<p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<article id="cloud-site">
<nav class="cloud-jump-menu cloud-jump-menu__prebuilt" data-cloud-menu-label="Certificate Authority Service documentation">
<div class="cloud-menu-content">
<a class="cloud-jump-menu__toggle" href="#">Certificate Authority Service documentation<i aria-hidden="true" class="material-icons" translate="no"><span></span></i></a>
<div class="cloud-jump-menu__links">
<h1 class="cloud-subhead" data-text="Certificate Authority Service documentation" id="certificate-authority-service-documentation">Certificate Authority Service documentation</h1>
<!-- first_jump_section_label -->
<div class="cloud-jump-menu__links">
<a class="cloud-jump-menu__item" href="#docs" track-metadata-eventdetail="Overview" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
      Overview
    </div>
</a>
<!-- hero_headline -->
<!-- Training and tutorials -->
<a class="cloud-jump-menu__item" href="#training-and-tutorials" track-metadata-eventdetail="Training and tutorials" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
         Training and tutorials
        </div>
</a>
<!-- use-cases -->
<a class="cloud-jump-menu__item" href="#use-cases" track-metadata-eventdetail="Use cases" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
          Use cases
        </div>
</a>
<!-- Code samples -->
<a class="cloud-jump-menu__item" href="#code-samples" track-metadata-eventdetail="Code samples" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
        Code samples
      </div>
</a>
<!--  Videos -->
<a class="cloud-jump-menu__item" href="#videos" track-metadata-eventdetail="Videos" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
        Videos
      </div>
</a>
</div>
</div>
</div>
</nav>
<div class="cloud-jump-content cloud-jump-section" data-cloud-main-text="Overview" id="docs">
<div class="cloud-section cloud-section--no-padding-bottom cloud-section__header--small">
<div class="page-intro">
<p>
  Certificate Authority Service is a highly available and scalable Google Cloud service that
  enables you to simplify, automate, and customize the deployment, management,
  and security of private certificate authorities (CA).
  </p>
</div>
</div>
<div class="cloud-section--small cloud-section--no-padding-top hero-section">
<div class="cloud-grid--alternate cloud-copy__inner cloud-copy--three-column">
<div class="cloud-grid--alternate cloud-grid--row-gap cloud-grid__col is-12 is-12__large">
<div class="cloud-grid__col is-6 is-4__large">
<div class="cloud-list-card cloud-elevation-z0">
<div class="cloud-list-card__content">
<div class="cloud-list-card__header-border">
<h4 class="cloud-list-card__subhead cloud-body-text" data-text="Guides" id="guides">Guides</h4>
</div>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/create-certificate" track-metadata-category="Guides" track-metadata-child_headline="Quickstart" track-metadata-eventdetail="/certificate-authority-service/docs/create-certificate" track-metadata-position="0" track-name="
  Quickstart
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Quickstart
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/creating-ca-pool" track-metadata-category="Guides" track-metadata-child_headline="Creating CA pools" track-metadata-eventdetail="/certificate-authority-service/docs/creating-ca-pool" track-metadata-position="1" track-name="
  Creating CA pools
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Creating CA pools
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/creating-certificate-authorities" track-metadata-category="Guides" track-metadata-child_headline="Creating CAs" track-metadata-eventdetail="/certificate-authority-service/docs/creating-certificate-authorities" track-metadata-position="2" track-name="
  Creating CAs
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Creating CAs
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/managing-ca-rotation" track-metadata-category="Guides" track-metadata-child_headline="Managing CA rotation" track-metadata-eventdetail="/certificate-authority-service/docs/managing-ca-rotation" track-metadata-position="3" track-name="
  Managing CA rotation
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Managing CA rotation
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/creating-certificate-template" track-metadata-category="Guides" track-metadata-child_headline="Creating certificate templates" track-metadata-eventdetail="/certificate-authority-service/docs/creating-certificate-template" track-metadata-position="4" track-name="
  Creating certificate templates
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Creating certificate templates
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/use-issuance-policy" track-metadata-category="Guides" track-metadata-child_headline="Using a certificate issuance policy" track-metadata-eventdetail="/certificate-authority-service/docs/use-issuance-policy" track-metadata-position="5" track-name="
  Using a certificate issuance policy
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Using a certificate issuance policy
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/requesting-certificates" track-metadata-category="Guides" track-metadata-child_headline="Requesting certificates" track-metadata-eventdetail="/certificate-authority-service/docs/requesting-certificates" track-metadata-position="6" track-name="
  Requesting certificates
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Requesting certificates
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/revoking-certificates" track-metadata-category="Guides" track-metadata-child_headline="Revoking certificates" track-metadata-eventdetail="/certificate-authority-service/docs/revoking-certificates" track-metadata-position="7" track-name="
  Revoking certificates
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Revoking certificates
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/configuring-iam" track-metadata-category="Guides" track-metadata-child_headline="Configuring, modifying, and removing IAM policies" track-metadata-eventdetail="/certificate-authority-service/docs/configuring-iam" track-metadata-position="8" track-name="
  Configuring, modifying, and removing IAM policies
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Configuring, modifying, and removing IAM policies
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item cloud-list-card__list-item--static">
<div>
</div>
</li>
</ul>
</div>
<div class="cloud-list-card__footer">
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item l-pad-left-4">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/how-to" track-metadata-anchor_text="More" track-metadata-category="Guides" track-metadata-eventdetail="/certificate-authority-service/docs/how-to" track-metadata-href="/certificate-authority-service/docs/how-to" track-metadata-icon="internal" track-metadata-modifier="flat" track-name="More" track-type="button">
    
  
    More
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-grid__col is-6 is-4__large">
<div class="cloud-list-card cloud-elevation-z0">
<div class="cloud-list-card__content">
<div class="cloud-list-card__header-border">
<h4 class="cloud-list-card__subhead cloud-body-text" data-text="Reference" id="reference">Reference</h4>
</div>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/reference/rpc" track-metadata-category="Reference" track-metadata-child_headline="RPC APIs" track-metadata-eventdetail="/certificate-authority-service/docs/reference/rpc/" track-metadata-position="0" track-name="
  RPC APIs
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        RPC APIs
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/reference/rest" track-metadata-category="Reference" track-metadata-child_headline="REST APIs" track-metadata-eventdetail="/certificate-authority-service/docs/reference/rest/" track-metadata-position="1" track-name="
  REST APIs
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        REST APIs
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/sdk/gcloud/reference/privateca" track-metadata-category="Reference" track-metadata-child_headline="gcloud privateca commands" track-metadata-eventdetail="/sdk/gcloud/reference/privateca" track-metadata-position="2" track-name="
  gcloud privateca commands
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        gcloud privateca commands
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/using-grpc" track-metadata-category="Reference" track-metadata-child_headline="Using gRPC" track-metadata-eventdetail="/certificate-authority-service/docs/using-grpc" track-metadata-position="3" track-name="
  Using gRPC
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Using gRPC
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/certificate-profile" track-metadata-category="Reference" track-metadata-child_headline="Certificate profiles" track-metadata-eventdetail="/certificate-authority-service/docs/certificate-profile" track-metadata-position="4" track-name="
  Certificate profiles
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Certificate profiles
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/reference/permissions-and-roles" track-metadata-category="Reference" track-metadata-child_headline="Permissions and roles" track-metadata-eventdetail="/certificate-authority-service/docs/reference/permissions-and-roles" track-metadata-position="5" track-name="
  Permissions and roles
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Permissions and roles
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/rfc-compliance" track-metadata-category="Reference" track-metadata-child_headline="RFC compliance" track-metadata-eventdetail="/certificate-authority-service/docs/rfc-compliance" track-metadata-position="6" track-name="
  RFC compliance
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        RFC compliance
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/troubleshooting" track-metadata-category="Reference" track-metadata-child_headline="Troubleshooting" track-metadata-eventdetail="/certificate-authority-service/docs/troubleshooting" track-metadata-position="7" track-name="
  Troubleshooting
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Troubleshooting
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item cloud-list-card__list-item--static">
<div>
</div>
</li>
</ul>
</div>
<div class="cloud-list-card__footer">
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item l-pad-left-4">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/apis" track-metadata-anchor_text="More" track-metadata-category="Reference" track-metadata-eventdetail="/certificate-authority-service/docs/apis" track-metadata-href="/certificate-authority-service/docs/apis" track-metadata-icon="internal" track-metadata-modifier="flat" track-name="More" track-type="button">
    
  
    More
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-grid__col is-6 is-4__large">
<div class="cloud-list-card cloud-elevation-z0">
<div class="cloud-list-card__content">
<div class="cloud-list-card__header-border">
<h4 class="cloud-list-card__subhead cloud-body-text" data-text="Resources" id="resources">Resources</h4>
</div>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/faqs" track-metadata-category="Resources" track-metadata-child_headline="Frequently asked questions" track-metadata-eventdetail="/certificate-authority-service/docs/faqs" track-metadata-position="0" track-name="
  Frequently asked questions
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Frequently asked questions
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/pricing" track-metadata-category="Resources" track-metadata-child_headline="Pricing" track-metadata-eventdetail="/certificate-authority-service/pricing" track-metadata-position="1" track-name="
  Pricing
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Pricing
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/quotas" track-metadata-category="Resources" track-metadata-child_headline="Quotas and limits" track-metadata-eventdetail="/certificate-authority-service/quotas" track-metadata-position="2" track-name="
  Quotas and limits
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Quotas and limits
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/release-notes" track-metadata-category="Resources" track-metadata-child_headline="Release notes" track-metadata-eventdetail="/certificate-authority-service/docs/release-notes" track-metadata-position="3" track-name="
  Release notes
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Release notes
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/known-limitations" track-metadata-category="Resources" track-metadata-child_headline="Known limitations" track-metadata-eventdetail="/certificate-authority-service/docs/known-limitations" track-metadata-position="4" track-name="
  Known limitations
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Known limitations
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/sla" track-metadata-category="Resources" track-metadata-child_headline="Service Level Agreement" track-metadata-eventdetail="/certificate-authority-service/sla" track-metadata-position="5" track-name="
  Service Level Agreement
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Service Level Agreement
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/certificate-authority-service/docs/getting-support" track-metadata-category="Resources" track-metadata-child_headline="Getting support" track-metadata-eventdetail="/certificate-authority-service/docs/getting-support" track-metadata-position="6" track-name="
  Getting support
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Getting support
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item cloud-list-card__list-item--static">
<div>
</div>
</li>
</ul>
</div>
<div class="cloud-list-card__footer">
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item l-pad-left-4">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/resources" track-metadata-anchor_text="More" track-metadata-category="Resources" track-metadata-eventdetail="/certificate-authority-service/docs/resources" track-metadata-href="/certificate-authority-service/docs/resources" track-metadata-icon="internal" track-metadata-modifier="flat" track-name="More" track-type="button">
    
  
    More
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cloud-section--small cloud-section--border technical-architectures cloud-section--no-padding-top">
<h2 class="cloud-jump-section" data-cloud-main-text="Training and tutorials" data-text="Training and tutorials" id="training-and-tutorials">Training and tutorials</h2>
<p class="cloud-section__header--xsmall">
            
              Try CA Service tutorials, courses, and self-paced
              training from
              <dfn title="Google Cloud Skills Boost offers courses, hands-on labs, and badges to build and validate your cloud skills.">
              Google Cloud Skills Boost</dfn>.
            
            </p>
<div class="cloud-card__container cloud-card__container--3up cloud-card__container--left-aligned">
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Training

  </span>
<p class="cloud-card__headline cloud-headline5">Getting started with Certificate Authority Service</p>
<p class="cloud-body-text__small">
    Learn how to enable the Certificate Authority Service API, create a root CA and a subordinate CA, and issue certificates from those CAs.
    
  </p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="https://www.cloudskillsboost.google/catalog_lab/3873" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Training" track-metadata-eventdetail="https://www.cloudskillsboost.google/catalog_lab/3873" track-metadata-href="https://www.cloudskillsboost.google/catalog_lab/3873" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="0" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Tutorial

  </span>
<p class="cloud-card__headline cloud-headline5">Manage policy controls</p>
<p class="cloud-body-text__small">
    Policy controls let you control the type of certificates that your CA pool can issue. This tutorial explains how you can manage various policies to control certificate issuance and access to CA Service resources.
    
  </p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/tutorials/manage-policy-controls" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Tutorial" track-metadata-eventdetail="/certificate-authority-service/docs/tutorials/manage-policy-controls" track-metadata-href="/certificate-authority-service/docs/tutorials/manage-policy-controls" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="1" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
</div>
</div>
<div class="cloud-section--small cloud-section--border learn cloud-section--no-padding-top">
<h2 class="cloud-jump-section" data-cloud-main-text="Use cases" data-text="               Use cases             " id="use-cases">
              Use cases
            </h2>
<p class="cloud-section__header--xsmall">Explore use cases, reference architectures, whitepapers, best practices, and industry solutions.</p>
<div class="cloud-card__container cloud-card__container--3up cloud-card__container--left-aligned">
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Hashicorp Vault CA integration</p>
<p class="cloud-body-text__small">
    Hashicorp Vault is commonly used for managing and storing secrets on-premises. This topic describes how Hashicorp Vault CA can be configured to act as a proxy that forwards all certificate issuance requests to Certificate Authority Service. This integration allows a currently deployed solution to natively work with CA Service.
    
      <div class="chips-container">
<span class="chip">Hashicorp</span>
<span class="chip">On-premises</span>
<span class="chip">Secrets</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/hashicorp-integration" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/certificate-authority-service/docs/hashicorp-integration" track-metadata-href="/certificate-authority-service/docs/hashicorp-integration" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="0" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Implementing a delegated OCSP responder</p>
<p class="cloud-body-text__small">
    Using OCSP to provide the certificate revocation status can have many benefits. These benefits include quicker response time and smaller requirement for network bandwidth, as compared to Certificate Revocation Lists (CRLs), which can get very large. This page provides information about configuring a delegated OCSP responder that works with CA Service.
    
      <div class="chips-container">
<span class="chip">OCSP</span>
<span class="chip">Security</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/ocsp-support" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/certificate-authority-service/docs/ocsp-support" track-metadata-href="/certificate-authority-service/docs/ocsp-support" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="1" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Using Terraform</p>
<p class="cloud-body-text__small">
    Terraform is a popular open source tool that lets you create and manage your Certificate Authority Service resources using its infrastructure-as-code paradigm. This guide provides information about using Terraform with CA Service.
    
      <div class="chips-container">
<span class="chip">Terraform</span>
<span class="chip">CA Service APIs</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/using-terraform" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/certificate-authority-service/docs/using-terraform" track-metadata-href="/certificate-authority-service/docs/using-terraform" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="2" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Manage certificate lifecycle using Cert-Manager</p>
<p class="cloud-body-text__small">
    Cert-Manager is a Kubernetes add-on to automate the management and issuance of TLS certificates from various issuing sources. You can use Cert-Manager to manage the lifecycle of certificates issued by CAs that are created using CA Service. Cert-Manager ensures certificates are valid and duly renewed before they expire.
    
      <div class="chips-container">
<span class="chip">Cert-Manager</span>
<span class="chip">Certificate renewal</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/cert-manager" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/certificate-authority-service/docs/cert-manager" track-metadata-href="/certificate-authority-service/docs/cert-manager" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="3" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Use Certificate Authority Service with Anthos Service Mesh</p>
<p class="cloud-body-text__small">
    CA Service lets you request workload identity certificates from a certificate authority (CA) that you control. This document explains how you can install Anthos Service Mesh and use Certificate Authority Service with it.
    
      <div class="chips-container">
<span class="chip">Anthos Service Mesh</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/service-mesh/docs/unified-install/install-anthos-service-mesh#install_ca_service" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/service-mesh/docs/unified-install/install-anthos-service-mesh#install_ca_service" track-metadata-href="/service-mesh/docs/unified-install/install-anthos-service-mesh#install_ca_service" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="4" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Set up Traffic Director service security with Envoy</p>
<p class="cloud-body-text__small">
    Learn how you can set up service security for Traffic Director with Envoy and Certificate Authority Service.
    
      <div class="chips-container">
<span class="chip">Traffic Director</span>
<span class="chip">Envoy</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/traffic-director/docs/security-envoy-setup" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/traffic-director/docs/security-envoy-setup" track-metadata-href="/traffic-director/docs/security-envoy-setup" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="5" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Use case

  </span>
<p class="cloud-card__headline cloud-headline5">Set up Traffic Director service security with proxyless gRPC</p>
<p class="cloud-body-text__small">
    Learn how you can set up service security for Traffic Director with proxyless gRPC and Certificate Authority Service.
    
      <div class="chips-container">
<span class="chip">Traffic Director</span>
<span class="chip">proxyless gRPC</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/traffic-director/docs/security-proxyless-setup" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Use case" track-metadata-eventdetail="/traffic-director/docs/security-proxyless-setup" track-metadata-href="/traffic-director/docs/security-proxyless-setup" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="6" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Whitepaper

  </span>
<p class="cloud-card__headline cloud-headline5">How to deploy a secure and reliable PKI with Certificate Authority Service</p>
<p class="cloud-body-text__small">
    This whitepaper provides security and architectural recommendations to organizations for the use of CA Service. It describes critical concepts to securing and deploying a PKI and provides specific recommendations for configuring CA Service to ensure high operational availability.
    
      <div class="chips-container">
<span class="chip">PKI design</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="https://services.google.com/fh/files/misc/deploying_public_key_infrastructure_with_cas.pdf" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Whitepaper" track-metadata-eventdetail="https://services.google.com/fh/files/misc/deploying_public_key_infrastructure_with_cas.pdf" track-metadata-href="https://services.google.com/fh/files/misc/deploying_public_key_infrastructure_with_cas.pdf" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="7" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Whitepaper

  </span>
<p class="cloud-card__headline cloud-headline5">Scaling certificate management with Certificate Authority Service</p>
<p class="cloud-body-text__small">
    This whitepaper explains how CA Service addresses the challenges organizations face as they use digital certificates in a fast-changing and interconnected digital world.
    
      <div class="chips-container">
<span class="chip">IoT</span>
<span class="chip">Cloud computing</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="https://services.google.com/fh/files/misc/scaling_certificate_management_cas.pdf" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Whitepaper" track-metadata-eventdetail="https://services.google.com/fh/files/misc/scaling_certificate_management_cas.pdf" track-metadata-href="https://services.google.com/fh/files/misc/scaling_certificate_management_cas.pdf" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="8" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Best practice

  </span>
<p class="cloud-card__headline cloud-headline5">Best practices for Certificate Authority Service</p>
<p class="cloud-body-text__small">
    This topic provides the best practices to use CA Service more effectively.
    
      <div class="chips-container">
<span class="chip">Access control</span>
<span class="chip">Signing keys</span>
<span class="chip">CA Service tiers</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/best-practices" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Best practice" track-metadata-eventdetail="/certificate-authority-service/docs/best-practices" track-metadata-href="/certificate-authority-service/docs/best-practices" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="9" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<span class="cloud-chip cloud-chip--blue-bg cloud-card__chip">
  Solution

  </span>
<p class="cloud-card__headline cloud-headline5">GCLB rotation tool</p>
<p class="cloud-body-text__small">
    Certificate expiry is one of the main sources of service outages in the industry. Even large and well-established companies have suffered from this in recent years. The GCLB rotation tool can be configured to periodically check the status of SSL proxy load balancers and rotate their certificates using CA Service when they reach a given threshold.
    
      <div class="chips-container">
<span class="chip">Certificate management</span>
</div>
</p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="/certificate-authority-service/docs/gclb-rotation-tool" track-metadata-anchor_text="Learn more" track-metadata-chip-label="Solution" track-metadata-eventdetail="/certificate-authority-service/docs/gclb-rotation-tool" track-metadata-href="/certificate-authority-service/docs/gclb-rotation-tool" track-metadata-icon="internal" track-metadata-link-label="Learn more" track-metadata-modifier="flat" track-metadata-position="10" track-name="Learn more" track-type="button">
    
  
    Learn more
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</div>
</div>
</div>
</div>
<div class="cloud-section--small cloud-section--border samples cloud-section--no-padding-top">
<h2 class="cloud-jump-section" data-cloud-main-text="Code samples" data-text="Code samples" id="code-samples">Code samples</h2>
<p class="cloud-section__header--xsmall">
              Dive into coding with examples that demonstrate how to use and connect Google Cloud services.
            </p>
<div class="cloud-card__container cloud-card__container--3up cloud-card__container--left-aligned">
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<p class="cloud-eyebrow cloud-card__eyebrow">github</p>
<p class="cloud-card__headline cloud-headline5">Certificate Authority Service Client for Python</p>
<p class="cloud-body-text__small">
    Samples that use the Python idiomatic client for Certificate Authority Service.
    
  </p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="https://github.com/googleapis/python-security-private-ca" target="_blank" track-metadata-anchor_text="Open GitHub" track-metadata-category="github" track-metadata-chip-label="" track-metadata-eventdetail="https://github.com/googleapis/python-security-private-ca" track-metadata-href="https://github.com/googleapis/python-security-private-ca" track-metadata-icon="external" track-metadata-link-label="Open GitHub" track-metadata-modifier="flat" track-metadata-position="0" track-name="Open GitHub" track-type="button">
    
  
    Open GitHub
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--external" translate="no">arrow_forward</i></span></a>
</div>
</div>
<div class="cloud-card cloud-elevation-z1">
<div class="cloud-card__content--has-footer">
<p class="cloud-eyebrow cloud-card__eyebrow">github</p>
<p class="cloud-card__headline cloud-headline5">Certificate Authority Service Client for Java</p>
<p class="cloud-body-text__small">
    Samples that use the Java idiomatic client for Certificate Authority Service.
    
  </p>
</div>
<div class="cloud-card__footer">
<a class="cloud-button cloud-button--flat" href="https://github.com/googleapis/java-security-private-ca" target="_blank" track-metadata-anchor_text="Open GitHub" track-metadata-category="github" track-metadata-chip-label="" track-metadata-eventdetail="https://github.com/googleapis/java-security-private-ca" track-metadata-href="https://github.com/googleapis/java-security-private-ca" track-metadata-icon="external" track-metadata-link-label="Open GitHub" track-metadata-modifier="flat" track-metadata-position="1" track-name="Open GitHub" track-type="button">
    
  
    Open GitHub
  
<span class="cloud-button__icon--no-wrap"> <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--external" translate="no">arrow_forward</i></span></a>
</div>
</div>
</div>
</div>
<div class="cloud-section--small cloud-section--border community cloud-section--no-padding-top">
<h2 class="cloud-jump-section" data-cloud-main-text="Videos" data-text="               Videos             " id="videos">
              Videos
            </h2>
<devsite-dynamic-content initial-results="3" query="tenant:cloud+origin:youtube+text:Private Certificate Authority" sortorder="-timestamp">
</devsite-dynamic-content>
</div>
</div>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/create-certificate]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Create a certificate by using the Cloud console" id="create-a-certificate-by-using-the-cloud-console">Create a certificate by using the Cloud console</h1>
<section class="intro">
<p>This page explains how you can use Certificate Authority Service and the Google Cloud console to
create certificates.</p>
<p>CA Service lets you deploy and manage private certificate authorities
(CAs) without managing infrastructure.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
</section>
<section class="steps">
<h2 data-text="Create a CA pool" id="create-pool">Create a CA pool</h2>
<p>A CA pool is a collection of multiple CAs. A CA pool provides the ability to
rotate trust chains without any outage or downtime for workloads. A CA pool
lives in a single <a href="/about/locations">Google Cloud location</a> that you cannot
change after creation.</p>
<p>To create a CA pool with the default settings, do the following:</p>
<ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Under the <strong>CA pool manager</strong> tab, click
<span aria-hidden="true" class="material-icons" translate="no">add_box</span><strong>Create pool</strong>.</p></li>
<li><p>On the <strong>Create CA pool</strong> page, add a name for the CA pool.</p>
<aside class="note"><strong>Note:</strong><span> The names of all CA Service resources must contain only
the allowed characters, which are all the letters, numbers, hyphen, and
underscore. The maximum allowed length of a name is 63 characters.</span></aside></li>
<li><p>Click <strong>Region</strong>, and select <strong>us-east1 (South Carolina)</strong> as the region of
the CA pool.</p></li>
<li><p>Click <strong>Next</strong> for each step.</p></li>
<li><p>Click <strong>Done</strong>.</p></li>
</ol>
<p>You can see this CA pool in the list of CA pools under the <strong>CA pool manager</strong>
tab.</p>
<h2 data-text="Create a root CA" id="create-ca">Create a root CA</h2>
<p>A CA pool is empty on creation. You must add a CA to the CA pool to request
certificates.</p>
<p>A root CA has a self-signed certificate that resides in the client's trust
store. This section explains how you can add a root CA to the CA pool you
created.</p>
<p>To add a root CA to your CA pool, do the following:</p>
<ol>
<li>Click <strong>CA manager</strong>.</li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">add_box</span><strong>Create CA</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="create-ca" src="/certificate-authority-service/images/create-ca-quickstart.png" style="width: 85%"/>
<devsite-lightbox id="create-ca">
<img alt="Create a new CA in your CA pool." src="/certificate-authority-service/images/create-ca-quickstart.png"/>
</devsite-lightbox></p></li>
<li><p>Click <strong>Region</strong>, and select <strong>us-east1 (South Carolina)</strong> as the region of
the CA.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>In the <strong>Organization (O)</strong> field, enter the name of your organization.</p></li>
<li><p>In the <strong>CA common name (CN)</strong> field, enter the name of the CA. Note the CA
name because you will need it for requesting a certificate.</p></li>
<li><p>In the <strong>Pool ID</strong> field, enter the name of your CA pool.</p></li>
<li><p>Click <strong>Next</strong> for each step.</p></li>
<li><p>Review the details of the CA, and click <strong>Create</strong>.</p></li>
</ol>
<h2 data-text="Create a certificate" id="create-certificate">Create a certificate</h2>
<p>To request a certificate using the CA, do the following:</p>
<ol>
<li>On the <strong>Certificate authority</strong> page, click <strong>Request a certificate</strong>.</li>
<li><p>Click <strong>Enter details</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="enter-details" src="/certificate-authority-service/images/request-certificate-enter-details.png" style="width: 75%"/>
<devsite-lightbox id="enter-details">
<img alt="Click Enter details to request a certificate." src="/certificate-authority-service/images/request-certificate-enter-details.png"/>
</devsite-lightbox></p></li>
<li><p>Under <strong>Add domain name</strong>, enter the fully qualified domain name of the site
you want to secure with this certificate.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>Under <strong>Configure key size and algorithm</strong>, click <strong>Continue</strong>.</p>
<p>You will see the generated certificate that you can copy or download. To
copy the certificate, click <span aria-hidden="true" class="material-icons" translate="no">content_copy</span>.</p>
<p><img class="screenshot" data-modal-dialog-id="download-cert" src="/certificate-authority-service/images/download-signed-certificate.png" style="width: 85%"/>
<devsite-lightbox id="download-cert">
<img alt="Copy or download the generated certificate." src="/certificate-authority-service/images/download-signed-certificate.png"/>
</devsite-lightbox></p></li>
<li><p>Click <strong>Done</strong>.</p></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>Clean up by revoking the certificate and deleting the CA pool, the CA, and the
project you created for this quickstart.</p>
<ol>
<li><p>Revoke the certificate.</p>
<ol>
<li>
    Click the <b>Private certificate manager</b> tab.
  </li>
<li>
    In the list of certificates, click
    <span aria-hidden="true" class="material-icons" translate="no">more_vert</span><b>View more</b> in the row of
    the certificate you want to delete.
  </li>
<li>
    Click <b>Revoke</b>.
  </li>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
</ol></li>
<li><p>Delete the CA.</p>
<p>You can delete a CA only after you have revoked all the certificates
issued by it.</p>
<p>After you have revoked the certificate, do the following:</p>
<ol>
<li>
    Click the <b>CA manager</b> tab.
  </li>
<li>
    In the list of CAs, select the CA you want to delete.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">cancel</span><b>Disable</b>.
  </li>
<img class="screenshot" data-modal-dialog-id="disable" src="/certificate-authority-service/images/disable-ca.png" style="width: 85%"/>
<devsite-lightbox id="disable">
<img alt="Disable the CA you want to delete." src="/certificate-authority-service/images/disable-ca.png"/>
</devsite-lightbox>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">delete</span><b>Delete</b>.
  </li>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
</ol>
<p>The CA state changes to <code dir="ltr" translate="no">Deleted</code>. The CA is permanently deleted 30 days
after you initiate the deletion.</p></li>
<li><p>Delete the CA pool.</p>
<p>You can delete a CA pool only after CA Service permanently
deletes the CA.</p>
<p>After you have deleted the CA in the CA pool, do the following:</p>
<ol>
<li>
    Click the <b>CA pool manager</b> tab.
  </li>
<li>
    In the list of CA pools, select the CA pool you want to delete.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">delete</span><b>Delete</b>.
  </li>
<img class="screenshot" data-modal-dialog-id="delete-pool" src="/certificate-authority-service/images/delete-ca-pool.png" style="width: 85%"/>
<devsite-lightbox id="delete-pool">
<img alt="Permanently delete a CA pool." src="/certificate-authority-service/images/delete-ca-pool.png"/>
</devsite-lightbox>
<li>
    In the dialog box that opens, click <b>Confirm</b>.
  </li>
</ol></li>
<li><p>To delete the project, do the following:</p>
<p>
<ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol></p></li>
</ol>
</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/creating-ca-pool">creating a CA pool</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/creating-certificate-authorities">creating CAs</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/requesting-certificates">requesting certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/policy-controls">control the type of certificates a CA pool can issue</a>.</li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/apis]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="apis">
<header>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/reference/libraries">
<h3 class="hide-from-toc no-link" data-text="Client libraries" id="client-libraries">Client libraries</h3>
<p>
    Read how to get started with using the client libraries.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/reference/rest">
<h3 class="hide-from-toc no-link" data-text="REST API Reference" id="rest-api-reference">REST API Reference</h3>
<p>
    Read about the REST APIs.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/reference/rpc">
<h3 class="hide-from-toc no-link" data-text="RPC API Reference" id="rpc-api-reference">RPC API Reference</h3>
<p>
    Read about the RPC APIs.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/using-grpc">
<h3 class="hide-from-toc no-link" data-text="Using gRPC" id="using-grpc">Using gRPC</h3>
<p>
    Read how to use manually-created gRPC libraries to make API calls to CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/certificate-profile">
<h3 class="hide-from-toc no-link" data-text="Certificate profiles" id="certificate-profiles">Certificate profiles</h3>
<p>
    Read about the common certificate profiles.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/reference/permissions-and-roles">
<h3 class="hide-from-toc no-link" data-text="Permissions and roles" id="permissions-and-roles">Permissions and roles</h3>
<p>
    Read about IAM permissions and roles for CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/rfc-compliance">
<h3 class="hide-from-toc no-link" data-text="RFC compliance" id="rfc-compliance">RFC compliance</h3>
<p>
    Learn the RFC 5280 requirements that CA Service enforces.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/troubleshooting">
<h3 class="hide-from-toc no-link" data-text="Troubleshooting" id="troubleshooting">Troubleshooting</h3>
<p>
    See solutions to common issues encountered in CA Service.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/samples]</H1></p><div class="devsite-article-body clearfix">
<p>This page contains code samples for Certificate Authority Service. To search and filter code samples for other
Google Cloud products, see the
<a class="cloud-link" href="/docs/samples?p=privateca">Google Cloud sample browser</a>.</p>
<div class="cloud-card__container">
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Activate a Subordinate Certificate Authority" id="activate-a-subordinate-certificate-authority">Activate a Subordinate Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Activate an already created Subordinate Certificate Authority.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-activate-subordinateca#privateca_activate_subordinateca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-activate-subordinateca#privateca_activate_subordinateca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-activate-subordinateca">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a CA pool" id="create-a-ca-pool">Create a CA pool</h4>
<p class="cloud-body-text" id="desc">Create a new CA pool in the specified project and zone.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca-pool#privateca_create_ca_pool-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca-pool#privateca_create_ca_pool-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca-pool">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/creating-ca-pool">Creating CA pools</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a certificate" id="create-a-certificate">Create a certificate</h4>
<p class="cloud-body-text" id="desc">Issue/ create a new certificate using a certificate authority.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate#privateca_create_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate#privateca_create_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/tutorials/using-3pi-with-reflection">Issue certificates that attest to third-party identity</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Create a Certificate template" id="create-a-certificate-template">Create a Certificate template</h4>
<p class="cloud-body-text" id="desc">Create a Certificate template that can be reused for common certificate issuance scenarios.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-template#privateca_create_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-template#privateca_create_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a root Certificate Authority" id="create-a-root-certificate-authority">Create a root Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Create a root Certificate Authority under a CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca#privateca_create_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca#privateca_create_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-authorities">Creating certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a Subordinate Certificate Authority" id="create-a-subordinate-certificate-authority">Create a Subordinate Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Create a subordinate certificate authority from a root or subordinate CA.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-subordinateca#privateca_create_subordinateca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-subordinateca#privateca_create_subordinateca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-subordinateca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-authorities">Creating certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create Certificate using Certificate Signing Request " id="create-certificate-using-certificate-signing-request">Create Certificate using Certificate Signing Request </h4>
<p class="cloud-body-text" id="desc">Issue certificate by the specified certificate authority using a CSR.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-csr#privateca_create_certificate_csr-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-csr#privateca_create_certificate_csr-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-csr">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Delete a Certificate template" id="delete-a-certificate-template">Delete a Certificate template</h4>
<p class="cloud-body-text" id="desc">Delete the specified certificate template from project.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-certificate-template#privateca_delete_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-certificate-template#privateca_delete_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete CA pool" id="delete-ca-pool">Delete CA pool</h4>
<p class="cloud-body-text" id="desc">Delete the specified CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca-pool#privateca_delete_ca_pool-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca-pool#privateca_delete_ca_pool-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca-pool">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/operations-ca-pool">Updating and deleting a CA pool</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete Certificate Authority" id="delete-certificate-authority">Delete Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Delete the Certificate Authority from the specified CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca#privateca_delete_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca#privateca_delete_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/deleting-certificate-authorities">Deleting certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Disable a Certificate Authority" id="disable-a-certificate-authority">Disable a Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Disable a Certificate Authority in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-disable-ca#privateca_disable_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-disable-ca#privateca_disable_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-disable-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/managing-ca-state">Managing CA state</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Enable a Certificate Authority" id="enable-a-certificate-authority">Enable a Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Enable the Certificate Authority in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-enable-ca#privateca_enable_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-enable-ca#privateca_enable_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-enable-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/managing-ca-state">Managing CA state</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Filter certificates" id="filter-certificates">Filter certificates</h4>
<p class="cloud-body-text" id="desc">Filter certificates based on a condition.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-filter-certificate#privateca_filter_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-filter-certificate#privateca_filter_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-filter-certificate">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="List CA pool" id="list-ca-pool">List CA pool</h4>
<p class="cloud-body-text" id="desc">List all CA pools in the given project and location.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca-pool#privateca_list_ca_pool-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca-pool#privateca_list_ca_pool-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca-pool">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List Certificate Authorities" id="list-certificate-authorities">List Certificate Authorities</h4>
<p class="cloud-body-text" id="desc">List all Certificate Authorities in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca#privateca_list_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca#privateca_list_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/listing-certificate-authorities">Listing certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="List Certificate templates" id="list-certificate-templates">List Certificate templates</h4>
<p class="cloud-body-text" id="desc">List the Certificate templates in the specified project and location.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate-template#privateca_list_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate-template#privateca_list_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List Certificates" id="list-certificates">List Certificates</h4>
<p class="cloud-body-text" id="desc">List Certificates in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate#privateca_list_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate#privateca_list_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Monitor expiring Certificate Authorities" id="monitor-expiring-certificate-authorities">Monitor expiring Certificate Authorities</h4>
<p class="cloud-body-text" id="desc">Create a monitoring policy that notifies 30 days before a managed CA expires.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-monitor-ca-expiry#privateca_monitor_ca_expiry-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-monitor-ca-expiry#privateca_monitor_ca_expiry-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-monitor-ca-expiry">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Revoke a Certificate" id="revoke-a-certificate">Revoke a Certificate</h4>
<p class="cloud-body-text" id="desc">Revoke an issued Certificate.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-revoke-certificate#privateca_revoke_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-revoke-certificate#privateca_revoke_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-revoke-certificate">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/revoking-certificates">Revoking certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Set/ Update Issuance Policy" id="set-update-issuance-policy">Set/ Update Issuance Policy</h4>
<p class="cloud-body-text" id="desc">Set/ Update the issuance policy for a CA pool. All certificates issued from this CA pool should meet the issuance policy.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-set-issuance-policy#privateca_set_issuance_policy-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-set-issuance-policy#privateca_set_issuance_policy-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-set-issuance-policy">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Undelete a Certificate Authority" id="undelete-a-certificate-authority">Undelete a Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Restore a deleted CA, if still within the grace period of 30 days.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-undelete-ca#privateca_undelete_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-undelete-ca#privateca_undelete_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-undelete-ca">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Update a Certificate template" id="update-a-certificate-template">Update a Certificate template</h4>
<p class="cloud-body-text" id="desc">Update an existing Certificate template.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-certificate-template#privateca_update_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-certificate-template#privateca_update_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Update Certificate Authority Label" id="update-certificate-authority-label">Update Certificate Authority Label</h4>
<p class="cloud-body-text" id="desc">Update the labels in a Certificate Authority.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-ca-label#privateca_update_ca_label-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-ca-label#privateca_update_ca_label-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-ca-label">
            View sample
          </a>
</div>
</div>
</div>
</div>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/support]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="support">
<header>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/getting-support">
<h3 class="hide-from-toc no-link" data-text="Getting support" id="getting-support">Getting support</h3>
<p>
    Where to find support when using CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/billing-questions">
<h3 class="hide-from-toc no-link" data-text="Billing questions" id="billing-questions">Billing questions</h3>
<p>
    Learn about the resources where you can find answers for common billing questions.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/resources]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="resources">
<header>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/faqs">
<h3 class="hide-from-toc no-link" data-text="Frequently asked questions" id="frequently-asked-questions">Frequently asked questions</h3>
<p>
    Frequently asked questions for CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/pricing">
<h3 class="hide-from-toc no-link" data-text="Pricing" id="pricing">Pricing</h3>
<p>
    Pricing details for CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/quotas">
<h3 class="hide-from-toc no-link" data-text="Quotas and limits" id="quotas-and-limits">Quotas and limits</h3>
<p>
    Usage policies for your CA Service resources.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/release-notes">
<h3 class="hide-from-toc no-link" data-text="Release notes" id="release-notes">Release notes</h3>
<p>
    Details about updates to CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/known-limitations">
<h3 class="hide-from-toc no-link" data-text="Known limitations" id="known-limitations">Known limitations</h3>
<p>
    Known limitations for CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/sla">
<h3 class="hide-from-toc no-link" data-text="Service Level Agreement" id="service-level-agreement">Service Level Agreement</h3>
<p>
    The service level agreement (SLA) for CA Service.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<style>
  body[layout='full'] {
    background: #fff;
  }
</style>
<article id="cloud-site">
<style>
      .module-section:first-child {
        margin-top: 48px;
      }

      .module-section:empty {
        display: none;
      }

      .module-section:not(:empty) {
        margin-bottom: 48px;
      }

      div.richtext {
        color: #5f6368;
      }

      .richtext p {
        color: inherit;
        font: inherit;
        margin-bottom: 0;
      }

      .cloud-jump-content {
        padding-top: 72px;
      }

      .cloud-module__description p {
        margin: 0;
      }

      .cloud-module__description p+p {
        margin-top: 16px;
      }

      @media(min-width: 1024px) {
        .module-section:first-child {
          margin-top: 60px;
        }

        .module-section:not(:empty) {
          margin-bottom: 60px;
        }
      }

      @media(min-width: 1280px) {
        .cloud-jump-content {
          padding-top: 0;
        }
      }

      .cloud-block__image {
        width: 100%;
      }
    </style>
<div class="cws-banner cws-fullbleed" track-metadata-module="banner">
<p class="cws-banner__body-copy"><span>Did you miss the recent Google
          Cloud Security Talks event? Check out all of the great sessions
          <a class="cws-link cws-link--dark" href="https://cloudonair.withgoogle.com/events/security-talks-march-2022" rel="noopener" target="_blank" track-metadata-eventdetail="cloudonair.withgoogle.com/events/security-talks-march-2022" track-name="on-demand" track-type="inline link">on-demand</a>!</span>
</p>
</div>
<header track-metadata-module="hero" track-metadata-position="hero">
<div class="cws-grid">
<div class="cws-grid__col--span-12 cws-grid__col--offset-1-lg cws-grid__col--span-8-lg cws-content-block cws-spacer-6--bottom cws-spacer-6--top">
<div class="cws-content-block__content">
<h1 class="cws-headline--headline-2 cws-content-block__headline" data-text="               Certificate Authority Service " id="certificate-authority-service">
              Certificate Authority Service </h1>
<div class="cws-content-block__text">
<p class="cws-body">Simplify the deployment and management of
                private CAs without managing infrastructure.</p>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/freetrial" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/freetrial" track-metadata-modifier="high-emphasis" track-metadata-module="hero" track-metadata-position="hero" track-name="try it free" track-type="button">


      Try it free
      
    
      </a>
<a class="cws-button cws-button--high-emphasis" href="https://docs.google.com/forms/d/1inuJhrN4xd9tAtmDvb6KoTdqicD-uzMWd5DAz47ljQM/viewform?edit_requested=true" rel="noopener" target="_blank" track-metadata-eventdetail="docs.google.com/forms/d/1inuJhrN4xd9tAtmDvb6KoTdqicD-uzMWd5DAz47ljQM/viewform" track-metadata-modifier="high-emphasis" track-metadata-module="hero" track-metadata-position="hero" track-name="express interest" track-type="button">


      Express interest
      
    
      </a>
</div>
</slot>
<slot slot="ineligible">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/security/cas" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/security/cas" track-metadata-modifier="high-emphasis" track-metadata-module="hero" track-metadata-position="hero" track-name="go to console" track-type="button">


      Go to console
      
    
      </a>
<a class="cws-button cws-button--high-emphasis" href="https://docs.google.com/forms/d/1inuJhrN4xd9tAtmDvb6KoTdqicD-uzMWd5DAz47ljQM/viewform?edit_requested=true" rel="noopener" target="_blank" track-metadata-eventdetail="docs.google.com/forms/d/1inuJhrN4xd9tAtmDvb6KoTdqicD-uzMWd5DAz47ljQM/viewform" track-metadata-modifier="high-emphasis" track-metadata-module="hero" track-metadata-position="hero" track-name="express interest" track-type="button">


      Express interest
      
    
      </a>
</div>
</slot>
</cloudx-free-trial-eligible-content>
<div class="cws-body cws-spacer-2--top">
<p>
<a class="cws-link" href="https://cloud.google.com/certificate-authority-service/docs" track-metadata-eventdetail="#" track-metadata-module="hero" track-metadata-module_headline="Certificate Authority Service" track-metadata-position="hero" track-name="documentation" track-type="inline-link">View documentation</a>
                  for this product. </p>
</div>
</div>
</div>
</div>
</div>
</header>
<section class="cws-spacer-5--bottom" track-metadata-module="overview" track-metadata-module_headline="overview">
<div class="cws-content-block cws-content-block--flipped cws-content-block--split cws-grid">
<div class="cws-content-block__asset cws-grid__col--span-6 cws-grid__col--span-5-lg cws-grid__col-justify-center cws-grid__col--align-center">
<div class="cws-media-block">
<div class="cws-media-block__asset">
<div class="cws-media-block__image">
<picture>
<source srcset="https://lh3.googleusercontent.com/G0hN--Mazn4kyHK3O7cQdkql-z5oVezJHPZAqiR1Ijj5cwMnBJKVNNueezqF0TM4yzD9Z6igDt4=e14-rw-lo-sc0xffffff-w1270 1x,https://lh3.googleusercontent.com/G0hN--Mazn4kyHK3O7cQdkql-z5oVezJHPZAqiR1Ijj5cwMnBJKVNNueezqF0TM4yzD9Z6igDt4=e14-rw-lo-sc0xffffff-w2540 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/G0hN--Mazn4kyHK3O7cQdkql-z5oVezJHPZAqiR1Ijj5cwMnBJKVNNueezqF0TM4yzD9Z6igDt4=e14-rj-sc0xffffff-w1270 1x,https://lh3.googleusercontent.com/G0hN--Mazn4kyHK3O7cQdkql-z5oVezJHPZAqiR1Ijj5cwMnBJKVNNueezqF0TM4yzD9Z6igDt4=e14-rj-sc0xffffff-w2540 2x" type="image/jpeg"/>
<img alt="From left a dotted line joins a stack of servers, car, and smartphone with 2 shipping containers and with a database. A dotted line runs from the containers through the Certificate Authority Service icon to a document bearing lines of text and a locked padlock, and to Google Cloud" class="" loading="lazy" src="https://lh3.googleusercontent.com/G0hN--Mazn4kyHK3O7cQdkql-z5oVezJHPZAqiR1Ijj5cwMnBJKVNNueezqF0TM4yzD9Z6igDt4=e14-rj-sc0xffffff-w1270" srcset="https://lh3.googleusercontent.com/G0hN--Mazn4kyHK3O7cQdkql-z5oVezJHPZAqiR1Ijj5cwMnBJKVNNueezqF0TM4yzD9Z6igDt4=e14-rj-sc0xffffff-w2540 2x"/>
</picture>
</div>
</div>
</div>
</div>
<div class="cws-content-block__content cws-grid__col--span-6 cws-grid__col--span-5-lg cws-grid__col--offset-1-lg cws-grid__col--align-center">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="             Overview" id="overview">
            Overview</h2>
<div class="cws-body cws-content-block__text">Certificate Authority
            Service is a highly available, scalable Google Cloud service that
            enables you to simplify, automate, and customize the deployment,
            management, and security of private certificate authorities (CA).
          </div>
</div>
</div>
</section>
<div class="cws-spacer--section cws-border--top cws-text-center" track-metadata-module="whats new" track-metadata-module_headline="whats new">
<div class="cws-spacer-5--bottom">
<h3 class="cws-headline--headline-4" data-text="What's new" id="whats-new">What's new</h3>
</div>
<div class="cws-background--grey cws-fullbleed cws-spacer--section">
<div style="max-width:1280px; margin: auto;">
<div class="cloud-carousel">
<div class="cloud-carousel__slide-deck-container">
<div class="cloud-carousel__slide-deck">
<div class="cloud-carousel__slide">
<div>
<p class="cws-label cws-spacer-2--bottom">Blog post</p>
<div class="cws-spacer-3--bottom">
<h5 class="cws-headline--headline-6" data-text="New whitepaper:                         Scaling certificate management with Certificate                         Authority Service" id="new-whitepaper:-scaling-certificate-management-with-certificate-authority-service">New whitepaper:
                        Scaling certificate management with Certificate
                        Authority Service</h5>
</div>
<div class="cws-spacer-3--bottom">
<a class="cws-button cws-button--low-emphasis" href="https://cloud.google.com/blog/products/identity-security/how-to-scale-certificate-management-with-google-cas-whitepaper" track-metadata-child_index="1" track-metadata-child_total="5" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/how-to-scale-certificate-management-with-google-cas-whitepaper" track-metadata-modifier="low-emphasis" track-name="read blog post" track-type="button">


      Read blog post
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-carousel__slide">
<div>
<p class="cws-label cws-spacer-2--bottom">Event</p>
<div class="cws-spacer-3--bottom">
<h5 class="cws-headline--headline-6" data-text="Leveraging                         Certificate Authority Service for Zero Trust" id="leveraging-certificate-authority-service-for-zero-trust">Leveraging
                        Certificate Authority Service for Zero Trust</h5>
</div>
<div class="cws-spacer-3--bottom">
<a class="cws-button cws-button--low-emphasis cws-button--icon-right" href="https://cloudonair.withgoogle.com/events/security-talks-december-2021?talk=leveraging-certificate-authority-zero-trust" rel="noopener" target="_blank" track-metadata-child_index="2" track-metadata-child_total="5" track-metadata-eventdetail="cloudonair.withgoogle.com/events/security-talks-december-2021" track-metadata-icon="new tab" track-metadata-modifier="low-emphasis" track-name="register" track-type="button">


      Register
      
      
        <span class="cws-button--icon">
<svg class="cws-icon" height="18px" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg>
</span>
</a>
</div>
</div>
</div>
<div class="cloud-carousel__slide">
<div>
<p class="cws-label cws-spacer-2--bottom">Event</p>
<div class="cws-spacer-3--bottom">
<h5 class="cws-headline--headline-6" data-text="Bringing BeyondProd                         to life with Google Cloud" id="bringing-beyondprod-to-life-with-google-cloud">Bringing BeyondProd
                        to life with Google Cloud</h5>
</div>
<div class="cws-spacer-3--bottom">
<a class="cws-button cws-button--low-emphasis cws-button--icon-right" href="https://cloudonair.withgoogle.com/events/security-talks-december-2021?talk=bringing-beyondprod-life-google-cloud" rel="noopener" target="_blank" track-metadata-child_index="3" track-metadata-child_total="5" track-metadata-eventdetail="cloudonair.withgoogle.com/events/security-talks-december-2021" track-metadata-icon="new tab" track-metadata-modifier="low-emphasis" track-name="register" track-type="button">


      Register
      
      
        <span class="cws-button--icon">
<svg class="cws-icon" height="18px" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg>
</span>
</a>
</div>
</div>
</div>
<div class="cloud-carousel__slide">
<div>
<p class="cws-label cws-spacer-2--bottom">Blog post</p>
<div class="cws-spacer-3--bottom">
<h5 class="cws-headline--headline-6" data-text="How to deploy                         Certificate Authority Service" id="how-to-deploy-certificate-authority-service">How to deploy
                        Certificate Authority Service</h5>
</div>
<div class="cws-spacer-3--bottom">
<a class="cws-button cws-button--low-emphasis" href="https://cloud.google.com/blog/products/identity-security/how-to-deploy-google-cas-whitepaper" track-metadata-child_index="4" track-metadata-child_total="5" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/how-to-deploy-google-cas-whitepaper" track-metadata-modifier="low-emphasis" track-name="read blog post" track-type="button">


      Read blog post
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-carousel__slide">
<div>
<p class="cws-label cws-spacer-2--bottom">Blog post</p>
<div class="cws-spacer-3--bottom">
<h5 class="cws-headline--headline-6" data-text="CA Service is now GA!                       " id="ca-service-is-now-ga">CA Service is now GA!
                      </h5>
</div>
<div class="cws-spacer-3--bottom">
<a class="cws-button cws-button--low-emphasis" href="https://cloud.google.com/blog/products/identity-security/google-cloud-certificate-authority-service-is-now-ga" track-metadata-child_index="5" track-metadata-child_total="5" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/google-cloud-certificate-authority-service-is-now-ga" track-metadata-modifier="low-emphasis" track-name="read blog post" track-type="button">


      Read blog post
      
    
      </a>
</div>
</div>
</div>
</div>
</div>
<div class="cloud-carousel__controls">
<div class="cloud-carousel__arrow left-arrow">
<img alt="" src="https://www.gstatic.com/images/icons/material/system/2x/keyboard_arrow_left_black_36dp.png"/>
</div>
<div class="cloud-carousel__arrow right-arrow">
<img alt="" src="https://www.gstatic.com/images/icons/material/system/2x/keyboard_arrow_right_black_36dp.png"/>
</div>
<div class="cloud-carousel__nuggets cws-spacer-3--bottom">
<div class="cloud-carousel__nugget"></div>
</div>
</div>
</div>
</div>
</div>
</div>
<section class="cws-spacer-6--bottom" track-metadata-module="benefits">
<div class="cws-grid">
<div class="cws-grid cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__asset">
<div class="cws-icon">
<picture>
<source srcset="https://lh3.googleusercontent.com/W_rvEg4p6rN5_WtskXz-wf4pl-F5irTGOygPGhxA1AtA_4nvGvCAvDqCmEJLVAjy_4gTMvK04JnZ=e14-rw-lo-sc0xffffff-w92 1x,https://lh3.googleusercontent.com/W_rvEg4p6rN5_WtskXz-wf4pl-F5irTGOygPGhxA1AtA_4nvGvCAvDqCmEJLVAjy_4gTMvK04JnZ=e14-rw-lo-sc0xffffff-w184 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/W_rvEg4p6rN5_WtskXz-wf4pl-F5irTGOygPGhxA1AtA_4nvGvCAvDqCmEJLVAjy_4gTMvK04JnZ=e14-rj-sc0xffffff-w92 1x,https://lh3.googleusercontent.com/W_rvEg4p6rN5_WtskXz-wf4pl-F5irTGOygPGhxA1AtA_4nvGvCAvDqCmEJLVAjy_4gTMvK04JnZ=e14-rj-sc0xffffff-w184 2x" type="image/jpeg"/>
<img alt="Icon of cloud on monitor screen in a blue circle " class="" loading="lazy" src="https://lh3.googleusercontent.com/W_rvEg4p6rN5_WtskXz-wf4pl-F5irTGOygPGhxA1AtA_4nvGvCAvDqCmEJLVAjy_4gTMvK04JnZ=e14-rj-sc0xffffff-w92" srcset="https://lh3.googleusercontent.com/W_rvEg4p6rN5_WtskXz-wf4pl-F5irTGOygPGhxA1AtA_4nvGvCAvDqCmEJLVAjy_4gTMvK04JnZ=e14-rj-sc0xffffff-w184 2x"/>
</picture>
</div>
</div>
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Simpler deployment and management" id="simpler-deployment-and-management">
                  Simpler deployment and management</h4>
<div class="cws-body cws-content-block__text">
<p>Simplify the deployment, management, and security of your
                    enterprise PKI with a cloud service that helps to automate
                    time-consuming, risky, and error-prone infrastructure tasks,
                    freeing you to focus on higher-value projects.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__asset">
<div class="cws-icon">
<picture>
<source srcset="https://lh3.googleusercontent.com/JhUlJydtagedsMBY5x5LuVFM2vMBWIFfymiXlgNJ6gOWuZ6cCjPu2GO9KKxyaaywyWWyep9a_JTt=e14-rw-lo-sc0xffffff-w92 1x,https://lh3.googleusercontent.com/JhUlJydtagedsMBY5x5LuVFM2vMBWIFfymiXlgNJ6gOWuZ6cCjPu2GO9KKxyaaywyWWyep9a_JTt=e14-rw-lo-sc0xffffff-w184 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/JhUlJydtagedsMBY5x5LuVFM2vMBWIFfymiXlgNJ6gOWuZ6cCjPu2GO9KKxyaaywyWWyep9a_JTt=e14-rj-sc0xffffff-w92 1x,https://lh3.googleusercontent.com/JhUlJydtagedsMBY5x5LuVFM2vMBWIFfymiXlgNJ6gOWuZ6cCjPu2GO9KKxyaaywyWWyep9a_JTt=e14-rj-sc0xffffff-w184 2x" type="image/jpeg"/>
<img alt="Icon of blue circle with gears and a shield inset with a ribbon, on a document " class="" loading="lazy" src="https://lh3.googleusercontent.com/JhUlJydtagedsMBY5x5LuVFM2vMBWIFfymiXlgNJ6gOWuZ6cCjPu2GO9KKxyaaywyWWyep9a_JTt=e14-rj-sc0xffffff-w92" srcset="https://lh3.googleusercontent.com/JhUlJydtagedsMBY5x5LuVFM2vMBWIFfymiXlgNJ6gOWuZ6cCjPu2GO9KKxyaaywyWWyep9a_JTt=e14-rj-sc0xffffff-w184 2x"/>
</picture>
</div>
</div>
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Tailored for you" id="tailored-for-you">
                  Tailored for you</h4>
<div class="cws-body cws-content-block__text">
<p>Customize Certificate Authority Service to your needs by
                    configuring custom CAs and certificates, enforcing granular
                    access controls, automating common tasks with APIs, and
                    integrating with your existing systems.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__asset">
<div class="cws-icon">
<picture>
<source srcset="https://lh3.googleusercontent.com/jMk0X5N2Wwf2HmYVTO7nZqzuQz7LK985zDkKRvcmOIdHWq7ZXmYxu7SiEpRtO1EJFjIYF7VNGvJoxg=e14-rw-lo-sc0xffffff-w92 1x,https://lh3.googleusercontent.com/jMk0X5N2Wwf2HmYVTO7nZqzuQz7LK985zDkKRvcmOIdHWq7ZXmYxu7SiEpRtO1EJFjIYF7VNGvJoxg=e14-rw-lo-sc0xffffff-w184 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/jMk0X5N2Wwf2HmYVTO7nZqzuQz7LK985zDkKRvcmOIdHWq7ZXmYxu7SiEpRtO1EJFjIYF7VNGvJoxg=e14-rj-sc0xffffff-w92 1x,https://lh3.googleusercontent.com/jMk0X5N2Wwf2HmYVTO7nZqzuQz7LK985zDkKRvcmOIdHWq7ZXmYxu7SiEpRtO1EJFjIYF7VNGvJoxg=e14-rj-sc0xffffff-w184 2x" type="image/jpeg"/>
<img alt="Icon of a blue circle with office buildings, a security shield in the upper left, and a magnifying glass in the lower right" class="" loading="lazy" src="https://lh3.googleusercontent.com/jMk0X5N2Wwf2HmYVTO7nZqzuQz7LK985zDkKRvcmOIdHWq7ZXmYxu7SiEpRtO1EJFjIYF7VNGvJoxg=e14-rj-sc0xffffff-w92" srcset="https://lh3.googleusercontent.com/jMk0X5N2Wwf2HmYVTO7nZqzuQz7LK985zDkKRvcmOIdHWq7ZXmYxu7SiEpRtO1EJFjIYF7VNGvJoxg=e14-rj-sc0xffffff-w184 2x"/>
</picture>
</div>
</div>
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Enterprise-ready" id="enterprise-ready">
                  Enterprise-ready</h4>
<div class="cws-body cws-content-block__text">
<p>Have peace of mind knowing that your CA service is highly
                    available, scalable, backed by an
                    <a class="cws-link" href="https://cloud.google.com/certificate-authority-service/sla" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/sla" track-name="sla" track-type="content block">SLA</a>,
                    auditable, and ready to help you achieve compliance with
                    advanced hardware and software security controls.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<style>
      .cloud-diagram__spacer {
        margin-bottom: 56px;
      }

      .cloud-diagram__spacer:last-child {
        margin-bottom: 0;
      }
    </style>
<section class="cws-spacer--section cws-border--top cws-text-center" track-metadata-module="product demo" track-metadata-module_headline="product demonstrations">
<div class="cws-grid cws-grid__no-gap">
<div class="cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<div class="cloud-diagram">
<div class="cloud-diagram__graph">
<header class="cws-spacer-5--bottom">
<h2 class="cws-headline--headline-3" data-text=" Product demonstrations                 " id="product-demonstrations"> Product demonstrations
                </h2>
<div class="cws-spacer-2--top cws-spacer-2--bottom richtext">The
                  section shows use-case specific demos for Certificate
                  Authority Service.</div>
</header>
<div class="cloud-diagram__spacer">
<div>
<div class="cws-spacer-4--bottom">
<h3 class="cws-headline--headline-4" data-text="Set up a CA in seconds                     " id="set-up-a-ca-in-seconds">Set up a CA in seconds
                    </h3>
<div class="cws-spacer-2--top cws-spacer-2--bottom richtext">
                      The demo video shows that Certificate Authority Service
                      can be used to create a CA very quickly.</div>
</div>
<a aria-label="CAS setup and demo" class="lb lb-play-overlay lb-play-button-80" data-lightbox-height="394" data-lightbox-index="0" data-lightbox-width="700" href="https://www.youtube.com/watch?v=5Ni0EhJlae8" target="_blank" track-metadata-eventdetail="https://img.youtube.com/vi/5Ni0EhJlae8" track-metadata-icon="https://img.youtube.com/vi/5Ni0EhJlae8/hqdefault.jpg" track-metadata-module="Set up a CA in seconds" track-metadata-module_headline="Set up a CA in seconds" track-metadata-position="body" track-metadata-video_id="5Ni0EhJlae8" track-name="Set up a CA in seconds" track-type="video">
<img alt="CAS setup and demo" src="https://img.youtube.com/vi/5Ni0EhJlae8/hqdefault.jpg"/>
</a>
<p>CA Service setup</p>
<div class="cws-small-text"></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<div class="cws-spacer--section cws-border--top">
<div class="cws-spacer-5--bottom cws-grid" track-metadata-module="features" track-metadata-module_headline="features">
<div class="cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<div class="cws-content-block cws-content-block--centered">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                 Features" id="features">
                Features</h2>
</div>
</div>
</div>
</div>
<section class="cws-grid">
<div class="cws-grid cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Deploy in minutes" id="deploy-in-minutes">
                  Deploy in minutes</h3>
<div class="cws-body cws-content-block__text">
<p>Create a private CA in minutes versus the days and weeks
                    that it takes to deploy and operate your own CA. Leverage
                    descriptive RESTful APIs to acquire and manage certificates
                    without being a PKI expert.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Focus on higher-value tasks" id="focus-on-higher-value-tasks">
                  Focus on higher-value tasks</h3>
<div class="cws-body cws-content-block__text">
<p>Offload time-consuming tasks like hardware provisioning,
                    infrastructure security, software deployment,
                    high-availability configuration, disaster recovery, backups,
                    and more to the cloud.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Pay-as-you-go or subscribe" id="pay-as-you-go-or-subscribe">
                  Pay-as-you-go or subscribe</h3>
<div class="cws-body cws-content-block__text">
<p>Help lower your total cost of ownership and simplify
                    licensing with pay-as-you-go pricing and zero capital
                    expenditures. Pay only for what you use. Also, for high
                    volume certificates, consider subscription for even less
                    expensive alternatives.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Customize to your needs" id="customize-to-your-needs">
                  Customize to your needs</h3>
<div class="cws-body cws-content-block__text">
<p>Scale from simple to advanced use cases by configuring the
                    root CA (e.g. existing on-premises or cloud), custom key
                    sizes and algorithms, location (region) of the CA, bring
                    your own cloud KMS key, and more. Manage, automate, and
                    integrate private CAs and certificates in the way that’s
                    most convenient for you: via APIs, gcloud command line, or
                    cloud console.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Support compliance with various regulations" id="support-compliance-with-various-regulations">
                  Support compliance with various regulations</h3>
<div class="cws-body cws-content-block__text">
<p>Have confidence that your CAs are approved as part of ISO
                    27001, 27017, 27018, SOC1, SOC2, SOC3, BSI C5, and PCI DSS.
                  </p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Enforce granular access controls" id="enforce-granular-access-controls">
                  Enforce granular access controls</h3>
<div class="cws-body cws-content-block__text">
<p>Define granular, context-aware access controls and virtual
                    security perimeters for CA Service with
                    <a class="cws-link" href="https://cloud.google.com/iam" track-metadata-eventdetail="cloud.google.com/iam" track-name="cloud iam" track-type="content block">Cloud IAM</a>
                    and
                    <a class="cws-link" href="https://cloud.google.com/vpc-service-controls" track-metadata-eventdetail="cloud.google.com/vpc-service-controls" track-name="vpc service controls" track-type="content block">VPC Service Controls</a>.
                    Leverage certificate templates and per user-group policies
                    to achieve even more granular control over certificate
                    issuance.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Protect your keys in an HSM" id="protect-your-keys-in-an-hsm">
                  Protect your keys in an HSM</h3>
<div class="cws-body cws-content-block__text">
<p>Store your CA keys using
                    <a class="cws-link" href="https://cloud.google.com/hsm" track-metadata-eventdetail="cloud.google.com/hsm" track-name="cloud hsm" track-type="content block">Cloud HSM</a>,
                    which is FIPS 140-2 Level 3 validated and available in
                    <a class="cws-link" href="https://cloud.google.com/kms/docs/locations" track-metadata-eventdetail="cloud.google.com/kms/docs/locations" track-name="regions" track-type="content block">regions</a>
                    across the Americas, Europe, and Asia Pacific.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Audit user activity" id="audit-user-activity">
                  Audit user activity</h3>
<div class="cws-body cws-content-block__text">
<p>Obtain tamper-proof logs and gain visibility into who did
                    what, when, and where with
                    <a class="cws-link" href="https://cloud.google.com/audit-logs" track-metadata-eventdetail="cloud.google.com/audit-logs" track-name="cloud audit logs" track-type="content block">Cloud Audit Logs</a>.
                  </p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-5 cws-content-block__headline" data-text="                   Scale with confidence" id="scale-with-confidence">
                  Scale with confidence</h3>
<div class="cws-body cws-content-block__text">
<p>Scale with confidence knowing that the service provides
                    high query throughput, can issue millions of certificates,
                    and comes with an enterprise-grade
                    <a class="cws-link" href="https://cloud.google.com/certificate-authority-service/sla" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/sla" track-name="sla" track-type="content block">SLA</a>.
                    Scale even higher by grouping a few CAs under a CA pool and
                    let Google load balance certificate requests across
                    them </p>
</div>
</div>
</div>
</div>
</div>
</section>
</div>
<style>
      .logo-module .cws-logo-garden:not(.cws-logo-garden__interactive) .cws-logo-garden__list-item:nth-child(n+11) {
        display: none;
      }
    </style>
<section class="cws-spacer--section cws-border--top" track-metadata-module="customer logos" track-metadata-module_headline="our customers">
<div class="cws-spacer-5--bottom cws-text-center cws-grid">
<div class="cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<h2 class="cws-headline--headline-4" data-text="Our customers" id="our-customers">Our customers</h2>
<span class="cws-body richtext">
<p>Click below to learn how our customers are using Certificate
              Authority Service in their environments.</p>
</span>
</div>
</div>
<div class="cws-logo-garden cws-logo-garden__interactive cws-logo-garden--no-border">
<ul class="cws-logo-garden__list">
<li class="cws-logo-garden__list-item">
<a aria-label="Goldman Sachs logo" class="lb" data-lightbox-height="506" data-lightbox-width="900" href="https://www.youtube.com/watch?v=ihvp8tGPItE&amp;t=534" rel="noopener" target="_blank" track-metadata-eventdetail="www.youtube.com/watch" track-metadata-module="customer logos" track-metadata-module_headline="our customers" track-name="goldman sachs logo" track-type="logo garden">
<img alt="Goldman Sachs logo" class="" loading="lazy" src="https://lh3.googleusercontent.com/fAL58iV7iQzNS3dbKagduNPqw8DKpN2XTSRDgp2EejfQBtLs45EGbGsD2iDJm3WRQU-I2oTcWUFD=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/fAL58iV7iQzNS3dbKagduNPqw8DKpN2XTSRDgp2EejfQBtLs45EGbGsD2iDJm3WRQU-I2oTcWUFD=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
<li class="cws-logo-garden__list-item">
<a aria-label="Commerzbank logo" class="lb" data-lightbox-height="506" data-lightbox-width="900" href="https://www.youtube.com/watch?v=_5uoMQeeevM&amp;t=569" rel="noopener" target="_blank" track-metadata-eventdetail="www.youtube.com/watch" track-metadata-module="customer logos" track-metadata-module_headline="our customers" track-name="commerzbank logo" track-type="logo garden">
<img alt="Commerzbank logo" class="" loading="lazy" src="https://lh3.googleusercontent.com/7j0nwX_DhLVIMkreS9UDu5lLboZ8YISwTTQc37og2XMFtmgRCbwokUPFWILffAuk8InAAsjdki4=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/7j0nwX_DhLVIMkreS9UDu5lLboZ8YISwTTQc37og2XMFtmgRCbwokUPFWILffAuk8InAAsjdki4=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
</ul>
</div>
<div class="cws-text-center cws-spacer-4--top">
<a class="cws-button cws-button--low-emphasis" href="https://cloud.google.com/customers" track-metadata-eventdetail="cloud.google.com/customers" track-metadata-modifier="low-emphasis" track-name="see more customers" track-type="button">


      See more customers
      
    
      </a>
</div>
</section>
<style>
      .logo-module .cws-logo-garden:not(.cws-logo-garden__interactive) .cws-logo-garden__list-item:nth-child(n+11) {
        display: none;
      }
    </style>
<section class="cws-spacer--section cws-border--top" track-metadata-module="partners" track-metadata-module_headline="partners">
<div class="cws-spacer-5--bottom cws-text-center cws-grid">
<div class="cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<h2 class="cws-headline--headline-4" data-text="Partners" id="partners">Partners</h2>
<span class="cws-body richtext">
<p>Migrate your on-premises PKI to cloud leveraging our partner
              solutions that integrate with Certificate Authority Service.</p>
</span>
</div>
</div>
<div class="cws-logo-garden cws-logo-garden__interactive cws-logo-garden--no-border">
<ul class="cws-logo-garden__list">
<li class="cws-logo-garden__list-item">
<a aria-label="Venafi" href="http://www.venafi.com" rel="noopener" target="_blank" track-metadata-eventdetail="www.venafi.com" track-metadata-module="partners" track-metadata-module_headline="partners" track-name="venafi" track-type="logo garden">
<img alt="Venafi" class="" loading="lazy" src="https://lh3.googleusercontent.com/KnFyFT4voMuxjlQ4d3NlqO3gyjI706blzowQSVM59IsKAyxwstKz1mOADj8BuEzT_1viAifTOn1R=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/KnFyFT4voMuxjlQ4d3NlqO3gyjI706blzowQSVM59IsKAyxwstKz1mOADj8BuEzT_1viAifTOn1R=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
<li class="cws-logo-garden__list-item">
<a aria-label="AppViewX" href="https://www.appviewx.com" rel="noopener" target="_blank" track-metadata-eventdetail="www.appviewx.com" track-metadata-module="partners" track-metadata-module_headline="partners" track-name="appviewx" track-type="logo garden">
<img alt="AppViewX" class="" loading="lazy" src="https://lh3.googleusercontent.com/TRVwspbajzo6uYddYjE6toRtNGixn-BaYnZtRJMuvx0nMpHcDCRH5D3yPxWkFjFn6lQJ-xCLYOM=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/TRVwspbajzo6uYddYjE6toRtNGixn-BaYnZtRJMuvx0nMpHcDCRH5D3yPxWkFjFn6lQJ-xCLYOM=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
<li class="cws-logo-garden__list-item">
<a aria-label="Jetstack" href="https://www.jetstack.io" rel="noopener" target="_blank" track-metadata-eventdetail="www.jetstack.io" track-metadata-module="partners" track-metadata-module_headline="partners" track-name="jetstack" track-type="logo garden">
<img alt="Jetstack" class="" loading="lazy" src="https://lh3.googleusercontent.com/CRoo8xKmqfi6vnPZgCDHZOSWH8s5HdtxrF1vO7cfIQV2R4jNpcvTD4NXJPuivnqZ7K_f4Qh5R78qXQ=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/CRoo8xKmqfi6vnPZgCDHZOSWH8s5HdtxrF1vO7cfIQV2R4jNpcvTD4NXJPuivnqZ7K_f4Qh5R78qXQ=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
<li class="cws-logo-garden__list-item">
<a aria-label="Keyfactor" href="https://www.keyfactor.com/" rel="noopener" target="_blank" track-metadata-eventdetail="www.keyfactor.com/" track-metadata-module="partners" track-metadata-module_headline="partners" track-name="keyfactor" track-type="logo garden">
<img alt="Keyfactor" class="" loading="lazy" src="https://lh3.googleusercontent.com/neQqC60ch9qXPW5WdMhXyXawuyrMar19rCaGgPJWa9Jsg8Okk5fnCsM_ongByTybSuy8aluDqtU=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/neQqC60ch9qXPW5WdMhXyXawuyrMar19rCaGgPJWa9Jsg8Okk5fnCsM_ongByTybSuy8aluDqtU=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
<li class="cws-logo-garden__list-item">
<a aria-label="Smallstep" href="https://smallstep.com/" rel="noopener" target="_blank" track-metadata-eventdetail="smallstep.com/" track-metadata-module="partners" track-metadata-module_headline="partners" track-name="smallstep" track-type="logo garden">
<img alt="Smallstep" class="" loading="lazy" src="https://lh3.googleusercontent.com/BJ_At1bi486eMxjwoZtfTwrd1kyF-0--CdEqrQIvHsXadDLy2PObt4pO2kFwW44QdWgNdYHgZCmaBQ=e14-rj-sc0xffffff-w160" srcset="https://lh3.googleusercontent.com/BJ_At1bi486eMxjwoZtfTwrd1kyF-0--CdEqrQIvHsXadDLy2PObt4pO2kFwW44QdWgNdYHgZCmaBQ=e14-rj-sc0xffffff-w320 2x"/>
</a>
</li>
</ul>
</div>
<div class="cws-text-center cws-spacer-4--top">
<a class="cws-button cws-button--low-emphasis" href="https://cloud.withgoogle.com/partners" rel="noopener" target="_blank" track-metadata-eventdetail="cloud.withgoogle.com/partners" track-metadata-modifier="low-emphasis" track-name="see all google cloud partners" track-type="button">


      See all Google Cloud partners
      
    
      </a>
</div>
</section>
<div class="cws-spacer--section cws-border--top" track-metadata-module="technical resources" track-metadata-module_headline="documentation">
<div class="cws-spacer-5--bottom cws-text-center cws-grid">
<div class="cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<h2 class="cws-headline--headline-4" data-text="             Documentation " id="resources-and-integrations">
            Documentation </h2>
<div class="cws-spacer-2--top cws-spacer-2--bottom richtext">
<a class="cws-link" href="https://cloud.google.com/certificate-authority-service/docs" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/docs" track-name="view all product documentation" track-type="inline link">View all product documentation</a>
</div>
</div>
</div>
<ul class="cws-grid cws-cards cws-cards--compact">
<li class="cws-grid__col--span-4">
<a class="cws-card" href="https://cloud.google.com/certificate-authority-service/docs/how-to" track-metadata-child_headline="how-to guides" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/docs/how-to" track-metadata-module="technical resources" track-metadata-parent_type="technical resources" track-metadata-position="technical resources" track-name="how-to guides" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--icon cws-card__asset--icon-small">
</div>
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-5">How-to guides </p>
<div class="cws-body">Review CA Service how-to guides.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          View documentation
        </span>
</div>
</div>
</a>
</li>
<li class="cws-grid__col--span-4">
<a class="cws-card" href="https://cloud.google.com/certificate-authority-service/docs/create-certificate" track-metadata-child_headline="quickstart" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/docs/create-certificate" track-metadata-module="technical resources" track-metadata-parent_type="technical resources" track-metadata-position="technical resources" track-name="quickstart" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--icon cws-card__asset--icon-small">
<img alt="" class="" loading="lazy" src="https://kstatic.googleusercontent.com/files/0e9dc0aa937761f8c5daa07beddf8ef4c79931a6f68592b0b817b46664ddcc54ea3d8c3d32ccfc52f61ac5d7446dc3fea634315eb6560e70158a01e6bfb79869"/>
</div>
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-5">Quickstart</p>
<div class="cws-body">Get started by creating a certificate authority (CA) pool and issuing a certificate.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          View quickstart
        </span>
</div>
</div>
</a>
</li>
<li class="cws-grid__col--span-4">
<a class="cws-card" href="https://cloud.google.com/certificate-authority-service/docs/best-practices" track-metadata-child_headline="best practices" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/docs/best-practices" track-metadata-module="technical resources" track-metadata-parent_type="technical resources" track-metadata-position="technical resources" track-name="best practices" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--icon cws-card__asset--icon-small">
<img alt="" class="" loading="lazy" src="https://kstatic.googleusercontent.com/files/0e9dc0aa937761f8c5daa07beddf8ef4c79931a6f68592b0b817b46664ddcc54ea3d8c3d32ccfc52f61ac5d7446dc3fea634315eb6560e70158a01e6bfb79869"/>
</div>
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-5">Best practices</p>
<div class="cws-body">View best practices that can help you use Certificate Authority Service more effectively.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</li>
</ul>
</div>
<style>
      .cloud-pricing__table .cloud-table {
        table-layout: auto;
      }
    </style>
<section class="cloud-pricing cloud-pricing--simple cws-border--top" track-metadata-module="pricing" track-metadata-module_headline="pricing">
<div class="cws-grid">
<div class="cws-grid__col--span-12 cws-grid__col--span-10-lg cws-grid__col--offset-1-lg">
<div class="cloud-pricing__header">
<h3 class="cws-headline--headline-4 cws-text-center" data-text="Pricing" id="pricing">Pricing</h3>
</div>
<div class="cloud-pricing__text-body">
<span class="cws-body richtext">
<p>There are two pricing options available: pay-as-you-go and
                subscription. If you plan to deploy more than 1 million
                certificates per year, consider our subscription model for more
                attractive pricing. </p>
<p>
<a class="cws-link" href="https://cloud.google.com/certificate-authority-service/pricing" track-metadata-eventdetail="cloud.google.com/certificate-authority-service/pricing" track-name="view pricing details" track-type="inline link">View pricing details</a>
</p>
</span>
</div>
</div>
</div>
</section>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<section class="cloud-jump-section cws-fullbleed cws-background--grey" data-cloud-main-text="Take the next step" id="take-the-next-step" track-metadata-module="take the next step" track-metadata-position="bottom">
<div class="cws-page">
<div class="cloud-section--large cws-grid">
<style>
                .next-steps-headline {
                  margin-bottom: 28px;
                }
              </style>
<div class="cws-grid__col--span-6 cws-grid__col--offset-1">
<div class="next-steps-headline">
<h2 class="cws-headline--headline-4" data-text="Take the next step" id="take-the-next-step">Take the next step</h2>
</div>
<div class="cws-spacer-4--bottom">
<p class="cws-body--large">Start building on Google Cloud with
                    $300 in free credits and 20+ always free products.</p>
</div>
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/freetrial" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/freetrial" track-metadata-modifier="high-emphasis" track-name="try it free" track-type="button">


      Try it free
      
    
      </a>
</div>
</div>
<style>
                .next-steps-divider {
                  border-right: 2px solid #e8eaed;
                }
              </style>
<div class="cws-grid__col--span-1 cws-grid__col--offset-7 next-steps-divider">
</div>
<style>
                .next-steps-column-2-container {
                  padding: 4px 0 9px 0;
                }

                .next-steps-column-2-cta {
                  font-size: 16px;
                  line-height: 26px;
                }

                .next-steps-column-2-cta:not(:last-child) {
                  margin-bottom: 36px;
                }

                .next-steps-column-2-cta-link {
                  line-height: 0;
                  margin-top: 8px;
                }
              </style>
<div class="cws-grid__col--span-4 cws-grid__col--offset-8 next-steps-column-2-container">
<div class="cws-headline--headline-6 next-steps-column-2-cta">
                  Need help getting started? <div class="next-steps-column-2-cta-link">
<a class="cws-link-independent" href="https://cloud.google.com/contact/" track-metadata-eventdetail="cloud.google.com/contact/" track-name="contact sales" track-type="next step link">
              Contact sales
            </a>
</div>
</div>
<div class="cws-headline--headline-6 next-steps-column-2-cta">
                  Work with a trusted partner <div class="next-steps-column-2-cta-link">
<a class="cws-link-independent" href="https://cloud.withgoogle.com/partners/" rel="noopener" target="_blank" track-metadata-eventdetail="cloud.withgoogle.com/partners/" track-name="find a partner" track-type="next step link">
              Find a partner
            </a>
</div>
</div>
<div class="cws-headline--headline-6 next-steps-column-2-cta">
                  Continue browsing <div class="next-steps-column-2-cta-link">
<a class="cws-link-independent" href="https://cloud.google.com/products/" track-metadata-eventdetail="cloud.google.com/products/" track-name="see all products" track-type="next step link">
              See all products
            </a>
</div>
</div>
</div>
</div>
</div>
</section>
</slot>
<slot slot="ineligible">
<section class="cloud-jump-section cws-fullbleed cws-background--grey" data-cloud-main-text="Take the next step" id="take-the-next-step" track-metadata-module="take the next step" track-metadata-position="bottom">
<div class="cws-page">
<div class="cloud-section--large cws-grid">
<style>
                .next-steps-headline {
                  margin-bottom: 28px;
                }
              </style>
<div class="cws-grid__col--span-6 cws-grid__col--offset-1">
<div class="next-steps-headline">
<h2 class="cws-headline--headline-4" data-text="Take the next step" id="take-the-next-step_1">Take the next step</h2>
</div>
<div class="cws-spacer-4--bottom">
<p class="cws-body--large">Simplify the deployment and
                    management of private CAs without managing infrastructure.
                  </p>
</div>
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/security/cas" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/security/cas" track-metadata-modifier="high-emphasis" track-name="go to console" track-type="button">


      Go to console
      
    
      </a>
</div>
</div>
<style>
                .next-steps-divider {
                  border-right: 2px solid #e8eaed;
                }
              </style>
<div class="cws-grid__col--span-1 cws-grid__col--offset-7 next-steps-divider">
</div>
<style>
                .next-steps-column-2-container {
                  padding: 4px 0 9px 0;
                }

                .next-steps-column-2-cta {
                  font-size: 16px;
                  line-height: 26px;
                }

                .next-steps-column-2-cta:not(:last-child) {
                  margin-bottom: 36px;
                }

                .next-steps-column-2-cta-link {
                  line-height: 0;
                  margin-top: 8px;
                }
              </style>
<div class="cws-grid__col--span-4 cws-grid__col--offset-8 next-steps-column-2-container">
<div class="cws-headline--headline-6 next-steps-column-2-cta">
                  Need help getting started? <div class="next-steps-column-2-cta-link">
<a class="cws-link-independent" href="https://cloud.google.com/contact/" track-metadata-eventdetail="cloud.google.com/contact/" track-name="contact sales" track-type="next step link">
              Contact sales
            </a>
</div>
</div>
<div class="cws-headline--headline-6 next-steps-column-2-cta">
                  Work with a trusted partner <div class="next-steps-column-2-cta-link">
<a class="cws-link-independent" href="https://cloud.withgoogle.com/partners/" rel="noopener" target="_blank" track-metadata-eventdetail="cloud.withgoogle.com/partners/" track-name="find a partner" track-type="next step link">
              Find a partner
            </a>
</div>
</div>
<div class="cws-headline--headline-6 next-steps-column-2-cta">
                  Get tips &amp; best practices <div class="next-steps-column-2-cta-link">
<a class="cws-link-independent" href="https://cloud.google.com/docs/tutorials" track-metadata-eventdetail="cloud.google.com/docs/tutorials" track-name="see tutorials" track-type="next step link">
              See tutorials
            </a>
</div>
</div>
</div>
</div>
</div>
</section>
</slot>
</cloudx-free-trial-eligible-content>
</article>
<!--&#123;# Page published by Bricks, request id 4548649868213962932} #}-->
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/best-practices]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Best practices for Certificate Authority Service" id="best-practices-for-certificate-authority-service">Best practices for Certificate Authority Service</h1>
<p>This topic outlines some of the best practices that can help you use Certificate Authority Service more effectively.</p>
<h2 data-text="Roles and access control" id="roles">Roles and access control</h2>
<p>Using Identity and Access Management (IAM), you can grant roles to users. Roles are a bundle of one or more permissions. Roles in IAM can either be basic, predefined, or custom.</p>
<table>
<thead>
<tr>
<th>IAM role type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Basic</td>
<td>Includes the Owner, Editor, and Viewer roles that existed before the introduction of IAM.</td>
</tr>
<tr>
<td>Predefined</td>
<td>Predefined roles are created and maintained by Google.</td>
</tr>
<tr>
<td>Custom</td>
<td>Custom roles are user-defined, and let you bundle one or more supported permissions to meet your specific needs. For more information, see <a href="/iam/docs/understanding-custom-roles">Understanding custom roles</a>.</td>
</tr>
</tbody>
</table>
<p>Individuals shouldn't be assigned more than one role at any given time. In addition, everyone holding an assigned role should be properly briefed and trained on their responsibilities and security practices. If you want to assign a diverse set of permissions to an individual, we recommend that you create a custom role using IAM. For information about creating a custom role, see <a href="/iam/docs/creating-custom-roles">Creating and managing custom roles</a>.</p>
<p>For information about permissions and predefined IAM roles, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and roles</a>.</p>
<h2 data-text="CA Service tiers" id="tiers">CA Service tiers</h2>
<p>Tiers are set for the certificate authority (CA) pool. All CAs in a CA pool are assigned the same tier. CA Service provides two operational service tiers for CA pools: DevOps and Enterprise. These two tiers provide organizations with a balance of performance and lifecycle management capabilities based on operational requirements.</p>
<ul>
<li>We recommend that you carefully consider using the DevOps tier because it doesn't support certificate revocation.</li>
<li>For CAs in the DevOps tier, issued certificates are not stored. You can only track certificates by reviewing <a href="/logging/docs/audit">Cloud Audit Logs</a>, if enabled. We recommend that you use the DevOps tier only for short-lived certificates that don't need to be revoked, such as certificates used with microservices, containers, session certificates, non-persistent virtual machines, and other isolated needs.</li>
<li>A Public Key Infrastructure (PKI) can consist of a combination of CAs in DevOps and Enterprise tiers to meet various needs.</li>
<li>In most cases, we recommend that you use the Enterprise tier to create CA pools that issue certificates to other CAs and end-entities.</li>
</ul>
<p>For more information about CA Service tiers, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</p>
<p>For information about enabling Cloud Audit Logs, see <a href="/logging/docs/audit/configure-data-access">Configuring Data Access audit logs</a>.</p>
<h2 data-text="CA signing keys" id="ca-signing-keys">CA signing keys</h2>
<p>The proper control of the underlying cryptographic key pair for CA certificates determines the security and integrity afforded by the PKI. This section lists some best practices for securing CA signing keys.</p>
<h3 data-text="Hardware Security Modules (HSM)" id="hsm">Hardware Security Modules (HSM)</h3>
<p>You can configure CA Service to use Google-managed keys that leverage Cloud HSM for generating, storing, and using keys. However, if you want to use your own key or leverage another key stored in Cloud KMS, you can use the key during the setup of the CA.</p>
<p>For more information about Cloud HSM, see <a href="/kms/docs/hsm">Cloud HSM</a>.</p>
<aside class="note"><strong>Note:</strong><span> After you create or import a key to Cloud HSM, it is not possible to export that key and migrate to another platform.</span></aside>
<p>For more information about importing a cryptographic key into Cloud HSM or Cloud KMS, see <a href="/kms/docs/importing-a-key">Importing a key into Cloud KMS</a>.</p>
<h3 data-text="Google-managed vs Customer-managed keys" id="customer-managed-keys">Google-managed vs Customer-managed keys</h3>
<p>If you don't have a custom security or operational requirement that requires direct management of keys outside of CA Service, we recommend that you use Google-managed keys. Google-managed keys provide a simplified and secure-by-default key generation, storage, and utilization system.</p>
<p>Google-managed keys use Cloud HSM and aren't accessible or usable by any other organization. Access and use of Cloud HSM signing keys are auditable through Cloud Audit Logs.</p>
<aside class="note"><strong>Note:</strong><span> CA keys are only used for signing issued certificates. They are not used for encrypting information on CA Service.</span></aside>
<p>For more information about lifecycle management models, see <a href="/certificate-authority-service/docs/managed-resources">Managed resources</a>.</p>
<h3 data-text="Importing external CAs" id="import-external">Importing external CAs</h3>
<p>It isn't possible to import previously issued certificates into CA Service. We recommend that you don't import an existing external CA with issued certificates into CA Service.</p>
<h3 data-text="Key Escrow" id="escrow">Key Escrow</h3>
<p>CA Service uses Cloud KMS and Cloud HSM to protect keys from export and extraction. If your organization wants to maintain a copy of its CA keys, you can generate keys using on-premises tools. To use those keys with CA Service, import the keys to Cloud KMS and Cloud HSM. You can then safely escrow the keys and maintain possession until needed in future.</p>
<p>For information about importing keys into Cloud KMS, see <a href="/kms/docs/importing-a-key">Importing a key into Cloud KMS</a>.</p>
<h3 data-text="CA key sizes and algorithms" id="ca-key-algorithm">CA key sizes and algorithms</h3>
<p>Cryptographic key sizes and algorithms define the type and strength of the asymmetric key-pair that is used to sign certificates and Certificate Revocation Lists (CRLs). CAs can live for a relatively long period. Therefore, it is important that the keys are strong enough to be secure throughout the CA's intended lifetime.</p>
<p>If you have a well-defined PKI environment with modern devices, <a href="/certificate-authority-service/docs/choosing-key-algorithm#ecdsa">Elliptic Curve Digital Signature Algorithm (ECDSA)</a> offers the best performance and security. In organizations with a wide range of systems and uncertainty about key support, it could be sufficient to use RSA-based keys.</p>
<p>There are also other considerations for CA signing keys, such as compliance with certifications, compatibility with other systems, and the specific threat models. Consider your use case when choosing a key size and algorithm.</p>
<p>Regardless of the CA lifetime, or key size and algorithm, we recommend that you set up a process for regular rotation of CA keys.</p>
<p>For more information about choosing an algorithm for signing keys, see <a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><a href="/certificate-authority-service/docs/faqs">Frequently asked questions</a></li>
<li><a href="/certificate-authority-service/docs/concepts">Concepts</a></li>
<li><a href="/iam/docs/understanding-roles">IAM: Understanding roles</a></li>
<li><a href="/kms/docs/key-import">Cloud KMS: Key import</a></li>
<li><a href="/logging/docs/audit/configure-data-access">Cloud Logging: Configuring Data Access audit logs</a></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/all-quickstarts]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="quickstarts">
<header>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/quickstart">
<h3 class="hide-from-toc no-link" data-text="Create certificates using the Google Cloud console" id="create-certificates-using-the-google-cloud-console">Create certificates using the Google Cloud console</h3>
<p>
    Learn how you can create certificates using CA Service and the
    Cloud console.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/quickstart-gcloud">
<h3 class="hide-from-toc no-link" data-text="Create certificates using the Google Cloud CLI" id="create-certificates-using-the-google-cloud-cli">Create certificates using the Google Cloud CLI</h3>
<p>
    Learn how you can create certificates using CA Service and the
    gcloud CLI.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/using-terraform">
<h3 class="hide-from-toc no-link" data-text="Create certificates using Terraform" id="create-certificates-using-terraform">Create certificates using Terraform</h3>
<p>
    Learn how you can create certificates using CA Service and
    Terraform.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/create-certificate]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Create a certificate by using the Cloud console" id="create-a-certificate-by-using-the-cloud-console">Create a certificate by using the Cloud console</h1>
<section class="intro">
<p>This page explains how you can use Certificate Authority Service and the Google Cloud console to
create certificates.</p>
<p>CA Service lets you deploy and manage private certificate authorities
(CAs) without managing infrastructure.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
</section>
<section class="steps">
<h2 data-text="Create a CA pool" id="create-pool">Create a CA pool</h2>
<p>A CA pool is a collection of multiple CAs. A CA pool provides the ability to
rotate trust chains without any outage or downtime for workloads. A CA pool
lives in a single <a href="/about/locations">Google Cloud location</a> that you cannot
change after creation.</p>
<p>To create a CA pool with the default settings, do the following:</p>
<ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Under the <strong>CA pool manager</strong> tab, click
<span aria-hidden="true" class="material-icons" translate="no">add_box</span><strong>Create pool</strong>.</p></li>
<li><p>On the <strong>Create CA pool</strong> page, add a name for the CA pool.</p>
<aside class="note"><strong>Note:</strong><span> The names of all CA Service resources must contain only
the allowed characters, which are all the letters, numbers, hyphen, and
underscore. The maximum allowed length of a name is 63 characters.</span></aside></li>
<li><p>Click <strong>Region</strong>, and select <strong>us-east1 (South Carolina)</strong> as the region of
the CA pool.</p></li>
<li><p>Click <strong>Next</strong> for each step.</p></li>
<li><p>Click <strong>Done</strong>.</p></li>
</ol>
<p>You can see this CA pool in the list of CA pools under the <strong>CA pool manager</strong>
tab.</p>
<h2 data-text="Create a root CA" id="create-ca">Create a root CA</h2>
<p>A CA pool is empty on creation. You must add a CA to the CA pool to request
certificates.</p>
<p>A root CA has a self-signed certificate that resides in the client's trust
store. This section explains how you can add a root CA to the CA pool you
created.</p>
<p>To add a root CA to your CA pool, do the following:</p>
<ol>
<li>Click <strong>CA manager</strong>.</li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">add_box</span><strong>Create CA</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="create-ca" src="/certificate-authority-service/images/create-ca-quickstart.png" style="width: 85%"/>
<devsite-lightbox id="create-ca">
<img alt="Create a new CA in your CA pool." src="/certificate-authority-service/images/create-ca-quickstart.png"/>
</devsite-lightbox></p></li>
<li><p>Click <strong>Region</strong>, and select <strong>us-east1 (South Carolina)</strong> as the region of
the CA.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>In the <strong>Organization (O)</strong> field, enter the name of your organization.</p></li>
<li><p>In the <strong>CA common name (CN)</strong> field, enter the name of the CA. Note the CA
name because you will need it for requesting a certificate.</p></li>
<li><p>In the <strong>Pool ID</strong> field, enter the name of your CA pool.</p></li>
<li><p>Click <strong>Next</strong> for each step.</p></li>
<li><p>Review the details of the CA, and click <strong>Create</strong>.</p></li>
</ol>
<h2 data-text="Create a certificate" id="create-certificate">Create a certificate</h2>
<p>To request a certificate using the CA, do the following:</p>
<ol>
<li>On the <strong>Certificate authority</strong> page, click <strong>Request a certificate</strong>.</li>
<li><p>Click <strong>Enter details</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="enter-details" src="/certificate-authority-service/images/request-certificate-enter-details.png" style="width: 75%"/>
<devsite-lightbox id="enter-details">
<img alt="Click Enter details to request a certificate." src="/certificate-authority-service/images/request-certificate-enter-details.png"/>
</devsite-lightbox></p></li>
<li><p>Under <strong>Add domain name</strong>, enter the fully qualified domain name of the site
you want to secure with this certificate.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>Under <strong>Configure key size and algorithm</strong>, click <strong>Continue</strong>.</p>
<p>You will see the generated certificate that you can copy or download. To
copy the certificate, click <span aria-hidden="true" class="material-icons" translate="no">content_copy</span>.</p>
<p><img class="screenshot" data-modal-dialog-id="download-cert" src="/certificate-authority-service/images/download-signed-certificate.png" style="width: 85%"/>
<devsite-lightbox id="download-cert">
<img alt="Copy or download the generated certificate." src="/certificate-authority-service/images/download-signed-certificate.png"/>
</devsite-lightbox></p></li>
<li><p>Click <strong>Done</strong>.</p></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>Clean up by revoking the certificate and deleting the CA pool, the CA, and the
project you created for this quickstart.</p>
<ol>
<li><p>Revoke the certificate.</p>
<ol>
<li>
    Click the <b>Private certificate manager</b> tab.
  </li>
<li>
    In the list of certificates, click
    <span aria-hidden="true" class="material-icons" translate="no">more_vert</span><b>View more</b> in the row of
    the certificate you want to delete.
  </li>
<li>
    Click <b>Revoke</b>.
  </li>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
</ol></li>
<li><p>Delete the CA.</p>
<p>You can delete a CA only after you have revoked all the certificates
issued by it.</p>
<p>After you have revoked the certificate, do the following:</p>
<ol>
<li>
    Click the <b>CA manager</b> tab.
  </li>
<li>
    In the list of CAs, select the CA you want to delete.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">cancel</span><b>Disable</b>.
  </li>
<img class="screenshot" data-modal-dialog-id="disable" src="/certificate-authority-service/images/disable-ca.png" style="width: 85%"/>
<devsite-lightbox id="disable">
<img alt="Disable the CA you want to delete." src="/certificate-authority-service/images/disable-ca.png"/>
</devsite-lightbox>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">delete</span><b>Delete</b>.
  </li>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
</ol>
<p>The CA state changes to <code dir="ltr" translate="no">Deleted</code>. The CA is permanently deleted 30 days
after you initiate the deletion.</p></li>
<li><p>Delete the CA pool.</p>
<p>You can delete a CA pool only after CA Service permanently
deletes the CA.</p>
<p>After you have deleted the CA in the CA pool, do the following:</p>
<ol>
<li>
    Click the <b>CA pool manager</b> tab.
  </li>
<li>
    In the list of CA pools, select the CA pool you want to delete.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">delete</span><b>Delete</b>.
  </li>
<img class="screenshot" data-modal-dialog-id="delete-pool" src="/certificate-authority-service/images/delete-ca-pool.png" style="width: 85%"/>
<devsite-lightbox id="delete-pool">
<img alt="Permanently delete a CA pool." src="/certificate-authority-service/images/delete-ca-pool.png"/>
</devsite-lightbox>
<li>
    In the dialog box that opens, click <b>Confirm</b>.
  </li>
</ol></li>
<li><p>To delete the project, do the following:</p>
<p>
<ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol></p></li>
</ol>
</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/creating-ca-pool">creating a CA pool</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/creating-certificate-authorities">creating CAs</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/requesting-certificates">requesting certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/policy-controls">control the type of certificates a CA pool can issue</a>.</li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/request-certificates-gcloud]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Create a certificate by using the Google Cloud CLI" id="create-a-certificate-by-using-the-google-cloud-cli">Create a certificate by using the Google Cloud CLI</h1>
<section class="intro">
<p>This page explains how you can get started with using Certificate Authority Service by
creating a certificate authority (CA) pool and issuing a certificate.</p>
<p>CA Service lets you deploy and manage private CAs without managing
infrastructure.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ul>
<li><p>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  
    <aside class="note"><strong>Note:</strong> You can run the gcloud CLI in
      the Cloud console without installing the Google Cloud CLI. To run the
      gcloud CLI in the Cloud console,
      <a href="https://console.cloud.google.com/home/dashboard?cloudshell=true" track-metadata-end-goal="launchCloudShell" track-name="consoleLink" track-type="commonIncludes">use
        Cloud Shell</a>.
    </aside>
</p></li>
<li><p>
<p>Create or select a Google Cloud project.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<ul>
<li>
<p>Create a Cloud project:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">gcloud projects create <var translate="no">PROJECT_ID</var></pre>
</li>
<li>
<p>Select a Cloud project:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">gcloud config set project <var translate="no">PROJECT_ID</var></pre>
</li>
</ul>
</p></li>

<li><p>
<p>
        
          
            Enable the Certificate Authority Service API.
          
        
      </p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">gcloud services enable privateca.googleapis.com</pre>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</p></li>
<li><p>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</p></li>
<li><p>Configure a default location for use in the <code dir="ltr" translate="no">gcloud</code> commands in this quickstart.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud config set privateca/location <var translate="no">LOCATION</var>
</code></pre>
<p>CA Service resources, such as CA pools and CAs live in a single
<a href="/about/locations">Google Cloud location</a> that you cannot change after
creating these resources.</p>
<aside class="note"><strong>Note:</strong><span> If you skip this step, you must add the <code dir="ltr" translate="no">--location</code> flag to some of the
following commands.</span></aside></li>
</ul>
</section>
<section class="steps">
<h2 data-text="Create a CA pool" id="create-pool">Create a CA pool</h2>
<p>A certificate authority (CA) pool is a collection of multiple CAs. A CA pool
provides the ability to rotate trust chains without any outage or downtime for
workloads.</p>
<p>To create a CA pool in the Enterprise tier, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">POOL_ID</var> --tier "enterprise"
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the CA pool.</p>
<p>The names of all CA Service resources must contain only the
allowed characters, which are all the letters, numbers, hyphen, and underscore.
The maximum allowed length of a name is 63 characters.</p>
<h2 data-text="Create a root CA" id="create-root-ca">Create a root CA</h2>
<p>A CA pool is empty on creation. To request certificates from a CA pool, you must
add a CA in it.</p>
<p>To create a root CA and add it in the CA pool you created, run the following
command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots create <var translate="no">CA_ID</var> --pool <var translate="no">POOL_ID</var> --subject "CN=Example Prod Root CA, O=Google"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_ID</var>: The name of the root CA.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
</ul>
<p>CA Service returns the following command when it creates the root CA:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">Created Certificate Authority [projects/<var translate="no">PROJECT_ID</var>/locations/us-east1/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities/<var translate="no">CA_ID</var>]
</code></pre>
<p>Enable the root CA by entering <code dir="ltr" translate="no">y</code> when prompted by the gcloud CLI.</p>
<p>Now that you have a CA pool with a root CA, you can proceed to creating
certificates.</p>
<h2 data-text="Create a certificate" id="create-certificate">Create a certificate</h2>
<p>To use the newly created CA to create a certificate, do the following:</p>
<ol>
<li><p>Install the Pyca cryptography library using the <code dir="ltr" translate="no">pip</code> command.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  pip install --user "cryptography&gt;=2.2.0"
</code></pre>
<p>CA Service uses the Pyca cryptography library to generate and
  store a new asymmetric key-pair on your local machine. This key is never
  sent to CA Service.</p></li>
<li><p>To allow Google Cloud SDK to use the Pyca cryptography library, you must
  enable site packages.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="macOS or Linux" id="macos-or-linux">macOS or Linux</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export CLOUDSDK_PYTHON_SITEPACKAGES=1
</code></pre></section>
<section><h3 data-text="Windows" id="windows">Windows</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">set CLOUDSDK_PYTHON_SITEPACKAGES=1
</code></pre></section>
</div></li>
<li><p>Create a certificate.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  gcloud privateca certificates create \
      --issuer-pool <var translate="no">POOL_ID</var> \
      --subject "CN=Example Prod,O=Google" \
      --generate-key \
      --key-output-file=./key \
      --cert-output-file=./cert.pem
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the resource ID of the CA
  pool you created.</p>
<p>CA Service returns the following response:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  Created Certificate [projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificates/<var translate="no">CERTIFICATE_ID</var>]
</code></pre></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>Clean up by deleting the CA pool, the CA, and the project you created for this
quickstart.</p>
<ol>
<li><p>Revoke the certificate.</p>
<ol>
<p>
     To revoke a certificate, run the following command:
  </p>
<pre class="prettyprint" dir="ltr" suppresswarning="" translate="no">
  gcloud privateca certificates revoke --certificate <var translate="no">CERT_NAME</var> --issuer-pool <var translate="no">POOL_ID</var>
  </pre>
<p>
    Replace the following:
  </p>
<ul>
<li>
<var translate="no">CERT_NAME</var>: The name of the certificate you want to revoke.
    </li>
<li>
<var translate="no">POOL_ID</var>: The name of the CA pool that issued the certificate.
    </li>
</ul>
</ol></li>
<li><p>Delete the CA.</p>
<p>You can delete a CA only after you have revoked all the certificates
issued by it.</p>
<ol>
<li><p>Disable the CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots disable <var translate="no">CA_ID</var> --pool=<var translate="no">POOL_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_ID</var>: The resource ID of the CA.</li>
<li><var translate="no">POOL_ID</var>: The resource ID of the CA pool.</li>
</ul></li>
<li><p>Delete the CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots delete <var translate="no">CA_ID</var> --pool=<var translate="no">POOL_ID</var>
</code></pre></li>
</ol>
<p>The CA state changes to <code dir="ltr" translate="no">Deleted</code>. CA Service permanently deletes
the CA 30 days after you initiate the deletion.</p></li>
<li><p>Delete the CA pool.</p>
<p>You can delete a CA pool only after the CA in it is permanently
deleted.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools delete <var label="Pool Name" translate="no">POOL_ID</var>
</code></pre></li>
<li><p>Delete the project.</p>
<p>
<ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<p>Delete a Cloud project:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">gcloud projects delete <var translate="no">PROJECT_ID</var></pre>
</ol></p></li>
</ol>
</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/creating-ca-pool">creating a CA pool</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/creating-certificate-authorities">creating CAs</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/requesting-certificates">requesting certificates</a>.</li>
<li>Learn how you can <a href="/certificate-authority-service/docs/policy-controls">control the type of certificates a CA pool can issue</a>.</li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/using-terraform]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Create a certificate by using Terraform" id="create-a-certificate-by-using-terraform">Create a certificate by using Terraform</h1>
<p><a class="external" href="https://terraform.io">Terraform</a> is an open-source software tool
that lets you create and manage your CA Service resources
using its <a class="external" href="https://learn.hashicorp.com/tutorials/terraform/infrastructure-as-code?in=terraform/gcp-get-started">infrastructure-as-code</a> paradigm.</p>
<h2 data-text="Objective" id="objective">Objective</h2>
<p>This page describes how you can use Terraform to perform the following
operations with Certificate Authority Service:</p>
<ul>
<li>Create a certificate authority (CA) pool.</li>
<li>Create a CA in the new CA pool.</li>
<li>Generate a new Certificate Signing Request (CSR).</li>
<li>Use the generated CSR to request a certificate from the new CA pool.</li>
</ul>
<p>This tutorial uses the <a class="external" href="https://registry.terraform.io/providers/hashicorp/google/latest/docs">Google Cloud Terraform
Provider</a> 
for Terraform.</p>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<p>Make sure that you have the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>)
IAM role. If you don't have this IAM role, read
<a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single role</a>
for information about granting this role.</p>
<h2 data-text="Create a Google Cloud project" id="create-project">Create a Google Cloud project</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the CA Service API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=privateca.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the CA Service API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=privateca.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
<h2 data-text="Install the Google Cloud CLI" id="install-sdk">Install the Google Cloud CLI</h2>
<p>If you haven't already, <a href="/sdk/docs/install">install the Google Cloud CLI</a>.
When prompted, choose the project that you selected or created earlier.</p>
<p>If you already have the Google Cloud CLI installed, update it using the following
Google Cloud CLI command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud components update
</code></pre>
<p>For more information about this gcloud CLI command, see
<a href="/sdk/gcloud/reference/components/update">gcloud components update</a>.</p>
<h2 data-text="Create a Terraform configuration file" id="set-up-terraform">Create a Terraform configuration file</h2>
<p>To create a Terraform configuration file that you can use to <a href="#objective">perform
operations</a> on CA Service, do the following:</p>
<ol>
<li><p>Create a new directory for the project to live.</p></li>
<li><p>In this new directory, create a <code dir="ltr" translate="no">main.tf</code> file for the Terraform
configuration.</p></li>
<li><p>Copy the following Terraform configuration, and paste it in the <code dir="ltr" translate="no">main.tf</code>
file.</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_quickstart/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_quickstart/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_quickstart/main.tf" data-region-tag="privateca_quickstart" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_quickstart/main.tf/main/privateca_quickstart" translate="no"><code dir="ltr" translate="no">provider google{}
provider tls{}

resource "tls_private_key" "example" {
  algorithm   = "RSA"
}

resource "tls_cert_request" "example" {
  key_algorithm   = "RSA"
  private_key_pem = tls_private_key.example.private_key_pem

  subject {
    common_name  = "example.com"
    organization = "ACME Examples, Inc"
  }
}

resource "google_privateca_ca_pool" "default" {
  name = "my-ca-pool"
  location = "us-central1"
  tier = "ENTERPRISE"
  project = "project-id"
  publishing_options {
    publish_ca_cert = true
    publish_crl = true
  }
  labels = {
    foo = "bar"
  }
  issuance_policy {
    baseline_values {
      ca_options {
        is_ca = false
      }
      key_usage {
        base_key_usage {
          digital_signature = true
          key_encipherment = true
        }
        extended_key_usage {
          server_auth = true
        }
      }
    }
  }
}

resource "google_privateca_certificate_authority" "test-ca" {
  certificate_authority_id = "my-authority"
  location = "us-central1"
  project = "project-id"
  pool = google_privateca_ca_pool.pool.name
  config {
    subject_config {
      subject {
        country_code = "us"
        organization = "google"
        organizational_unit = "enterprise"
        locality = "mountain view"
        province = "california"
        street_address = "1600 amphitheatre parkway"
        postal_code = "94109"
        common_name = "my-certificate-authority"
      }
    }
    x509_config {
      ca_options {
        is_ca = true
      }
      key_usage {
        base_key_usage {
          cert_sign = true
          crl_sign = true
        }
        extended_key_usage {
          server_auth = true
        }
      }
    }
  }
  type = "SELF_SIGNED"
  key_spec {
    algorithm = "RSA_PKCS1_4096_SHA256"
  }
}

resource "google_privateca_certificate" "default" {
  pool = google_privateca_ca_pool.pool.name
  certificate_authority = google_privateca_certificate_authority.test-ca.certificate_authority_id
  project = "project-id"
  location = "us-central1"
  lifetime = "860s"
  name = "my-certificate"
  pem_csr = tls_cert_request.example.cert_request_pem
}</code></pre>
</div>
<p>For information about operating CA Service with Terraform, see
<a class="external" href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/privateca_ca_pool">Using Terraform with CA Service</a>.</p></li>
</ol>
<p>For more information about setting up Terraform with Google Cloud, see
<a class="external" href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/getting_started">Getting started with the Google Cloud
Provider</a>.</p>
<h2 data-text="Run the Terraform configuration file" id="execute-terraform">Run the Terraform configuration file</h2>
<p>To run the Terraform configuration file you created, run the following
commands in Cloud Shell.</p>
<p>For information about running gcloud CLI commands using
Cloud Shell, see <a href="/shell/docs/run-gcloud-commands">Running gcloud commands with
Cloud Shell</a>.</p>
<ol>
<li><p>Initialize Terraform in the directory where you have stored the <code dir="ltr" translate="no">main.tf</code>
file.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">terraform init
</code></pre></li>
<li><p>Run the created Terraform configuration file.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">terraform apply
</code></pre></li>
<li><p>When prompted to confirm if you want to run the configuration file, enter
<strong>yes</strong>.</p></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/docs/terraform">use Terraform with Google Cloud</a>.</li>
<li>Read the <a class="external" href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/privateca_ca_pool">Terraform documentation about CA Service support</a>.</li>
<li><a class="external" href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/getting_started" track-metadata-position="relatedLinks" track-type="solution">Get started with the Google Cloud Provider</a>.</li>
<li><a class="external" href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/privateca_ca_pool" track-metadata-position="relatedLinks" track-type="solution">Use Terraform with CA Service</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/concepts]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="overview">
<header>
<h2 data-text="CA Service Concepts" id="ca-service-concepts">CA Service Concepts</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/trust-model">
<h3 class="hide-from-toc no-link" data-text="Trust model" id="trust-model">Trust model</h3>
<p>
    Describes how the CA Service handles authorization.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/certificate-authority-states">
<h3 class="hide-from-toc no-link" data-text="CA states" id="ca-states">CA states</h3>
<p>
    Describes the properties of each state a CA can be in through its lifecycle.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/locations">
<h3 class="hide-from-toc no-link" data-text="Locations" id="locations">Locations</h3>
<p>
    Provides the list of geographical locations where you can create your CA Service resources.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/tiers">
<h3 class="hide-from-toc no-link" data-text="Workload-optimized tiers" id="workload-optimized-tiers">Workload-optimized tiers</h3>
<p>
    Describes and compares the supported tiers at which certificate authorities
    can be created.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/managed-resources">
<h3 class="hide-from-toc no-link" data-text="Managed resources" id="managed-resources">Managed resources</h3>
<p>
    Describes the different models of resource management supported by
    CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/certificate-authority-settings">
<h3 class="hide-from-toc no-link" data-text="Certificate authority settings" id="certificate-authority-settings">Certificate authority settings</h3>
<p>
    Describes the permanent and optional settings of a CA.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/certificate-template">
<h3 class="hide-from-toc no-link" data-text="Certificate templates" id="certificate-templates">Certificate templates</h3>
<p>
    Describes the concept of certificate templates.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/ca-pool">
<h3 class="hide-from-toc no-link" data-text="CA pools" id="ca-pools">CA pools</h3>
<p>
    Describes the concept of CA pools.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/policy-controls">
<h3 class="hide-from-toc no-link" data-text="Policy controls" id="policy-controls">Policy controls</h3>
<p>
    Describes the use cases of the various policy controls.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/using-identity-reflection">
<h3 class="hide-from-toc no-link" data-text="Identity reflection" id="identity-reflection">Identity reflection</h3>
<p>
    Describes a restricted certificate issuance mode for unprivileged certificate requesters. With the identity reflection mode, an unprivileged certificate requester can only request certificates with an SAN corresponding to the identity in their credential.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/trust-model]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Trust model" id="trust-model">Trust model</h1>
<h2 data-text="Background" id="background">Background</h2>
<p>In a typical Web Public Key Infrastructure (PKI), millions of clients across the
world trust a set of independent certificate authorities (CAs) to assert identities
(such as domain names) in certificates. As part of their responsibilities, CAs commit
to only issuing certificates when they have independently validated the identity
in that certificate. For example, a CA typically needs to verify that
somebody requesting a certificate for the domain name <code dir="ltr" translate="no">example.com</code> actually
controls the said domain before they issue a certificate to them. Since those CAs
can issue certificates for millions of customers where they might not have an
existing direct relationship, they are limited to asserting identities that are
publicly verifiable. Those CAs are limited to certain well-defined verification
processes that are consistently applied across the Web PKI.</p>
<p>Unlike Web PKI, a private PKI often involves a smaller CA hierarchy, which is
directly managed by an organization. A private PKI sends certificates only to clients
that inherently trust the organization to have the appropriate controls (for
example, machines owned by that organization). Since the CA admins often have
their own ways of validating identities for which they issue certificates (for
example, issuing certificates to their own employees), they aren't limited by
the same requirements as for Web PKI. This flexibility is one of the main advantages
of private PKI over Web PKI. A private PKI enables new use-cases such as securing
internal websites with short domain names without requiring unique ownership of
those names, or encoding alternative identities formats (such
as <a class="external" href="https://spiffe.io/docs/latest/spiffe/concepts/#spiffe-id">SPIFFE IDs</a>) into
a certificate.</p>
<p>Certificate Authority Service aims to simplify the process of managing private PKI by
allowing you to easily create and manage CAs. As such, CA Service
does not define how identities in certificates must be validated. However, CA Service provides a robust set of policy controls that allows fine-grained configuration of CA pools. For more information, see <a href="/certificate-authority-service/docs/policy-controls">Policy controls</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/policy-controls">policy controls</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/configuring-iam">configure IAM policies</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/use-issuance-policy">use an issuance policy</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/certificate-authority-states]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Certificate authority states" id="certificate-authority-states">Certificate authority states</h1>
<p>This page describes the operational states that apply to certificate authorities (CAs).</p>
<p>Once created, a CA is in one of the following states throughout its lifecycle.</p>
<ul>
<li>Enabled</li>
<li>Disabled</li>
<li>Staged</li>
<li>Awaiting user activation</li>
<li>Deleted</li>
</ul>
<p>Subordinate CAs are created in the <code dir="ltr" translate="no">AWAITING_USER_ACTIVATION</code> state, and they are set to the <code dir="ltr" translate="no">STAGED</code> state after activation.</p>
<aside class="note"><strong>Note:</strong><span> If you don't activate subordinate CAs within 30 days of creation, the subordinate CAs are deleted.</span></aside>
<p>Root CAs are created in the <code dir="ltr" translate="no">STAGED</code> state. A root CA can never be in the <code dir="ltr" translate="no">AWAITING_USER_ACTIVATION</code> state.</p>
<p>We recommend that you create and test certificates while the CA is still in the <code dir="ltr" translate="no">STAGED</code> state. Once you have verified that the CA certificate has been published to all clients and tested certificate issuance from the CA, you can enable the CA to start issuing load-balanced certificates for the CA pool. For information on enabling a CA, see <a href="/certificate-authority-service/docs/managing-ca-state#enable">Enabling a CA</a>.</p>
<p>A CA pool cannot issue certificates until it has at least one CA in the <code dir="ltr" translate="no">ENABLED</code> state.</p>
<aside class="note"><strong>Note:</strong><span> Once you enable a CA, it cannot be transitioned back to the <code dir="ltr" translate="no">STAGED</code> state.</span></aside>
<p>The following table illustrates the properties of a CA in each of the states.</p>
<table>
<thead>
<tr>
<th>CA state</th>
<th>Can issue certificates?</th>
<th>Included in CA pool certificate issuance rotation?</th>
<th>Included in CA pool Trust Anchor?</th>
<th>Can revoke certificates and publish CRLs?</th>
<th>Is billed?</th>
<th>Are resources accessible?</th>
<th>Can accept update requests?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Enabled</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Disabled</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Staged</td>
<td>Yes<sup>1</sup></td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Awaiting user activation</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Deleted</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
<td>No</td>
</tr>
</tbody>
</table>
<p><sup>1</sup>CAs in the <code dir="ltr" translate="no">STAGED</code> state cannot issue certificates through CA pool load-balancing. They can only issue certificates when requested directly by the clients.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="https://cloud.google.com/certificate-authority-service/pricing">pricing for CA Service</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/managing-ca-state">manage CA states</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/requesting-certificates">request certificates</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/locations]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Locations" id="locations">Locations</h1>
<p>Within a project, you can create certificates, certificate authorities (CAs), and CA pools in one of many <a href="/about/locations">locations</a>. These locations represent the geographical regions where a Certificate Authority Service resource is stored and can be accessed. The location of a CA pool impacts the latency of applications that use that resource.</p>
<p>You can create CA Service resources in several different locations in Google Cloud, depending on
your availability requirements. For specific
information about each location, see <a href="/about/locations">Locations</a>.</p>
<p>For information on how to select a location, see <a href="#choosing">Choosing the best type of location</a>.</p>
<h2 data-text="List of regional locations" id="list-regional-locations">List of regional locations</h2>
<p>A regional location's data centers exist in a specific geographical place. For
example, a resource created in the <code dir="ltr" translate="no">us-central1</code> region is located in the
central United States.</p>
<p><span id="privateca-regions"></span>
CA Service resources can be created in the regional
locations given below.</p>
<table>
<thead>
<tr>
<th>Region name</th>
<th>Region description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">asia-east1</code></td>
<td>Taiwan</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-east2</code></td>
<td>Hong Kong</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-northeast1</code></td>
<td>Tokyo</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-northeast2</code></td>
<td>Osaka</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-northeast3</code></td>
<td>Seoul</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-south1</code></td>
<td>Mumbai</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-southeast1</code></td>
<td>Singapore</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">asia-southeast2</code></td>
<td>Jakarta</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">australia-southeast1</code></td>
<td>Sydney</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">europe-north1</code></td>
<td>Finland</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">europe-west1</code></td>
<td>Belgium</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">europe-west2</code></td>
<td>London</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">europe-west3</code></td>
<td>Frankfurt</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">europe-west4</code></td>
<td>Netherlands</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">europe-west6</code></td>
<td>Zürich</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">northamerica-northeast1</code></td>
<td>Montréal</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-central1</code></td>
<td>Iowa</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-east1</code></td>
<td>South Carolina</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-east4</code></td>
<td>Northern Virginia</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-west1</code></td>
<td>Oregon</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-west2</code></td>
<td>Los Angeles</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-west3</code></td>
<td>Salt Lake City</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">us-west4</code></td>
<td>Las Vegas</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">southamerica-east1</code></td>
<td>São Paulo</td>
</tr>
</tbody>
</table>
<p>You can also check the list of supported locations by running the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca locations list
</code></pre>
<p><a name="choosing"></a></p>
<h2 data-text="Choosing the best type of location" id="choosing-best-location">Choosing the best type of location</h2>
<p>The location of your CA pools is an important aspect of your application's design. As a rule, design your application so that all of its components are
geographically near each other and near your application's clients. You cannot move or export a CA pool after it has been created.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>See all the <a href="/about/locations">Google Cloud locations</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/tiers]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Workload-optimized tiers" id="workload-optimized-tiers">Workload-optimized tiers</h1>
<p>Certificate Authority Service offers two workload-optimized operation tiers for certificate
authority (CA) pools.</p>
<ul>
<li><strong>DevOps</strong>: Focused on high volume, short-lived certificate issuance which is
found in microservice-based applications.</li>
<li><strong>Enterprise</strong>: Focused on lower volume, long-lived certificate issuance
which is normally found in devices and user identity, where lifecycle
management is important.</li>
</ul>
<aside class="note"><strong>Note:</strong><span> The operation tier is set when the CA pool is created and cannot be changed
afterwards.</span></aside>
<p>Both tiers can be used with any kind of application and both tiers support all user-specified certificate timelines. Microservice-based applications might benefit from the higher QPS quota for DevOps CA pools, which can support environments with higher rates of workload startup and allow certificates to be rotated more frequently. DevOps tier might also be more suited for shorter-lived certificates because it lacks certificate lifecycle management.</p>
<p>Some differences between the DevOps and the Enterprise tier are mentioned in the following table:</p>
<table>
<tr>
<th></th>
<th>DevOps tier</th>
<th>Enterprise tier</th>
</tr>
<tr>
<td>HSM support for CA key</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Customer-managed CA key, supported through Cloud KMS</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Support for listing, describing, and revoking certificates</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>QPS quota for CAs*</td>
<td>25</td>
<td>7</td>
</tr>
</table>
<p>* QPS quota refers to the maximum number of certificates that can be
issued per second by a given CA. A CA pool can reach a higher total effective QPS with multiple CAs. For more information, see <a href="/certificate-authority-service/docs/higher-qps">Achieving a higher QPS using a CA pool</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-ca-pool">create CA pools</a>.</li>
<li>Learn about <a href="/certificate-authority-service/quotas">quotas and limits</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/managed-resources]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Managed resources" id="managed-resources">Managed resources</h1>
<p>Certificate authorities (CAs) created through Certificate Authority Service rely on
two secondary resource types:</p>
<ul>
<li>A <strong>Cloud Key Management Service key version</strong>, used to sign certificates and
Certificate Revocation Lists (CRLs) issued by the CA. For more information about key versions, see <a href="/kms/docs/resource-hierarchy#key_versions">Key versions</a>.</li>
<li>A <strong>Cloud Storage bucket</strong>, used to host a CA certificate and/or
any CRLs published by the CA, if these settings are enabled. For more information about Cloud Storage buckets, see <a href="/storage/docs/key-terms#buckets">Buckets</a>.</li>
</ul>
<p>Both of these resources must exist for each CA, and cannot be changed after
the CA is created.</p>
<h2 data-text="Management models" id="management-models">Management models</h2>
<p>CA Service supports two lifecycle management models for these
resources:</p>
<ul>
<li>Google-managed</li>
<li>Customer-managed</li>
</ul>
<p>The Cloud KMS key and the Cloud Storage bucket don't need to
use the same management model. For example, the Cloud KMS key can be
Google-managed, and the Cloud Storage bucket can be customer-managed, or the other
way around.</p>
<h3 data-text="Google-managed" id="google-managed">Google-managed</h3>
<p>CA Service automatically creates and configures the resources
following this model on CA creation, and deletes the resources on CA deletion.
You aren't billed separately for these resources.</p>
<p>By default, new CAs use Google-managed Cloud KMS keys and
Cloud Storage buckets. You can choose a specific key algorithm for the
Google-managed Cloud KMS key while creating a CA.</p>
<p>For more information on creating a CA, see
<a href="/certificate-authority-service/docs/creating-certificate-authorities">Creating certificate authorities</a>. For
guidance on choosing a key algorithm, see
<a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.</p>
<h3 data-text="Customer-managed" id="customer-managed">Customer-managed</h3>
<p>You can create customer-managed resources only for CAs in the <a href="/certificate-authority-service/docs/tiers">Enterprise
tier</a>. You must create and
configure the customer-managed resources before CA creation. Additionally,
you must delete these resources at an appropriate time after the CA is
destroyed. Users are billed directly for these resources.</p>
<p>CA Service treats the project as the security boundary for customer-managed Cloud KMS keys. For example, consider that a user Alice uses a customer-managed Cloud KMS key to create a CA in project <code dir="ltr" translate="no">test</code>. Then, another user Bob can use the same Cloud KMS key to create another CA in the same project. While Alice needs to have admin access on the key to create the first CA, Bob doesn't need any access on that key because Alice already enabled use of the key by CA Service in project <code dir="ltr" translate="no">test</code>.</p>
<h4 data-text="Advantages of creating customer-managed resources" id="customer-managed-advantages">Advantages of creating customer-managed resources</h4>
<p>One advantage of this model is that callers have direct control over those
resources. Callers can directly update attributes such as access management to fit
their organizational requirements.</p>
<p>Creating a CA with customer-managed resources requires the caller to have
administrative access over those resources, in order to grant the appropriate
access to CA Service. For more information, see
<a href="/certificate-authority-service/docs/reference/permissions-and-roles#service_agent">CA Service Service Agent</a>.</p>
<h4 data-text="Location of Cloud KMS keys" id="location-keys">Location of Cloud KMS keys</h4>
<p>You must create customer-managed Cloud KMS keys in the same location as that of your CA Service resources. For the complete list of locations for CA Service, see <a href="/certificate-authority-service/docs/locations">Locations</a>. For the list of locations where Cloud KMS resources can be created, see <a href="/kms/docs/locations">Cloud KMS locations</a>.</p>
<h4 data-text="Location of Cloud Storage buckets" id="location-buckets">Location of Cloud Storage buckets</h4>
<p>You must create customer-managed Cloud Storage buckets
in approximately the same location as your CA Service resources. You
cannot create the Cloud Storage bucket outside the continent where you have
created the CA Service resources.</p>
<p>For example, if your CA is in <code dir="ltr" translate="no">us-west1</code>, you can create the
Cloud Storage buckets in any single region in the US such as
<code dir="ltr" translate="no">us-west1</code> or <code dir="ltr" translate="no">us-east1</code>, the dual-region <code dir="ltr" translate="no">NAM4</code>, and the multi-region <code dir="ltr" translate="no">US</code>.</p>
<p>For the list of locations where Cloud Storage
resources can be created, see <a href="/storage/docs/locations">Cloud Storage locations</a>.</p>
<aside class="caution"><strong>Caution:</strong><span> You maintain control over the resources in this model. Therefore, it is
possible to cause accidental outages for the CA by deleting those resources or
removing the <a href="/certificate-authority-service/docs/reference/permissions-and-roles#service_agent">CA Service Service Agent</a> account from their IAM
policies. For information about configuring alerts for these scenarios, see
<a href="/certificate-authority-service/docs/monitoring#create_an_alerting_policy">Create an alerting policy</a>.</span></aside>
<h2 data-text="Access to the managed resources" id="access">Access to the managed resources</h2>
<p>Anybody who has the URL of the CA certificate hosted on a Cloud Storage
bucket or any CRLs published by the CA can access these resources by default.
To prevent public access to your CA certificate and CRL, add the project
containing the CA pool to a <a href="/vpc-service-controls/docs/service-perimeters#about-perimeters">VPC Service Controls perimeter</a>.</p>
<p>By adding the project containing the CA pool to a VPC Service Controls perimeter,
the Google-managed Cloud Storage bucket joins the perimeter. The
VPC Service Controls perimeter ensures that the Cloud Storage bucket cannot be
accessed from outside the approved networks.</p>
<p>Clients within the network perimeter can still access the CRLs and CA
certificates without authentication. The access requests from outside the
approved network fail.</p>
<h3 data-text="HTTP-based URLs for CA certificates and CRLs" id="http-url">HTTP-based URLs for CA certificates and CRLs</h3>
<p>CA certificates and CRLs are available on HTTP-based URLs for the following
reasons:</p>
<ul>
<li><p>A CA certificate that is published in a Cloud Storage bucket isn't supposed
to be trusted by clients as-is. The CA certificates are a part of a
<em>certificate chain</em>, which starts with the certificate of the root CA. Each
certificate in the certificate chain is signed by the CA certificate above it,
which preserves the integrity of the certificate. Hence, there is no added
advantage of using the HTTPS protocol.</p></li>
<li><p>Some clients reject HTTPS-based URLs while validating certificates.</p></li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-ca-pool">create CA pools</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-certificate-authorities">create certificate authorities</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/certificate-authority-settings]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Certificate authority settings" id="certificate-authority-settings">Certificate authority settings</h1>
<p>This page describes the various settings of a certificate authority (CA).</p>
<h2 data-text="Permanent settings" id="permanent">Permanent settings</h2>
<p>You cannot change the settings mentioned in this section after creating the CA.</p>
<h3 data-text="Service-specific settings" id="service-specific-settings">Service-specific settings</h3>
<p><strong>Type of CA</strong></p>
<p>CA Service lets you create both root CAs and subordinate CAs.</p>
<table>
<thead>
<tr>
<th>Root CA</th>
<th>Subordinate CA</th>
</tr>
</thead>
<tbody>
<tr>
<td>A root CA is a self-signed CA.
Parties that need to authenticate
certificates created from a root CA
(a <em>relying party</em>) must know its CA
certificate in advance. The root CA
certificate is often referred to as
a <em>trust anchor</em>.<br/><br/>Frequently
changing a root CA is difficult. To
change the root CA, you must first
update all relying parties about the
new trust anchor. Otherwise, they
won't be able to authenticate
certificates from the new root
CA.<br/><br/>Root CAs cannot be
revoked using the CRLs of the
issuing CA because root CAs are
self-signed. To revoke a root CA,
you must remove it from the trust
store of every single client that
trusts it. This process can be long
and tedious. Hence, we recommend
protecting the root CAs.</td>
<td>A subordinate CA is a CA that is
signed by a root CA or another
subordinate CA. Following a chain of
subordinate CAs, the chain always
ends with a root CA.<br/><br/>A relying
party that only knows about a root CA
can also implicitly trust a
subordinate CA that <em>chains</em> to the
explicitly trusted root CA
certificate. The subordinate CA can
be trusted only if the relying party
is able to cryptographically validate
the certificate chain that forms a
path to the root CA
certificate.<br/><br/>A chain
containing a root and one or more
subordinate CAs can include CAs that
are managed in CA Service
and CAs that aren't.


</td>
</tr>
</tbody>
</table>
<p><strong>Cloud KMS key</strong></p>
<p>By default, new CAs use a Google-managed Cloud Key Management Service (Cloud KMS) key.
You can choose a specific key algorithm for the
Google-managed Cloud KMS key. Alternatively, you can grant CA Service
access to a key that already exists. For more information, see
<a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.</p>
<p>For more information about the management models for Cloud KMS keys and
Cloud Storage buckets, see <a href="/certificate-authority-service/docs/managed-resources">Managed resources</a>.</p>
<p><strong>Cloud Storage bucket</strong></p>
<p>By default, CA Service creates a new Google-managed Cloud Storage bucket
in the same location as the CA. You can also choose to use an existing self-managed
bucket or <a href="/storage/docs/creating-buckets">create a new bucket</a>. To minimize latency while publishing CRLs, we
recommend creating the Cloud Storage bucket in the same location as your CA.
For more information, see <a href="/certificate-authority-service/docs/managed-resources">Managed resources</a>.</p>
<h2 data-text="CA certificate settings" id="ca_certificate_settings">CA certificate settings</h2>
<p>The following settings are directly reflected in the CA's own certificate:</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lifetime
</td>
<td>Specifies a CA's lifetime. Lifetime is the amount of time, starting
from the CA's creation, that the CA is valid for.</td>
</tr>
<tr>
<td>Subject




</td>
<td>A CA can specify a distinguished name and subject alternative
names. In many cases, these fields are purely informational.
However, a relying party can choose to treat certificates issued
from a CA with particular subject attributes differently.<br/><br/>
If you want to specify a subject alternative name for your CA's
certificate, you must use the Google Cloud CLI.</td>
</tr>
</tbody>
</table>
<h2 data-text="Optional CA settings" id="optional_ca_settings">Optional CA settings</h2>
<p>The following CA settings are optional. You can change the following setting
after creating the CA.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Label
</td>
<td>A CA can have one or more user labels attached to it. Labels have
no semantic meaning to CA Service.</td>
</tr>
</tbody>
</table>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-certificate-authorities">create CAs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/certificate-template]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Certificate templates" id="certificate-templates">Certificate templates</h1>
<p>Certificate Authority Service provides reusable and parameterized templates that you can use for common certificate issuance scenarios. A certificate template represents a relatively static and well-defined certificate issuance schema within an organization. The <code dir="ltr" translate="no">CertificateTemplate</code> resource includes the following.</p>
<ol>
<li>A <a class="external" href="https://opensource.google/projects/cel">Common Expression Language (CEL)</a> expression that is evaluated against the requested subject and SANs in all certificate requests that use the template. For more information about using CEL, see <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.</li>
<li>An allowlist specifying whether the subject and/or subject alternative name can be copied from the end-user request to the issued certificate.</li>
<li>An optional allowlist specifying which X.509 extensions, if any, can be copied from the end-user request to the issued certificate.</li>
<li>An optional set of X.509 extension values that are added to all the issued certificates that use the template.</li>
</ol>
<p>A certificate template can essentially become a full-fledged vertical certificate issuance framework. For more details, see the full <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.certificateTemplates#CertificateTemplate">CertificateTemplate</a> message definition.</p>
<h2 data-text="Predefined values in a certificate template" id="predefined-values">Predefined values in a certificate template</h2>
<p>The predefined values in a certificate template are added to all the certificates that use the certificate template. They allow creating common certificate issuance scenarios, such as mTLS or code signing. The values include the following:</p>
<ul>
<li><strong>Key usages</strong>: Specifies the base key usage for a certificate according to <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">RFC 5280 section 4.2.1.12</a>.</li>
<li><strong>Extended key usages</strong>: Specifies the extended key usage for a certificate according to <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">RFC 5280 section 4.2.1.3</a>.</li>
<li><strong>If the certificate is a CA</strong>: Specifies if the certificate can issue additional certificates or whether it's an end-entity certificate.</li>
<li><strong>Max issuer path length</strong>: In the case of a CA, it specifies the maximum number of CAs that can be chained up to this CA certificate. If the max issuer path length is set to 0, then the CA can only issue end-entity certificates. If it's set to 1, then the chain beneath this CA certificate can include only one subordinate CA. If a value isn't declared, then the number of subordinate CAs in the chain beneath this CA is unbounded.</li>
<li><strong>AIA OCSP servers</strong>: Refers to the OCSP servers in a certificate's Authority Information Access (AIA) extension, as described in <a class="external" href="https://tools.ietf.org/html/rfc5280#section-4.2.2.1">RFC 5280 section 4.2.2.1</a>.</li>
<li><strong>Additional X.509 extensions</strong>: Describes custom X.509 extensions.</li>
</ul>
<p>The following code sample mentions all the predefined fields in a certificate template:</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">keyUsage:
  baseKeyUsage:
    digitalSignature: true
    keyEncipherment: true
    contentCommitment: false
    dataEncipherment: false
    keyAgreement: false
    certSign: false
    crlSign: false
    encipherOnly: false
    decipherOnly: false
  extendedKeyUsage:
    serverAuth: true
    clientAuth: false
    codeSigning: false
    emailProtection: false
    timeStamping: false
    ocspSigning: false
caOptions:
  isCa: true
  maxIssuerPathLength: 1
policyIds:
- objectIdPath:
  - 1
  - 2
  - 3
additionalExtensions:
- objectId:
    objectIdPath:
    - 1
    - 2
    - 3
  critical: false
  value: "base64 encoded extension value"
</code></pre>
<p>Values not specified in the YAML are either omitted or defaulted to <code dir="ltr" translate="no">false</code>.</p>
<p>The following extensions are omitted if a value isn't specified:</p>
<ul>
<li><code dir="ltr" translate="no">keyUsage</code></li>
<li><code dir="ltr" translate="no">policyIds</code></li>
<li><code dir="ltr" translate="no">additionalExtensions</code></li>
<li><code dir="ltr" translate="no">maxIssuerPathLength</code> field in the <code dir="ltr" translate="no">caOptions</code> extension</li>
</ul>
<p>The following extensions default to <code dir="ltr" translate="no">false</code> if a value isn't specified:</p>
<ul>
<li><code dir="ltr" translate="no">isCa</code> field in the <code dir="ltr" translate="no">caOptions</code> extension</li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-certificate-template">create certificate templates</a>.</li>
<li>Learn about <a class="external" href="https://github.com/google/cel-spec">Common Expression Language</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/using-cel">use Common Expression Language</a>.</li>
<li>Learn about <a href="/certificate-authority-service/docs/certificate-profile">certificate profiles</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/ca-pool]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Overview of CA pools" id="overview-of-ca-pools">Overview of CA pools</h1>
<p>A certificate authority (CA) pool is a collection of multiple CAs with a common
certificate issuance policy and Identity and Access Management (IAM) policy. CA
pools provide the ability to rotate trust chains without any outage or
downtime for their payloads.</p>
<p>A CA pool is empty when you create it. For information about adding a CA to a
CA pool, see <a href="/certificate-authority-service/docs/creating-certificate-authorities">Creating
CAs</a>.</p>
<p>The CA pool maintains a list of trusted CA certificates. You must install these
trusted CA certificates with the certificate requester.</p>
<h2 data-text="Properties of CAs in a CA pool" id="properties">Properties of CAs in a CA pool</h2>
<p>The following table lists the features that must be same, can be different, and
must be different for all CAs in a CA pool.</p>
<table>
<thead>
<tr>
<th>Must be same for all CAs in a CA pool</th>
<th>Can be different for all CAs in a CA pool</th>
<th>Must be different for all CAs in a CA pool</th>
</tr>
</thead>
<tbody>
<tr>
<td><ul><li>Certificate issuance policies</li><li>IAM conditions</li><li>Tier</li><li>Location</li><li>Publishing options. For example, whether to publish a CRL.</li></ul></td>
<td><ul><li>Algorithms and sizes of signing keys</li><li>CA subjects and SANs</li><li>Expiration date and validity period</li><li>Labels</li><li>Customer-managed Cloud Storage bucket used for CRL and AIA.</li><li>Customer-managed CA keys</li><li>CA certificate extensions</li></ul></td>
<td><ul><li>CA name</li></ul></td>
</tr>
</tbody>
</table>
<h2 data-text="Achieve higher QPS" id="higher-qps">Achieve higher QPS</h2>
<p>Certificate Authority Service enforces <a href="/certificate-authority-service/quotas">limits on the number of requests</a> you can
send. For example, the usage limit for the
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates/create">createCertificate</a> request for a DevOps CA is 25
<a class="external" href="https://wikipedia.org/wiki/Queries_per_second">QPS</a>.</p>
<p>To increase your total effective QPS, you must have multiple
CAs in a CA pool. A CA pool increases the total effective QPS by
distributing the incoming certificate requests across all CAs in the <code dir="ltr" translate="no">ENABLED</code>
<a href="/certificate-authority-service/docs/certificate-authority-states">state</a>. However, you can still <a href="/certificate-authority-service/docs/requesting-certificates#issue-certificate-specific-ca">request certificates from a particular
CA in the CA pool</a>.</p>
<p>You can use the following formula to calculate the maximum allowed QPS for a CA
pool:</p>
<p><code dir="ltr" translate="no">Total effective QPS = min(100, number of CAs in the CA pool x QPS per CA)</code></p>
<p>For example, if the effective QPS for a CA is 25 QPS and if you create 4 CAs in
a CA pool, then the total effective QPS of the CA pool is 100 QPS.</p>
<p>For more information about achieving a higher total effective QPS, see <a href="/certificate-authority-service/docs/higher-qps">Achieve
a higher QPS using a CA pool</a>.</p>
<h2 data-text="Manage CA rotation" id="ca-rotation">Manage CA rotation</h2>
<p>A CA pool can have CAs that are in different <a href="/certificate-authority-service/docs/certificate-authority-states">states</a>. A CA pool
load-balances certificate issuance for workloads across the enabled CAs in a CA
pool.</p>
<p>The CA pool abstracts the specific CAs within it that issue certificates. When
a CA expires, the total effective QPS of the CA pool gets reduced. For example,
if a CA pool has 4 enabled CAs, the total effective QPS for that CA pool is
100 QPS. But if one CA in the CA pool expires, the total effective QPS gets
reduced to 75 QPS. To ensure that the total effective QPS of the CA pool remains
unaffected when a CA expires, you must create a new CA before the existing CA
expires.</p>
<p>For more information, see <a href="/certificate-authority-service/docs/managing-ca-rotation">Managing CA
rotation</a>.</p>
<p>For information about requesting an increase in quota, see <a href="/docs/quota#requesting_higher_quota">Requesting a higher
quota limit</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/docs/quota">work with quotas</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-ca-pool">create a CA pool</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/operations-ca-pool">update and delete a CA pool</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/policy-controls]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Policy controls" id="policy-controls">Policy controls</h1>
<p>This topic describes the scenarios when you should use various policy controls.</p>
<p>Policy controls enable you to control the type of certificates that your certificate authority (CA) pool can issue. Policy controls are of two types: coarse-grained and fine-grained. Coarse-grained policies apply CA pool-specific constraints. Fine-grained policies determine the operations a particular user can perform on a CA pool.</p>
<h2 data-text="Certificate templates" id="certificate-template">Certificate templates</h2>
<p>You can use a certificate template when you have a well-defined certificate issuance scenario. You can use certificate templates to enable consistency across certificates issued from different CA pools. You can also use a certificate template to restrict the kinds of certificates that different individuals can issue. For more information, see <a href="/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</p>
<p>For information about creating certificate templates, see <a href="/certificate-authority-service/docs/creating-certificate-template">Creating certificate templates</a>.</p>
<h2 data-text="Certificate issuance policies" id="issuance-policies">Certificate issuance policies</h2>
<p>A CA Manager can attach a
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#issuancepolicy">certificate issuance policy</a>
to a CA pool to define restrictions on the kind of certificates that the CAs in the CA pool can
issue. An issuance policy can define restrictions on certificate identities, certificate lifetimes, key types, certificate request
modes, and X.509 extensions. The issuance policy can also contain a set of X.509 extensions
that are applied to all incoming certificate requests.</p>
<p>Issuance policies let you apply certain restrictions on the entire CA pool. For
example, you can use an issuance policy to enforce the following conditions:</p>
<ul>
<li>All issued certificates have <code dir="ltr" translate="no">O=My organization</code> in their subject.</li>
<li>All DNS names end with <code dir="ltr" translate="no">.my-org-domain.com</code>.</li>
<li>The CA pool can only issue Server TLS certificates.</li>
</ul>
<p>If one or both of the following cases apply, we recommend using a certificate
issuance policy:</p>
<ol>
<li>Your CA pool is intended to issue certificates according to a single, well-defined profile.</li>
<li>You want to define a common baseline for X.509 extensions and additional restrictions that apply to all the certificate issuance profiles.</li>
</ol>
<p>For more information about issuance policies, see <a href="/certificate-authority-service/docs/use-issuance-policy">Using an issuance policy</a>.</p>
<h2 data-text="IAM policies" id="iam-policies">IAM policies</h2>
<p>It is important to implement the security principle of least privilege to protect the integrity of CA Service resources. Through the implementation of discrete Identity and Access Management (IAM) roles, organizations can better manage the security of the CA pool and the overall PKI itself.</p>
<h3 data-text="General IAM policies" id="general-iam">General IAM policies</h3>
<p>CA Service lets you grant IAM roles to users or service accounts for creating and managing resources. You can add these role bindings at the following levels:</p>
<ul>
<li>CA pool-level to manage access for a specific CA pool and for the CAs in that CA pool.</li>
<li>Project or organization-level to grant access to all CA pools in that scope.</li>
</ul>
<p>Roles are inherited, if granted at a higher resource-level. For example, a user who is granted the Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) role at the project-level is able to view all resources under the project.</p>
<p>For the complete list of predefined IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined_roles">Predefined roles</a>.</p>
<h3 data-text="Conditional IAM policies" id="conditional-iam">Conditional IAM policies</h3>
<p>If you have a shared CA pool that might be used by multiple users who are authorized to request different types of certificates, you can implement controls through conditional IAM policies to limit the per-user permissions to perform
certain operations on a CA pool.</p>
<p>IAM conditional bindings help control the permissions a specific user or group is allowed under a set of conditions. For example, if the
<a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined_roles">Certificate Requester</a>
role is bound to the user <code dir="ltr" translate="no">alice@example.com</code> on a CA pool with the condition that the requested DNS SANs are a subset of <code dir="ltr" translate="no">['alice@example.com', 'bob@example.com']</code>, then that user is
able to request certificates from the same CA pool only if the requested SAN is one of those two allowed values. You can set conditions on IAM bindings using Common Expression Language (CEL) expressions. These conditions can help you further restrict the type of certificates a user is able to request. For information on using CEL expressions for IAM conditions, see <a href="/certificate-authority-service/docs/using-cel#iam-policies">Common Expression Language (CEL) dialect for IAM policies</a>.</p>
<p>For information on configuring IAM policies, see <a href="/certificate-authority-service/docs/configuring-iam">Configuring IAM policies</a>.</p>
<h2 data-text="Policy conflicts" id="policy-conflicts">Policy conflicts</h2>
<p>When using different policy control mechanisms in conjunction, there is a possibility that policies on different levels can conflict. This section describes how policy controls get enforced and provides guidance on avoiding policy conflicts.</p>
<h3 data-text="Policy enforcement" id="policy-enforcement">Policy enforcement</h3>
<p>When requesting certificates, policy controls are evaluated at different layers.</p>
<p>IAM conditional bindings for request attributes are evaluated first to ensure the caller has the required permissions for creating certificates or using certificate templates.</p>
<p>During certificate creation the CA pool and the certificate template issuance policy are validated against the normalized certificate request. X.509 extensions from the CA pool's certificate issuance policy and the certificate template are added to the certificate, and certain values can be dropped based on those same policies.</p>
<h3 data-text="Issuance policy conflicts" id="issuance-policy-conflicts">Issuance policy conflicts</h3>
<p>The following is a non-comprehensive list of errors where the issuance policy of a certificate template can conflict with the issuance policy of a CA pool.</p>
<ul>
<li>A certificate template contains predefined values that are prohibited by the CA pool, or vice versa.</li>
<li>A certificate template contains different X.509 values than the CA pool baseline values, or vice versa.</li>
</ul>
<p>In all these cases, the API returns an invalid argument error.</p>
<h3 data-text="CEL conflicts" id="cel-conflicts">CEL conflicts</h3>
<p>CEL provides the ability to implement diverse expressions. There can be situations where the CEL expressions on the CA pool's issuance policy and on the certificate template conflict. These conflicts disallow certificates to be issued from the CA pool. For example, consider the situation that a CA pool had a CEL expression enforcing the common name of a certificate to end in <code dir="ltr" translate="no">.example.com</code> and the certificate template had a CEL expression enforcing the common name of a certificate to end in <code dir="ltr" translate="no">.example.net</code>. Since these two CEL expressions place different restrictions on the same field, all certificate issuance requests fail.</p>
<p>If you are using both certificate issuance policies and certificate templates, we recommend that you ensure that their CEL expressions do not conflict.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/certificate-authority-service/docs/using-cel">using Common Expression Language (CEL)</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/using-identity-reflection]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Identity reflection" id="identity-reflection">Identity reflection</h1>
<p>Identity reflection is a special certificate issuance mode that limits an unprivileged certificate requester to requesting certificates with a SAN corresponding to the identity in their credential. For example, an Anthos Service Mesh (ASM) workload with a federated third-party identity token might be able to request a certificate with a SAN corresponding to its Mesh identity, but cannot request a certificate with any other SAN.</p>
<aside class="note"><strong>Note:</strong><span> Identity reflection is only supported for workloads using <a href="/kubernetes-engine/docs/how-to/workload-identity">GKE
workload identity</a> and/or <a href="/anthos/multicluster-management/fleets">
fleets</a>. It does not support
<a href="/iam/docs/workload-identity-federation">IAM workload identity
federation</a>.</span></aside>
<h2 data-text="Request subject mode for the certificate" id="request_subject_mode_for_the_certificate">Request subject mode for the certificate</h2>
<p>To use identity reflection, the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates#Certificate.FIELDS.subject_mode">subject_mode</a> field on the requested certificate must be set to <code dir="ltr" translate="no">REFLECTED_SPIFFE</code>.</p>
<p>The workload requesting identity reflection must have the <code dir="ltr" translate="no">roles/privateca.workloadCertificateRequester</code> permission. For information on setting an IAM role, see <a href="/certificate-authority-service/docs/configuring-iam">Configuring IAM</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="https://spiffe.io">SPIFFE</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/samples]</H1></p><div class="devsite-article-body clearfix">
<p>This page contains code samples for Certificate Authority Service. To search and filter code samples for other
Google Cloud products, see the
<a class="cloud-link" href="/docs/samples?p=privateca">Google Cloud sample browser</a>.</p>
<div class="cloud-card__container">
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Activate a Subordinate Certificate Authority" id="activate-a-subordinate-certificate-authority">Activate a Subordinate Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Activate an already created Subordinate Certificate Authority.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-activate-subordinateca#privateca_activate_subordinateca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-activate-subordinateca#privateca_activate_subordinateca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-activate-subordinateca">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a CA pool" id="create-a-ca-pool">Create a CA pool</h4>
<p class="cloud-body-text" id="desc">Create a new CA pool in the specified project and zone.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca-pool#privateca_create_ca_pool-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca-pool#privateca_create_ca_pool-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca-pool">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/creating-ca-pool">Creating CA pools</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a certificate" id="create-a-certificate">Create a certificate</h4>
<p class="cloud-body-text" id="desc">Issue/ create a new certificate using a certificate authority.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate#privateca_create_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate#privateca_create_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/tutorials/using-3pi-with-reflection">Issue certificates that attest to third-party identity</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Create a Certificate template" id="create-a-certificate-template">Create a Certificate template</h4>
<p class="cloud-body-text" id="desc">Create a Certificate template that can be reused for common certificate issuance scenarios.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-template#privateca_create_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-template#privateca_create_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a root Certificate Authority" id="create-a-root-certificate-authority">Create a root Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Create a root Certificate Authority under a CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca#privateca_create_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca#privateca_create_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-authorities">Creating certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a Subordinate Certificate Authority" id="create-a-subordinate-certificate-authority">Create a Subordinate Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Create a subordinate certificate authority from a root or subordinate CA.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-subordinateca#privateca_create_subordinateca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-subordinateca#privateca_create_subordinateca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-subordinateca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-authorities">Creating certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create Certificate using Certificate Signing Request " id="create-certificate-using-certificate-signing-request">Create Certificate using Certificate Signing Request </h4>
<p class="cloud-body-text" id="desc">Issue certificate by the specified certificate authority using a CSR.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-csr#privateca_create_certificate_csr-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-csr#privateca_create_certificate_csr-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-create-certificate-csr">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Delete a Certificate template" id="delete-a-certificate-template">Delete a Certificate template</h4>
<p class="cloud-body-text" id="desc">Delete the specified certificate template from project.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-certificate-template#privateca_delete_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-certificate-template#privateca_delete_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete CA pool" id="delete-ca-pool">Delete CA pool</h4>
<p class="cloud-body-text" id="desc">Delete the specified CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca-pool#privateca_delete_ca_pool-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca-pool#privateca_delete_ca_pool-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca-pool">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/operations-ca-pool">Updating and deleting a CA pool</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete Certificate Authority" id="delete-certificate-authority">Delete Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Delete the Certificate Authority from the specified CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca#privateca_delete_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca#privateca_delete_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-delete-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/deleting-certificate-authorities">Deleting certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Disable a Certificate Authority" id="disable-a-certificate-authority">Disable a Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Disable a Certificate Authority in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-disable-ca#privateca_disable_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-disable-ca#privateca_disable_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-disable-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/managing-ca-state">Managing CA state</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Enable a Certificate Authority" id="enable-a-certificate-authority">Enable a Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Enable the Certificate Authority in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-enable-ca#privateca_enable_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-enable-ca#privateca_enable_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-enable-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/managing-ca-state">Managing CA state</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Filter certificates" id="filter-certificates">Filter certificates</h4>
<p class="cloud-body-text" id="desc">Filter certificates based on a condition.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-filter-certificate#privateca_filter_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-filter-certificate#privateca_filter_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-filter-certificate">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="List CA pool" id="list-ca-pool">List CA pool</h4>
<p class="cloud-body-text" id="desc">List all CA pools in the given project and location.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca-pool#privateca_list_ca_pool-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca-pool#privateca_list_ca_pool-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca-pool">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List Certificate Authorities" id="list-certificate-authorities">List Certificate Authorities</h4>
<p class="cloud-body-text" id="desc">List all Certificate Authorities in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca#privateca_list_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca#privateca_list_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-ca">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/listing-certificate-authorities">Listing certificate authorities</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="List Certificate templates" id="list-certificate-templates">List Certificate templates</h4>
<p class="cloud-body-text" id="desc">List the Certificate templates in the specified project and location.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate-template#privateca_list_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate-template#privateca_list_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List Certificates" id="list-certificates">List Certificates</h4>
<p class="cloud-body-text" id="desc">List Certificates in the given CA pool.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate#privateca_list_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate#privateca_list_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-list-certificate">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Monitor expiring Certificate Authorities" id="monitor-expiring-certificate-authorities">Monitor expiring Certificate Authorities</h4>
<p class="cloud-body-text" id="desc">Create a monitoring policy that notifies 30 days before a managed CA expires.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-monitor-ca-expiry#privateca_monitor_ca_expiry-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-monitor-ca-expiry#privateca_monitor_ca_expiry-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-monitor-ca-expiry">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Revoke a Certificate" id="revoke-a-certificate">Revoke a Certificate</h4>
<p class="cloud-body-text" id="desc">Revoke an issued Certificate.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-revoke-certificate#privateca_revoke_certificate-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-revoke-certificate#privateca_revoke_certificate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-revoke-certificate">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/certificate-authority-service/docs/revoking-certificates">Revoking certificates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Set/ Update Issuance Policy" id="set-update-issuance-policy">Set/ Update Issuance Policy</h4>
<p class="cloud-body-text" id="desc">Set/ Update the issuance policy for a CA pool. All certificates issued from this CA pool should meet the issuance policy.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-set-issuance-policy#privateca_set_issuance_policy-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-set-issuance-policy#privateca_set_issuance_policy-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-set-issuance-policy">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Undelete a Certificate Authority" id="undelete-a-certificate-authority">Undelete a Certificate Authority</h4>
<p class="cloud-body-text" id="desc">Restore a deleted CA, if still within the grace period of 30 days.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-undelete-ca#privateca_undelete_ca-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-undelete-ca#privateca_undelete_ca-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-undelete-ca">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Update a Certificate template" id="update-a-certificate-template">Update a Certificate template</h4>
<p class="cloud-body-text" id="desc">Update an existing Certificate template.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-certificate-template#privateca_update_certificate_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-certificate-template#privateca_update_certificate_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-certificate-template">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Update Certificate Authority Label" id="update-certificate-authority-label">Update Certificate Authority Label</h4>
<p class="cloud-body-text" id="desc">Update the labels in a Certificate Authority.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-ca-label#privateca_update_ca_label-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-ca-label#privateca_update_ca_label-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/certificate-authority-service/docs/samples/privateca-update-ca-label">
            View sample
          </a>
</div>
</div>
</div>
</div>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/how-to]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="first-group">
<header>
<h2 data-text="Managing CA pools" id="managing-ca-pools">Managing CA pools</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/creating-ca-pool">
<h3 class="hide-from-toc no-link" data-text="Creating CA pools" id="creating-ca-pools">Creating CA pools</h3>
<p>
    Learn how to create a certificate authority (CA) pool.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/managing-ca-rotation">
<h3 class="hide-from-toc no-link" data-text="Managing CA rotation" id="managing-ca-rotation">Managing CA rotation</h3>
<p>
    Learn how to manage the rotation and expiration of CAs in a CA pool.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/operations-ca-pool">
<h3 class="hide-from-toc no-link" data-text="Updating and deleting a CA pool" id="updating-and-deleting-a-ca-pool">Updating and deleting a CA pool</h3>
<p>
    Learn how to perform operations such as updating the labels of a CA pool,
    updating a CA pool's issuance policy, and enabling and disabling CA
    certificate publication and CRL publication to Cloud Storage buckets.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/higher-qps">
<h3 class="hide-from-toc no-link" data-text="Achieving a higher QPS" id="achieving-a-higher-qps">Achieving a higher QPS</h3>
<p>
    Learn how to achieve a higher QPS using a CA pool.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="second-group">
<header>
<h2 data-text="Managing policy controls" id="managing-policy-controls">Managing policy controls</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/creating-certificate-template">
<h3 class="hide-from-toc no-link" data-text="Creating certificate templates" id="creating-certificate-templates">Creating certificate templates</h3>
<p>
    Learn how to create and use a certificate template.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/use-issuance-policy">
<h3 class="hide-from-toc no-link" data-text="Using a certificate issuance policy" id="using-a-certificate-issuance-policy">Using a certificate issuance policy</h3>
<p>
    Learn how to set a certificate issuance policy for a CA pool.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/using-cel">
<h3 class="hide-from-toc no-link" data-text="Using Common Expression Language" id="using-common-expression-language">Using Common Expression Language</h3>
<p>
    Learn how to use Common Expression Language (CEL) with certificate issuance policies, certificate templates, and IAM conditions on your CA pool.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/configuring-iam">
<h3 class="hide-from-toc no-link" data-text="Configuring, modifying, and removing IAM policies" id="configuring,-modifying,-and-removing-iam-policies">Configuring, modifying, and removing IAM policies</h3>
<p>
    Learn how to set, modify, and remove an IAM policy for a CA pool.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="third-group">
<header>
<h2 data-text="Managing certificate authorities" id="managing-certificate-authorities">Managing certificate authorities</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/creating-certificate-authorities">
<h3 class="hide-from-toc no-link" data-text="Creating certificate authorities" id="creating-certificate-authorities">Creating certificate authorities</h3>
<p>
    Learn how to create CAs.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/choosing-key-algorithm">
<h3 class="hide-from-toc no-link" data-text="Choosing a key algorithm" id="choosing-a-key-algorithm">Choosing a key algorithm</h3>
<p>
    Learn how to choose an appropriate key algorithm for your CA.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/managing-ca-state">
<h3 class="hide-from-toc no-link" data-text="Managing CA state" id="managing-ca-state">Managing CA state</h3>
<p>
    Learn how to manage the state of a CA.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/updating-certificate-authorities">
<h3 class="hide-from-toc no-link" data-text="Updating certificate authorities" id="updating-certificate-authorities">Updating certificate authorities</h3>
<p>
    Learn how to update CAs.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/listing-certificate-authorities">
<h3 class="hide-from-toc no-link" data-text="Listing certificate authorities" id="listing-certificate-authorities">Listing certificate authorities</h3>
<p>
    Learn how to list root and subordinate CAs.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/deleting-certificate-authorities">
<h3 class="hide-from-toc no-link" data-text="Deleting certificate authorities" id="deleting-certificate-authorities">Deleting certificate authorities</h3>
<p>
    Learn how to delete a CA.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="fourth-group">
<header>
<h2 data-text="Managing certificates" id="managing-certificates">Managing certificates</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/requesting-certificates">
<h3 class="hide-from-toc no-link" data-text="Requesting certificates" id="requesting-certificates">Requesting certificates</h3>
<p>
    Learn how to request a certificate from CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/revoking-certificates">
<h3 class="hide-from-toc no-link" data-text="Revoking certificates" id="revoking-certificates">Revoking certificates</h3>
<p>
    Learn how to configure Certificate Revocation Lists (CRLs) and revoke
    certificates.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/sorting-filtering-certificates">
<h3 class="hide-from-toc no-link" data-text="Sorting and filtering certificates" id="sorting-and-filtering-certificates">Sorting and filtering certificates</h3>
<p>
    Learn how to sort and filter results when listing certificates.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="fifth-group">
<header>
<h2 data-text="Tutorials" id="tutorials">Tutorials</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/tutorials/using-3pi-with-reflection">
<h3 class="hide-from-toc no-link" data-text="Tutorial: Using third-party identities with identity reflection" id="tutorial:-using-third-party-identities-with-identity-reflection">Tutorial: Using third-party identities with identity reflection</h3>
<p>
    Learn how to use identity reflection with workload identity pools to issue certificates that attest to a third-party identity.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/tutorials/manage-policy-controls">
<h3 class="hide-from-toc no-link" data-text="Tutorial: Managing policy controls" id="tutorial:-managing-policy-controls">Tutorial: Managing policy controls</h3>
<p>
    Learn how to perform various policy management operations that allow control over certificate issuance and access to CA Service resources.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="sixth-group">
<header>
<h2 data-text="Using Cloud Audit Logs" id="using-cloud-audit-logs">Using Cloud Audit Logs</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/audit-logging">
<h3 class="hide-from-toc no-link" data-text="Using Cloud Audit Logs" id="using-cloud-audit-logs_1">Using Cloud Audit Logs</h3>
<p>
    Learn how to enable Cloud Audit Logs, and find, read, and export the audit logs created by CA Service.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="seventh-group">
<header>
<h2 data-text="Using Cloud Monitoring" id="using-cloud-monitoring">Using Cloud Monitoring</h2>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/monitoring">
<h3 class="hide-from-toc no-link" data-text="Using Cloud Monitoring" id="using-cloud-monitoring_1">Using Cloud Monitoring</h3>
<p>
    Learn how to use Cloud Monitoring to monitor the operations performed on CA Service resources.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/creating-ca-pool]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Creating CA pools" id="creating-ca-pools">Creating CA pools</h1>
<p>This topic describes how to create certificate authority (CA) pools.</p>
<p>A CA pool is a collection of multiple CAs with a common certificate
issuance policy and Identity and Access Management (IAM) policy. A CA pool makes
CA rotation management easier and lets you achieve higher total effective
queries per second (QPS).</p>
<p>You must create a CA pool before you can use Certificate Authority Service to create a CA.
For more information, see <a href="/certificate-authority-service/docs/ca-pool">CA pool</a>.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Make sure you have the CA Service Operation Manager
(<code dir="ltr" translate="no">roles/privateca.caManager</code>) IAM role. For information about
granting an IAM to a principal, see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single
role</a>.</p>
<h2 data-text="Deciding the CA pool's settings" id="settings">Deciding the CA pool's settings</h2>
<p>This section describes the settings of a CA pool and provides recommendations
for deciding the settings.</p>
<h3 data-text="Permanent CA pool settings" id="permanent-settings">Permanent CA pool settings</h3>
<p>The following CA pool settings can't be changed after creating the CA pool.</p>
<dl>
<dt>Location</dt>
<dd><p>Specify the CA pool's location. A CA pool is stored in a single
<a href="/about/locations">Google Cloud location</a>. We recommend that you
create your CA pool in the same location or near the location where you intend
to use it.</p></dd>
<dd><p>For the complete list of supported locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</p></dd>
<dt>Tier</dt>
<dd><p>Choose whether you want to create the CA pool with the DevOps or the Enterprise
tier. This choice affects whether CA Service persists the created
certificates, whether created certificates can later be revoked, and the
maximum rate at which you can create certificates from the CAs in the CA pool.
For more information, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</p></dd>
</dl>
<h3 data-text="Optional CA pool settings" id="optional-settings">Optional CA pool settings</h3>
<dl>
<dt>Certificate issuance policy</dt>
<dd><p>A CA pool can have a certificate issuance policy. This issuance policy places restrictions on the certificates that the CAs in the CA pool are allowed to issue. You can update the issuance policy of a CA pool after you create the CA pool. For more information, see <a href="/certificate-authority-service/docs/policy-controls#issuance-policies">Certificate issuance policies</a>.</p></dd>
<dd><p>For more information about configuring a certificate issuance policy, see
<a href="/certificate-authority-service/docs/use-issuance-policy">Using a certificate issuance policy</a>.</p></dd>
<dt>Publishing options</dt>
<dd><p>You can configure a CA pool to publish the CA certificates for each of its CAs.
When issuing a certificate, the URL to this CA certificate is included in the
certificate as an authority information access (AIA) extension.</p></dd>
<dd><p>CAs in Enterprise tier CA pools can be permitted to publish certificate
revocation lists (CRLs) to the associated Cloud Storage
bucket. When issuing a certificate, a URL to this CRL is included in the
certificate as the CRL Distribution Point (CDP) extension. You cannot find
the CRL without the CDP extension in the certificate. For more information,
see <a href="/certificate-authority-service/docs/revoking-certificates">Revoking certificates</a>.</p></dd>
<dd><p>If you create the CA pool using Google Cloud CLI or Google Cloud console,
CA Service enables these publishing options by default. For
more information, see <a href="/certificate-authority-service/docs/operations-ca-pool#disable-extensions">Disable CA certificate and/or CRL publication for CAs in a CA
pool</a>.</p></dd>
</dl>
<h2 data-text="Creating a CA pool" id="create-ca-pool">Creating a CA pool</h2>
<p>To create a CA pool, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><p><strong>Choose a name for the CA pool</strong></p>
<ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click <strong>CA pool manager</strong>.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">add_box</span><strong>Create pool</strong>.</p></li>
<li><p>Add a name for the CA pool that is unique for the region.</p></li>
<li><p>Select a region from the drop-down in the <strong>Region</strong> field. For more information, see
<a href="/certificate-authority-service/docs/locations#choosing-best-location">Choosing the best location</a>.</p></li>
<li><p>Select either the Enterprise or the DevOps tier. For more information, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
</ol>
<p><strong>Configure allowed key algorithms and sizes</strong></p>
<p>CA Service lets you choose the signing algorithms for the
Cloud KMS keys that back the CAs in the CA pool. All key algorithms
are allowed by default.</p>
<p>To restrict the allowed keys in the certificates issued by the CA pool, do
the following. This is an optional procedure.</p>
<ol>
<li>Click the toggle.</li>
<li>Click <strong>Add an item</strong>.</li>
<li><p>In the <strong>Type</strong> list, select the key type.</p>
<p>If you want to use RSA keys, do the following:</p>
<ol>
<li>Optional: Add the minimum modulus size in bits.</li>
<li>Optional: Add the maximum modulus size in bits.</li>
<li>Click <strong>Done</strong>.</li>
</ol>
<p>If you want to use elliptic curve keys, do the following:</p>
<ol>
<li>Optional: In the <strong>Elliptic curve type</strong> list, select the elliptic
curve type.</li>
<li>Click <strong>Done</strong>.</li>
</ol></li>
<li><p>To add another allowed key, click <strong>Add an item</strong>, and repeat Step 2.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
</ol>
<p><strong>Configure certificate request methods</strong></p>
<p>To place limitations on the methods that certificate requesters can use to
request certificates from the CA pool, do the following:</p>
<ol>
<li>Optional: To restrict CSR-based certificate requests, click the toggle.</li>
<li>Optional: To restrict configuration-based certificate requests, click the
toggle.</li>
</ol>
<p><strong>Configure publishing options</strong></p>
<p>To configure publishing options, do the following:</p>
<ol>
<li>Optional: To disallow publishing CA certificates to the Cloud Storage
bucket for the CAs in the CA pool, click the toggle.</li>
<li><p>Optional: To disallow publishing CRLs to the Cloud Storage bucket for
the CAs in the CA pool, click the toggle.</p>
<p><img class="screenshot" data-modal-dialog-id="pub-options" src="/certificate-authority-service/images/configure-publishing-options.png" style="width: 55%"/>
<devsite-lightbox id="pub-options">
<img alt="Configure publishing options for CA certificates and CRLs for the CAs in the CA pool." src="/certificate-authority-service/images/configure-publishing-options.png"/>
</devsite-lightbox></p></li>
<li><p>Click <strong>Next</strong>.</p></li>
</ol>
<b>Configure identity constraints</b>
<p>To configure constraints on the subject and SANs in the certificates that
  the CA pool issues, do the following:</p>
<ol>
<li>
    Optional: To disallow subject in certificate requests from being passed
    through, click the toggle.
  </li>
<li>
    Optional: To disallow subject alternative names in certificate requests
    from being passed through, click the toggle.
  </li>
<li>
    Optional: Add a Common Expression Language (CEL) expression to place
    restrictions on certificate subjects. For more information, see
    <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure extension constraints</b>
<p>To disallow all extensions from certificate requests from being included in
   the issued certificates, click the toggle.
</p>
<p>
  After you click the toggle, you will see the <b>Known certificate
  extensions</b> field that you can use to select the certificate extensions. To
  select the certificate extensions, do the following:
</p>
<ol>
<li>
    Optional: Click the <b>Known certificate extensions</b> field, and clear the
    unrequired extensions from the menu.
  </li>
<li>
    Optional: In the <b>Custom extensions</b> field, add the object identifiers
    for extensions you want to be included in the certificates that the CA pool
    issues.
  </li>
</ol>
<b>Configure baseline values</b>
<p>
  To configure baseline values in the certificates issued from the CA pool, do
  the following:
</p>
<ol>
<li>
    Click the toggle.
  </li>
<li>
    Click <b>Configure baseline values</b>.
  </li>
</ol>
<b>Define base key usage</b>
<p>
  You can use this setting to configure the ways in which the key contained in
  the certificate can be used. The options for key usage include key
  encipherment, data encipherment, certificate signing, CRL signing, and more.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">Key usage</a>
</p>
<p>
  To define the base key usages, do the following:
</p>
<ol>
<li>
    Optional: In the window that appears, click the toggle, if
    you want to specify base key usages for the certificates.
  </li>
<li>
    Select the checkboxes for the ways in which you want a key to be used.
  </li>
<img class="screenshot" data-modal-dialog-id="base-key" src="/certificate-authority-service/images/base-key-usage.png" style="width: 55%"/>
<devsite-lightbox id="base-key">
<img alt="Select the high-level ways in which you want a key to be used." src="/certificate-authority-service/images/base-key-usage.png"/>
</devsite-lightbox>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Define extended key usage</b>
<p>
  You can use this setting to select more granular scenarios for which the key
  contained in the certificate can be used. The options include server
  authentication, client authentication, code signing, email protection, and
  more.
</p>
<p>
  Extended key usages are defined using object identifiers (OIDs). If you don't
  configure the extended key usages, all key usage scenarios are allowed.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">Extended key usage</a>.
</p>
<p>
  To define the extended key usages, do the following:
</p>
<ol>
<li>
    Optional: To specify the extended key usages for the certificates that the
    CA pool issues, click the toggle.
  </li>
<li>
    Select the checkboxes for the extended key usage scenarios.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Define policy identifiers</b>
<p>
  The certificate policies extension in the certificate expresses the policies
  that the issuing CA pool follows. This extension can include information about how
  identities are validated before certificate issuance, how certificates are
  revoked, and how the CA pool's integrity is ensured. This extension helps you
  verify the certificates that the CA pool issues and see how the certificates
  are used.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.4">Certificate policies</a>.
</p>
<p>
  To specify the policy that defines the certificate usage, do the following:
</p>
<ol>
<li>
    Optional: Add the policy identifier in the <b>Policy identifiers</b> field.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Add Authority information access (AIA) OCSP servers</b>
<p>
  The AIA extension in a certificate provides the following information:
</p>
<ul>
<li>
    Address of the OCSP servers from where you can check the revocation status
    of the certificate.
  </li>
<li>
    The access method for the issuer of the certificate.
  </li>
</ul>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.2.1">Authority information access</a>.
</p>
<p>
  To add the OCSP servers that appear in the AIA extension field in the
  certificates, do the following. The following procedure is optional.
</p>
<ol>
<li>
    Optional: Click <b>Add item</b>.
  </li>
<li>
    In the <b>Server URL</b> field, add the URL of the OCSP server.
  </li>
<li>
    Click <b>Done</b>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure additional extensions</b>
<p>
  To configure additional custom extensions to include in the
  certificates issued by the CA pool, do the following. The following procedure
  is optional.
</p>
<ol>
<li>
    Click <b>Add item</b>.
  </li>
<li>
    In the <b>Object identifier</b> field, add a valid object identifier that
    is formatted as dot-separated digits.
  </li>
<li>
    In the <b>Value</b> field, add the base64-encoded value for the identifier.
  </li>
<li>
    If the extension is critical, select <b>Extension is critical</b>.
  </li>
</ol>
<p>
  To save all the baseline value configurations, click <b>Done</b>.
</p>
<p>To create the CA pool, click <strong>Done</strong>.</p></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>
Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">POOL_NAME</var>
</code></pre>
<p>Replace <var translate="no">POOL_NAME</var> with the name of the CA pool.</p>
<p>If you don't specify which tier you require for your CA pool, the <code dir="ltr" translate="no">Enterprise</code>
tier is selected by default. If you want to specify the tier for your
CA pool, run the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">POOL_NAME</var> --tier=<var translate="no">TIER_NAME</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_NAME</var>: The name of your CA pool.</li>
<li><var translate="no">TIER_NAME</var>: Either <code dir="ltr" translate="no">devops</code> or <code dir="ltr" translate="no">enterprise</code>. For
more information, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools create</code> command, see
<a href="/sdk/gcloud/reference/privateca/pools/create">gcloud privateca pools create</a>.</p>
<p>For information about placing restrictions on the type of certificates
that a CA pool can issue, see <a href="/certificate-authority-service/docs/use-issuance-policy">Using a certificate issuance
policy</a>.</p></section>
<section><h3 data-text="REST API" id="rest-api">REST API</h3><ol>
<li><p>Create a CA pool.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">POST https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools\?ca_pool_id=<var translate="no">POOL_ID</var></pre>
</section>
<p>
  Request JSON body:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="request body" dir="ltr" suppresswarning="" translate="no">
{
"tier": "ENTERPRISE"
}
</pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Save the request body in a file called <code dir="ltr" translate="no">request.json</code>,
    and execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X POST \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>-H "Content-Type: application/json; charset=utf-8" \<br/>-d @request.json \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools\?ca_pool_id=<var translate="no">POOL_ID</var>"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Save the request body in a file called <code dir="ltr" translate="no">request.json</code>,
    and execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method POST `<br/>  -Headers $headers `<br/>  -ContentType: "application/json; charset=utf-8" `<br/>  -InFile request.json `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools\?ca_pool_id=<var translate="no">POOL_ID</var>" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>",
 "metadata": {...},
 "done": false
}
</pre>
</section>
</p></li>
<li><p>Poll the operation until it is complete.</p>
<p>The operation is complete when the long-running operation's <code dir="ltr" translate="no">done</code> property
is set to <code dir="ltr" translate="no">true</code>.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">GET https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var></pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell_1">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X GET \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows_1">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method GET `<br/>  -Headers $headers `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>",
 "metadata": {...},
 "done": true,
 "response": {
   "@type": "type.googleapis.com/google.cloud.security.privateca.v1.CaPool",
   "name": "...",
   "tier": "ENTERPRISE"
 }
}
</pre>
</section>
</p></li>
</ol></section>
<section><h3 data-text="Terraform" id="terraform">Terraform</h3>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_capool_basic/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_capool_basic/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_capool_basic/main.tf" data-region-tag="privateca_create_ca_pool" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_capool_basic/main.tf/main/privateca_create_ca_pool" translate="no"><code dir="ltr" translate="no">resource "google_privateca_ca_pool" "default" {
  name = "my-pool"
  location = "us-central1"
  tier = "ENTERPRISE"
  publishing_options {
    publish_ca_cert = true
    publish_crl = true
  }
  labels = {
    foo = "bar"
  }
}</code></pre>
</div>
</section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_create_ca_pool-code-sample">
<section>
<h3 data-text="Java" id="privateca_create_ca_pool-java" track-metadata-position="privateca_create_ca_pool" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/CreateCaPool.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/CreateCaPool.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_ca_pool" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_create_ca_pool" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/CreateCaPool.java" data-region-tag="privateca_create_ca_pool" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/CreateCaPool.java/HEAD/privateca_create_ca_pool" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CaPool;
import com.google.cloud.security.privateca.v1.CaPool.Tier;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.CreateCaPoolRequest;
import com.google.cloud.security.privateca.v1.LocationName;
import com.google.longrunning.Operation;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class CreateCaPool {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: Set a unique pool_Id for the CA pool.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    createCaPool(project, location, pool_Id);
  }

  // Create a Certificate Authority Pool. All certificates created under this CA pool will
  // follow the same issuance policy, IAM policies,etc.,
  public static void createCaPool(String project, String location, String pool_Id)
      throws InterruptedException, ExecutionException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      /* Create the pool request
        Set Parent which denotes the project id and location.
        Set the Tier (see: https://cloud.google.com/certificate-authority-service/docs/tiers).
      */
      CreateCaPoolRequest caPoolRequest =
          CreateCaPoolRequest.newBuilder()
              .setParent(LocationName.of(project, location).toString())
              .setCaPoolId(pool_Id)
              .setCaPool(CaPool.newBuilder().setTier(Tier.ENTERPRISE).build())
              .build();

      // Create the CA pool.
      ApiFuture&lt;Operation&gt; futureCall =
          certificateAuthorityServiceClient.createCaPoolCallable().futureCall(caPoolRequest);
      Operation response = futureCall.get();

      if (response.hasError()) {
        System.out.println("Error while creating CA pool !" + response.getError());
        return;
      }

      System.out.println("CA pool created successfully: " + pool_Id);
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_create_ca_pool-python" track-metadata-position="privateca_create_ca_pool" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_ca_pool.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_ca_pool.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_ca_pool" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_create_ca_pool" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/create_ca_pool.py" data-region-tag="privateca_create_ca_pool" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/create_ca_pool.py/HEAD/privateca_create_ca_pool" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1


def create_ca_pool(project_id: str, location: str, ca_pool_name: str) -&gt; None:
    """
    Create a Certificate Authority pool. All certificates created under this CA pool will
    follow the same issuance policy, IAM policies,etc.,

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: a unique name for the ca pool.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    ca_pool = privateca_v1.CaPool(
        # Set the tier (see: https://cloud.google.com/certificate-authority-service/docs/tiers).
        tier=privateca_v1.CaPool.Tier.ENTERPRISE,
    )
    location_path = caServiceClient.common_location_path(project_id, location)

    # Create the pool request.
    request = privateca_v1.CreateCaPoolRequest(
        parent=location_path,
        ca_pool_id=ca_pool_name,
        ca_pool=ca_pool,
    )

    # Create the CA pool.
    operation = caServiceClient.create_ca_pool(request=request)

    print("Operation result:", operation.result())

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-certificate-authorities">create CAs</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/use-issuance-policy">use a certificate issuance policy</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/higher-qps">achieve a higher QPS using a CA pool</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/operations-ca-pool">update and delete a CA pool</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/managing-ca-rotation]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Managing CA rotation" id="managing-ca-rotation">Managing CA rotation</h1>
<p>This document explains how you can manage the rotation of a CA in a CA pool. For more information about CA pools, see <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>.</p>
<aside class="note"><strong>Note:</strong><span> This document provides general guidance on managing CA rotation. We recommend that organizations carefully construct their processes in consultation with security experts.</span></aside>
<h2 data-text="Ensuring seamless CA rotation" id="seamless-ca-rotation">Ensuring seamless CA rotation</h2>
<p>Ensuring seamless CA rotation is essential to avoid a service downtime. The following procedure explains how you can seamlessly rotate a CA.</p>
<aside class="note"><strong>Note:</strong><span> You can manage CA expiration with similar steps. Make sure to create new CAs within the CA pool to avoid increasing load on the remaining CAs.</span></aside>
<ol>
<li>Find the CA pool for the existing CA that is due to expire.</li>
<li><p>Create a CA in the same CA pool.
The CA is created in the <code dir="ltr" translate="no">STAGED</code> state and cannot issue certificates through CA pool load-balancing. CAs in the <code dir="ltr" translate="no">STAGED</code> state can only issue certificates when requested directly by the clients. For more information about CA states, see <a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</p></li>
<li><p>Ensure that all clients have downloaded the latest set of CA certificates from the CA pool.</p>
<aside class="note"><strong>Note:</strong><span> Verify that all your clients have received the new certificates. The clients must use the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools/fetchCaCerts">fetchCaCerts</a> API to retrieve the CA certificates. If you have configured your clients to automatically download the latest set of certificates from the CA pool, then you have to wait until all your clients get the new certificates. Otherwise, you can explicitly publish the new set of certificates to your clients.</span></aside></li>
<li><p>Change the state of the new CA to <code dir="ltr" translate="no">ENABLED</code>. This ensures that certificates can be issued from both the old and the new CA. For information about enabling certificate authorities, see <a href="/certificate-authority-service/docs/managing-ca-state#enable">Enabling a CA</a>.</p>
<aside class="note"><strong>Note:</strong><span> To ensure that the new certificates aren't causing outages, you can now choose to wait and monitor your environment.</span></aside></li>
<li><p>Change the state of the old CA to <code dir="ltr" translate="no">DISABLED</code>. This ensures that certificates can only be issued from the new CA. For information about disabling certificate authorities, see <a href="/certificate-authority-service/docs/managing-ca-state#disable">Disabling a CA</a>.</p>
<aside class="note"><strong>Note:</strong><span> CAs in the <code dir="ltr" translate="no">DISABLED</code> state are still trusted by the clients and provided in the trust anchor for the CA pool.</span></aside></li>
<li><p>Wait until all clients have stopped using the certificates issued from the old CA. You can ensure that in two ways:</p>
<ul>
<li>You can wait for the maximum certificate lifetime.</li>
<li>You can monitor the certificates being used by your clients.</li>
</ul></li>
<li><p>Delete the old CA. For more information about deleting a CA, see <a href="/certificate-authority-service/docs/deleting-certificate-authorities">Deleting a CA</a>.</p></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/managing-ca-state">manage CA states</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/updating-certificate-authorities">update CAs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/operations-ca-pool]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Updating and deleting a CA pool" id="updating-and-deleting-a-ca-pool">Updating and deleting a CA pool</h1>
<p>This page explains how to perform the following operations:</p>
<ul>
<li>Enable and disable CA certificate and CRL publication on Cloud Storage buckets.</li>
<li>Update labels for a CA pool.</li>
<li>Delete a CA pool.</li>
</ul>
<h2 data-text="Enabling CA certificate and CRL publication for CAs in a CA pool" id="enable-crl-publication">Enabling CA certificate and CRL publication for CAs in a CA pool</h2>
<p>CA Service enables CA certificate and CRL publication to
Cloud Storage buckets by default when you create a new CA pool. If you
disabled CA certificate and CRL publishing while creating the CA pool and want
to enable them now, you can follow the instructions in this section.</p>
<p>To enable CA certificate publication and CRL publication for all CAs in a CA
pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Under the <strong>CA pool manager</strong> tab, click the name of the CA pool you want
to edit.</p></li>
<li><p>On the <strong>CA pool</strong> page, click
<span aria-hidden="true" class="material-icons" translate="no">mode_edit</span><strong>Edit</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="edit-pool" src="/certificate-authority-service/images/edit-ca-pool.png"/>
<devsite-lightbox id="edit-pool">
<img alt="Edit an existing CA pool using the Cloud console." src="/certificate-authority-service/images/edit-ca-pool.png"/>
</devsite-lightbox></p></li>
<li><p>Under <strong>Configure allowed key algorithms and sizes</strong>, click <strong>Next</strong>.</p></li>
<li><p>Under <strong>Configure accepted certificate request methods</strong>, click <strong>Next</strong>.</p></li>
<li><p>Under <strong>Configure publishing options</strong>, click the toggle for <strong>Publish CA
certificate to Cloud Storage bucket for CAs in this pool</strong>.</p></li>
<li><p>Click the toggle for <strong>Publish CRL to Cloud Storage bucket for CAs in this pool</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools update <var translate="no">POOL_ID</var> --publish-crl --publish-ca-cert
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the CA pool.</p>
<p>If you enable <code dir="ltr" translate="no">--publish-ca-cert</code>, CA Service writes each CA's CA
certificate to a Cloud Storage bucket, whose path is specified in the CA
resource. The AIA extension in all the issued certificates points to the
Cloud Storage object URL that contains the CA certificate. The CRL
Distribution Point (CDP) extension in all the issued certificates point to
the Cloud Storage object URL that contains the CRL.</p>
<aside class="note"><strong>Note:</strong><span> <code dir="ltr" translate="no">--publish-ca-cert</code> and <code dir="ltr" translate="no">--publish-crl</code> are enabled by default. Use <code dir="ltr" translate="no">--no-publish-ca-cert</code> and <code dir="ltr" translate="no">--no-publish-crl</code> to disable.</span></aside>
<p>To learn more about enabling CRL publication for revoking certificates, see
<a href="/certificate-authority-service/docs/revoking-certificates">Revoking certificates</a>.</p></section>
</div>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools update</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/update">gcloud privateca pools update</a>.</p>
<h2 data-text="Disabling CA certificate and CRL publication for CAs in a CA pool" id="disable-extensions">Disabling CA certificate and CRL publication for CAs in a CA pool</h2>
<p>To disable CA certificate publication or CRL publication for all CAs in a
CA pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Under the <strong>CA pool manager</strong> tab, click the name of the CA pool you want
to edit.</p></li>
<li><p>On the <strong>CA pool</strong> page, click <span aria-hidden="true" class="material-icons" translate="no">mode_edit</span><strong>Edit</strong>.</p></li>
<li><p>Under <strong>Configure allowed key algorithms and sizes</strong>, click <strong>Next</strong>.</p></li>
<li><p>Under <strong>Configure accepted certificate request methods</strong>, click <strong>Next</strong>.</p></li>
<li><p>Under <strong>Configure publishing options</strong>, click the toggle for <strong>Publish CA
certificate to Cloud Storage bucket for CAs in this pool</strong>.</p></li>
<li><p>Click the toggle for <strong>Publish CRL to Cloud Storage bucket for CAs in this pool</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools update <var translate="no">POOL_ID</var> --no-publish-crl --no-publish-ca-cert
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the CA pool.</p></section>
</div>
<p>Disabling distribution points doesn't delete the Cloud Storage bucket or
its permissions, and doesn't remove any CA certificates or CRLs that are
already hosted there. It does, however, mean that future CRLs will no longer
be published to the Cloud Storage bucket, and future certificates won't have
the AIA and CDP extensions.</p>
<h2 data-text="Adding or updating labels on a CA pool" id="update-labels">Adding or updating labels on a CA pool</h2>
<p>A label is a key-value pair that helps you organize your CA Service
resources. You can filter your resources based on their labels.</p>
<p>To add or update labels on a CA pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_2">Console</h3><p>To add a label, do the following:</p>
<ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>In the <strong>CA pool manager</strong> tab, select the CA pool.</p></li>
<li><p>Click <strong>Labels</strong>.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">add</span><strong>Add label</strong>.</p></li>
<li><p>Add a key-value pair.</p></li>
<li><p>Click <strong>Save</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="add-label" src="/certificate-authority-service/images/update-pool-labels.png" style="width: 60%"/>
<devsite-lightbox id="add-label">
<img alt="Add a label to an existing CA pool." src="/certificate-authority-service/images/update-pool-labels.png"/>
</devsite-lightbox></p></li>
</ol>
<p>To edit an existing label, do the following:</p>
<ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>In the <strong>CA pool manager</strong> tab, select the CA pool.</p></li>
<li><p>Click <strong>Labels</strong>.</p></li>
<li><p>Edit the value of the label.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools update <var translate="no">POOL_ID</var> --update-labels foo=bar
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the CA pool.</p></section>
</div>
<h2 data-text="Deleting a CA pool" id="delete">Deleting a CA pool</h2>
<p>You can delete a CA pool only after you have permanently deleted all CAs
within that CA pool. CA Service permanently deletes a CA after a
30-day grace period from when the deletion process is initiated. For more
information, see <a href="/certificate-authority-service/docs/deleting-certificate-authorities">Deleting CAs</a>.</p>
<p>To delete a CA pool, use the following instructions.</p>
<aside class="caution"><strong>Caution:</strong><span> Deletion of a CA pool is not reversible.</span></aside><div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3>
<ol>
<li>
    Go to the <b>Certificate Authority Service</b> page in the
    Cloud console.
  </li>
<p>
<a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service
      </a>
</p>
<li>
    Click the <b>CA pool manager</b> tab.
  </li>
<li>
    In the list of CA pools, select the CA pool you want to delete.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">delete</span><b>Delete</b>.
  </li>
<img class="screenshot" data-modal-dialog-id="delete-pool" src="/certificate-authority-service/images/delete-ca-pool.png" style="width: 85%"/>
<devsite-lightbox id="delete-pool">
<img alt="Permanently delete a CA pool." src="/certificate-authority-service/images/delete-ca-pool.png"/>
</devsite-lightbox>
<li>
    In the dialog box that opens, click <b>Confirm</b>.
  </li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools delete <var label="Pool Name" translate="no">POOL_ID</var>
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the
CA pool that you want to delete.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools delete</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/delete">gcloud privateca pools delete</a>.</p></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_delete_ca_pool-code-sample">
<section>
<h3 data-text="Java" id="privateca_delete_ca_pool-java" track-metadata-position="privateca_delete_ca_pool" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/DeleteCaPool.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/DeleteCaPool.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_delete_ca_pool" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_delete_ca_pool" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/DeleteCaPool.java" data-region-tag="privateca_delete_ca_pool" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/DeleteCaPool.java/HEAD/privateca_delete_ca_pool" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CaPoolName;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.DeleteCaPoolRequest;
import com.google.longrunning.Operation;
import java.io.IOException;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeoutException;

public class DeleteCaPool {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException, TimeoutException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: The id of the CA pool to be deleted.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    deleteCaPool(project, location, pool_Id);
  }

  // Delete the CA pool as mentioned by the pool_Id.
  // Before deleting the pool, all CAs in the pool MUST BE deleted.
  public static void deleteCaPool(String project, String location, String pool_Id)
      throws InterruptedException, ExecutionException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      // Set the project, location and pool_Id to delete.
      CaPoolName caPool =
          CaPoolName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .build();

      // Create the Delete request.
      DeleteCaPoolRequest deleteCaPoolRequest =
          DeleteCaPoolRequest.newBuilder().setName(caPool.toString()).build();

      // Delete the CA Pool.
      ApiFuture&lt;Operation&gt; futureCall =
          certificateAuthorityServiceClient.deleteCaPoolCallable().futureCall(deleteCaPoolRequest);
      Operation response = futureCall.get();

      if (response.hasError()) {
        System.out.println("Error while deleting CA pool !" + response.getError());
        return;
      }

      System.out.println("Deleted CA Pool: " + pool_Id);
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_delete_ca_pool-python" track-metadata-position="privateca_delete_ca_pool" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/delete_ca_pool.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/delete_ca_pool.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_delete_ca_pool" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_delete_ca_pool" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/delete_ca_pool.py" data-region-tag="privateca_delete_ca_pool" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/delete_ca_pool.py/HEAD/privateca_delete_ca_pool" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1


def delete_ca_pool(project_id: str, location: str, ca_pool_name: str) -&gt; None:
    """
    Delete the CA pool as mentioned by the ca_pool_name.
    Before deleting the pool, all CAs in the pool MUST BE deleted.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: the name of the CA pool to be deleted.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    ca_pool_path = caServiceClient.ca_pool_path(project_id, location, ca_pool_name)

    # Create the Delete request.
    request = privateca_v1.DeleteCaPoolRequest(name=ca_pool_path)

    # Delete the CA Pool.
    caServiceClient.delete_ca_pool(request=request)

    print("Deleted CA Pool:", ca_pool_name)

</code></pre>
</div>
</section>
</div></p></section>
</div><aside class="note"><strong>Note:</strong><span> You cannot use the name of the deleted CA pool for another CA pool.</span></aside>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/policy-controls">policy controls</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/use-issuance-policy">use an issuance policy to restrict the type of certificates a CA pool can issue</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/updating-certificate-authorities">update certificate authorities</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/deleting-certificate-authorities">delete certificate authorities</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/higher-qps]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Achieving a higher QPS using a CA pool" id="achieving-a-higher-qps-using-a-ca-pool">Achieving a higher QPS using a CA pool</h1>
<p>This document illustrates how you can achieve a higher effective QPS using a certificate authority (CA) pool. For information about CA pools, see <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Set up a CA pool in your required location. To create a CA pool, follow the instructions in the <a href="/certificate-authority-service/docs/quickstart">quickstart</a> guide. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</p>
<p>We recommend that you create the CA pool in the DevOps tier. The maximum achievable effective QPS for a CA pool is 100 QPS. The maximum QPS for each individual CA within the pool is 25 QPS (in the DevOps tier) or 7 QPS (in the Enterprise tier). If you create the CA pool in the DevOps tier, you have to create 4 CAs within the CA pool to reach a total effective QPS of 100 QPS. For more information about quotas, see <a href="https://cloud.google.com/certificate-authority-service/quotas">Quotas and limits</a>.</p>
<aside class="note"><strong>Note:</strong><span> Support for listing, describing, and revoking certificates is not available for CA pools in the DevOps tier. For more information about tiers, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</span></aside>
<h2 data-text="Procedure" id="procedure">Procedure</h2>
<ol>
<li><p>Create enough CAs within your CA pool to achieve the required QPS. The required number of CAs is 4 for CA pools in the DevOps tiers, and 15 for CA pools in the Enterprise tier. The following set of instructions is for a CA pool in the DevOps tier:</p>
<ol>
<li><p>To create a root CA with the name <code dir="ltr" translate="no">root-1</code> in your CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no"> gcloud privateca roots create root-1 --pool <var translate="no">POOL_NAME</var> --subject="CN=root-1,O=google"
</code></pre>
<p>The total effective QPS of the CA pool at this stage is 25 QPS. To increase the total effective QPS of the CA pool to 100 QPS, you must create 3 more CAs in your CA pool.</p></li>
<li><p>To create a root CA with the name <code dir="ltr" translate="no">root-2</code>, use the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  gcloud privateca roots create root-2 --pool <var translate="no">POOL_NAME</var> --subject="CN=root-2,O=google"
</code></pre></li>
<li><p>To create a root CA with the name <code dir="ltr" translate="no">root-3</code>, use the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  gcloud privateca roots create root-3 --pool <var translate="no">POOL_NAME</var> --subject="CN=root-3,O=google"
</code></pre></li>
<li><p>To create a root CA with the name <code dir="ltr" translate="no">root-4</code>, use the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  gcloud privateca roots create root-4 --pool <var translate="no">POOL_NAME</var> --subject="CN=root-4,O=google"
</code></pre>
<p>At this stage, the total effective QPS of your CA pool is 100 QPS.</p></li>
</ol></li>
<li><p>While CAs are in the <code dir="ltr" translate="no">STAGED</code> state, create and test certificates. Once that is done, enable the CAs. For information on enabling CAs, see <a href="/certificate-authority-service/docs/managing-ca-state#enable">Enabling a CA</a>. For information on testing CAs, see <a href="/certificate-authority-service/docs/creating-certificate-authorities#test">Test a CA</a>.</p></li>
<li><p>Verify the health of your CA pool by getting audit reports on load-balancing across CAs. Ideally, there should be uniformity in the number of certificates issued by each CA.</p>
<p>You can use Cloud Monitoring to monitor your CA pool's load-balancing metrics, such as the number of certificates issued per CA in a given time period. For more information on using Cloud Monitoring, see <a href="/certificate-authority-service/docs/monitoring">Using Cloud Monitoring with CA Service</a>.</p></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="https://cloud.google.com/certificate-authority-service/quotas">quotas and limits</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/creating-certificate-template]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Creating certificate templates" id="creating-certificate-templates">Creating certificate templates</h1>
<p>This topic describes how you can create a certificate template. For an overview of certificate templates, see <a href="/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</p>
<h2 data-text="Creating a certificate template" id="create-template">Creating a certificate template</h2>
<p>To create a certificate template, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates create <var translate="no">TEMPLATE_ID</var> \
  --copy-subject \
  --copy-sans \
  --identity-cel-expression &lt;expr&gt; \
  --predefined-values-file <var translate="no">FILE_PATH</var> \
  --copy-all-requested-extensions \
  --copy-extensions-by-oid &lt;1.2.3.4,5.6.7.8&gt; \
  --copy-known-extensions &lt;ext1,ext2&gt;
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">TEMPLATE_ID</var>: the unique identifier of the certificate template.</li>
<li><var translate="no">FILE_PATH</var>: the YAML file that describes the X.509 values set by the certificate template.</li>
</ul>
<p>The <code dir="ltr" translate="no">--copy-sans</code> flag allows the Subject Alternative Name (SAN) extension from the certificate request to be copied into the signed certificate. You can alternatively specify <code dir="ltr" translate="no">--no-copy-sans</code> to drop any caller specified SANs from the certificate request.</p>
<p>The <code dir="ltr" translate="no">--copy-subject</code> flag allows the Subject from the certificate request to be copied into the signed certificate. You can alternatively specify <code dir="ltr" translate="no">--no-copy-subject</code> to drop any caller specified subjects from the certificate request.</p>
<aside class="note"><strong>Note:</strong><span> If you want to ensure that a template must be used with identity
reflection, specify the <code dir="ltr" translate="no">--no-copy-subject</code> and <code dir="ltr" translate="no">--no-copy-sans</code> flags
together. For more information about identity reflection, see
<a href="/certificate-authority-service/docs/using-identity-reflection">Identity reflection</a>.</span></aside>
<p>The <code dir="ltr" translate="no">--identity-cel-expression</code> flag takes a CEL expression that is evaluated against the Subject and Subject Alternative Name of the certificate before it is issued, and returns a boolean signifying whether the request should be allowed. For information about using a Common Expression Language (CEL) expression for a certificate template, see <a href="/certificate-authority-service/docs/using-cel#templates">Using CEL for certificate templates</a>.</p>
<p>The <code dir="ltr" translate="no">--predefined-values-file</code> flag specifies the path to a YAML file describing any predefined X.509 values set by this template. The provided extensions are copied over to any certificate requests that use this template, taking precedence over any allowed extensions in the certificate request. If you update any part of the predefined X.509 values, the update replaces the entire set of the predefined X.509 values.</p>
<p>If the <code dir="ltr" translate="no">--copy-all-requested-extensions</code> flag is set, all the extensions specified in the certificate request are copied into the signed certificate. Alternatively the <code dir="ltr" translate="no">--copy-extensions-by-oid</code> flag can be used to copy specific OIDs from the certificate request into the signed certificate and the <code dir="ltr" translate="no">--copy-known-extensions</code> flag can be used to copy extensions from the certificate request into the signed certificate. Must be one of: <code dir="ltr" translate="no">base-key-usage</code>, <code dir="ltr" translate="no">extended-key-usage</code>, <code dir="ltr" translate="no">ca-options</code>, <code dir="ltr" translate="no">policy-ids</code>, <code dir="ltr" translate="no">aia-ocsp-servers</code>.</p>
<aside class="note"><strong>Note:</strong><span> The tag <code dir="ltr" translate="no">--copy-all-requested-extensions</code> flag is mutually exclusive from <code dir="ltr" translate="no">--copy-known-extensions</code> and <code dir="ltr" translate="no">--copy-extensions-by-oid</code> flags.</span></aside>
<p>Remove the <code dir="ltr" translate="no">--copy-all-requested-extensions</code> flag to ignore all X.509 extensions in the certificate request, but still keep predefined values defined in this template.</p></section>
</div>
<h2 data-text="Creating a certificate template for common scenarios" id="common-scenario">Creating a certificate template for common scenarios</h2>
<p>This section provides <code dir="ltr" translate="no">gcloud</code> commands for creating a certificate template for common use cases.</p>
<h3 data-text="DNS server TLS certificates for any domain" id="dns-server-tls-domain">DNS server TLS certificates for any domain</h3>
<p>To create a certificate template for issuing server TLS certificates that allow
any domain, use the following instructions:</p>
<ol>
<li><p>Create a file with the name <code dir="ltr" translate="no">leaf_server_tls_values.yaml</code> and add the following end-entity server TLS configuration to it:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="leaf_server_tls_values.yaml" id="leaf_server_tls_values.yaml">leaf_server_tls_values.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">keyUsage:
  baseKeyUsage:
    digitalSignature: true
    keyEncipherment: true
  extendedKeyUsage:
    serverAuth: true
caOptions:
  isCa: false
</code></pre></section>
</div></li>
<li><p>To only allow certificates with <code dir="ltr" translate="no">DNS</code>-type SANs, execute following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates create server-tls \
  --predefined-values-file leaf_server_tls_values.yaml \
  --copy-sans --no-copy-subject \
  --identity-cel-expression "subject_alt_names.all(san, san.type == DNS)"
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates create</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/create">gcloud privateca templates create</a>.</p></section>
</div></li>
</ol>
<h3 data-text="DNS server TLS certificates with only test domains" id="dns-server-tls-test-domain">DNS server TLS certificates with only test domains</h3>
<p>To create a certificate template for issuing server TLS certificates with DNS
SANs limited to test domains, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates create server-tls \
  --predefined-values-file leaf_server_tls_values.yaml \
  --copy-sans --no-copy-subject \
  --identity-cel-expression "subject_alt_names.all(san, san.type == DNS &amp;&amp; san.value.endsWith('.test.example.com'))"
</code></pre></section>
</div>
<p>The contents of the <code dir="ltr" translate="no">leaf_server_tls_values.yaml</code> file must be the same as the previous example.</p>
<p>For more information about using CEL expressions to ensure DNS names start or end with a particular string, see <a href="/certificate-authority-service/docs/using-cel#template-examples">CEL example expressions</a>.</p>
<h3 data-text="Workload identity certificates" id="workload-identity">Workload identity certificates</h3>
<p>To create a certificate template for issuing mutual TLS (mTLS) certificates, use
the following instructions:</p>
<ol>
<li><p>Create a file with the name <code dir="ltr" translate="no">leaf_mtls_values.yaml</code> and add the following
end-entity mutual TLS configuration to it.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="leaf_mtls_values.yaml" id="leaf_mtls_values.yaml">leaf_mtls_values.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">keyUsage:
  baseKeyUsage:
    digitalSignature: true
    keyEncipherment: true
  extendedKeyUsage:
    serverAuth: true
    clientAuth: true
caOptions:
  isCa: false
</code></pre></section>
</div></li>
<li><p>To only allow certificates with <a class="external" href="https://spiffe.io/">SPIFFE</a> URI SANs, use the
following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates create workload-spiffe \
  --predefined-values-file leaf_mtls_values.yaml \
  --copy-sans --no-copy-subject \
  --identity-cel-expression "subject_alt_names.all(san, san.type == URI &amp;&amp; san.value.startsWith('spiffe://'))"
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates create</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/create">gcloud privateca templates create</a>.</p></section>
</div></li>
</ol>
<p>For more information about using CEL expressions to ensure DNS names start or end with a particular string, see <a href="/certificate-authority-service/docs/using-cel#examples">CEL example expressions</a>.</p>
<h2 data-text="Granting access to the certificate template" id="grant-access">Granting access to the certificate template</h2>
<p>You can use a certificate template if you have the CA Service Certificate Template User (<code dir="ltr" translate="no">roles/privateca.templateUser</code>) role. We recommend that the authors of a certificate template grant the CA Service Certificate Template User role to the members in the organization who might use that certificate template.</p>
<p>To grant the CA Service Certificate Template User (<code dir="ltr" translate="no">roles/privateca.templateUser</code>) role to everyone in the <code dir="ltr" translate="no">example.com</code> domain, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_4">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates add-iam-policy-binding <var translate="no">TEMPLATE_ID</var> \
  --member "domain:example.com" \
  --role "roles/privateca.templateUser"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">TEMPLATE_ID</var>: the unique identifier of the certificate template.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/add-iam-policy-binding">gcloud privateca templates add-iam-policy-binding</a>.</p></section>
</div>
<p>For more information about IAM roles for CA Service, and their associated permissions, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and roles</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/certificate-template">certificate templates</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/certificate-profile">certificate profiles</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/using-cel">use CEL</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/use-issuance-policy]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Using a certificate issuance policy" id="using-a-certificate-issuance-policy">Using a certificate issuance policy</h1>
<p>This topic describes how to use a certificate issuance policy on a certificate
authority (CA) pool.</p>
<p>A certificate issuance policy lets you specify the subject and subject
alternative names (SANs) that can be included in the issued certificates. You can
specify the certificate issuance policy while creating a CA pool or you can update
an existing CA pool to add an issuance policy.</p>
<p>For more information, see <a href="/certificate-authority-service/docs/policy-controls#issuance-policies">Certificate issuance policies</a>.</p>
<aside class="caution"><strong>Caution:</strong><span> The issuance policy changes are effective immediately. Before using the
issuance policy in production, we recommend that you try out the policy changes
on a test CA pool instance.</span></aside>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ul>
<li><p>Make sure you have the CA Service Operation Manager
(<code dir="ltr" translate="no">roles/privateca.caManager</code>) or the CA Service Admin
(<code dir="ltr" translate="no">roles/privateca.admin</code>) IAM role. For information about
granting an IAM to a principal, see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single
role</a>.</p></li>
<li><p>Create a CA pool by using the instructions in the <a href="/certificate-authority-service/docs/create-certificate">quickstart</a>.</p></li>
</ul>
<h2 data-text="Add a certificate issuance policy file" id="add-issuance-policy">Add a certificate issuance policy file</h2>
<p>To add a certificate issuance policy to an existing CA pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>On the <strong>CA pool manager</strong> page, click the name of the CA pool for which you
want to add a certificate issuance policy.</p></li>
<li><p>On the <strong>CA pool</strong> page, click <span aria-hidden="true" class="material-icons" translate="no">edit</span><strong>Edit</strong>.</p></li>
</ol>
<b>Configure identity constraints</b>
<p>To configure constraints on the subject and SANs in the certificates that
  the CA pool issues, do the following:</p>
<ol>
<li>
    Optional: To disallow subject in certificate requests from being passed
    through, click the toggle.
  </li>
<li>
    Optional: To disallow subject alternative names in certificate requests
    from being passed through, click the toggle.
  </li>
<li>
    Optional: Add a Common Expression Language (CEL) expression to place
    restrictions on certificate subjects. For more information, see
    <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure extension constraints</b>
<p>To disallow all extensions from certificate requests from being included in
   the issued certificates, click the toggle.
</p>
<p>
  After you click the toggle, you will see the <b>Known certificate
  extensions</b> field that you can use to select the certificate extensions. To
  select the certificate extensions, do the following:
</p>
<ol>
<li>
    Optional: Click the <b>Known certificate extensions</b> field, and clear the
    unrequired extensions from the menu.
  </li>
<li>
    Optional: In the <b>Custom extensions</b> field, add the object identifiers
    for extensions you want to be included in the certificates that the CA pool
    issues.
  </li>
</ol>
<b>Configure baseline values</b>
<p>
  To configure baseline values in the certificates issued from the CA pool, do
  the following:
</p>
<ol>
<li>
    Click the toggle.
  </li>
<li>
    Click <b>Configure baseline values</b>.
  </li>
</ol>
<b>Define base key usage</b>
<p>
  You can use this setting to configure the ways in which the key contained in
  the certificate can be used. The options for key usage include key
  encipherment, data encipherment, certificate signing, CRL signing, and more.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">Key usage</a>
</p>
<p>
  To define the base key usages, do the following:
</p>
<ol>
<li>
    Optional: In the window that appears, click the toggle, if
    you want to specify base key usages for the certificates.
  </li>
<li>
    Select the checkboxes for the ways in which you want a key to be used.
  </li>
<img class="screenshot" data-modal-dialog-id="base-key" src="/certificate-authority-service/images/base-key-usage.png" style="width: 55%"/>
<devsite-lightbox id="base-key">
<img alt="Select the high-level ways in which you want a key to be used." src="/certificate-authority-service/images/base-key-usage.png"/>
</devsite-lightbox>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Define extended key usage</b>
<p>
  You can use this setting to select more granular scenarios for which the key
  contained in the certificate can be used. The options include server
  authentication, client authentication, code signing, email protection, and
  more.
</p>
<p>
  Extended key usages are defined using object identifiers (OIDs). If you don't
  configure the extended key usages, all key usage scenarios are allowed.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">Extended key usage</a>.
</p>
<p>
  To define the extended key usages, do the following:
</p>
<ol>
<li>
    Optional: To specify the extended key usages for the certificates that the
    CA pool issues, click the toggle.
  </li>
<li>
    Select the checkboxes for the extended key usage scenarios.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Define policy identifiers</b>
<p>
  The certificate policies extension in the certificate expresses the policies
  that the issuing CA pool follows. This extension can include information about how
  identities are validated before certificate issuance, how certificates are
  revoked, and how the CA pool's integrity is ensured. This extension helps you
  verify the certificates that the CA pool issues and see how the certificates
  are used.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.4">Certificate policies</a>.
</p>
<p>
  To specify the policy that defines the certificate usage, do the following:
</p>
<ol>
<li>
    Optional: Add the policy identifier in the <b>Policy identifiers</b> field.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Add Authority information access (AIA) OCSP servers</b>
<p>
  The AIA extension in a certificate provides the following information:
</p>
<ul>
<li>
    Address of the OCSP servers from where you can check the revocation status
    of the certificate.
  </li>
<li>
    The access method for the issuer of the certificate.
  </li>
</ul>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.2.1">Authority information access</a>.
</p>
<p>
  To add the OCSP servers that appear in the AIA extension field in the
  certificates, do the following. The following procedure is optional.
</p>
<ol>
<li>
    Optional: Click <b>Add item</b>.
  </li>
<li>
    In the <b>Server URL</b> field, add the URL of the OCSP server.
  </li>
<li>
    Click <b>Done</b>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure additional extensions</b>
<p>
  To configure additional custom extensions to include in the
  certificates issued by the CA pool, do the following. The following procedure
  is optional.
</p>
<ol>
<li>
    Click <b>Add item</b>.
  </li>
<li>
    In the <b>Object identifier</b> field, add a valid object identifier that
    is formatted as dot-separated digits.
  </li>
<li>
    In the <b>Value</b> field, add the base64-encoded value for the identifier.
  </li>
<li>
    If the extension is critical, select <b>Extension is critical</b>.
  </li>
</ol>
<p>
  To save all the baseline value configurations, click <b>Done</b>.
</p></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>To use the Google Cloud CLI to add a certificate issuance policy to a CA pool,
you must create a YAML file that describes the restrictions on the
certificates that the CA pool can issue. The content corresponds to an
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#issuancepolicy">IssuancePolicy</a>.</p>
<ol>
<li><p>Using the Cloud Shell Editor, create a file <code dir="ltr" translate="no">policy.yaml</code> with the
following content:</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: true
  allowSubjectAltNamesPassthrough: true
</code></pre>
<p>Where:</p>
<ul>
<li>The <code dir="ltr" translate="no">allowSubjectPassthrough</code> field is required. If the <code dir="ltr" translate="no">allowSubjectPassthrough</code> field is set to <code dir="ltr" translate="no">true</code>, the subject field is copied from a certificate request into the signed certificate. Otherwise, the requested Subject is discarded.</li>
<li>If the <code dir="ltr" translate="no">allowSubjectAltNamesPassthrough</code> field is set to <code dir="ltr" translate="no">true</code>, the SubjectAltNames extension is copied from a certificate request into the signed certificate. Otherwise, the requested SubjectAltNames is discarded.</li>
</ul></li>
<li><p>To update a CA pool's certificate issuance policy using the file
created in the previous step, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools update <var translate="no">POOL_NAME</var> \
  --issuance-policy <var translate="no">FILE_PATH</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_NAME</var>: Name of the CA pool.</li>
<li><var translate="no">FILE_PATH</var>: The path of the <code dir="ltr" translate="no">policy.yaml</code> file.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools update</code> command,
see <a href="/sdk/gcloud/reference/privateca/pools/update">gcloud privateca pools update</a>.</p></li>
</ol></section>
</div>
<p>For more information, see <a href="/certificate-authority-service/docs/creating-ca-pool">Creating CA pools</a>.</p>
<h2 data-text="Supported restrictions" id="supported-restrictions">Supported restrictions</h2>
<p>CA Service supports the following issuance policy restrictions. You
can combine the following restrictions as necessary to build a custom certificate
issuance policy.</p>
<h3 data-text="Restrict or force allowed X.509 values" id="restrict_or_force_allowed_x509_values">Restrict or force allowed X.509 values</h3>
<p>A CA pool can restrict the allowed X.509 values in certificate requests by configuring the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.passthrough_extensions">passthrough_extensions</a> field.</p>
<p>A CA pool can also explicitly specify X.509 values to be added to all its issued certificates, overwriting any requested values, by using the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.baseline_values">baseline_values</a> field.</p>
<p>The <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.baseline_values">baseline_values</a> values of a CA pool allow specifying the following properties:</p>
<ul>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#KeyUsage">Key Usage</a></li>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#CaOptions">CA Options</a></li>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters">AIA OCSP Servers</a></li>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Extension">Additional X.509 Extensions</a></li>
</ul>
<p>You can also use these options together.</p>
<p>If you update any part of the <code dir="ltr" translate="no">baseline_values</code> field, the update replaces
the entire set of values in the <code dir="ltr" translate="no">baseline_values</code> field.</p>
<ul>
<li><p><strong>Example</strong>: Restrict a CA to issue only end-entity certificates with X.509 values for mutual TLS (mTLS).</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">baselineValues:
  caOptions:
    isCa: false
  keyUsage:
    baseKeyUsage:
      digitalSignature: true
      keyEncipherment: true
    extendedKeyUsage:
       clientAuth: true
       serverAuth: true
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>:  Restrict a CA to issue only end-entity code signing certificates with a baseline AIA OCSP URL.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_1">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">baselineValues:
  caOptions:
    isCa: false
  keyUsage:
    baseKeyUsage:
      digitalSignature: true
    extendedKeyUsage:
      codeSigning: true
  aiaOcspServers:
    - "http://foo.bar/revocation"
  additionalExtensions:
  - objectId:
      objectIdPath:
        - 1
        - 2
        - 3
    critical: false
    value: "base64 encoded extension value"
</code></pre></section>
</div></li>
</ul>
<p>For more information about the certificate profile for end-entity mTLS, see <a href="/certificate-authority-service/docs/certificate-profile#end-mtls">End-entity mTLS</a>.</p>
<h3 data-text="Restrict allowed identity fields" id="restrict-allowed-identity-fields">Restrict allowed identity fields</h3>
<p>To restrict the identity of certificates issued through a CA pool, you can add a <a class="external" href="https://opensource.google/projects/cel">Common Expression Language (CEL)</a> expression to the issuance policy's <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.identity_constraints">identity_constraints</a> field. The CEL expressions allow arbitrary restrictions over the Subject Domain Name (including the common name) and the SANs of a certificate.</p>
<p>For more information about using a CEL expression to restrict Subject and SANs, see <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.</p>
<ul>
<li><p><strong>Example</strong> Allow the CA to issue only certificates matching a specified Subject.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_2">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: true
  allowSubjectAltNamesPassthrough: false
  celExpression:
    expression: 'subject.organization == "Example LLC" &amp;&amp; subject.country_code in ["US", "UK"]'
</code></pre>
<p>The <code dir="ltr" translate="no">celExpression</code> field is optional. Use a Common Expression Language (CEL) expression to validate the resolved X.509 subject and/or SAN before a certificate is signed. For more information about using CEL expressions, see <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.</p></section>
</div></li>
<li><p><strong>Example</strong>: Allow only SANs having DNS Names as <code dir="ltr" translate="no">us.google.org</code> or ending in <code dir="ltr" translate="no">.google.com</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_3">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == DNS &amp;&amp; (san.value == "us.google.org" || san.value.endsWith(".google.com")) )'
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>: Allow only SANs having URIs <code dir="ltr" translate="no">https://google.com/webhp</code> or starting with <code dir="ltr" translate="no">spiffe://example-trust-domain-1/ns/namespace1/sa/</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_4">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == URI &amp;&amp; (san.value == "https://google.com/webhp" || san.value.startsWith("spiffe://example-trust-domain-1/ns/namespace1/sa/")) )'
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>: Allow only SANs having email addresses <code dir="ltr" translate="no">example@google.com</code> or ending with <code dir="ltr" translate="no">@google.org</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_5">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == EMAIL &amp;&amp; (san.value == "example@google.com" || san.value.endsWith("@google.org")) )'
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>: Allow only custom SANs having a specific OID and a custom value.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_6">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == CUSTOM &amp;&amp; san.oid == [1, 2, 3, 4] &amp;&amp; san.value == "custom-data" )'
</code></pre></section>
</div></li>
</ul>
<h3 data-text="Restrict maximum lifetime of the issued certificates" id="restrict-max-lifetime">Restrict maximum lifetime of the issued certificates</h3>
<p>To restrict the lifetime of the issued certificates, use the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.maximum_lifetime">maximum_lifetime</a> field. If a certificate's requested lifetime is larger than the maximum lifetime, the certificate's lifetime is explicitly truncated.</p>
<aside class="note"><strong>Note:</strong><span> A certificate can never outlive its issuing CA. If a certificate request mentions a lifetime that exceeds the CA's <code dir="ltr" translate="no">not_after_time</code> date, its lifetime is truncated to match the CA's <code dir="ltr" translate="no">not_after_time</code> date. The certificate's lifetime is truncated even if the certificate issuance policy allows a longer lifetime.</span></aside>
<h4 data-text="Example" id="example">Example</h4>
<p>To allow a maximum lifetime of 30 days, use the following <code dir="ltr" translate="no">policy.yaml</code> file:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_7">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">maximumLifetime: 2592000s
</code></pre></section>
</div>
<h3 data-text="Restrict allowed certificate issuance modes" id="restrict-allowed-issuance-modes">Restrict allowed certificate issuance modes</h3>
<p>You can request a certificate either through a Certificate Signing Request (CSR) or an inline description of the requested values. Some organizations might prefer to add limitations on the option that can be used because the latter method doesn't require a proof of possession of the associated private key. You can set these limitations using the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.allowed_issuance_modes">allowedIssuanceModes</a> field.</p>
<p>For more information about specifying the ways in which certificates can be requested from a CA pool, see <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuanceModes">IssuanceModes</a>.</p>
<p>For more information about requesting certificates, see <a href="/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>.</p>
<ul>
<li><p><strong>Example</strong>: Allow only CSR issuance.</p></li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_8">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">allowedIssuanceModes:
  allowCsrBasedIssuance: True
  allowConfigBasedIssuance: False
</code></pre></section>
</div>
<h3 data-text="Restrict the public key algorithms of the certificate request" id="restrict-public-key">Restrict the public key algorithms of the certificate request</h3>
<p>To restrict the minimum key length and the public key algorithms that certificates can use, you can use the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.allowed_key_types">allowedKeyTypes</a> field in the certificate issuance policy YAML file. If this field is specified, then the certificate request's public key must match one of the key types listed in the YAML file. If this field isn't specified, then you can use any key.</p>
<ul>
<li><p><strong>Example</strong>: Allow RSA keys with a modulus size between 3072 bits and 4096 bits (inclusive), or Elliptic Curve Digital Signature Algorithm (ECDSA) keys over the NIST P-256 curve.</p></li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_9">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">allowedKeyTypes:
- rsa:
    minModulusSize: 3072
    maxModulusSize: 4096
- ellipticCurve:
    signatureAlgorithm: ECDSA_P256
</code></pre></section>
</div>
<p>You can choose one of the following elliptic curve signature algorithms:</p>
<ul>
<li><code dir="ltr" translate="no">EC_SIGNATURE_ALGORITHM_UNSPECIFIED</code> - Any signature algorithm may be used.</li>
<li><code dir="ltr" translate="no">ECDSA_P256</code> -  Elliptic Curve Digital Signature over the NIST P-256 curve.</li>
<li><code dir="ltr" translate="no">ECDSA_P384</code> -  Elliptic Curve Digital Signature over the NIST P-384 curve.</li>
<li><code dir="ltr" translate="no">EDDSA_25519</code> - Edwards-curve Digital Signature Algorithm over curve 25519, as described in RFC 8410.</li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/certificate-profile">certificate profiles</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/requesting-certificates">requesting certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/configuring-iam">configure IAM policies</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/using-cel">use Common Expression Language (CEL)</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/tutorials/manage-policy-controls">manage various policy controls</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/using-cel]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Using Common Expression Language" id="using-common-expression-language">Using Common Expression Language</h1>
<p>This topic describes how you can use Common Expression Language (CEL) with certificate issuance policies, certificate templates, and Identity and Access Management (IAM) conditions on your CA pool.</p>
<h2 data-text="Overview" id="overview">Overview</h2>
<p><a class="external" href="https://opensource.google/projects/cel">Common Expression Language (CEL)</a> is an open-source non-Turing complete language that implements common semantics for expression evaluation. Certificate Authority Service supports CEL to enforce various policy controls for certificate issuance.</p>
<p>There are two CEL dialects that can be used with CA Service:</p>
<ul>
<li>A flexible dialect that can be used in a CA pool's certificate issuance policies and certificate templates.</li>
<li>A more limited dialect that can be used in IAM conditions.</li>
</ul>
<h2 data-text="CEL dialect for certificate issuance policies and certificate templates" id="certificate-templates">CEL dialect for certificate issuance policies and certificate templates</h2>
<p>When creating a CA pool or a certificate template, you can specify a CEL expression as part of the certificate identity constraints. The CEL expression lets you validate the Subject and Subject Alternative Name (SAN) fields.</p>
<p>For more information about issuance policies, see <a href="/certificate-authority-service/docs/use-issuance-policy">Using an issuance policy</a>.</p>
<p>For more information about certificate templates, see <a href="/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</p>
<p>The CEL dialect for the identity constraints of CA pools and certificate templates exposes the following variables for accessing and validating the subject and SAN fields:</p>
<ul>
<li>Subject: <code dir="ltr" translate="no">subject</code></li>
<li>SAN: <code dir="ltr" translate="no">subject_alt_names</code></li>
</ul>
<h4 data-text="Subject" id="subject">Subject</h4>
<p>You can validate all the fields in a certificate's subject domain name (including the common name), as specified in the certificate request using a variable of type <code dir="ltr" translate="no">Subject</code> and name <code dir="ltr" translate="no">subject</code>.</p>
<p><code dir="ltr" translate="no">Subject</code> is a structure that contains the following fields:</p>
<table>
<tr>
<th>Type</th>
<th>Name</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>common_name</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>country_code</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>organization</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>organizational_unit</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>locality</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>province</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>street_address</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>postal_code</td>
</tr>
</table>
<h4 data-text="Subject Alternative Names (SANs)" id="subject_alternative_names_sans">Subject Alternative Names (SANs)</h4>
<p>You can validate all SANs as specified in the certificate request using the <code dir="ltr" translate="no">subject_alt_names</code> variable. The <code dir="ltr" translate="no">subject_alt_names</code> variable contains a list SAN structs, where each SAN is of type <code dir="ltr" translate="no">SubjectAltName</code>.</p>
<p><code dir="ltr" translate="no">SubjectAltName</code> is a struct that contains the following fields:</p>
<table>
<tr>
<th>Type</th>
<th>Name</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>value</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">[]Int32</code></td>
<td>oid</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Enum</code></td>
<td>type</td>
</tr>
</table>
<p>You can use the following values for the <code dir="ltr" translate="no">SubjectAltName</code> type:</p>
<ul>
<li><code dir="ltr" translate="no">TYPE_UNSPECIFIED</code></li>
<li><code dir="ltr" translate="no">DNS</code></li>
<li><code dir="ltr" translate="no">URI</code></li>
<li><code dir="ltr" translate="no">EMAIL</code></li>
<li><code dir="ltr" translate="no">IP_ADDRESS</code></li>
<li><code dir="ltr" translate="no">CUSTOM</code></li>
</ul>
<p>The <code dir="ltr" translate="no">subject_alt_names</code> variable contains a list with all the requested SANs.</p>
<p>You can use the following macros on SANs:</p>
<ul>
<li><code dir="ltr" translate="no">subject_alt_names.all(san, predicate)</code></li>
<li><code dir="ltr" translate="no">subject_alt_names.exists(san, predicate)</code></li>
<li><code dir="ltr" translate="no">subject_alt_names.exists_one(san, predicate)</code></li>
<li><code dir="ltr" translate="no">subject_alt_names.filter(san, predicate)</code></li>
</ul>
<p>For more information about macros, see <a class="external" href="https://github.com/google/cel-spec/blob/master/doc/langdef.md#macros">Language definition: Macros</a>.</p>
<aside class="note"><strong>Note:</strong><span> CA Service doesn't support CEL expressions with nested macros. We recommend that you use <code dir="ltr" translate="no">and</code> and <code dir="ltr" translate="no">or</code> operators to implement the same functionality.</span></aside>
<h3 data-text="Example expressions" id="template-examples">Example expressions</h3>
<p><strong>Ensuring a specific common name and a set of countries</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">subject.common_name == "google.com" &amp;&amp; (subject.country_code == "US" || subject.country_code == "IR")
</code></pre>
<p><strong>Ensuring all DNS names end with a custom string</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">subject_alt_names.all(san, san.type == DNS &amp;&amp; san.value.endsWith(".test.com"))
</code></pre>
<p><strong>Ensuring all SANs are of type DNS or EMAIL</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">subject_alt_names.all(san, san.type == DNS || san.type == EMAIL )
</code></pre>
<p><strong>Ensuring only one custom SAN with a specific OID</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">subject_alt_names.size() == 1 &amp;&amp; subject_alt_names[0].oid == [1, 2, 3, 5, 17]
</code></pre>
<p><strong>Ensuring custom SANs are only a set of OIDs</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">subject_alt_names.all(san, san.oid == [1, 2, 4, 5, 55] || san.oid == [1, 2, 4, 5, 54])
</code></pre>
<h2 data-text="CEL dialect for IAM policies" id="iam-policies">CEL dialect for IAM policies</h2>
<p>Use IAM conditions to subject IAM role bindings to a conditional expression. If the condition evaluates to <code dir="ltr" translate="no">true</code>, then the IAM role binding is effective, otherwise it is ignored. CA Service lets you add IAM conditional bindings to a CA pool.</p>
<p>The IAM condition is a CEL expression that references a set of contextual attributes about the request and evaluates to a boolean. Users set conditions on the role bindings in an IAM policy, which is stored by IAM and evaluated to see whether the operation that is about to be performed is permitted.</p>
<p>For more information about IAM conditions, see <a href="/iam/docs/conditions-overview">Overview of IAM conditions</a>.</p>
<p>The following attributes are exposed during CEL evaluation of IAM conditions:</p>
<ul>
<li><p><strong><code dir="ltr" translate="no">privateca.googleapis.com/subject</code></strong></p>
<p>The <code dir="ltr" translate="no">privateca.googleapis.com/subject</code> is accessible as <code dir="ltr" translate="no">api.getAttribute('privateca.googleapis.com/subject', {})</code>.</p></li>
</ul>
<table>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">map{string, string}</code></td>
<td>This field contains the subject distinguished name (including the common name) as specified in the incoming certificate request.<br/><br/><b>Example</b><br/><br/><code dir="ltr" translate="no">{<br/> 'common_name': 'Foobar',<br/> 'organization': 'Example LLC'<br/> 'country_code' :'US'<br/> 'organizational_unit':'Foobar'<br/> 'locality':'Mountain View'<br/> 'Province':'California'<br/> 'street_address':'Foobar 22'<br/> 'postal_code':55555<br/>}</code></td>
</tr>
</table>
<ul>
<li><p><strong><code dir="ltr" translate="no">privateca.googleapis.com/subject_alt_names</code></strong></p>
<p>The <code dir="ltr" translate="no">privateca.googleapis.com/subject_alt_names</code> is accessible as <code dir="ltr" translate="no">api.getAttribute('privateca.googleapis.com/subject_alt_names', [])</code>.</p></li>
</ul>
<table>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">list{string}</code></td>
<td>This field contains all requested SANs as specified in the incoming certificate request. Each of the requested SANs is prefixed with its type. SANs with unknown types are prefixed with the type's serialized OID.<br/><br/><b>Example</b><br/><br/><code dir="ltr" translate="no">{<br/> 'dns:foo.bar.com',<br/> 'uri:spiffe://foo/ns/bar/sa/baz'<br/> 'email:foo@bar.com'<br/> 'ip:169.169.254.254'<br/> 'custom:1.2.3.4.5.6.3:foobar'<br/>}</code></td>
</tr>
</table>
<ul>
<li><p><strong>privateca.googleapis.com/template</strong></p>
<p>The <code dir="ltr" translate="no">privateca.googleapis.com/template</code> is accessible as <code dir="ltr" translate="no">api.getAttribute('privateca.googleapis.com/template', '')</code>.</p></li>
</ul>
<table>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">String</code></td>
<td>The certificate template that was used, if any. The format is <code dir="ltr" translate="no">{project_id}/-/{template_id}</code>.<br/><br/><b>Example</b>: <code dir="ltr" translate="no">my-project-pki/-/workload_tls</code></td>
</tr>
</table>
<h3 data-text="Example expressions" id="iam-examples">Example expressions</h3>
<p><strong>Ensuring that all subjects have organization set as 'Example' and country code set as <code dir="ltr" translate="no">US</code> or <code dir="ltr" translate="no">UK</code></strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">api.getAttribute('privateca.googleapis.com/subject', {})['organization'] == 'Example' &amp;&amp;
api.getAttribute('privateca.googleapis.com/subject', {})['country_code'] in ['US', 'UK']
</code></pre>
<p><strong>Ensuring that the certificate request only includes the given DNS SANs</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">api.getAttribute('privateca.googleapis.com/subject_alt_names')
        .hasOnly(['dns:sample1.prod.example.com', 'dns:sample2.prod.example.com'])
</code></pre>
<p><strong>Ensuring that all certificates use a specific template</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">api.getAttribute('privateca.googleapis.com/template', '') == 'my-project-pki/-/leaf-server-tls'
</code></pre>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Read the <a class="external" href="https://github.com/google/cel-spec/blob/master/doc/intro.md">introduction to CEL</a>.</li>
<li>Learn more about <a class="external" href="https://github.com/google/cel-spec/blob/master/doc/langdef.md">language definition for CEL</a>.</li>
<li>Learn about <a href="/certificate-authority-service/docs/policy-controls">policy controls</a>.</li>
<li>Read the <a href="/iam/docs/conditions-overview">overview of IAM conditions</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/use-issuance-policy">issuance policy</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/configuring-iam]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Configuring, modifying, and removing IAM policies" id="configuring,-modifying,-and-removing-iam-policies">Configuring, modifying, and removing IAM policies</h1>
<p>This topic describes how to configure, modify, and remove the Identity and Access Management (IAM) policies
that let members create and manage Certificate Authority Service resources. For more information about IAM, see <a href="/iam/docs/overview">Overview for IAM</a>.</p>
<p>IAM policies that are set on a certificate authority (CA) pool are inherited by all the CAs in that CA pool. You cannot set IAM policies on certificates and CA resources.</p>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ul>
<li>Read the <a href="/certificate-authority-service/docs/quickstart#before-you-begin">Quickstart</a> guide to set up the API and create a CA pool.</li>
<li>Read <a href="/certificate-authority-service/docs/policy-controls#iam-policies">IAM policies</a> to learn more about IAM policies.</li>
<li>Read the <a href="/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and roles</a> topic to learn about the IAM roles available for Certificate Authority Service.</li>
</ul>
<h2 data-text="Configuring IAM policy bindings" id="configure-iam">Configuring IAM policy bindings</h2>
<p>The following scenarios describe how you can grant users access to CA Service
resources.</p>
<h3 data-text="Administering resources" id="administer-resources">Administering resources</h3>
<p>A CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) has the permissions to manage all CA Service
resources, and set IAM policies on CA pools and certificate templates.</p>
<aside class="note"><strong>Note:</strong><span> We recommend that you carefully assign the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) role, and implement a special access control for this role to prevent unauthorized access or use.</span></aside>
<p>To assign the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) role to a user, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-name="iamConsoleLink" track-type="addRole">Go to Identity and Access Management</a> </p></li>
<li><p>In the top bar for IAM, click <strong>ADD</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>Type the filter <strong>CA Service Admin</strong>, scroll down the list, and select <strong>CA Service Admin</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/privateca.admin
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the unique identifier of the project.</li>
<li><var translate="no">MEMBER</var>: the user or service account to whom you want to assign the CA Service Admin role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p></section>
</div>
<p>You can also set the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) role at the resource level to manage a
specific CA pool or certificate template.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="addRole">Go to Certificate Authority Service</a> </p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>CA Service</strong>, and select <strong>CA Service Admin</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>To set the IAM policy, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location <var translate="no">LOCATION</var> \
  --member <var translate="no">MEMBER</var> \
  --role roles/privateca.admin
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: the unique identifier of the CA pool for which you want to set the IAM policy.</li>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account to which you want to assign the IAM role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca pools add-iam-policy-binding</a>.</p></section>
</div>
<h3 data-text="Creating and managing CA pools and CAs" id="creating-managing-certificate-authorities">Creating and managing CA pools and CAs</h3>
<p>To create a CA pool and a CA, assign the CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) role to a user at the
project level. Granting CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) also allows the caller to
revoke certificates issued by the CAs in the CA pool.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_2">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-name="iamConsoleLink" track-type="addRole">Go to Identity and Access Management</a> </p></li>
<li><p>In the top bar for IAM, click <strong>ADD</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click <strong>Select a role</strong>.</p></li>
<li><p>Type the filter <strong>CA Service Operation Manager</strong>, and select <strong>CA Service Operation Manager</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/privateca.caManager
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the unique identifier of the project.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud projects add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/projects/add-iam-policy-binding">gcloud projects add-iam-policy-binding</a>.</p></section>
</div>
<p>Optionally, creating a CA using an existing Cloud KMS key also requires
the caller to be an administrator for the Cloud KMS key.</p>
<p>The Cloud KMS Admin (<code dir="ltr" translate="no">roles/cloudkms.admin</code>) has complete access to all Cloud KMS resources, except the encrypt and decrypt operations. For more information about IAM roles for Cloud KMS, see <a href="/kms/docs/reference/permissions-and-roles">Cloud KMS: Permissions and roles</a>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Cloud Key Management Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/kms" target="console" track-name="kmsConsoleLink" track-type="addRole">Go to Cloud Key Management Service</a> </p></li>
<li><p>Under <strong>Key rings</strong>, click the key ring that contains the CA signing key.</p></li>
<li><p>Click the key that is the CA signing key.</p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>Cloud KMS</strong>, and select <strong>Cloud KMS Admin</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys add-iam-policy-binding <var translate="no">KEY</var> \
  --keyring=<var translate="no">KEYRING</var> --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/cloudkms.admin
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">KEY</var>: the unique identifier of the key.</li>
<li><var translate="no">KEYRING</var>: the keyring that contains the key. For more information about key rings, see <a href="/kms/docs/resource-hierarchy#key_rings">Key rings</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM binding.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud kms keys add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/kms/keys/add-iam-policy-binding">gcloud kms keys add-iam-policy-binding</a>.</p></section>
</div>
<p>To manage a specific CA pool and its CAs, the <code dir="ltr" translate="no">roles/privateca.caManager</code> role can be granted
on either the project or on the CA pool. This role also allows the caller to
revoke certificates issued by CAs in the CA pool.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_4">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="addRole">Go to Certificate Authority Service</a> </p></li>
<li><p>Select your CA under <strong>Certificate authorities</strong>.</p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>CA Service</strong>, and select <strong>CA Service Operation Manager</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_4">gcloud</h3><p>To grant the role for a specific CA pool, run the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location <var translate="no">LOCATION</var> \
  --member <var translate="no">MEMBER</var> \
  --role roles/privateca.caManager
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: the unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the unique identifier of the user to whom you want to assign the CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) role.</li>
</ul>
<p>The  <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca pools add-iam-policy-binding</a>.</p></section>
</div>
<h3 data-text="Creating certificates" id="create-certificates">Creating certificates</h3>
<p>To create certificates, use the CA Service Certificate Manager (<code dir="ltr" translate="no">roles/privateca.certificateManager</code>) role.
This role also gives read access to CA Service resources. To only
allow certificate creation without read access, use
the CA Service Certificate Requester (<code dir="ltr" translate="no">roles/privateca.certificateRequester</code>) role. For more information about IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<p>To grant the user access to create certificates for a specific CA, use the following instructions.</p>
<aside class="caution"><strong>Caution:</strong><span> We recommend that you carefully grant the CA Service Certificate Manager role on a CA pool. If there is a CA in the CA pool that permits
issuing CA certificates, it might allow the caller to create their own subordinate
CA certificates that chain up to that CA. For more information about certificate issuance policy, see <a href="/certificate-authority-service/docs/policy-controls">Policy controls</a> and <a href="/certificate-authority-service/docs/use-issuance-policy">Using an issuance policy</a>.</span></aside><div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_5">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="addRole">Go to Certificate Authority Service</a> </p></li>
<li><p>Select your CA under <strong>Certificate authorities</strong>.</p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>CA Service</strong>, and select <strong>CA Service Certificate Manager</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_5">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding '<var translate="no">POOL_ID</var>' \
  --location <var translate="no">LOCATION</var> \
  --member <var translate="no">MEMBER</var> \
  --role roles/privateca.certificateManager
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: the unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the unique identifier of the user to whom you want to assign the CA Service Certificate Manager (<code dir="ltr" translate="no">roles/privateca.certificateManager</code>) role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p></section>
</div>
<h3 data-text="Auditing resources" id="audit-resources">Auditing resources</h3>
<p>A CA Service Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) has read access to all resources in CA Service. When
granted for a specific CA pool, it grants read access to the
CA pool. If the CA pool is in the Enterprise tier, the user with this role can also view
certificates and CRLs issued by the CAs in the CA pool. Assign this role to individuals who are accountable for validating security and operations of the CA pool. For more information about the predefined IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_6">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-name="iamConsoleLink" track-type="addRole">Go to Identity and Access Management</a> </p></li>
<li><p>In the top bar for IAM, click <strong>ADD</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click <strong>Select a role</strong>.</p></li>
<li><p>Type the filter <strong>CA Service Auditor</strong>, and select <strong>CA Service Auditor</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_6">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/privateca.auditor
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the unique identifier of the project.</li>
<li><var translate="no">MEMBER</var>: the unique identifier of the user to whom you want to assign the CA Service Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p></section>
</div>
<h2 data-text="Configuring IAM policy bindings per resource" id="configure-iam-resource">Configuring IAM policy bindings per resource</h2>
<p>This section describes how you can configure IAM policy bindings for a particular resource in CA Service.</p>
<h3 data-text="Adding IAM policy bindings" id="modify-iam-resource">Adding IAM policy bindings</h3>
<p>The procedure for modifying a user's IAM role is the same as that for granting a role. You can modify an existing IAM policy binding using the Google Cloud CLI's <code dir="ltr" translate="no">add-iam-policy-binding</code> command.</p>
<p>To add an IAM policy on a particular CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_7">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to modify for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca pools add-iam-policy-binding</a>.</p></section>
</div>
<p>To add an IAM policy on a particular certificate template, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_8">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates add-iam-policy-binding <var translate="no">TEMPLATE_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the certificate template. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to modify for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/add-iam-policy-binding">gcloud privateca templates add-iam-policy-binding</a>.</p></section>
</div>
<p>For more information about modifying a user's IAM role, see <a href="/iam/docs/granting-changing-revoking-access#granting-gcloud-manual">Granting access</a>.</p>
<h3 data-text="Removing IAM policy bindings" id="remove-iam">Removing IAM policy bindings</h3>
<p>You can remove an existing IAM policy binding using the Google Cloud CLI's <code dir="ltr" translate="no">remove-iam-policy-binding</code> command.</p>
<p>To remove an IAM policy on a particular CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_9">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to remove the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to remove for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/remove-iam-policy-binding">gcloud privateca pools remove-iam-policy-binding</a>.</p></section>
</div>
<p>To remove an IAM policy on a particular certificate template, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_10">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates remove-iam-policy-binding <var translate="no">TEMPLATE_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the certificate template. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to remove the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to remove for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates remove-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/remove-iam-policy-binding">gcloud privateca templates remove-iam-policy-binding</a>.</p></section>
</div>
<p>For more information about removing a user's IAM role, see <a href="/iam/docs/granting-changing-revoking-access#revoking-gcloud-manual">Revoking access</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Read the <a href="/iam/docs/overview">overview for IAM</a>.</li>
<li>Learn more about <a href="/iam/docs/understanding-roles">IAM roles</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/reference/permissions-and-roles">IAM roles for CA Service, and their associated permissions</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/policy-controls">policy controls</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/tutorials/manage-policy-controls">manage policy controls</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/tutorials/manage-policy-controls]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Tutorial: Managing policy controls" id="tutorial:-managing-policy-controls">Tutorial: Managing policy controls</h1>
<p>This tutorial combines various concepts on policy management that allow control over certificate issuance and access to Certificate Authority Service resources.</p>
<h2 data-text="Objectives" id="objectives">Objectives</h2>
<p>This tutorial provides information on configuring a shared certificate authority (CA) pool for DNS certificate issuance with the following policy controls:</p>
<ul>
<li>User <code dir="ltr" translate="no">prod-dns-requester</code> can request end-entity server TLS certificates for the <code dir="ltr" translate="no">*.prod.example.com</code> domain.</li>
<li>User <code dir="ltr" translate="no">test-dns-requester</code> can request end-entity server TLS certificates for the <code dir="ltr" translate="no">*.test.example.com</code> domain.
<!-- - User `prod-code-signing-requester` can request end-entity code signing certificates with the subject `CN=code signing 1, O=Example LLC`. --></li>
<li>User <code dir="ltr" translate="no">blank-check-requester</code> can request any kind of certificate from the CA pool.</li>
</ul>
<p>This tutorial uses the certificate issuance policy of a CA pool, certificate templates, and conditional IAM bindings to achieve this scenario.</p>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ul>
<li>Read about the various <a href="https://cloud.google.com/certificate-authority-service/docs/policy-controls">policy controls</a> offered by CA Service.</li>
<li>Read how you can <a href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-template">create certificate templates</a>.</li>
<li>Read about the <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-profile">certificate profiles</a> that you can use for various certificate issuance scenarios.</li>
<li>Read how you can use <a href="https://cloud.google.com/certificate-authority-service/docs/using-cel">Common Expression Language (CEL)</a> to enforce various policy controls for certificate issuance.</li>
<li>Read how you can <a href="https://cloud.google.com/certificate-authority-service/docs/use-issuance-policy">use a certificate issuance policy</a>.</li>
<li>Read how you can <a href="https://cloud.google.com/certificate-authority-service/docs/configuring-iam">configure, modify, and remove IAM policies</a> for creating and managing CA Service resources.</li>
</ul>
<h2 data-text="Creating a CA pool" id="create-ca-pool">Creating a CA pool</h2>
<p>To create a CA pool, use the following instructions:</p>
<ol>
<li><p>To create a CA pool that uses the <code dir="ltr" translate="no">issuance-policy.yaml</code> file, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">POOL_NAME</var> \
    --tier=ENTERPRISE
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--tier</code> flag is used to specify the tier of the CA pool. For more information about tiers, see <a href="https://cloud.google.com/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</li>
</ul></section>
</div></li>
<li><p>To create a CA with Google-managed resources in the newly created CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots create <var translate="no">CA_NAME</var> \
   --pool=<var translate="no">POOL_NAME</var> \
   --subject="CN=Example DNS Root, O=Example LLC, C=US" \
   --validity="10Y" \
   --max-chain-length=1 \
   --auto-enable
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">POOL_NAME</var> is the unique identifier of the CA pool.</li>
<li><code dir="ltr" translate="no">--subject</code> flag is used to pass the name of the certificate subject.</li>
<li><code dir="ltr" translate="no">--validity</code> flag determines the validity period of the CA. The default validity period is 10 years.</li>
<li><code dir="ltr" translate="no">--max-chain-length</code> flag determines the maximum depth of subordinate CAs allowed under a CA.</li>
<li><code dir="ltr" translate="no">--auto-enable</code> flag creates the CA in <code dir="ltr" translate="no">ENABLED</code> state, rather than in the <code dir="ltr" translate="no">STAGED</code> state. For more information about CA states, see <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</li>
</ul></section>
</div><aside class="note"><strong>Note:</strong><span> The user who creates the CA pool has permissions associated with the CA Service Operations Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) role by default. Project-level permissions associated with the roles supersede any custom bindings set at the resource level. When you are creating fine-grained policy controls, ensure the accounts don't have project or organization-level permissions that might conflict with the issuance policy.</span></aside></li>
</ol>
<h2 data-text="Configuring policy controls for test certificates" id="test-policy-controls">Configuring policy controls for test certificates</h2>
<p>The issuance policy changes are effective immediately. We recommend that you configure test policy controls before using them for production. This section describes how you can configure test policy controls.</p>
<p>For both the test and production DNS templates, you must use the same predefined values for server TLS certificates. Create a YAML file <code dir="ltr" translate="no">leaf_server_tls_predefined_values.yaml</code>, and copy the following end-entity server TLS configuration into the file.</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">  keyUsage:
    baseKeyUsage:
      digitalSignature: true
      keyEncipherment: true
    extendedKeyUsage:
      serverAuth: true
  caOptions:
    isCa: false
</code></pre>
<h3 data-text="Configure policy controls for test DNS certificates" id="test-dns-policy-controls">Configure policy controls for test DNS certificates</h3>
<p>This section describes how you can set policy controls to allow the user <code dir="ltr" translate="no">test-dns-requester</code> to request <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-profile#end-server-tls">end-entity server TLS</a> certificates for DNS in the <code dir="ltr" translate="no">*.test.example.com</code> domain.</p>
<h4 data-text="Create DNS certificate template for test certificates" id="test-dns-certificate-template">Create DNS certificate template for test certificates</h4>
<p>This section describes how you can create a certificate template that contains the <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-profile#end-server-tls">end-entity server TLS</a> configuration. This certificate template restricts certificates to using only DNS SANs on the <code dir="ltr" translate="no">*.test.example.com</code> domain. These restrictions are implemented using a Common Expression Language (CEL) expression. The certificate template also drops any subject specified in the certificate request.</p>
<ol>
<li><p>Use the following <code dir="ltr" translate="no">gcloud</code> command to create the certificate template that contains the end-entity server TLS extensions, drops any <code dir="ltr" translate="no">subject</code> specified in the certificate request, and limits allowed SANs.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates create test-server-tls-template \
  --predefined-values-file  ./leaf_server_tls_predefined_values.yaml \
  --no-copy-subject \
  --copy-sans \
  --identity-cel-expression "subject_alt_names.all(san, san.type == DNS &amp;&amp; san.value.endsWith('.test.example.com'))"
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--predefined-values-file</code> flag is used to pass a YAML file that describes any predefined X.509 values set by the certificate template.</li>
<li><code dir="ltr" translate="no">--no-copy-subject</code> flag drops all caller-specified subjects from the certificate request.</li>
<li><code dir="ltr" translate="no">--copy sans</code> flag ensures that the SAN extension from the certificate request is copied into the signed certificate.</li>
<li><code dir="ltr" translate="no">--identity-cel-expression</code> flag is used to pass a CEL expression that is evaluated against the identity in the certificate before it is issued. For more information about using CEL expressions to implement various policy controls, see <a href="https://cloud.google.com/certificate-authority-service/docs/using-cel">Using CEL</a>.</li>
</ul></section>
</div>
<p>For more information about creating certificate templates, see <a href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-template">Creating certificate templates</a>.</p></li>
</ol>
<h4 data-text="Create IAM bindings for DNS test certificates" id="create-iam-bindings-test-certificates">Create IAM bindings for DNS test certificates</h4>
<p>To allow user <code dir="ltr" translate="no">test-dns-requester@</code> in the DNS CA pool to request test server TLS certificates, create a conditional IAM binding on the CA pool. Grant the <code dir="ltr" translate="no">privateca.certificateRequester</code> role to user <code dir="ltr" translate="no">test-dns-requester@</code> only if the certificate request contains a reference to the <code dir="ltr" translate="no">test-server-tls-template</code> template. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</p>
<ol>
<li><p>Create a policy YAML file <code dir="ltr" translate="no">test_dns_condition.yaml</code>, and copy the following TLS configuration into the file.</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">title: test DNS binding
description: allows user to only create DNS test certificates
expression: api.getAttribute("privateca.googleapis.com/template", "") == "<var translate="no">PROJECT_ID</var>/-/test-server-tls-template"
</code></pre></li>
<li><p>Use the following <code dir="ltr" translate="no">gcloud</code> command to add policy controls that allow <code dir="ltr" translate="no">test-dns-requester@</code> to only request production test TLS certificates from the CA pool.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_NAME</var> \
    --role='roles/privateca.certificateRequester' \
    --member='user:test-dns-requester@' \
    --condition-from-file=./test_dns_condition.yaml
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--role</code> flag is used to pass the role name that is to be assigned to a member. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and roles</a>.</li>
<li><code dir="ltr" translate="no">--member</code> flag is used to pass the member to add the binding for.</li>
<li><code dir="ltr" translate="no">condition-from-file</code> flag is used to pass the name of the file with the CEL condition.</li>
</ul></section>
</div></li>
<li><p>Use the following <code dir="ltr" translate="no">gcloud</code> to add policy controls that allow <code dir="ltr" translate="no">test-dns-requester@</code> to use the 'test-server-tls-template' certificate template.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_4">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca template add-iam-policy-binding test-server-tls-template \
    --role='roles/privateca.templateUser' \
    --member='user:test-dns-requester@' \
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--role</code> flag is used to pass the role name that is to be assigned to a member. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</li>
<li><code dir="ltr" translate="no">--member</code> flag is used to pass the member to add the binding for.</li>
</ul></section>
</div>
<p>For more information about configuring IAM policies, see <a href="https://cloud.google.com/certificate-authority-service/docs/configuring-iam">Configuring IAM policies</a>.</p></li>
</ol>
<h2 data-text="Configuring policy controls for production certificates" id="prod-policy-controls">Configuring policy controls for production certificates</h2>
<p>Once you have tested your policy controls, you can use those policy controls in your production environment.</p>
<h3 data-text="Configure policy controls for production DNS certificates" id="prod-dns-policy-controls">Configure policy controls for production DNS certificates</h3>
<p>This section describes how you can set policy controls to allow the user <code dir="ltr" translate="no">prod-dns-requester</code> to request end-entity TLS certificates for the DNS <code dir="ltr" translate="no">.prod.example.com</code> domain.</p>
<h4 data-text="Create certificate template for production DNS certificates" id="prod-dns-certificate-template">Create certificate template for production DNS certificates</h4>
<p>Use the following instructions to create a certificate template that contains <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-profile#end-server-tls">end-entity server TLS</a> configuration. This certificate template restricts certificates to using only DNS SANs on the <code dir="ltr" translate="no">*.prod.example.com</code> domain. These restrictions are implemented using a Common Expression Language (CEL) expression. The certificate template also drops any subject specified in the certificate request.</p>
<p>Create a certificate template <code dir="ltr" translate="no">prod-server-tls-template</code> using the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_5">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">  gcloud privateca templates create prod-server-tls-template \
    --predefined-values-file ./leaf_server_tls_predefined_values.yaml \
    --no-copy-subject \
    --copy-sans \
    --identity-cel-expression "subject_alt_names.all(san, san.type == DNS &amp;&amp; san.value.endsWith('.prod.example.com'))"
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--predefined-values-file</code> flag is used to pass a YAML file that describes any predefined X.509 values set by the certificate template.</li>
<li><code dir="ltr" translate="no">--no-copy-subject</code> flag drops all caller-specified subjects from the certificate request.</li>
<li><code dir="ltr" translate="no">--copy sans</code> flag ensures that the SAN extension from the certificate request is copied into the signed certificate.</li>
<li><code dir="ltr" translate="no">--identity-cel-expression</code> flag is used to pass a CEL expression that is evaluated against the identity in the certificate before it is issued. For more information about CEL expressions, see <a href="https://cloud.google.com/certificate-authority-service/docs/using-cel">Using CEL expressions</a>.</li>
</ul></section>
</div>
<p>For more information about creating certificate templates, see <a href="https://cloud.google.com/certificate-authority-service/docs/creating-certificate-template">Creating certificate templates</a>.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates create</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/create">gcloud privateca templates create</a>.</p>
<h4 data-text="Create production DNS IAM binding" id="create-production-iam-binding">Create production DNS IAM binding</h4>
<p>To allow user <code dir="ltr" translate="no">prod-dns-requester@</code> in the DNS CA pool to request production server TLS certificates, create a conditional IAM binding on the CA pool. Give the user <code dir="ltr" translate="no">prod-dns-requester@</code> the <code dir="ltr" translate="no">privateca.certificateRequester</code> role only if the certificate request contains a reference to the <code dir="ltr" translate="no">prod-server-tls-template</code> template. For more information about IAM roles and permissions, see: <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and roles</a>.</p>
<ol>
<li><p>Create a policy YAML file <code dir="ltr" translate="no">prod_dns_condition.yaml</code> and copy the following TLS configuration into the file.</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">title: Production DNS binding
description: allows user to only create DNS production certificates
expression: api.getAttribute("privateca.googleapis.com/template", "") == "<var translate="no">PROJECT_ID</var>/-/prod-server-tls-template"
</code></pre></li>
<li><p>Use the following <code dir="ltr" translate="no">gcloud</code> command to add policy controls that allow <code dir="ltr" translate="no">prod-dns-requester@</code> to only request production server TLS certificates from the CA pool.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_6">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_NAME</var> \
    --role='roles/privateca.certificateRequester' \
    --member='user:prod-dns-requester@' \
    --condition-from-file=./prod_dns_condition.yaml
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--role</code> flag is used to pass the role name that is to be assigned to a member. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</li>
<li><code dir="ltr" translate="no">--member</code> flag is used to pass the member to add the binding for.</li>
<li><code dir="ltr" translate="no">condition-from-file</code> flag is used to pass the name of the file with the CEL condition.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca template add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca template add-iam-policy-binding</a>.</p></section>
</div></li>
<li><p>To add policy controls that allow <code dir="ltr" translate="no">prod-dns-requester@</code> to use the 'prod-server-tls-template' certificate template, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_7">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca template add-iam-policy-binding prod-server-tls-template \
    --role='roles/privateca.templateUser' \
    --member='user:prod-dns-requester@' \
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--role</code> flag is used to pass the role name that is to be assigned to a member. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</li>
<li><code dir="ltr" translate="no">--member</code> flag is used to pass the member to add the binding for.</li>
</ul></section>
</div></li>
</ol>
<!--
### Set production code signing policy controls {:#prod-code-signing}

Use the following instructions to set a policy control that allows the user `prod-code-signing-requester@` to request code signing certificates. This policy control places a restriction on the Common Name and Organization of the certificate subject.

1. Create a policy YAML file `code_signing_values.yaml`, and copy the following YAML configuration into the file. that contains predefined values for code signing, and restricts the Common Name to `code signing 1` and the organization to `Example LLC` in the certificate subject description using a CEL expression.

  ```yaml
  keyUsage:
    baseKeyUsage:
      digitalSignature: true
    extendedKeyUsage:
      codeSigning: true
  caOptions:
    isCa: false
  ```

1. Use the following `gcloud` command to add policy controls that allow `prod-code-signing-requester@` to request code signing certificates from the CA pool.

    * {gcloud}

      ```
      gcloud privateca templates create code-signing-template \
          --predefined-values-file  /code_signing_values.yaml \
          --copy-subject \
          --no-copy-sans \
          --identity-cel-expression "subject.common_name == 'code signing 1' and subject.organization == 'Example LLC'"
      ```

      Where:

      - `no-copy-sans` flag ensures that all the SANs in the requested certificate are dropped.
      - The CEL expression ensures that the `Common Name` is `code signing 1` and the Organization is `Example LLC` in the certificate subject. For more information on using CEL expressions to implement various policy controls, see [Using CEL](../using-cel).

#### Set production code signing IAM binding {:#prod-code-signing-iam}

To allow user `prod-code-signing-requester@` to only request code signing certificates from the CA pool, create a conditional IAM binding on the CA pool giving the `privateca.certificateRequester` role if the certificate request contains a reference to the template we just created.

A CA Service Certificate Requester can submit certificate requests to a CA. This role must be granted to trusted individuals who are allowed to request certificates. For more information on IAM roles and permissions for CA Service, see [Permissions and roles](../reference/permissions-and-roles).

1. Create a YAML file with the name `test_dns_condition.yaml` and copy the following contents into the file.

  ```yaml
  title: code signing binding
  description: allows user to create code signing certificates
  expression: api.getAttribute("privateca.googleapis.com/template", "") == "<var translate="no">PROJECT_ID</var>/-/code-signing-template"
  ```

1. Use the following `gcloud` command to add policy controls that allow `prod-code-signing-requester@` to request code signing certificates from the CA pool.

   * {gcloud}

      ```
      gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_NAME</var> \
          --role='roles/privateca.certificateRequester' \
          --member='user:prod-code-signing-requester@' \
          --condition-from-file=/code_signing_condition.yaml
      ```

      Where:

      - The value of `--role` flag determines the role that is assigned to the user. For more information on IAM roles and permissions for CA Service, see [Roles and permissions](../reference/permissions-and-roles).
      - The value of `--member` flag determines the user who is assigned the role.
      - The value of `--condition-from-file` flag determines the YAML file that is used to set the IAM binding.
-->
<h3 data-text="Unrestricted user policy controls" id="unrestricted">Unrestricted user policy controls</h3>
<p>To allow the user <code dir="ltr" translate="no">blank-check-requester@</code> to request any certificate without any limitations, create an IAM binding without any conditionals giving the user the role <code dir="ltr" translate="no">privateca.certificateRequester</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_8">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_NAME</var> \
  --role='roles/privateca.certificateRequester' \
  --member='user:blank-check-requester@example.com'
</code></pre>
<p>Where:</p>
<ul>
<li>The value of the <code dir="ltr" translate="no">--role</code> flag determines the role that is assigned to the user. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</li>
<li>The value of the <code dir="ltr" translate="no">--member</code> flag determines the user who is assigned the role.</li>
</ul></section>
</div>
<h2 data-text="Testing the policy controls" id="test-policy">Testing the policy controls</h2>
<p>Once you have implemented your certificate issuance and IAM policies, it is important to review and test these policies to ensure that they work as expected.</p>
<h3 data-text="Retrieve all policy bindings" id="retrieve-policies">Retrieve all policy bindings</h3>
<p>Fetch all the IAM policies that are implemented on your CA pool. To retrieve all the IAM policies for the CA pool, use the <code dir="ltr" translate="no">gcloud privateca pools get-iam-policy</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_9">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools get-iam-policy <var translate="no">POOL_NAME</var>
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">POOL_NAME</var> is the unique identifier of the CA pool.</li>
</ul></section>
</div>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools get-iam-policy</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/get-iam-policy">gcloud privateca pools get-iam-policy</a>.</p>
<h2 data-text="Generating certificates" id="generate-certificates">Generating certificates</h2>
<p>This section provides information on generating general-purpose certificates, and test and production DNS certificates.</p>
<h3 data-text="Generate test DNS certificates" id="generating-test-dns-certificates">Generate test DNS certificates</h3>
<p>To allow user <code dir="ltr" translate="no">test-dns-requester@</code> to request test DNS certificates from the CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_10">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create test-dns-1 \
    --project=<var translate="no">PROJECT_ID</var> \
    --issuer-location=<var translate="no">LOCATION</var> \
    --issuer-pool=<var translate="no">POOL_NAME</var> \
    --dns-san=foo.bar.test.example.com \
    --generate-key \
    --key-output-file=<var translate="no">KEY_FILE_NAME</var> \
    --cert-output-file=test_dns_cert.pem \
    --template=projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/certificateTemplates/test-server-tls-template
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--issuer-location</code> flag is used to set the location of the certificate. For the complete list of locations, see <a href="https://cloud.google.com/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><code dir="ltr" translate="no">--issuer-pool</code> flag sets the CA pool from which the certificate is requested.</li>
<li><code dir="ltr" translate="no">--dns-san</code> flag is used to set one or more comma-separated DNS SANs.</li>
<li><code dir="ltr" translate="no">--generate-key</code> flag triggers the generation of a new RSA-2048 private key on your machine.</li>
<li><code dir="ltr" translate="no">--key-output-file</code> flag is used to set the path where the generated private key is written (in PEM format).</li>
<li><code dir="ltr" translate="no">--cert-output-file</code> flag is used to set the path where the resulting PEM-encoded certificate chain file is written (ordered from end-entity to root).</li>
<li><code dir="ltr" translate="no">--template</code> flag is used to set the name of the certificate template that you want to use for issuing this certificate. The specified template must be in the same location as the issuing CA pool. For more information about certificate templates, see <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</li>
</ul></section>
</div>
<h3 data-text="Generate production certificates" id="generate-prod-certificates">Generate production certificates</h3>
<p>The user <code dir="ltr" translate="no">prod-dns-requester</code> can now request production DNS certificates from the CA pool. The <code dir="ltr" translate="no">--dns-san=foo.bar.prod.example.com</code> adds a SAN of DNS type with the specified value to the certificate request.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_11">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create prod-dns-1 \
    --project=<var translate="no">PROJECT_ID</var> \
    --issuer-location=<var translate="no">LOCATION</var> \
    --issuer-pool=<var translate="no">POOL_NAME</var> \
    --dns-san=foo.bar.prod.example.com \
    --generate-key \
    --key-output-file=<var translate="no">KEY_FILE_NAME</var> \
    --cert-output-file=prod_dns_cert.pem \
    --template=projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/certificateTemplates/prod-server-tls-template
</code></pre>
<p>Where:</p>
<ul>
<li><code dir="ltr" translate="no">--issuer-location</code> flag is used to set the location of the certificate. For the complete list of locations, see <a href="https://cloud.google.com/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><code dir="ltr" translate="no">--issuer-pool</code> flag sets the CA pool from which the certificate is requested.</li>
<li><code dir="ltr" translate="no">--dns-san</code> flag is used to set one or more comma-separated DNS SANs.</li>
<li><code dir="ltr" translate="no">--generate-key</code> flag triggers the generation of a new RSA-2048 private key on your machine.</li>
<li><code dir="ltr" translate="no">--key-output-file</code> flag is used to set the path where the generated private key is written (in PEM format).</li>
<li><code dir="ltr" translate="no">--cert-output-file</code> flag is used to set the path where the resulting PEM-encoded certificate chain file is written (ordered from end-entity to root).</li>
<li><code dir="ltr" translate="no">--template</code> flag is used to set the name of the certificate template to use for issuing this certificate. The specified template must be in the same location as the issuing CA pool. For more information about certificate templates, see <a href="https://cloud.google.com/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</li>
</ul></section>
</div>
<h3 data-text="Generate general-purpose certificates" id="generating-general-certificates">Generate general-purpose certificates</h3>
<p>The user <code dir="ltr" translate="no">blank-check-requester@</code> can request any certificate from the CA pool using the <code dir="ltr" translate="no">gcloud privateca certificates create</code> command.</p>
<p>To request a certificate from a CA pool, you can use a public/private key created by CA Service. For more information about requesting certificates, see <a href="https://cloud.google.com/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>.</p>
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>This section explains how you can remove IAM policies over a CA pool.</p>
<h3 data-text="Remove a specific IAM binding" id="remove-specific-binding">Remove a specific IAM binding</h3>
<p>To remove the IAM conditional bindings over the CA pool for <code dir="ltr" translate="no">blank-check-requester</code> user, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_12">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding <var translate="no">POOL_NAME</var> \
    --role='roles/privateca.certificateRequester' \
    --member='user:blank-check-requester@'
</code></pre>
<p>Where:</p>
<ul>
<li>The value of the <code dir="ltr" translate="no">--role</code> flag determines the role that is assigned to the user. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</li>
<li>The value of the <code dir="ltr" translate="no">--member</code> flag determines the user who is assigned the role.</li>
</ul></section>
</div>
<p>When removing a specific IAM binding, you must provide all the information related to the IAM binding in the <code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding</code> command. A role and member might have multiple IAM bindings with different conditions. It is important that you provide all the details related to the IAM binding to avoid accidentally deleting a different binding.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/remove-iam-policy-binding">gcloud privateca pools remove-iam-policy-binding</a>.</p>
<h3 data-text="Remove all IAM conditional bindings" id="remove-all">Remove all IAM conditional bindings</h3>
<p>To remove an IAM binding, you can use the <code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding</code> command. When removing an IAM conditional binding, you must provide all the information about the binding. A user and a role can have more than one conditional binding. To remove all conditional bindings, use the <code dir="ltr" translate="no">--all</code> flag in your <code dir="ltr" translate="no">gcloud</code> command.</p>
<p>Use the following <code dir="ltr" translate="no">gcloud</code> command to remove all bindings for the <code dir="ltr" translate="no">prod-code-signing-requester</code> user.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_13">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding <var translate="no">POOL_NAME</var> \
    --role='roles/privateca.certificateRequester' \
    --member='user:prod-code-signing-requester@' \
    --all
</code></pre>
<p>Where:</p>
<ul>
<li>The value of the <code dir="ltr" translate="no">--role</code> flag determines the role that is assigned to the user. For more information about IAM roles and permissions for CA Service, see <a href="https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles">Roles and permissions</a>.</li>
<li>The value of the <code dir="ltr" translate="no">--member</code> flag determines the user who is assigned the role.</li>
</ul></section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/creating-certificate-authorities]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Creating certificate authorities" id="creating-certificate-authorities">Creating certificate authorities</h1>
<p>This topic describes how to create certificate authorities (CAs) in a CA pool.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<ul>
<li><p>Make sure you have the CA Service Operation Manager
(<code dir="ltr" translate="no">roles/privateca.caManager</code>) or the CA Service Admin
(<code dir="ltr" translate="no">roles/privateca.admin</code>) IAM role. For information about
granting an IAM to a principal, see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single
role</a>.</p></li>
<li><p>Create a CA pool by following the instructions in <a href="/certificate-authority-service/docs/creating-ca-pool">Creating CA
pools</a>.</p></li>
</ul>
<h2 data-text="Deciding the CA's settings" id="decide-ca-settings">Deciding the CA's settings</h2>
<p>You cannot change some CA settings after creating the CA. Some of these settings are
specific to Certificate Authority Service, while other settings are inherently immutable
to CAs, because they appear in the CA's own certificate. For example, the CA
type (root or subordinate) is a permanent setting.</p>
<p>For more information, see <a href="/certificate-authority-service/docs/certificate-authority-settings#permanent">Permanent CA settings</a>.</p>
<h2 data-text="Creating a root CA" id="create-root-ca">Creating a root CA</h2>
<p>A root CA has a self-signed certificate that you must distribute to the trust
stores of your clients. The root CA's certificate is at the top of the
<em>certificate chain</em>. No other CA can revoke the CA certificate. The CRL of the
root CA applies only to the other certificates the root CA issued, but not to
itself.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><p>To create a root CA, do the following.</p>
<ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in
the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab.</p>
<aside class="note"><strong>Note:</strong><span> You can't create more than one CA inside a CA pool using the
<strong>CA manager</strong> tab.</span></aside></li>
<li><p>Click <strong>Create CA</strong>.</p></li>
</ol>
<p><strong>Select CA type</strong></p>
<p>To configure the permanent settings of the CA, such as tier, location,
lifetime, and the operational state at creation, do the following:</p>
<ol>
<li>Select <strong>Root CA</strong>.</li>
<li>In the <strong>Valid for</strong> field, enter the duration for which you want the
certificates issued by the CA certificate to be valid.</li>
<li>Optional: Choose a tier for the CA. For more information, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized
tiers</a>.</li>
<li>Click <strong>Region</strong> and in the list, select the location where you want to
create the CA. We recommend creating the CA geographically near
your application's clients. For more information, see <a href="/certificate-authority-service/docs/locations#choosing-best-location">Choosing the best
location</a>.</li>
<li><p>Optional: Select the operational state of the CA to be created in.</p>
<p><img class="screenshot" data-modal-dialog-id="initial-state" src="/certificate-authority-service/images/initialized-state-ca.png" style="width: 80%"/>
<devsite-lightbox id="initial-state">
<img alt="Choose the operation state of the CA to be created in." src="/certificate-authority-service/images/initialized-state-ca.png"/>
</devsite-lightbox></p></li>
<li><p>Optional: Click <strong>Certificate profile</strong>. In the list, select the
certificate profile that matches the type of certificates you want the
CA to issue.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
</ol>
<b>Configure CA subject name</b>
<ol>
<li>
    In the <b>Organization (O)</b> field, enter the name of your company.
  </li>
<li>
    Optional: In the <b>Organization unit (OU)</b> field, enter the company
    subdivision or business unit.
  </li>
<li>
    Optional: In the <b>Country name</b> field, enter a two letter country code.
  </li>
<li>
    Optional: In the <b>State or province name</b> field, enter the name of
    your state.
  </li>
<li>
    Optional: In the <b>Locality name</b> field, enter the name of your city.
  </li>
<li>
    In the <b>CA common name (CN)</b> field, enter the CA name.
  </li>
<li>
    In the <b>Pool ID</b> field, enter the CA pool name. You cannot change the
    CA pool after creating the CA.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure CA key size and algorithm</b>
<ol>
<li>
    Choose the key algorithm that best meets your needs. For information
    about deciding the suitable key algorithm, see
    <a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure CA artifacts</b>
<p>
  The following steps are optional. If you skip these steps, the default
  settings apply.
</p>
<ol>
<li>
    Choose whether you want to use a Google-managed or a self-managed
    Cloud Storage bucket.
  </li>
<p>
    If you don't select a self-managed Cloud Storage bucket,
    CA Service creates a Google-managed bucket in the same
    location as the CA.
  </p>
<li>
    Choose whether you want to disable the publication of certificate
    revocation lists (CRLs) and CA certificates to the Cloud Storage
    bucket.
  </li>
<p>
    The publication of CRL and CA certificate on a Cloud Storage bucket
    is enabled by default. To disable these settings, click the toggles.
  </p>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Add labels</b>
<p>
  The following steps are optional.
</p>
<p>
  If you want to add labels to the CA, do the following:
</p>
<ol>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">add</span><b>Add item</b>.
  </li>
<li>
    In the <b>Key 1</b> field, enter the label key.
  </li>
<li>
    In the <b>Value 1</b> field, enter the label value.
  </li>
<li>
    If you want to add another label, click
    <span aria-hidden="true" class="material-icons" translate="no">add</span><b>Add item</b>. Then, add the
    label key and value as mentioned in steps 2 and 3.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Review the settings</b>
<p>
  Carefully review all the settings, then click <b>Create</b> to create the CA.
</p>
</section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><ol>
<li><p>To create a CA pool, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">POOL_ID</var>
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the CA pool.</p>
<p>For more information, see <a href="/certificate-authority-service/docs/creating-ca-pool">Creating a CA
pool</a>.</p>
<p>For more information about this <code dir="ltr" translate="no">gcloud</code> command, see
<a href="/sdk/gcloud/reference/privateca/pools/create">gcloud privateca pools create</a>.</p></li>
<li><p>Create a new root CA in the CA pool you created.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots create <var translate="no">ROOT_CA_ID</var> --pool=<var translate="no">POOL_ID</var> \
  --key-algorithm=<var translate="no">KEY_ALGORITHM</var> \
  --subject="CN=my-ca, O=Test LLC"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">ROOT_CA_ID</var>: The name of the CA.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
<li><var translate="no">KEY_ALGORITHM</var>: The algorithm to use for creating a
Cloud KMS key. This flag is optional. If you don't include
this flag, the key algorithm defaults to <code dir="ltr" translate="no">rsa-pkcs1-4096-sha256</code>. For
more information, see <a href="/sdk/gcloud/reference/beta/privateca/roots/create#--key-algorithm">--key-algorithm flag</a>.</li>
</ul>
<p>By default, the CA is created in the <code dir="ltr" translate="no">STAGED</code> state. To enable a CA by
default, include the <code dir="ltr" translate="no">--auto-enable</code> flag.</p>
<p>If you want to use a customer-managed Cloud Storage bucket for
publishing CA certificates and CRLs, add <code dir="ltr" translate="no">--bucket <var translate="no">bucket-name</var></code>
to the command. Replace <var translate="no">bucket-name</var> with the
name of the Cloud Storage bucket.</p>
<p>To see the exhaustive list of settings, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots create --help
</code></pre></li>
</ol></section>
<section><h3 data-text="REST API" id="rest-api">REST API</h3><ol>
<li><p>Create a root CA.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">POST https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities?certificate_authority_id=<var translate="no">ROOT_CA_ID</var></pre>
</section>
<p>
  Request JSON body:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="request body" dir="ltr" suppresswarning="" translate="no">
{
"type": "SELF_SIGNED",
"lifetime": {
 "seconds": 315576000,
 "nanos": 0
},
"config": {
 "subject_config": {
   "subject": {
     "organization": "<var translate="no">ORGANIZATION_NAME</var>",
     "common_name": "<var translate="no">COMMON_NAME</var>"
   }
 },
 "x509_config":{
   "ca_options":{
     "is_ca":true
   },
   "key_usage":{
     "base_key_usage":{
       "cert_sign":true,
       "crl_sign":true
     }
   }
 }
},
"key_spec":{
 "algorithm":"RSA_PKCS1_4096_SHA256"
}
}
</pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Save the request body in a file called <code dir="ltr" translate="no">request.json</code>,
    and execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X POST \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>-H "Content-Type: application/json; charset=utf-8" \<br/>-d @request.json \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities?certificate_authority_id=<var translate="no">ROOT_CA_ID</var>"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Save the request body in a file called <code dir="ltr" translate="no">request.json</code>,
    and execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method POST `<br/>  -Headers $headers `<br/>  -ContentType: "application/json; charset=utf-8" `<br/>  -InFile request.json `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities?certificate_authority_id=<var translate="no">ROOT_CA_ID</var>" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>",
 "metadata": {...},
 "done": false
}
</pre>
</section>
</p></li>
<li><p>Poll the operation until it has completed.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">GET https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var></pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell_1">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X GET \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows_1">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method GET `<br/>  -Headers $headers `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>",
 "metadata": {...},
 "done": true,
 "response": {
   "@type": "type.googleapis.com/google.cloud.security.privateca.v1.CertificateAuthority",
   "name": "...",
 }
}
</pre>
</section>
</p></li>
</ol></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_create_ca-code-sample">
<section>
<h3 data-text="Java" id="privateca_create_ca-java" track-metadata-position="privateca_create_ca" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificateAuthority.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificateAuthority.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_ca" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_create_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificateAuthority.java" data-region-tag="privateca_create_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificateAuthority.java/HEAD/privateca_create_ca" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CaPoolName;
import com.google.cloud.security.privateca.v1.CertificateAuthority;
import com.google.cloud.security.privateca.v1.CertificateAuthority.KeyVersionSpec;
import com.google.cloud.security.privateca.v1.CertificateAuthority.SignHashAlgorithm;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.CertificateConfig;
import com.google.cloud.security.privateca.v1.CertificateConfig.SubjectConfig;
import com.google.cloud.security.privateca.v1.CreateCertificateAuthorityRequest;
import com.google.cloud.security.privateca.v1.KeyUsage;
import com.google.cloud.security.privateca.v1.KeyUsage.KeyUsageOptions;
import com.google.cloud.security.privateca.v1.Subject;
import com.google.cloud.security.privateca.v1.X509Parameters;
import com.google.cloud.security.privateca.v1.X509Parameters.CaOptions;
import com.google.longrunning.Operation;
import com.google.protobuf.Duration;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class CreateCertificateAuthority {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: Set it to the CA Pool under which the CA should be created.
    // certificateAuthorityName: Unique name for the CA.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    String certificateAuthorityName = "certificate-authority-name";
    createCertificateAuthority(project, location, pool_Id, certificateAuthorityName);
  }

  // Create Certificate Authority which is the root CA in the given CA Pool.
  public static void createCertificateAuthority(
      String project, String location, String pool_Id, String certificateAuthorityName)
      throws InterruptedException, ExecutionException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      String commonName = "common-name";
      String orgName = "org-name";
      int caDuration = 100000; // Validity of this CA in seconds.

      // Set the type of Algorithm.
      KeyVersionSpec keyVersionSpec =
          KeyVersionSpec.newBuilder().setAlgorithm(SignHashAlgorithm.RSA_PKCS1_4096_SHA256).build();

      // Set CA subject config.
      SubjectConfig subjectConfig =
          SubjectConfig.newBuilder()
              .setSubject(
                  Subject.newBuilder().setCommonName(commonName).setOrganization(orgName).build())
              .build();

      //  Set the key usage options for X.509 fields.
      X509Parameters x509Parameters =
          X509Parameters.newBuilder()
              .setKeyUsage(
                  KeyUsage.newBuilder()
                      .setBaseKeyUsage(
                          KeyUsageOptions.newBuilder().setCrlSign(true).setCertSign(true).build())
                      .build())
              .setCaOptions(CaOptions.newBuilder().setIsCa(true).build())
              .build();

      // Set certificate authority settings.
      CertificateAuthority certificateAuthority =
          CertificateAuthority.newBuilder()
              // CertificateAuthority.Type.SELF_SIGNED denotes that this CA is a root CA.
              .setType(CertificateAuthority.Type.SELF_SIGNED)
              .setKeySpec(keyVersionSpec)
              .setConfig(
                  CertificateConfig.newBuilder()
                      .setSubjectConfig(subjectConfig)
                      .setX509Config(x509Parameters)
                      .build())
              // Set the CA validity duration.
              .setLifetime(Duration.newBuilder().setSeconds(caDuration).build())
              .build();

      // Create the CertificateAuthorityRequest.
      CreateCertificateAuthorityRequest certificateAuthorityRequest =
          CreateCertificateAuthorityRequest.newBuilder()
              .setParent(CaPoolName.of(project, location, pool_Id).toString())
              .setCertificateAuthorityId(certificateAuthorityName)
              .setCertificateAuthority(certificateAuthority)
              .build();

      // Create Certificate Authority.
      ApiFuture&lt;Operation&gt; futureCall =
          certificateAuthorityServiceClient
              .createCertificateAuthorityCallable()
              .futureCall(certificateAuthorityRequest);
      Operation response = futureCall.get();

      if (response.hasError()) {
        System.out.println("Error while creating CA !" + response.getError());
        return;
      }

      System.out.println(
          "Certificate Authority created successfully : " + certificateAuthorityName);
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_create_ca-python" track-metadata-position="privateca_create_ca" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_certificate_authority.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_certificate_authority.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_ca" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_create_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/create_certificate_authority.py" data-region-tag="privateca_create_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/create_certificate_authority.py/HEAD/privateca_create_ca" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1
from google.protobuf import duration_pb2


def create_certificate_authority(
    project_id: str,
    location: str,
    ca_pool_name: str,
    ca_name: str,
    common_name: str,
    organization: str,
    ca_duration: int,
) -&gt; None:
    """
    Create Certificate Authority which is the root CA in the given CA Pool. This CA will be
    responsible for signing certificates within this pool.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: set it to the CA Pool under which the CA should be created.
        ca_name: unique name for the CA.
        common_name: a title for your certificate authority.
        organization: the name of your company for your certificate authority.
        ca_duration: the validity of the certificate authority in seconds.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    # Set the types of Algorithm used to create a cloud KMS key.
    key_version_spec = privateca_v1.CertificateAuthority.KeyVersionSpec(
        algorithm=privateca_v1.CertificateAuthority.SignHashAlgorithm.RSA_PKCS1_4096_SHA256
    )

    # Set CA subject config.
    subject_config = privateca_v1.CertificateConfig.SubjectConfig(
        subject=privateca_v1.Subject(common_name=common_name, organization=organization)
    )

    # Set the key usage options for X.509 fields.
    x509_parameters = privateca_v1.X509Parameters(
        key_usage=privateca_v1.KeyUsage(
            base_key_usage=privateca_v1.KeyUsage.KeyUsageOptions(
                crl_sign=True,
                cert_sign=True,
            )
        ),
        ca_options=privateca_v1.X509Parameters.CaOptions(
            is_ca=True,
        ),
    )

    # Set certificate authority settings.
    certificate_authority = privateca_v1.CertificateAuthority(
        # CertificateAuthority.Type.SELF_SIGNED denotes that this CA is a root CA.
        type_=privateca_v1.CertificateAuthority.Type.SELF_SIGNED,
        key_spec=key_version_spec,
        config=privateca_v1.CertificateConfig(
            subject_config=subject_config,
            x509_config=x509_parameters,
        ),
        lifetime=duration_pb2.Duration(seconds=ca_duration),
    )

    ca_pool_path = caServiceClient.ca_pool_path(project_id, location, ca_pool_name)

    # Create the CertificateAuthorityRequest.
    request = privateca_v1.CreateCertificateAuthorityRequest(
        parent=ca_pool_path,
        certificate_authority_id=ca_name,
        certificate_authority=certificate_authority,
    )

    operation = caServiceClient.create_certificate_authority(request=request)
    result = operation.result()

    print("Operation result:", result)

</code></pre>
</div>
</section>
</div></p></section>
<section><h3 data-text="Terraform" id="terraform">Terraform</h3><p>To create a root CA using a Google-managed key, use the following sample
configuration:</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_authority_basic/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_authority_basic/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_certificate_authority_basic/main.tf" data-region-tag="privateca_create_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_certificate_authority_basic/main.tf/main/privateca_create_ca" translate="no"><code dir="ltr" translate="no">resource "google_privateca_certificate_authority" "default" {
  // This example assumes this pool already exists.
  // Pools cannot be deleted in normal test circumstances, so we depend on static pools
  pool = "ca-pool"
  certificate_authority_id = "my-certificate-authority"
  location = "us-central1"
  deletion_protection = "true"
  config {
    subject_config {
      subject {
        organization = "HashiCorp"
        common_name = "my-certificate-authority"
      }
      subject_alt_name {
        dns_names = ["hashicorp.com"]
      }
    }
    x509_config {
      ca_options {
        is_ca = true
        max_issuer_path_length = 10
      }
      key_usage {
        base_key_usage {
          digital_signature = true
          content_commitment = true
          key_encipherment = false
          data_encipherment = true
          key_agreement = true
          cert_sign = true
          crl_sign = true
          decipher_only = true
        }
        extended_key_usage {
          server_auth = true
          client_auth = false
          email_protection = true
          code_signing = true
          time_stamping = true
        }
      }
    }
  }
  lifetime = "86400s"
  key_spec {
    algorithm = "RSA_PKCS1_4096_SHA256"
  }
}</code></pre>
</div>
<p>To create a root CA using a self-managed key, use the following sample
configuration:</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_authority_byo_key/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_authority_byo_key/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_certificate_authority_byo_key/main.tf" data-region-tag="privateca_create_ca_byo_key" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_certificate_authority_byo_key/main.tf/main/privateca_create_ca_byo_key" translate="no"><code dir="ltr" translate="no">resource "google_project_service_identity" "privateca_sa" {
  service = "privateca.googleapis.com"
}

resource "google_kms_crypto_key_iam_binding" "privateca_sa_keyuser_signerverifier" {
  crypto_key_id = "projects/keys-project/locations/us-central1/keyRings/key-ring/cryptoKeys/crypto-key"
  role          = "roles/cloudkms.signerVerifier"

  members = [
    "serviceAccount:${google_project_service_identity.privateca_sa.email}",
  ]
}

resource "google_kms_crypto_key_iam_binding" "privateca_sa_keyuser_viewer" {
  crypto_key_id = "projects/keys-project/locations/us-central1/keyRings/key-ring/cryptoKeys/crypto-key"
  role          = "roles/viewer"
  members = [
    "serviceAccount:${google_project_service_identity.privateca_sa.email}",
  ]
}

resource "google_privateca_certificate_authority" "default" {
  // This example assumes this pool already exists.
  // Pools cannot be deleted in normal test circumstances, so we depend on static pools
  pool = "ca-pool"
  certificate_authority_id = "my-certificate-authority"
  location = "us-central1"
  deletion_protection = "true"
  key_spec {
    cloud_kms_key_version = "projects/keys-project/locations/us-central1/keyRings/key-ring/cryptoKeys/crypto-key/cryptoKeyVersions/1"
  }

  config  {
    subject_config  {
      subject {
        organization = "Example, Org."
        common_name  = "Example Authority"
      }
    }
    x509_config {
      ca_options {
        # is_ca *MUST* be true for certificate authorities
        is_ca = true
        max_issuer_path_length = 10
      }
      key_usage {
        base_key_usage {
          # cert_sign and crl_sign *MUST* be true for certificate authorities
          cert_sign = true
          crl_sign = true
        }
        extended_key_usage {
          server_auth = false
        }
      }
    }
  }

  depends_on = [
    google_kms_crypto_key_iam_binding.privateca_sa_keyuser_signerverifier,
    google_kms_crypto_key_iam_binding.privateca_sa_keyuser_viewer,
  ]
}</code></pre>
</div>
</section>
</div><aside class="note"><strong>Note:</strong><span> Root CAs are created in the <code dir="ltr" translate="no">STAGED</code> state by default. We recommend that
you test your CA while it is still in the <code dir="ltr" translate="no">STAGED</code> state. You must directly
request certificates from the CA <code dir="ltr" translate="no">STAGED</code> state because these CAs cannot issue
certificates through CA pool load-balancing. For more information, see
<a href="#test">Testing a CA</a>.<br/><br/>For more information about CA states, see
<a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</span></aside>
<p>After you have verified that the CA works as expected, you can enable it to
start issuing load-balanced certificates for the CA pool. For more information, see
<a href="/certificate-authority-service/docs/managing-ca-state#enable">Enabling a CA</a>.</p>
<h2 data-text="Testing a CA" id="test">Testing a CA</h2>
<p>To verify that a CA is able to issue certificates, request a certificate from
the associated CA pool and explicitly mention the name of the CA you want to
test using the <code dir="ltr" translate="no">--ca</code> flag.</p>
<p>You can use the following methods to request a certificate from a CA pool:</p>
<ol>
<li>Have CA Service create a private or public key for you.</li>
<li>Generate your own private or public key and submit a Certificate Signing Request (CSR).</li>
</ol>
<p>It is easier to use an auto-generated private key or public key to request a
certificate from a CA in a CA pool. This section provides information on
testing a CA using that method.</p>
<p>To use an auto-generated private key or public key to request a certificate
from a CA in a CA pool, run the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create \
  --issuer-pool=<var translate="no">POOL_ID</var> \
  --ca=<var translate="no">ROOT_CA_ID</var> \
  --generate-key \
  --key-output-file=<var translate="no">KEY_FILENAME</var> \
  --cert-output-file=<var translate="no">CERT_FILENAME</var> \
  --dns-san=<var translate="no">DNS_NAME</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
<li><var translate="no">ROOT_CA_ID</var>: The unique identifier of the CA that you want to test.</li>
<li><var translate="no">KEY_FILENAME</var>: The file where the generated key is written in PEM format.</li>
<li><var translate="no">CERT_FILENAME</var>: The file where the resulting PEM-encoded certificate chain file is written. The order of the certificate chain is from leaf to root.</li>
<li><p><var translate="no">DNS_NAME</var>: One or more comma-separated DNS Subject Alternative Names (SANs).</p>
<p>The <code dir="ltr" translate="no">--generate-key</code> flag generates a new RSA-2048 private key on your machine.</p></li>
</ul>
<p>To use a Certificate Signing Request (CSR) to request a certificate from a CA in a CA pool, or for more information about requesting certificates, see <a href="/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>.</p>
<h2 data-text="Enabling a root CA" id="enable-root">Enabling a root CA</h2>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>To enable a root CA, run the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots enable <var translate="no">ROOT_CA_ID</var> --pool=<var translate="no">POOL_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">ROOT_CA_ID</var>: The name of the CA.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
</ul></section>
<section><h3 data-text="REST API" id="rest-api_1">REST API</h3><ol>
<li><p>Enable the CA to issue certificates from the CA pool.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">POST https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities/<var translate="no">ROOT_CA_ID</var>:enable</pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell_2">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X POST \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>-H "Content-Type: application/json; charset=utf-8" \<br/>-d "" \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities/<var translate="no">ROOT_CA_ID</var>:enable"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows_2">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method POST `<br/>  -Headers $headers `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificateAuthorities/<var translate="no">ROOT_CA_ID</var>:enable" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>",
 "metadata": {...},
 "done": false
}
</pre>
</section>
</p></li>
<li><p>Poll the operation until it has completed.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">GET https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var></pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell_3">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X GET \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows_3">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method GET `<br/>  -Headers $headers `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/operations/operation-<var translate="no">UUID</var>",
 "metadata": {...},
 "done": true,
 "response": {
   "@type": "type.googleapis.com/google.cloud.security.privateca.v1.CertificateAuthority",
   "name": "...",
 }
}
</pre>
</section>
</p></li>
</ol></section>
</div><aside class="caution"><strong>Caution:</strong><span> Any certificate signed by the private key of the root CA is widely
trusted by browsers. We recommend that you don't issue end-entity certificates
from a root CA. Create subordinate CAs to issue end-entity certificates.</span></aside>
<h2 data-text="Creating a subordinate CA" id="subordinate-internal">Creating a subordinate CA</h2>
<p>Subordinate CAs are easier to revoke and rotate than root CAs. If you have
multiple certificate issuance scenarios, you can create a subordinate CA for
each of those scenarios. Adding multiple subordinate CAs in a CA pool helps you
achieve better load-balancing of certificate requests and a
<a href="/certificate-authority-service/docs/ca-pool#higher-qps">higher total effective QPS</a>.</p>
<p>To create a subordinate CA, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click <strong>CA manager</strong>.</p></li>
<li><p>Click <strong>Create CA</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="create-ca" src="/certificate-authority-service/images/create-ca-quickstart.png" style="width: 75%"/>
<devsite-lightbox id="create-ca">
<img alt="Create a CA using the Cloud console." src="/certificate-authority-service/images/create-ca-quickstart.png"/>
</devsite-lightbox></p></li>
</ol>
<p><strong>Select CA type</strong></p>
<ol>
<li>Click <strong>Subordinate CA</strong>.</li>
<li>Click <strong>Root CA is in Google Cloud</strong>.</li>
<li>In the <strong>Valid for</strong> field, enter the duration for which you want
the CA certificate to be valid.</li>
<li>Optional: Choose the tier for the CA. The default tier is
<strong>Enterprise</strong>. For more information, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized
tiers</a>.</li>
<li>Click <strong>Region</strong> to select a location for the CA. For more
information, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li>Optional: Under <strong>Initialized state</strong>, select the state the CA must
be in at creation.</li>
<li>Optional: Under <strong>Set up an issuance scenario</strong>, click
<strong>Certificate profile</strong> and select the certificate profile that
best suits your requirements from the list. For more
information, see <a href="/certificate-authority-service/docs/certificate-profile">Certificate profiles</a>.</li>
<li>Click <strong>Next</strong>.</li>
</ol>
<b>Configure CA subject name</b>
<ol>
<li>
    In the <b>Organization (O)</b> field, enter the name of your company.
  </li>
<li>
    Optional: In the <b>Organization unit (OU)</b> field, enter the company
    subdivision or business unit.
  </li>
<li>
    Optional: In the <b>Country name</b> field, enter a two letter country code.
  </li>
<li>
    Optional: In the <b>State or province name</b> field, enter the name of
    your state.
  </li>
<li>
    Optional: In the <b>Locality name</b> field, enter the name of your city.
  </li>
<li>
    In the <b>CA common name (CN)</b> field, enter the CA name.
  </li>
<li>
    In the <b>Pool ID</b> field, enter the CA pool name. You cannot change the
    CA pool after creating the CA.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure CA key size and algorithm</b>
<ol>
<li>
    Choose the key algorithm that best meets your needs. For information
    about deciding the suitable key algorithm, see
    <a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure CA artifacts</b>
<p>
  The following steps are optional. If you skip these steps, the default
  settings apply.
</p>
<ol>
<li>
    Choose whether you want to use a Google-managed or a self-managed
    Cloud Storage bucket.
  </li>
<p>
    If you don't select a self-managed Cloud Storage bucket,
    CA Service creates a Google-managed bucket in the same
    location as the CA.
  </p>
<li>
    Choose whether you want to disable the publication of certificate
    revocation lists (CRLs) and CA certificates to the Cloud Storage
    bucket.
  </li>
<p>
    The publication of CRL and CA certificate on a Cloud Storage bucket
    is enabled by default. To disable these settings, click the toggles.
  </p>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Add labels</b>
<p>
  The following steps are optional.
</p>
<p>
  If you want to add labels to the CA, do the following:
</p>
<ol>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">add</span><b>Add item</b>.
  </li>
<li>
    In the <b>Key 1</b> field, enter the label key.
  </li>
<li>
    In the <b>Value 1</b> field, enter the label value.
  </li>
<li>
    If you want to add another label, click
    <span aria-hidden="true" class="material-icons" translate="no">add</span><b>Add item</b>. Then, add the
    label key and value as mentioned in steps 2 and 3.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Review the settings</b>
<p>
  Carefully review all the settings, then click <b>Create</b> to create the CA.
</p>
</section>
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><ol>
<li><p>Create a CA pool for the subordinate CA:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">SUBORDINATE_POOL_ID</var>
</code></pre>
<p>Replace <var translate="no">SUBORDINATE_POOL_ID</var> with the name of the CA pool.</p>
<p>For more information about creating CA pools, see <a href="/certificate-authority-service/docs/creating-ca-pool">Creating a CA pool</a>.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools create</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/create">gcloud privateca pools create</a>.</p></li>
<li><p>Create a subordinate CA in the created CA pool.</p>
<aside class="note"><strong>Note:</strong><span> You can obtain the issuer's resource ID (<var translate="no">POOL_ID</var>)
by copying the ID from the create command, or by leveraging the
<code dir="ltr" translate="no">gcloud privateca pools list</code> command.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates create <var translate="no">SUBORDINATE_CA_ID</var> \
  --pool=<var translate="no">SUBORDINATE_POOL_ID</var> \
  --issuer-pool=<var translate="no">POOL_ID</var> \
  --key-algorithm="ec-p256-sha256" \
  --subject="CN=Example Server TLS CA, O=Example LLC"
</code></pre>
<p>The following statement is returned when the subordinate CA is created.</p>
<pre dir="ltr" translate="no">
Created Certificate Authority [projects/my-project-pki/locations/us-west1/caPools/<var translate="no">SUBORDINATE_POOL_ID</var>/certificateAuthorities/<var translate="no">SUBORDINATE_CA_ID</var>].
</pre>
<p>To see an exhaustive list of settings, run the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates create --help
</code></pre>
<p>The command returns examples to create a subordinate CA whose issuer is either located on CA Service or located elsewhere.</p></li>
</ol></section>
<section><h3 data-text="Terraform" id="terraform_1">Terraform</h3>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_authority_subordinate/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_authority_subordinate/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_certificate_authority_subordinate/main.tf" data-region-tag="privateca_create_subordinateca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_certificate_authority_subordinate/main.tf/main/privateca_create_subordinateca" translate="no"><code dir="ltr" translate="no">resource "google_privateca_certificate_authority" "default" {
  // This example assumes this pool already exists.
  // Pools cannot be deleted in normal test circumstances, so we depend on static pools
  pool = "ca-pool"
  certificate_authority_id = "my-certificate-authority"
  location = "us-central1"
  deletion_protection = "true"
  config {
    subject_config {
      subject {
        organization = "HashiCorp"
        common_name = "my-subordinate-authority"
      }
      subject_alt_name {
        dns_names = ["hashicorp.com"]
      }
    }
    x509_config {
      ca_options {
        is_ca = true
        # Force the sub CA to only issue leaf certs
        max_issuer_path_length = 0
      }
      key_usage {
        base_key_usage {
          digital_signature = true
          content_commitment = true
          key_encipherment = false
          data_encipherment = true
          key_agreement = true
          cert_sign = true
          crl_sign = true
          decipher_only = true
        }
        extended_key_usage {
          server_auth = true
          client_auth = false
          email_protection = true
          code_signing = true
          time_stamping = true
        }
      }
    }
  }
  lifetime = "86400s"
  key_spec {
    algorithm = "RSA_PKCS1_4096_SHA256"
  }
  type = "SUBORDINATE"
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Creating a subordinate CA from an external CA" id="subordinate-external">Creating a subordinate CA from an external CA</h2>
<p>Creating a subordinate CA from an external CA is a three-step process. The first step is to create a CSR for this CA and download the CSR. Once you have the CSR, it needs to be signed by your
external CA (specific instructions depend on your setup). Finally, you can use
either the gcloud CLI command-line tool or the Google Cloud console to
upload the signed PEM certificate chain. For more details, see the following example.</p>
<aside class="note"><strong>Note:</strong><span> When creating a subordinate CA that chains up to an external CA, the properties included in the CSR generated by CA Service must be preserved in the CA certificate signed by the external CA. The external CA can add additional extensions as long as it preserves the properties in the CSR. For example, if the CSR contains a path length restriction, the signed subordinate CA certificate must also include the same path length restriction.</span></aside>
<h3 data-text="Step 1: Create a CSR" id="create-csr">Step 1: Create a CSR</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_2">Console</h3><ol>
<li><p>Visit the <strong>Security &gt; Certificate Authority Service</strong> menu in
Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab.</p></li>
<li><p>Click <strong>Create CA</strong>.</p></li>
</ol>
<p><strong>Select CA type</strong>:</p>
<ol>
<li>Click <strong>Subordinate CA</strong>.</li>
<li>In the <strong>Valid for</strong> field, enter the duration for which you want
the certificates issued by the CA certificate to be valid.</li>
<li>Click <strong>Root CA is external</strong>.</li>
<li>Pick one of the available options for the CA <strong>Tier</strong>. For more
information, see <a href="/certificate-authority-service/docs/tiers">Workload-optimized tiers</a>.</li>
<li>Under <strong>Regionalization</strong>, select a <strong>CA location</strong> from the
list.</li>
<li>Click <strong>Next</strong>.</li>
</ol>
<b>Configure CA subject name</b>
<ol>
<li>
    In the <b>Organization (O)</b> field, enter the name of your company.
  </li>
<li>
    Optional: In the <b>Organization unit (OU)</b> field, enter the company
    subdivision or business unit.
  </li>
<li>
    Optional: In the <b>Country name</b> field, enter a two letter country code.
  </li>
<li>
    Optional: In the <b>State or province name</b> field, enter the name of
    your state.
  </li>
<li>
    Optional: In the <b>Locality name</b> field, enter the name of your city.
  </li>
<li>
    In the <b>CA common name (CN)</b> field, enter the CA name.
  </li>
<li>
    In the <b>Pool ID</b> field, enter the CA pool name. You cannot change the
    CA pool after creating the CA.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure CA key size and algorithm</b>
<ol>
<li>
    Choose the key algorithm that best meets your needs. For information
    about deciding the suitable key algorithm, see
    <a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure CA artifacts</b>
<p>
  The following steps are optional. If you skip these steps, the default
  settings apply.
</p>
<ol>
<li>
    Choose whether you want to use a Google-managed or a self-managed
    Cloud Storage bucket.
  </li>
<p>
    If you don't select a self-managed Cloud Storage bucket,
    CA Service creates a Google-managed bucket in the same
    location as the CA.
  </p>
<li>
    Choose whether you want to disable the publication of certificate
    revocation lists (CRLs) and CA certificates to the Cloud Storage
    bucket.
  </li>
<p>
    The publication of CRL and CA certificate on a Cloud Storage bucket
    is enabled by default. To disable these settings, click the toggles.
  </p>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Add labels</b>
<p>
  The following steps are optional.
</p>
<p>
  If you want to add labels to the CA, do the following:
</p>
<ol>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">add</span><b>Add item</b>.
  </li>
<li>
    In the <b>Key 1</b> field, enter the label key.
  </li>
<li>
    In the <b>Value 1</b> field, enter the label value.
  </li>
<li>
    If you want to add another label, click
    <span aria-hidden="true" class="material-icons" translate="no">add</span><b>Add item</b>. Then, add the
    label key and value as mentioned in steps 2 and 3.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Review the settings</b>
<p>
  Carefully review all the settings, then click <b>Create</b> to create the CA.
</p>
<aside class="note"><strong>Note:</strong><span> The CA is created in the <code dir="ltr" translate="no">AWAITING_USER_ACTIVATION</code> state. If you don't
activate the subordinate CA within 30 days of creation,
CA Service deletes the CA.</span></aside>
<p><strong>Download the CSR</strong></p>
<ol>
<li>On the <strong>Certificate authority</strong> page, select the CA you want to activate.</li>
<li>Click <span aria-hidden="true" class="material-icons" translate="no">power_settings_new</span><strong>Activate</strong>.</li>
<li><p>In the dialog that opens, click
<span aria-hidden="true" class="material-icons" translate="no">file_download</span><strong>Download CSR</strong>.</p>
<p><img class="screenshot" data-modal-dialog-id="ca-csr" src="/certificate-authority-service/images/download-ca-csr.png" style="width: 65%"/>
<devsite-lightbox id="ca-csr">
<img alt="Download the CSR of the CA." src="/certificate-authority-service/images/download-ca-csr.png"/>
</devsite-lightbox></p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><ol>
<li><p>To create a CA pool for the subordinate CA, run the following command. For more information, see <a href="/certificate-authority-service/docs/creating-ca-pool">Creating a CA pool</a>.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">SUBORDINATE_POOL_ID</var>
</code></pre>
<p>Replace <var translate="no">SUBORDINATE_POOL_ID</var> with the name of the CA pool.</p></li>
<li><p>To create a subordinate CA in the created CA pool, run the following <code dir="ltr" translate="no">gcloud</code> command. The <code dir="ltr" translate="no">gcloud</code> command also creates a CSR and saves it to <var translate="no">FILE_NAME</var> file.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates create <var translate="no">SUBORDINATE_CA_ID</var> \
  --pool=<var translate="no">SUBORDINATE_POOL_ID</var> \
  --create-csr --csr-output-file=<var translate="no">FILE_NAME</var> \
  --key-algorithm="ec-p256-sha256" \
  --subject="CN=Example Server TLS CA, O=Example LLC"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">SUBORDINATE_CA_ID</var>: The unique identifier of the subordinate CA.</li>
<li><var translate="no">SUBORDINATE_POOL_ID</var>: The name of the CA pool.</li>
<li><var translate="no">FILE_NAME</var>: The name of the file where the PEM-encoded CSR is written.</li>
</ul>
<p><code dir="ltr" translate="no">--key-algorithm</code> flag takes the cryptographic algorithm that you want to use for creating a managed Cloud HSM key for the CA.</p>
<p><code dir="ltr" translate="no">--subject</code> flag takes the X.501 name of the certificate subject.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca subordinates create</code> command, see <a href="/sdk/gcloud/reference/privateca/subordinates/create">gcloud privateca subordinates create</a>.</p></li>
</ol>
<p>The following statement is returned when the CSR is created:</p>
<pre dir="ltr" translate="no">
Created Certificate Authority [projects/my-project-pki/locations/us-west1/caPools/<var translate="no">SUBORDINATE_POOL_ID</var>/certificateAuthorities/<var translate="no">SUBORDINATE_CA_ID</var>] and saved CSR to <var translate="no">FILE_NAME</var>.
</pre>
<p>To see the exhaustive list of available settings, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates create --help
</code></pre>
<p>If you lose the CSR, you can download it again using the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates get-csr <var translate="no">SUBORDINATE_CA_ID</var> \
  --pool=<var translate="no">SUBORDINATE_POOL_ID</var>
</code></pre></section>
</div>
<h3 data-text="Step 2: Sign the CSR" id="sign-csr">Step 2: Sign the CSR</h3>
<p>Pass the generated CSR file from <a href="#create-csr">step 1</a> to the member of your organization
responsible for certificate issuance, and request that they sign it. The specific
steps depend on your organization's setup.</p>
<p>You can experiment with a simple root CA using the
following <code dir="ltr" translate="no">openssl</code> commands:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Shell" id="shell">Shell</h3><p>Configure settings for the new root CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">cat &gt; root.conf &lt;&lt;- EOM
[ req ]
distinguished_name = req_distinguished_name
x509_extensions    = v3_ca
prompt             = no
[ req_distinguished_name ]
commonName = Sample Root
[ v3_ca ]
subjectKeyIdentifier=hash
basicConstraints=critical, CA:true
EOM
</code></pre>
<p>Create the new root CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">openssl req -x509 -new -nodes -config root.conf -keyout rootCA.key \
  -days 3000 -out rootCA.crt -batch
</code></pre>
<p>Configure the extensions that must be added to the new subordinate CA certificate.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">cat &gt; extensions.conf &lt;&lt;- EOM
basicConstraints=critical,CA:TRUE,pathlen:0
keyUsage=critical,keyCertSign,cRLSign
extendedKeyUsage=critical,serverAuth
subjectKeyIdentifier=hash
authorityKeyIdentifier=keyid
EOM
</code></pre>
<p>Sign the subordinate CA's CSR with this root.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">openssl x509 -req -in <var translate="no">FILE_NAME</var> -CA rootCA.crt -CAkey rootCA.key \
  -CAcreateserial -out subordinate.crt -days 1095 -sha256 -extfile extensions.conf
</code></pre>
<p>Concatenate the entire certificate chain into a single file.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">cat subordinate.crt &gt; chain.crt
cat rootCA.crt &gt;&gt; chain.crt
</code></pre></section>
</div><aside class="note"><strong>Note:</strong><span> By default, <a class="external" href="https://www.openssl.org/docs/man1.1.1/man1/x509.html#BUGS">openssl</a> does not include extensions from the CSR in the signed certificate.
<code dir="ltr" translate="no">extensions.conf</code> is required to add extensions to a signed certificate, even though CSRs issued by CA Service include extensions.</span></aside>
<h3 data-text="Step 3: Upload the signed certificate" id="upload-signed-certificate">Step 3: Upload the signed certificate</h3>
<p>To activate a subordinate CA using a signed certificate, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in
the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab.</p></li>
<li><p>Under <strong>Certificate authorities</strong>, choose the CA you created in <a href="#create-csr">Step 1: Create CSR</a>.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">power_settings_new</span><strong>Activate</strong>.</p></li>
<li><p>In the dialog that opens, click <strong>Download CSR</strong> to download the
PEM-encoded CSR file that the issuing CA can sign.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>In the <strong>Upload Certificate Chain</strong> field, click <strong>Browse</strong>.</p></li>
<li><p>Upload the signed certificate file with <code dir="ltr" translate="no">.crt</code> extension.</p></li>
<li><p>Click <strong>Activate</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_4">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates activate <var translate="no">SUBORDINATE_CA_ID</var> \
  --pool=<var translate="no">SUBORDINATE_POOL_ID</var> \
  --pem-chain ./chain.crt
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">SUBORDINATE_CA_ID</var>: the unique identifier of the subordinate CA that you want to activate.</li>
<li><var translate="no">SUBORDINATE_POOL_ID</var>: the name of the CA pool that contains the subordinate CA.</li>
</ul>
<p>The <code dir="ltr" translate="no">--pem-chain</code> flag is required. This flag takes the file containing the list of PEM-encoded certificates. The list of certificates starts with the current CA certificate and ends with the root CA certificate.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca subordinates activate</code> command, see <a href="/sdk/gcloud/reference/privateca/subordinates/activate">gcloud privateca subordinates activate</a>.</p>
<p>The following statement is returned when the signed certificate is uploaded:</p>
<pre dir="ltr" translate="no">
Activated certificate authority [<var translate="no">SUBORDINATE_CA_ID</var>].
</pre></section>
</div><aside class="note"><strong>Note:</strong><span> Subordinate CAs are set to the <code dir="ltr" translate="no">STAGED</code> state after user activation. Once it has been verified that the CA works as expected, it can be enabled to start issuing load-balanced certificates for the CA pool. If you don't enable subordinate CAs within 30 days of creation, the subordinate CAs are deleted. To enable a CA, see <a href="/certificate-authority-service/docs/managing-ca-state#enable">Enabling certificate authorities</a>.<br/>For information about CA states, see <a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</span></aside>
<h2 data-text="Enabling a subordinate CA" id="enable-subordinate-ca">Enabling a subordinate CA</h2>
<p>To enable a subordinate CA, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_4">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in
the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab.</p></li>
<li><p>Under <strong>Certificate authorities</strong>, select the CA you want to activate.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">power_settings_new</span><strong>Activate</strong>.</p></li>
<li><p>In the dialog that opens, click <strong>Download CSR</strong> to download the
PEM-encoded CSR file that the issuing CA can sign.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
<li><p>In the <strong>Upload Certificate Chain</strong> field, click <strong>Browse</strong>.</p></li>
<li><p>Upload the signed certificate file with <code dir="ltr" translate="no">.crt</code> extension.</p></li>
<li><p>Click <strong>Activate</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_5">gcloud</h3><p>To enable a newly created CA, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates enable <var translate="no">SUBORDINATE_CA_ID</var> --pool=<var translate="no">SUBORDINATE_POOL_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">SUBORDINATE_CA_ID</var>: the unique identifier of the subordinate CA.</li>
<li><var translate="no">SUBORDINATE_POOL_ID</var>: the name of the CA pool that contains the subordinate CA.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca subordinates enable</code> command, see <a href="/sdk/gcloud/reference/privateca/subordinates/enable">gcloud privateca subordinates enable</a>.</p></section>
</div><aside class="note"><strong>Note:</strong><span> CA Service doesn't check the revocation status of the root CA
before enabling a subordinate CA that chains up to it. The only exception to
this policy is when you have created the root CA using CA Service.
In this scenario, CA Service checks the revocation status of the
root CA daily. If the root CA is revoked, CA Service updates the
<a href="/monitoring/api/metrics_gcp#gcp-privateca"><code dir="ltr" translate="no">privateca.googleapis.com/ca/cert_revoked</code></a> metric on the
subordinate CA.</span></aside>
<h2 data-text="Cloning certificate authorities" id="cloning">Cloning certificate authorities</h2>
<!--
* {Console}

    0. In the Google Cloud console, go to the Certificate Authority Service page.

        [Go to Certificate Authority Service](https://console.cloud.google.com/security/cas){: target="console" class="button button-primary" track-type="quickstart" track-name="consoleLink"} 
    0.  Under **CAs**, pick your target CA.
    0.  Navigate to **Actions**.
    0.  Click **Create copy**.
    0.  On **Select CA Type**, overwrite existing values as desired.
        0. If you want to copy a CA to another region, change **Location**.
    0.  Click **Next**.
    0.  If the CA is in the same location, change **Resource ID**. Otherwise,
        overwrite existing values as desired.
    0.  Click **Next**.
    0.  For steps 3-5, overwrite existing values as desired, and then click
        **Next**.
    0.  On **Review**, click **Create**.
-->
<p>To clone an existing CA to renew that CA, or to create a new CA with the same
configuration, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots create <var translate="no">NEW_CA_ID</var> --pool=<var translate="no">POOL_ID</var> \
  --from-ca=<var translate="no">EXISTING_CA_ID</var> \
  --key-algorithm "ec-p384-sha384"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">NEW_CA_ID</var>: The unique identifier of the new CA.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool in which you want
to create the new CA.</li>
</ul>
<p>The <code dir="ltr" translate="no">--from-ca</code> flag is supported for root and subordinate CA creation. The
existing CA must be in the same CA pool as the new CA.</p>
<p>The <code dir="ltr" translate="no">--key-algorithm</code> flag copies all CA configuration from the existing CA
(except for the Cloud KMS key version and Cloud Storage bucket). However,
you can still override any of the configuration values in the new CA by
explicitly providing the appropriate flag. For example, you can still
specify `--subject <var translate="no">SUBJECT</var> to use a new subject.</p>
<p>If you omit the <code dir="ltr" translate="no">--key-algorithm</code> flag, the algorithm defaults to:
- <code dir="ltr" translate="no">rsa-pkcs1-4096-sha256</code> for root CAs.
- <code dir="ltr" translate="no">rsa-pkcs1-2048-sha256</code> for subordinate CAs.</p>
<p>For more information about this <code dir="ltr" translate="no">gcloud</code> command, see
<a href="/sdk/gcloud/reference/privateca/roots/create">gcloud privateca roots create</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/managing-ca-state#enable">enable certificate authorities</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/use-issuance-policy">use a certificate issuance policy</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/requesting-certificates">request certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/configuring-iam">configure, modify, and remove IAM policies</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/choosing-key-algorithm]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Choosing a key algorithm" id="choosing-a-key-algorithm">Choosing a key algorithm</h1>
<p>Before creating a certificate authority (CA), you must choose a signing
algorithm for the CA's backing Cloud Key Management Service key. Certificate Authority Service allows
creation of CAs with preexisting Cloud KMS keys using any of the
supported <a href="/kms/docs/algorithms#asymmetric_signing_algorithms">asymmetric signing algorithms</a>,
or by choosing from a
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificateAuthorities#signhashalgorithm">smaller subset</a>
of those algorithms and having the service create and manage the key lifecycle.</p>
<p>This page mentions the factors you must consider when deciding a CA's
signing algorithm.</p>
<h2 data-text="Algorithm families" id="algorithm-families">Algorithm families</h2>
<p>Cloud KMS supports two families of algorithms for asymmetric signing
operations: RSA and ECDSA.</p>
<aside class="note"><strong>Note:</strong><span> CA Service doesn't support Ed25519 algorithms.</span></aside>
<h3 data-text="RSA" id="rsa">RSA</h3>
<p>RSA-based signature schemes enjoy wide compatibility across multiple platforms
by virtue of their age. If you need to support clients using legacy operating
systems, protocols, firmware or other technology stacks, RSA is a common choice.</p>
<p>Cloud KMS exposes two major variants of RSA signature algorithms:
<code dir="ltr" translate="no">RSA_SIGN_PSS</code> and <code dir="ltr" translate="no">RSA_SIGN_PKCS1</code>. The <code dir="ltr" translate="no">PSS</code> variants use the RSASSA-PSS
signature scheme described in
<a class="external" href="https://tools.ietf.org/html/rfc8017#section-8.1">section 8.1</a> 
of RFC 8017, which is newer and considered more verifiably secure. The <code dir="ltr" translate="no">PKCS1</code>
variants use the older PKCS#1 v1.5 signature scheme described in
<a class="external" href="https://tools.ietf.org/html/rfc8017#section-8.2">section 8.2</a> of RFC 8017.</p>
<p>Newer hierarchies are encouraged to use the <code dir="ltr" translate="no">PSS</code> variants if all the applications
that might use those certificates support it. Otherwise, the <code dir="ltr" translate="no">PKCS1</code> variants
are a more suitable choice due to their wider support.</p>
<h3 data-text="ECDSA" id="ecdsa">ECDSA</h3>
<p>While asymmetric keys based on elliptic curves are relatively newer than their
RSA counterparts, they are still supported in many of the most common technology
stacks released over the last decade. They are especially popular because they
can achieve similar levels of security strength to RSA keys using smaller key
sizes. Applications that use ECDSA keys store and transmit less data over the wire.</p>
<p>Cloud KMS exposes two major variants of ECDSA signature algorithms:
<code dir="ltr" translate="no">EC_SIGN_P256</code> and <code dir="ltr" translate="no">EC_SIGN_P384</code>.</p>
<h3 data-text="Mixed chains" id="mixed-chains">Mixed chains</h3>
<p>A mixed (or hybrid) chain is a certificate chain where one or more certificates
use different key algorithm families, such as RSA in some certificates and
ECDSA in others. Some technology stacks have trouble parsing mixed certificate chains,
and might show unexpected errors for those cases. In addition, some industries
can have compliance requirements that require a CA chain to use a single
algorithm family.</p>
<p>It is typical to set up a separate CA chain for ECDSA keys than the ones used
for RSA keys.</p>
<aside class="note"><strong>Note:</strong><span> Unlike algorithm families, using different key sizes within a chain is
a common practice.</span></aside>
<h2 data-text="Key size" id="key-size">Key size</h2>
<p>While larger key sizes (within the same family) provide greater security
strength, they also result in more data being stored and transmitted over the
wire. In addition, encryption and signing operations can sometimes take longer
with larger key sizes, though this is usually too small to notice.</p>
<p>A typical practice is for longer-lasting keys, such as those associated with
root or long-lived subordinate CAs, to use key sizes with greater security
strength than other keys.</p>
<aside class="note"><strong>Note:</strong><span> Regardless of the chosen key size or intended CA lifetime, we recommend
defining a process for key rotation. A CA key may need to be rotated earlier
than expected due to events such as key compromise, or newer advancements in
cryptography that might result in weakened security.</span></aside>
<h2 data-text="Decision-making guide" id="decision-making-guide">Decision-making guide</h2>
<p>You can use this simple guide to help you choose an appropriate signing
algorithm for your CA key:</p>
<ol>
<li><p><strong>Choose an algorithm family</strong></p>
<p>If you are creating a subordinate CA chaining up to an existing root CA, use
the same family as the root.</p>
<p>If you are creating a new root CA but need to work with legacy systems
that don't support ECDSA, use one of the
<a href="/kms/docs/algorithms#rsa_signing_algorithms">RSA signing algorithms</a>.</p>
<p>Otherwise, use one of the
<a href="/kms/docs/algorithms#elliptic_curve_signing_algorithms">Elliptic curve signing algorithms</a>.</p></li>
<li><p>(RSA only) <strong>Choose a signature algorithm</strong></p>
<p>If you expect to work with older libraries or frameworks that don't support
PSS, use one of the <code dir="ltr" translate="no">RSA_SIGN_PKCS1</code> algorithms.</p>
<p>Otherwise, use one of the <code dir="ltr" translate="no">RSA_SIGN_PSS</code> algorithms.</p></li>
<li><p><strong>Choose a key size</strong></p>
<p>For a new root CA or a subordinate CA that is expected to have a lifetime in
the order of years, we recommend that you use the largest key size available
for that algorithm family.</p>
<ul>
<li>For RSA, the largest supported key size is 4096 bits.</li>
<li>For ECDSA, the largest supported key size is 384 bits.</li>
</ul>
<p>For subordinate CAs with a shorter lifetime, it is sufficient to use smaller
key sizes, such as 2048 bits for RSA or 256 bits for ECDSA.</p></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><a href="/kms/docs/algorithms">Cloud KMS: Key purposes and algorithms</a></li>
<li><a href="/kms/docs/digital-signatures">Cloud KMS: Digital signatures</a></li>
<li><a href="/certificate-authority-service/docs/managed-resources">Managed resources</a></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/managing-ca-state]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Managing CA state" id="managing-ca-state">Managing CA state</h1>
<p>This topic explains how you can manage the state of your certificate authority (CA).</p>
<h2 data-text="Enabling a CA" id="enable">Enabling a CA</h2>
<p>All subordinate CAs are created in the <code dir="ltr" translate="no">AWAITING_USER_ACTIVATION</code> state, and they are set to the <code dir="ltr" translate="no">STAGED</code> state after activation. All root CAs are created in the <code dir="ltr" translate="no">STAGED</code> state by default. You must change the CA state to <code dir="ltr" translate="no">ENABLED</code> to include it in a CA pool's certificate issuance rotation. For more information about the operational states of a CA, see <a href="/certificate-authority-service/docs/certificate-authority-states">Certificate authority states</a>.</p>
<p>To enable a CA that is in the <code dir="ltr" translate="no">STAGED</code> or <code dir="ltr" translate="no">DISABLED</code> state, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Under <strong>Certificate authorities</strong>, select your target CA.</p></li>
<li><p>Click <strong>Enable</strong>.</p></li>
<li><p>In the dialog that opens, click <strong>Confirm</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>
To enable a root CA, use the following <code dir="ltr" translate="no">gcloud</code> command.</p>
<aside class="note"><strong>Note:</strong><span> If you want to target a subordinate CA, replace <code dir="ltr" translate="no">roots</code> with
<code dir="ltr" translate="no">subordinates</code> in the following gcloud command.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots enable <var translate="no">CA_ID</var> --pool <var translate="no">POOL_ID</var>
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">CA_ID</var> is the unique identifier of the CA.</li>
<li><var translate="no">POOL_ID</var> is the unique identifier of the CA pool to which the CA belongs.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots enable</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/enable">gcloud privateca roots enable</a>.</p></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_enable_ca-code-sample">
<section>
<h3 data-text="Java" id="privateca_enable_ca-java" track-metadata-position="privateca_enable_ca" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/EnableCertificateAuthority.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/EnableCertificateAuthority.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_enable_ca" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_enable_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/EnableCertificateAuthority.java" data-region-tag="privateca_enable_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/EnableCertificateAuthority.java/HEAD/privateca_enable_ca" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CertificateAuthority.State;
import com.google.cloud.security.privateca.v1.CertificateAuthorityName;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.EnableCertificateAuthorityRequest;
import com.google.longrunning.Operation;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class EnableCertificateAuthority {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: The id of the CA pool under which the CA is present.
    // certificateAuthorityName: The name of the CA to be enabled.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    String certificateAuthorityName = "certificate-authority-name";
    enableCertificateAuthority(project, location, pool_Id, certificateAuthorityName);
  }

  // Enable the Certificate Authority present in the given ca pool.
  // CA cannot be enabled if it has been already deleted.
  public static void enableCertificateAuthority(
      String project, String location, String pool_Id, String certificateAuthorityName)
      throws IOException, ExecutionException, InterruptedException {
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {
      // Create the Certificate Authority Name.
      CertificateAuthorityName certificateAuthorityParent =
          CertificateAuthorityName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .setCertificateAuthority(certificateAuthorityName)
              .build();

      // Create the Enable Certificate Authority Request.
      EnableCertificateAuthorityRequest enableCertificateAuthorityRequest =
          EnableCertificateAuthorityRequest.newBuilder()
              .setName(certificateAuthorityParent.toString())
              .build();

      // Enable the Certificate Authority.
      ApiFuture&lt;Operation&gt; futureCall =
          certificateAuthorityServiceClient
              .enableCertificateAuthorityCallable()
              .futureCall(enableCertificateAuthorityRequest);
      Operation response = futureCall.get();

      if (response.hasError()) {
        System.out.println("Error while enabling Certificate Authority !" + response.getError());
        return;
      }

      // Get the current CA state.
      State caState =
          certificateAuthorityServiceClient
              .getCertificateAuthority(certificateAuthorityParent)
              .getState();

      // Check if the CA is enabled.
      if (caState == State.ENABLED) {
        System.out.println("Enabled Certificate Authority : " + certificateAuthorityName);
      } else {
        System.out.println(
            "Cannot enable the Certificate Authority ! Current CA State: " + caState);
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_enable_ca-python" track-metadata-position="privateca_enable_ca" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/enable_certificate_authority.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/enable_certificate_authority.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_enable_ca" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_enable_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/enable_certificate_authority.py" data-region-tag="privateca_enable_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/enable_certificate_authority.py/HEAD/privateca_enable_ca" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1


def enable_certificate_authority(
    project_id: str, location: str, ca_pool_name: str, ca_name: str
) -&gt; None:
    """
    Enable the Certificate Authority present in the given ca pool.
    CA cannot be enabled if it has been already deleted.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: the name of the CA pool under which the CA is present.
        ca_name: the name of the CA to be enabled.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()
    ca_path = caServiceClient.certificate_authority_path(
        project_id, location, ca_pool_name, ca_name
    )

    # Create the Enable Certificate Authority Request.
    request = privateca_v1.EnableCertificateAuthorityRequest(
        name=ca_path,
    )

    # Enable the Certificate Authority.
    operation = caServiceClient.enable_certificate_authority(request=request)
    result = operation.result()

    print("Operation result:", result)

    # Get the current CA state.
    ca_state = caServiceClient.get_certificate_authority(name=ca_path).state

    # Check if the CA is enabled.
    if ca_state == privateca_v1.CertificateAuthority.State.ENABLED:
        print("Enabled Certificate Authority:", ca_name)
    else:
        print("Cannot enable the Certificate Authority ! Current CA State:", ca_state)

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h2 data-text="Disabling a CA" id="disable">Disabling a CA</h2>
<p>Disabling a CA prevents it from issuing certificates. All certificate requests
to a disabled CA are rejected. Other functionalities, such as revoking
certificates, publishing Certificate Revocation Lists (CRLs), and updating
the CA metadata can still take place.</p>
<aside class="note"><strong>Note:</strong><span> A disabled CA continues to be billed at its usual billing tier. Delete the CA if you want to avoid getting billed for it. For more information about pricing, see <a href="https://cloud.google.com/certificate-authority-service/pricing">Pricing for CA Service</a>. For more information about CA states, see <a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</span></aside>
<p>To disable a CA, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Under <strong>Certificate authorities</strong>, select your target CA.</p></li>
<li><p>Click <strong>Disable</strong>.</p></li>
<li><p>In the dialog that opens, click <strong>Confirm</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>To disable a root CA, use the following command.</p>
<aside class="note"><strong>Note:</strong><span> If you want to target a subordinate CA, replace <code dir="ltr" translate="no">roots</code> with
<code dir="ltr" translate="no">subordinates</code> in the following <code dir="ltr" translate="no">gcloud</code> command.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots disable <var translate="no">CA_ID</var> --pool <var translate="no">POOL_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_ID</var> is the unique identifier of the root CA that you want to disable.</li>
<li><var translate="no">POOL_ID</var> is the unique identifier of the CA pool to which the root CA belongs.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots disable</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/disable">gcloud privateca roots disable</a>.</p></section>
<section><h3 data-text="Code samples" id="code-samples_1">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_disable_ca-code-sample">
<section>
<h3 data-text="Java" id="privateca_disable_ca-java" track-metadata-position="privateca_disable_ca" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/DisableCertificateAuthority.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/DisableCertificateAuthority.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_disable_ca" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_disable_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/DisableCertificateAuthority.java" data-region-tag="privateca_disable_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/DisableCertificateAuthority.java/HEAD/privateca_disable_ca" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CertificateAuthority.State;
import com.google.cloud.security.privateca.v1.CertificateAuthorityName;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.DisableCertificateAuthorityRequest;
import com.google.longrunning.Operation;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class DisableCertificateAuthority {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: The id of the CA pool under which the CA is present.
    // certificateAuthorityName: The name of the CA to be disabled.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    String certificateAuthorityName = "certificate-authority-name";
    disableCertificateAuthority(project, location, pool_Id, certificateAuthorityName);
  }

  // Disable a Certificate Authority which is present in the given CA pool.
  public static void disableCertificateAuthority(
      String project, String location, String pool_Id, String certificateAuthorityName)
      throws IOException, ExecutionException, InterruptedException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      // Create the Certificate Authority Name.
      CertificateAuthorityName certificateAuthorityNameParent =
          CertificateAuthorityName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .setCertificateAuthority(certificateAuthorityName)
              .build();

      // Create the Disable Certificate Authority Request.
      DisableCertificateAuthorityRequest disableCertificateAuthorityRequest =
          DisableCertificateAuthorityRequest.newBuilder()
              .setName(certificateAuthorityNameParent.toString())
              .build();

      // Disable the Certificate Authority.
      ApiFuture&lt;Operation&gt; futureCall =
          certificateAuthorityServiceClient
              .disableCertificateAuthorityCallable()
              .futureCall(disableCertificateAuthorityRequest);
      Operation response = futureCall.get();

      if (response.hasError()) {
        System.out.println("Error while disabling Certificate Authority !" + response.getError());
        return;
      }

      // Get the current CA state.
      State caState =
          certificateAuthorityServiceClient
              .getCertificateAuthority(certificateAuthorityNameParent)
              .getState();

      // Check if the Certificate Authority is disabled.
      if (caState == State.DISABLED) {
        System.out.println("Disabled Certificate Authority : " + certificateAuthorityName);
      } else {
        System.out.println(
            "Cannot disable the Certificate Authority ! Current CA State: " + caState);
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_disable_ca-python" track-metadata-position="privateca_disable_ca" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/disable_certificate_authority.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/disable_certificate_authority.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_disable_ca" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_disable_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/disable_certificate_authority.py" data-region-tag="privateca_disable_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/disable_certificate_authority.py/HEAD/privateca_disable_ca" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1


def disable_certificate_authority(
    project_id: str, location: str, ca_pool_name: str, ca_name: str
) -&gt; None:
    """
    Disable a Certificate Authority which is present in the given CA pool.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: the name of the CA pool under which the CA is present.
        ca_name: the name of the CA to be disabled.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()
    ca_path = caServiceClient.certificate_authority_path(
        project_id, location, ca_pool_name, ca_name
    )

    # Create the Disable Certificate Authority Request.
    request = privateca_v1.DisableCertificateAuthorityRequest(name=ca_path)

    # Disable the Certificate Authority.
    operation = caServiceClient.disable_certificate_authority(request=request)
    result = operation.result()

    print("Operation result:", result)

    # Get the current CA state.
    ca_state = caServiceClient.get_certificate_authority(name=ca_path).state

    # Check if the CA is disabled.
    if ca_state == privateca_v1.CertificateAuthority.State.DISABLED:
        print("Disabled Certificate Authority:", ca_name)
    else:
        print("Cannot disable the Certificate Authority ! Current CA State:", ca_state)

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h2 data-text="Restoring a CA" id="restore">Restoring a CA</h2>
<p>When a CA is scheduled for deletion, there is a 30-day grace
period before it is deleted. During the grace period, a CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) or CA Service
Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) can stop the deletion process. You can restore a CA only during the grace period.</p>
<p>To restore a CA that is
scheduled to be deleted to the disabled state, use the following instructions:</p>
<ol>
<li><p>Confirm that the CA is in the <code dir="ltr" translate="no">DELETED</code> state.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots describe <var translate="no">CA_ID</var> \
  --pool <var translate="no">POOL_ID</var> \
  --format="value(state)"
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">CA_ID</var> is the unique identifier of the CA.</li>
<li><var translate="no">POOL_ID</var> is the unique identifier of the CA pool to which the CA belongs.</li>
<li><code dir="ltr" translate="no">--format</code> flag is used to set the format for printing command output resources.</li>
</ul>
<p>The command returns <code dir="ltr" translate="no">DELETED</code>.</p></li>
<li><p>Restore the CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots undelete <var translate="no">CA_ID</var> --pool <var translate="no">POOL_ID</var>
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">CA_ID</var> is the unique identifier of the CA.</li>
<li><var translate="no">POOL_ID</var> is the unique identifier of the CA pool to which the CA belongs.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots undelete</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/undelete">gcloud privateca roots undelete</a>.</p></li>
<li><p>Confirm the state of the CA is now <code dir="ltr" translate="no">DISABLED</code>.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots describe <var translate="no">CA_ID</var> \
  --pool <var translate="no">POOL_ID</var> \
  --format="value(state)"
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">CA_ID</var> is the unique identifier of the CA.</li>
<li><var translate="no">POOL_ID</var> is the unique identifier of the CA pool to which the CA belongs.</li>
<li><code dir="ltr" translate="no">--format</code> flag is used to set the format for printing command output resources.</li>
</ul>
<p>The command returns <code dir="ltr" translate="no">DISABLED</code>.</p></li>
</ol>
<aside class="note"><strong>Note:</strong><span> The restored CA cannot issue certificates until you enable it.</span></aside>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/deleting-certificate-authorities">delete CAs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/updating-certificate-authorities]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Updating certificate authorities" id="updating-certificate-authorities">Updating certificate authorities</h1>
<p>This topic explains how you can update the configuration for a certificate authority (CA).</p>
<h2 data-text="Update labels on a CA" id="update-labels">Update labels on a CA</h2>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Under <strong>CAs</strong>, pick your target CA.</p></li>
<li><p>In the <strong>Summary</strong> section, click <strong>Edit</strong>.</p></li>
<li><p>Click <strong>Add labels</strong>.</p></li>
<li><p>In the panel on the right side, click <strong>Add Item</strong>.</p></li>
<li><p>Add the <strong>Key</strong> and <strong>Value</strong> for your label.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots update <var translate="no">CA_NAME</var> --pool <var translate="no">POOL_NAME</var> --update-labels foo=bar
</code></pre>
<p>Where:</p>
<ul>
<li><var translate="no">CA_NAME</var> is the unique identifier of the CA.</li>
<li><var translate="no">POOL_NAME</var> is the unique identifier of the CA pool.</li>
<li><code dir="ltr" translate="no">--update-labels</code> flag mentions the key-value pairs to update.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots update</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/update">gcloud privateca roots update</a>.</p></section>
</div>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/managing-ca-state">manage the CA state</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/deleting-certificate-authorities">delete CAs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/listing-certificate-authorities]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Listing certificate authorities" id="listing-certificate-authorities">Listing certificate authorities</h1>
<p>This topic explains how you can list the certificate authorities (CAs) in a
Google Cloud project.</p>
<h2 data-text="Listing root CAs" id="list-root">Listing root CAs</h2>
<p>This section shows how to view the root CAs.</p>
<h3 data-text="List root CAs across CA pools" id="list-root-all-pools">List root CAs across CA pools</h3>
<p>To list all the root CAs across CA pools, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab to go to the <strong>Certificate authorities</strong>
page.</p></li>
<li><p>In the <span aria-hidden="true" class="material-icons" translate="no">filter_list</span> <strong>Filter</strong> field,
select <strong>Type</strong> in the list.</p></li>
<li><p>Set the value of <strong>Type</strong> as <strong>Root</strong>.</p></li>
</ol>
<p>All CAs with <strong>Type</strong> set as <strong>Root</strong> are listed.</p></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots list --location <var label="Location" translate="no">LOCATION</var>
</code></pre>
<p>Replace <var translate="no">LOCATION</var> with the location of the root CAs. For
the complete list of locations, see
<a href="/certificate-authority-service/docs/locations">Locations</a>.</p></section>
</div>
<h3 data-text="List root CAs in a particular CA pool" id="list-root">List root CAs in a particular CA pool</h3>
<p>To list all the root CAs in a particular CA pool, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab to go to the <strong>Certificate authorities</strong>
page.</p></li>
<li><p>In the <span aria-hidden="true" class="material-icons" translate="no">filter_list</span> <strong>Filter</strong> field,
select <strong>Type</strong> in the list.</p></li>
<li><p>Set the value of <strong>Type</strong> as <strong>Root</strong>.</p></li>
<li><p>In the <strong>Filter</strong> field, select <strong>Pool</strong> in the list.</p></li>
<li><p>Click the name of the CA pool in the list.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots list --location <var label="Location" translate="no">LOCATION</var> --pool <var label="Pool ID" translate="no">POOL_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: The location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
</ul>
<p>To list root CAs across all CA pools and locations, omit the <code dir="ltr" translate="no">--pool</code> and
<code dir="ltr" translate="no">--location</code> flags from the command.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots list</code> command, see
<a href="/sdk/gcloud/reference/privateca/roots/list">gcloud privateca roots list</a>.</p></section>
</div>
<h2 data-text="Listing subordinate CAs" id="list-subordinate">Listing subordinate CAs</h2>
<p>This section shows how to view the subordinate CAs.</p>
<h3 data-text="List subordinate CAs across CA pools" id="list-root-all-pools">List subordinate CAs across CA pools</h3>
<p>To list all the subordinate CAs across CA pools, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_2">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab to go to the <strong>Certificate authorities</strong> page.</p></li>
<li><p>In the <span aria-hidden="true" class="material-icons" translate="no">filter_list</span> <strong>Filter</strong> field,
select <strong>Type</strong> in the list.</p></li>
<li><p>Set the value of <strong>Type</strong> as <strong>Subordinate</strong>.</p></li>
</ol>
<p>All CAs with <strong>Type</strong> set as <strong>Subordinate</strong> are listed.</p></section>
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates list --location <var label="Location" translate="no">LOCATION</var>
</code></pre>
<p>Replace <var translate="no">LOCATION</var> with the location of the subordinate CAs.
For the complete list of locations, see
<a href="/certificate-authority-service/docs/locations">Locations</a>.</p></section>
</div>
<h3 data-text="List subordinate CAs in a particular CA pool" id="list-subordinate">List subordinate CAs in a particular CA pool</h3>
<p>To list all the subordinate CAs in a particular CA pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab to go to the <strong>Certificate authorities</strong> page.</p></li>
<li><p>In the <span aria-hidden="true" class="material-icons" translate="no">filter_list</span> <strong>Filter</strong> field,
select <strong>Type</strong> in the list.</p></li>
<li><p>Set the value of <strong>Type</strong> as <strong>Subordinate</strong>.</p></li>
<li><p>In the <span aria-hidden="true" class="material-icons" translate="no">filter_list</span> <strong>Filter</strong> field, select <strong>Pool</strong> in the list.</p></li>
<li><p>Click the name of the CA pool in the list.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca subordinates list --location <var translate="no">LOCATION</var> --pool <var translate="no">POOL_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: The location of the CA pool. For the complete
list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
</ul>
<aside class="note"><strong>Note:</strong><span> You can omit the <code dir="ltr" translate="no">--pool</code> and/or <code dir="ltr" translate="no">--location</code> flags to list subordinate
CAs across all CA pools or locations.</span></aside>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca subordinates list</code> command, see <a href="/sdk/gcloud/reference/privateca/subordinates/list">gcloud privateca subordinates list</a>.</p></section>
</div>
<h2 data-text="Listing all CAs" id="list-all">Listing all CAs</h2>
<p>To list all the CAs in a CA pool, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_4">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab to go to the <strong>Certificate authorities</strong> page.</p></li>
<li><p>In the <span aria-hidden="true" class="material-icons" translate="no">filter_list</span> <strong>Filter</strong> field,
select <strong>Pool</strong> in the list.</p></li>
<li><p>Click the name of the CA pool in the list.</p></li>
</ol>
<p>Alternatively, you can view the CAs in a particular CA pool from the
<strong>CA pool manager</strong> page by doing the following:</p>
<ol>
<li>Click the <strong>CA pool manager</strong> tab.</li>
<li>On the <strong>CA pools</strong> page, click the name of the CA pool whose CAs you
want to view.</li>
</ol>
<p>On the <strong>CA pool</strong> details page, you can see the CAs listed under
<strong>Certificate authorities in pool</strong>. You can filter the CAs based on type,
tier, location, state, and more.</p></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_list_ca-code-sample">
<section>
<h3 data-text="Java" id="privateca_list_ca-java" track-metadata-position="privateca_list_ca" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/ListCertificateAuthorities.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/ListCertificateAuthorities.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_list_ca" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_list_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/ListCertificateAuthorities.java" data-region-tag="privateca_list_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/ListCertificateAuthorities.java/HEAD/privateca_list_ca" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.security.privateca.v1.CaPoolName;
import com.google.cloud.security.privateca.v1.CertificateAuthority;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import java.io.IOException;

public class ListCertificateAuthorities {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: The id of the CA pool under which the CAs to be listed are present.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    listCertificateAuthority(project, location, pool_Id);
  }

  // List all Certificate authorities present in the given CA Pool.
  public static void listCertificateAuthority(String project, String location, String pool_Id)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      // Create CA pool name comprising of project, location and the pool name.
      CaPoolName parent =
          CaPoolName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .build();

      // List the CA name and its corresponding state.
      for (CertificateAuthority certificateAuthority :
          certificateAuthorityServiceClient.listCertificateAuthorities(parent).iterateAll()) {
        System.out.println(
            certificateAuthority.getName() + " is " + certificateAuthority.getState());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_list_ca-python" track-metadata-position="privateca_list_ca" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/list_certificate_authorities.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/list_certificate_authorities.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_list_ca" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_list_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/list_certificate_authorities.py" data-region-tag="privateca_list_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/list_certificate_authorities.py/HEAD/privateca_list_ca" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1


def list_certificate_authorities(
    project_id: str, location: str, ca_pool_name: str
) -&gt; None:
    """
    List all Certificate authorities present in the given CA Pool.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: the name of the CA pool under which the CAs to be listed are present.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    ca_pool_path = caServiceClient.ca_pool_path(project_id, location, ca_pool_name)

    # List the CA name and its corresponding state.
    for ca in caServiceClient.list_certificate_authorities(parent=ca_pool_path):
        print(ca.name, "is", ca.state)

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/creating-certificate-authorities">create CAs</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/deleting-certificate-authorities">delete CAs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/deleting-certificate-authorities]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Deleting certificate authorities" id="deleting-certificate-authorities">Deleting certificate authorities</h1>
<p>Certificate Authority Service lets you delete an existing certificate authority (CA). The CA is permanently deleted after a 30-day grace period from when the deletion process is initiated. After the
grace period, CA Service permanently deletes the CA and all the nested artifacts, such as certificates and certificate revocation lists (CRLs).</p>
<p>Any customer-managed Google Cloud resources that were being used by the deleted CA, such as Cloud Storage buckets or Cloud Key Management Service keys aren't deleted. For more information about Google-managed and customer-managed resources, see <a href="/certificate-authority-service/docs/managed-resources">Managed resources</a>.</p>
<p>A deleted CA isn't billed during the grace period. However, if you
<a href="/certificate-authority-service/docs/managing-ca-state#restore">undelete the CA</a>,
you are charged at the CA's billing tier for the time that the CA existed in
the <code dir="ltr" translate="no">DELETED</code> state.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<ul>
<li><p>Make sure you have the CA Service Operation Manager
(<code dir="ltr" translate="no">roles/privateca.caManager</code>) or the CA Service Admin
(<code dir="ltr" translate="no">roles/privateca.admin</code>) Identity and Access Management (IAM) role. For more
information about the predefined IAM roles for
CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<p>For information about granting an IAM role, see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Granting a single
role</a>.</p></li>
<li><p>Make sure the CA meets the following conditions:</p>
<ul>
<li>The CA must be in the <code dir="ltr" translate="no">AWAITING_USER_ACTIVATION</code>, <code dir="ltr" translate="no">DISABLED</code>, or <code dir="ltr" translate="no">STAGED</code> state. For more information, see <a href="/certificate-authority-service/docs/certificate-authority-states">Certificate authority states</a>.</li>
</ul>
<aside class="caution"><strong>Caution:</strong><span> You <strong>cannot</strong> recover CAs that are deleted in the <code dir="ltr" translate="no">AWAITING_USER_ACTIVATION</code> state. To use the CA again, you must recreate it with a different name.</span></aside>
<ul>
<li>The CA must not contain active certificates. We recommend revoking the
certificates issued by the CA before permanently deleting the CA. The
active certificates cannot be revoked after the CA is permanently deleted.</li>
</ul></li>
</ul>
<h2 data-text="Delete a CA" id="delete">Delete a CA</h2>
<p>To initiate CA deletion, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3>
<ol>
<li>
    Go to the <b>Certificate Authority Service</b> page in the
    Cloud console.
    <p>
<a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service
      </a>
</p>
</li>
<li>
    Click the <b>CA manager</b> tab.
  </li>
<li>
    In the list of CAs, select the CA you want to delete.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">cancel</span><b>Disable</b>.
  </li>
<img class="screenshot" data-modal-dialog-id="disable" src="/certificate-authority-service/images/disable-ca.png" style="width: 85%"/>
<devsite-lightbox id="disable">
<img alt="Disable the CA you want to delete." src="/certificate-authority-service/images/disable-ca.png"/>
</devsite-lightbox>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
<li>
    Click <span aria-hidden="true" class="material-icons" translate="no">delete</span><b>Delete</b>.
  </li>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><ol>
<li><p>Check the CA state to ensure it is disabled. You can only delete the CAs
that are in the <code dir="ltr" translate="no">DISABLED</code> state.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots describe <var translate="no">CA_ID</var> --pool=<var translate="no">POOL_ID</var> \
  --format="value(state)"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_ID</var>: The unique identifier of the CA.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool that contains the CA.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots describe</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/describe">gcloud privateca roots describe</a>.</p></li>
<li><p>If the CA isn't disabled, run the following command to disable
the CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots disable <var translate="no">CA_ID</var> --pool=<var translate="no">POOL_ID</var>
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots disable</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/disable">gcloud privateca roots disable</a>.</p></li>
<li><p>Delete the CA.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots delete <var translate="no">CA_ID</var> --pool=<var translate="no">POOL_ID</var>
</code></pre>
<p>You can delete the CA even if the CA has active certificates by
including the <code dir="ltr" translate="no">--ignore-active-certificates</code> flag in your <code dir="ltr" translate="no">gcloud</code>
command.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca roots delete</code> command, see <a href="/sdk/gcloud/reference/privateca/roots/delete">gcloud privateca roots delete</a>.</p></li>
<li><p>When you are prompted, confirm that you want to delete the CA.</p>
<p>After confirming, the CA is scheduled for deletion and the 30-day grace period begins. The command outputs the expected date and time when the CA will be deleted.</p>
<pre dir="ltr" translate="no">
Deleted Root CA [projects/<var translate="no">PROJECT_ID</var>/locations/us-west1/caPools/<var label="Pool Name" translate="no">POOL_ID</var>/certificateAuthorities/<var label="CA name" translate="no">CA_ID</var>] can be undeleted until 2020-08-14T19:28:39Z.
</pre></li>
</ol></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_delete_ca-code-sample">
<section>
<h3 data-text="Java" id="privateca_delete_ca-java" track-metadata-position="privateca_delete_ca" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/DeleteCertificateAuthority.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/DeleteCertificateAuthority.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_delete_ca" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_delete_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/DeleteCertificateAuthority.java" data-region-tag="privateca_delete_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/DeleteCertificateAuthority.java/HEAD/privateca_delete_ca" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CertificateAuthority.State;
import com.google.cloud.security.privateca.v1.CertificateAuthorityName;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.DeleteCertificateAuthorityRequest;
import com.google.longrunning.Operation;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class DeleteCertificateAuthority {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: The id of the CA pool under which the CA is present.
    // certificateAuthorityName: The name of the CA to be deleted.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    String certificateAuthorityName = "certificate-authority-name";
    deleteCertificateAuthority(project, location, pool_Id, certificateAuthorityName);
  }

  // Delete the Certificate Authority from the specified CA pool.
  // Before deletion, the CA must be disabled and must not contain any active certificates.
  public static void deleteCertificateAuthority(
      String project, String location, String pool_Id, String certificateAuthorityName)
      throws IOException, ExecutionException, InterruptedException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {
      // Create the Certificate Authority Name.
      CertificateAuthorityName certificateAuthorityNameParent =
          CertificateAuthorityName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .setCertificateAuthority(certificateAuthorityName)
              .build();

      // Check if the CA is enabled.
      State caState =
          certificateAuthorityServiceClient
              .getCertificateAuthority(certificateAuthorityNameParent)
              .getState();
      if (caState == State.ENABLED) {
        System.out.println(
            "Please disable the Certificate Authority before deletion ! Current state: " + caState);
        return;
      }

      // Create the DeleteCertificateAuthorityRequest.
      // Setting the setIgnoreActiveCertificates() to true, will delete the CA
      // even if it contains active certificates. Care should be taken to re-anchor
      // the certificates to new CA before deleting.
      DeleteCertificateAuthorityRequest deleteCertificateAuthorityRequest =
          DeleteCertificateAuthorityRequest.newBuilder()
              .setName(certificateAuthorityNameParent.toString())
              .setIgnoreActiveCertificates(false)
              .build();

      // Delete the Certificate Authority.
      ApiFuture&lt;Operation&gt; futureCall =
          certificateAuthorityServiceClient
              .deleteCertificateAuthorityCallable()
              .futureCall(deleteCertificateAuthorityRequest);
      Operation response = futureCall.get();

      if (response.hasError()) {
        System.out.println("Error while deleting Certificate Authority !" + response.getError());
        return;
      }

      // Check if the CA has been deleted.
      caState =
          certificateAuthorityServiceClient
              .getCertificateAuthority(certificateAuthorityNameParent)
              .getState();
      if (caState == State.DELETED) {
        System.out.println(
            "Successfully deleted Certificate Authority : " + certificateAuthorityName);
      } else {
        System.out.println(
            "Unable to delete Certificate Authority. Please try again ! Current state: " + caState);
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_delete_ca-python" track-metadata-position="privateca_delete_ca" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/delete_certificate_authority.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/delete_certificate_authority.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_delete_ca" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_delete_ca" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/delete_certificate_authority.py" data-region-tag="privateca_delete_ca" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/delete_certificate_authority.py/HEAD/privateca_delete_ca" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1


def delete_certificate_authority(
    project_id: str, location: str, ca_pool_name: str, ca_name: str
) -&gt; None:
    """
    Delete the Certificate Authority from the specified CA pool.
    Before deletion, the CA must be disabled and must not contain any active certificates.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: the name of the CA pool under which the CA is present.
        ca_name: the name of the CA to be deleted.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()
    ca_path = caServiceClient.certificate_authority_path(
        project_id, location, ca_pool_name, ca_name
    )

    # Check if the CA is enabled.
    ca_state = caServiceClient.get_certificate_authority(name=ca_path).state
    print(ca_state)
    if ca_state == privateca_v1.CertificateAuthority.State.ENABLED:
        print(
            "Please disable the Certificate Authority before deletion ! Current state:",
            ca_state,
        )

    # Create the DeleteCertificateAuthorityRequest.
    # Setting the ignore_active_certificates to True will delete the CA
    # even if it contains active certificates. Care should be taken to re-anchor
    # the certificates to new CA before deleting.
    request = privateca_v1.DeleteCertificateAuthorityRequest(
        name=ca_path, ignore_active_certificates=False
    )

    # Delete the Certificate Authority.
    operation = caServiceClient.delete_certificate_authority(request=request)
    result = operation.result()

    print("Operation result", result)

    # Get the current CA state.
    ca_state = caServiceClient.get_certificate_authority(name=ca_path).state

    # Check if the CA has been deleted.
    if ca_state == privateca_v1.CertificateAuthority.State.DELETED:
        print("Successfully deleted Certificate Authority:", ca_name)
    else:
        print(
            "Unable to delete Certificate Authority. Please try again ! Current state:",
            ca_state,
        )

</code></pre>
</div>
</section>
</div></p></section>
</div><aside class="note"><strong>Note:</strong><span> You cannot use the name of the deleted CA for another CA. Even if you
didn't activate the CA and CA Service deleted the CA after the
30-day grace period ended, you can't use the name of the deleted CA for a new
CA.</span></aside>
<h2 data-text="Check the expiration date of a deleted CA" id="check-expiration">Check the expiration date of a deleted CA</h2>
<p>To see when a CA will be permanently deleted, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li>Click the <strong>CA pool manager</strong> tab.</li>
<li>Click the name of the CA pool that contained the CA you deleted.</li>
</ol>
<p>You can see the expiration date of the CA in the table on the <strong>CA pool</strong>
page.</p>
<p><img class="screenshot" data-modal-dialog-id="ca-expiry" src="/certificate-authority-service/images/view-ca-expiration.png" style="width: 75%"/>
<devsite-lightbox id="ca-expiry">
<img alt="See the expiration date of a deleted CA." src="/certificate-authority-service/images/view-ca-expiration.png"/>
</devsite-lightbox></p></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>To check the expected deletion time for a CA, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots describe <var translate="no">CA_ID</var> \
  --pool=<var translate="no">POOL_ID</var> \
  --format="value(expireTime.date())"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_ID</var>: The name of the CA.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool that contained the CA.</li>
</ul>
<p>The command returns the expected date and time when CA Service
deletes the CA.</p>
<pre dir="ltr" translate="no">
2020-08-14T19:28:39
</pre>
<p>To verify that the CA has been permanently deleted, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots describe <var translate="no">CA_ID</var> --pool=<var translate="no">POOL_ID</var>
</code></pre>
<p>If the CA is successfully deleted, the command returns the following error.</p>
<pre dir="ltr" translate="no">
ERROR: (gcloud.privateca.roots.describe) NOT_FOUND: Resource 'projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var label="Pool Name" translate="no">POOL_ID</var>/certificateAuthorities/<var translate="no">CA_ID</var>' was not found
</pre></section>
</div>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/managing-ca-state#restore">restore CAs</a>.</li>
<li>Learn about <a href="/certificate-authority-service/docs/certificate-authority-states">CA states</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/requesting-certificates]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Requesting certificates" id="requesting-certificates">Requesting certificates</h1>
<p>This topic describes how you can request a certificate from Certificate Authority Service
and view the issued certificates.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Make sure you have the CA Service Certificate Requester
(<code dir="ltr" translate="no">roles/privateca.certificateRequester</code>) or the CA Service
Certificate Manager (<code dir="ltr" translate="no">roles/privateca.certificateManager</code>) IAM
role.  For more information about the predefined IAM roles for
CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<p>For information about granting an IAM role to a principal,
see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single role</a>.</p>
<h2 data-text="Overview" id="overview">Overview</h2>
<p>You can request a certificate using the following methods:</p>
<ol>
<li>Generate your own private/public key and submit a Certificate Signing
Request (CSR).</li>
<li>Have CA Service create a private/public key for you.</li>
<li>Use an existing Cloud Key Management Service (Cloud KMS) key.</li>
</ol>
<h2 data-text="Using a CSR" id="use-csr">Using a CSR</h2>
<p>Before you proceed, you must generate a CSR. After generating a CSR, do the
following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page on the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA Manager</strong> tab.</p></li>
<li><p>Click the name of the CA you want to issue from.</p></li>
<li><p>On the bottom of the CA details page, click <strong>Request a certificate</strong>.</p></li>
<li><p>Optional: If you want to use a <a href="/certificate-authority-service/docs/certificate-template">certificate
template</a>, click
<span aria-hidden="true" class="material-icons" translate="no">create</span>, select a template from
the list, and click <strong>Save</strong>.</p></li>
<li><p>Click <strong>Provide CSR</strong>.</p></li>
<li><p>Optional: To overwrite the automatically generated certificate
name, enter the custom name in the <strong>Certificate name</strong> field.</p></li>
<li><p>Optional: To choose a custom validity period for the certificate, enter
the value in the <strong>Valid for</strong> field.</p></li>
<li><p>Copy and paste your CSR to the <strong>Certificate CSR</strong> box. To upload the
CSR, click <strong>Browse</strong>.</p></li>
<li><p>Click <strong>Next</strong>.</p></li>
</ol>
<p><strong>Download the signed certificate</strong></p>
<ol>
<li>To copy the certificate, click <span aria-hidden="true" class="material-icons" translate="no">content_copy</span>.
To download the certificate in the form of a <code dir="ltr" translate="no">.crt</code> file, click
<span aria-hidden="true" class="material-icons" translate="no">file_download</span><strong>Download certificate</strong>.</li>
<li>Optional: To download the certificate chain, click
<span aria-hidden="true" class="material-icons" translate="no">file_download</span><strong>Download certificate chain</strong>.</li>
<li>Click <strong>Done</strong>.</li>
</ol>
<aside class="special"><strong>Important:</strong><span> If you are using a DevOps CA pool, this is the only time you can
download the created certificates. CA Service doesn't store the
contents of the certificate after you move from this screen.</span></aside></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create <var translate="no">CERT_ID</var> \
     --issuer-pool <var translate="no">POOL_ID</var> \
     --csr <var translate="no">CSR_FILENAME</var> \
     --cert-output-file <var translate="no">CERT_FILENAME</var> \
     --validity "P30D"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CERT_ID</var>: The unique identifier of the certificate.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
<li><var translate="no">CSR_FILENAME</var>: The file that stores the PEM-encoded CSR.</li>
</ul>
<p>The <code dir="ltr" translate="no">--validity</code> flag defines the duration the certificate is valid. It is an optional flag whose default value is 30 days.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates create</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/create">gcloud privateca certificates create</a>.</p>
<aside class="note"><strong>Note:</strong><span> You can omit the certificate ID to have one automatically
generated for you with the following naming format:
<code dir="ltr" translate="no">{YYYYMMDD}-{3 alphanumeric characters}-{3 alphanumeric characters}</code></span></aside></section>
<section><h3 data-text="REST API" id="rest-api">REST API</h3><ol>
<li><p>Generate a Certificate Signing Request (CSR) using your preferred method,
such as <code dir="ltr" translate="no">openssl</code>.</p>
<p>The following is a sample CSR that is encoded for JSON.</p>
<aside class="caution"><strong>Caution:</strong><span> The following CSR contains sample values. Do not use this CSR for
production.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">-----BEGIN CERTIFICATE REQUEST-----\nMIIChTCCAW0CAQAwQDELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAkNBMQ8wDQYDVQQK\nDAZKb29uaXgxEzARBgNVBAMMCmpvb25peC5uZXQwggEiMA0GCSqGSIb3DQEBAQUA\nA4IBDwAwggEKAoIBAQCnyy+5vcRQUBPqAse3ojmWjyUvhcJK6eLRXpp0teEUF5kg\nHb2ov8gYXb9sSim5fnvs09dGYDKibSrL4Siy7lA/NzMzWtKwyQQeLIQq/cLUJVcd\ndItJ0VRcqr+UPkTCii2vrdcocNDChHM1J8chDdl6DkpYieSTqZwlPcWlQBGAINmT\nT3Q0ZarIVM5l74j13WPuToGrhbVOIZXWxWqJjlHbBA8B/VKtSRCzM1qG60y8Pu2f\n6c78Dfg8+CGRzGwnz8aFS0Yf9czT9luNHSadS/RHjvE9FPZCsinz+6mJlXRcphi1\nKaHsDbstUAhse1h5E9Biyr9SFYRHxY7qRv9aSJ/dAgMBAAGgADANBgkqhkiG9w0B\nAQsFAAOCAQEAZz+I9ff1Rf3lTewXRUpA7nr5HVO1ojCR93Pf27tI/hvNH7z7GwnS\noScoJlClxeRqABOCnfmVoRChullb/KmER4BZ/lF0GQpEtbqbjgjkEDpVlBKCb0+L\nHE9psplIz6H9nfFS3Ouoiodk902vrMEh0LyDYNQuqFoyCZuuepUlK3NmtmkexlgT\n0pJg/5FV0iaQ+GiFXSZhTC3drfiM/wDnXGiqpbW9WmebSij5O+3BNYXKBUgqmT3r\nbryFydNq4qSOIbnN/MNb4UoKno3ve7mnGk9lIDf9UMPvhl+bT7C3OLQLGadJroME\npYnKLoZUvRwEdtZpbNL9QhCAm2QiJ6w+6g==\n-----END CERTIFICATE REQUEST-----
</code></pre></li>
<li><p>Request a certificate.</p>
<p>
<p>
  HTTP method and URL:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="HTTP method and URL" dir="ltr" suppresswarning="" translate="no">POST https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificates?certificate_id=<var translate="no">CERTIFICATE_ID</var></pre>
</section>
<p>
  Request JSON body:
</p>
<section>
<pre class="devsite-click-to-copy" data-label="request body" dir="ltr" suppresswarning="" translate="no">
{
 "lifetime": {
   "seconds": 3600,
   "nanos": 0
 },
 "pem_csr": "<var translate="no">PEM_CSR</var>"
}
</pre>
</section>
<p>To send your request, expand one of these options:</p>
<section class="expandable">
<h4 class="showalways" data-text="curl (Linux, macOS, or Cloud Shell)" id="curl-linux,-macos,-or-cloud-shell">curl (Linux, macOS, or Cloud Shell)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Save the request body in a file called <code dir="ltr" translate="no">request.json</code>,
    and execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label=" CURL command" dir="ltr" suppresswarning="" translate="no">curl -X POST \<br/>-H "Authorization: Bearer "$(gcloud auth print-access-token) \<br/>-H "Content-Type: application/json; charset=utf-8" \<br/>-d @request.json \<br/>"https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificates?certificate_id=<var translate="no">CERTIFICATE_ID</var>"</pre></section>
</section>
<section class="expandable">
<h4 class="showalways" data-text="PowerShell (Windows)" id="powershell-windows">PowerShell (Windows)</h4>
<aside class="note"><b>Note:</b>
      The following command assumes that you have used either
      <a href="/sdk/gcloud/reference/init"><code dir="ltr" translate="no">gcloud init</code></a>
      or
      <a href="/sdk/gcloud/reference/auth/login"><code dir="ltr" translate="no">gcloud auth login</code></a>
      to authenticate <code dir="ltr" translate="no">gcloud</code> with your user account.
      You can check the currently active account by executing
      <a href="/sdk/gcloud/reference/auth/list"><code dir="ltr" translate="no">gcloud auth list</code></a>.
    </aside>
<p>
    Save the request body in a file called <code dir="ltr" translate="no">request.json</code>,
    and execute the following command:
  </p>
<section><pre class="devsite-click-to-copy" data-label="PowerShell command" dir="ltr" suppresswarning="" translate="no">$cred = gcloud auth print-access-token<br/>$headers = @{ "Authorization" = "Bearer $cred" }<br/><br/>Invoke-WebRequest `<br/>  -Method POST `<br/>  -Headers $headers `<br/>  -ContentType: "application/json; charset=utf-8" `<br/>  -InFile request.json `<br/>  -Uri "https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">POOL_ID</var>/certificates?certificate_id=<var translate="no">CERTIFICATE_ID</var>" | Select-Object -Expand Content</pre></section>
</section>
<p>You should receive a JSON response similar to the following:</p>
<section>
<pre class="devsite-click-to-copy readonly" data-label="sample response" dir="ltr" suppresswarning="" translate="no">
{
 "name": "projects/project-id/locations/location/certificateAuthorities/ca-id/certificates/certificate-id",
 "pemCertificate": "-----BEGIN CERTIFICATE-----...",
 "certificateDescription": {...}
}
</pre>
</section>
</p>
<aside class="caution"><strong>Caution:</strong><span> We recommend that you don't issue end-entity certificates from a root
CA. For information about creating subordinate CAs, see
<a href="/certificate-authority-service/docs/creating-certificate-authorities">Creating CAs</a>.</span></aside></li>
</ol></section>
<section><h3 data-text="Terraform" id="terraform">Terraform</h3>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_csr/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_csr/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_certificate_csr/main.tf" data-region-tag="privateca_create_certificate_csr" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_certificate_csr/main.tf/main/privateca_create_certificate_csr" translate="no"><code dir="ltr" translate="no">resource "google_privateca_certificate_authority" "test-ca" {
  pool = ""
  certificate_authority_id = "my-certificate-authority"
  location = "us-central1"
  deletion_protection = false
  config {
    subject_config {
      subject {
        organization = "HashiCorp"
        common_name = "my-certificate-authority"
      }
      subject_alt_name {
        dns_names = ["hashicorp.com"]
      }
    }
    x509_config {
      ca_options {
        # is_ca *MUST* be true for certificate authorities
        is_ca = true
      }
      key_usage {
        base_key_usage {
          # cert_sign and crl_sign *MUST* be true for certificate authorities
          cert_sign = true
          crl_sign = true
        }
        extended_key_usage {
          server_auth = false
        }
      }
    }
  }
  key_spec {
    algorithm = "RSA_PKCS1_4096_SHA256"
  }
}


resource "google_privateca_certificate" "default" {
  pool = ""
  location = "us-central1"
  certificate_authority = google_privateca_certificate_authority.test-ca.certificate_authority_id
  lifetime = "860s"
  name = "my-certificate"
  pem_csr = file("test-fixtures/rsa_csr.pem")
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Using an auto-generated key" id="auto-generated-key">Using an auto-generated key</h2>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><p>You can use Google Cloud console to generate client or server TLS certificates.</p>
<ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA Manager</strong> tab.</p></li>
<li><p>Click the name of the CA you want to issue from.</p></li>
<li><p>At the bottom of the <strong>Certificate authority</strong> details page, click
<strong>Request a certificate</strong>.</p></li>
<li><p>Optional: If you want to use a <a href="/certificate-authority-service/docs/certificate-template">certificate
template</a>, click
<span aria-hidden="true" class="material-icons" translate="no">create</span>, select a template from
the list, and click <strong>Save</strong>.</p></li>
<li><p>Click <strong>Enter details</strong>.</p></li>
<li><p>Optional: Replace the auto-generated <strong>Certificate name</strong> with a custom
name that is unique.</p></li>
<li><p>Optional: To choose a custom validity period for the certificate, enter
the value in the <strong>Valid for</strong> field.</p></li>
</ol>
<p><strong>Add domain name</strong></p>
<ol>
<li>Under <strong>Add domain name</strong>, enter a domain name in the <strong>Domain name 1</strong>
field.</li>
<li>Optional: If you want to add more than one domain name, click <strong>Add
Item</strong>, and enter another domain name in the <strong>Domain name 2</strong> field.</li>
</ol>
<p><strong>Extended key usage</strong></p>
<ol>
<li><p>Optional: Under <strong>Extended key usage</strong>, select between the following
options based on your use case:</p>
<ul>
<li><strong>Server TLS</strong>: These certificates let you authenticate the identity
of a server.</li>
<li><strong>Client TLS</strong>: These certificates let you authenticate the identity of
a requester.</li>
</ul></li>
<li><p>Click <strong>Next</strong>.</p></li>
</ol>
<p><strong>Configure the key size and algorithm</strong></p>
<ol>
<li>Optional: Under <strong>Configure key size and algorithm</strong>, select the signing
key size and algorithm from the list. If you skip this step,
RSASSA-PSS 2048 bit key with a SHA 256 digest is used. For information
about selecting a signing key and algorithm, see <a href="/certificate-authority-service/docs/choosing-key-algorithm">Choosing a key algorithm</a>.</li>
<li>Click <strong>Continue</strong>.</li>
</ol>
<p><strong>Download the signed certificate</strong></p>
<ol>
<li>Optional: To download the PEM-encoded certificate chain, click
<strong>Download certificate chain</strong>.</li>
<li><p>Optional: To download the associated PEM-encoded private key, click
<strong>Download private key</strong>.</p>
<aside class="special"><strong>Important:</strong><span> You cannot retrieve this key after leaving this page. This
key is sensitive. We recommend protecting the key in a secure location.</span></aside></li>
<li><p>Click <strong>Done</strong>.</p>
<aside class="special"><strong>Important:</strong><span> If you are using a DevOps CA pool, this is the only time you can
download the created certificate. CA Service doesn't store the
contents of the certificate past this screen.</span></aside></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>To use the auto-generated key functionality, you need to install the <a class="external" href="https://cryptography.io/en/latest/">Python
Cryptographic Authority (PyCA)</a> library. For instructions about installing the Pyca cryptography library, see <a href="/kms/docs/crypto">Including the Pyca cryptography library</a>.</p>
<p>To create a certificate, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create \
  --issuer-pool <var translate="no">POOL_ID</var> \
  --generate-key \
  --key-output-file <var translate="no">KEY_FILENAME</var> \
  --cert-output-file <var translate="no">CERT_FILENAME</var> \
  --dns-san "<var translate="no">DNS_NAME</var>" \
  --use-preset-profile "<var translate="no">CERTIFICATE_PROFILE</var>"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
<li><var translate="no">KEY_FILENAME</var>: The path where the generated
private key file must be written.</li>
<li><var translate="no">CERT_FILENAME</var>: The path where the PEM-encoded
certificate chain file must be written. The certificate chain is
ordered from end-entity to root.</li>
<li><var translate="no">DNS_NAME</var>: One or more comma-separated DNS subject alternative names (SANs).</li>
<li><var translate="no">CERTIFICATE_PROFILE</var>: The unique identifier of
the <a href="/certificate-authority-service/docs/certificate-profile">certificate profile</a>.
For example, use <code dir="ltr" translate="no">leaf_server_tls</code> for end-entity server TLS.</li>
</ul>
<p>The <code dir="ltr" translate="no">gcloud</code> command mentions the following flags:</p>
<ul>
<li><a href="/sdk/gcloud/reference/privateca/certificates/create#--generate-key"><code dir="ltr" translate="no">--generate-key</code></a>: Generates a new RSA-2048 private key on your machine.</li>
</ul>
<p>You can also use any combination of the following flags:</p>
<ul>
<li><a href="/sdk/gcloud/reference/privateca/certificates/create#--dns-san"><code dir="ltr" translate="no">--dns-san</code></a>: Lets you pass one or more comma-separated DNS SANs.</li>
<li><a href="/sdk/gcloud/reference/privateca/certificates/create#--ip-san"><code dir="ltr" translate="no">--ip-san</code></a>: Lets you pass one or more comma-separated IP SANs.</li>
<li><a href="/sdk/gcloud/reference/privateca/certificates/create#--uri-san"><code dir="ltr" translate="no">--uri-san</code></a>: Lets you pass one or more comma-separated URI SANs.</li>
<li><a href="/sdk/gcloud/reference/privateca/certificates/create#--subject"><code dir="ltr" translate="no">--subject</code></a>: Lets you pass an X.501 name of the certificate
subject.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates create</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/create">gcloud privateca certificates create</a>.</p></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_create_certificate-code-sample">
<section>
<h3 data-text="Java" id="privateca_create_certificate-java" track-metadata-position="privateca_create_certificate" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificate.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificate.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_certificate" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_create_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificate.java" data-region-tag="privateca_create_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/CreateCertificate.java/HEAD/privateca_create_certificate" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.CaPoolName;
import com.google.cloud.security.privateca.v1.Certificate;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.CertificateConfig;
import com.google.cloud.security.privateca.v1.CertificateConfig.SubjectConfig;
import com.google.cloud.security.privateca.v1.CreateCertificateRequest;
import com.google.cloud.security.privateca.v1.KeyUsage;
import com.google.cloud.security.privateca.v1.KeyUsage.ExtendedKeyUsageOptions;
import com.google.cloud.security.privateca.v1.KeyUsage.KeyUsageOptions;
import com.google.cloud.security.privateca.v1.PublicKey;
import com.google.cloud.security.privateca.v1.PublicKey.KeyFormat;
import com.google.cloud.security.privateca.v1.Subject;
import com.google.cloud.security.privateca.v1.SubjectAltNames;
import com.google.cloud.security.privateca.v1.X509Parameters;
import com.google.cloud.security.privateca.v1.X509Parameters.CaOptions;
import com.google.protobuf.ByteString;
import com.google.protobuf.Duration;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class CreateCertificate {

  public static void main(String[] args)
      throws InterruptedException, ExecutionException, IOException {
    // TODO(developer): Replace these variables before running the sample.

    // publicKeyBytes: Public key used in signing the certificates.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: Set a unique id for the CA pool.
    // certificateAuthorityName: The name of the certificate authority which issues the certificate.
    // certificateName: Set a unique name for the certificate.
    String project = "your-project-id";
    ByteString publicKeyBytes = ByteString.copyFrom(new byte[] {});
    String location = "ca-location";
    String pool_Id = "ca-pool_Id";
    String certificateAuthorityName = "certificate-authority-name";
    String certificateName = "certificate-name";

    createCertificate(
        project, location, pool_Id, certificateAuthorityName, certificateName, publicKeyBytes);
  }

  // Create a Certificate which is issued by the Certificate Authority present in the CA Pool.
  // The public key used to sign the certificate can be generated using any crypto
  // library/framework.
  public static void createCertificate(
      String project,
      String location,
      String pool_Id,
      String certificateAuthorityName,
      String certificateName,
      ByteString publicKeyBytes)
      throws InterruptedException, ExecutionException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      // commonName: Enter a title for your certificate.
      // orgName: Provide the name of your company.
      // domainName: List the fully qualified domain name.
      // certificateLifetime: The validity of the certificate in seconds.
      String commonName = "common-name";
      String orgName = "org-name";
      String domainName = "dns.your-domain.com";
      long certificateLifetime = 1000L;

      // Set the Public Key and its format.
      PublicKey publicKey =
          PublicKey.newBuilder().setKey(publicKeyBytes).setFormat(KeyFormat.PEM).build();

      SubjectConfig subjectConfig =
          SubjectConfig.newBuilder()
              // Set the common name and org name.
              .setSubject(
                  Subject.newBuilder().setCommonName(commonName).setOrganization(orgName).build())
              // Set the fully qualified domain name.
              .setSubjectAltName(SubjectAltNames.newBuilder().addDnsNames(domainName).build())
              .build();

      // Set the X.509 fields required for the certificate.
      X509Parameters x509Parameters =
          X509Parameters.newBuilder()
              .setKeyUsage(
                  KeyUsage.newBuilder()
                      .setBaseKeyUsage(
                          KeyUsageOptions.newBuilder()
                              .setDigitalSignature(true)
                              .setKeyEncipherment(true)
                              .setCertSign(true)
                              .build())
                      .setExtendedKeyUsage(
                          ExtendedKeyUsageOptions.newBuilder().setServerAuth(true).build())
                      .build())
              .setCaOptions(CaOptions.newBuilder().setIsCa(true).buildPartial())
              .build();

      // Create certificate.
      Certificate certificate =
          Certificate.newBuilder()
              .setConfig(
                  CertificateConfig.newBuilder()
                      .setPublicKey(publicKey)
                      .setSubjectConfig(subjectConfig)
                      .setX509Config(x509Parameters)
                      .build())
              .setLifetime(Duration.newBuilder().setSeconds(certificateLifetime).build())
              .build();

      // Create the Certificate Request.
      CreateCertificateRequest certificateRequest =
          CreateCertificateRequest.newBuilder()
              .setParent(CaPoolName.of(project, location, pool_Id).toString())
              .setCertificateId(certificateName)
              .setCertificate(certificate)
              .setIssuingCertificateAuthorityId(certificateAuthorityName)
              .build();

      // Get the Certificate response.
      ApiFuture&lt;Certificate&gt; future =
          certificateAuthorityServiceClient
              .createCertificateCallable()
              .futureCall(certificateRequest);

      Certificate response = future.get();
      // Get the PEM encoded, signed X.509 certificate.
      System.out.println(response.getPemCertificate());
      // To verify the obtained certificate, use this intermediate chain list.
      System.out.println(response.getPemCertificateChainList());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_create_certificate-python" track-metadata-position="privateca_create_certificate" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_certificate.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_certificate.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_certificate" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_create_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/create_certificate.py" data-region-tag="privateca_create_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/create_certificate.py/HEAD/privateca_create_certificate" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1
from google.protobuf import duration_pb2


def create_certificate(
    project_id: str,
    location: str,
    ca_pool_name: str,
    ca_name: str,
    certificate_name: str,
    common_name: str,
    domain_name: str,
    certificate_lifetime: int,
    public_key_bytes: bytes,
) -&gt; None:
    """
    Create a Certificate which is issued by the Certificate Authority present in the CA Pool.
    The key used to sign the certificate is created by the Cloud KMS.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: set a unique name for the CA pool.
        ca_name: the name of the certificate authority which issues the certificate.
        certificate_name: set a unique name for the certificate.
        common_name: a title for your certificate.
        domain_name: fully qualified domain name for your certificate.
        certificate_lifetime: the validity of the certificate in seconds.
        public_key_bytes: public key used in signing the certificates.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    # The public key used to sign the certificate can be generated using any crypto library/framework.
    # Also you can use Cloud KMS to retrieve an already created public key.
    # For more info, see: https://cloud.google.com/kms/docs/retrieve-public-key.

    # Set the Public Key and its format.
    public_key = privateca_v1.PublicKey(
        key=public_key_bytes,
        format_=privateca_v1.PublicKey.KeyFormat.PEM,
    )

    subject_config = privateca_v1.CertificateConfig.SubjectConfig(
        subject=privateca_v1.Subject(common_name=common_name),
        subject_alt_name=privateca_v1.SubjectAltNames(dns_names=[domain_name]),
    )

    # Set the X.509 fields required for the certificate.
    x509_parameters = privateca_v1.X509Parameters(
        key_usage=privateca_v1.KeyUsage(
            base_key_usage=privateca_v1.KeyUsage.KeyUsageOptions(
                digital_signature=True,
                key_encipherment=True,
            ),
            extended_key_usage=privateca_v1.KeyUsage.ExtendedKeyUsageOptions(
                server_auth=True,
                client_auth=True,
            ),
        ),
    )

    # Create certificate.
    certificate = privateca_v1.Certificate(
        config=privateca_v1.CertificateConfig(
            public_key=public_key,
            subject_config=subject_config,
            x509_config=x509_parameters,
        ),
        lifetime=duration_pb2.Duration(seconds=certificate_lifetime),
    )

    # Create the Certificate Request.
    request = privateca_v1.CreateCertificateRequest(
        parent=caServiceClient.ca_pool_path(project_id, location, ca_pool_name),
        certificate_id=certificate_name,
        certificate=certificate,
        issuing_certificate_authority_id=ca_name,
    )
    result = caServiceClient.create_certificate(request=request)

    print("Certificate creation result:", result)

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h2 data-text="Using an existing Cloud KMS key" id="kms-key">Using an existing Cloud KMS key</h2>
<p>To use a Cloud KMS key to create an end-entity server TLS certificate,
run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create \
  --issuer-pool <var translate="no">POOL_ID</var> \
  --kms-key-version projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION_ID</var>/keyRings/<var translate="no">KEY_RING</var>/cryptoKeys/<var translate="no">KEY</var>/cryptoKeyVersions/<var translate="no">KEY_VERSION</var> \
  --cert-output-file <var translate="no">CERT_FILENAME</var> \
  --dns-san "<var translate="no">DNS_NAME</var>" \
  --use-preset-profile "leaf_server_tls"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: The name of the CA pool.</li>
<li><var translate="no">PROJECT_ID</var>: The project ID.</li>
<li><var translate="no">LOCATION_ID</var>: The location of the key ring.</li>
<li><var translate="no">KEY_RING</var>: The name of the key ring where the key
is located.</li>
<li><var translate="no">KEY</var>: The name of the key.</li>
<li><var translate="no">KEY_VERSION</var>: The version of the key.</li>
<li><var translate="no">CERT_FILENAME</var>: The path of the PEM-encoded
certificate chain file. The certificate chain file is ordered from end-entity
to root.</li>
<li><var translate="no">DNS_NAME</var>: Comma-separated DNS SANs.</li>
</ul>
<h2 data-text="Performing common operations with certificates" id="common-operations">Performing common operations with certificates</h2>
<p>This section describes how you can perform certain common operations with certificates.</p>
<h3 data-text="Issue a certificate from a specific CA in a CA pool" id="issue-certificate-specific-ca">Issue a certificate from a specific CA in a CA pool</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><p>To target a specific CA in the CA pool for certificate issuance, add the
<code dir="ltr" translate="no">--ca</code> flag with the <var translate="no">CA_ID</var> of the CA that must issue the certificate.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates create \
  --issuer-pool <var translate="no">POOL_ID</var> \
  --ca <var translate="no">CA_ID</var> \
  --generate-key \
  --key-output-file <var translate="no">KEY_FILENAME</var> \
  --cert-output-file <var translate="no">CERT_FILENAME</var> \
  --dns-san "<var translate="no">DNS_NAME</var>" \
  --use-preset-profile "leaf_server_tls"
</code></pre></section>
<section><h3 data-text="Console" id="console_2">Console</h3><p>The Google Cloud console only supports certificate issuance from a particular CA. Use the
instructions in the <a href="#use_an_auto-generated_key">Use an auto-generated Key</a>
section or the <a href="#use_a_csr">Use a CSR</a> section to choose the CA that must
issue the certificate.</p></section>
<section><h3 data-text="Terraform" id="terraform_1">Terraform</h3>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_no_authority/main.tf" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/privateca_certificate_no_authority/main.tf" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="main" data-github-path="terraform-google-modules/terraform-docs-samples/privateca_certificate_no_authority/main.tf" data-region-tag="privateca_create_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="terraform-google-modules/terraform-docs-samples/privateca_certificate_no_authority/main.tf/main/privateca_create_certificate" translate="no"><code dir="ltr" translate="no">resource "google_privateca_certificate_authority" "authority" {
  // This example assumes this pool already exists.
  // Pools cannot be deleted in normal test circumstances, so we depend on static pools
  pool = ""
  certificate_authority_id = "my-authority"
  location = "us-central1"
  deletion_protection = false
  config {
    subject_config {
      subject {
        organization = "HashiCorp"
        common_name = "my-certificate-authority"
      }
      subject_alt_name {
        dns_names = ["hashicorp.com"]
      }
    }
    x509_config {
      ca_options {
        is_ca = true
      }
      key_usage {
        base_key_usage {
          digital_signature = true
          cert_sign = true
          crl_sign = true
        }
        extended_key_usage {
          server_auth = true
        }
      }
    }
  }
  lifetime = "86400s"
  key_spec {
    algorithm = "RSA_PKCS1_4096_SHA256"
  }
}


resource "google_privateca_certificate" "default" {
  pool = ""
  location = "us-central1"
  lifetime = "860s"
  name = "my-certificate"
  config {
    subject_config  {
      subject {
        common_name = "san1.example.com"
        country_code = "us"
        organization = "google"
        organizational_unit = "enterprise"
        locality = "mountain view"
        province = "california"
        street_address = "1600 amphitheatre parkway"
        postal_code = "94109"
      }
    }
    x509_config {
      ca_options {
        is_ca = false
      }
      key_usage {
        base_key_usage {
          crl_sign = true
        }
        extended_key_usage {
          server_auth = true
        }
      }
    }
    public_key {
      format = "PEM"
      key = filebase64("test-fixtures/rsa_public.pem")
    }
  }
  // Certificates require an authority to exist in the pool, though they don't
  // need to be explicitly connected to it
  depends_on = [google_privateca_certificate_authority.authority]
}</code></pre>
</div>
</section>
</div>
<h3 data-text="View issued certificates" id="view-issued-certificates">View issued certificates</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Click the <strong>CA manager</strong> tab.</p></li>
<li><p>On the <strong>Certificate authorities</strong> page, click the name of the CA.</p></li>
<li><p>At the bottom of the <strong>Certificate authority</strong> details page, click
<strong>View issued certificates</strong> to view the list of certificates issued by
the CA.</p>
<p>You can see the certificates on the <strong>All certificates</strong> page. The
details include the status of the certificate, issuing CA, the CA pool
that contains the CA, the certificate's expiration date, and more.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><p>To list all certificates issued by a particular CA in a CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates list --issuer-pool <var translate="no">ISSUER_POOL</var> --ca <var translate="no">CA_NAME</var>
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates list</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/list">gcloud privateca certificates list</a>.</p>
<p>To list all certificates across all CAs in a given location, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates list --location <var translate="no">LOCATION</var>
</code></pre><aside class="note"><strong>Note:</strong><span> Google Cloud CLI does not support cross-region listing for certificates. Use the Google Cloud console to view all the certificates in the project.</span></aside></section>
<section><h3 data-text="Code samples" id="code-samples_1">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_list_certificate-code-sample">
<section>
<h3 data-text="Java" id="privateca_list_certificate-java" track-metadata-position="privateca_list_certificate" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/ListCertificates.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/ListCertificates.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_list_certificate" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_list_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/ListCertificates.java" data-region-tag="privateca_list_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/ListCertificates.java/HEAD/privateca_list_certificate" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.security.privateca.v1.CaPoolName;
import com.google.cloud.security.privateca.v1.Certificate;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import java.io.IOException;

public class ListCertificates {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: Id of the CA pool which contains the certificates to be listed.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    listCertificates(project, location, pool_Id);
  }

  // List Certificates present in the given CA pool.
  public static void listCertificates(String project, String location, String pool_Id)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      CaPoolName caPool =
          CaPoolName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .build();

      // Retrieve and print the certificate names.
      System.out.println("Available certificates: ");
      for (Certificate certificate :
          certificateAuthorityServiceClient.listCertificates(caPool).iterateAll()) {
        System.out.println(certificate.getName());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_list_certificate-python" track-metadata-position="privateca_list_certificate" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/list_certificates.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/list_certificates.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_list_certificate" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_list_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/list_certificates.py" data-region-tag="privateca_list_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/list_certificates.py/HEAD/privateca_list_certificate" translate="no"><code dir="ltr" translate="no">
import google.cloud.security.privateca_v1 as privateca_v1


def list_certificates(
    project_id: str,
    location: str,
    ca_pool_name: str,
) -&gt; None:
    """
    List Certificates present in the given CA pool.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: name of the CA pool which contains the certificates to be listed.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    ca_pool_path = caServiceClient.ca_pool_path(project_id, location, ca_pool_name)

    # Retrieve and print the certificate names.
    print(f"Available certificates in CA pool {ca_pool_name}:")
    for certificate in caServiceClient.list_certificates(parent=ca_pool_path):
        print(certificate.name)

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h3 data-text="View details for a single certificate" id="view-details-single-certificate">View details for a single certificate</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_4">Console</h3><ol>
<li><p>In the Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>Pick your target CA under the <strong>CA Manager</strong> tab.</p></li>
<li><p>Click the CA name.</p></li>
<li><p>At the bottom of the <strong>Certificate authority</strong> details page, click <strong>View issued certificates</strong> to see the list of issued certificates.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> in the <strong>Actions</strong> column for the certificate you want to download.</p></li>
<li><p>Under <strong>Download</strong>, click <strong>Certificate</strong>. You can download the
<em>certificate chain</em> by clicking <strong>Certificate chain</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_4">gcloud</h3><p>To see the full description of a certificate, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates describe <var translate="no">CERT_NAME</var> \
    --issuer-pool <var translate="no">POOL_ID</var>
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates describe</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/describe">gcloud privateca certificates describe</a>.</p>
<p>To export the PEM-encoded X.509 certificate chain and to a file, run the
following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates export <var translate="no">CERT_NAME</var> \
    --issuer-pool <var translate="no">POOL_ID</var> \
    --include-chain \
    --output-file <var translate="no">certificate-file</var>
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates export</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/export">gcloud privateca certificates export</a>.</p>
<aside class="note"><strong>Note:</strong><span> You may omit <code dir="ltr" translate="no">---include-chain</code> to export only the leaf certificate.</span></aside></section>
</div>
<h2 data-text="Proof-of-possession for certificates" id="pop">Proof-of-possession for certificates</h2>
<p>Proof-of-possession of the private key ensures that the requester of a certificate holds the private key for that certificate. CA Service checks proof-of-possession only if the requester provides a PKCS #10 CSR according to <a class="external" href="https://tools.ietf.org/html/rfc2986">RFC 2986</a>. Proof-of-possession for other forms of certificate requests, such as requests by <a href="/certificate-authority-service/docs/reference/rest/v1beta1/CertificateConfig">CertificateConfig</a> is not enforced.</p>
<p>It is the responsibility of client applications that accept certificates to validate whether the certificate holder possesses the private key of that certificate. Enforcing proof-of-possession checks during certificate issuance is a form of defense-in-depth to protect again misbehaving clients. The existence of such clients, regardless of whether the CA checks proof-of-possession, could constitute a security vulnerability.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/certificate-authority-service/docs/certificate-profile">certificate profiles</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/revoking-certificates">revoke certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/sorting-filtering-certificates">sort and filter certificates</a>.</li>
<li>Learn how to <a href="/sdk/gcloud/reference/privateca/certificates">manage certificates using the Google Cloud CLI</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/revoking-certificates]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Revoking certificates" id="revoking-certificates">Revoking certificates</h1>
<p>This page explains how to revoke certificates.</p>
<p>Certificate Authority Service supports certificate revocation by periodically publishing
Certificate Revocation Lists (CRLs). You can only revoke certificates issued by
CA pools in the Enterprise tier.</p>
<aside class="note"><strong>Note:</strong><span> While CA Service does support publishing CRLs in the Enterprise tier, effective
revocation requires client applications to periodically download those CRLs and
reject certificates whose serial numbers appear in them.</span></aside>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Make sure you have the Certificate Authority Service Operation Manager
(<code dir="ltr" translate="no">roles/privateca.caManager</code>) or the CA Service Admin
(<code dir="ltr" translate="no">roles/privateca.admin</code>) Identity and Access Management (IAM) role. For more
information about the predefined IAM roles for
CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<p>For information about granting an IAM role, see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Granting a single
role</a>.</p>
<h2 data-text="Enabling CRL publication" id="enable-crl-publication">Enabling CRL publication</h2>
<p>To revoke the certificates issued by a CA pool, you must enable CRL publication
on the CA pool. You can enable CRL publication while creating a CA pool. If
initially disabled, you can enable CRL publication later.</p>
<p>After you enable CRL publication, a new CRL is published daily and is
valid for 7 days. A new CRL is also published within 15 minutes of any
new certificate revocation.</p>
<aside class="caution"><strong>Caution:</strong><span> Any certificates issued while CRL publication was disabled don't have the necessary extension to perform revocation checks. We recommend that you ensure CRL
publication is enabled <strong>before</strong> issuing any long-lived certificates.</span></aside>
<p>To enable CRL publication on a CA pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="revoking_certificates">Certificate Authority Service</a> </p></li>
<li><p>Click the name of a CA from the CA pool that you want to modify.</p></li>
<li><p>On the <strong>Certificate authority</strong> page, click <strong>Edit Policy</strong>.</p></li>
<li><p>On the left panel that appears, click the <strong>Publish the access URL for the certificate revocation list in issued certificates</strong> toggle under <strong>Publishing Options</strong>.</p>
<aside class="note"><strong>Note:</strong><span> Toggling this switch enables CRL publication for <strong>all CAs</strong> that are part of the CA pool in which your CA resides.</span></aside></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>Run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools update <var translate="no">POOL_ID</var> \
  --publish-crl
</code></pre>
<p>Replace <var translate="no">POOL_ID</var> with the name of the CA pool.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools update</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/update">gcloud privateca pools update</a>.</p></section>
</div>
<p>CA Service enforces a limit of 500,000 unexpired revoked
certificates per CRL.</p>
<aside class="note"><strong>Note:</strong><span> Only the last 100 CRLs by chronological order are retained as <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificateAuthorities.certificateRevocationLists#CertificateRevocationList">CertificateRevocationList</a> resources, and older CRLs are automatically deleted. Retention of older CRLs in customer-managed Cloud Storage buckets is subject to the <a href="/storage/docs/object-versioning">Object Versioning</a> and <a href="/storage/docs/bucket-lock">retention policies</a> configured by customers.<br/>Note that CRLs that have been deleted from CA Service can still be accessed from service-managed Cloud Storage buckets, unless the CA is deleted. CRLs are never deleted from customer-managed Cloud Storage buckets, even if the CA is deleted.</span></aside>
<h2 data-text="Revoking a certificate" id="revoke-certificate">Revoking a certificate</h2>
<p>CA Service allows revoking certificates by serial number or resource
name, and also accepts an optional reason. After a certificate is revoked, its serial
number and revocation reason appear in all future CRLs until the
certificate reaches its expiry date. An out-of-band CRL is also generated within
15 minutes of revocation.</p>
<p>To revoke a certificate, use the following steps:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3>
<ol>
<li>
    Go to the <b>Certificate Authority Service</b> page in the
    Cloud console.
    <p>
<a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to Certificate Authority Service
      </a>
</p>
</li>
<li>
    Click the <b>Private certificate manager</b> tab.
  </li>
<li>
    In the list of certificates, click
    <span aria-hidden="true" class="material-icons" translate="no">more_vert</span><b>View more</b> in the row of
    the certificate you want to delete.
  </li>
<li>
    Click <b>Revoke</b>.
  </li>
<li>
    In the dialog that opens, click <b>Confirm</b>.
  </li>
</ol>
<aside class="note"><strong>Note:</strong><span> Cloud console does not support revoking a certificate using its
serial number. If you want to revoke a certificate using its serial number,
use the Google Cloud CLI.</span></aside></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><ul>
<li><p>To revoke a certificate using its resource name, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates revoke \
  --certificate <var translate="no">CERT_ID</var> \
  --issuer-pool <var translate="no">POOL_ID</var> \
  --reason <var translate="no">REVOCATION_REASON</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CERT_ID</var>: The unique identifier of the certificate that you want to revoke.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool that issued the certificate.</li>
<li><var translate="no">REVOCATION_REASON</var>: The reason for revoking the certificate.</li>
</ul>
<p>The <code dir="ltr" translate="no">--reason</code> flag is optional. For more information about this flag, see <a href="/sdk/gcloud/reference/privateca/certificates/revoke#--reason">--reason</a>, or use the following <code dir="ltr" translate="no">gcloud</code> command with the <code dir="ltr" translate="no">--help</code> flag:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates revoke <strong>--help</strong>
</code></pre>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates revoke</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/revoke">gcloud privateca certificates revoke</a>.</p></li>
<li><p>To revoke a certificate using its serial number, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca certificates revoke \
  --serial-number <var translate="no">SERIAL_NUMBER</var> \
  --issuer-pool <var translate="no">POOL_ID</var> \
  --reason <var translate="no">REVOCATION_REASON</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">SERIAL_NUMBER</var>: The serial number of the certificate.</li>
<li><var translate="no">POOL_ID</var>: The name of the CA pool that issued the certificate.</li>
<li><var translate="no">REVOCATION_REASON</var>: The reason for revoking the certificate.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca certificates revoke</code> command, see <a href="/sdk/gcloud/reference/privateca/certificates/revoke">gcloud privateca certificates revoke</a>.</p>
<p>When prompted to confirm, you can do so by entering 'Y':</p>
<pre class="devsite-disable-click-to-copy devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">You are about to revoke Certificate [projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">CA_POOL_REGION</var>/caPools/<var translate="no">POOL_ID</var>/certificates/<var translate="no">CERT_ID</var>]

Do you want to continue? (Y/n) Y
Revoked certificate [projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">CA_POOL_REGION</var>/caPools/<var translate="no">POOL_ID</var>/certificates/<var translate="no">CERT_ID</var>] at <var translate="no">DATE_TIME</var>.

</code></pre></li>
</ul></section>
<section><h3 data-text="Code samples" id="code-samples">Code samples</h3><p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_revoke_certificate-code-sample">
<section>
<h3 data-text="Java" id="privateca_revoke_certificate-java" track-metadata-position="privateca_revoke_certificate" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/RevokeCertificate.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-security-private-ca/blob/HEAD/samples/snippets/cloud-client/src/main/java/privateca/RevokeCertificate.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_revoke_certificate" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="privateca_revoke_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/RevokeCertificate.java" data-region-tag="privateca_revoke_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-security-private-ca/samples/snippets/cloud-client/src/main/java/privateca/RevokeCertificate.java/HEAD/privateca_revoke_certificate" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.ApiFuture;
import com.google.cloud.security.privateca.v1.Certificate;
import com.google.cloud.security.privateca.v1.CertificateAuthorityServiceClient;
import com.google.cloud.security.privateca.v1.CertificateName;
import com.google.cloud.security.privateca.v1.RevocationReason;
import com.google.cloud.security.privateca.v1.RevokeCertificateRequest;
import java.io.IOException;
import java.util.concurrent.ExecutionException;

public class RevokeCertificate {

  public static void main(String[] args)
      throws IOException, ExecutionException, InterruptedException {
    // TODO(developer): Replace these variables before running the sample.
    // location: For a list of locations, see:
    // https://cloud.google.com/certificate-authority-service/docs/locations
    // pool_Id: Id for the CA pool which contains the certificate.
    // certificateName: Name of the certificate to be revoked.
    String project = "your-project-id";
    String location = "ca-location";
    String pool_Id = "ca-pool-id";
    String certificateName = "certificate-name";
    revokeCertificate(project, location, pool_Id, certificateName);
  }

  // Revoke an issued certificate. Once revoked, the certificate will become invalid and will expire
  // post its lifetime.
  public static void revokeCertificate(
      String project, String location, String pool_Id, String certificateName)
      throws IOException, ExecutionException, InterruptedException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the `certificateAuthorityServiceClient.close()` method on the client to safely
    // clean up any remaining background resources.
    try (CertificateAuthorityServiceClient certificateAuthorityServiceClient =
        CertificateAuthorityServiceClient.create()) {

      // Create Certificate Name.
      CertificateName certificateNameParent =
          CertificateName.newBuilder()
              .setProject(project)
              .setLocation(location)
              .setCaPool(pool_Id)
              .setCertificate(certificateName)
              .build();

      // Create Revoke Certificate Request and specify the appropriate revocation reason.
      RevokeCertificateRequest revokeCertificateRequest =
          RevokeCertificateRequest.newBuilder()
              .setName(certificateNameParent.toString())
              .setReason(RevocationReason.PRIVILEGE_WITHDRAWN)
              .build();

      // Revoke certificate.
      ApiFuture&lt;Certificate&gt; response =
          certificateAuthorityServiceClient
              .revokeCertificateCallable()
              .futureCall(revokeCertificateRequest);
      Certificate certificateResponse = response.get();

      System.out.println("Certificate Revoked: " + certificateResponse.getName());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="privateca_revoke_certificate-python" track-metadata-position="privateca_revoke_certificate" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/revoke_certificate.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/revoke_certificate.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_revoke_certificate" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_revoke_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/revoke_certificate.py" data-region-tag="privateca_revoke_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/revoke_certificate.py/HEAD/privateca_revoke_certificate" translate="no"><code dir="ltr" translate="no">
import google.cloud.security.privateca_v1 as privateca_v1


def revoke_certificate(
    project_id: str,
    location: str,
    ca_pool_name: str,
    certificate_name: str,
) -&gt; None:
    """
    Revoke an issued certificate. Once revoked, the certificate will become invalid and will expire post its lifetime.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: name for the CA pool which contains the certificate.
        certificate_name: name of the certificate to be revoked.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    # Create Certificate Path.
    certificate_path = caServiceClient.certificate_path(
        project_id, location, ca_pool_name, certificate_name
    )

    # Create Revoke Certificate Request and specify the appropriate revocation reason.
    request = privateca_v1.RevokeCertificateRequest(
        name=certificate_path, reason=privateca_v1.RevocationReason.PRIVILEGE_WITHDRAWN
    )
    result = caServiceClient.revoke_certificate(request=request)

    print("Certificate revoke result:", result)

</code></pre>
</div>
</section>
</div></p></section>
</div>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/sorting-filtering-certificates">sort and filter certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/ocsp-support">implement a delegated OCSP responder</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/sorting-filtering-certificates]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Sorting and filtering certificates" id="sorting-and-filtering-certificates">Sorting and filtering certificates</h1>
<p>This page lists the ordering and filters that can be used with the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates/list"><code dir="ltr" translate="no">ListCertificates</code></a> API call of Certificate Authority Service.</p>
<h2 data-text="Sorting support" id="sorting_support">Sorting support</h2>
<p>By default, <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates/list"><code dir="ltr" translate="no">ListCertificates</code></a> API call returns the certificates ordered by the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates#Certificate.FIELDS.create_time"><code dir="ltr" translate="no">create_time</code></a> field, with the newest certificates being listed first. No other sort order can be specified.</p>
<h2 data-text="Filtering support" id="filtering_support">Filtering support</h2>
<h3 data-text="Supported fields" id="supported_fields">Supported fields</h3>
<p>The following fields can be used for filtering the certificates returned by the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates/list"><code dir="ltr" translate="no">ListCertificates</code></a> API call:</p>
<table>
<thead>
<tr>
<th>Field Name</th>
<th>Field Type</th>
<th>Supported Operators</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates#Certificate.FIELDS.create_time">create_time</a></td>
<td><a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#timestamp">timestamp</a></td>
<td><code dir="ltr" translate="no">&lt;, &gt;, &lt;=, &gt;=, =, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates#Certificate.FIELDS.update_time">update_time</a></td>
<td><a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#timestamp">timestamp</a></td>
<td><code dir="ltr" translate="no">&lt;, &gt;, &lt;=, &gt;=, =, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/CertificateDescription#SubjectDescription.FIELDS.not_after_time">certificate_description.subject_description.not_after_time</a></td>
<td><a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#timestamp">timestamp</a></td>
<td><code dir="ltr" translate="no">&lt;, &gt;, &lt;=, &gt;=, =, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/CertificateDescription#SubjectDescription.FIELDS.not_before_time">certificate_description.subject_description.not_before_time</a></td>
<td><a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#timestamp">timestamp</a></td>
<td><code dir="ltr" translate="no">&lt;, &gt;, &lt;=, &gt;=, =, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/CertificateDescription#CertificateFingerprint.FIELDS.sha256_hash">certificate_description.cert_fingerprint.sha256_hash</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/CertificateDescription#SubjectDescription.FIELDS.hex_serial_number">certificate_description.subject_description.hex_serial_number</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.common_name">certificate_description.subject_description.subject.common_name</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.country_code">certificate_description.subject_description.subject.country_code</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.organization">certificate_description.subject_description.subject.organization</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.organizational_unit">certificate_description.subject_description.subject.organizational_unit</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.locality">certificate_description.subject_description.subject.locality</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.province">certificate_description.subject_description.subject.province</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.street_address">certificate_description.subject_description.subject.street_address</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/Subject#FIELDS.postal_code">certificate_description.subject_description.subject.postal_code</a></td>
<td>string</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/SubjectAltNames#FIELDS.dns_names">certificate_description.subject_description.subject_alt_name.dns_names</a></td>
<td>string</td>
<td><a href="https://google.aip.dev/160#has-operator">: (HAS operator)</a></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#ExtendedKeyUsageOptions.FIELDS.client_auth">certificate_description.x509_description.key_usage.extended_key_usage.client_auth</a></td>
<td>bool</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#ExtendedKeyUsageOptions.FIELDS.server_auth">certificate_description.x509_description.key_usage.extended_key_usage.server_auth</a></td>
<td>bool</td>
<td><code dir="ltr" translate="no">=, !=</code></td>
</tr>
<tr>
<td><a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates#Certificate.FIELDS.labels">labels</a></td>
<td><a href="https://developers.google.com/protocol-buffers/docs/proto3#maps">map<string, string=""></string,></a></td>
<td><a href="https://google.aip.dev/160#has-operator">: (HAS operator)</a></td>
</tr>
</tbody>
</table>
<p><strong>Note</strong>: The fields <a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#ExtendedKeyUsageOptions.FIELDS.client_auth">certificate_description.x509_description.key_usage.extended_key_usage.client_auth</a> and <a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#ExtendedKeyUsageOptions.FIELDS.server_auth">certificate_description.x509_description.key_usage.extended_key_usage.server_auth</a> are booleans that refer to whether the respective Extended Key Usages are present.</p>
<h3 data-text="Filtering syntax" id="filtering_syntax">Filtering syntax</h3>
<p>The filtering syntax is following the API Filtering guidance set in <a href="https://google.aip.dev/160">AIP 160</a> with the following limitations:</p>
<ul>
<li><p>only top level <code dir="ltr" translate="no">AND</code> operators are supported. Everything else is not (for example, <code dir="ltr" translate="no">OR</code>, <code dir="ltr" translate="no">NOT</code>, nested operators, or any combination of these operators).</p>
<ul>
<li><p><span class="compare-better">Valid</span>: Filter uses only top level AND operator:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">create_time&gt;"2020-08-21T11:30:00.11-05:00" AND certificate_description.x509_description.key_usage.extended_key_usage.server_auth=true
</code></pre></li>
<li><p><span class="compare-worse">Invalid</span>: Filter uses OR operator:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no"> create_time&gt;"2020-08-21T11:30:00.11-05:00" OR certificate_description.x509_description.key_usage.extended_key_usage.server_auth=true
</code></pre></li>
<li><p><span class="compare-worse">Invalid</span>: Filter uses nested operators:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no"> (create_time&gt;"2020-08-21T11:30:00.11-05:00" AND certificate_description.x509_description.key_usage.extended_key_usage.server_auth=true) AND certificate_description.subject_description.subject.common_name="foo.com"
</code></pre></li>
</ul></li>
<li><p>wildcard matching (using <code dir="ltr" translate="no">*</code>) is not supported except for the <a href="/certificate-authority-service/docs/reference/rest/v1/SubjectAltNames#FIELDS.dns_names"><code dir="ltr" translate="no">certificate_description.subject_description.subject_alt_name.dns_names</code></a> field which supports suffix matching for the DNS labels.</p>
<ul>
<li><p><span class="compare-better">Valid</span>: Filter compares a wildcard suffix match:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">certificate_description.subject_description.subject_alt_name.dns_names:"*.foo.com"
</code></pre></li>
<li><p><span class="compare-worse">Invalid</span>: Filter compares with a wildcard prefix match:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">certificate_description.subject_description.subject_alt_name.dns_names:"foo.*"
</code></pre></li>
<li><p><span class="compare-worse">Invalid</span>: Filter compares with a wildcard for an unsupported field:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">"certificate_description.subject_description.hex_serial_number"="*3d3"
</code></pre></li>
</ul></li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/certificate-authority-service/docs/requesting-certificates">request certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/revoking-certificates">revoke certificates</a>.</li>
<li>See the <a href="/certificate-authority-service/docs/reference/rest">REST API reference documentation</a>.</li>
<li>See the <a href="/certificate-authority-service/docs/reference/rpc">RPC API reference documentation</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/tutorials/using-3pi-with-reflection]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Issue certificates that attest to third-party identity" id="issue-certificates-that-attest-to-third-party-identity">Issue certificates that attest to third-party identity</h1>
<p>This tutorial demonstrates how you can issue certificates that attest to a
third-party identity using
<a href="/certificate-authority-service/docs/using-identity-reflection">identity reflection</a>
and <a href="/iam/docs/workload-identity-federation#pools">workload identity pools</a>.</p>
<p>You can use identity reflection to create certificates that match the verified
identity of a certificate requester. Using identity reflection, you can limit an
unprivileged certificate requester to requesting only certificates with a
subject alternative name (SAN) corresponding to the identity in their
credential.</p>
<h2 data-text="Objectives" id="objectives">Objectives</h2>
<p>This tutorial provides information about how you can use CA Service
with workload identity pools to federate a third-party identity and obtain a
certificate that attests to this identity.</p>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<p>Before you begin, make sure that you understand the following concepts:</p>
<ul>
<li><strong>Workload identity pools</strong>: Workload identity pools let you manage third-party
identity providers. For more information, see <a href="/iam/docs/manage-workload-identity-pools-providers">Workload identity
pools</a>.</li>
<li><strong>Workload identity federation</strong>: Workload identity federation leverages
workload identity pools to give third-party identities access to Google Cloud
services. For more information, see <a href="/iam/docs/workload-identity-federation">Workload identity
federation</a>.</li>
<li><strong>Secure Token Service (STS)</strong>: The Secure Token Service lets you exchange
third-party credentials for first-party (Google Cloud) tokens. For more
information, see <a href="/iam/docs/reference/sts/rest">Secure Token Service</a>.</li>
<li><strong>Identity reflection</strong>: The identity reflection feature lets the verified
identity of a certificate requester go on to the requested certificate. For
more information, see <a href="/certificate-authority-service/docs/using-identity-reflection">Identity
reflection</a>.</li>
</ul>
<p>Make sure that you have the following <a href="/iam/docs/overview#roles">IAM
roles</a>:</p>
<aside class="note"><strong>Note:</strong><span> Grant the following IAM roles with caution. The permissions
associated with the following roles grant access to security critical
Google Cloud controls. If you plan to use the same project later for production,
we recommend reviewing these permissions again and reducing access wherever
possible.</span></aside>
<ul>
<li>To manage certificate authorities (CAs) and <a href="/certificate-authority-service/docs/ca-pool">CA pools</a>, and request
certificates, you must have the CA Service Operation Manager
(<code dir="ltr" translate="no">privateca.caManager</code>) role. For more information about IAM
roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and
roles</a>.</li>
<li>To manage workload identity pools and providers, you must have the
Workload Identity Pool Admin (<code dir="ltr" translate="no">iam.workloadIdentityPoolAdmin</code>) role.</li>
<li>To create a service account, you must have the Service Account Admin
(<code dir="ltr" translate="no">iam.serviceAccountAdmin</code>) role.</li>
</ul>
<p>For information about granting IAM roles, see
<a href="/iam/docs/granting-changing-revoking-access">Manage access to projects, folders, and
organizations</a>. You can grant the
required IAM roles to a Google Account, a service account, a
Google group, a Google Workspace account, or a Cloud Identity domain.</p>
<h2 data-text="Set up a workload identity pool and provider" id="set-up-wip">Set up a workload identity pool and provider</h2>
<p>This tutorial explains how you can use a <a href="https://developers.google.com/identity/protocols/oauth2/openid-connect">Google OpenID Connect (OIDC)</a>
provider combined with a service account to act as a third-party identity. The
Google Accounts OIDC provider acts as a third-party identity provider (IDP) and
the Google Cloud service account is a sample third-party identity asserted by this IDP.</p>
<p>Workload identity pools support a variety of identity providers,
including Microsoft Azure/On-premises Active Directory, AWS, and SAML-based
identity providers.</p>
<p>To set up a workload identity pool and provider, do the following:</p>
<ol>
<li><p>To represent a trusted set of federated identities, create a workload
identity pool:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud iam workload-identity-pools create <var translate="no">IDENTITY_POOL_ID</var> --location global --display-name "tutorial-wip"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">IDENTITY_POOL_ID</var>: The unique identifier of the new workload
identity pool.</li>
</ul></li>
<li><p>Create a workload identity pool provider for your third-party identity
provider:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud iam workload-identity-pools providers create-oidc <var translate="no">PROVIDER_ID</var> --location global --workload-identity-pool <var translate="no">IDENTITY_POOL_ID</var> --display-name "tutorial-oidc" --attribute-mapping "google.subject=assertion.sub" --issuer-uri="https://accounts.google.com"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROVIDER_ID</var>: The unique identifier of the identity provider
that you want to create in the workload identity pool.</li>
</ul>
<p>You can customize the following flags to your use case:</p>
<ul>
<li><code dir="ltr" translate="no">attribute-mapping</code>: This flag sets the mapping between the third-party
claims to the Google principal claim, <code dir="ltr" translate="no">google.subject</code>. <code dir="ltr" translate="no">google.subject</code>
is a required mapping that you can set to any claims or combination of
claims using a <a class="external" href="https://opensource.google/projects/cel">CEL</a> 
expression. For more information, see <a href="/iam/docs/configuring-workload-identity-federation#mappings-and-conditions">Define an attribute mapping and
condition</a>.</li>
<li><code dir="ltr" translate="no">issuer-uri</code>: For OIDC providers, this flag is a publicly accessible
endpoint that Google reaches out to for verification of third-party
tokens. For more information, see <a href="/iam/docs/configuring-workload-identity-federation#prepare">Preparing an external identity
provider</a>.</li>
</ul>
<p>For more information about setting up a workload identity
provider, see <a href="/iam/docs/configuring-workload-identity-federation">Configuring workload identity
federation</a>.</p></li>
</ol>
<h2 data-text="Create a CA pool and an issuing CA" id="create-ca-pool">Create a CA pool and an issuing CA</h2>
<p>This section explains how you can create a CA pool and add a root
CA to it. You can use this CA pool to issue identity-reflected
certificates. If you want to use an existing CA pool and CA, you can skip this
section.</p>
<p>Instead of a root CA, you can also choose to create a subordinate CA. Creating
a root CA helps shorten the procedure.</p>
<ol>
<li><p>Create a CA pool in the <a href="/certificate-authority-service/docs/tiers">DevOps tier</a>:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools create <var translate="no">CA_POOL_ID</var> --location <var translate="no">LOCATION</var> --tier devops
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_POOL_ID</var> - The ID of the CA Service CA pool that
issues certificates.</li>
<li><var translate="no">LOCATION</var> - The location of the CA pool.</li>
</ul>
<p>For more information about creating CA pools, see
<a href="/certificate-authority-service/docs/creating-ca-pool">Creating CA pools</a>.</p></li>
<li><p>Create a root CA:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots create <var translate="no">CA_ID</var> --pool <var translate="no">CA_POOL_ID</var>  --location <var translate="no">LOCATION</var> --subject "CN=test,O=test-org"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">CA_ID</var> - The ID of certificate authority that issues certificates.</li>
<li><var translate="no">CA_POOL_ID</var> - The ID of the CA Service CA pool that
issues certificates.</li>
<li><var translate="no">LOCATION</var> - The location of the CA pool.</li>
</ul>
<p>For more information about creating CAs, see
<a href="/certificate-authority-service/docs/creating-certificate-authorities">Creating CAs</a>.</p></li>
<li><p>Enable identities federated from the workload identity pool to issue
certificates from the CA Pool. Identity reflection requires the
CA Service Workload Certificate Requester
(<code dir="ltr" translate="no">roles/privateca.workloadCertificateRequester</code>) IAM role for
the requesters of <a href="/certificate-authority-service/docs/reference/rpc/google.cloud.security.privateca.v1#createcertificaterequest"><code dir="ltr" translate="no">CreateCertificate</code></a>.</p>
<p>You can represent workload identity pool principals in various granularities,
ranging from a single subject to all identities in the pool across providers.
For more information, see the <a href="/iam/docs/using-workload-identity-federation#impersonate">principals or principal sets that are available (use gcloud tab)</a> to best suit your use case.</p>
<aside class="note"><strong>Note:</strong><span> You don't need to impersonate a service account to reach out to
CA Service.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">CA_POOL_ID</var> --location <var translate="no">LOCATION</var> --role roles/privateca.workloadCertificateRequester --member "principalSet://iam.googleapis.com/projects/<var translate="no">PROJECT_NUMBER</var>/locations/global/workloadIdentityPools/<var translate="no">IDENTITY_POOL_ID</var>/*"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_NUMBER</var> - The project number of the project in which you
created the workload identity pool.</li>
</ul></li>
</ol>
<h2 data-text="Create a service account that represents a third-party identity" id="create-service-account">Create a service account that represents a third-party identity</h2>
<p>The following procedure assumes that a service account represents a
third-party. This section shows how you can use the
<a href="/iam/docs/creating-short-lived-service-account-credentials#sa-credentials-oidc"><code dir="ltr" translate="no">GenerateIdToken</code></a>
IAM endpoint to retrieve a third-party identity in the form of
an OIDC token. Depending on your use case, you might need different steps to
obtain the third-party identity token of your choosing.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud iam service-accounts create <var translate="no">SERVICE_ACCOUNT</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">SERVICE_ACCOUNT</var> - The ID of the service account that represents the
third-party identity.</li>
</ul>
<h2 data-text="Issue a certificate attesting to a third-party identity" id="issue-certificate">Issue a certificate attesting to a third-party identity</h2>
<p>Before you begin, make sure that you have the Service Account Token Creator
(<code dir="ltr" translate="no">roles/iam.serviceAccountTokenCreator</code>) IAM role. You need this
IAM role to call the <code dir="ltr" translate="no">GenerateIdToken</code> API.</p>
<p>To obtain a certificate that attests to a third-party identity, do the
following:</p>
<!-- TODO(b/207544796): Update and test jq instead of python -->
<ol>
<li><p>Obtain a third-party identity token from your third-party identity provider.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="curl" id="curl">curl</h3><aside class="note"><strong>Note:</strong><span> To perform this command, you need the <a href="https://www.python.org/download/releases/3.0/"><code dir="ltr" translate="no">python3</code></a>
CLI.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export ID_TOKEN=`curl -d '{"audience":"//iam.googleapis.com/projects/<var translate="no">PROJECT_NUMBER</var>/locations/global/workloadIdentityPools/<var translate="no">IDENTITY_POOL_ID</var>/providers/<var translate="no">PROVIDER_ID</var>"}' -H 'Content-Type: application/json' -H "Authorization: Bearer $(gcloud auth print-access-token)" https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/<var translate="no">SERVICE_ACCOUNT</var>@<var translate="no">PROJECT_ID</var>.iam.gserviceaccount.com:generateIdToken | python3 -c "import sys;import json;print(json.load(sys.stdin)['token'])"`
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var> - The Google Cloud project id for the project you
want to create resources in.</li>
</ul></section>
<section><h3 data-text="Client libraries" id="client-libraries">Client libraries</h3><aside class="note"><strong>Note:</strong><span> This flow requires the Python-based client libraries for
CA Service. For information about installing the Python-based
client libraries, see <a class="external" href="https://googleapis.dev/python/privateca/latest/index.html">Python client for
CA Service</a> </span></aside>
<p>To access the third-party token programmatically, you can obtain a token from a
file-sourced credential or a url-sourced credential. For more information,
see <a href="/iam/docs/using-workload-identity-federation#generate-automatic">Authenticating by using client libraries, the gcloud CLI,
or Terraform</a>.
In this tutorial, we follow a file-source credential workflow.</p>
<p>Load your credential into a file path readable by your certificate
requester:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -d '{"audience":"//iam.googleapis.com/projects/<var translate="no">PROJECT_NUMBER</var>/locations/global/workloadIdentityPools/<var translate="no">IDENTITY_POOL_ID</var>/providers/<var translate="no">PROVIDER_ID</var>"}' -H 'Content-Type: application/json' -H "Authorization: Bearer $(gcloud auth print-access-token)" https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/<var translate="no">SERVICE_ACCOUNT</var>@<var translate="no">PROJECT_ID</var>.iam.gserviceaccount.com:generateIdToken | python3 -c "import sys;import json;       print(json.load(sys.stdin)['token']) &gt; /tmp/oidc_token.txt
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: The project ID of the project you
want to create resources in.</li>
</ul></section>
</div></li>
<li><p>Exchange your third-party token for a federated OAuth token using the STS
<code dir="ltr" translate="no">token</code> endpoint:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="curl" id="curl_1">curl</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export STS_TOKEN=`curl -L -X POST 'https://sts.googleapis.com/v1/token' -H 'Content-Type: application/json' \
-d '{
    "grant_type": "urn:ietf:params:oauth:grant-type:token-exchange",
    "audience": "//iam.googleapis.com/projects/<var translate="no">PROJECT_NUMBER</var>/locations/global/workloadIdentityPools/<var translate="no">IDENTITY_POOL_ID</var>/providers/<var translate="no">PROVIDER_ID</var>",
    "requested_token_type": "urn:ietf:params:oauth:token-type:access_token",
    "scope": "https://www.googleapis.com/auth/cloud-platform",
    "subject_token": "'$ID_TOKEN'",
    "subject_token_type": "urn:ietf:params:oauth:token-type:jwt"
}' | python3 -c "import sys;import json; print(json.load(sys.stdin)['access_token'])"`
</code></pre></section>
<section><h3 data-text="Client libraries" id="client-libraries_1">Client libraries</h3><ol>
<li>Create a credential
configuration file named <code dir="ltr" translate="no">oidc_token.txt</code> that the certificate
requesting code can read to perform a token exchange.</li>
</ol>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud iam workload-identity-pools create-cred-config projects/<var translate="no">PROJECT_NUMBER</var>/locations/global/workloadIdentityPools/<var translate="no">IDENTITY_POOL_ID</var> --output-file=/tmp/cred_config.json --credential-source-file=/tmp/oidc_token.txt
</code></pre>
<ol>
<li>Read the <code dir="ltr" translate="no">oidc_token.txt</code> file to set the authorization mechanism in the client
library:</li>
</ol>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="python" id="python">python</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">import json

from google.auth import identity_pool

with open('/tmp/cred_config.json', 'r') as f:
  json_config_info = json.loads(f.read())
credentials = identity_pool.Credentials.from_info(json_config_info)
scoped_credentials = credentials.with_scopes(
    ['https://www.googleapis.com/auth/cloud-platform'])
</code></pre></section>
</div></section>
</div></li>
<li><p>Make a request to CA Service with the
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools.certificates#subjectrequestmode"><code dir="ltr" translate="no">REFLECTED_SPIFFE</code></a> subject request mode:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="curl" id="curl_2">curl</h3><ol>
<li><p>Optional: If you don't have a CSR, create a CSR by executing the
following command.</p>
<aside class="note"><strong>Note:</strong><span> The following command creates a CSR with no subject.
CA Service will add a subject that reflects the certificate requester's
identity.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export TUTORIAL_CSR=$(openssl req -newkey rsa:2048 -nodes -subj / -keyout tutorial_do_not_use.key)
</code></pre>
<!-- TODO(b/207544458): Remove extra $() in command --></li>
<li><p>Request a certificate with the CSR, a lifetime, and a reflected
subject request mode:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -H "Authorization: Bearer $(echo $STS_TOKEN)" https://privateca.googleapis.com/v1/projects/<var translate="no">PROJECT_NUMBER</var>/locations/<var translate="no">LOCATION</var>/caPools/<var translate="no">CA_POOL_ID</var>/certificates\?alt\=json  -X POST -H "Content-Type: application/json" -H 'Accept: application/json' --data '{"lifetime": "100s", "pemCsr": "'$TUTORIAL_CSR'", "subjectMode": "REFLECTED_SPIFFE"}'
</code></pre></li>
</ol></section>
<section><h3 data-text="Client libraries" id="client-libraries_2">Client libraries</h3><p>To forward the first-party token to CA Service, you must
create a credentialed client. You can then use this credentialed client
to make certificate requests:</p>
<ol>
<li><p>Initiate a credentialed CA Service client:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="python" id="python_1">python</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">caServiceClient = privateca_v1.CertificateAuthorityServiceClient(credentials=scoped_credentials)
</code></pre></section>
</div></li>
<li><p>Request a certificate.</p>
<aside class="note"><strong>Note:</strong><span> Make sure to update the <code dir="ltr" translate="no">caServiceClient</code> variable in the
following example to use the credentialed version described in the
previous step.</span></aside>
<p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="privateca_create_certificate-code-sample">
<section>
<h3 data-text="Python" id="privateca_create_certificate-python" track-metadata-position="privateca_create_certificate" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_certificate.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-security-private-ca/blob/HEAD/samples/snippets/create_certificate.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="other" data-context="privateca_create_certificate" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="privateca_create_certificate" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-security-private-ca/samples/snippets/create_certificate.py" data-region-tag="privateca_create_certificate" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-security-private-ca/samples/snippets/create_certificate.py/HEAD/privateca_create_certificate" translate="no"><code dir="ltr" translate="no">import google.cloud.security.privateca_v1 as privateca_v1
from google.protobuf import duration_pb2


def create_certificate(
    project_id: str,
    location: str,
    ca_pool_name: str,
    ca_name: str,
    certificate_name: str,
    common_name: str,
    domain_name: str,
    certificate_lifetime: int,
    public_key_bytes: bytes,
) -&gt; None:
    """
    Create a Certificate which is issued by the Certificate Authority present in the CA Pool.
    The key used to sign the certificate is created by the Cloud KMS.

    Args:
        project_id: project ID or project number of the Cloud project you want to use.
        location: location you want to use. For a list of locations, see: https://cloud.google.com/certificate-authority-service/docs/locations.
        ca_pool_name: set a unique name for the CA pool.
        ca_name: the name of the certificate authority which issues the certificate.
        certificate_name: set a unique name for the certificate.
        common_name: a title for your certificate.
        domain_name: fully qualified domain name for your certificate.
        certificate_lifetime: the validity of the certificate in seconds.
        public_key_bytes: public key used in signing the certificates.
    """

    caServiceClient = privateca_v1.CertificateAuthorityServiceClient()

    # The public key used to sign the certificate can be generated using any crypto library/framework.
    # Also you can use Cloud KMS to retrieve an already created public key.
    # For more info, see: https://cloud.google.com/kms/docs/retrieve-public-key.

    # Set the Public Key and its format.
    public_key = privateca_v1.PublicKey(
        key=public_key_bytes,
        format_=privateca_v1.PublicKey.KeyFormat.PEM,
    )

    subject_config = privateca_v1.CertificateConfig.SubjectConfig(
        subject=privateca_v1.Subject(common_name=common_name),
        subject_alt_name=privateca_v1.SubjectAltNames(dns_names=[domain_name]),
    )

    # Set the X.509 fields required for the certificate.
    x509_parameters = privateca_v1.X509Parameters(
        key_usage=privateca_v1.KeyUsage(
            base_key_usage=privateca_v1.KeyUsage.KeyUsageOptions(
                digital_signature=True,
                key_encipherment=True,
            ),
            extended_key_usage=privateca_v1.KeyUsage.ExtendedKeyUsageOptions(
                server_auth=True,
                client_auth=True,
            ),
        ),
    )

    # Create certificate.
    certificate = privateca_v1.Certificate(
        config=privateca_v1.CertificateConfig(
            public_key=public_key,
            subject_config=subject_config,
            x509_config=x509_parameters,
        ),
        lifetime=duration_pb2.Duration(seconds=certificate_lifetime),
    )

    # Create the Certificate Request.
    request = privateca_v1.CreateCertificateRequest(
        parent=caServiceClient.ca_pool_path(project_id, location, ca_pool_name),
        certificate_id=certificate_name,
        certificate=certificate,
        issuing_certificate_authority_id=ca_name,
    )
    result = caServiceClient.create_certificate(request=request)

    print("Certificate creation result:", result)

</code></pre>
</div>
</section>
</div></p></li>
<li><p>Verify the certificate. Your certificate should have a subject
containing a single URI SAN. The SAN that attests to an identity is
in the following format:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">spiffe://<var translate="no">IDENTITY_POOL_ID</var>.<var translate="no">PROJECT_NUMBER</var>.global.workload.id.goog/subject/&lt;oidc_subject_number&gt;
</code></pre>
<p>Replace:</p>
<ul>
<li><var translate="no">IDENTITY_POOL_ID</var>: The unique identifier of the
workload identity pool.</li>
<li><var translate="no">PROJECT_NUMBER</var> - The project number of the project in
which you created the workload identity pool.</li>
</ul></li>
</ol></section>
</div></li>
</ol>
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>To avoid incurring charges to your Google Cloud account for the
CA Service resources you created following this document, perform
the following operations using the Google Cloud CLI:</p>
<ol>
<li><p>Delete the CA you created.</p>
<ol>
<li><p>Disable the CA:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots disable <var translate="no">CA_ID</var> --pool <var translate="no">CA_POOL_ID</var>  --location <var translate="no">LOCATION</var>
</code></pre>
<p>Replace:</p>
<ul>
<li><var translate="no">CA_ID</var>: The unique identifier of the CA.</li>
<li><var translate="no">CA_POOL_ID</var>: The unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: The location of the CA pool.</li>
</ul></li>
<li><p>Delete the CA:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca roots delete <var translate="no">CA_ID</var> --pool <var translate="no">CA_POOL_ID</var>  --location <var translate="no">LOCATION</var> --ignore-active-certificates
</code></pre>
<p>Replace:</p>
<ul>
<li><var translate="no">CA_ID</var>: The unique identifier of the CA.</li>
<li><var translate="no">CA_POOL_ID</var>: The unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: The location of the CA pool.</li>
</ul></li>
</ol></li>
<li><p>Delete the CA pool you created.</p>
<aside class="note"><strong>Note:</strong><span> You can't delete a CA pool until you have permanently deleted all the
CAs within it. The default expiration time of a CA is 30 days.</span></aside><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools delete <var translate="no">CA_POOL_ID</var> --location <var translate="no">LOCATION</var>
</code></pre>
<p>Replace:</p>
<ul>
<li><var translate="no">CA_POOL_ID</var>: The unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: The location of the CA pool.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools delete</code> command, see
<a href="/sdk/gcloud/reference/privateca/pools/delete">gcloud privateca pools delete</a>.</p></li>
<li><p>Delete the workload identity pool you created:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud iam workload-identity-pools delete <var translate="no">IDENTITY_POOL_ID</var> --location global
</code></pre>
<p>Replace:</p>
<ul>
<li><var translate="no">IDENTITY_POOL_ID</var>: The unique identifier of the workload
identity pool.</li>
</ul></li>
<li><p>Delete the service account that you created:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud iam service-accounts delete <var translate="no">SERVICE_ACCOUNT</var>@<var translate="no">PROJECT_ID</var>.iam.gserviceaccount.com
</code></pre>
<p>Replace:</p>
<ul>
<li><var translate="no">SERVICE_ACCOUNT</var>: The unique identifier of the workload
identity pool.</li>
<li><var translate="no">PROJECT_ID</var>: The project that owns the service account.</li>
</ul></li>
</ol>
<p>The CA Service Workload
Certificate Requester (<code dir="ltr" translate="no">privateca.workloadCertificateRequester</code>)
IAM role restricts the subject of the issued certificate to only
the identity of the requester. Ensure that users or workloads using the identity
reflection feature are only granted the CA Service
Workload Certificate Requester (<code dir="ltr" translate="no">privateca.workloadCertificateRequester</code>)
IAM role. To abide by the principle of least privilege, you can
avoid granting the CA Service Certificate Requester
(<code dir="ltr" translate="no">privateca.certificateRequester</code>) IAM role.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Read about the various <a href="/certificate-authority-service/docs/policy-controls">policy controls</a>
that let you control the properties of the requested certificate beyond a
reflected identity.</li>
<li>Read how you can <a href="/certificate-authority-service/docs/tutorials/manage-policy-controls">configure and manage various policy
controls</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/audit-logging]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Using Cloud Audit Logs with Certificate Authority Service " id="using-cloud-audit-logs-with-certificate-authority-service">Using Cloud Audit Logs with Certificate Authority Service </h1>
<p>This document describes the audit logs created by Certificate Authority Service as part of
<a href="/logging/docs/audit">Cloud Audit Logs</a>.</p>
<h2 data-text="Overview" id="overview">Overview</h2>
<p>Google Cloud services write audit logs to help you answer the questions, "Who
did what, where, and when?" within your Google Cloud resources.</p>
<p>Your Google Cloud projects contain only the audit logs for resources that are
directly within the Cloud project. Other Google Cloud resources,
such as folders, organizations, and billing accounts, contain the audit logs for
the entity itself.</p>
<p>For a general overview of Cloud Audit Logs, see
<a href="/logging/docs/audit">Cloud Audit Logs overview</a>. For a deeper understanding of
the audit log format, see
<a href="/logging/docs/audit/understanding-audit-logs">Understand audit logs</a>.</p>
<h2 data-text="Available audit logs" id="available-logs">Available audit logs</h2>
<p>The following types of audit logs are available for CA Service:</p>
<ul>
<li>
<p>
        Admin Activity audit logs
      </p>
<p>
        Includes "admin write" operations that write metadata or configuration
        information.
      </p>
<p>
        You can't disable Admin Activity audit logs.
      </p>
</li>
<li>
<p>
        Data Access audit logs
      </p>
<p>
        Includes "admin read" operations that read metadata or configuration
        information. Also includes "data read" and "data write" operations that
        read or write user-provided data.
      </p>
<p>
          To receive Data Access audit logs, you must
          <a href="/logging/docs/audit/configure-data-access#config-console-enable">
            explicitly enable</a> them.
        </p>
</li>
</ul>
<p>For fuller descriptions of the audit log types, see
<a href="/logging/docs/audit#types">Types of audit logs</a>.</p>
<h2 data-text="Audited operations" id="audited_operations">Audited operations</h2>
<p>The following summarizes which API operations correspond to each audit log
type in CA Service:</p>
<p>
<table>
<thead>
<tr>
<th>Audit logs category</th>
<th>CA Service operations</th>
</tr>
</thead>
<tbody>
<tr>
<td>Admin Activity audit logs</td>
<td><code dir="ltr" translate="no">privateca.certificateAuthorities.create</code><br/><code dir="ltr" translate="no">privateca.certificateAuthorities.update</code><br/><code dir="ltr" translate="no">privateca.certificateAuthorities.delete</code><br/><code dir="ltr" translate="no">privateca.caPools.create</code><br/><code dir="ltr" translate="no">privateca.caPools.update</code><br/><code dir="ltr" translate="no">privateca.caPools.delete</code><br/><code dir="ltr" translate="no">privateca.certificateTemplates.create</code><br/><code dir="ltr" translate="no">privateca.certificateTemplates.update</code><br/><code dir="ltr" translate="no">privateca.certificateTemplates.delete</code></td>
</tr>
<tr>
<td>Data Access audit logs</td>
<td><code dir="ltr" translate="no">privateca.certificateAuthorities.list</code><br/><code dir="ltr" translate="no">privateca.certificateAuthorities.get</code><br/><code dir="ltr" translate="no">privateca.caPools.list</code><br/><code dir="ltr" translate="no">privateca.caPools.get</code><br/><code dir="ltr" translate="no">privateca.certificates.create</code><br/><code dir="ltr" translate="no">privateca.certificates.get</code><br/><code dir="ltr" translate="no">privateca.certificates.update</code><br/><code dir="ltr" translate="no">privateca.certificates.list</code><br/><code dir="ltr" translate="no">privateca.certificateTemplates.list</code><br/><code dir="ltr" translate="no">privateca.certificateTemplates.get</code><br/><code dir="ltr" translate="no">privateca.certificateRevocationLists.list</code><br/><code dir="ltr" translate="no">privateca.certificateRevocationLists.update</code><br/><code dir="ltr" translate="no">privateca.certificateRevocationLists.get</code></td>
</tr>
</tbody>
</table>
</p>
<h2 data-text="Audit log format" id="audit_log_format">Audit log format</h2>
<p>Audit log entries include the following objects:</p>
<ul>
<li><p>The log entry itself, which is an object of type <a href="/logging/docs/reference/v2/rest/v2/LogEntry"><code dir="ltr" translate="no">LogEntry</code></a>.
Useful fields include the following:</p>
<ul>
<li>The <code dir="ltr" translate="no">logName</code> contains the resource ID and audit log type.</li>
<li>The <code dir="ltr" translate="no">resource</code> contains the target of the audited operation.</li>
<li>The <code dir="ltr" translate="no">timeStamp</code> contains the time of the audited operation.</li>
<li>The <code dir="ltr" translate="no">protoPayload</code> contains the audited information.</li>
</ul></li>
<li><p>The audit logging data, which is an <a href="/logging/docs/reference/audit/auditlog/rest/Shared.Types/AuditLog"><code dir="ltr" translate="no">AuditLog</code></a> object held in
the <code dir="ltr" translate="no">protoPayload</code> field of the log entry.</p></li>
<li><p>Optional service-specific audit information, which is a service-specific
object. For earlier integrations, this object is held in the <code dir="ltr" translate="no">serviceData</code>
field of the <code dir="ltr" translate="no">AuditLog</code> object; later integrations use the <code dir="ltr" translate="no">metadata</code> field.</p></li>
</ul>
<p>For other fields in these objects, and how to interpret them, review
<a href="/logging/docs/audit/understanding-audit-logs">Understand audit logs</a>.</p>
<h3 data-text="Log name" id="log_name">Log name</h3>
<p>Cloud Audit Logs log names include resource identifiers indicating the
Cloud project or other Google Cloud entity that owns the audit
logs, and whether the log contains Admin Activity, Data Access, Policy Denied,
or System Event audit logging data.</p>
<p>The following are the audit log names, including variables for the resource
identifiers:</p>
<pre class="devsite-click-to-copy" dir="ltr" lang-sql="" translate="no">
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy

   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy

   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy

   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy
</pre>
<aside class="note"><strong>Note:</strong><span> The part of the log name following <code dir="ltr" translate="no">/logs/</code> must be URL-encoded. The
forward-slash character, <code dir="ltr" translate="no">/</code>, must be written as <code dir="ltr" translate="no">%2F</code>.</span></aside>
<h3 data-text="Service name" id="service_name">Service name</h3>
<p>
CA Service audit logs use the service name
<code dir="ltr" translate="no">privateca.googleapis.com</code>.
</p>
<p>For a list of all the Cloud Logging API service names and their corresponding
monitored resource type, see
<a href="/logging/docs/api/v2/resource-list#service-names">Map services to resources</a>.</p>
<h3 data-text="Resource types" id="resource_types">Resource types</h3>
<p>
CA Service audit logs use the resource type
<code dir="ltr" translate="no">audited_resource</code> for all audit logs.
</p>
<p>For a list of all the Cloud Logging monitored resource types and descriptive
information, see
<a href="/logging/docs/api/v2/resource-list#resource-types">Monitored resource types</a>.</p>
<h2 data-text="Enable audit logging" id="enabling_audit_logging">Enable audit logging</h2>
<p>Admin Activity audit logs are always enabled; you can't disable them.</p>
<p>Data Access audit logs are disabled by default and aren't written unless
explicitly enabled (the exception is Data Access audit logs for
BigQuery, which can't be disabled).</p>
<p>For information about enabling some or all of your Data Access audit logs, see
<a href="/logging/docs/audit/configure-data-access">Configure Data Access audit logs</a>.</p>
<h2 data-text="Permissions and roles" id="audit_log_permissions">Permissions and roles</h2>
<p><a href="/iam/docs">IAM</a> permissions and roles determine your ability to
access audit logs data in Google Cloud resources.</p>
<p>When deciding which
<a href="/logging/docs/access-control#permissions_and_roles">Logging-specific permissions and roles</a>
apply to your use case, consider the following:</p>
<ul>
<li><p>The Logs Viewer role (<code dir="ltr" translate="no">roles/logging.viewer</code>) gives you read-only access to
Admin Activity, Policy Denied, and System Event audit logs. If you have just
this role, you cannot view Data Access audit logs that are in the
<code dir="ltr" translate="no">_Required</code> and <code dir="ltr" translate="no">_Default</code> buckets.</p></li>
<li><p>The Private Logs Viewer role<code dir="ltr" translate="no">(roles/logging.privateLogViewer</code>) includes the
permissions contained in <code dir="ltr" translate="no">roles/logging.viewer</code>, plus the ability to read
Data Access audit logs in the <code dir="ltr" translate="no">_Required</code> and <code dir="ltr" translate="no">_Default</code> buckets.</p>
<p>Note that if these private logs are stored in user-defined buckets, then any
user who has permissions to read logs in those buckets can read the private
logs. For more information about log buckets, see
<a href="/logging/docs/routing/overview">Routing and storage overview</a>.</p></li>
</ul>
<p>For more information about the IAM permissions and roles that
apply to audit logs data, see
<a href="/logging/docs/access-control">Access control with IAM</a>.</p>
<h2 data-text="View logs" id="viewing_logs">View logs</h2>
<p>To query for audit logs, you need to know the <a href="#log_name">audit log name</a>, which includes the
<a href="/resource-manager/docs/creating-managing-projects#identifying_projects">resource identifier</a>
of the Cloud project, folder, billing account, or
organization for which you want to view audit logging information. In your
query, you can further specify other indexed <a href="/logging/docs/reference/v2/rest/v2/LogEntry"><code dir="ltr" translate="no">LogEntry</code></a> fields, such
as <code dir="ltr" translate="no">resource.type</code>. For more information on querying, see
<a href="/logging/docs/view/building-queries">Build queries in the Logs Explorer</a>.</p>


You can view audit logs in Cloud Logging by using the
Cloud console, the Google Cloud CLI, or the Logging API.



<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><p>In the Cloud console, you can use the Logs Explorer
to retrieve your audit log entries for your Cloud project, folder,
or organization:</p>
<aside class="note"><strong>Note:</strong><span> You can't view audit logs for Cloud Billing accounts in the
Cloud console. You must use the API or the gcloud CLI.</span></aside>
<ol>
<li><p>In the Cloud console, go to the
<strong>Logging<span aria-label="and then">&gt;</span> Logs Explorer</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/logs/query" target="console">Go to Logs Explorer</a> </p></li>
<li><p>Select an existing Cloud project, folder, or organization.</p></li>
<li><p>In the <strong>Query builder</strong> pane, do the following:</p>
<ul>
<li><p>In <strong>Resource type</strong>, select the Google Cloud resource whose
audit logs you want to see.</p></li>
<li><p>In <strong>Log name</strong>, select the audit log type that you want to see:</p>
<ul>
<li>For Admin Activity audit logs, select <strong>activity</strong>.</li>
<li>For Data Access audit logs, select <strong>data_access</strong>.</li>
<li>For System Event audit logs, select <strong>system_event</strong>.</li>
<li>For Policy Denied audit logs, select <strong>policy</strong>.</li>
</ul></li>
</ul>
<p>If you don't see these options, then there aren't any audit logs of
that type available in the Cloud project, folder, or
organization.</p>
<p>If you're experiencing issues when trying to view logs in the
Logs Explorer, see the
<a href="/logging/docs/view/logs-explorer-interface#troubleshooting">troubleshooting</a>
information.</p>
<p>For more information about querying by using the Logs Explorer, see
<a href="/logging/docs/view/building-queries">Build queries in the Logs Explorer</a>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>The Google Cloud CLI provides a command-line interface to the
Logging API. Supply a valid resource identifier in each of the log
names. For example, if your query includes a <var translate="no">PROJECT_ID</var>, then the
project identifier you supply must refer to the currently selected
Cloud project.</p>
<p>To read your Cloud project-level audit log entries, run
the following command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com" \
    --project=<var translate="no">PROJECT_ID</var>
</pre>
<p>To read your folder-level audit log entries, run the following command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com" \
    --folder=<var translate="no">FOLDER_ID</var>
</pre>
<p>To read your organization-level audit log entries, run the following
command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com" \
    --organization=<var translate="no">ORGANIZATION_ID</var>
</pre>
<p>To read your Cloud Billing account-level audit log entries, run the following command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com" \
    --billing-account=<var translate="no">BILLING_ACCOUNT_ID</var>
</pre>
<p>Add the <a href="/sdk/gcloud/reference/logging/read#--freshness"><code dir="ltr" translate="no">--freshness</code> flag</a>
to your command to read logs that are more than 1 day old.</p>
<p>For more information about using the gcloud CLI, see
<a href="/sdk/gcloud/reference/logging/read"><code dir="ltr" translate="no">gcloud logging read</code></a>.</p></section>
<section><h3 data-text="API" id="api">API</h3><p>When building your queries, supply a valid resource identifier in each of
the log names. For example, if your query includes a <var translate="no">PROJECT_ID</var>,
then the project identifier you supply must refer to the currently selected
Cloud project.</p>
<p>For example, to use the Logging API to view your project-level
audit log entries, do the following:</p>
<ol>
<li><p>Go to the <strong>Try this API</strong> section in the documentation for the
<a href="/logging/docs/reference/v2/rest/v2/entries/list"><code dir="ltr" translate="no">entries.list</code></a>
method.</p></li>
<li><p>Put the following into the <strong>Request body</strong> part of the <strong>Try this
API</strong> form. Clicking this <a href="/logging/docs/reference/v2/rest/v2/entries/list?apix_params=%7B%22resource%22%3A%7B%22resourceNames%22%3A%5B%22projects%2F%5BPROJECT_ID%5D%22%5D%2C%22pageSize%22%3A5%2C%22filter%22%3A%22logName%3D(projects%2F%5BPROJECT_ID%5D%2Flogs%2Fcloudaudit.googleapis.com%252Factivity%20OR%20projects%2F%5BPROJECT_ID%5D%2Flogs%2Fcloudaudit.googleapis.com%252Fsystem_events%20OR%20projects%2F%5BPROJECT_ID%5D%2Flogs%2Fcloudaudit.googleapis.com%252Fdata_access)%22%7D%7D">prepopulated form</a>
automatically fills the request body, but you need to supply a valid
<var translate="no">PROJECT_ID</var> in each of the log names.</p>
<pre class="devsite-click-to-copy" dir="ltr" lang-html="" translate="no">
{
  "resourceNames": [
    "projects/<var translate="no">PROJECT_ID</var>"
  ],
  "pageSize": 5,
  "filter": "logName : projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com"
}
</pre></li>
<li><p>Click <strong>Execute</strong>.</p></li>
</ol></section>
</div>
<h2 data-text="Route audit logs" id="exporting_audit_logs">Route audit logs</h2>
<p>You can <a href="/logging/docs/routing/overview">route audit logs</a> to supported
destinations in the same way that you can route other kinds of logs. Here are
some reasons you might want to route your audit logs:</p>
<ul>
<li><p>To keep audit logs for a longer period of time or to use more powerful
search capabilities, you can route copies of your audit logs to
Cloud Storage, BigQuery, or Pub/Sub. Using
Pub/Sub, you can route to other applications, other
repositories, and to third parties.</p></li>
<li><p>To manage your audit logs across an entire organization, you can create
<a href="/logging/docs/export/aggregated_sinks">aggregated sinks</a> that can
route logs from any or all Cloud projects in the organization.</p></li>
</ul>
<ul>
<li>If your enabled Data Access audit logs are pushing your
Cloud projects over your log allotments, you can create sinks that
exclude the Data Access audit logs from Logging.</li>
</ul>
<p>For instructions about routing logs, see
<a href="/logging/docs/export/configure_export_v2">Configure and manage sinks </a>.</p>
<h2 data-text="Pricing" id="pricing">Pricing</h2>
<p>For information about Cloud Logging pricing, see
<a href="/stackdriver/pricing#logging-costs">Google Cloud's operations suite pricing: Cloud Logging</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/monitoring]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Using Cloud Monitoring with Certificate Authority Service" id="using-cloud-monitoring-with-certificate-authority-service">Using Cloud Monitoring with Certificate Authority Service</h1>
<p><a href="/monitoring">Cloud Monitoring</a> can be used to monitor operations performed on
resources in Certificate Authority Service.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>If you haven't already done so,
set up a Google Cloud project that has the Certificate Authority Service API enabled.
These steps are documented in the <a href="/certificate-authority-service/docs/create-certificate#before-you-begin">CA Service Quickstart</a>.</p>
<h2 data-text="Viewing metrics in Cloud Monitoring" id="viewing_metrics_in">Viewing metrics in Cloud Monitoring</h2>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><p>
<p>To use Metrics Explorer to view the metrics for a monitored resource, follow these steps:</p>
<ol>
<li>In the Google Cloud console, go to the Metrics Explorer page within
      Monitoring.</li>
<p><a class="button button-primary" href="https://console.cloud.google.com/monitoring/metrics-explorer" target="console">Go to Metrics Explorer</a></p>
<li>In the toolbar, select the <b>Explorer</b> tab.</li>
<li>Select the <b>Configuration</b> tab.</li>
<li>Expand the <b>Select a metric</b> menu, enter <code dir="ltr" translate="no">Certificate Authority</code>
    in the filter bar, and then use the submenus to select a specific resource type and metric:
    
    <ol>
<li>In the <b>Active resources</b> menu, select <a href="/monitoring/api/resources#tag_privateca.googleapis.com/CertificateAuthority"><b>Certificate Authority</b></a>.</li>
<li>To select a metric, use the <b>Active metric categories</b> and <b>Active metrics</b> menus.
        
        For a list of metrics, see
<a href="/monitoring/api/metrics_gcp#gcp-privateca"><strong>privateca metrics</strong></a>.
        
      </li>
<li>Click <b>Apply</b>.</li>
</ol>
</li>
<li>Optional: To configure how the data is viewed, add filters and use the
       <b>Group By</b>, <b>Aggregator</b>, and chart-type menus.
      
      For example, you can group by resource or metric labels.
      
      For more information, see
      <a href="/monitoring/charts/metrics-selector">Select metrics when using Metrics Explorer</a>.
  </li>
<li>Optional: Change the graph settings:
    <ul>
<li>For quota and other metrics that report one sample per day, set
          the time frame to at least one week and
          set the plot type to <b>Stacked bar chart</b>.</li>
<li>For distribution valued metrics, set the plot type to <b>Heatmap chart</b>.</li>
</ul>
</li>
</ol>
</p></section>
</div>
<h2 data-text="CA Service metrics" id="metrics">CA Service metrics</h2>
<p>The list of metrics can be viewed in Cloud Monitoring
<a href="/monitoring/api/metrics_gcp#gcp-privateca" target="_blank">documentation</a>.</p>
<p>The monitored resource documentation can be viewed in <a href="/monitoring/api/resources#tag_privateca.googleapis.com/CertificateAuthority" target="_blank">Monitored resources</a>.</p>
<h2 data-text="Enabling Recommended Alerts" id="enabling_recommended_alerts">Enabling Recommended Alerts</h2>
<p>Use the following instructions to enable recommended alerts.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>Go to the CA Service Overview page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas/overview" target="console" track-name="consoleLink" track-type="quickstart">Certificate Authority Service</a> </p></li>
<li><p>On the top right of the Overview page, click the <strong>+ 5 Recommended Alerts</strong>.</p></li>
<li><p>Enable or disable each alert, reading its description.</p>
<ul>
<li>Some alerts support custom thresholds. For example, you can specify
when you want to be alerted for an expiring CA certificate, or the
error rate for a high rate of certificate creation failures.</li>
<li>All alerts support <a href="/monitoring/support/notification-options">notification channels</a>.</li>
</ul></li>
<li><p>Click <strong>Submit</strong> once you have enabled all desired alerts.</p></li>
</ol></section>
</div>
<h2 data-text="Create an alerting policy" id="create_an_alerting_policy">Create an alerting policy</h2>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_2">Console</h3><p>
<p>You can create alerting policies to monitor the values of metrics and to notify you when
  those metrics violate a condition. The following steps are for the preview alerting interface.
</p>
<ol>
<li>In the Google Cloud console, go to the <b>Monitoring</b> page.
  <p><a class="button button-primary" href="https://console.cloud.google.com/monitoring" target="console">Go to Monitoring</a></p>
</li>
<li>In the Monitoring navigation pane, select
    <i aria-hidden="true" class="material-icons" translate="no">notifications</i><b>Alerting</b>.</li>
<li>If you haven't created your notification channels and if you want to be notified, then click
      <b>Edit Notification Channels</b> and add your notification channels. Return to the
      <b>Alerting</b> page after you add your channels.
  <li>From the <b>Alerting</b> page, select <b>Create policy</b>.</li>
<li>To select the metric, expand the <b>Select a metric</b> menu and then do the following:

        

        <ol>
<li>To limit the menu to relevant entries, enter <code dir="ltr" translate="no">Certificate Authority</code>
              into the filter bar. If there are no results after you filter the menu, then disable
              the <b>Show only active resources &amp; metrics</b> toggle.

          </li>
<li>For the <b>Resource type</b>, select <a href="/monitoring/api/resources#tag_privateca.googleapis.com/CertificateAuthority"><b>Certificate Authority</b></a>.</li>
<li>For the <b>Metric category</b>, select <b>Ca</b>.</li>
<li>For the <b>Metric</b>, select a metric from the <a href="/monitoring/api/metrics_gcp#gcp-privateca"><b>list of privateca metrics</b></a>.</li>
<li>Select <b>Apply</b>.</li>
</ol>
</li>
<li>Click <b>Next</b>.</li>
<li>The settings in the <b>Configure alert trigger</b> page determine when the alert is triggered.

      
      Select a condition type and, if necessary, specify a threshold. For more
      information, see
      <a href="/monitoring/alerts/using-alerting-ui#configure-trigger">Condition trigger</a>.
      
  </li>
<li>Click <b>Next</b>.</li>
<li>Optional: To add notifications to your alerting policy, click
      <b>Notification channels</b>. In the dialog, select one or more notification
      channels from the menu, and then click <b>OK</b>.</li>
<li>Optional: Update the <b>Incident autoclose duration</b>. This field determines when
      Monitoring closes incidents in the absence of metric data.</li>
<li>Optional: Click <b>Documentation</b>, and then add any information that you
      want included in a notification message.</li>
<li>Click <b>Alert name</b> and enter a name for the alerting policy.</li>
<li>Click <b>Create Policy</b>.</li>
</li></ol>

For more information, see <a href="/monitoring/alerts">Alerting policies</a>.
</p></section>
</div>
<h2 data-text="Create Pub/Sub notification channel" id="create_notification_channel">Create Pub/Sub notification channel</h2>
<p>A notification channel that publishes events to Pub/Sub can be set up
by following <a href="/monitoring/support/notification-options#pubsub">these instructions</a>.</p>
<h2 data-text="Sample alert policies" id="sample_alert_policies">Sample alert policies</h2>
<p>You can use the following sample alert policies for common
CA Service monitoring use cases.</p>
<p>To learn more about alert policies, see the <a href="/monitoring/api/ref_v3/rest/v3/projects.alertPolicies">documentation</a>.</p>
<h3 data-text="CA expiring in 30 days" id="ca_expiring_in_30_days">CA expiring in 30 days</h3>
<p>This alert policy notifies you 30 days before a managed CA expires. This
policy creates alert notifications for all managed CAs across all projects
whose metrics are visible to the Google Cloud project selected in the
Google Cloud console project picker. For information about metric visibility,
see <a href="/monitoring/settings#concept-scope">Understanding metrics scope</a>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3><p>
</p>
<p>You can create alerting policies to monitor the values of metrics and to notify you when
  those metrics violate a condition. The following steps are for the preview alerting interface.
</p>
<ol>
<li>In the Google Cloud console, go to the <b>Monitoring</b> page.
  <p><a class="button button-primary" href="https://console.cloud.google.com/monitoring" target="console">Go to Monitoring</a></p>
</li>
<li>In the Monitoring navigation pane, select
    <i aria-hidden="true" class="material-icons" translate="no">notifications</i><b>Alerting</b>.</li>
<li>If you haven't created your notification channels and if you want to be notified, then click
      <b>Edit Notification Channels</b> and add your notification channels. Return to the
      <b>Alerting</b> page after you add your channels.
  <li>From the <b>Alerting</b> page, select <b>Create policy</b>.</li>
<li>To select the metric, expand the <b>Select a metric</b> menu and then do the following:

        

        <ol>
<li>To limit the menu to relevant entries, enter <code dir="ltr" translate="no">Certificate Authority</code>
              into the filter bar. If there are no results after you filter the menu, then disable
              the <b>Show only active resources &amp; metrics</b> toggle.

          </li>
<li>For the <b>Resource type</b>, select <a href="/monitoring/api/resources#tag_privateca.googleapis.com/CertificateAuthority"><b>Certificate Authority</b></a>.</li>
<li>For the <b>Metric category</b>, select <b>Ca</b>.</li>
<li>For the <b>Metric</b>, select <b>ca/cert_expiration</b>.</li>
<li>Select <b>Apply</b>.</li>
</ol>
</li>
<li>Click <b>Next</b>.</li>
<li>The settings in the <b>Configure alert trigger</b> page determine when the alert is triggered.

      
      Complete this page with the settings in the following table.<br/>
<table>
<thead>
<tr>
<th width="45%"><strong>Configure alert trigger</strong> page<br/>Field</th>
<th><br/>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code dir="ltr" translate="no">Condition type</code></strong></td>
<td><code dir="ltr" translate="no">Threshold</code></td>
</tr>
<tr>
<td><strong><code dir="ltr" translate="no">Alert trigger</code></strong></td>
<td><code dir="ltr" translate="no">Any time series violates</code></td>
</tr>
<tr>
<td><strong><code dir="ltr" translate="no">Threshold position</code></strong></td>
<td><code dir="ltr" translate="no">Below threshold</code></td>
</tr>
<tr>
<td><strong><code dir="ltr" translate="no">Threshold value</code></strong></td>
<td><code dir="ltr" translate="no">2592000000 ms</code></td>
</tr>
<tr>
<td><strong><code dir="ltr" translate="no">Advanced Options: Retest window</code></strong></td>
<td><code dir="ltr" translate="no">No retest</code></td>
</tr>
</tbody>
</table>
</li>
<li>Click <b>Next</b>.</li>
<li>Optional: To add notifications to your alerting policy, click
      <b>Notification channels</b>. In the dialog, select one or more notification
      channels from the menu, and then click <b>OK</b>.</li>
<li>Optional: Update the <b>Incident autoclose duration</b>. This field determines when
      Monitoring closes incidents in the absence of metric data.</li>
<li>Optional: Click <b>Documentation</b>, and then add any information that you
      want included in a notification message.</li>
<li>Click <b>Alert name</b> and enter a name for the alerting policy.</li>
<li>Click <b>Create Policy</b>.</li>
</li></ol>

For more information, see <a href="/monitoring/alerts">Alerting policies</a>.
</section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>Paste the following policy into a file named <code dir="ltr" translate="no">ca-expiration-policy.yaml</code>:</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">combiner: OR
conditions:
- conditionThreshold:
    aggregations:
    - alignmentPeriod: 60s
      perSeriesAligner: ALIGN_MEAN
    comparison: COMPARISON_LT
    duration: 0s
    filter: metric.type="privateca.googleapis.com/ca/cert_expiration" resource.type="privateca.googleapis.com/CertificateAuthority"
    thresholdValue: 2592000.0
    trigger:
      count: 1
  displayName: CA certificate expiration
displayName: CA expiring in 30 days
enabled: true
</code></pre>
<p>Create the alert policy with the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud alpha monitoring policies create --policy-from-file ca-expiration-policy.yaml
</code></pre>
<p>After creating the alert policy, follow <a href="/monitoring/alerts/using-channels-api">Managing notification channels</a>
to create or update existing notification channels, if desired. To add a
notification channel to an existing alert policy, follow
<a href="/monitoring/alerts/using-alerting-api#api-replace-channels">Updating notification channels in a policy</a>.</p></section>
</div>
<h3 data-text="High rate of certificate creation failures" id="high_rate_of_certificate_creation_failures">High rate of certificate creation failures</h3>
<p>This alert policy notifies you when the ratio of certificate creation
failures, due to either CA policy or validation failure, exceeds a threshold
of <code dir="ltr" translate="no">0.2</code>. This
policy creates alert notifications for all managed CAs across all projects
whose metrics are visible to the Google Cloud project selected in the
Google Cloud console project picker. For information about metric visibility,
see <a href="/monitoring/settings#concept-scope">Understanding metrics scope</a>.</p>
<aside class="note"><strong>Note:</strong><span> Editing the conditions of a <a href="/monitoring/alerts/policies-in-json#json-ratio">metric ratio policy</a> is only supported
through the gcloud CLI. Once the policy has been created, you can
edit the policy's description and add notification channels through the
Cloud console however.</span></aside><div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>Paste the following policy into a file named <code dir="ltr" translate="no">cert-create-failure.yaml</code>:</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">displayName: High rate of certificate creation failures
enabled: true
combiner: OR
conditions:
- conditionThreshold:
    filter: metric.type="privateca.googleapis.com/ca/cert/create_failure_count" resource.type="privateca.googleapis.com/CertificateAuthority"
    aggregations:
    - alignmentPeriod: 300s
      crossSeriesReducer: REDUCE_SUM
      groupByFields:
      - resource.label.resource_container
      - resource.label.location
      - resource.label.certificate_authority_id
      perSeriesAligner: ALIGN_DELTA
    denominatorFilter: metric.type="privateca.googleapis.com/ca/cert/create_request_count"
      resource.type="privateca.googleapis.com/CertificateAuthority"
    denominatorAggregations:
    - alignmentPeriod: 300s
      perSeriesAligner: ALIGN_DELTA
    comparison: COMPARISON_GT
    duration: 0s
    thresholdValue: 0.2
    trigger:
      count: 1
  displayName: 'Ratio: Certificate creation CA policy error count / Total certificate creation request count'
</code></pre>
<p>Create the alert policy with the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud alpha monitoring policies create --policy-from-file cert-create-failure.yaml
</code></pre>
<p>After creating the alert policy, follow <a href="/monitoring/alerts/using-channels-api">Managing notification channels</a>
to create or update existing notification channels, if desired. To add a
notification channel to an existing alert policy, follow
<a href="/monitoring/alerts/using-alerting-api#api-replace-channels">Updating notification channels in a policy</a>.</p></section>
</div>
<h4 data-text="What this policy does" id="what_this_policy_does">What this policy does</h4>
<p>This policy computes the ratio of failures to total requests. The policy
triggers an alert notification if the ratio goes above 20% (that is, the ratio
is greater than 0.2) over the 5-minute alignment period.</p>
<p>The filter in the condition selects the number of certificate creation failures,
which is the numerator in the ratio. The numerator aggregates by project,
location, and CA resource ID, since this metric has additional labels. The
denominator filter in the condition selects the number of certificate
creation requests.</p>
<p>Once the threshold is reached, the policy triggers the alert notification
immediately, since the permitted duration for the condition is 0 seconds. This
policy uses a trigger count of 1, which is the number of time series that needs
to violate the condition to trigger the alert notification.</p>
<h2 data-text="Monitoring gauge metrics" id="monitoring_gauge_metrics">Monitoring gauge metrics</h2>
<p>Gauge metrics measure a value at a specific instant in time. For example,
 <code dir="ltr" translate="no">privateca.googleapis.com/ca/resource_state</code> or
<code dir="ltr" translate="no">privateca.googleapis.com/kms/key_issue</code> are gauge metrics. These metrics use a
boolean value, while using labels to provide additional information. For
example, <code dir="ltr" translate="no">privateca.googleapis.com/ca/resource_state</code> uses a boolean for
whether the CA state is enabled, but uses a label, <code dir="ltr" translate="no">state</code>, for the
actual resource state.</p>
<p>When monitoring gauge metrics that use boolean values, we recommend
that you use the <code dir="ltr" translate="no">COUNT</code> aggregator to build alert thresholds. The <code dir="ltr" translate="no">SUM</code>
aggregator only sums the boolean values, whereas the <code dir="ltr" translate="no">COUNT</code> aggregator sums the
number of time series. For example, if you want to determine the number of CAs
that are in the <code dir="ltr" translate="no">DISABLED</code> state, you should create a filter for
<code dir="ltr" translate="no">state=DISABLED</code>. Use the <code dir="ltr" translate="no">COUNT</code> aggregator to determine the number of CAs
that match this condition.</p>
<h2 data-text="Cloud Monitoring cost" id="cost">Cloud Monitoring cost</h2>
<p>There is no cost for monitoring CA Service.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><a href="/monitoring">Cloud Monitoring</a></li>
<li><a href="/monitoring/api/metrics_gcp#gcp-privateca">CA Service metrics</a></li>
<li><a href="/monitoring/support/notification-options#pubsub">Managing notification channels</a></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/solutions]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="samples">
<header>
<h2 data-text="Sample solutions" id="sample-solutions">Sample solutions</h2>
</header>
<ul class="card-showcase">
<!-- TODO(peteman): Uncomment this after README updates are done on that repo. -->
<!--     
    
    

    
<li>
  <a href="/certificate-authority-service/docs/automatic-cert-renewal" class="no-logo">
    <h3 class="hide-from-toc no-link" id="endpoint-tls-certificate-renewal" data-text="Endpoint TLS certificate renewal">Endpoint TLS certificate renewal</h3>
   <p>
    Shows how to configure a script to auto-renew your TLS certificates for your
    GCP endpoints using Certificate Authority Service.
    </p>
  </a>
</li>






 -->
<li>
<a class="no-logo" href="/certificate-authority-service/docs/gclb-rotation-tool">
<h3 class="hide-from-toc no-link" data-text="Use the GCLB rotation tool" id="use-the-gclb-rotation-tool">Use the GCLB rotation tool</h3>
<p>
    Learn how you can use the GCLB rotation tool to periodically check the
    status of SSL proxy load balancers and rotate their certificates.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/ocsp-support">
<h3 class="hide-from-toc no-link" data-text="Implement a delegated OCSP responder" id="implement-a-delegated-ocsp-responder">Implement a delegated OCSP responder</h3>
<p>
    Learn how you can implement a delegated OCSP responder for your certificate
    authority.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/gclb-rotation-tool]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Use the GCLB rotation tool" id="use-the-gclb-rotation-tool">Use the GCLB rotation tool</h1>
<aside class="caution">
  This page contains a sample provided for demonstration purposes. Google does
  not officially support this sample. We recommend that you carefully evaluate
  any solution before deploying it in your production environment.
</aside>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<p>This solution assumes that you have created a certificate authority (CA) pool
that has one or more certificate authorities (CAs). For information about
creating a CA pool, see <a href="/certificate-authority-service/docs/creating-ca-pool">Creating CA pools</a>. For information
about creating CAs, see <a href="/certificate-authority-service/docs/creating-certificate-authorities">Creating certificate
authorities</a>.</p>
<h2 data-text="Why use this tool" id="why">Why use this tool</h2>
<p>Certificate expiry is one of the main sources of service outages in the industry.
Even large and well-established companies have suffered from this in recent years.</p>
<p>Here are some examples of possible outages that certificate expiration can cause:</p>
<ul>
<li>When certificates on routers expire, users aren't able to log in to WiFi
networks.</li>
<li>When a website certificate expires, users aren't able to connect to that
website anymore.</li>
</ul>
<p>You can configure the GCLB rotation tool to periodically check the status of
SSL proxy load balancers and rotate their certificates using
CA Service when they reach a given threshold. You can use a YAML
config file to configure the load balancer, issuing CA, and certificate profile.</p>
<h2 data-text="Where to find this tool" id="where">Where to find this tool</h2>
<p>This sample solution can be found here: <a href="https://github.com/GoogleCloudPlatform/cas-gclb-rotation" track-name="gitHubLink" track-type="solution">GitHub: GCLB rotation tool for
Certificate Authority Service</a>.</p>
<p>For information about how you can get started with using this sample solution,
see its <a href="https://github.com/GoogleCloudPlatform/cas-gclb-rotation/blob/main/README.md#quickstart-for-a-local-run" track-name="gitHubLink" track-type="solution">quickstart</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/ocsp-support]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Implement a delegated OCSP responder" id="implement-a-delegated-ocsp-responder">Implement a delegated OCSP responder</h1>
<aside class="caution">
  This page contains a sample provided for demonstration purposes. Google does
  not officially support this sample. We recommend that you carefully evaluate
  any solution before deploying it in your production environment.
</aside>
<p>This document provides information about the Online Certificate Status Protocol (OCSP)
responder that you can use to check the revocation status of certificates
issued using Certificate Authority Service. For more information about the tool, see <a class="external" href="https://github.com/googlecloudplatform/gcp-ca-service-ocsp" track-name="gitHubLink" track-type="solution">OCSP responder for
CA Service</a>.</p>
<h2 data-text="What is Online Certificate Status Protocol (OCSP)?" id="what-ocsp">What is Online Certificate Status Protocol (OCSP)?</h2>
<p><a class="external" href="https://wikipedia.org/wiki/Online_Certificate_Status_Protocol">OCSP</a> is a protocol for obtaining the revocation status for
an X.509 certificate. When a user requests information about the validity of a
certificate, a request is sent to an OCSP responder. The OCSP responder checks
the status of the certificate with a trusted certificate authority (CA) and
sends back an OCSP response.</p>
<h2 data-text="Why use a delegated OCSP responder?" id="why-ocsp">Why use a delegated OCSP responder?</h2>
<p>Tracking certificate revocation status using OCSP can have many benefits.
These include quicker response time and smaller requirement for network
bandwidth, as compared to Certificate Revocation Lists (CRLs), which can get
quite large.</p>
<h2 data-text="How does the OCSP responder work?" id="ocsp-work">How does the OCSP responder work?</h2>
<p>The OCSP responder pre-generates an OCSP response
for each certificate that a particular CA issues. The pre-generated
responses are saved as individual files in a Cloud Storage bucket.</p>
<p>You can deploy a Cloud Run service that regenerates these files
on-demand or on a schedule. The Cloud Run service is essentially the
<em>frontend</em> for the OCSP server.</p>
<p>You can use <a href="/cdn/docs/overview">Cloud CDN</a> to forward requests to Cloud Run and cache
OCSP responses. For more information, see <a href="/cdn/docs/setting-up-cdn-with-serverless">Setting up Cloud CDN with Cloud Run</a>.</p>
<p>For instructions about configuring an OCSP responder with CA Service,
see the <a class="external" href="https://github.com/GoogleCloudPlatform/gcp-ca-service-ocsp/blob/master/README.md" track-name="gitHubLink" track-type="solution">README: OCSP responder for
CA Service</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/third-party-tools]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="samples">
<header>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/certificate-authority-service/docs/hashicorp-integration">
<h3 class="hide-from-toc no-link" data-text="Use Hashicorp Vault CA with Certificate Authority Service" id="use-hashicorp-vault-ca-with-certificate-authority-service">Use Hashicorp Vault CA with Certificate Authority Service</h3>
<p>
    Learn how to configure Hashicorp Vault to act as a proxy that
    forwards all certificate issuance requests to CA Service.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/certificate-authority-service/docs/cert-manager">
<h3 class="hide-from-toc no-link" data-text="Manage certificate lifecycle using cert-manager" id="manage-certificate-lifecycle-using-cert-manager">Manage certificate lifecycle using cert-manager</h3>
<p>
    Learn how to use Jetstack cert-manager with CA Service.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/hashicorp-integration]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Use Hashicorp Vault CA with CA Service" id="use-hashicorp-vault-ca-with-ca-service">Use Hashicorp Vault CA with CA Service</h1>
<aside class="caution">
  This page contains a sample provided for demonstration purposes. Google does
  not officially support this sample. Carefully evaluate any solution before
  deploying it in your production environment.
</aside>
<p><a class="external" href="https://www.vaultproject.io/">Hashicorp Vault</a> lets you
manage and store secrets on-premises. This page provides information about
how you can configure Hashicorp Vault CA to act as a proxy that forwards all
certificate issuance requests to Certificate Authority Service. This configuration allows a
currently deployed solution to work natively with CA Service.</p>
<p>The <a class="external" href="https://github.com/googlecloudplatform/vault-plugin-secrets-gcppca" track-name="gitHubLink" track-type="solution">Vault plugin for CA Service</a> 
issues certificates through Hashicorp Vault by generating the private key and
certificate signing request (CSR), or by receiving a user-provided CSR. The
plugin doesn't perform create and delete CA operations, or manage other aspects
of the certificate authority (CA) lifecycle.</p>
<p>At a high level, the plugin acts as a proxy to issue certificates.</p>
<aside class="note"><strong>Note:</strong><span> The Vault plugin doesn't retain any public or private key that is generated
during certificate issuance. The certificate requester should retain the
certificate and keys that the Vault plugin generates.</span></aside>
<p>Using the Vault plugin has the following advantages:</p>
<ul>
<li>Administrators can use a familiar workflow and the existing access-control
list (ACL) permissions in the Vault.</li>
<li>The administrator can define who gets to request certificates and what
specifications and limits those certificates have.</li>
</ul>
<p>For more information about setting up and using the plugin, see the <a class="external" href="https://github.com/GoogleCloudPlatform/vault-plugin-secrets-gcppca/blob/master/README.md">README:
Vault Plugin for CA Service</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><a class="external" href="https://github.com/googlecloudplatform/vault-plugin-secrets-gcppca" track-name="gitHubLink" track-type="solution">GitHub: Vault Plugin for CA Service</a> </li>
<li><a class="external" href="https://www.vaultproject.io/docs">Hashicorp Vault documentation</a> </li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/cert-manager]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Manage certificate lifecycle using Cert-Manager" id="manage-certificate-lifecycle-using-cert-manager">Manage certificate lifecycle using Cert-Manager</h1>
<aside class="caution">
  This page contains a sample provided for demonstration purposes. Google does
  not officially support this sample. Carefully evaluate any solution before
  deploying it in your production environment.
</aside>
<p>This page provides information about using <a class="external" href="https://cert-manager.io" track-name="externalLink" track-type="solution">Jetstack
Cert-Manager</a> 
with Certificate Authority Service.</p>
<p>Cert-Manager is an open source Kubernetes add-on that automates the management
and issuance of TLS certificates from various issuing sources.</p>
<p>Cert-Manager manages the lifecycle of certificates issued by CA pools that are
created using CA Service. Cert-Manager ensures certificates are
valid and duly renewed before they expire.</p>
<p>For instructions on using Cert-Manager with CA Service, see
<a class="external" href="https://github.com/jetstack/google-cas-issuer/blob/main/README.md" track-name="gitHubLink" track-type="solution">README: Certificate Authority Service Issuer for
Cert-Manager</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><a class="external" href="https://blog.jetstack.io/blog/cert-manager-google-cas-issuer/">Integrating Cert-Manager with Google Cloud Certificate Authority Service</a> </li>
<li><a class="external" href="https://github.com/jetstack/cert-manager">GitHub: Cert-Manager</a> </li>
<li><a class="external" href="https://Cert-Manager.io/docs/">Cert-Manager documentation</a> </li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/policy-controls]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Policy controls" id="policy-controls">Policy controls</h1>
<p>This topic describes the scenarios when you should use various policy controls.</p>
<p>Policy controls enable you to control the type of certificates that your certificate authority (CA) pool can issue. Policy controls are of two types: coarse-grained and fine-grained. Coarse-grained policies apply CA pool-specific constraints. Fine-grained policies determine the operations a particular user can perform on a CA pool.</p>
<h2 data-text="Certificate templates" id="certificate-template">Certificate templates</h2>
<p>You can use a certificate template when you have a well-defined certificate issuance scenario. You can use certificate templates to enable consistency across certificates issued from different CA pools. You can also use a certificate template to restrict the kinds of certificates that different individuals can issue. For more information, see <a href="/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</p>
<p>For information about creating certificate templates, see <a href="/certificate-authority-service/docs/creating-certificate-template">Creating certificate templates</a>.</p>
<h2 data-text="Certificate issuance policies" id="issuance-policies">Certificate issuance policies</h2>
<p>A CA Manager can attach a
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#issuancepolicy">certificate issuance policy</a>
to a CA pool to define restrictions on the kind of certificates that the CAs in the CA pool can
issue. An issuance policy can define restrictions on certificate identities, certificate lifetimes, key types, certificate request
modes, and X.509 extensions. The issuance policy can also contain a set of X.509 extensions
that are applied to all incoming certificate requests.</p>
<p>Issuance policies let you apply certain restrictions on the entire CA pool. For
example, you can use an issuance policy to enforce the following conditions:</p>
<ul>
<li>All issued certificates have <code dir="ltr" translate="no">O=My organization</code> in their subject.</li>
<li>All DNS names end with <code dir="ltr" translate="no">.my-org-domain.com</code>.</li>
<li>The CA pool can only issue Server TLS certificates.</li>
</ul>
<p>If one or both of the following cases apply, we recommend using a certificate
issuance policy:</p>
<ol>
<li>Your CA pool is intended to issue certificates according to a single, well-defined profile.</li>
<li>You want to define a common baseline for X.509 extensions and additional restrictions that apply to all the certificate issuance profiles.</li>
</ol>
<p>For more information about issuance policies, see <a href="/certificate-authority-service/docs/use-issuance-policy">Using an issuance policy</a>.</p>
<h2 data-text="IAM policies" id="iam-policies">IAM policies</h2>
<p>It is important to implement the security principle of least privilege to protect the integrity of CA Service resources. Through the implementation of discrete Identity and Access Management (IAM) roles, organizations can better manage the security of the CA pool and the overall PKI itself.</p>
<h3 data-text="General IAM policies" id="general-iam">General IAM policies</h3>
<p>CA Service lets you grant IAM roles to users or service accounts for creating and managing resources. You can add these role bindings at the following levels:</p>
<ul>
<li>CA pool-level to manage access for a specific CA pool and for the CAs in that CA pool.</li>
<li>Project or organization-level to grant access to all CA pools in that scope.</li>
</ul>
<p>Roles are inherited, if granted at a higher resource-level. For example, a user who is granted the Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) role at the project-level is able to view all resources under the project.</p>
<p>For the complete list of predefined IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined_roles">Predefined roles</a>.</p>
<h3 data-text="Conditional IAM policies" id="conditional-iam">Conditional IAM policies</h3>
<p>If you have a shared CA pool that might be used by multiple users who are authorized to request different types of certificates, you can implement controls through conditional IAM policies to limit the per-user permissions to perform
certain operations on a CA pool.</p>
<p>IAM conditional bindings help control the permissions a specific user or group is allowed under a set of conditions. For example, if the
<a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined_roles">Certificate Requester</a>
role is bound to the user <code dir="ltr" translate="no">alice@example.com</code> on a CA pool with the condition that the requested DNS SANs are a subset of <code dir="ltr" translate="no">['alice@example.com', 'bob@example.com']</code>, then that user is
able to request certificates from the same CA pool only if the requested SAN is one of those two allowed values. You can set conditions on IAM bindings using Common Expression Language (CEL) expressions. These conditions can help you further restrict the type of certificates a user is able to request. For information on using CEL expressions for IAM conditions, see <a href="/certificate-authority-service/docs/using-cel#iam-policies">Common Expression Language (CEL) dialect for IAM policies</a>.</p>
<p>For information on configuring IAM policies, see <a href="/certificate-authority-service/docs/configuring-iam">Configuring IAM policies</a>.</p>
<h2 data-text="Policy conflicts" id="policy-conflicts">Policy conflicts</h2>
<p>When using different policy control mechanisms in conjunction, there is a possibility that policies on different levels can conflict. This section describes how policy controls get enforced and provides guidance on avoiding policy conflicts.</p>
<h3 data-text="Policy enforcement" id="policy-enforcement">Policy enforcement</h3>
<p>When requesting certificates, policy controls are evaluated at different layers.</p>
<p>IAM conditional bindings for request attributes are evaluated first to ensure the caller has the required permissions for creating certificates or using certificate templates.</p>
<p>During certificate creation the CA pool and the certificate template issuance policy are validated against the normalized certificate request. X.509 extensions from the CA pool's certificate issuance policy and the certificate template are added to the certificate, and certain values can be dropped based on those same policies.</p>
<h3 data-text="Issuance policy conflicts" id="issuance-policy-conflicts">Issuance policy conflicts</h3>
<p>The following is a non-comprehensive list of errors where the issuance policy of a certificate template can conflict with the issuance policy of a CA pool.</p>
<ul>
<li>A certificate template contains predefined values that are prohibited by the CA pool, or vice versa.</li>
<li>A certificate template contains different X.509 values than the CA pool baseline values, or vice versa.</li>
</ul>
<p>In all these cases, the API returns an invalid argument error.</p>
<h3 data-text="CEL conflicts" id="cel-conflicts">CEL conflicts</h3>
<p>CEL provides the ability to implement diverse expressions. There can be situations where the CEL expressions on the CA pool's issuance policy and on the certificate template conflict. These conflicts disallow certificates to be issued from the CA pool. For example, consider the situation that a CA pool had a CEL expression enforcing the common name of a certificate to end in <code dir="ltr" translate="no">.example.com</code> and the certificate template had a CEL expression enforcing the common name of a certificate to end in <code dir="ltr" translate="no">.example.net</code>. Since these two CEL expressions place different restrictions on the same field, all certificate issuance requests fail.</p>
<p>If you are using both certificate issuance policies and certificate templates, we recommend that you ensure that their CEL expressions do not conflict.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/certificate-authority-service/docs/using-cel">using Common Expression Language (CEL)</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/policy-controls]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Policy controls" id="policy-controls">Policy controls</h1>
<p>This topic describes the scenarios when you should use various policy controls.</p>
<p>Policy controls enable you to control the type of certificates that your certificate authority (CA) pool can issue. Policy controls are of two types: coarse-grained and fine-grained. Coarse-grained policies apply CA pool-specific constraints. Fine-grained policies determine the operations a particular user can perform on a CA pool.</p>
<h2 data-text="Certificate templates" id="certificate-template">Certificate templates</h2>
<p>You can use a certificate template when you have a well-defined certificate issuance scenario. You can use certificate templates to enable consistency across certificates issued from different CA pools. You can also use a certificate template to restrict the kinds of certificates that different individuals can issue. For more information, see <a href="/certificate-authority-service/docs/certificate-template">Certificate templates</a>.</p>
<p>For information about creating certificate templates, see <a href="/certificate-authority-service/docs/creating-certificate-template">Creating certificate templates</a>.</p>
<h2 data-text="Certificate issuance policies" id="issuance-policies">Certificate issuance policies</h2>
<p>A CA Manager can attach a
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#issuancepolicy">certificate issuance policy</a>
to a CA pool to define restrictions on the kind of certificates that the CAs in the CA pool can
issue. An issuance policy can define restrictions on certificate identities, certificate lifetimes, key types, certificate request
modes, and X.509 extensions. The issuance policy can also contain a set of X.509 extensions
that are applied to all incoming certificate requests.</p>
<p>Issuance policies let you apply certain restrictions on the entire CA pool. For
example, you can use an issuance policy to enforce the following conditions:</p>
<ul>
<li>All issued certificates have <code dir="ltr" translate="no">O=My organization</code> in their subject.</li>
<li>All DNS names end with <code dir="ltr" translate="no">.my-org-domain.com</code>.</li>
<li>The CA pool can only issue Server TLS certificates.</li>
</ul>
<p>If one or both of the following cases apply, we recommend using a certificate
issuance policy:</p>
<ol>
<li>Your CA pool is intended to issue certificates according to a single, well-defined profile.</li>
<li>You want to define a common baseline for X.509 extensions and additional restrictions that apply to all the certificate issuance profiles.</li>
</ol>
<p>For more information about issuance policies, see <a href="/certificate-authority-service/docs/use-issuance-policy">Using an issuance policy</a>.</p>
<h2 data-text="IAM policies" id="iam-policies">IAM policies</h2>
<p>It is important to implement the security principle of least privilege to protect the integrity of CA Service resources. Through the implementation of discrete Identity and Access Management (IAM) roles, organizations can better manage the security of the CA pool and the overall PKI itself.</p>
<h3 data-text="General IAM policies" id="general-iam">General IAM policies</h3>
<p>CA Service lets you grant IAM roles to users or service accounts for creating and managing resources. You can add these role bindings at the following levels:</p>
<ul>
<li>CA pool-level to manage access for a specific CA pool and for the CAs in that CA pool.</li>
<li>Project or organization-level to grant access to all CA pools in that scope.</li>
</ul>
<p>Roles are inherited, if granted at a higher resource-level. For example, a user who is granted the Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) role at the project-level is able to view all resources under the project.</p>
<p>For the complete list of predefined IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined_roles">Predefined roles</a>.</p>
<h3 data-text="Conditional IAM policies" id="conditional-iam">Conditional IAM policies</h3>
<p>If you have a shared CA pool that might be used by multiple users who are authorized to request different types of certificates, you can implement controls through conditional IAM policies to limit the per-user permissions to perform
certain operations on a CA pool.</p>
<p>IAM conditional bindings help control the permissions a specific user or group is allowed under a set of conditions. For example, if the
<a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined_roles">Certificate Requester</a>
role is bound to the user <code dir="ltr" translate="no">alice@example.com</code> on a CA pool with the condition that the requested DNS SANs are a subset of <code dir="ltr" translate="no">['alice@example.com', 'bob@example.com']</code>, then that user is
able to request certificates from the same CA pool only if the requested SAN is one of those two allowed values. You can set conditions on IAM bindings using Common Expression Language (CEL) expressions. These conditions can help you further restrict the type of certificates a user is able to request. For information on using CEL expressions for IAM conditions, see <a href="/certificate-authority-service/docs/using-cel#iam-policies">Common Expression Language (CEL) dialect for IAM policies</a>.</p>
<p>For information on configuring IAM policies, see <a href="/certificate-authority-service/docs/configuring-iam">Configuring IAM policies</a>.</p>
<h2 data-text="Policy conflicts" id="policy-conflicts">Policy conflicts</h2>
<p>When using different policy control mechanisms in conjunction, there is a possibility that policies on different levels can conflict. This section describes how policy controls get enforced and provides guidance on avoiding policy conflicts.</p>
<h3 data-text="Policy enforcement" id="policy-enforcement">Policy enforcement</h3>
<p>When requesting certificates, policy controls are evaluated at different layers.</p>
<p>IAM conditional bindings for request attributes are evaluated first to ensure the caller has the required permissions for creating certificates or using certificate templates.</p>
<p>During certificate creation the CA pool and the certificate template issuance policy are validated against the normalized certificate request. X.509 extensions from the CA pool's certificate issuance policy and the certificate template are added to the certificate, and certain values can be dropped based on those same policies.</p>
<h3 data-text="Issuance policy conflicts" id="issuance-policy-conflicts">Issuance policy conflicts</h3>
<p>The following is a non-comprehensive list of errors where the issuance policy of a certificate template can conflict with the issuance policy of a CA pool.</p>
<ul>
<li>A certificate template contains predefined values that are prohibited by the CA pool, or vice versa.</li>
<li>A certificate template contains different X.509 values than the CA pool baseline values, or vice versa.</li>
</ul>
<p>In all these cases, the API returns an invalid argument error.</p>
<h3 data-text="CEL conflicts" id="cel-conflicts">CEL conflicts</h3>
<p>CEL provides the ability to implement diverse expressions. There can be situations where the CEL expressions on the CA pool's issuance policy and on the certificate template conflict. These conflicts disallow certificates to be issued from the CA pool. For example, consider the situation that a CA pool had a CEL expression enforcing the common name of a certificate to end in <code dir="ltr" translate="no">.example.com</code> and the certificate template had a CEL expression enforcing the common name of a certificate to end in <code dir="ltr" translate="no">.example.net</code>. Since these two CEL expressions place different restrictions on the same field, all certificate issuance requests fail.</p>
<p>If you are using both certificate issuance policies and certificate templates, we recommend that you ensure that their CEL expressions do not conflict.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/certificate-authority-service/docs/using-cel">using Common Expression Language (CEL)</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/configuring-iam]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Configuring, modifying, and removing IAM policies" id="configuring,-modifying,-and-removing-iam-policies">Configuring, modifying, and removing IAM policies</h1>
<p>This topic describes how to configure, modify, and remove the Identity and Access Management (IAM) policies
that let members create and manage Certificate Authority Service resources. For more information about IAM, see <a href="/iam/docs/overview">Overview for IAM</a>.</p>
<p>IAM policies that are set on a certificate authority (CA) pool are inherited by all the CAs in that CA pool. You cannot set IAM policies on certificates and CA resources.</p>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ul>
<li>Read the <a href="/certificate-authority-service/docs/quickstart#before-you-begin">Quickstart</a> guide to set up the API and create a CA pool.</li>
<li>Read <a href="/certificate-authority-service/docs/policy-controls#iam-policies">IAM policies</a> to learn more about IAM policies.</li>
<li>Read the <a href="/certificate-authority-service/docs/reference/permissions-and-roles">Permissions and roles</a> topic to learn about the IAM roles available for Certificate Authority Service.</li>
</ul>
<h2 data-text="Configuring IAM policy bindings" id="configure-iam">Configuring IAM policy bindings</h2>
<p>The following scenarios describe how you can grant users access to CA Service
resources.</p>
<h3 data-text="Administering resources" id="administer-resources">Administering resources</h3>
<p>A CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) has the permissions to manage all CA Service
resources, and set IAM policies on CA pools and certificate templates.</p>
<aside class="note"><strong>Note:</strong><span> We recommend that you carefully assign the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) role, and implement a special access control for this role to prevent unauthorized access or use.</span></aside>
<p>To assign the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) role to a user, use the following instructions:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-name="iamConsoleLink" track-type="addRole">Go to Identity and Access Management</a> </p></li>
<li><p>In the top bar for IAM, click <strong>ADD</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>Type the filter <strong>CA Service Admin</strong>, scroll down the list, and select <strong>CA Service Admin</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/privateca.admin
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the unique identifier of the project.</li>
<li><var translate="no">MEMBER</var>: the user or service account to whom you want to assign the CA Service Admin role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p></section>
</div>
<p>You can also set the CA Service Admin (<code dir="ltr" translate="no">roles/privateca.admin</code>) role at the resource level to manage a
specific CA pool or certificate template.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_1">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="addRole">Go to Certificate Authority Service</a> </p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>CA Service</strong>, and select <strong>CA Service Admin</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_1">gcloud</h3><p>To set the IAM policy, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location <var translate="no">LOCATION</var> \
  --member <var translate="no">MEMBER</var> \
  --role roles/privateca.admin
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: the unique identifier of the CA pool for which you want to set the IAM policy.</li>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account to which you want to assign the IAM role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca pools add-iam-policy-binding</a>.</p></section>
</div>
<h3 data-text="Creating and managing CA pools and CAs" id="creating-managing-certificate-authorities">Creating and managing CA pools and CAs</h3>
<p>To create a CA pool and a CA, assign the CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) role to a user at the
project level. Granting CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) also allows the caller to
revoke certificates issued by the CAs in the CA pool.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_2">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-name="iamConsoleLink" track-type="addRole">Go to Identity and Access Management</a> </p></li>
<li><p>In the top bar for IAM, click <strong>ADD</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click <strong>Select a role</strong>.</p></li>
<li><p>Type the filter <strong>CA Service Operation Manager</strong>, and select <strong>CA Service Operation Manager</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_2">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/privateca.caManager
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the unique identifier of the project.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud projects add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/projects/add-iam-policy-binding">gcloud projects add-iam-policy-binding</a>.</p></section>
</div>
<p>Optionally, creating a CA using an existing Cloud KMS key also requires
the caller to be an administrator for the Cloud KMS key.</p>
<p>The Cloud KMS Admin (<code dir="ltr" translate="no">roles/cloudkms.admin</code>) has complete access to all Cloud KMS resources, except the encrypt and decrypt operations. For more information about IAM roles for Cloud KMS, see <a href="/kms/docs/reference/permissions-and-roles">Cloud KMS: Permissions and roles</a>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_3">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Cloud Key Management Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/kms" target="console" track-name="kmsConsoleLink" track-type="addRole">Go to Cloud Key Management Service</a> </p></li>
<li><p>Under <strong>Key rings</strong>, click the key ring that contains the CA signing key.</p></li>
<li><p>Click the key that is the CA signing key.</p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>Cloud KMS</strong>, and select <strong>Cloud KMS Admin</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_3">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys add-iam-policy-binding <var translate="no">KEY</var> \
  --keyring=<var translate="no">KEYRING</var> --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/cloudkms.admin
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">KEY</var>: the unique identifier of the key.</li>
<li><var translate="no">KEYRING</var>: the keyring that contains the key. For more information about key rings, see <a href="/kms/docs/resource-hierarchy#key_rings">Key rings</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM binding.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud kms keys add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/kms/keys/add-iam-policy-binding">gcloud kms keys add-iam-policy-binding</a>.</p></section>
</div>
<p>To manage a specific CA pool and its CAs, the <code dir="ltr" translate="no">roles/privateca.caManager</code> role can be granted
on either the project or on the CA pool. This role also allows the caller to
revoke certificates issued by CAs in the CA pool.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_4">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="addRole">Go to Certificate Authority Service</a> </p></li>
<li><p>Select your CA under <strong>Certificate authorities</strong>.</p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>CA Service</strong>, and select <strong>CA Service Operation Manager</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_4">gcloud</h3><p>To grant the role for a specific CA pool, run the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location <var translate="no">LOCATION</var> \
  --member <var translate="no">MEMBER</var> \
  --role roles/privateca.caManager
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: the unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the unique identifier of the user to whom you want to assign the CA Service Operation Manager (<code dir="ltr" translate="no">roles/privateca.caManager</code>) role.</li>
</ul>
<p>The  <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca pools add-iam-policy-binding</a>.</p></section>
</div>
<h3 data-text="Creating certificates" id="create-certificates">Creating certificates</h3>
<p>To create certificates, use the CA Service Certificate Manager (<code dir="ltr" translate="no">roles/privateca.certificateManager</code>) role.
This role also gives read access to CA Service resources. To only
allow certificate creation without read access, use
the CA Service Certificate Requester (<code dir="ltr" translate="no">roles/privateca.certificateRequester</code>) role. For more information about IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<p>To grant the user access to create certificates for a specific CA, use the following instructions.</p>
<aside class="caution"><strong>Caution:</strong><span> We recommend that you carefully grant the CA Service Certificate Manager role on a CA pool. If there is a CA in the CA pool that permits
issuing CA certificates, it might allow the caller to create their own subordinate
CA certificates that chain up to that CA. For more information about certificate issuance policy, see <a href="/certificate-authority-service/docs/policy-controls">Policy controls</a> and <a href="/certificate-authority-service/docs/use-issuance-policy">Using an issuance policy</a>.</span></aside><div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_5">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>Certificate Authority Service</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="addRole">Go to Certificate Authority Service</a> </p></li>
<li><p>Select your CA under <strong>Certificate authorities</strong>.</p></li>
<li><p>If not visible, click <strong>SHOW INFO PANEL</strong> in the top right of the Cloud console.</p></li>
<li><p>Click <strong>ADD MEMBER</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click the <strong>Select a role</strong> field.</p></li>
<li><p>In the pop-up, hover over <strong>CA Service</strong>, and select <strong>CA Service Certificate Manager</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_5">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding '<var translate="no">POOL_ID</var>' \
  --location <var translate="no">LOCATION</var> \
  --member <var translate="no">MEMBER</var> \
  --role roles/privateca.certificateManager
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_ID</var>: the unique identifier of the CA pool.</li>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the unique identifier of the user to whom you want to assign the CA Service Certificate Manager (<code dir="ltr" translate="no">roles/privateca.certificateManager</code>) role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p></section>
</div>
<h3 data-text="Auditing resources" id="audit-resources">Auditing resources</h3>
<p>A CA Service Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) has read access to all resources in CA Service. When
granted for a specific CA pool, it grants read access to the
CA pool. If the CA pool is in the Enterprise tier, the user with this role can also view
certificates and CRLs issued by the CAs in the CA pool. Assign this role to individuals who are accountable for validating security and operations of the CA pool. For more information about the predefined IAM roles for CA Service, see <a href="/certificate-authority-service/docs/reference/permissions-and-roles#predefined-roles">Predefined roles</a>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console_6">Console</h3><ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-name="iamConsoleLink" track-type="addRole">Go to Identity and Access Management</a> </p></li>
<li><p>In the top bar for IAM, click <strong>ADD</strong>.</p></li>
<li><p>In the <strong>New members</strong> field, enter the member.</p></li>
<li><p>Click <strong>Select a role</strong>.</p></li>
<li><p>Type the filter <strong>CA Service Auditor</strong>, and select <strong>CA Service Auditor</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud_6">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=roles/privateca.auditor
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the unique identifier of the project.</li>
<li><var translate="no">MEMBER</var>: the unique identifier of the user to whom you want to assign the CA Service Auditor (<code dir="ltr" translate="no">roles/privateca.auditor</code>) role.</li>
</ul>
<p>The <code dir="ltr" translate="no">--role</code> flag takes the IAM role that you want to assign to the member.</p></section>
</div>
<h2 data-text="Configuring IAM policy bindings per resource" id="configure-iam-resource">Configuring IAM policy bindings per resource</h2>
<p>This section describes how you can configure IAM policy bindings for a particular resource in CA Service.</p>
<h3 data-text="Adding IAM policy bindings" id="modify-iam-resource">Adding IAM policy bindings</h3>
<p>The procedure for modifying a user's IAM role is the same as that for granting a role. You can modify an existing IAM policy binding using the Google Cloud CLI's <code dir="ltr" translate="no">add-iam-policy-binding</code> command.</p>
<p>To add an IAM policy on a particular CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_7">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to modify for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/add-iam-policy-binding">gcloud privateca pools add-iam-policy-binding</a>.</p></section>
</div>
<p>To add an IAM policy on a particular certificate template, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_8">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates add-iam-policy-binding <var translate="no">TEMPLATE_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the certificate template. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to add the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to modify for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates add-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/add-iam-policy-binding">gcloud privateca templates add-iam-policy-binding</a>.</p></section>
</div>
<p>For more information about modifying a user's IAM role, see <a href="/iam/docs/granting-changing-revoking-access#granting-gcloud-manual">Granting access</a>.</p>
<h3 data-text="Removing IAM policy bindings" id="remove-iam">Removing IAM policy bindings</h3>
<p>You can remove an existing IAM policy binding using the Google Cloud CLI's <code dir="ltr" translate="no">remove-iam-policy-binding</code> command.</p>
<p>To remove an IAM policy on a particular CA pool, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_9">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding <var translate="no">POOL_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the CA pool. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to remove the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to remove for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools remove-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/pools/remove-iam-policy-binding">gcloud privateca pools remove-iam-policy-binding</a>.</p></section>
</div>
<p>To remove an IAM policy on a particular certificate template, use the following <code dir="ltr" translate="no">gcloud</code> command:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="gcloud" id="gcloud_10">gcloud</h3><pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca templates remove-iam-policy-binding <var translate="no">TEMPLATE_ID</var> \
  --location=<var translate="no">LOCATION</var> \
  --member=<var translate="no">MEMBER</var> \
  --role=<var translate="no">ROLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">LOCATION</var>: the location of the certificate template. For the complete list of locations, see <a href="/certificate-authority-service/docs/locations">Locations</a>.</li>
<li><var translate="no">MEMBER</var>: the user or service account for which you want to remove the IAM policy binding.</li>
<li><var translate="no">ROLE</var>: the role that you want to remove for the member.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca templates remove-iam-policy-binding</code> command, see <a href="/sdk/gcloud/reference/privateca/templates/remove-iam-policy-binding">gcloud privateca templates remove-iam-policy-binding</a>.</p></section>
</div>
<p>For more information about removing a user's IAM role, see <a href="/iam/docs/granting-changing-revoking-access#revoking-gcloud-manual">Revoking access</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Read the <a href="/iam/docs/overview">overview for IAM</a>.</li>
<li>Learn more about <a href="/iam/docs/understanding-roles">IAM roles</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/reference/permissions-and-roles">IAM roles for CA Service, and their associated permissions</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/policy-controls">policy controls</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/tutorials/manage-policy-controls">manage policy controls</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//certificate-authority-service/docs/use-issuance-policy]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<h1 data-text="Using a certificate issuance policy" id="using-a-certificate-issuance-policy">Using a certificate issuance policy</h1>
<p>This topic describes how to use a certificate issuance policy on a certificate
authority (CA) pool.</p>
<p>A certificate issuance policy lets you specify the subject and subject
alternative names (SANs) that can be included in the issued certificates. You can
specify the certificate issuance policy while creating a CA pool or you can update
an existing CA pool to add an issuance policy.</p>
<p>For more information, see <a href="/certificate-authority-service/docs/policy-controls#issuance-policies">Certificate issuance policies</a>.</p>
<aside class="caution"><strong>Caution:</strong><span> The issuance policy changes are effective immediately. Before using the
issuance policy in production, we recommend that you try out the policy changes
on a test CA pool instance.</span></aside>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ul>
<li><p>Make sure you have the CA Service Operation Manager
(<code dir="ltr" translate="no">roles/privateca.caManager</code>) or the CA Service Admin
(<code dir="ltr" translate="no">roles/privateca.admin</code>) IAM role. For information about
granting an IAM to a principal, see <a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single
role</a>.</p></li>
<li><p>Create a CA pool by using the instructions in the <a href="/certificate-authority-service/docs/create-certificate">quickstart</a>.</p></li>
</ul>
<h2 data-text="Add a certificate issuance policy file" id="add-issuance-policy">Add a certificate issuance policy file</h2>
<p>To add a certificate issuance policy to an existing CA pool, do the following:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><ol>
<li><p>Go to the <strong>Certificate Authority Service</strong> page in the Google Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/cas" target="console" track-name="consoleLink" track-type="quickstart">Go to Certificate Authority Service</a> </p></li>
<li><p>On the <strong>CA pool manager</strong> page, click the name of the CA pool for which you
want to add a certificate issuance policy.</p></li>
<li><p>On the <strong>CA pool</strong> page, click <span aria-hidden="true" class="material-icons" translate="no">edit</span><strong>Edit</strong>.</p></li>
</ol>
<b>Configure identity constraints</b>
<p>To configure constraints on the subject and SANs in the certificates that
  the CA pool issues, do the following:</p>
<ol>
<li>
    Optional: To disallow subject in certificate requests from being passed
    through, click the toggle.
  </li>
<li>
    Optional: To disallow subject alternative names in certificate requests
    from being passed through, click the toggle.
  </li>
<li>
    Optional: Add a Common Expression Language (CEL) expression to place
    restrictions on certificate subjects. For more information, see
    <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure extension constraints</b>
<p>To disallow all extensions from certificate requests from being included in
   the issued certificates, click the toggle.
</p>
<p>
  After you click the toggle, you will see the <b>Known certificate
  extensions</b> field that you can use to select the certificate extensions. To
  select the certificate extensions, do the following:
</p>
<ol>
<li>
    Optional: Click the <b>Known certificate extensions</b> field, and clear the
    unrequired extensions from the menu.
  </li>
<li>
    Optional: In the <b>Custom extensions</b> field, add the object identifiers
    for extensions you want to be included in the certificates that the CA pool
    issues.
  </li>
</ol>
<b>Configure baseline values</b>
<p>
  To configure baseline values in the certificates issued from the CA pool, do
  the following:
</p>
<ol>
<li>
    Click the toggle.
  </li>
<li>
    Click <b>Configure baseline values</b>.
  </li>
</ol>
<b>Define base key usage</b>
<p>
  You can use this setting to configure the ways in which the key contained in
  the certificate can be used. The options for key usage include key
  encipherment, data encipherment, certificate signing, CRL signing, and more.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">Key usage</a>
</p>
<p>
  To define the base key usages, do the following:
</p>
<ol>
<li>
    Optional: In the window that appears, click the toggle, if
    you want to specify base key usages for the certificates.
  </li>
<li>
    Select the checkboxes for the ways in which you want a key to be used.
  </li>
<img class="screenshot" data-modal-dialog-id="base-key" src="/certificate-authority-service/images/base-key-usage.png" style="width: 55%"/>
<devsite-lightbox id="base-key">
<img alt="Select the high-level ways in which you want a key to be used." src="/certificate-authority-service/images/base-key-usage.png"/>
</devsite-lightbox>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Define extended key usage</b>
<p>
  You can use this setting to select more granular scenarios for which the key
  contained in the certificate can be used. The options include server
  authentication, client authentication, code signing, email protection, and
  more.
</p>
<p>
  Extended key usages are defined using object identifiers (OIDs). If you don't
  configure the extended key usages, all key usage scenarios are allowed.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">Extended key usage</a>.
</p>
<p>
  To define the extended key usages, do the following:
</p>
<ol>
<li>
    Optional: To specify the extended key usages for the certificates that the
    CA pool issues, click the toggle.
  </li>
<li>
    Select the checkboxes for the extended key usage scenarios.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Define policy identifiers</b>
<p>
  The certificate policies extension in the certificate expresses the policies
  that the issuing CA pool follows. This extension can include information about how
  identities are validated before certificate issuance, how certificates are
  revoked, and how the CA pool's integrity is ensured. This extension helps you
  verify the certificates that the CA pool issues and see how the certificates
  are used.
</p>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.4">Certificate policies</a>.
</p>
<p>
  To specify the policy that defines the certificate usage, do the following:
</p>
<ol>
<li>
    Optional: Add the policy identifier in the <b>Policy identifiers</b> field.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Add Authority information access (AIA) OCSP servers</b>
<p>
  The AIA extension in a certificate provides the following information:
</p>
<ul>
<li>
    Address of the OCSP servers from where you can check the revocation status
    of the certificate.
  </li>
<li>
    The access method for the issuer of the certificate.
  </li>
</ul>
<p>
  For more information, see <a class="external" href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.2.1">Authority information access</a>.
</p>
<p>
  To add the OCSP servers that appear in the AIA extension field in the
  certificates, do the following. The following procedure is optional.
</p>
<ol>
<li>
    Optional: Click <b>Add item</b>.
  </li>
<li>
    In the <b>Server URL</b> field, add the URL of the OCSP server.
  </li>
<li>
    Click <b>Done</b>.
  </li>
<li>
    Click <b>Next</b>.
  </li>
</ol>
<b>Configure additional extensions</b>
<p>
  To configure additional custom extensions to include in the
  certificates issued by the CA pool, do the following. The following procedure
  is optional.
</p>
<ol>
<li>
    Click <b>Add item</b>.
  </li>
<li>
    In the <b>Object identifier</b> field, add a valid object identifier that
    is formatted as dot-separated digits.
  </li>
<li>
    In the <b>Value</b> field, add the base64-encoded value for the identifier.
  </li>
<li>
    If the extension is critical, select <b>Extension is critical</b>.
  </li>
</ol>
<p>
  To save all the baseline value configurations, click <b>Done</b>.
</p></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>To use the Google Cloud CLI to add a certificate issuance policy to a CA pool,
you must create a YAML file that describes the restrictions on the
certificates that the CA pool can issue. The content corresponds to an
<a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#issuancepolicy">IssuancePolicy</a>.</p>
<ol>
<li><p>Using the Cloud Shell Editor, create a file <code dir="ltr" translate="no">policy.yaml</code> with the
following content:</p>
<pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: true
  allowSubjectAltNamesPassthrough: true
</code></pre>
<p>Where:</p>
<ul>
<li>The <code dir="ltr" translate="no">allowSubjectPassthrough</code> field is required. If the <code dir="ltr" translate="no">allowSubjectPassthrough</code> field is set to <code dir="ltr" translate="no">true</code>, the subject field is copied from a certificate request into the signed certificate. Otherwise, the requested Subject is discarded.</li>
<li>If the <code dir="ltr" translate="no">allowSubjectAltNamesPassthrough</code> field is set to <code dir="ltr" translate="no">true</code>, the SubjectAltNames extension is copied from a certificate request into the signed certificate. Otherwise, the requested SubjectAltNames is discarded.</li>
</ul></li>
<li><p>To update a CA pool's certificate issuance policy using the file
created in the previous step, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud privateca pools update <var translate="no">POOL_NAME</var> \
  --issuance-policy <var translate="no">FILE_PATH</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">POOL_NAME</var>: Name of the CA pool.</li>
<li><var translate="no">FILE_PATH</var>: The path of the <code dir="ltr" translate="no">policy.yaml</code> file.</li>
</ul>
<p>For more information about the <code dir="ltr" translate="no">gcloud privateca pools update</code> command,
see <a href="/sdk/gcloud/reference/privateca/pools/update">gcloud privateca pools update</a>.</p></li>
</ol></section>
</div>
<p>For more information, see <a href="/certificate-authority-service/docs/creating-ca-pool">Creating CA pools</a>.</p>
<h2 data-text="Supported restrictions" id="supported-restrictions">Supported restrictions</h2>
<p>CA Service supports the following issuance policy restrictions. You
can combine the following restrictions as necessary to build a custom certificate
issuance policy.</p>
<h3 data-text="Restrict or force allowed X.509 values" id="restrict_or_force_allowed_x509_values">Restrict or force allowed X.509 values</h3>
<p>A CA pool can restrict the allowed X.509 values in certificate requests by configuring the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.passthrough_extensions">passthrough_extensions</a> field.</p>
<p>A CA pool can also explicitly specify X.509 values to be added to all its issued certificates, overwriting any requested values, by using the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.baseline_values">baseline_values</a> field.</p>
<p>The <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.baseline_values">baseline_values</a> values of a CA pool allow specifying the following properties:</p>
<ul>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#KeyUsage">Key Usage</a></li>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters#CaOptions">CA Options</a></li>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Parameters">AIA OCSP Servers</a></li>
<li><a href="/certificate-authority-service/docs/reference/rest/v1/X509Extension">Additional X.509 Extensions</a></li>
</ul>
<p>You can also use these options together.</p>
<p>If you update any part of the <code dir="ltr" translate="no">baseline_values</code> field, the update replaces
the entire set of values in the <code dir="ltr" translate="no">baseline_values</code> field.</p>
<ul>
<li><p><strong>Example</strong>: Restrict a CA to issue only end-entity certificates with X.509 values for mutual TLS (mTLS).</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">baselineValues:
  caOptions:
    isCa: false
  keyUsage:
    baseKeyUsage:
      digitalSignature: true
      keyEncipherment: true
    extendedKeyUsage:
       clientAuth: true
       serverAuth: true
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>:  Restrict a CA to issue only end-entity code signing certificates with a baseline AIA OCSP URL.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_1">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">baselineValues:
  caOptions:
    isCa: false
  keyUsage:
    baseKeyUsage:
      digitalSignature: true
    extendedKeyUsage:
      codeSigning: true
  aiaOcspServers:
    - "http://foo.bar/revocation"
  additionalExtensions:
  - objectId:
      objectIdPath:
        - 1
        - 2
        - 3
    critical: false
    value: "base64 encoded extension value"
</code></pre></section>
</div></li>
</ul>
<p>For more information about the certificate profile for end-entity mTLS, see <a href="/certificate-authority-service/docs/certificate-profile#end-mtls">End-entity mTLS</a>.</p>
<h3 data-text="Restrict allowed identity fields" id="restrict-allowed-identity-fields">Restrict allowed identity fields</h3>
<p>To restrict the identity of certificates issued through a CA pool, you can add a <a class="external" href="https://opensource.google/projects/cel">Common Expression Language (CEL)</a> expression to the issuance policy's <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.identity_constraints">identity_constraints</a> field. The CEL expressions allow arbitrary restrictions over the Subject Domain Name (including the common name) and the SANs of a certificate.</p>
<p>For more information about using a CEL expression to restrict Subject and SANs, see <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.</p>
<ul>
<li><p><strong>Example</strong> Allow the CA to issue only certificates matching a specified Subject.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_2">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: true
  allowSubjectAltNamesPassthrough: false
  celExpression:
    expression: 'subject.organization == "Example LLC" &amp;&amp; subject.country_code in ["US", "UK"]'
</code></pre>
<p>The <code dir="ltr" translate="no">celExpression</code> field is optional. Use a Common Expression Language (CEL) expression to validate the resolved X.509 subject and/or SAN before a certificate is signed. For more information about using CEL expressions, see <a href="/certificate-authority-service/docs/using-cel">Using CEL</a>.</p></section>
</div></li>
<li><p><strong>Example</strong>: Allow only SANs having DNS Names as <code dir="ltr" translate="no">us.google.org</code> or ending in <code dir="ltr" translate="no">.google.com</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_3">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == DNS &amp;&amp; (san.value == "us.google.org" || san.value.endsWith(".google.com")) )'
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>: Allow only SANs having URIs <code dir="ltr" translate="no">https://google.com/webhp</code> or starting with <code dir="ltr" translate="no">spiffe://example-trust-domain-1/ns/namespace1/sa/</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_4">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == URI &amp;&amp; (san.value == "https://google.com/webhp" || san.value.startsWith("spiffe://example-trust-domain-1/ns/namespace1/sa/")) )'
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>: Allow only SANs having email addresses <code dir="ltr" translate="no">example@google.com</code> or ending with <code dir="ltr" translate="no">@google.org</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_5">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == EMAIL &amp;&amp; (san.value == "example@google.com" || san.value.endsWith("@google.org")) )'
</code></pre></section>
</div></li>
<li><p><strong>Example</strong>: Allow only custom SANs having a specific OID and a custom value.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_6">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">identityConstraints:
  allowSubjectPassthrough: false
  allowSubjectAltNamesPassthrough: true
  celExpression:
    expression: 'subject_alt_names.all(san, san.type == CUSTOM &amp;&amp; san.oid == [1, 2, 3, 4] &amp;&amp; san.value == "custom-data" )'
</code></pre></section>
</div></li>
</ul>
<h3 data-text="Restrict maximum lifetime of the issued certificates" id="restrict-max-lifetime">Restrict maximum lifetime of the issued certificates</h3>
<p>To restrict the lifetime of the issued certificates, use the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.maximum_lifetime">maximum_lifetime</a> field. If a certificate's requested lifetime is larger than the maximum lifetime, the certificate's lifetime is explicitly truncated.</p>
<aside class="note"><strong>Note:</strong><span> A certificate can never outlive its issuing CA. If a certificate request mentions a lifetime that exceeds the CA's <code dir="ltr" translate="no">not_after_time</code> date, its lifetime is truncated to match the CA's <code dir="ltr" translate="no">not_after_time</code> date. The certificate's lifetime is truncated even if the certificate issuance policy allows a longer lifetime.</span></aside>
<h4 data-text="Example" id="example">Example</h4>
<p>To allow a maximum lifetime of 30 days, use the following <code dir="ltr" translate="no">policy.yaml</code> file:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_7">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">maximumLifetime: 2592000s
</code></pre></section>
</div>
<h3 data-text="Restrict allowed certificate issuance modes" id="restrict-allowed-issuance-modes">Restrict allowed certificate issuance modes</h3>
<p>You can request a certificate either through a Certificate Signing Request (CSR) or an inline description of the requested values. Some organizations might prefer to add limitations on the option that can be used because the latter method doesn't require a proof of possession of the associated private key. You can set these limitations using the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.allowed_issuance_modes">allowedIssuanceModes</a> field.</p>
<p>For more information about specifying the ways in which certificates can be requested from a CA pool, see <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuanceModes">IssuanceModes</a>.</p>
<p>For more information about requesting certificates, see <a href="/certificate-authority-service/docs/requesting-certificates">Requesting certificates</a>.</p>
<ul>
<li><p><strong>Example</strong>: Allow only CSR issuance.</p></li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_8">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">allowedIssuanceModes:
  allowCsrBasedIssuance: True
  allowConfigBasedIssuance: False
</code></pre></section>
</div>
<h3 data-text="Restrict the public key algorithms of the certificate request" id="restrict-public-key">Restrict the public key algorithms of the certificate request</h3>
<p>To restrict the minimum key length and the public key algorithms that certificates can use, you can use the <a href="/certificate-authority-service/docs/reference/rest/v1/projects.locations.caPools#IssuancePolicy.FIELDS.allowed_key_types">allowedKeyTypes</a> field in the certificate issuance policy YAML file. If this field is specified, then the certificate request's public key must match one of the key types listed in the YAML file. If this field isn't specified, then you can use any key.</p>
<ul>
<li><p><strong>Example</strong>: Allow RSA keys with a modulus size between 3072 bits and 4096 bits (inclusive), or Elliptic Curve Digital Signature Algorithm (ECDSA) keys over the NIST P-256 curve.</p></li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="policy.yaml" id="policy.yaml_9">policy.yaml</h3><pre class="prettyprint lang-yaml" dir="ltr" translate="no"><code dir="ltr" translate="no">allowedKeyTypes:
- rsa:
    minModulusSize: 3072
    maxModulusSize: 4096
- ellipticCurve:
    signatureAlgorithm: ECDSA_P256
</code></pre></section>
</div>
<p>You can choose one of the following elliptic curve signature algorithms:</p>
<ul>
<li><code dir="ltr" translate="no">EC_SIGNATURE_ALGORITHM_UNSPECIFIED</code> - Any signature algorithm may be used.</li>
<li><code dir="ltr" translate="no">ECDSA_P256</code> -  Elliptic Curve Digital Signature over the NIST P-256 curve.</li>
<li><code dir="ltr" translate="no">ECDSA_P384</code> -  Elliptic Curve Digital Signature over the NIST P-384 curve.</li>
<li><code dir="ltr" translate="no">EDDSA_25519</code> - Edwards-curve Digital Signature Algorithm over curve 25519, as described in RFC 8410.</li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/certificate-authority-service/docs/certificate-profile">certificate profiles</a>.</li>
<li>Learn more about <a href="/certificate-authority-service/docs/requesting-certificates">requesting certificates</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/configuring-iam">configure IAM policies</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/using-cel">use Common Expression Language (CEL)</a>.</li>
<li>Learn how to <a href="/certificate-authority-service/docs/tutorials/manage-policy-controls">manage various policy controls</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr>