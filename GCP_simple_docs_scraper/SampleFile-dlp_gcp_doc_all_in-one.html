<p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<article id="cloud-site">
<nav class="cloud-jump-menu cloud-jump-menu__prebuilt" data-cloud-menu-label="Cloud Data Loss Prevention documentation">
<div class="cloud-menu-content">
<a class="cloud-jump-menu__toggle" href="#">Cloud Data Loss Prevention documentation<i aria-hidden="true" class="material-icons" translate="no"><span></span></i></a>
<div class="cloud-jump-menu__links">
<h1 class="cloud-subhead" data-text="Cloud Data Loss Prevention documentation" id="cloud-data-loss-prevention-documentation">Cloud Data Loss Prevention documentation</h1>
<!-- first_jump_section_label -->
<div class="cloud-jump-menu__links">
<a class="cloud-jump-menu__item" href="#docs" track-metadata-eventdetail="Overview" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
      Overview
    </div>
</a>
<!-- hero_headline -->
<!-- Training and tutorials -->
<!-- use-cases -->
<!-- Code samples -->
<!--  Videos -->
<a class="cloud-jump-menu__item" href="#videos" track-metadata-eventdetail="Videos" track-metadata-module="left nav" track-metadata-position="left nav" track-name="leftJumpNav" track-type="navigation">
<div class="cloud-body-text__small cloud-jump-menu__item__main">
        Videos
      </div>
</a>
</div>
</div>
</div>
</nav>
<div class="cloud-jump-content cloud-jump-section" data-cloud-main-text="Overview" id="docs">
<div class="cloud-section cloud-section--no-padding-bottom cloud-section__header--small">
<div class="page-intro">
<p>
  Cloud DLP provides access to a powerful sensitive data inspection, classification,
  and de-identification platform.
</p>
<p>Cloud DLP includes:</p>
<ul>
<li>
    Over 150 built-in <a href="/dlp/docs/infotypes-reference">information type (or
    "infoType") detectors</a>.
  </li>
<li>
    The ability to <a href="/dlp/docs/concepts-infotypes">define custom infoType detectors</a> using
    dictionaries, regular expressions, and contextual elements.
  </li>
<li>
<a href="/dlp/docs/deidentify-sensitive-data">De-identification techniques</a> including
    redaction, masking, format-preserving encryption, date-shifting, and more.</li>
<li>
    The ability to detect sensitive data within <a href="/dlp/docs/inspecting-text">streams of data</a>,
    <a href="/dlp/docs/inspecting-structured-text">structured text</a>,
    <a href="/dlp/docs/inspecting-storage">files in storage repositories such as Cloud Storage and
    BigQuery</a>, and even within <a href="/dlp/docs/inspecting-images">images</a>.
  </li>
<li>
<a href="/dlp/docs/concepts-risk-analysis">Analysis of structured data</a> to help understand
    its risk of being re-identified, including computation of metrics like <em>k</em>-anonymity,
    <em>l</em>-diversity, and more.
  </li>
<li><img alt="New feature" src="/dlp/docs/images/new.svg"> The ability to automatically
    <a href="/dlp/docs/data-profiles">profile BigQuery data</a> across an organization,
    folder, and project to identify tables where high-risk and sensitive data reside.</img></li>
</ul>
</div>
</div>
<div class="cloud-section--small cloud-section--no-padding-top hero-section">
<div class="cloud-grid--alternate cloud-copy__inner cloud-copy--three-column">
<div class="cloud-grid--alternate cloud-grid--row-gap cloud-grid__col is-12 is-12__large">
<div class="cloud-grid__col is-6 is-4__large">
<div class="cloud-list-card cloud-elevation-z0">
<div class="cloud-list-card__content">
<div class="cloud-list-card__header-border">
<h4 class="cloud-list-card__subhead cloud-body-text" data-text="Guides" id="guides">Guides</h4>
</div>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/quickstart-json" track-metadata-category="Guides" track-metadata-child_headline="Quickstart: Using a JSON request" track-metadata-eventdetail="/dlp/docs/quickstart-json" track-metadata-position="0" track-name="
  Quickstart: Using a JSON request
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Quickstart: Using a JSON request
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/inspect-sensitive-text" track-metadata-category="Guides" track-metadata-child_headline="Quickstart: Inspect sensitive text by using the command line" track-metadata-eventdetail="/dlp/docs/inspect-sensitive-text" track-metadata-position="1" track-name="
  Quickstart: Inspect sensitive text by using the command line
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Quickstart: Inspect sensitive text by using the command line
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/schedule-inspection-scan" track-metadata-category="Guides" track-metadata-child_headline="Quickstart: Schedule a Cloud DLP inspection scan" track-metadata-eventdetail="/dlp/docs/schedule-inspection-scan" track-metadata-position="2" track-name="
  Quickstart: Schedule a Cloud DLP inspection scan
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Quickstart: Schedule a Cloud DLP inspection scan
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/deidentify-sensitive-data" track-metadata-category="Guides" track-metadata-child_headline="De-identifying sensitive data" track-metadata-eventdetail="/dlp/docs/deidentify-sensitive-data" track-metadata-position="3" track-name="
  De-identifying sensitive data
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        De-identifying sensitive data
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/redacting-sensitive-data-images" track-metadata-category="Guides" track-metadata-child_headline="Redacting sensitive data from images" track-metadata-eventdetail="/dlp/docs/redacting-sensitive-data-images" track-metadata-position="4" track-name="
  Redacting sensitive data from images
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Redacting sensitive data from images
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/inspecting-storage" track-metadata-category="Guides" track-metadata-child_headline="Inspecting storage and databases for sensitive data" track-metadata-eventdetail="/dlp/docs/inspecting-storage" track-metadata-position="5" track-name="
  Inspecting storage and databases for sensitive data
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Inspecting storage and databases for sensitive data
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/inspecting-text" track-metadata-category="Guides" track-metadata-child_headline="Inspecting text for sensitive data" track-metadata-eventdetail="/dlp/docs/inspecting-text" track-metadata-position="6" track-name="
  Inspecting text for sensitive data
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Inspecting text for sensitive data
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/creating-templates-inspect" track-metadata-category="Guides" track-metadata-child_headline="Creating Cloud DLP inspection templates" track-metadata-eventdetail="/dlp/docs/creating-templates-inspect" track-metadata-position="7" track-name="
  Creating Cloud DLP inspection templates
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Creating Cloud DLP inspection templates
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/creating-job-triggers" track-metadata-category="Guides" track-metadata-child_headline="Creating and scheduling Cloud DLP inspection jobs" track-metadata-eventdetail="/dlp/docs/creating-job-triggers" track-metadata-position="8" track-name="
  Creating and scheduling Cloud DLP inspection jobs
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Creating and scheduling Cloud DLP inspection jobs
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item cloud-list-card__list-item--static">
<div>
</div>
</li>
</ul>
</div>
<div class="cloud-list-card__footer">
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item l-pad-left-4">
<a class="cloud-button cloud-button--flat" href="/dlp/docs/how-to" track-metadata-anchor_text="More" track-metadata-category="Guides" track-metadata-eventdetail="/dlp/docs/how-to" track-metadata-href="/dlp/docs/how-to" track-metadata-icon="internal" track-metadata-modifier="flat" track-name="More" track-type="button">
    
  
    More
  
<span class="cloud-button__icon--no-wrap">Â <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-grid__col is-6 is-4__large">
<div class="cloud-list-card cloud-elevation-z0">
<div class="cloud-list-card__content">
<div class="cloud-list-card__header-border">
<h4 class="cloud-list-card__subhead cloud-body-text" data-text="Reference" id="reference">Reference</h4>
</div>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/libraries" track-metadata-category="Reference" track-metadata-child_headline="Cloud DLP Client Libraries" track-metadata-eventdetail="/dlp/docs/libraries" track-metadata-position="0" track-name="
  Cloud DLP Client Libraries
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Cloud DLP Client Libraries
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/reference/rest" track-metadata-category="Reference" track-metadata-child_headline="REST API" track-metadata-eventdetail="/dlp/docs/reference/rest/" track-metadata-position="1" track-name="
  REST API
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        REST API
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/reference/rpc" track-metadata-category="Reference" track-metadata-child_headline="RPC API" track-metadata-eventdetail="/dlp/docs/reference/rpc/" track-metadata-position="2" track-name="
  RPC API
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        RPC API
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item cloud-list-card__list-item--static">
<div>
</div>
</li>
</ul>
</div>
<div class="cloud-list-card__footer">
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item l-pad-left-4">
<a class="cloud-button cloud-button--flat" href="/dlp/docs/apis" track-metadata-anchor_text="More" track-metadata-category="Reference" track-metadata-eventdetail="/dlp/docs/apis" track-metadata-href="/dlp/docs/apis" track-metadata-icon="internal" track-metadata-modifier="flat" track-name="More" track-type="button">
    
  
    More
  
<span class="cloud-button__icon--no-wrap">Â <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-grid__col is-6 is-4__large">
<div class="cloud-list-card cloud-elevation-z0">
<div class="cloud-list-card__content">
<div class="cloud-list-card__header-border">
<h4 class="cloud-list-card__subhead cloud-body-text" data-text="Resources" id="resources">Resources</h4>
</div>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/pricing" track-metadata-category="Resources" track-metadata-child_headline="Cloud DLP pricing" track-metadata-eventdetail="/dlp/pricing" track-metadata-position="0" track-name="
  Cloud DLP pricing
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Cloud DLP pricing
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/support/getting-support" track-metadata-category="Resources" track-metadata-child_headline="Getting support" track-metadata-eventdetail="/dlp/docs/support/getting-support" track-metadata-position="1" track-name="
  Getting support
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Getting support
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/support/data-security" track-metadata-category="Resources" track-metadata-child_headline="Cloud DLP data security" track-metadata-eventdetail="/dlp/docs/support/data-security" track-metadata-position="2" track-name="
  Cloud DLP data security
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Cloud DLP data security
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/release-notes" track-metadata-category="Resources" track-metadata-child_headline="Release notes" track-metadata-eventdetail="/dlp/docs/release-notes" track-metadata-position="3" track-name="
  Release notes
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Release notes
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-list-card__link" href="/dlp/docs/support/billing-questions" track-metadata-category="Resources" track-metadata-child_headline="Billing questions" track-metadata-eventdetail="/dlp/docs/support/billing-questions" track-metadata-position="4" track-name="
  Billing questions
  
" track-type="list card item">
<div>
<p class="cloud-subhead2">
        Billing questions
      </p>
</div>
</a>
</li>
<li class="cloud-list-card__list-item cloud-list-card__list-item--static">
<div>
</div>
</li>
</ul>
</div>
<div class="cloud-list-card__footer">
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item l-pad-left-4">
<a class="cloud-button cloud-button--flat" href="/dlp/docs/resources" track-metadata-anchor_text="More" track-metadata-category="Resources" track-metadata-eventdetail="/dlp/docs/resources" track-metadata-href="/dlp/docs/resources" track-metadata-icon="internal" track-metadata-modifier="flat" track-name="More" track-type="button">
    
  
    More
  
<span class="cloud-button__icon--no-wrap">Â <i aria-hidden="true" class="material-icons notranslate cloud-button__icon cloud-button__icon--internal" translate="no">arrow_forward</i></span></a>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cloud-section--small cloud-section--border community cloud-section--no-padding-top">
<h2 class="cloud-jump-section" data-cloud-main-text="Videos" data-text="               Videos             " id="videos">
              Videos
            </h2>
<devsite-dynamic-content initial-results="3" query="tenant:cloud+origin:youtube+text:DLP" sortorder="-timestamp">
</devsite-dynamic-content>
</div>
</div>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspect-sensitive-text]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Inspect sensitive text by using Node.js" id="inspect-sensitive-text-by-using-node.js">Inspect sensitive text by using Node.js</h1>
<section class="intro">
<p>Learn how to scan a sample string for sensitive information by using the
Cloud Data Loss Prevention API (DLP API), the Google Cloud CLI, and Node.js.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
</cloudx-free-trial-eligible-content>
<li><a href="/nodejs/docs/setup">Install Node.js and NPM</a>.</li>
</ol>
</section>
<section class="steps">
<h2 data-text="Set permissions" id="set-permissions">Set permissions</h2>
<p>To inspect content, you must have the <code dir="ltr" translate="no">serviceusage.services.use</code>
IAM permission for your project. To give this permission, grant
the DLP User role at the project level:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">   gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> --member user:<var translate="no">EMAIL_ADDRESS</var> --role roles/dlp.user
</code></pre>
<p>Replace the following:</p>
<ul>
<li><p><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your Google Cloud project</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">EMAIL_ADDRESS</var></code>: the email address of your 
 Google Cloud account</p></li>
</ul>
<p>The output is similar to the following:</p>
<pre class="devsite-disable-click-to-copy devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">   bindings:
   - members:
   - user:test@example.com
   role: roles/dlp.user
</code></pre>
<h2 data-text="Set up a Cloud DLP CLI app" id="setup-cli-app">Set up a Cloud DLP CLI app</h2>
<p>To set up a Cloud DLP CLI app using Node.js, do the following:</p>
<ol>
<li><p>Clone the <a href="https://github.com/googleapis/nodejs-dlp">Node.js DLP client library</a>:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no"> git clone https://github.com/googleapis/nodejs-dlp
</code></pre></li>
<li><p>Navigate to the <code dir="ltr" translate="no">samples</code> directory.</p></li>
<li><p>Install the app dependencies:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no"> npm install
</code></pre></li>
</ol>
<h2 data-text="Inspect a string for sensitive information" id="inspect-string">Inspect a string for sensitive information</h2>
<p>To scan sample text by using the DLP API and the <code dir="ltr" translate="no">inspectString</code>
Node.js script, run the following command:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">  node inspectString.js <var translate="no">PROJECT_ID</var> "My email address is joe@example.com."
</code></pre>
<p>The output is similar to the following:</p>
<pre class="devsite-disable-click-to-copy devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">  Findings:
      Info type: PERSON_NAME
      Likelihood: POSSIBLE
      Info type: EMAIL_ADDRESS
      Likelihood: LIKELY
</code></pre>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>
          To avoid incurring charges to your Google Cloud account for
          the resources used on this page, follow these steps.
        </p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>
  The easiest way to eliminate billing is to delete the project that you
  created for the tutorial.
</p>
<p>To delete the project:
  <ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</p>

</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li><p>To get started with inspecting text and images for sensitive data, see
<a href="/dlp/docs/how-to">How-to guides</a>.</p></li>
<li><p>To better understand inspection, redaction, infoTypes, and likelihood, see
<a href="/dlp/docs/concepts">Concepts</a>.</p></li>
<li><p>Learn more about the <a href="/dlp/docs/reference/rest/v2">DLP API</a>.</p></li>
<li><p>Learn more about the <a href="/nodejs/docs/reference/dlp/latest">Cloud DLP Node.js Client</a>.</p></li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/apis]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="quickstarts">
<ul class="card-showcase">
<li>
<a class="no-logo" href="/dlp/docs/reference/libraries">
<h3 class="hide-from-toc no-link" data-text="DLP API Client libraries" id="dlp-api-client-libraries">DLP API Client libraries</h3>
<p>
    Get started with the DLP API in your language of choice.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/reference/rest/v2">
<h3 class="hide-from-toc no-link" data-text="REST reference" id="rest-reference">REST reference</h3>
<p>REST APIs for using the DLP API.</p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/reference/rpc">
<h3 class="hide-from-toc no-link" data-text="RPC reference" id="rpc-reference">RPC reference</h3>
<p>RPC APIs for using the DLP API.</p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/infotypes-reference">
<h3 class="hide-from-toc no-link" data-text="InfoType reference" id="infotype-reference">InfoType reference</h3>
<p>Consult this table of infoTypes for use with Cloud DLP.</p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/samples]</H1></p><div class="devsite-article-body clearfix">
<p>This page contains code samples for Cloud Data Loss Prevention. To search and filter code samples for other
Google Cloud products, see the
<a class="cloud-link" href="/docs/samples?p=dlp">Google Cloud sample browser</a>.</p>
<div class="cloud-card__container">
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Character masking" id="character-masking">Character masking</h4>
<p class="cloud-body-text" id="desc">Demonstrates masking characters.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Client library quickstart" id="client-library-quickstart">Client library quickstart</h4>
<p class="cloud-body-text" id="desc">Demonstrates inspecting a string with the Cloud DLP API.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-python">
              Python
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-ruby">
              Ruby
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/libraries">Cloud DLP client libraries</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Compute l-diversity" id="compute-l-diversity">Compute l-diversity</h4>
<p class="cloud-body-text" id="desc">ComputeÂ l-diversity with Cloud DLP. L-diversity, whichÂ is an extension ofÂ k-anonymity, measures the diversity of sensitive values for each column in which they occur. A dataset hasÂ l-diversity if, for every set of rows with identical quasi-identifiers, there are at leastÂ lÂ distinct values for each sensitive attribute.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-l-diversity">Computing l-diversity for a dataset</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Compute numerical statistics" id="compute-numerical-statistics">Compute numerical statistics</h4>
<p class="cloud-body-text" id="desc">You can determine minimum, maximum, and quantile values for an individual BigQuery column. To calculate these values, you configure a DlpJob, setting the NumericalStatsConfig privacy metric to the name of the column to scan. When you run the job, Cloud DLP computes statistics for the given column, returning its results in the NumericalStatsResult object.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-stats">Computing numerical and categorical statistics</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Computing k-anonymity" id="computing-k-anonymity">Computing k-anonymity</h4>
<p class="cloud-body-text" id="desc">K-anonymity is a property of a dataset that indicates the re-identifiability of its records. A dataset is k-anonymous if quasi-identifiers for each person in the dataset are identical to at least k â 1 other people also in the dataset. This sample demonstrates how to use Cloud DLP to compute a k-anonymity value.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-k-anonymity">Computing k-anonymity for a dataset</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Computing k-map estimates " id="computing-k-map-estimates">Computing k-map estimates </h4>
<p class="cloud-body-text" id="desc">You can estimate k-map values using Cloud DLP, which uses a statistical model to estimate a re-identification dataset.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-k-map">Computing k-map for a dataset</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a job trigger" id="create-a-job-trigger">Create a job trigger</h4>
<p class="cloud-body-text" id="desc">Creates a scheduled Cloud Data Loss Prevention API job trigger.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create an exception list for de-identification" id="create-an-exception-list-for-de-identification">Create an exception list for de-identification</h4>
<p class="cloud-body-text" id="desc">Create an exception list for a regular custom dictionary detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-exception-list#dlp_deidentify_exception_list-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-exception-list#dlp_deidentify_exception_list-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-exception-list">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary detector</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create an inspection job" id="create-an-inspection-job">Create an inspection job</h4>
<p class="cloud-body-text" id="desc">Creates an inspection job with the Cloud Data Loss Prevention API.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-job#dlp_create_job-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-job#dlp_create_job-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-create-job">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create an inspection template" id="create-an-inspection-template">Create an inspection template</h4>
<p class="cloud-body-text" id="desc">Use templates to create and persist configuration information for use with Cloud DLP. Templates are useful for decoupling configuration informationâsuch as what you inspect for and how you de-identify itâfrom the implementation of your requests. Templates provide a way to re-use configuration and enable consistency across users and datasets. In addition, whenever you update a template, it's updated for any job trigger that uses it.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-inspect">Creating Cloud DLP inspection templates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Date shifting of a CSV file" id="date-shifting-of-a-csv-file">Date shifting of a CSV file</h4>
<p class="cloud-body-text" id="desc">Demonstrates date shifting of a CSV file.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="De-identify content through deterministic encryption" id="de-identify-content-through-deterministic-encryption">De-identify content through deterministic encryption</h4>
<p class="cloud-body-text" id="desc">Use the Data Loss Prevention API to de-identify sensitive data in a string using deterministic encryption, which is a reversible cryptographic method. The encryption is performed with a wrapped key.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-deterministic#dlp_deidentify_deterministic-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-deterministic">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify data using table bucketing" id="de-identify-data-using-table-bucketing">De-identify data using table bucketing</h4>
<p class="cloud-body-text" id="desc">Transform a column without inspection. To transform a column in which the content is already known, you can skip inspection and specify a transformation directly.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-bucketing#dlp_deidentify_table_bucketing-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-bucketing">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify data: Redacting with matched input values" id="de-identify-data:-redacting-with-matched-input-values">De-identify data: Redacting with matched input values</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string by redacting matched input values.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-redact#dlp_deidentify_redact-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-redact#dlp_deidentify_redact-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-redact">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="De-identify free text with FPE by using a surrogate" id="de-identify-free-text-with-fpe-by-using-a-surrogate">De-identify free text with FPE by using a surrogate</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string using format-preserving encryption (FPE). The encryption is performed with an unwrapped key.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-free-text-with-fpe-using-surrogate#dlp_deidentify_free_text_with_fpe_using_surrogate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-free-text-with-fpe-using-surrogate">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify sensitive data by replacing with infoType" id="de-identify-sensitive-data-by-replacing-with-infotype">De-identify sensitive data by replacing with infoType</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string by replacing it with the infoType.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace-infotype#dlp_deidentify_replace_infotype-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace-infotype">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data">Redacting sensitive data from text</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify sensitive data with a simple word list" id="de-identify-sensitive-data-with-a-simple-word-list">De-identify sensitive data with a simple word list</h4>
<p class="cloud-body-text" id="desc">Matches against a custom simple word list to de-identify sensitive data.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-simple-word-list#dlp_deidentify_simple_word_list-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-simple-word-list#dlp_deidentify_simple_word_list-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-simple-word-list">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary detector</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify sensitive data: Replacing matched input values" id="de-identify-sensitive-data:-replacing-matched-input-values">De-identify sensitive data: Replacing matched input values</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string by replacing matched input values with a value that you specify.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace#dlp_deidentify_replace-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace#dlp_deidentify_replace-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace#dlp_deidentify_replace-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data using conditional logic and replace with infoTypes" id="de-identify-table-data-using-conditional-logic-and-replace-with-infotypes">De-identify table data using conditional logic and replace with infoTypes</h4>
<p class="cloud-body-text" id="desc">Transform findings only when specific conditions are met on another field.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-infotypes#dlp_deidentify_table_condition_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data using masking and conditional logic" id="de-identify-table-data-using-masking-and-conditional-logic">De-identify table data using masking and conditional logic</h4>
<p class="cloud-body-text" id="desc">Transform a column based on the value of another column.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-masking#dlp_deidentify_table_condition_masking-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-masking">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="De-identify table data with format-preserving encryption" id="de-identify-table-data-with-format-preserving-encryption">De-identify table data with format-preserving encryption</h4>
<p class="cloud-body-text" id="desc">Demonstrates encrypting sensitive data in a table while maintaining format.
</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-fpe#dlp_deidentify_table_fpe-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data with infoTypes" id="de-identify-table-data-with-infotypes">De-identify table data with infoTypes</h4>
<p class="cloud-body-text" id="desc">Transform findings found in columns.  You can transform findings that either make up part of a cell's content or all of it. In this example, all instances of PERSON_NAME are anonymized.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-infotypes#dlp_deidentify_table_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data: Suppress a row based on the content of a column" id="de-identify-table-data:-suppress-a-row-based-on-the-content-of-a-column">De-identify table data: Suppress a row based on the content of a column</h4>
<p class="cloud-body-text" id="desc">Suppress a row based on the content of a column.  You can remove a row entirely based on the content that appears in any column. This example suppresses the record for "Charles Dickens," as this patient is over 89 years old.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-row-suppress#dlp_deidentify_table_row_suppress-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-row-suppress">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete a job" id="delete-a-job">Delete a job</h4>
<p class="cloud-body-text" id="desc">Delete a DLP job.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete a trigger" id="delete-a-trigger">Delete a trigger</h4>
<p class="cloud-body-text" id="desc">Delete a DLP trigger.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-php">
              PHP
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete an inspection template" id="delete-an-inspection-template">Delete an inspection template</h4>
<p class="cloud-body-text" id="desc">Delete an inspection template from Cloud DLP.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-deid">Creating Cloud DLP de-identification templates</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-inspect">Creating Cloud DLP inspection templates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Format-preserving encryption (FPE)" id="format-preserving-encryption-fpe">Format-preserving encryption (FPE)</h4>
<p class="cloud-body-text" id="desc">Demonstrates encrypting sensitive characters while maintaining format.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Get an inspection job" id="get-an-inspection-job">Get an inspection job</h4>
<p class="cloud-body-text" id="desc">Get DLP inspection job.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-get-job#dlp_get_job-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-get-job#dlp_get_job-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-get-job">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a Cloud Storage file" id="inspect-a-cloud-storage-file">Inspect a Cloud Storage file</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data in a file that is located in Cloud Storage.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a local file" id="inspect-a-local-file">Inspect a local file</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data in a local text or image file.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-python">
              Python
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-ruby">
              Ruby
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-text">Inspecting text for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string" id="inspect-a-string">Inspect a string</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data in a string.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-python">
              Python
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-ruby">
              Ruby
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-text">Inspecting text for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data by using multiple rules" id="inspect-a-string-for-sensitive-data-by-using-multiple-rules">Inspect a string for sensitive data by using multiple rules</h4>
<p class="cloud-body-text" id="desc">Illustrates applying both exclusion and hotword rules. This snippet's rule set includes both hotword rules and dictionary and regex exclusion rules. Notice that the four rules are specified in an array within the rules element.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules#dlp_inspect_string_multiple_rules-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules#dlp_inspect_string_multiple_rules-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules#dlp_inspect_string_multiple_rules-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, excluding a custom substring" id="inspect-a-string-for-sensitive-data,-excluding-a-custom-substring">Inspect a string for sensitive data, excluding a custom substring</h4>
<p class="cloud-body-text" id="desc">Illustrates how to use an InspectConfig to instruct Cloud DLP to avoid matching on the name "Jimmy" in a scan that uses the specified custom regular expression detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring#dlp_inspect_string_custom_excluding_substring-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring#dlp_inspect_string_custom_excluding_substring-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring#dlp_inspect_string_custom_excluding_substring-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, omitting custom matches" id="inspect-a-string-for-sensitive-data,-omitting-custom-matches">Inspect a string for sensitive data, omitting custom matches</h4>
<p class="cloud-body-text" id="desc">Omit scan matches from a PERSON_NAME detector scan that overlap with a custom detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap#dlp_inspect_string_custom_omit_overlap-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap#dlp_inspect_string_custom_omit_overlap-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap#dlp_inspect_string_custom_omit_overlap-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, omitting overlapping matches on domain and email" id="inspect-a-string-for-sensitive-data,-omitting-overlapping-matches-on-domain-and-email">Inspect a string for sensitive data, omitting overlapping matches on domain and email</h4>
<p class="cloud-body-text" id="desc">Omit matches on domain names that are part of email addresses in a DOMAIN_NAME detector scan.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap#dlp_inspect_string_without_overlap-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap#dlp_inspect_string_without_overlap-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap#dlp_inspect_string_without_overlap-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, omitting overlapping matches on person and email" id="inspect-a-string-for-sensitive-data,-omitting-overlapping-matches-on-person-and-email">Inspect a string for sensitive data, omitting overlapping matches on person and email</h4>
<p class="cloud-body-text" id="desc">Omit matches on a PERSON_NAME detector if also matched by an EMAIL_ADDRESS detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-omit-overlap#dlp_inspect_string_omit_overlap-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-omit-overlap#dlp_inspect_string_omit_overlap-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-omit-overlap">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, using exclusion dictionary" id="inspect-a-string-for-sensitive-data,-using-exclusion-dictionary">Inspect a string for sensitive data, using exclusion dictionary</h4>
<p class="cloud-body-text" id="desc">Omit a specific email address from an EMAIL_ADDRESS detector scan with an exclusion dictionary.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict#dlp_inspect_string_with_exclusion_dict-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict#dlp_inspect_string_with_exclusion_dict-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict#dlp_inspect_string_with_exclusion_dict-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string from sensitive data by using a custom hotword" id="inspect-a-string-from-sensitive-data-by-using-a-custom-hotword">Inspect a string from sensitive data by using a custom hotword</h4>
<p class="cloud-body-text" id="desc">Increase the likelihood of a PERSON_NAME match if there is the hotword "patient" nearby. 
Illustrates using the InspectConfig property for the purpose of scanning a medical database for patient names. You can use Cloud DLP's built-in PERSON_NAME infoType detector, but that causes Cloud DLP to match on all names of people, not just names of patients. To fix this, you can include a hotword rule that looks for the word "patient" within a certain character proximity from the first character of potential matches. You can then assign findings that match this pattern a likelihood of "very likely," since they correspond to your special criteria. Setting the minimum likelihood to VERY_LIKELY within InspectConfig ensures that only matches to this configuration are returned in findings.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-hotword#dlp_inspect_string_custom_hotword-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-hotword#dlp_inspect_string_custom_hotword-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-hotword">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string with an exclusion dictionary substring" id="inspect-a-string-with-an-exclusion-dictionary-substring">Inspect a string with an exclusion dictionary substring</h4>
<p class="cloud-body-text" id="desc">Omit scan matches that include the substring "TEST".</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring#dlp_inspect_string_with_exclusion_dict_substring-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring#dlp_inspect_string_with_exclusion_dict_substring-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring#dlp_inspect_string_with_exclusion_dict_substring-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string, excluding REGEX matches" id="inspect-a-string,-excluding-regex-matches">Inspect a string, excluding REGEX matches</h4>
<p class="cloud-body-text" id="desc">Omit email addresses ending with a specific domain from an EMAIL_ADDRESS detector scan.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex#dlp_inspect_string_with_exclusion_regex-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex#dlp_inspect_string_with_exclusion_regex-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex#dlp_inspect_string_with_exclusion_regex-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a table for sensitive content" id="inspect-a-table-for-sensitive-content">Inspect a table for sensitive content</h4>
<p class="cloud-body-text" id="desc">Check a table of data for sensitive content.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-table#dlp_inspect_table-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-table#dlp_inspect_table-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-table">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-structured-text">Inspecting structured text for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect an image file for sensitive data" id="inspect-an-image-file-for-sensitive-data">Inspect an image file for sensitive data</h4>
<p class="cloud-body-text" id="desc">Uses Cloud DLP to inspect an image for sensitive data.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-file#dlp_inspect_image_file-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-file#dlp_inspect_image_file-php">
              PHP
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-file">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect an image for sensitive data with listed infoTypes" id="inspect-an-image-for-sensitive-data-with-listed-infotypes">Inspect an image for sensitive data with listed infoTypes</h4>
<p class="cloud-body-text" id="desc">If you want to inspect an image for only certain sensitive data types, specify their corresponding built-in infoTypes.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-listed-infotypes#dlp_inspect_image_listed_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-listed-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect BigQuery for sensitive data" id="inspect-bigquery-for-sensitive-data">Inspect BigQuery for sensitive data</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data that is stored in BigQuery.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect BigQuery for sensitive data with sampling" id="inspect-bigquery-for-sensitive-data-with-sampling">Inspect BigQuery for sensitive data with sampling</h4>
<p class="cloud-body-text" id="desc">The following examples demonstrate using the Cloud Data Loss Prevention API to scan a 1000-row subset of a BigQuery table. The scan starts from a random row.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery-with-sampling#dlp_inspect_bigquery_with_sampling-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery-with-sampling">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect data for phone numbers" id="inspect-data-for-phone-numbers">Inspect data for phone numbers</h4>
<p class="cloud-body-text" id="desc">Demonstrates a simple scan request to the Cloud DLP API. Notice that the PHONE_NUMBER detector is specified in inspectConfig, which instructs Cloud DLP to scan the given string for a phone number.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-phone-number#dlp_inspect_phone_number-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-phone-number">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/concepts-infotypes">InfoTypes and infoType detectors</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect data with a custom regex" id="inspect-data-with-a-custom-regex">Inspect data with a custom regex</h4>
<p class="cloud-body-text" id="desc">Regex example: Matching medical record numbers.
The following sample uses a regular expression custom infoType detector that instructs Cloud DLP to match a medical record number (MRN) in the input text "Patient's MRN 444-5-22222," and then assigns each match a likelihood of POSSIBLE.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-custom-regex#dlp_inspect_custom_regex-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-custom-regex">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-regex">Creating a custom regex detector</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-custom-infotypes">Examples of custom infotype detectors</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect data with a hotword rule" id="inspect-data-with-a-hotword-rule">Inspect data with a hotword rule</h4>
<p class="cloud-body-text" id="desc">This sample uses a custom regex with a hotword rule to increase the likelihood of match.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-hotword-rule#dlp_inspect_hotword_rule-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-hotword-rule">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-likelihood">Customizing match likelihood</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect Datastore" id="inspect-datastore">Inspect Datastore</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data stored in Datastore.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect image for sensitive data with infoTypes" id="inspect-image-for-sensitive-data-with-infotypes">Inspect image for sensitive data with infoTypes</h4>
<p class="cloud-body-text" id="desc">To inspect an image for sensitive data, you submit a base64-encoded image to the Cloud DLP API's content.inspect method. Unless you specify information types (infoTypes) to search for, Cloud DLP searches for the most common infoTypes.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-all-infotypes#dlp_inspect_image_all_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-all-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect storage with sampling" id="inspect-storage-with-sampling">Inspect storage with sampling</h4>
<p class="cloud-body-text" id="desc">The following examples demonstrate using the Cloud DLP API to scan a 90% subset of a Cloud Storage bucket for person names. The scan starts from a random location in the dataset and only includes text files under 200 bytes.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs-with-sampling#dlp_inspect_gcs_with_sampling-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs-with-sampling">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List information types for a category" id="list-information-types-for-a-category">List information types for a category</h4>
<p class="cloud-body-text" id="desc">Demonstrates listing information types for a category.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/listing-infotypes">Listing built-in infoType detectors</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List jobs" id="list-jobs">List jobs</h4>
<p class="cloud-body-text" id="desc">List all Cloud DLP jobs for the current project.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List templates" id="list-templates">List templates</h4>
<p class="cloud-body-text" id="desc">List inspection or de-identification templates.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-php">
              PHP
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-deid">Creating Cloud DLP de-identification templates</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-inspect">Creating Cloud DLP inspection templates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List triggers" id="list-triggers">List triggers</h4>
<p class="cloud-body-text" id="desc">List all job triggers for the current project.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Perform risk analysis" id="perform-risk-analysis">Perform risk analysis</h4>
<p class="cloud-body-text" id="desc">Use the Data Loss Prevention API to compute risk metrics of a column of categorical data in a BigQuery table.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-stats">Computing numerical and categorical statistics</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify content encrypted by deterministic encryption" id="re-identify-content-encrypted-by-deterministic-encryption">Re-identify content encrypted by deterministic encryption</h4>
<p class="cloud-body-text" id="desc">Re-identify content that was previously de-identified through deterministic encryption.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-deterministic#dlp_reidentify_deterministic-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-deterministic">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify content encrypted by FPE" id="re-identify-content-encrypted-by-fpe">Re-identify content encrypted by FPE</h4>
<p class="cloud-body-text" id="desc">Demonstrates re-identifying de-identified content.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify free text with FPE using a surrogate" id="re-identify-free-text-with-fpe-using-a-surrogate">Re-identify free text with FPE using a surrogate</h4>
<p class="cloud-body-text" id="desc">Uses the Cloud Data Loss Prevention API to re-identify sensitive data in a string that was encrypted by format-preserving encryption (FPE) with a surrogate type. The encryption is performed with an unwrapped key.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-free-text-with-fpe-using-surrogate#dlp_reidentify_free_text_with_fpe_using_surrogate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-free-text-with-fpe-using-surrogate">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify table data with FPE" id="re-identify-table-data-with-fpe">Re-identify table data with FPE</h4>
<p class="cloud-body-text" id="desc">Re-identify table data with format-preserving encryption.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-table-fpe#dlp_reidentify_table_fpe-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-table-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify text data with FPE" id="re-identify-text-data-with-fpe">Re-identify text data with FPE</h4>
<p class="cloud-body-text" id="desc">Re-identify text data with format-preserving encryption.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-text-fpe#dlp_reidentify_text_fpe-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-text-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact all detected text in an image" id="redact-all-detected-text-in-an-image">Redact all detected text in an image</h4>
<p class="cloud-body-text" id="desc">Redact all detected text in an image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-text#dlp_redact_image_all_text-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-text#dlp_redact_image_all_text-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-text">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact an image" id="redact-an-image">Redact an image</h4>
<p class="cloud-body-text" id="desc">Demonstrates redacting sensitive data from an image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact data from an image with color-coded infoTypes" id="redact-data-from-an-image-with-color-coded-infotypes">Redact data from an image with color-coded infoTypes</h4>
<p class="cloud-body-text" id="desc">Redacting infoTypes from an image with color coding.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-colored-infotypes#dlp_redact_image_colored_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-colored-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact only certain sensitive data from an image using infoTypes" id="redact-only-certain-sensitive-data-from-an-image-using-infotypes">Redact only certain sensitive data from an image using infoTypes</h4>
<p class="cloud-body-text" id="desc">Redact only certain sensitive data from an image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-listed-infotypes#dlp_redact_image_listed_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-listed-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact sensitive data from an image using default infoTypes" id="redact-sensitive-data-from-an-image-using-default-infotypes">Redact sensitive data from an image using default infoTypes</h4>
<p class="cloud-body-text" id="desc">Redact the default infoTypes from this image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-infotypes#dlp_redact_image_all_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/support]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="support">
<header>
</header>
<ul class="card-showcase">
<li>
<a class="no-logo" href="/dlp/docs/support/getting-support">
<h3 class="hide-from-toc no-link" data-text="Getting support" id="getting-support">Getting support</h3>
<p>
    Where to find support when using Cloud DLP.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/support/billing-questions">
<h3 class="hide-from-toc no-link" data-text="Billing questions" id="billing-questions">Billing questions</h3>
<p>
    Learn about resources for answering common billing questions.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/support/data-security">
<h3 class="hide-from-toc no-link" data-text="Data security" id="data-security">Data security</h3>
<p>
    Learn about Cloud DLP and data security, including
    certifications, compliance, and encryption.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/known-issues">
<h3 class="hide-from-toc no-link" data-text="Known issues" id="known-issues">Known issues</h3>
<p>
    Learn about known issues with Cloud DLP.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/resources]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="resources">
<ul class="card-showcase">
<li>
<a class="no-logo" href="/dlp/pricing">
<h3 class="hide-from-toc no-link" data-text="Pricing" id="pricing">Pricing</h3>
<p>
    Pricing guidelines and examples for Cloud Data Loss Prevention.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/limits">
<h3 class="hide-from-toc no-link" data-text="Quotas and limits" id="quotas-and-limits">Quotas and limits</h3>
<p>
    Restrictions and usage limits that apply to using Cloud DLP.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/release-notes">
<h3 class="hide-from-toc no-link" data-text="Release notes" id="release-notes">Release notes</h3>
<p>
    Release notes for Cloud DLP.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/locations">
<h3 class="hide-from-toc no-link" data-text="Locations" id="locations">Locations</h3>
<p>
    Listing of supported regions and multi-regions.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/solutions">
<h3 class="hide-from-toc no-link" data-text="Blog posts, solutions, and videos" id="blog-posts,-solutions,-and-videos">Blog posts, solutions, and videos</h3>
<p>
    Links to Cloud DLP blog posts, solutions, and videos.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/sla">
<h3 class="hide-from-toc no-link" data-text="Service level agreement" id="service-level-agreement">Service level agreement</h3>
<p>
    The service level agreement (SLA) for the Cloud Data Loss Prevention API.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/best-practices-costs">
<h3 class="hide-from-toc no-link" data-text="Controlling costs" id="controlling-costs">Controlling costs</h3>
<p>
    Best practices for controlling costs.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<cloudx-tags tags="5D6Y89"></cloudx-tags>
<style>
  body[layout='full'] {
    background: #fff;
  }
</style>
<article id="cloud-site">
<style>
      .module-section:first-child {
        margin-top: 48px;
      }

      .module-section:empty {
        display: none;
      }

      .module-section:not(:empty) {
        margin-bottom: 48px;
      }

      div.richtext {
        color: #5f6368;
      }

      .richtext p {
        color: inherit;
        font: inherit;
        margin-bottom: 0;
      }

      .cloud-jump-content {
        padding-top: 72px;
      }

      .cloud-module__description p {
        margin: 0;
      }

      .cloud-module__description p+p {
        margin-top: 16px;
      }

      @media(min-width: 1024px) {
        .module-section:first-child {
          margin-top: 60px;
        }

        .module-section:not(:empty) {
          margin-bottom: 60px;
        }
      }

      @media(min-width: 1280px) {
        .cloud-jump-content {
          padding-top: 0;
        }
      }

      .cloud-block__image {
        width: 100%;
      }
    </style>
<style>
      .product-template__benefits:not(:empty) {
        margin-top: 36px;
      }

      .product-v2-template .cloud-chip {
        text-decoration: none;
      }
    </style>
<section class="module-section">
<div class="cws-banner cws-fullbleed" track-metadata-module="banner">
<p class="cws-banner__body-copy">
<span><a class="cws-link cws-link--dark" href="https://cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-name="automatic dlp" track-type="inline link">Automatic DLP</a>
            for BigQuery is now GA â our fully managed service designed to
            helpÂ  discover, inspect, classify, and protect data in
            BigQuery.</span></p>
</div> </section>
<style>
      .in-page-navigation-module cloudx-jump-menu[mixed],
      .in-page-navigation-module .cloud-jump-menu {
        padding-top: 0
      }

      .in-page-navigation-module .bricks-jump-menu {
        background-color: #f8f9fa;
      }

      @media(min-width: 1024px) {
        .in-page-navigation-module .bricks-jump-menu {
          margin-top: 60px;
        }

        .in-page-navigation-module .bricks-jump-menu--has-banner {
          margin-top: 0;
        }
      }

      #cloud-site cloudx-jump-menu .in-page-navigation-module__headline {
        margin-top: 0;
      }
    </style>
<div class="in-page-navigation-module">
<cloudx-jump-menu class="bricks-jump-menu--has-banner" label="Jump to" label-hidden-large="" mixed="">
<div class="cloud-menu-content">
<a class="cloud-jump-menu__toggle cloud-jump-menu__toggle--hide-large" href="#">Jump to<i aria-hidden="true" class="material-icons" translate="no"><span></span></i></a>
<div class="cloud-jump-menu__links">
<span class="cloud-subhead in-page-navigation-module__headline">
              Cloud Data Loss Prevention </span>
<div class="cloud-jump-menu__active-page"></div>
</div>
</div>
</cloudx-jump-menu>
</div>
<div class="product-v2-template cloud-jump-content">
<section class="module-section">
<style>
          .hero-module__title {
            color: #4185f4;
          }

          .hero-module--centered.hero-module--no-hero-asset .hero-module__content {
            text-align: center;
          }

          @media(max-width: 1024px) {
            .hero-module--centered .hero-module__content {
              text-align: center;
            }
          }
        </style>
<div class="hero-module hero-module--product" track-metadata-module="hero" track-metadata-module_headline="cloud data loss prevention" track-metadata-position="hero">
<div class="cws-grid">
<div class="cws-grid__col--span-12">
</div>
</div>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="cws-content-block">
<div class="cws-content-block__content hero-module__content">
<div class="cws-content-block__headline">
<h1 class="cws-headline--headline-3" data-text=" Cloud Data Loss                       Prevention " id="cloud-data-loss-prevention"> Cloud Data Loss
                      Prevention </h1>
</div>
<div class="cws-content-block__text">
<div class="cws-body--large richtext">Fully managed service
                      designed to help you discover, classify, and protect your
                      most sensitive data.</div>
</div>
</div>
</div>
<div class="cws-spacer-4--top">
<div class="cws-button__set">
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/freetrial" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/freetrial" track-metadata-modifier="high-emphasis" track-name="try cloud dlp free" track-type="button">


      Try Cloud DLP free
      
    
      </a>
</slot>
<slot slot="ineligible">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/dlp" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/dlp" track-metadata-modifier="high-emphasis" track-name="go to console" track-type="button">


      Go to console
      
    
      </a>
</slot>
</cloudx-free-trial-eligible-content>
</div>
</div>
<div class="cws-spacer-4--top cws-spacer-4--bottom">
<ul class="cws-bulleted-list">
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">Take
                      charge of your data on or off cloud</span>
</li>
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">
<p>Gain visibility into sensitive data risk across your
                        entire organization</p>
</span>
</li>
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">
<p>Reduce data risk with obfuscation and de-identification
                        methods like masking and tokenization</p>
</span>
</li>
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">Seamlessly
                      inspect and transform structured and unstructured
                      data</span>
</li>
</ul>
</div>
</div>
<div class="hero-module__right-rail cws-grid__col--span-4">
<a class="cws-card" href="https://cloud.google.com/resources/forrester-unstructured-data-security-2021-report" track-metadata-child_headline="google cloud named a leader in the forrester wave unstructured data security platforms q2 2021 report" track-metadata-eventdetail="cloud.google.com/resources/forrester-unstructured-data-security-2021-report" track-metadata-module="hero" track-metadata-module_headline="cloud data loss prevention" track-metadata-position="hero" track-name="google cloud named a leader in the forrester wave unstructured data security platforms q2 2021 report" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
</div>
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-5">Google Cloud named a Leader in The Forrester Waveâ¢: Unstructured Data Security Platforms, Q2 2021 report.</p>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Get the report
        </span>
</div>
</div>
</a>
</div>
</div>
</div> <div class="product-template__benefits">
<div class="cloud-jump-section" data-cloud-main-text="Benefits">
<p class="cws-label" style="margin-bottom: 16px;">Benefits</p>
<style>
              .benefit-module__copy-block {
                border: 1px solid #dbdce0;
                padding: 36px;
              }

              @media(max-width: 767px) {
                .benefit-module__copy-block {
                  padding: 24px;
                }
              }
            </style>
<div class="benefits-module" track-metadata-module="benefits">
<div class="cws-spacer-2--bottom">
<div class="cws-content-block">
</div>
</div>
<div class="benefit-module__copy-block cws-grid">
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                         Gain visibility into the data you store and process" id="gain-visibility-into-the-data-you-store-and-process">
                        Gain visibility into the data you store and process</h4>
<div class="cws-body cws-content-block__text">
<p>Create dashboards and audit reports. Automate
                          tagging, remediation, or policy based on findings.
                          Connect DLP results into Security Command Center, Data
                          Catalog, or export to your own SIEM or governance
                          tool.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                         Configure data inspection and monitoring with ease" id="configure-data-inspection-and-monitoring-with-ease">
                        Configure data inspection and monitoring with ease</h4>
<div class="cws-body cws-content-block__text">
<p>Enable DLP across your entire BigQuery footprint to
                          automatically discover, inspect, and classify your
                          data. DLP runs continuously, picking up new data
                          tables as they are added, so you can focus on
                          analysis.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                         Reduce risk to unlock more data for your business" id="reduce-risk-to-unlock-more-data-for-your-business">
                        Reduce risk to unlock more data for your business</h4>
<div class="cws-body cws-content-block__text">
<p>Protection of sensitive data, like personally
                          identifiable information (PII), is critical to your
                          business. Deploy de-identification in migrations, data
                          workloads, and real-time data collection and
                          processing.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="module-section"></section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-main-text="Key features">
<p class="cws-label" style="margin-bottom: 16px;">Key features</p>
<style>
            .key-features-module__eyebrow {
              margin-bottom: 8px;
            }

            .key-features-module__key-feature img {
              width: auto;
            }
          </style>
<div class="key-features-module" track-metadata-module="key features" track-metadata-module_headline="key features">
<div class="cws-grid">
<div class="key-features-module__headline cws-spacer-4--bottom cws-grid__col--span-8">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                       Key features" id="key-features">
                      Key features</h2>
</div>
</div>
</div>
</div>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Automated sensitive data discovery for your data                         warehouse" id="automated-sensitive-data-discovery-for-your-data-warehouse">
                        Automated sensitive data discovery for your data
                        warehouse</h3>
<div class="cws-body cws-content-block__text">
<p>Discover sensitive data by profiling every BigQuery
                          table and column across your entire organization,
                          select organization folders, or individual projects.
                          Configure directly in the Cloud Console UI and let DLP
                          handle the rest. Use table and column profiles to
                          inform your security and privacy posture.</p>
</div>
</div>
</div>
</div>
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Use Cloud DLP from virtually anywhere, on or off Cloud                       " id="use-cloud-dlp-from-virtually-anywhere,-on-or-off-cloud">
                        Use Cloud DLP from virtually anywhere, on or off Cloud
                      </h3>
<div class="cws-body cws-content-block__text">
<p>With over
                          <a class="cws-link" href="/dlp/docs/infotypes-reference" track-metadata-eventdetail="cloud.google.com/dlp/docs/infotypes-reference" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="150 built-in infotypes" track-type="content block">150 built-in infoTypes</a>,
                          Cloud DLP gives you the power to scan, discover,
                          classify, and report on data from virtually anywhere.
                          Cloud DLP has built-in support for scanning and
                          classifying sensitive data in Cloud Storage, BigQuery,
                          and Datastore, and a streaming content API to enable
                          support for additional data sources, custom workloads,
                          and applications.</p>
</div>
</div>
</div>
</div>
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Automatically mask your data to safely unlock more of                         the cloud" id="automatically-mask-your-data-to-safely-unlock-more-of-the-cloud">
                        Automatically mask your data to safely unlock more of
                        the cloud</h3>
<div class="cws-body cws-content-block__text">
<p>Cloud DLP provides tools to classify, mask, tokenize,
                          and transform sensitive elements to help you better
                          manage the data that you collect, store, or use for
                          business or analytics. With support for
                          <a class="cws-link" href="/dlp/docs/examples-deid-tables" track-metadata-eventdetail="cloud.google.com/dlp/docs/examples-deid-tables" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="structured" track-type="content block">structured</a>
                          and
                          <a class="cws-link" href="/dlp/docs/deidentify-sensitive-data" track-metadata-eventdetail="cloud.google.com/dlp/docs/deidentify-sensitive-data" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="unstructured" track-type="content block">unstructured</a>
                          data, Cloud DLP can help you preserve the utility of
                          your data for joining, analytics, and AI while
                          protecting the raw sensitive identifiers.</p>
</div>
</div>
</div>
</div>
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Measure re-identification risk in structured data" id="measure-re-identification-risk-in-structured-data">
                        Measure re-identification risk in structured data</h3>
<div class="cws-body cws-content-block__text">
<p>Enhance your understanding of data privacy risk.
                          Quasi-identifiers are partially identifying elements
                          or combinations of data that may link to a single
                          person or a very small group. Cloud DLP allows you to
                          measure statistical properties such as k-anonymity and
                          l-diversity, expanding your ability to understand and
                          protect data privacy.</p>
</div>
</div>
</div>
</div>
<a class="cws-button cws-button--low-emphasis cws-button--align-left cloud-smooth-scroll" href="#all-features" track-metadata-eventdetail="cloud.google.com" track-metadata-modifier="low-emphasis" track-name="view all features" track-type="button">


      View all features
      
    
      </a>
</div>
<div class="key-features-module__right-rail cws-grid__col--span-4">
<a class="cws-card lb" data-lightbox-height="506" data-lightbox-width="900" href="https://youtube.com/watch?v=7RqG-pjgZeQ&amp;autoplay=1?t=1" rel="noopener" target="_blank" track-metadata-child_eyebrow="video" track-metadata-child_headline="learn how cloud dlp helps enterprises discover and manage sensitive data assets" track-metadata-eventdetail="youtube.com/watch" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="learn how cloud dlp helps enterprises discover and manage sensitive data assets" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--video">
<picture>
<source srcset="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rw-lo-sc0xffffff-h338-w600 1x,https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rw-lo-sc0xffffff-h676-w1200 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h338-w600 1x,https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h676-w1200 2x" type="image/jpeg"/>
<img alt="Thumbnail from Cloud OnAir presentation: Protecting sensitive datasets in Google Cloud" class="" loading="lazy" src="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h338-w600" srcset="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h676-w1200 2x"/>
</picture>
<span aria-hidden="true">
<svg class="cws-icon" height="18px" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M23.74 7.1s-.23-1.65-.95-2.37c-.91-.96-1.93-.96-2.4-1.02C17.04 3.47 12 3.5 12 3.5s-5.02-.03-8.37.21c-.46.06-1.48.06-2.39 1.02C.52 5.45.28 7.1.28 7.1S.04 9.05 0 10.98V13c.04 1.94.28 3.87.28 3.87s.24 1.65.96 2.38c.91.95 2.1.92 2.64 1.02 1.88.18 7.91.22 8.12.22 0 0 5.05.01 8.4-.23.46-.06 1.48-.06 2.39-1.02.72-.72.96-2.37.96-2.37s.24-1.94.25-3.87v-2.02c-.02-1.93-.26-3.88-.26-3.88zM9.57 15.5V8.49L16 12.13 9.57 15.5z"></path></svg>
</span>
</div>
<div class="cws-card__content">
<p class="cws-label">VIDEO</p>
<p class="cws-headline cws-headline--headline-5">Learn how Cloud DLP helps enterprises discover and manage sensitive data assets.</p>
<p class="cws-small-text">37:55</p>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
</section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-main-text="Customers">
<style>
            .customer-module__carousel .cloud-carousel {
              padding: 0;
            }
          </style>
<div class="customer-module" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action">
<p class="cws-label">Customers</p>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="customer-module__headline cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                         See DLP in action" id="see-dlp-in-action">
                        See DLP in action</h2>
</div>
</div>
</div>
</div>
</div>
<div class="customer-module__carousel cws-spacer-4--bottom">
<style>
                @media (max-width: 480px) {
                  .cloud-carousel--bleed-right {
                    margin-right: 0;
                  }

                  .cloud-carousel__slide {
                    margin-right: 16px;
                  }
                }
              </style>
<div class="cloud-carousel cloud-carousel--3up cloud-carousel--margin-tight">
<div class="cloud-carousel__slide-deck-container">
<div class="cloud-carousel__slide-deck" role="group">
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/sittercity" track-metadata-child_eyebrow="case study" track-metadata-child_headline="sittercity uses uses cloud dlp api to detect and redact personal data to keep its service secure" track-metadata-child_index="1" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/sittercity" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="sittercity uses uses cloud dlp api to detect and redact personal data to keep its service secure" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="Sittercity logo" class="" src="https://lh3.googleusercontent.com/yKu7jAeos7YSTgrJ9FCi88Dcx3oIRdd08nkO_OZu7smei1CH8AZsaPCkCMTgaiVf8axaS-pBlS3c=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/yKu7jAeos7YSTgrJ9FCi88Dcx3oIRdd08nkO_OZu7smei1CH8AZsaPCkCMTgaiVf8axaS-pBlS3c=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">Sittercity uses uses Cloud DLP API to detect and redact personal data to keep its service secure.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/featured/paypal" track-metadata-child_eyebrow="case study" track-metadata-child_headline="paypal uses cloud dlp to secure sensitive data" track-metadata-child_index="2" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/featured/paypal/index.html" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="paypal uses cloud dlp to secure sensitive data" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="PayPal" class="" src="https://lh3.googleusercontent.com/60Hm2cszoJ78rOSK4YalVQ7v0GC40eZjxbcrzAIh9zRjM8AFUhyF8IDIG8vzMJ2r0TmwGhDp-fXn=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/60Hm2cszoJ78rOSK4YalVQ7v0GC40eZjxbcrzAIh9zRjM8AFUhyF8IDIG8vzMJ2r0TmwGhDp-fXn=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">PayPal uses Cloud DLP to secure sensitive data.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/ambra-health" track-metadata-child_eyebrow="case study" track-metadata-child_headline="ambra health uses the cloud dlp api for managing and redacting sensitive patient data at scale" track-metadata-child_index="3" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/ambra-health/" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="ambra health uses the cloud dlp api for managing and redacting sensitive patient data at scale" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="ambra health" class="" src="https://lh3.googleusercontent.com/ZG7P3eiWrSt1J19qxA-ZoeSGWosq9EHNV8dJA3CbE6CvNYvam69D1JIQIF6FbkuQscF7doQ-tqTy=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/ZG7P3eiWrSt1J19qxA-ZoeSGWosq9EHNV8dJA3CbE6CvNYvam69D1JIQIF6FbkuQscF7doQ-tqTy=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">Ambra health uses the Cloud DLP API for managing and redacting sensitive patient data at scale.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/sunway-group" track-metadata-child_eyebrow="case study" track-metadata-child_headline="sunway group uses cloud dlp to classify and protect sensitive data in their data processing pipelines" track-metadata-child_index="4" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/sunway-group" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="sunway group uses cloud dlp to classify and protect sensitive data in their data processing pipelines" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="Sunway Group" class="" src="https://lh3.googleusercontent.com/NSuQnqfqQX6l1aqWQvQ8LYbsABw6IdRO3lY3EGRrctjxiGwT9IanjE4bYYe1IButUn0YBlp3kBU8gg=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/NSuQnqfqQX6l1aqWQvQ8LYbsABw6IdRO3lY3EGRrctjxiGwT9IanjE4bYYe1IButUn0YBlp3kBU8gg=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">Sunway Group uses Cloud DLP to classify and protect sensitive data in their data processing pipelines.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
</div>
</div>
<div class="cloud-carousel__controls cloud-carousel__controls--hide-nuggets">
<div class="cloud-carousel__arrow left-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_left</i>
</div>
<div class="cloud-carousel__arrow right-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_right</i>
</div>
<div class="cloud-carousel__nuggets">
<div class="cloud-carousel__nugget"></div>
</div>
</div>
</div>
</div>
<div>
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://cloud.google.com/customers" track-metadata-eventdetail="cloud.google.com/customers" track-metadata-modifier="low-emphasis" track-name="see all customers" track-type="button">


      See all customers
      
    
      </a>
</div>
</div>
</div> </section>
<section class="module-section"></section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-main-text="What's new">
<style>
            .whats-new-module .cloud-carousel {
              padding: 0;
            }

            @media (max-width: 767px) {
              .whats-new-module .cloud-carousel--3up .cloud-carousel__slide {
                padding: 0 24px;
                align-items: start;
              }
            }
          </style>
<div class="whats-new-module" track-metadata-module="whats new" track-metadata-module_headline="whats new">
<p class="cws-label">What's new</p>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="whats-new-module__headline cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                         What's new" id="whats-new">
                        What's new</h2>
<div class="cws-body cws-content-block__text">
<p>
<a class="cws-link" href="https://cloud.google.com/newsletter" track-metadata-eventdetail="cloud.google.com/newsletter" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="sign up" track-type="content block">Sign up</a>
                          for Google Cloud newsletters to receive product
                          updates, event information, special offers, and more.
                        </p>
</div>
</div>
</div>
</div>
</div>
</div>
<style>
              @media (max-width: 480px) {
                .cloud-carousel--bleed-right {
                  margin-right: 0;
                }

                .cloud-carousel__slide {
                  margin-right: 16px;
                }
              }
            </style>
<div class="cloud-carousel cloud-carousel--3up">
<div class="cloud-carousel__slide-deck-container">
<div class="cloud-carousel__slide-deck" role="group">
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="https://cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="automatic data risk management for bigquery using dlp" track-metadata-child_index="1" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="People analysing data" class="" src="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Automatic data risk management for BigQuery using DLP</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="scan for sensitive data in just a few clicks" track-metadata-child_index="2" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Blog logo" class="" src="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Scan for sensitive data in just a few clicks</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="https://cloud.google.com/blog/products/identity-security/taking-charge-of-your-data-using-cloud-dlp-to-de-identify-and-obfuscate-sensitive-information" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="use cloud dlp to mask sensitive information" track-metadata-child_index="3" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/taking-charge-of-your-data-using-cloud-dlp-to-de-identify-and-obfuscate-sensitive-information" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Painter covering data with paint" class="" src="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Use cloud DLP to mask sensitive information</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link lb" data-lightbox-height="506" data-lightbox-width="900" href="https://www.youtube.com/watch?v=PIlMsykXqLk" rel="noopener" target="_blank" track-metadata-child_eyebrow="video" track-metadata-child_headline="scotiabank shares their cloud-native approach to ingesting pii into google cloud" track-metadata-child_index="4" track-metadata-child_total="6" track-metadata-eventdetail="www.youtube.com/watch" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-metadata-video-id="PIlMsykXqLk" track-name="watch video" track-type="card">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Thumbnail image of man on stage" class="" src="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Video</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Scotiabank shares their cloud-native approach to ingesting PII into Google Cloud</span>
<span class="cloud-link cloud-carousel__slide-cta">Watch video</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="/blog/products/identity-security/take-charge-of-your-data-how-tokenization-makes-data-usable-without-sacrificing-privacy" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="how tokenization makes data usable without sacrificing privacy" track-metadata-child_index="5" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/take-charge-of-your-data-how-tokenization-makes-data-usable-without-sacrificing-privacy" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Stylized image of flow of multicolored circles entering a funnel and emerging as a stacked set of square blocks" class="" src="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>How tokenization makes data usable without sacrificing privacy</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="https://cloud.google.com/blog/products/identity-security/how-cloud-dlp-can-help-with-compliance-security-and-privacy" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="not just compliance reimagining dlp for todays cloud-centric world" track-metadata-child_index="6" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/how-cloud-dlp-can-help-with-compliance-security-and-privacy" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Thumbnail of a woman standing and looking at a variety of data output" class="" src="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Not just compliance: reimagining DLP for todayâs cloud-centric world</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
</div>
</div>
<div class="cloud-carousel__controls cloud-carousel__controls--hide-nuggets">
<div class="cloud-carousel__arrow left-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_left</i>
</div>
<div class="cloud-carousel__arrow right-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_right</i>
</div>
<div class="cloud-carousel__nuggets">
<div class="cloud-carousel__nugget"></div>
</div>
</div>
</div>
</div>
</div> </section>
<section class="module-section" id="documentation">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Documentation">
<p class="cws-label" style="margin-bottom: 16px;">Documentation</p>
<style>
            .documentation-module__more-docs {
              margin-bottom: 24px;
            }
          </style>
<div class="documentation-module" track-metadata-module="documentation" track-metadata-module_headline="documentation">
<div class="cws-grid">
<div class="documentation-module__copy cws-grid__col--span-8">
<div class="documentation-module__headline cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                         Documentation" id="documentation">
                        Documentation</h2>
</div>
</div>
</div>
</div>
</div>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="cloud-list">
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         De-identification of PII in large-scale data using Cloud                         DLP" id="de-identification-of-pii-in-large-scale-data-using-cloud-dlp">
                        De-identification of PII in large-scale data using Cloud
                        DLP</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to use Cloud DLP
                          to create an automated transformation pipeline to
                          de-identify sensitive data like personally
                          identifiable information (PII).Â </span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-child_index="1" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Automating the classification of data in Cloud Storage                       " id="automating-the-classification-of-data-in-cloud-storage">
                        Automating the classification of data in Cloud Storage
                      </h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to implement an
                          automated data quarantine and classification system
                          using Cloud Storage and other Google Cloud
                          products.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-child_index="2" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Pattern </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Relational database import to BigQuery with Dataflow                       " id="relational-database-import-to-bigquery-with-dataflow">
                        Relational database import to BigQuery with Dataflow
                      </h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">This proof of concept uses
                          Dataflow and Cloud DLP to securely tokenize and import
                          data from a relational database to BigQuery.</span>
</p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://github.com/GoogleCloudPlatform/dlp-rdb-bq-import" rel="noopener" target="_blank" track-metadata-child_index="3" track-metadata-child_total="9" track-metadata-eventdetail="github.com/GoogleCloudPlatform/dlp-rdb-bq-import" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Pattern </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Using a Cloud DLP proxy to query a database" id="using-a-cloud-dlp-proxy-to-query-a-database">
                        Using a Cloud DLP proxy to query a database</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">This concept architecture
                          uses a proxy that parses, inspects, and then either
                          logs the findings or de-identifies the results by
                          using Cloud DLP.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/solutions/example-architecture-dlp-proxy-query-database-sensitive-data" track-metadata-child_index="4" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/solutions/example-architecture-dlp-proxy-query-database-sensitive-data" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Inspecting storage and databases for sensitive data" id="inspecting-storage-and-databases-for-sensitive-data">
                        Inspecting storage and databases for sensitive data</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Instructions for setting up
                          an inspection scan using Cloud DLP in the Cloud
                          Console, and (optionally) for scheduling periodic
                          repeating inspection scans.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/inspecting-storage" track-metadata-child_index="5" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/dlp/docs/inspecting-storage" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Quickstart </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Scheduling a Cloud DLP inspection scan" id="scheduling-a-cloud-dlp-inspection-scan">
                        Scheduling a Cloud DLP inspection scan</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">You can schedule inspection
                          scans of storage repositories like Cloud Storage,
                          BigQuery, and Datastore using Cloud DLPâs job trigger
                          feature.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/schedule-inspection-scan" track-metadata-child_index="6" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/dlp/docs/schedule-inspection-scan" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> APIs &amp; Libraries </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Cloud DLP Client Libraries" id="cloud-dlp-client-libraries">
                        Cloud DLP Client Libraries</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to get started
                          with the Cloud Client Libraries for the Cloud Data
                          Loss Prevention API.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/libraries" track-metadata-child_index="7" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/dlp/docs/libraries" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Create a Cloud DLP inspection template" id="create-a-cloud-dlp-inspection-template">
                        Create a Cloud DLP inspection template</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">This quickstart shows you
                          how to create and use a Cloud Data Loss Prevention
                          (DLP) inspection template that lets you create and
                          persist configuration information.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-template-inspect" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-child_index="8" track-metadata-child_total="9" track-metadata-eventdetail="console.cloud.google.com/" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Schedule a Cloud DLP inspection scan" id="schedule-a-cloud-dlp-inspection-scan">
                        Schedule a Cloud DLP inspection scan</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to: enable DLP in
                          a project, create a job trigger to scan a public
                          dataset, choose input data to customize your scan and
                          configure detection parameters.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-job-trigger" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-child_index="9" track-metadata-child_total="9" track-metadata-eventdetail="console.cloud.google.com/" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list__footer">
<h5 class="cws-headline--headline-6 cloud-list__footer-heading" data-text="                       Not seeing what youâre looking for? " id="not-seeing-what-youâre-looking-for">
                      Not seeing what youâre looking for? </h5>
<div class="cloud-list__footer--buttons">
<div class="cws-button__set">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs" track-metadata-eventdetail="cloud.google.com/dlp/docs" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-name="view all product documentation" track-type="button">


      View all product documentation
      
    
      </a>
</div>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-4 documentation-module__sidebar">
<div class="documentation-module__more-docs">
<div aria-label="Explore more docs 1" class="cws-link-aside" role="complementary">
<div class="cws-link-aside__header">
<h2 class="cws-link-aside__headline cws-headline--headline-6" data-text="                         Explore more docs " id="explore-more-docs">
                        Explore more docs </h2>
</div>
<ul class="cws-link-aside__items">
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/quickstarts" track-metadata-eventdetail="cloud.google.com/dlp/docs/quickstarts" track-name="get a quick intro to using this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">Get a quick intro to using this product.</p>
</div>
</a>
</li>
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/how-to" track-metadata-eventdetail="cloud.google.com/dlp/docs/how-to" track-name="learn to complete specific tasks with this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">Learn to complete specific tasks with this product.</p>
</div>
</a>
</li>
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/solutions" track-metadata-eventdetail="cloud.google.com/dlp/docs/solutions" track-name="browse walkthroughs of common uses and scenarios for this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">Browse walkthroughs of common uses and scenarios for                this product.</p>
</div>
</a>
</li>
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/apis" track-metadata-eventdetail="cloud.google.com/dlp/docs/apis" track-name="view apis references and other resources for this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">View APIs, references, and other resources for this product.</p>
</div>
</a>
</li>
</ul>
</div>
</div>
<a class="cws-card cws-card--list" href="/dlp/docs/release-notes" track-metadata-child_headline="release notes" track-metadata-eventdetail="cloud.google.com/dlp/docs/release-notes" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-name="release notes" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-6">Release notes</p>
<div class="cws-body">Read about the latest releases for Cloud DLP</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
</section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Use cases">
<p class="cws-label" style="margin-bottom: 16px;">Use cases</p>
<style>
            /* [1] Override chip bottom margin to match design spec */
            .use-case-module .cloud-chip {
              margin-bottom: 8px;
              /* [1] */
            }

            .use-case-module__headline {
              margin-bottom: 40px;
            }

            .use-case-module__use-case {
              margin-bottom: 36px;
            }

            .use-case-module__use-case:last-child {
              margin-bottom: 0;
            }

            .use-case-module__use-case-diagram {
              display: flex;
              justify-content: left;
              overflow-x: auto;
              margin: 24px 0;
            }

            .use-case-module__cta {
              margin-top: 24px;
            }
          </style>
<div class="use-case-module" track-metadata-module="use cases" track-metadata-module_headline="use cases">
<div class="use-case-module__headline">
<h3 class="cws-headline--headline-4" data-text=" Use cases " id="use-cases"> Use cases </h3>
</div>
<div>
<div class="use-case-module__use-case">
<div>
<span class="cloud-chip cloud-chip--yellow-bg"> Use case </span>
</div>
<div>
<span class="cws-headline--headline-6 cloud-jump-section">Automatically
                    discover sensitive data</span>
</div>
<span class="cws-body richtext">
<p>Understand and manage your data risk across your
                    organization automatically with Cloud DLP (available now for
                    BigQuery). Continuous visibility into your data can help you
                    make more informed decisions, manage and reduce your data
                    risk, and help stay in compliance. Data profiling can be
                    configured easily in the Cloud Console with no jobs or
                    overhead to manage, letting you focus on the outcomes and
                    your business.</p>
</span>
<div class="use-case-module__use-case-diagram">
<picture>
<source srcset="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rw-lo-sc0xffffff-h400-w953 1x,https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rw-lo-sc0xffffff-h800-w1906 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h400-w953 1x,https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h800-w1906 2x" type="image/jpeg"/>
<img alt="Automatic Profiling" class="" loading="lazy" src="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h400-w953" srcset="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h800-w1906 2x"/>
</picture>
</div>
<div class="cws-grid cws-cards--compact use-case-module__technical-content cws-spacer-3--top">
</div>
</div>
<div class="use-case-module__use-case">
<div>
<span class="cloud-chip cloud-chip--yellow-bg"> Use case </span>
</div>
<div>
<span class="cws-headline--headline-6 cloud-jump-section">Classify
                    data across your enterprise</span>
</div>
<span class="cws-body richtext">
<p>Cloud DLP can help classify your data on or off cloud
                    giving you the insights you need to ensure proper
                    governance, control, and compliance. Save detailed findings
                    to BigQuery for analysis or publish summary findings to
                    other services like Data Catalog, Security Command Center,
                    Cloud Monitoring, and Pub/Sub. Audit and monitor your data
                    in Cloud Console or build custom reports and dashboards
                    using Google Data Studio or your tool of choice.</p>
</span>
<div class="use-case-module__use-case-diagram">
<img alt="On left is a rectangle labeled Data Sources with stacked icons for BigQuery, Cloud Storage, and Datastore. Arrow points right at rectangle labeled Cloud Data Loss Prevention with a Cloud DLP icon and 1. Set up a job or job trigger. Cloud DLP creates and runs a scan whenever you tell it to inspect your data. 2. Scan for sensitive data. Cloud DLP inspects for sensitive data elements like personally identifiable information (PII), credentials, and secrets. 3. Choose actions. Once the job is complete, Cloud DLP actions can give you rich, detailed findings or publish summary details to other systems.  From that rectangle, flow continues right splitting into upper box labeled Save Findings, with BigQuery and DLP icons and lower box labeled Publish Findings with icons for Security Command Center, Data Catalog, Cloud Monitoring, Email, and Pub/Sub" class="" loading="lazy" src="https://www.gstatic.com/bricks/image/17ce743c5356e76389a971b4267faca0331ad0c6dd28a0eb6728565c23cb9704.svg" style="max-width: 953px; max-height: 400px;"/>
</div>
<div class="cws-grid cws-cards--compact use-case-module__technical-content cws-spacer-3--top">
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-child_eyebrow="whitepaper" track-metadata-child_headline="scan for sensitive data in just a few clicks" track-metadata-child_index="1" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-module="use cases" track-metadata-module_headline="classify data across your enterprise" track-name="scan for sensitive data in just a few clicks" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Whitepaper</p>
<p class="cws-headline cws-headline--headline-5">Scan for sensitive data in just a few clicks</p>
<div class="cws-body">A deeper look at the Google Cloud Console user interface for Cloud DLP and how you can start to inspect your enterprise data with just a few clicks.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-child_eyebrow="tutorial" track-metadata-child_headline="automating the classification of data in cloud storage" track-metadata-child_index="2" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-module="use cases" track-metadata-module_headline="classify data across your enterprise" track-name="automating the classification of data in cloud storage" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Tutorial</p>
<p class="cws-headline cws-headline--headline-5">Automating the classification of data in Cloud Storage</p>
<div class="cws-body">This tutorial teaches you how to implement an automated data quarantine and classification system using Cloud Storage and other Google Cloud products.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/dlp/docs/schedule-inspection-scan" track-metadata-child_eyebrow="quickstart" track-metadata-child_headline="quickstart scheduling a cloud dlp inspection scan" track-metadata-child_index="3" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/dlp/docs/schedule-inspection-scan" track-metadata-module="use cases" track-metadata-module_headline="classify data across your enterprise" track-name="quickstart scheduling a cloud dlp inspection scan" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Quickstart</p>
<p class="cws-headline cws-headline--headline-5">Quickstart: Scheduling a Cloud DLP inspection scan</p>
<div class="cws-body">Get started with Cloud DLP to inspect and monitor your data using jobs and job triggers.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
</div>
</div>
<div class="use-case-module__use-case">
<div>
<span class="cloud-chip cloud-chip--yellow-bg"> Use case </span>
</div>
<div>
<span class="cws-headline--headline-6 cloud-jump-section">Protect
                    sensitive data as you migrate to the cloud</span>
</div>
<span class="cws-body richtext">
<p>Unblock more workloads as you migrate to the cloud. Cloud
                    DLP enables you to inspect and classify your sensitive data
                    in structured and unstructured workloads. De-identification
                    techniques like tokenization (pseudonymization) let you
                    preserve the utility of your data for joining or analytics
                    while reducing the risk of handling the data by obfuscating
                    the raw sensitive identifiers.</p>
</span>
<div class="use-case-module__use-case-diagram">
<img alt="Large gray Google Cloud rectangle comprises 3 yellow boxes. Top box on left is labeled âData de-identificationâ and contains Cloud Storage, which flows to Dataflow. Dataflow flows to lower yellow box labeled âConfiguration (DLP template and key) management.â On left is a Security admins box, and arrows flow right into Cloud DLP, into which Dataflow points, and Cloud KMS. To the right is the 3rd yellow box, labeled âData validation and re-identification,â containing BigQuery, Other data storage, Pub/Sub, Security analysts, Dataflow, and Subscriber client. Arrows indicate flow between these." class="" loading="lazy" src="https://www.gstatic.com/bricks/image/f3e5f0e8b58a60ef1b787ce6fb2d780ac0f1227314cb0b4a25eed9a36294fc86.svg" style="max-width: 953px; max-height: 400px;"/>
</div>
<div class="cws-grid cws-cards--compact use-case-module__technical-content cws-spacer-3--top">
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-child_eyebrow="tutorial" track-metadata-child_headline="de-identification of pii in large-scale datasets" track-metadata-child_index="1" track-metadata-child_total="2" track-metadata-eventdetail="cloud.google.com/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-module="use cases" track-metadata-module_headline="protect sensitive data as you migrate to the cloud" track-name="de-identification of pii in large-scale datasets" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Tutorial</p>
<p class="cws-headline cws-headline--headline-5">De-identification of PII in large-scale datasets</p>
<div class="cws-body">Reference on how to use Cloud DLP to create an automated data transformation pipeline to de-identify sensitive data like personally identifiable information (PII).</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
<div class="cws-grid__col--span-4">
<a class="cws-card" href="https://github.com/GoogleCloudPlatform/dlp-rdb-bq-import" rel="noopener" target="_blank" track-metadata-child_eyebrow="pattern" track-metadata-child_headline="relational database import to bigquery with dataflow" track-metadata-child_index="2" track-metadata-child_total="2" track-metadata-eventdetail="github.com/GoogleCloudPlatform/dlp-rdb-bq-import" track-metadata-module="use cases" track-metadata-module_headline="protect sensitive data as you migrate to the cloud" track-name="relational database import to bigquery with dataflow" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Pattern</p>
<p class="cws-headline cws-headline--headline-5">Relational database import to BigQuery with Dataflow</p>
<div class="cws-body">This concept architecture uses Dataflow and Cloud DLP to securely tokenize and import data from a relational database to BigQuery.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div class="use-case-module__cta">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/how-to" track-metadata-eventdetail="cloud.google.com/dlp/docs/how-to" track-metadata-modifier="low-emphasis" track-name="view all technical guides" track-type="button">


      View all technical guides
      
    
      </a>
</div>
</div>
</div>
</section>
<section class="module-section" id="all-features"></section>
<section class="module-section" id="all-features">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="All features">
<p class="cws-label" style="margin-bottom: 16px;">All features</p>
<style>
            .feature-module__body-text__large {
              font-family: Google Sans, sans-serif;
            }

            .feature-module__table-header {
              color: #202124;
            }

            .feature-module__table-cell p {
              font: inherit;
              margin-top: 0;
            }

            .feature-module__table-cell {
              line-height: 30px;
            }

            .feature-module__headline {
              margin-bottom: 36px;
            }
          </style>
<div class="feature-module" track-metadata-module="all features" track-metadata-module_headline="all features">
<div>
<div class="feature-module__headline">
<h3 class="cws-headline--headline-4" data-text=" All features " id="all-features"> All features </h3>
</div>
<div class="feature-module__feature-table">
<div class="cloud-table-wrapper devsite-table-wrapper">
<table class="cloud-table">
<tbody>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Automatic discovery, inspection, and classification
                          </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Automatic DLP can be
                            configured directly in the Cloud Console and runs
                            continuously for you.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Flexible classification </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext"><a class="cws-link" href="/dlp/docs/infotypes-reference" track-metadata-eventdetail="cloud.google.com/dlp/docs/infotypes-reference" track-metadata-module="all features" track-metadata-module_headline="all features" track-name="150 pre-defined detectors" track-type="inline link">150+ pre-defined detectors</a>
                            with a focus on quality, speed, and scale. Detectors
                            are improving and expanding all the time.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Simple and powerful redaction </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">De-identify your data:
                            redact, mask, tokenize, and transform text and
                            images to help ensure data privacy.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Serverless </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Cloud DLP is ready to
                            go, no need to manage hardware, VMs, or scale. Just
                            send a little or a lot of data and Cloud DLP scales
                            for you.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Detailed findings with on-demand inspection </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Classification results
                            can be sent directly into BigQuery for detailed
                            analysis or export into other systems. Custom
                            reports can easily be generated in Data
                            Studio.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Secure data handling </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Cloud DLP handles your
                            <a class="cws-link" href="/dlp/docs/support/data-security" track-metadata-eventdetail="cloud.google.com/dlp/docs/support/data-security" track-metadata-module="all features" track-metadata-module_headline="all features" track-name="data securely" track-type="inline link">data securely</a>
                            and undergoes several independent third-party audits
                            to test for data safety, privacy, and
                            security.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Pay-as-you-go pricing </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Cloud DLP is charged
                            based on the amount of data processed, not based on
                            a subscription service or device. This
                            customer-friendly pricing allows you to pay as you
                            go and not in advance of demand.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Easy workload integration </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Efficiently deploy
                            Cloud DLP with reusable templates, monitor your data
                            with periodic scans, and integrate into serverless
                            architecture with Pub/Sub notifications.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Custom rules </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Add your own custom
                            types, adjust detection thresholds, and create
                            detection rules to fit your needs and reduce
                            noise.</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Pricing">
<p class="cws-label" style="margin-bottom: 16px;">Pricing</p>
<style>
            .pricing-module__table-header span {
              color: #202124;
            }

            .pricing-module__table-cell {
              line-height: 30px;
            }

            .pricing-module__headline {
              margin-bottom: 36px;
            }

            .pricing-module__pricing-table,
            .pricing-module__pricing-cta {
              margin-top: 24px;
            }
          </style>
<div class="pricing-module" track-metadata-module="pricing" track-metadata-module_headline="pricing">
<div>
<div class="pricing-module__headline">
<h3 class="cws-headline--headline-4" data-text=" Pricing " id="pricing"> Pricing </h3>
</div>
<p class="cws-spacer-0--bottom">
<span class="cws-body--large richtext">
<p>Pricing for Cloud DLP is based on total bytes processed
                    with rate schedules based on total volume. You can try DLP
                    for free using the monthly free tier.</p>
</span>
</p>
</div>
<div class="pricing-module__pricing-cta">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/pricing" track-metadata-eventdetail="cloud.google.com/dlp/pricing" track-metadata-modifier="low-emphasis" track-name="view pricing details" track-type="button">


      View pricing details
      
    
      </a>
</div>
</div>
</div>
</section>
<section class="module-section">
</section>
<section class="module-section"></section>
</div>
<section class="cloud-content-footer">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Take the next step">
<style>
          .ankle-module__headline {
            margin-bottom: 28px;
          }

          .ankle-module__description {
            margin-bottom: 48px;
          }

          .ankle-module__buttons-wrap {
            display: flex;
            flex-wrap: wrap;
            gap: 32px;
          }

          .ankle-module__buttons {
            display: inline-block;
          }

          .ankle-module__richtext-cta {
            align-self: center;
            display: inline-block;
          }

          .ankle-module__richtext-cta p {
            margin-top: 0;
          }

          .ankle-module__content {
            padding: 60px 0;
          }

          .ankle-module__link-list {
            list-style: none;
            padding: 0;
          }

          .ankle-module__link-list-item:first-child {
            margin: 0;
          }

          .ankle-module__link-list-item {
            margin: 24px 0 0;
          }

          .ankle-module__link-list-item-label {
            margin-bottom: 8px;
          }

          @media (min-width: 767px) {
            .ankle-module__links {
              border-left: 1px solid #dadce0;
            }

            .ankle-module__link-list {
              padding: 4px 24px;
            }
          }

          @media (min-width: 1280px) {
            .ankle-module__link-list-item {
              margin: 36px 0 0;
            }
          }

          @media (max-width: 600px) {
            .ankle-module__links {
              margin-top: 24px;
            }
          }
        </style>
<div class="ankle-module cws-fullbleed cws-background--grey" track-metadata-module="take the next step">
<div class="cws-page">
<div class="ankle-module__content cloud-jump-content cws-grid">
<div class="cws-grid__col--span-6">
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<h3 class="cws-headline--headline-4 ankle-module__headline" data-text="                       Take the next step " id="take-the-next-step">
                      Take the next step </h3>
<p class="cws-body--large ankle-module__description"> Start
                      building on Google Cloud with $300 in free credits and 20+
                      always free products. </p>
<div class="ankle-module__buttons-wrap">
<div class="ankle-module__buttons">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/freetrial" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/freetrial" track-metadata-modifier="high-emphasis" track-name="try cloud dlp free" track-type="button">


      Try Cloud DLP free
      
    
      </a>
</div>
</div>
</slot>
<slot slot="ineligible">
<h3 class="cws-headline--headline-4 ankle-module__headline" data-text="                       Take the next step " id="take-the-next-step_1">
                      Take the next step </h3>
<p class="cws-body--large ankle-module__description"> Start
                      your next project, explore interactive tutorials, and
                      manage your account. </p>
<div class="ankle-module__buttons-wrap">
<div class="ankle-module__buttons">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/dlp" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/dlp" track-metadata-modifier="high-emphasis" track-name="go to console" track-type="button">


      Go to console
      
    
      </a>
</div>
</div>
</slot>
</cloudx-free-trial-eligible-content>
</div>
<div class="cws-grid__col--span-4 cws-grid__col--offset-7 ankle-module__links">
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<ul class="ankle-module__link-list">
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Need help getting started? </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/contact/" track-metadata-child_index="1" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/contact/" track-metadata-module="take the next step" track-name="contact sales" track-type="ankle link">
        Contact sales
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Work with a trusted partner </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.withgoogle.com/partners/" rel="noopener" target="_blank" track-metadata-child_index="2" track-metadata-child_total="3" track-metadata-eventdetail="cloud.withgoogle.com/partners/" track-metadata-module="take the next step" track-name="find a partner" track-type="ankle link">
        Find a partner
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Continue browsing </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/products/" track-metadata-child_index="3" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/products/" track-metadata-module="take the next step" track-name="see all products" track-type="ankle link">
        See all products
    </a>
</li>
</ul>
</slot>
<slot slot="ineligible">
<ul class="ankle-module__link-list">
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Need help getting started? </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/contact/" track-metadata-child_index="1" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/contact/" track-metadata-module="take the next step" track-name="contact sales" track-type="ankle link">
        Contact sales
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Work with a trusted partner </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.withgoogle.com/partners/" rel="noopener" target="_blank" track-metadata-child_index="2" track-metadata-child_total="3" track-metadata-eventdetail="cloud.withgoogle.com/partners/" track-metadata-module="take the next step" track-name="find a partner" track-type="ankle link">
        Find a partner
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Get tips &amp; best practices </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/docs/tutorials" track-metadata-child_index="3" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/docs/tutorials" track-metadata-module="take the next step" track-name="see tutorials" track-type="ankle link">
        See tutorials
    </a>
</li>
</ul>
</slot>
</cloudx-free-trial-eligible-content>
</div>
</div>
</div>
</div>
</div>
</section>
</article>
<!--&#123;# Page published by Bricks, request id 2bd353c5-84c3-4c5f-8873-d20fcb3b094c} #}-->
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/dlp-ui]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention has a user interface (UI) that is available in the
Cloud console. The Cloud DLP UI contains a subset of the
functionality available in the DLP API, as detailed on this page.</p>
<aside class="note"><strong>Note:</strong><span> We plan to update the Cloud DLP UI to enable new
Cloud DLP features on an ongoing basis.</span></aside>
<p>This topic provides instructions on how to access the Cloud DLP UI
and lists the features available in the Cloud DLP UI.</p>
<h2 data-text="Access the Cloud DLP UI" id="access_the_ui">Access the Cloud DLP UI</h2>
<p>To access Cloud DLP in the Cloud console:</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP UI</a> </p>
<p>Alternatively, do the following:</p>
<ol>
<li>In the Cloud console, if the navigation menu isn't visible,
 click the navigation button in the upper-left corner of the page.</li>
<li>Point to <strong>Security</strong>, and then click <strong>Data Loss Prevention.</strong></li>
</ol>
<p>The Cloud DLP UI appears.</p>
<h2 data-text="Available features" id="available_features">Available features</h2>
<p>The Cloud DLP UI supports the following existing
Cloud DLP features:</p>
<ul>
<li><a href="/dlp/docs/creating-job-triggers">Inspection jobs for inspecting Cloud Storage, BigQuery, and
Datastore storage repositories</a>: Creating,
listing, deleting, viewing detail, and triggering (with a job trigger).</li>
<li><a href="/dlp/docs/creating-job-triggers">Inspection job triggers</a>: Creating/scheduling,
listing, deleting, updating, and viewing detail.</li>
<li><a href="/dlp/docs/creating-templates-inspect">Inspection templates</a>: Creating, listing,
deleting, updating, and viewing detail.</li>
<li><a href="/dlp/docs/creating-stored-infotypes">Stored custom dictionary infoTypes</a>: Creating,
listing, deleting, updating, and viewing detail.</li>
</ul>
<h2 data-text="Feedback" id="feedback">Feedback</h2>
<p>To offer your feedback on the Cloud DLP UI, please send an
email to the engineering team at <a href="mailto:cloud-dlp-feedback@google.com">cloud-dlp-feedback@google.com</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/quickstarts]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="quickstarts">
<ul class="card-showcase">
<li>
<a class="no-logo" href="/dlp/docs/quickstart-cli">
<h3 class="hide-from-toc no-link" data-text="Quickstart: Using the command-line tool" id="quickstart:-using-the-command-line-tool">Quickstart: Using the command-line tool</h3>
<p>
    Set up Cloud DLP and perform your first text inspection using
    the command-line tool.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/quickstart-json">
<h3 class="hide-from-toc no-link" data-text="Quickstart: Using a JSON request" id="quickstart:-using-a-json-request">Quickstart: Using a JSON request</h3>
<p>
    Set up Cloud DLP and perform your first text inspection
    using a JSON request.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/quickstart-create-job-trigger">
<h3 class="hide-from-toc no-link" data-text="Quickstart: Creating a Cloud DLP job trigger" id="quickstart:-creating-a-cloud-dlp-job-trigger">Quickstart: Creating a Cloud DLP job trigger</h3>
<p>
    Schedule inspection scans of your content using job triggers.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/quickstart-create-template-inspect">
<h3 class="hide-from-toc no-link" data-text="Quickstart: Creating a Cloud DLP inspection template" id="quickstart:-creating-a-cloud-dlp-inspection-template">Quickstart: Creating a Cloud DLP inspection template</h3>
<p>
    Create and persist configuration information by using a template.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/quickstart-deid-reid">
<h3 class="hide-from-toc no-link" data-text="Quickstart: De-identifying and re-identifying sensitive     text" id="quickstart:-de-identifying-and-re-identifying-sensitive-text">Quickstart: De-identifying and re-identifying sensitive
    text</h3>
<p>
    De-identify sensitive information by replacing it with a token, and then
    re-identify it.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspect-sensitive-text]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Inspect sensitive text by using Node.js" id="inspect-sensitive-text-by-using-node.js">Inspect sensitive text by using Node.js</h1>
<section class="intro">
<p>Learn how to scan a sample string for sensitive information by using the
Cloud Data Loss Prevention API (DLP API), the Google Cloud CLI, and Node.js.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
</cloudx-free-trial-eligible-content>
<li><a href="/nodejs/docs/setup">Install Node.js and NPM</a>.</li>
</ol>
</section>
<section class="steps">
<h2 data-text="Set permissions" id="set-permissions">Set permissions</h2>
<p>To inspect content, you must have the <code dir="ltr" translate="no">serviceusage.services.use</code>
IAM permission for your project. To give this permission, grant
the DLP User role at the project level:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">   gcloud projects add-iam-policy-binding <var translate="no">PROJECT_ID</var> --member user:<var translate="no">EMAIL_ADDRESS</var> --role roles/dlp.user
</code></pre>
<p>Replace the following:</p>
<ul>
<li><p><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your Google Cloud project</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">EMAIL_ADDRESS</var></code>: the email address of your 
 Google Cloud account</p></li>
</ul>
<p>The output is similar to the following:</p>
<pre class="devsite-disable-click-to-copy devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">   bindings:
   - members:
   - user:test@example.com
   role: roles/dlp.user
</code></pre>
<h2 data-text="Set up a Cloud DLP CLI app" id="setup-cli-app">Set up a Cloud DLP CLI app</h2>
<p>To set up a Cloud DLP CLI app using Node.js, do the following:</p>
<ol>
<li><p>Clone the <a href="https://github.com/googleapis/nodejs-dlp">Node.js DLP client library</a>:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no"> git clone https://github.com/googleapis/nodejs-dlp
</code></pre></li>
<li><p>Navigate to the <code dir="ltr" translate="no">samples</code> directory.</p></li>
<li><p>Install the app dependencies:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no"> npm install
</code></pre></li>
</ol>
<h2 data-text="Inspect a string for sensitive information" id="inspect-string">Inspect a string for sensitive information</h2>
<p>To scan sample text by using the DLP API and the <code dir="ltr" translate="no">inspectString</code>
Node.js script, run the following command:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">  node inspectString.js <var translate="no">PROJECT_ID</var> "My email address is joe@example.com."
</code></pre>
<p>The output is similar to the following:</p>
<pre class="devsite-disable-click-to-copy devsite-click-to-copy" dir="ltr" translate="no"><code dir="ltr" translate="no">  Findings:
      Info type: PERSON_NAME
      Likelihood: POSSIBLE
      Info type: EMAIL_ADDRESS
      Likelihood: LIKELY
</code></pre>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>
          To avoid incurring charges to your Google Cloud account for
          the resources used on this page, follow these steps.
        </p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>
  The easiest way to eliminate billing is to delete the project that you
  created for the tutorial.
</p>
<p>To delete the project:
  <ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</p>

</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li><p>To get started with inspecting text and images for sensitive data, see
<a href="/dlp/docs/how-to">How-to guides</a>.</p></li>
<li><p>To better understand inspection, redaction, infoTypes, and likelihood, see
<a href="/dlp/docs/concepts">Concepts</a>.</p></li>
<li><p>Learn more about the <a href="/dlp/docs/reference/rest/v2">DLP API</a>.</p></li>
<li><p>Learn more about the <a href="/nodejs/docs/reference/dlp/latest">Cloud DLP Node.js Client</a>.</p></li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspect-sensitive-text-api]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Inspect sensitive text by using the DLP API" id="inspect-sensitive-text-by-using-the-dlp-api">Inspect sensitive text by using the DLP API</h1>
<section class="intro">
<p>Learn how to scan a sample string for sensitive information by using the
Cloud Data Loss Prevention API (DLP API) and JSON.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
</section>
<section class="steps">
<h2 data-text="Set permissions" id="set-permissions">Set permissions</h2>
<p>To inspect content, you must have the <code dir="ltr" translate="no">serviceusage.services.use</code>
IAM permission for your project. To give this permission, grant
the DLP User role at the project level:</p>
<ol>
<li><p>In the Google Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console">Go to IAM</a> </p></li>
<li><p>Click <strong>Add</strong>.</p></li>
<li><p>In the <strong>Add principals</strong> dialog, do the following:</p>
<ol>
<li><p>For <strong>New principals</strong>, enter your user email.</p></li>
<li><p>For <strong>Select a role</strong>, select <strong>Cloud DLP</strong>, and then select
<strong>DLP User</strong>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol></li>
</ol>
<h2 data-text="Inspect a string for sensitive information" id="inspect-string">Inspect a string for sensitive information</h2>
<p>This section shows you how to configure the DLP API to scan
sample text using the <a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">projects.content.inspect</code></a>
REST method.</p>
<ol>
<li><p>Create a JSON request file with the following text:</p>
<pre class="prettyprint lang-js" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My phone number is (800) 555-0123."
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"PHONE_NUMBER"
      },
      {
        "name":"US_TOLLFREE_PHONE_NUMBER"
      }
    ],
    "minLikelihood":"POSSIBLE",
    "limits":{
      "maxFindingsPerItem":0
    },
    "includeQuote":true
  }
}
</code></pre></li>
<li><p>Save the file as <code dir="ltr" translate="no">inspect-request.json</code>.</p></li>
<li><p>Go to the directory where you saved the <code dir="ltr" translate="no">inspect-request.json</code> file.</p></li>
<li><p>To complete the next steps, select one of the following tabs:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Linux or macOS " id="linux-or-macos"> Linux or macOS </h3><ol>
<li><p>Activate the service account:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud auth activate-service-account <var translate="no">SERVICE_ACCOUNT_ID</var>@<var translate="no">PROJECT_ID</var>.iam.gserviceaccount.com \
    --key-file=$GOOGLE_APPLICATION_CREDENTIALS
</code></pre>
<p>Replace the following:</p>
<ul>
<li><p><code dir="ltr" translate="no"><var translate="no">SERVICE_ACCOUNT_ID</var></code>: the ID of your service
account</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your Google Cloud project</p></li>
</ul></li>
<li><p>Set the <code dir="ltr" translate="no">ACCESS_TOKEN</code> environment variable to create an authorization
token:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">export ACCESS_TOKEN="$(gcloud auth print-access-token)"
</code></pre></li>
<li><p>Make a <code dir="ltr" translate="no">content:inspect</code> request:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -s \
-H "Authorization: Bearer $ACCESS_TOKEN" \
-H "Content-Type: application/json" \
https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/content:inspect \
-d @inspect-request.json
</code></pre></li>
</ol></section>
<section><h3 data-text=" Windows cmd.exe " id="windows-cmd.exe"> Windows cmd.exe </h3><ol>
<li><p>Activate the service account:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud auth activate-service-account <var translate="no">SERVICE_ACCOUNT_ID</var>@<var translate="no">PROJECT_ID</var>.iam.gserviceaccount.com ^
    --key-file=%GOOGLE_APPLICATION_CREDENTIALS%
</code></pre>
<p>Replace the following:</p>
<ul>
<li><p><code dir="ltr" translate="no"><var translate="no">SERVICE_ACCOUNT_ID</var></code>: the ID of your service
account</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your Google Cloud project</p></li>
</ul></li>
<li><p>Set the <code dir="ltr" translate="no">ACCESS_TOKEN</code> environment variable to create an authorization
token:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">for /f "delims=" %a in ("gcloud auth print-access-token") do @set ACCESS_TOKEN=%a
</code></pre></li>
<li><p>Make a <code dir="ltr" translate="no">content:inspect</code> request:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -s ^
-H "Authorization: Bearer %ACCESS_TOKEN%" ^
-H "Content-Type: application/json" ^
https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/content:inspect ^
-d @inspect-request.json
</code></pre></li>
</ol></section>
<section><h3 data-text=" Windows PowerShell " id="windows-powershell"> Windows PowerShell </h3><ol>
<li><p>Activate the service account:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud auth activate-service-account <var translate="no">SERVICE_ACCOUNT_ID</var>@<var translate="no">PROJECT_ID</var>.iam.gserviceaccount.com `
    --key-file=$GOOGLE_APPLICATION_CREDENTIALS
</code></pre>
<p>Replace the following:</p>
<ul>
<li><p><code dir="ltr" translate="no"><var translate="no">SERVICE_ACCOUNT_ID</var></code>: the ID of your service
account</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your Google Cloud project</p></li>
</ul></li>
<li><p>Set the <code dir="ltr" translate="no">ACCESS_TOKEN</code> environment variable to create an authorization
token:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">$env:ACCESS_TOKEN=$(gcloud auth print-access-token)
</code></pre></li>
<li><p>Make a <code dir="ltr" translate="no">content:inspect</code> request:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -s `
-H "Authorization: Bearer $ACCESS_TOKEN" `
-H "Content-Type: application/json" `
https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/content:inspect `
-d @inspect-request.json
</code></pre></li>
</ol></section>
</div>
<p>The output is similar to the following:</p>
<pre class="devsite-disable-click-to-copy prettyprint lang-js" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "result": {
    "findings": [
      {
        "quote": "(800) 555-0123",
        "infoType": {
          "name": "US_TOLLFREE_PHONE_NUMBER"
        },
        "likelihood": "LIKELY",
        "location": {
          "byteRange": {
            "start": "19",
            "end": "33"
          },
          "codepointRange": {
            "start": "19",
            "end": "33"
          }
        },
        "createTime": "2022-03-09T13:49:54.027Z",
        "findingId": "2022-03-09T13:49:54.029640Z1888389906614481185"
      }
    ]
  }
}
</code></pre></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>
          To avoid incurring charges to your Google Cloud account for
          the resources used on this page, follow these steps.
        </p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>
  The easiest way to eliminate billing is to delete the project that you
  created for the tutorial.
</p>
<p>To delete the project:
  <ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</p>

</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li><p>To get started with inspecting text and images for sensitive data, see
<a href="/dlp/docs/how-to">How-to guides</a>.</p></li>
<li><p>To better understand inspection, redaction, infoTypes, and likelihood, see
<a href="/dlp/docs/concepts">Concepts</a>.</p></li>
<li><p>Learn more about the <a href="/dlp/docs/reference/rest/v2">DLP API</a>.</p></li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/schedule-inspection-scan]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Schedule a Cloud DLP inspection scan" id="schedule-a-cloud-dlp-inspection-scan">Schedule a Cloud DLP inspection scan</h1>
<section class="intro">
<p>Learn how to create a new job trigger using Cloud Data Loss Prevention in the
Google Cloud console.</p>
<p>Job triggers are events that automate running Cloud DLP jobs to
scan Google Cloud storage repositories (Cloud Storage, BigQuery, and
Datastore).</p>
<hr/>
<p>For step-by-step guidance on this task directly in Cloud console,
  click <b>Guide me</b>:
</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-job-trigger" track-metadata-eventdetail="
https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-job-trigger
" track-metadata-id="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-job-trigger" track-name="consoleLink" track-type="walkthroughStatic">Guide me</a>
</p>
<hr/>
<p>The following sections take you through the same steps as clicking <b>Guide me</b>.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
<li>
<p>
        
          
            
              Enable the Cloud Data Loss Prevention API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</li>
</ol>
</section>
<section class="steps">
<h2 data-text="Create a job trigger" id="create-trigger">Create a job trigger</h2>
<p>In the following sections, you configure and create a job trigger for a
<a href="/bigquery/public-data">BigQuery public dataset</a> that contains
the street addresses of bike share stations in a city.</p>
<p>When this job trigger runs, Cloud DLP scans around 700 bytes of
data. You can inspect up to 1 GB of storage data per month free of charge. For
more information about pricing, see <a href="/dlp/pricing#storage-pricing">Storage inspection job
pricing</a>.</p>
<h3 data-text="Choose input data" id="choose-data">Choose input data</h3>
<ol>
<li><p>In the Cloud console, open the <strong>Data Loss Prevention</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Data Loss Prevention</a> </p></li>
<li><p>Click the <strong>Inspection</strong> tab.</p></li>
<li><p>Click <strong>Create job and job triggers</strong>.</p>
<p><img alt="The Create job and job triggers button." class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png"/></p></li>
<li><p>To configure input data, do the following:</p>
<ol>
<li><p>In the <strong>Name</strong> section, define the following options:</p>
<ul>
<li><p>For <strong>Job ID</strong>, enter <code dir="ltr" translate="no">quickstart-job-trigger</code>.</p></li>
<li><p>Keep <strong>Resource location</strong> set to <strong>Global (any region)</strong>.</p></li>
</ul></li>
<li><p>In the <strong>Storage type</strong> list, select <strong>BigQuery</strong>, and then
define the following options:</p>
<ul>
<li><p>For <strong>Project ID</strong>, enter <code dir="ltr" translate="no">bigquery-public-data</code>.</p></li>
<li><p>For <strong>Dataset ID</strong>, enter <code dir="ltr" translate="no">austin_bikeshare</code>.</p></li>
<li><p>For <strong>Table ID</strong>, enter <code dir="ltr" translate="no">bikeshare_stations</code>.</p></li>
</ul></li>
<li><p>In the <strong>Maximum number of rows</strong> field, enter <code dir="ltr" translate="no">10</code>.</p></li>
</ol></li>
<li><p>Click <strong>Continue</strong>.</p></li>
</ol>
<h3 data-text="Configure detection parameters" id="configure-detection">Configure detection parameters</h3>
<ol>
<li><p>To configure detection, do the following:</p>
<ol>
<li><p>In the <strong>InfoTypes</strong> section, click <strong>Manage infoTypes</strong>.</p></li>
<li><p>In the <strong>InfoTypes</strong> pane, select <strong>STREET_ADDRESS</strong>.</p></li>
<li><p>To close the <strong>infoTypes</strong> pane, click <strong>Done</strong>.</p></li>
<li><p>In the <strong>Confidence threshold</strong> section, select <strong>Possible</strong> from the
<strong>Likelihood</strong> list.</p>
<p>The value <strong>Possible</strong> is sufficient for most purposes. If you routinely
get matches that are too broad when you use this job trigger, select a
higher confidence threshold value. If you get too few matches, select a
lower confidence threshold value.</p></li>
</ol></li>
<li><p>Click <strong>Continue</strong>.</p></li>
</ol>
<h3 data-text="Add post-scan actions" id="post-scan-actions">Add post-scan actions</h3>
<ol>
<li><p>Click the <strong>Notify by email</strong> toggle.</p></li>
<li><p>Click <strong>Continue</strong>.</p></li>
</ol>
<h3 data-text="Set a schedule" id="set-a-schedule">Set a schedule</h3>
<ol>
<li><p>In the <strong>Time span or schedule</strong> list, select <strong>Create a trigger to run the
job on a periodic schedule</strong>.</p>
<aside class="special"><strong>Important:</strong><span> Selecting <strong>Create a trigger to run the job on a periodic
schedule</strong> is what makes a job into a job trigger. If you don't specify a
schedule, you create a single job that runs only once.</span></aside></li>
<li><p>In the <strong>Trigger scan repeats</strong> list, select <strong>Weekly</strong>.</p></li>
<li><p>Click <strong>Continue</strong>.</p></li>
</ol>
<h3 data-text="Review and create the job trigger" id="review-job-trigger">Review and create the job trigger</h3>
<p>After you review the JSON-formatted summary of the job settings you just
specified, do the following:</p>
<ol>
<li><p>Click <strong>Create</strong>.</p></li>
<li><p>In the <strong>Confirm job or job trigger create</strong> dialog, click
<strong>Confirm create</strong>.</p>
<p>Allow a minute for Cloud DLP to create the job trigger.</p></li>
</ol>
<h2 data-text="Run the job trigger and view results" id="run-job-trigger">Run the job trigger and view results</h2>
<p>To trigger a job immediately, do the following:</p>
<ol>
<li><p>On the <strong>Trigger details</strong> page, click <strong>Run now</strong>.</p>
<p>This operation might take some time to complete.</p></li>
<li><p>After the job that you created runs once, do the following:</p>
<ol>
<li><p>In the <strong>Triggered jobs</strong> section, select the job ID of the triggered job
in the <strong>Job ID</strong> column.</p></li>
<li><p>On the <strong>Job details</strong> page, view the job results.</p></li>
</ol></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>
          To avoid incurring charges to your Google Cloud account for
          the resources used on this page, follow these steps.
        </p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>
  The easiest way to eliminate billing is to delete the project that you
  created for the tutorial.
</p>
<p>To delete the project:
  <ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</p>

<h3 data-text="Delete the job trigger" id="delete_the_job_trigger">Delete the job trigger</h3>
<p>If you created the job trigger in an existing project and you no longer need
the job trigger, follow these steps:</p>
<ol>
<li><p>In the Cloud console, go to the <strong>Data Loss Prevention</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Data Loss Prevention</a> </p></li>
<li><p>If necessary, select the project in which you created a job trigger from the
Cloud console toolbar.</p></li>
<li><p>Click the <strong>Inspection</strong> tab, and then click the <strong>Job triggers</strong> tab. The
Cloud console displays a list of all the job triggers for the
current project.</p></li>
<li><p>In the <strong>Actions</strong> column for the job trigger you want to delete, click the
trigger actions menu <span aria-hidden="true">(<img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>)</span>,
click <strong>Delete</strong>, and then click <strong>Confirm</strong>.</p>
<p><img alt="The Delete option in the trigger actions menu." class="screenshot" src="/dlp/docs/images/creating-job-triggers-triggerlist-actionmenu.png"/></p></li>
</ol>
</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li><p>Learn more about <a href="/dlp/docs/creating-job-triggers">creating and scheduling Cloud DLP inspection
jobs</a>.</p></li>
<li><p>Learn more about <a href="/dlp/docs/creating-templates-inspect">creating Cloud DLP inspection
templates</a>.</p></li>
<li><p>To add actions you want Cloud DLP to take after a trigger job
completes, see <a href="/dlp/docs/creating-job-triggers#add-actions">Add actions</a>.</p></li>
<li><p>To specify the types of sensitive data you want to scan for, see <a href="/dlp/docs/creating-job-triggers#configure-detection">Configure
detection</a>.</p></li>
<li><p>To create a BigQuery dataset in a project, see <a href="/bigquery/docs/datasets">Creating
datasets</a>.</p></li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/create-inspection-template]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Create a Cloud DLP inspection template" id="create-a-cloud-dlp-inspection-template">Create a Cloud DLP inspection template</h1>
<section class="intro">
<p>This quickstart shows you how to create and use a Cloud Data Loss Prevention inspection
template in the Google Cloud console. <a href="/dlp/docs/concepts-templates">Cloud DLP inspection templates</a>
let you create and persist configuration information in Cloud DLP.</p>
<p>To complete this quickstart, you need to have data that you can scan in
Cloud Storage, BigQuery, or Datastore.</p>
<hr/>
<p>For step-by-step guidance on this task directly in Cloud console,
  click <b>Guide me</b>:
</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-template-inspect" track-metadata-eventdetail="
https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-template-inspect
" track-metadata-id="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-template-inspect" track-name="consoleLink" track-type="walkthroughStatic">Guide me</a>
</p>
<hr/>
<p>The following sections take you through the same steps as clicking <b>Guide me</b>.</p>
</section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
<li>
<p>
        
          
            
              Enable the Cloud DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</li>
</ol>
</section>
<section class="steps">
<h2 data-text="Create a template" id="create-template">Create a template</h2>
<p>In the following sections, you configure and create an inspection template.</p>
<h3 data-text="Define template" id="define-template">Define template</h3>
<ol>
<li><p>In the Cloud console, go to the <strong>Data Loss Prevention</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Data Loss Prevention</a> </p></li>
<li><p>Click the <strong>Configuration</strong> tab.</p></li>
<li><p>In the <strong>ConfigurationÂ <span aria-label="and then">&gt;</span> Templates</strong>
section, click <strong>Create template</strong>.</p>
<p><img alt="The Create template button." class="screenshot" src="/dlp/docs/images/creating-inspection-templates-create-templatesubtab.png"/></p></li>
<li><p>On the <strong>Create template</strong> page, define the following options:</p>
<ul>
<li><p>For <strong>Template type</strong>, use the default setting <strong>Inspect (find sensitive
data)</strong>.</p></li>
<li><p>For <strong>Template ID</strong>, enter <code dir="ltr" translate="no">quickstart-template</code>.</p></li>
<li><p>For <strong>Display name</strong>, enter <code dir="ltr" translate="no">Quickstart template</code>.</p></li>
<li><p>For <strong>Description</strong>, leave the field empty.</p></li>
<li><p>For <strong>Resource location</strong>, use the default setting <strong>Global (any
region)</strong>.</p></li>
</ul></li>
<li><p>Click <strong>Continue</strong>.</p></li>
</ol>
<h3 data-text="Configure detection" id="configure-detection">Configure detection</h3>
<p>You now configure the template to detect for an infoType such as credit card numbers.</p>
<ol>
<li><p>In the <strong>Configure detection</strong> section of the <strong>Create template</strong> page, do
the following:</p>
<ul>
<li><p>In the <strong>InfoTypes</strong> section, click <strong>Manage infoTypes</strong>, select the
infoTypes that you want to scan for, and then click <strong>Done</strong>.</p></li>
<li><p>In the <strong>Confidence threshold</strong> section, select <strong>Possible</strong>
from the <strong>Likelihood</strong> list.</p>
<p>The default value <strong>Possible</strong> is sufficient for most purposes. If
you routinely get matches that are too broad when you use this
template, move the slider up. If you get too few matches, move the
slider down.</p></li>
</ul></li>
<li><p>To create the template, click <strong>Create</strong>.</p>
<p>The template's summary information page appears. To return to the main
Cloud DLP page, click <span aria-hidden="true" class="material-icons" translate="no">arrow_back</span>
<strong>Up to Template list</strong>.</p></li>
</ol>
<h2 data-text="Use the template" id="use-template">Use the template</h2>
<p>The following steps describe how to configure the template for use in a scan:</p>
<ol>
<li><p>In the Cloud console, go to the <strong>Create job or job trigger</strong>
 page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/job;source=7" target="console">Go to Create job or job trigger</a> </p></li>
<li><p>Follow the prompts to create an inspection job or job trigger (a recurring
 job). When you are prompted to configure the detection, select the template
 that you created.</p></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>
          To avoid incurring charges to your Google Cloud account for
          the resources used on this page, follow these steps.
        </p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>
  The easiest way to eliminate billing is to delete the project that you
  created for the tutorial.
</p>
<p>To delete the project:
  <ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</p>

<h3 data-text="Delete the template" id="delete_the_template">Delete the template</h3>
<p>There are no costs associated with creating and storing templates. However, if
you want to delete a template, follow these steps:</p>
<ol>
<li><p>If necessary, select the project in which you created a template from the
 Cloud console toolbar.</p></li>
<li><p>Go to the <strong>Data Loss Prevention</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Data Loss Prevention</a> </p></li>
<li><p>Click the <strong>Configuration</strong> tab, and then click the <strong>Templates</strong> tab. The
 Cloud console displays a list of all templates for the current
 project.</p></li>
<li><p>In the <strong>Actions</strong> column for the template you want to delete, click the
 trigger actions menu <span aria-hidden="true">(<img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>)</span>,
 click <strong>Delete</strong>, and then click <strong>Confirm</strong>.</p>
<p><img alt="The Delete option in the trigger actions menu." class="screenshot" src="/dlp/docs/images/creating-inspection-templates-templatelist-actionmenu.png"/></p></li>
</ol>
</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li><p>Learn more about <a href="/dlp/docs/creating-job-triggers">creating and scheduling Cloud DLP inspection
jobs</a>.</p></li>
<li><p>Learn more about <a href="/dlp/docs/creating-templates-inspect">creating Cloud DLP inspection templates</a>.</p></li>
<li><p>Learn more about the <a href="/dlp/docs/infotypes-reference">infoType detector reference</a>.</p></li>
<li><p>Learn more about how Cloud DLP matches your content using the
<a href="/dlp/docs/likelihood">likelihood value</a>.</p></li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspect-sensitive-text-de-identify]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<div class="quickstart" itemscope="" itemtype="https://schema.org/TechArticle">
<h1 class="devsite-page-title" data-text="Inspect text to de-identify sensitive information" id="inspect-text-to-de-identify-sensitive-information">Inspect text to de-identify sensitive information</h1>
<section class="intro">
    
This quickstart shows you how to use Cloud Data Loss Prevention to de-identify and
re-identify sensitive data in text content. In the process, it takes
you through using Cloud Key Management Service to create a wrapped key. You need this key in
your de-identify and re-identify requests.
<p>The process described in this quickstart is called <em>pseudonymization</em>
(or <em>tokenization</em>). In this process, Cloud DLP uses
a cryptographic key to convert (de-identify) sensitive text into a token. In
order to restore (re-identify) that text, you need the cryptographic key
that you used during de-identification and the token.</p>
<p>Cloud DLP supports both reversible and non-reversible
cryptographic methods. In order to re-identify content, you need to choose a
reversible method.</p>
<p>The cryptographic method described here is called <a href="/dlp/docs/pseudonymization#aes-siv">deterministic encryption
using AES-SIV</a> (Advanced Encryption Standard
in Synthetic Initialization Vector mode). We
recommend this
among all the reversible cryptographic methods that Cloud DLP
<a href="/dlp/docs/pseudonymization#supported-methods">supports</a>,
because it provides the highest level of security.</p>
<p>You can complete the steps in this topic in 10 to 20 minutes, not including the
<a href="/dlp/docs/inspect-sensitive-text-de-identify#before-you-begin">Before you begin</a> steps.</p>
<p><aside class="special"><strong>Note:</strong> When you use
  Cloud KMS for cryptographic operations,
  <a href="https://cloud.google.com/kms/pricing">charges apply</a>.</aside>
</p></section>
<section class="prereqs">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the Cloud DLP and Cloud KMS APIs.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com,cloudkms.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the APIs</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
          select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the Cloud DLP and Cloud KMS APIs.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com,cloudkms.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the APIs</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
</section>
<section class="steps">
<h2 data-text="Step 1: Create a key ring and a key" id="create-kms-key">Step 1: Create a key ring and a key</h2>
<p>Before you start this procedure, decide where you want Cloud DLP
to process your de-identification and re-identification requests. When you
create a Cloud KMS key, you must store it in either <code dir="ltr" translate="no">global</code> or in the
same region that you will use for your Cloud DLP requests.
Otherwise, the Cloud DLP requests will fail.</p>
<p>You can find a list of supported locations in
<a href="/dlp/docs/locations">Cloud DLP locations</a>. Take note of the name
of your chosen region (for example, <code dir="ltr" translate="no">us-west1</code>).</p>
<p>This procedure uses <code dir="ltr" translate="no">global</code> as the location for all API requests. If you want
to use a different region, replace <code dir="ltr" translate="no">global</code> with the region name.</p>
<ol>
<li><p>Create a key ring:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keyrings create "dlp-keyring" \
    --location "global"
</code></pre></li>
<li><p>Create a key:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys create "dlp-key" \
    --location "global" \
    --keyring "dlp-keyring" \
    --purpose "encryption"
</code></pre></li>
<li><p>List your key ring and key:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys list \
    --location "global" \
    --keyring "dlp-keyring"
</code></pre>
<p>You get the following output:</p>
<pre dir="ltr" translate="no">
NAME                                                                                   PURPOSE          ALGORITHM                    PROTECTION_LEVEL  LABELS  PRIMARY_ID  PRIMARY_STATE
projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key  ENCRYPT_DECRYPT  GOOGLE_SYMMETRIC_ENCRYPTION  SOFTWARE                  1           ENABLED
</pre>
<p>In this output, <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> is the ID of your project.</p>
<p>The path under <code dir="ltr" translate="no">NAME</code> is the full resource name of your Cloud KMS
key. Take note of it because the de-identify and re-identify requests
require it.</p></li>
</ol>
<h2 data-text="Step 2: Create a base64-encoded AES key" id="create-base64-key">Step 2: Create a base64-encoded AES key</h2>
<p>This section describes how to create an Advanced Encryption Standard (AES) key
and encode it in base64 format.</p>
<aside class="note"><strong>Note:</strong><span> These steps use the <code dir="ltr" translate="no">openssl</code> and <code dir="ltr" translate="no">base64</code> commands, but there are
<a href="/storage/docs/encryption/using-customer-supplied-keys#generate-csek">many other ways</a>
to perform this task.</span></aside>
<ol>
<li><p>Create a 128-, 192-, or 256-bit AES key. The following command uses <code dir="ltr" translate="no">openssl</code>
to create a 256-bit key in the current directory:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">openssl rand -out "./aes_key.bin" 32
</code></pre>
<p>The file <code dir="ltr" translate="no">aes_key.bin</code> is added to your current directory.</p></li>
<li><p>Encode the AES key as a base64 string:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">base64 -i ./aes_key.bin
</code></pre>
<p>You get an output similar to the following:</p>
<pre dir="ltr" translate="no">
uEDo6/yKx+zCg2cZ1DBwpwvzMVNk/c+jWs7OwpkMc/s=
</pre>
<aside class="warning"><strong>Warning:</strong><span> Do not use this example key to protect actual sensitive workloads.
This key is provided only to serve as an example. Because it's shared here,
this key is not safe to use.</span></aside></li>
</ol>
<h2 data-text="Step 3: Wrap the AES key using the Cloud KMS key" id="wrap-aes-key">Step 3: Wrap the AES key using the Cloud KMS key</h2>
<p>This section describes how to use the Cloud KMS key that you created
in <a href="#create-kms-key">Step 1</a> to wrap the
base64-encoded AES key that you created in <a href="#create-base64-key">Step 2</a>.</p>
<p>To wrap the AES key, use <code dir="ltr" translate="no">curl</code> to send the following request to the
Cloud KMS API
<a href="/kms/docs/reference/rest/v1/projects.locations.keyRings.cryptoKeys/encrypt"><code dir="ltr" translate="no">projects.locations.keyRings.cryptoKeys.encrypt</code></a>:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">curl "https://cloudkms.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key:encrypt" \
  --request "POST" \
  --header "Authorization:Bearer $(gcloud auth application-default print-access-token)" \
  --header "content-type: application/json" \
  --data "{\"plaintext\": \"<var translate="no">BASE64_ENCODED_AES_KEY</var>\"}"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the <a href="/resource-manager/docs/creating-managing-projects#before_you_begin">ID of your project</a>.</li>
<li><code dir="ltr" translate="no"><var translate="no">BASE64_ENCODED_AES_KEY</var></code>: the base64-encoded string
returned in <a href="#create-base64-key">Step 2</a>.</li>
</ul>
<p>The response that you get from Cloud KMS is similar to the following
JSON:</p>
<pre dir="ltr" translate="no">
{
  "name": "projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key/cryptoKeyVersions/1",
  "ciphertext": "CiQAYuuIGo5DVaqdE0YLioWxEhC8LbTmq7Uy2G3qOJlZB7WXBw0SSQAjdwP8ZusZJ3Kr8GD9W0vaFPMDksmHEo6nTDaW/j5sSYpHa1ym2JHk+lUgkC3Zw5bXhfCNOkpXUdHGZKou1893O8BDby/82HY=",
  "ciphertextCrc32c": "901327763",
  "protectionLevel": "SOFTWARE"
}
</pre>
<p>In this output, <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> is the ID of your project.</p>
<p>Take note of the value of <code dir="ltr" translate="no">ciphertext</code> in the response that you get.
That is your wrapped key.</p>
<h2 data-text="Step 4: Send a de-identify request to the DLP API" id="deidentify">Step 4: Send a de-identify request to the DLP API</h2>
<p>This section describes how to de-identify sensitive data in text content.</p>
<p>To complete this task, you need the following:</p>
<ul>
<li>The full resource name of the Cloud KMS key that you created in
<a href="/dlp/docs/inspect-sensitive-text-de-identify#create-kms-key">Step 1</a>.</li>
<li>The wrapped key that you created in <a href="/dlp/docs/inspect-sensitive-text-de-identify#wrap-aes-key">Step 3</a>.</li>
</ul>
<p>To de-identify sensitive data in text content, follow these steps:</p>
<ol>
<li><p>Create a JSON request file with the following text.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item": {
    "value": "My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig": {
    "infoTypeTransformations": {
      "transformations": [
        {
          "infoTypes": [
            {
              "name": "EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation": {
            "cryptoDeterministicConfig": {
              "cryptoKey": {
                "kmsWrapped": {
                  "cryptoKeyName": "projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key",
                  "wrappedKey": "<var translate="no">WRAPPED_KEY</var>"
                }
              },
              "surrogateInfoType": {
                "name": "EMAIL_ADDRESS_TOKEN"
              }
            }
          }
        }
      ]
    }
  },
  "inspectConfig": {
    "infoTypes": [
      {
        "name": "EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p>Replace the following:</p>
<ul>
<li><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your project.</li>
<li><code dir="ltr" translate="no"><var translate="no">WRAPPED_KEY</var></code>: the wrapped key that you created in
<a href="/dlp/docs/inspect-sensitive-text-de-identify#wrap-aes-key">Step 3</a>.</li>
</ul>
<p>Make sure that the resulting value of <code dir="ltr" translate="no">cryptoKeyName</code> forms the full resource
name of your Cloud KMS key.</p>
<p>For more information on the components of this JSON request, see
<a href="/dlp/docs/reference/rest/v2/projects.locations.content/deidentify"><code dir="ltr" translate="no">projects.locations.content.deidentify</code></a>.
After you complete this quickstart, try experimenting with different inputs
for this request. You can use <code dir="ltr" translate="no">curl</code> as described here. Alternatively, you
can use the API Explorer on that API reference page under <strong>Try this API</strong>.</p></li>
<li><p>Save the file as <code dir="ltr" translate="no">deidentify-request.json</code>.</p></li>
<li><p>Use <code dir="ltr" translate="no">curl</code> to make a <code dir="ltr" translate="no">projects.locations.content.deidentify</code> request:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -s \
-H "Authorization: Bearer $(gcloud auth application-default print-access-token)" \
-H "Content-Type: application/json" \
https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/locations/global/content:deidentify \
-d @deidentify-request.json
</code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the ID of your project.</p>
<p>To pass a filename to <code dir="ltr" translate="no">curl</code> you use the
<code dir="ltr" translate="no">-d</code> option (for data) and precede the filename with an
<code dir="ltr" translate="no">@</code> sign. This file must be in the same directory where you
execute the <code dir="ltr" translate="no">curl</code> command.</p>
<aside class="note"><strong>Note:</strong><span> This example request explicitly targets the <code dir="ltr" translate="no">global</code> location. This is
the same as calling the <a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">projects.content.deidentify</code></a> API,
which defaults to the <code dir="ltr" translate="no">global</code> location.</span></aside>
<p>The response that you get from Cloud DLP is similar to the
following JSON:</p>
<pre dir="ltr" translate="no">
{
 "item": {
   "value": "My name is Alicia Abernathy, and my email address is EMAIL_ADDRESS_TOKEN(52):AVAx2eIEnIQP5jbNEr2j9wLOAd5m4kpSBR/0jjjGdAOmryzZbE/q."
 },
 "overview": {
   "transformedBytes": "22",
   "transformationSummaries": [
     {
       "infoType": {
         "name": "EMAIL_ADDRESS"
       },
       "transformation": {
         "cryptoDeterministicConfig": {
           "cryptoKey": {
             "kmsWrapped": {
               "wrappedKey": "CiQAYuuIGo5DVaqdE0YLioWxEhC8LbTmq7Uy2G3qOJlZB7WXBw0SSQAjdwP8ZusZJ3Kr8GD9W0vaFPMDksmHEo6nTDaW/j5sSYpHa1ym2JHk+lUgkC3Zw5bXhfCNOkpXUdHGZKou1893O8BDby/82HY=",
               "cryptoKeyName": "projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key"
             }
           },
           "surrogateInfoType": {
             "name": "EMAIL_ADDRESS_TOKEN"
           }
         }
       },
       "results": [
         {
           "count": "1",
           "code": "SUCCESS"
         }
       ],
       "transformedBytes": "22"
     }
   ]
 }
}
</pre>
<p>In the <code dir="ltr" translate="no">item</code> field, the email address is replaced with a token like
<code dir="ltr" translate="no">EMAIL_ADDRESS_TOKEN(52):AVAx2eIEnIQP5jbNEr2j9wLOAd5m4kpSBR/0jjjGdAOmryzZbE/q</code>.
To re-identify this content, you must pass the entire token in the
re-identify request.</p></li>
</ol>
<h2 data-text="Step 5: Send a re-identify request to the DLP API" id="step_5_send_a_re-identify_request_to_the">Step 5: Send a re-identify request to the DLP API</h2>
<p>This section describes how to re-identify tokenized data in text content.</p>
<p>To complete this task, you need the following:</p>
<ul>
<li>The full resource name of the Cloud KMS key that you created in
<a href="/dlp/docs/inspect-sensitive-text-de-identify#create-kms-key">Step 1</a>.</li>
<li>The wrapped key that you created in <a href="/dlp/docs/inspect-sensitive-text-de-identify#wrap-aes-key">Step 3</a>.</li>
<li>The token that you received in <a href="/dlp/docs/inspect-sensitive-text-de-identify#deidentify">Step 4</a>.</li>
</ul>
<p>To re-identify tokenized content, follow these steps:</p>
<ol>
<li><p>Create a JSON request file with the following text.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "reidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS_TOKEN"
            }
          ],
          "primitiveTransformation":{
            "cryptoDeterministicConfig":{
              "cryptoKey":{
              "kmsWrapped": {
                "cryptoKeyName": "projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key",
                "wrappedKey": "<var translate="no">WRAPPED_KEY</var>"
              }
            },
              "surrogateInfoType":{
                "name":"EMAIL_ADDRESS_TOKEN"
              }
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS_TOKEN"
        },
        "surrogateType":{

        }
      }
    ]
  },
  "item":{
    "value": "My name is Alicia Abernathy, and my email address is <var translate="no">TOKEN</var>."
  }
}
</code></pre>
<p>Replace the following:</p>
<ul>
<li><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the ID of your project.</li>
<li><code dir="ltr" translate="no"><var translate="no">WRAPPED_KEY</var></code>: the wrapped key that you created in
<a href="/dlp/docs/inspect-sensitive-text-de-identify#wrap-aes-key">Step 3</a>.</li>
<li><code dir="ltr" translate="no"><var translate="no">TOKEN</var></code>: the token that you received in
<a href="/dlp/docs/inspect-sensitive-text-de-identify#deidentify">Step 4</a>âfor example,
<code dir="ltr" translate="no">EMAIL_ADDRESS_TOKEN(52):AVAx2eIEnIQP5jbNEr2j9wLOAd5m4kpSBR/0jjjGdAOmryzZbE/q</code>.</li>
</ul>
<p>Make sure that the resulting value of <code dir="ltr" translate="no">cryptoKeyName</code> forms the full resource
name of your Cloud KMS key.</p>
<p>For more information on the components of this JSON request, see
<a href="/dlp/docs/reference/rest/v2/projects.locations.content/reidentify"><code dir="ltr" translate="no">projects.locations.content.reidentify</code></a>.
After you complete this quickstart, try experimenting with different inputs
for this request. You can use <code dir="ltr" translate="no">curl</code> as described here. Alternatively, you
can use the API Explorer on that API reference page under <strong>Try this API</strong>.</p></li>
<li><p>Save the file as <code dir="ltr" translate="no">reidentify-request.json</code>.</p></li>
<li><p>Use <code dir="ltr" translate="no">curl</code> to make a <code dir="ltr" translate="no">projects.locations.content.reidentify</code> request:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">curl -s \
-H "Authorization: Bearer $(gcloud auth application-default print-access-token)" \
-H "Content-Type: application/json" \
https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/locations/global/content:reidentify \
-d @reidentify-request.json
</code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the ID of your project.</p>
<p>To pass a filename to <code dir="ltr" translate="no">curl</code> you use the
<code dir="ltr" translate="no">-d</code> option (for data) and precede the filename with an
<code dir="ltr" translate="no">@</code> sign. This file must be in the same directory where you
execute the <code dir="ltr" translate="no">curl</code> command.</p>
<aside class="note"><strong>Note:</strong><span> This example request explicitly targets the <code dir="ltr" translate="no">global</code> location. This is
the same as calling the <a href="/dlp/docs/reference/rest/v2/projects.content/reidentify"><code dir="ltr" translate="no">projects.content.reidentify</code></a> API,
which defaults to the <code dir="ltr" translate="no">global</code> location.</span></aside>
<p>The response that you get from Cloud DLP is similar to the
following JSON:</p>
<pre dir="ltr" translate="no">
{
 "item": {
   "value": "My name is Alicia Abernathy, and my email address is aabernathy@example.com."
 },
 "overview": {
   "transformedBytes": "70",
   "transformationSummaries": [
     {
       "infoType": {
         "name": "EMAIL_ADDRESS"
       },
       "transformation": {
         "cryptoDeterministicConfig": {
           "cryptoKey": {
             "kmsWrapped": {
               "wrappedKey": "CiQAYuuIGo5DVaqdE0YLioWxEhC8LbTmq7Uy2G3qOJlZB7WXBw0SSQAjdwP8ZusZJ3Kr8GD9W0vaFPMDksmHEo6nTDaW/j5sSYpHa1ym2JHk+lUgkC3Zw5bXhfCNOkpXUdHGZKou1893O8BDby/82HY=",
               "cryptoKeyName": "projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key"
             }
           },
           "surrogateInfoType": {
             "name": "EMAIL_ADDRESS_TOKEN"
           }
         }
       },
       "results": [
         {
           "count": "1",
           "code": "SUCCESS"
         }
       ],
       "transformedBytes": "70"
     }
   ]
 }
}
</pre>
<p>In the <code dir="ltr" translate="no">item</code> field, the email address token is replaced with the actual
email address from the original text.</p>
<p>You've just de-identified and re-identified sensitive data
in text content using deterministic encryption.</p></li>
</ol>
</section>
<section class="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>
          To avoid incurring charges to your Google Cloud account for
          the resources used on this page, follow these steps.
        </p>
<h3 data-text="Destroy your key version" id="destroy_your_key_version">Destroy your key version</h3>
<p>If you no longer want to use the key you created in this quickstart, destroy
its version.</p>
<aside class="warning"><strong>Warning:</strong><span> When you destroy a key version, you can no longer decrypt
content that was encrypted using that version of the key. Make sure that
you no longer need a key version before you destroy it.</span></aside>
<p>List the versions available for your key:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code class="devsite-terminal" dir="ltr" translate="no">gcloud kms keys versions list \
    --location "global" \
    --keyring "dlp-keyring" \
    --key "dlp-key"</code>
</pre>
<p>To destroy a version, run the following command:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys versions destroy <var translate="no">KEY_VERSION</var> \
    --location "global" \
    --keyring "dlp-keyring" \
    --key "dlp-key"
</code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_VERSION</var></code> with the number of the version to be
destroyed.</p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>
  The easiest way to eliminate billing is to delete the project that you
  created for the tutorial.
</p>
<p>To delete the project:
  <ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</p>

</section>
<section class="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li>For more in-depth information on how to de-identify sensitive content,
see <a href="/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>.</li>
<li>For information on how a de-identification workflow fits into real-life
deployments, see <a href="/architecture/de-identification-re-identification-pii-using-cloud-dlp">De-identification and re-identification of PII in
large-scale datasets using Cloud DLP</a>.</li>
<li>For conceptual information on tokenizing data through a cryptographic key,
see <a href="/dlp/docs/pseudonymization">Pseudonymization</a>.</li>
</ul>
</section>
<section class="appendix">
</section>
<section class="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/samples]</H1></p><div class="devsite-article-body clearfix">
<p>This page contains code samples for Cloud Data Loss Prevention. To search and filter code samples for other
Google Cloud products, see the
<a class="cloud-link" href="/docs/samples?p=dlp">Google Cloud sample browser</a>.</p>
<div class="cloud-card__container">
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Character masking" id="character-masking">Character masking</h4>
<p class="cloud-body-text" id="desc">Demonstrates masking characters.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking#dlp_deidentify_masking-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-masking">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Client library quickstart" id="client-library-quickstart">Client library quickstart</h4>
<p class="cloud-body-text" id="desc">Demonstrates inspecting a string with the Cloud DLP API.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-python">
              Python
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart#dlp_quickstart-ruby">
              Ruby
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-quickstart">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/libraries">Cloud DLP client libraries</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Compute l-diversity" id="compute-l-diversity">Compute l-diversity</h4>
<p class="cloud-body-text" id="desc">ComputeÂ l-diversity with Cloud DLP. L-diversity, whichÂ is an extension ofÂ k-anonymity, measures the diversity of sensitive values for each column in which they occur. A dataset hasÂ l-diversity if, for every set of rows with identical quasi-identifiers, there are at leastÂ lÂ distinct values for each sensitive attribute.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity#dlp_l_diversity-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-l-diversity">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-l-diversity">Computing l-diversity for a dataset</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Compute numerical statistics" id="compute-numerical-statistics">Compute numerical statistics</h4>
<p class="cloud-body-text" id="desc">You can determine minimum, maximum, and quantile values for an individual BigQuery column. To calculate these values, you configure a DlpJob, setting the NumericalStatsConfig privacy metric to the name of the column to scan. When you run the job, Cloud DLP computes statistics for the given column, returning its results in the NumericalStatsResult object.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats#dlp_numerical_stats-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-numerical-stats">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-stats">Computing numerical and categorical statistics</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Computing k-anonymity" id="computing-k-anonymity">Computing k-anonymity</h4>
<p class="cloud-body-text" id="desc">K-anonymity is a property of a dataset that indicates the re-identifiability of its records. A dataset is k-anonymous if quasi-identifiers for each person in the dataset are identical to at least k â 1 other people also in the dataset. This sample demonstrates how to use Cloud DLP to compute a k-anonymity value.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity#dlp_k_anonymity-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-k-anonymity">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-k-anonymity">Computing k-anonymity for a dataset</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Computing k-map estimates " id="computing-k-map-estimates">Computing k-map estimates </h4>
<p class="cloud-body-text" id="desc">You can estimate k-map values using Cloud DLP, which uses a statistical model to estimate a re-identification dataset.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map#dlp_k_map-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-k-map">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-k-map">Computing k-map for a dataset</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create a job trigger" id="create-a-job-trigger">Create a job trigger</h4>
<p class="cloud-body-text" id="desc">Creates a scheduled Cloud Data Loss Prevention API job trigger.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger#dlp_create_trigger-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-create-trigger">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create an exception list for de-identification" id="create-an-exception-list-for-de-identification">Create an exception list for de-identification</h4>
<p class="cloud-body-text" id="desc">Create an exception list for a regular custom dictionary detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-exception-list#dlp_deidentify_exception_list-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-exception-list#dlp_deidentify_exception_list-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-exception-list">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary detector</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create an inspection job" id="create-an-inspection-job">Create an inspection job</h4>
<p class="cloud-body-text" id="desc">Creates an inspection job with the Cloud Data Loss Prevention API.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-job#dlp_create_job-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-job#dlp_create_job-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-create-job">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Create an inspection template" id="create-an-inspection-template">Create an inspection template</h4>
<p class="cloud-body-text" id="desc">Use templates to create and persist configuration information for use with Cloud DLP. Templates are useful for decoupling configuration informationâsuch as what you inspect for and how you de-identify itâfrom the implementation of your requests. Templates provide a way to re-use configuration and enable consistency across users and datasets. In addition, whenever you update a template, it's updated for any job trigger that uses it.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template#dlp_create_inspect_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-create-inspect-template">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-inspect">Creating Cloud DLP inspection templates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Date shifting of a CSV file" id="date-shifting-of-a-csv-file">Date shifting of a CSV file</h4>
<p class="cloud-body-text" id="desc">Demonstrates date shifting of a CSV file.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift#dlp_deidentify_date_shift-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-date-shift">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="De-identify content through deterministic encryption" id="de-identify-content-through-deterministic-encryption">De-identify content through deterministic encryption</h4>
<p class="cloud-body-text" id="desc">Use the Data Loss Prevention API to de-identify sensitive data in a string using deterministic encryption, which is a reversible cryptographic method. The encryption is performed with a wrapped key.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-deterministic#dlp_deidentify_deterministic-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-deterministic">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify data using table bucketing" id="de-identify-data-using-table-bucketing">De-identify data using table bucketing</h4>
<p class="cloud-body-text" id="desc">Transform a column without inspection. To transform a column in which the content is already known, you can skip inspection and specify a transformation directly.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-bucketing#dlp_deidentify_table_bucketing-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-bucketing">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify data: Redacting with matched input values" id="de-identify-data:-redacting-with-matched-input-values">De-identify data: Redacting with matched input values</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string by redacting matched input values.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-redact#dlp_deidentify_redact-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-redact#dlp_deidentify_redact-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-redact">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="De-identify free text with FPE by using a surrogate" id="de-identify-free-text-with-fpe-by-using-a-surrogate">De-identify free text with FPE by using a surrogate</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string using format-preserving encryption (FPE). The encryption is performed with an unwrapped key.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-free-text-with-fpe-using-surrogate#dlp_deidentify_free_text_with_fpe_using_surrogate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-free-text-with-fpe-using-surrogate">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify sensitive data by replacing with infoType" id="de-identify-sensitive-data-by-replacing-with-infotype">De-identify sensitive data by replacing with infoType</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string by replacing it with the infoType.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace-infotype#dlp_deidentify_replace_infotype-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace-infotype">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data">Redacting sensitive data from text</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify sensitive data with a simple word list" id="de-identify-sensitive-data-with-a-simple-word-list">De-identify sensitive data with a simple word list</h4>
<p class="cloud-body-text" id="desc">Matches against a custom simple word list to de-identify sensitive data.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-simple-word-list#dlp_deidentify_simple_word_list-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-simple-word-list#dlp_deidentify_simple_word_list-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-simple-word-list">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary detector</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify sensitive data: Replacing matched input values" id="de-identify-sensitive-data:-replacing-matched-input-values">De-identify sensitive data: Replacing matched input values</h4>
<p class="cloud-body-text" id="desc">Uses the Data Loss Prevention API to de-identify sensitive data in a string by replacing matched input values with a value that you specify.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace#dlp_deidentify_replace-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace#dlp_deidentify_replace-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace#dlp_deidentify_replace-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-replace">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data using conditional logic and replace with infoTypes" id="de-identify-table-data-using-conditional-logic-and-replace-with-infotypes">De-identify table data using conditional logic and replace with infoTypes</h4>
<p class="cloud-body-text" id="desc">Transform findings only when specific conditions are met on another field.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-infotypes#dlp_deidentify_table_condition_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data using masking and conditional logic" id="de-identify-table-data-using-masking-and-conditional-logic">De-identify table data using masking and conditional logic</h4>
<p class="cloud-body-text" id="desc">Transform a column based on the value of another column.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-masking#dlp_deidentify_table_condition_masking-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-condition-masking">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="De-identify table data with format-preserving encryption" id="de-identify-table-data-with-format-preserving-encryption">De-identify table data with format-preserving encryption</h4>
<p class="cloud-body-text" id="desc">Demonstrates encrypting sensitive data in a table while maintaining format.
</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-fpe#dlp_deidentify_table_fpe-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data with infoTypes" id="de-identify-table-data-with-infotypes">De-identify table data with infoTypes</h4>
<p class="cloud-body-text" id="desc">Transform findings found in columns.  You can transform findings that either make up part of a cell's content or all of it. In this example, all instances of PERSON_NAME are anonymized.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-infotypes#dlp_deidentify_table_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="De-identify table data: Suppress a row based on the content of a column" id="de-identify-table-data:-suppress-a-row-based-on-the-content-of-a-column">De-identify table data: Suppress a row based on the content of a column</h4>
<p class="cloud-body-text" id="desc">Suppress a row based on the content of a column.  You can remove a row entirely based on the content that appears in any column. This example suppresses the record for "Charles Dickens," as this patient is over 89 years old.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-row-suppress#dlp_deidentify_table_row_suppress-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-table-row-suppress">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-deid-tables">Examples of de-identifying tabular data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete a job" id="delete-a-job">Delete a job</h4>
<p class="cloud-body-text" id="desc">Delete a DLP job.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job#dlp_delete_job-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-job">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete a trigger" id="delete-a-trigger">Delete a trigger</h4>
<p class="cloud-body-text" id="desc">Delete a DLP trigger.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger#dlp_delete_trigger-php">
              PHP
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-trigger">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Delete an inspection template" id="delete-an-inspection-template">Delete an inspection template</h4>
<p class="cloud-body-text" id="desc">Delete an inspection template from Cloud DLP.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template#dlp_delete_inspect_template-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-delete-inspect-template">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-deid">Creating Cloud DLP de-identification templates</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-inspect">Creating Cloud DLP inspection templates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Format-preserving encryption (FPE)" id="format-preserving-encryption-fpe">Format-preserving encryption (FPE)</h4>
<p class="cloud-body-text" id="desc">Demonstrates encrypting sensitive characters while maintaining format.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe#dlp_deidentify_fpe-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-deidentify-fpe">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/transformations-reference">Transformation reference</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Get an inspection job" id="get-an-inspection-job">Get an inspection job</h4>
<p class="cloud-body-text" id="desc">Get DLP inspection job.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-get-job#dlp_get_job-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-get-job#dlp_get_job-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-get-job">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a Cloud Storage file" id="inspect-a-cloud-storage-file">Inspect a Cloud Storage file</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data in a file that is located in Cloud Storage.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs#dlp_inspect_gcs-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a local file" id="inspect-a-local-file">Inspect a local file</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data in a local text or image file.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-python">
              Python
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file#dlp_inspect_file-ruby">
              Ruby
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-file">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-text">Inspecting text for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string" id="inspect-a-string">Inspect a string</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data in a string.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-python">
              Python
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string#dlp_inspect_string-ruby">
              Ruby
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-text">Inspecting text for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data by using multiple rules" id="inspect-a-string-for-sensitive-data-by-using-multiple-rules">Inspect a string for sensitive data by using multiple rules</h4>
<p class="cloud-body-text" id="desc">Illustrates applying both exclusion and hotword rules. This snippet's rule set includes both hotword rules and dictionary and regex exclusion rules. Notice that the four rules are specified in an array within the rules element.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules#dlp_inspect_string_multiple_rules-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules#dlp_inspect_string_multiple_rules-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules#dlp_inspect_string_multiple_rules-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-multiple-rules">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, excluding a custom substring" id="inspect-a-string-for-sensitive-data,-excluding-a-custom-substring">Inspect a string for sensitive data, excluding a custom substring</h4>
<p class="cloud-body-text" id="desc">Illustrates how to use an InspectConfig to instruct Cloud DLP to avoid matching on the name "Jimmy" in a scan that uses the specified custom regular expression detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring#dlp_inspect_string_custom_excluding_substring-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring#dlp_inspect_string_custom_excluding_substring-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring#dlp_inspect_string_custom_excluding_substring-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-excluding-substring">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, omitting custom matches" id="inspect-a-string-for-sensitive-data,-omitting-custom-matches">Inspect a string for sensitive data, omitting custom matches</h4>
<p class="cloud-body-text" id="desc">Omit scan matches from a PERSON_NAME detector scan that overlap with a custom detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap#dlp_inspect_string_custom_omit_overlap-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap#dlp_inspect_string_custom_omit_overlap-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap#dlp_inspect_string_custom_omit_overlap-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-omit-overlap">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, omitting overlapping matches on domain and email" id="inspect-a-string-for-sensitive-data,-omitting-overlapping-matches-on-domain-and-email">Inspect a string for sensitive data, omitting overlapping matches on domain and email</h4>
<p class="cloud-body-text" id="desc">Omit matches on domain names that are part of email addresses in a DOMAIN_NAME detector scan.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap#dlp_inspect_string_without_overlap-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap#dlp_inspect_string_without_overlap-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap#dlp_inspect_string_without_overlap-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-without-overlap">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, omitting overlapping matches on person and email" id="inspect-a-string-for-sensitive-data,-omitting-overlapping-matches-on-person-and-email">Inspect a string for sensitive data, omitting overlapping matches on person and email</h4>
<p class="cloud-body-text" id="desc">Omit matches on a PERSON_NAME detector if also matched by an EMAIL_ADDRESS detector.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-omit-overlap#dlp_inspect_string_omit_overlap-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-omit-overlap#dlp_inspect_string_omit_overlap-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-omit-overlap">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string for sensitive data, using exclusion dictionary" id="inspect-a-string-for-sensitive-data,-using-exclusion-dictionary">Inspect a string for sensitive data, using exclusion dictionary</h4>
<p class="cloud-body-text" id="desc">Omit a specific email address from an EMAIL_ADDRESS detector scan with an exclusion dictionary.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict#dlp_inspect_string_with_exclusion_dict-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict#dlp_inspect_string_with_exclusion_dict-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict#dlp_inspect_string_with_exclusion_dict-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string from sensitive data by using a custom hotword" id="inspect-a-string-from-sensitive-data-by-using-a-custom-hotword">Inspect a string from sensitive data by using a custom hotword</h4>
<p class="cloud-body-text" id="desc">Increase the likelihood of a PERSON_NAME match if there is the hotword "patient" nearby. 
Illustrates using the InspectConfig property for the purpose of scanning a medical database for patient names. You can use Cloud DLP's built-in PERSON_NAME infoType detector, but that causes Cloud DLP to match on all names of people, not just names of patients. To fix this, you can include a hotword rule that looks for the word "patient" within a certain character proximity from the first character of potential matches. You can then assign findings that match this pattern a likelihood of "very likely," since they correspond to your special criteria. Setting the minimum likelihood to VERY_LIKELY within InspectConfig ensures that only matches to this configuration are returned in findings.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-hotword#dlp_inspect_string_custom_hotword-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-hotword#dlp_inspect_string_custom_hotword-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-custom-hotword">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string with an exclusion dictionary substring" id="inspect-a-string-with-an-exclusion-dictionary-substring">Inspect a string with an exclusion dictionary substring</h4>
<p class="cloud-body-text" id="desc">Omit scan matches that include the substring "TEST".</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring#dlp_inspect_string_with_exclusion_dict_substring-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring#dlp_inspect_string_with_exclusion_dict_substring-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring#dlp_inspect_string_with_exclusion_dict_substring-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-dict-substring">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a string, excluding REGEX matches" id="inspect-a-string,-excluding-regex-matches">Inspect a string, excluding REGEX matches</h4>
<p class="cloud-body-text" id="desc">Omit email addresses ending with a specific domain from an EMAIL_ADDRESS detector scan.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex#dlp_inspect_string_with_exclusion_regex-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex#dlp_inspect_string_with_exclusion_regex-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex#dlp_inspect_string_with_exclusion_regex-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-string-with-exclusion-regex">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect a table for sensitive content" id="inspect-a-table-for-sensitive-content">Inspect a table for sensitive content</h4>
<p class="cloud-body-text" id="desc">Check a table of data for sensitive content.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-table#dlp_inspect_table-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-table#dlp_inspect_table-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-table">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-structured-text">Inspecting structured text for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect an image file for sensitive data" id="inspect-an-image-file-for-sensitive-data">Inspect an image file for sensitive data</h4>
<p class="cloud-body-text" id="desc">Uses Cloud DLP to inspect an image for sensitive data.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-file#dlp_inspect_image_file-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-file#dlp_inspect_image_file-php">
              PHP
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-file">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect an image for sensitive data with listed infoTypes" id="inspect-an-image-for-sensitive-data-with-listed-infotypes">Inspect an image for sensitive data with listed infoTypes</h4>
<p class="cloud-body-text" id="desc">If you want to inspect an image for only certain sensitive data types, specify their corresponding built-in infoTypes.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-listed-infotypes#dlp_inspect_image_listed_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-listed-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect BigQuery for sensitive data" id="inspect-bigquery-for-sensitive-data">Inspect BigQuery for sensitive data</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data that is stored in BigQuery.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery#dlp_inspect_bigquery-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect BigQuery for sensitive data with sampling" id="inspect-bigquery-for-sensitive-data-with-sampling">Inspect BigQuery for sensitive data with sampling</h4>
<p class="cloud-body-text" id="desc">The following examples demonstrate using the Cloud Data Loss Prevention API to scan a 1000-row subset of a BigQuery table. The scan starts from a random row.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery-with-sampling#dlp_inspect_bigquery_with_sampling-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-bigquery-with-sampling">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect data for phone numbers" id="inspect-data-for-phone-numbers">Inspect data for phone numbers</h4>
<p class="cloud-body-text" id="desc">Demonstrates a simple scan request to the Cloud DLP API. Notice that the PHONE_NUMBER detector is specified in inspectConfig, which instructs Cloud DLP to scan the given string for a phone number.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-phone-number#dlp_inspect_phone_number-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-phone-number">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/concepts-infotypes">InfoTypes and infoType detectors</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect data with a custom regex" id="inspect-data-with-a-custom-regex">Inspect data with a custom regex</h4>
<p class="cloud-body-text" id="desc">Regex example: Matching medical record numbers.
The following sample uses a regular expression custom infoType detector that instructs Cloud DLP to match a medical record number (MRN) in the input text "Patient's MRN 444-5-22222," and then assigns each match a likelihood of POSSIBLE.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-custom-regex#dlp_inspect_custom_regex-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-custom-regex">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-regex">Creating a custom regex detector</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/examples-custom-infotypes">Examples of custom infotype detectors</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect data with a hotword rule" id="inspect-data-with-a-hotword-rule">Inspect data with a hotword rule</h4>
<p class="cloud-body-text" id="desc">This sample uses a custom regex with a hotword rule to increase the likelihood of match.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-hotword-rule#dlp_inspect_hotword_rule-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-hotword-rule">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-custom-infotypes-likelihood">Customizing match likelihood</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect Datastore" id="inspect-datastore">Inspect Datastore</h4>
<p class="cloud-body-text" id="desc">Demonstrates finding sensitive data stored in Datastore.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore#dlp_inspect_datastore-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-datastore">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect image for sensitive data with infoTypes" id="inspect-image-for-sensitive-data-with-infotypes">Inspect image for sensitive data with infoTypes</h4>
<p class="cloud-body-text" id="desc">To inspect an image for sensitive data, you submit a base64-encoded image to the Cloud DLP API's content.inspect method. Unless you specify information types (infoTypes) to search for, Cloud DLP searches for the most common infoTypes.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-all-infotypes#dlp_inspect_image_all_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-image-all-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-images">Inspecting images for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Inspect storage with sampling" id="inspect-storage-with-sampling">Inspect storage with sampling</h4>
<p class="cloud-body-text" id="desc">The following examples demonstrate using the Cloud DLP API to scan a 90% subset of a Cloud Storage bucket for person names. The scan starts from a random location in the dataset and only includes text files under 200 bytes.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs-with-sampling#dlp_inspect_gcs_with_sampling-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-inspect-gcs-with-sampling">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List information types for a category" id="list-information-types-for-a-category">List information types for a category</h4>
<p class="cloud-body-text" id="desc">Demonstrates listing information types for a category.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types#dlp_list_info_types-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-info-types">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/listing-infotypes">Listing built-in infoType detectors</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List jobs" id="list-jobs">List jobs</h4>
<p class="cloud-body-text" id="desc">List all Cloud DLP jobs for the current project.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs#dlp_list_jobs-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-jobs">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List templates" id="list-templates">List templates</h4>
<p class="cloud-body-text" id="desc">List inspection or de-identification templates.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates#dlp_list_inspect_templates-php">
              PHP
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-inspect-templates">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-deid">Creating Cloud DLP de-identification templates</a>
</li>
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-templates-inspect">Creating Cloud DLP inspection templates</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="List triggers" id="list-triggers">List triggers</h4>
<p class="cloud-body-text" id="desc">List all job triggers for the current project.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers#dlp_list_triggers-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-list-triggers">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection jobs</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Perform risk analysis" id="perform-risk-analysis">Perform risk analysis</h4>
<p class="cloud-body-text" id="desc">Use the Data Loss Prevention API to compute risk metrics of a column of categorical data in a BigQuery table.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-csharp">
              C#
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats#dlp_categorical_stats-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-categorical-stats">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/compute-stats">Computing numerical and categorical statistics</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify content encrypted by deterministic encryption" id="re-identify-content-encrypted-by-deterministic-encryption">Re-identify content encrypted by deterministic encryption</h4>
<p class="cloud-body-text" id="desc">Re-identify content that was previously de-identified through deterministic encryption.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-deterministic#dlp_reidentify_deterministic-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-deterministic">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify content encrypted by FPE" id="re-identify-content-encrypted-by-fpe">Re-identify content encrypted by FPE</h4>
<p class="cloud-body-text" id="desc">Demonstrates re-identifying de-identified content.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe#dlp_reidentify_fpe-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify free text with FPE using a surrogate" id="re-identify-free-text-with-fpe-using-a-surrogate">Re-identify free text with FPE using a surrogate</h4>
<p class="cloud-body-text" id="desc">Uses the Cloud Data Loss Prevention API to re-identify sensitive data in a string that was encrypted by format-preserving encryption (FPE) with a surrogate type. The encryption is performed with an unwrapped key.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-free-text-with-fpe-using-surrogate#dlp_reidentify_free_text_with_fpe_using_surrogate-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-free-text-with-fpe-using-surrogate">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify table data with FPE" id="re-identify-table-data-with-fpe">Re-identify table data with FPE</h4>
<p class="cloud-body-text" id="desc">Re-identify table data with format-preserving encryption.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-table-fpe#dlp_reidentify_table_fpe-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-table-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__full">
<h4 class="cloud-headline4" data-text="Re-identify text data with FPE" id="re-identify-text-data-with-fpe">Re-identify text data with FPE</h4>
<p class="cloud-body-text" id="desc">Re-identify text data with format-preserving encryption.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-text-fpe#dlp_reidentify_text_fpe-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-reidentify-text-fpe">
            View sample
          </a>
</div>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact all detected text in an image" id="redact-all-detected-text-in-an-image">Redact all detected text in an image</h4>
<p class="cloud-body-text" id="desc">Redact all detected text in an image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-text#dlp_redact_image_all_text-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-text#dlp_redact_image_all_text-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-text">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact an image" id="redact-an-image">Redact an image</h4>
<p class="cloud-body-text" id="desc">Demonstrates redacting sensitive data from an image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-go">
              Go
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-java">
              Java
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-nodejs">
              Node.js
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-php">
              PHP
            </a>
</span>
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image#dlp_redact_image-python">
              Python
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact data from an image with color-coded infoTypes" id="redact-data-from-an-image-with-color-coded-infotypes">Redact data from an image with color-coded infoTypes</h4>
<p class="cloud-body-text" id="desc">Redacting infoTypes from an image with color coding.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-colored-infotypes#dlp_redact_image_colored_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-colored-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact only certain sensitive data from an image using infoTypes" id="redact-only-certain-sensitive-data-from-an-image-using-infotypes">Redact only certain sensitive data from an image using infoTypes</h4>
<p class="cloud-body-text" id="desc">Redact only certain sensitive data from an image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-listed-infotypes#dlp_redact_image_listed_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-listed-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cloud-card cloud-card--extra-large">
<div class="snippet-card">
<div class="snippet-card-content__left">
<h4 class="cloud-headline4" data-text="Redact sensitive data from an image using default infoTypes" id="redact-sensitive-data-from-an-image-using-default-infotypes">Redact sensitive data from an image using default infoTypes</h4>
<p class="cloud-body-text" id="desc">Redact the default infoTypes from this image.</p>
<div class="languages">
<span class="cloud-chip cloud-card__chip lang-chip cloud-chip--yellow-bg">
<a class="lang-link" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-infotypes#dlp_redact_image_all_infotypes-java">
              Java
            </a>
</span>
</div>
<div class="button-div">
<a class="cloud-button cloud-button--secondary" href="https://cloud.google.com/dlp/docs/samples/dlp-redact-image-all-infotypes">
            View sample
          </a>
</div>
</div>
<div class="snippet-card-content__right">
<p class="cloud-body-text" id="view-in-docs">View in documentation</p>
<ul class="cloud-list-card__list">
<li class="cloud-list-card__list-item">
<a class="cloud-link" href="https://cloud.google.com/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from images</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/how-to]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="auth">
<ul class="card-showcase">
<header>Authentication</header>
<li>
<a class="no-logo" href="/dlp/docs/auth">
<h3 class="hide-from-toc no-link" data-text="Authenticating to the DLP API" id="authenticating-to-the-dlp-api">Authenticating to the DLP API</h3>
<p>
    Learn how to specify an API key or use service accounts to access the
    DLP API.
    </p>
</a>
</li>
</ul></div>
<div class="card" id="inspect">
<ul class="card-showcase">
<header>Inspection</header>
<li>
<a class="no-logo" href="/dlp/docs/inspecting-text">
<h3 class="hide-from-toc no-link" data-text="Inspecting text for sensitive data" id="inspecting-text-for-sensitive-data">Inspecting text for sensitive data</h3>
<p>
    Detect and classify sensitive information contained within text strings and text files.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/inspecting-structured-text">
<h3 class="hide-from-toc no-link" data-text="Inspecting structured text for sensitive data" id="inspecting-structured-text-for-sensitive-data">Inspecting structured text for sensitive data</h3>
<p>
    Detect and classify sensitive information contained within structured text strings.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/inspecting-images">
<h3 class="hide-from-toc no-link" data-text="Inspecting images for sensitive data" id="inspecting-images-for-sensitive-data">Inspecting images for sensitive data</h3>
<p>
    Detect and classify sensitive information contained within images.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/inspecting-storage">
<h3 class="hide-from-toc no-link" data-text="Inspecting storage and databases for sensitive data" id="inspecting-storage-and-databases-for-sensitive-data">Inspecting storage and databases for sensitive data</h3>
<p>
    Detect and classify sensitive information contained within content stored
    in Google Cloud Storage, Datastore, and BigQuery.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/how-to-hybrid-jobs">
<h3 class="hide-from-toc no-link" data-text="Inspecting data from external sources using hybrid jobs" id="inspecting-data-from-external-sources-using-hybrid-jobs">Inspecting data from external sources using hybrid jobs</h3>
<p>
    Learn how to use hybrid jobs and job triggers to stream data from virtually
    any source, inspect the data for sensitive information, save the inspection
    scan results to a hybrid job resource, and run an action to send the results
    to another Google Cloud product for analysis.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-templates">
<h3 class="hide-from-toc no-link" data-text="Creating inspection templates" id="creating-inspection-templates">Creating inspection templates</h3>
<p>
    Use templates to create and persist inspect job configuration information.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="infotypes">
<ul class="card-showcase">
<header>InfoType detectors</header>
<li>
<a class="no-logo" href="/dlp/docs/listing-infotypes">
<h3 class="hide-from-toc no-link" data-text="Listing built-in infoType detectors" id="listing-built-in-infotype-detectors">Listing built-in infoType detectors</h3>
<p>
    Programmatically retrieve a list of all currently supported built-in
    infoType detectors.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-custom-infotypes">
<h3 class="hide-from-toc no-link" data-text="Creating custom infoType detectors" id="creating-custom-infotype-detectors">Creating custom infoType detectors</h3>
<p>
    Create your own information type detectors to use for inspection and redaction.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-custom-infotypes-dictionary">
<h3 class="hide-from-toc no-link" data-text="Creating a regular custom dictionary detector" id="creating-a-regular-custom-dictionary-detector">Creating a regular custom dictionary detector</h3>
<p>
    Create your own regular dictionary custom detectors to use for inspection
    and redaction.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-stored-infotypes">
<h3 class="hide-from-toc no-link" data-text="Creating a stored custom dictionary detector" id="creating-a-stored-custom-dictionary-detector">Creating a stored custom dictionary detector</h3>
<p>
    Create large dictionary custom detectors to inspect storage repositories.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-custom-infotypes-regex">
<h3 class="hide-from-toc no-link" data-text="Creating a custom regex detector" id="creating-a-custom-regex-detector">Creating a custom regex detector</h3>
<p>
    Create your own regular expression detectors to use for inspection and redaction.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-custom-infotypes-rules">
<h3 class="hide-from-toc no-link" data-text="Modifying infoType detectors to refine scan results" id="modifying-infotype-detectors-to-refine-scan-results">Modifying infoType detectors to refine scan results</h3>
<p>
    Refine the scan results that Cloud DLP returns by
    modifying the detection mechanism of a given infoType detector.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-custom-infotypes-likelihood">
<h3 class="hide-from-toc no-link" data-text="Customizing match likelihood" id="customizing-match-likelihood">Customizing match likelihood</h3>
<p>
    Use hotword context rules to extend your custom infoType detectors.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="deidentification">
<ul class="card-showcase">
<header>De-identification</header>
<li>
<a class="no-logo" href="/dlp/docs/deidentify-sensitive-data">
<h3 class="hide-from-toc no-link" data-text="De-identifying sensitive data in text content" id="de-identifying-sensitive-data-in-text-content">De-identifying sensitive data in text content</h3>
<p>
    Detect and de-identify sensitive data in text content.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/redacting-sensitive-data-images">
<h3 class="hide-from-toc no-link" data-text="Redacting sensitive data from images" id="redacting-sensitive-data-from-images">Redacting sensitive data from images</h3>
<p>
    Redact sensitive information from images.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/create-wrapped-key">
<h3 class="hide-from-toc no-link" data-text="Creating a wrapped key" id="creating-a-wrapped-key">Creating a wrapped key</h3>
<p>
    Create a wrapped key for the purpose of de-identifying and re-identifying
    content.</p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/creating-templates-deid">
<h3 class="hide-from-toc no-link" data-text="Creating de-identification templates" id="creating-de-identification-templates">Creating de-identification templates</h3>
<p>
    Use templates to create and persist de-identification job configuration information.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="risk">
<ul class="card-showcase">
<header>Re-identification risk analysis</header>
<li>
<a class="no-logo" href="/dlp/docs/compute-risk-analysis">
<h3 class="hide-from-toc no-link" data-text="Measuring re-identification and disclosure risk" id="measuring-re-identification-and-disclosure-risk">Measuring re-identification and disclosure risk</h3>
<p>
    Compute the likelihood that de-identified data will be re-identified, the
    risk of sensitive attribute disclosure, and the risk of dataset membership
    disclosure.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/compute-k-anonymity">
<h3 class="hide-from-toc no-link" data-text="Computing k-anonymity for a dataset" id="computing-k-anonymity-for-a-dataset">Computing k-anonymity for a dataset</h3>
<p>
    Learn how to compute the _k_-anonymity metric, a property of a dataset that
    indicates the re-identifiability of its records.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/compute-l-diversity">
<h3 class="hide-from-toc no-link" data-text="Computing l-diversity for a dataset" id="computing-l-diversity-for-a-dataset">Computing l-diversity for a dataset</h3>
<p>
    Learn how to compute the _l_-diversity metric, an extension of _k_-anonymity
    that measures the diversity of sensitive values for each column in which
    they occur.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/compute-k-map">
<h3 class="hide-from-toc no-link" data-text="Computing k-map for a dataset" id="computing-k-map-for-a-dataset">Computing k-map for a dataset</h3>
<p>
    Learn how to compute the _k_-map metric, which is very similar to
    _k_-anonymity except that it assumes that the attacker most likely doesn't
    know who is in the dataset.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/compute-d-presence">
<h3 class="hide-from-toc no-link" data-text="Computing Î´-presence for a dataset" id="computing-Î´-presence-for-a-dataset">Computing Î´-presence for a dataset</h3>
<p>
    Learn how to compute the _Î´_-presence metric, which quantifies the
    probability that an individual belongs to an analyzed dataset.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/visualizing_re-id_risk">
<h3 class="hide-from-toc no-link" data-text="Visualizing re-identification risk using Google Data Studio" id="visualizing-re-identification-risk-using-google-data-studio">Visualizing re-identification risk using Google Data Studio</h3>
<p>
    Measure the <em>k</em>-anonymity of a dataset using Cloud Data Loss Prevention and
    visualize it in Data Studio to determine the
    re-identifiability of the data.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/compute-stats">
<h3 class="hide-from-toc no-link" data-text="Computing numerical and categorical statistics" id="computing-numerical-and-categorical-statistics">Computing numerical and categorical statistics</h3>
<p>
    Compute numerical and categorical numerical statistics for individual columns in BigQuery tables.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="jobs">
<ul class="card-showcase">
<header>Scheduling jobs</header>
<li>
<a class="no-logo" href="/dlp/docs/creating-job-triggers">
<h3 class="hide-from-toc no-link" data-text="Creating job triggers" id="creating-job-triggers">Creating job triggers</h3>
<p>
    Set off Cloud DLP scan jobs automatically by setting up job triggers.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="results">
<ul class="card-showcase">
<header>Working with DLP scan results</header>
<li>
<a class="no-logo" href="/dlp/docs/sending-results-to-dc">
<h3 class="hide-from-toc no-link" data-text="Sending Cloud DLP scan results to Data Catalog" id="sending-cloud-dlp-scan-results-to-data-catalog">Sending Cloud DLP scan results to Data Catalog</h3>
<p>
    Instruct Cloud DLP to send results directly to Data Catalog.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/sending-results-to-scc">
<h3 class="hide-from-toc no-link" data-text="Sending Cloud DLP scan results to Security Command Center" id="sending-cloud-dlp-scan-results-to-security-command-center">Sending Cloud DLP scan results to Security Command Center</h3>
<p>
    Instruct Cloud DLP to send results directly to Security Command Center.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/analyzing-and-reporting">
<h3 class="hide-from-toc no-link" data-text="Analyzing and reporting on Cloud DLP scan findings" id="analyzing-and-reporting-on-cloud-dlp-scan-findings">Analyzing and reporting on Cloud DLP scan findings</h3>
<p>
    Generate reports and run rich SQL analytics based on Cloud DLP scan findings.
    </p>
</a>
</li>
</ul>
</div>
<div class="card" id="security">
<ul class="card-showcase">
<header>Security</header>
<li>
<a class="no-logo" href="/dlp/docs/securing-dlp">
<h3 class="hide-from-toc no-link" data-text="Securing Cloud DLP resources" id="securing-cloud-dlp-resources">Securing Cloud DLP resources</h3>
<p>
    Learn how to secure Cloud DLP resources using
    VPC Service Controls.
    </p>
</a>
</li>
</ul>
</div>
<p></p></div>
</div>
</section></article></div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/auth]</H1></p><div class="devsite-article-body clearfix">
<p>You must authenticate to the DLP API in order to use it. The
DLP API can handle both API keys and authentication.
The main distinction between these two methods is:</p>
<ul>
<li>API keys identify the calling projectâthe app or siteâthat is
making the call to an API.</li>
<li>Auth tokens identify a userâthe personâthat is using the
project.</li>
</ul>
<h2 data-text="Using an API key for unauthenticated access" id="using_an_api_key_for_unauthenticated_access">Using an API key for unauthenticated access</h2>
<p>You can use a Google Cloud console API key to authenticate to the
DLP API for some methods, including all
<a href="/dlp/docs/reference/rest/v2/projects.content"><code dir="ltr" translate="no">projects.content.*</code></a>
and
<a href="/dlp/docs/reference/rest/v2/projects.image"><code dir="ltr" translate="no">projects.image.*</code></a>
methods.</p>
<ol>
<li>Follow the instructions to
    <a href="https://support.google.com/cloud/answer/6158862">create an API key
      for your Google Cloud console project</a>.</li>
<li>When making any DLP API request, pass your key as the value
    of a <code dir="ltr" translate="no">key</code> parameter. For example:
<pre dir="ltr" translate="no">curl https://dlp.googleapis.com/v2/infoTypes?key=[YOUR_API_KEY]</pre></li>
</ol>
<p>It's important to protect your API keys against unauthorized use. For advice on
how to do this, see <a href="https://support.google.com/cloud/answer/6310037">Best practices for securely using API
keys</a>.</p>
<h2 data-text="Using a service account" id="using_a_service_account">Using a service account</h2>
<p>To use a service account to authenticate to the DLP API:</p>
<ul>
<li>Follow the instructions to
<a href="/iam/docs/creating-managing-service-accounts#creating_a_service_account">create a service account</a>.
Select <strong>JSON</strong> as your key type, and grant the user the <strong>DLP User</strong> role
(roles/dlp.user).</li>
</ul>
<p>For more information about granting roles to service accounts, see
<a href="/iam/docs/granting-roles-to-service-accounts">Granting Roles to Service Accounts</a>.</p>
<aside class="note"><strong>Note:</strong><span> Granting the user the <strong>Owner</strong> role is not necessary.</span></aside>
<p>Once complete, your service account key is downloaded to your browser's
default location.</p>
<p>Next, decide whether you'll provide your service account authentication as a
<a href="#bearer"><em>bearer token</em></a> or using
<a href="#default-creds"><em>application default credentials</em></a>.</p>
<h3 data-text="Bearer tokens using a service account" id="bearer">Bearer tokens using a service account</h3>
<p>If you're calling the DLP API directly, such as by making an
HTTP request with cURL, you'll pass your authentication as a bearer token in an
HTTP Authorization request header. To obtain a bearer token using your service
account:</p>
<ol>
<li>Install the <a href="/sdk/downloads#interactive">
    Google Cloud CLI</a>.</li>
<li>Authenticate to your service account, replacing [KEY_FILE] below
    with the path to your service account key file:

    <pre class="notranslate devsite-click-to-copy" dir="ltr">gcloud auth activate-service-account --key-file [KEY_FILE]</pre></li>
<li>Obtain an authorization token using your service account:

    <pre class="notranslate devsite-click-to-copy" dir="ltr">gcloud auth print-access-token</pre>

    The command returns an access token value.</li>
<li>When calling the API, pass the token value as a <code dir="ltr" translate="no">bearer</code> token
    in an <code dir="ltr" translate="no">Authorization</code> header:

<pre class="notranslate devsite-click-to-copy" dir="ltr">curl -s -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer [ACCESS_TOKEN]' \
  'https://dlp.googleapis.com/v2/infoTypes'</pre></li></ol>
<h3 data-text="Application default credentials" id="default-creds">Application default credentials</h3>
<p>If you're using a client library to call the DLP API, use
<a href="https://developers.google.com/identity/protocols/application-default-credentials">Application Default
Credentials</a> (ADC).</p>
<p>Services using ADC look for credentials within a
<code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code> environment variable. Unless you specifically
want to have ADC use other credentials (for example, user credentials), set
this environment variable to point to your service account key file.</p>
<pre dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS=[PATH_TO_KEY_FILE]</pre>
<h3 data-text="Using Cloud DLP from Compute Engine VMs" id="gce-vms">Using Cloud DLP from Compute Engine VMs</h3>
<p>In order to access the DLP API from VM instances, select
<strong>Allow full access to all Cloud APIs</strong> under the <strong>Identity and API Access</strong>
section when creating the VM.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/data-profiles-workflow-overview]</H1></p><div class="devsite-article-body clearfix">
<p>This page provides an overview of the data profiling service of Cloud Data Loss Prevention.
It also lists procedures that guide you through working with data profiles.</p>
<h2 data-text="Overview" id="overview">Overview</h2>
<p>The Cloud DLP profiler analyzes all BigQuery tables across
an organization, folder, or project, and generates data profiles at the
project, table, and column levels. Each data profile contains metrics about
your data and provides insight into the type of information stored
in your BigQuery tables. Use data profiles to determine
which tables and columns need further protection through security features
like <a href="/bigquery/docs/best-practices-policy-tags">BigQuery policy tags</a>
and de-identification techniques like <a href="/dlp/docs/deidentify-sensitive-data#charactermaskconfig">masking</a>
and <a href="/dlp/docs/pseudonymization">pseudonymization</a>.</p>
<p>To start profiling data in an organization, folder, or project, you create
a <a href="/dlp/docs/data-profiles#scan-configuration">scan configuration</a>. The scan
configuration dictates which resource to profile, which
<a href="/dlp/docs/data-profiles#inspection-template">inspection template</a> to use (if
any), and what to do with the scan output.</p>
<p>Shortly after you configure the profiler, Cloud DLP starts profiling
all BigQuery tables in the resource that you specified. As long as
your scan configuration is active, Cloud DLP automatically
profiles new tables in that resource and
<a href="/dlp/docs/data-profiles#scan-frequency">periodically</a> reprofiles tables
that have schema changes.</p>
<p><figure style="text-align: center">
<a href="/dlp/docs/images/column-data-profiles_2x.png">
<img alt="Screenshot of column data profiles" src="/dlp/docs/images/column-data-profiles.png">
</img></a></figure></p>
<p>For more information about data profiles, see <a href="/dlp/docs/data-profiles">Data profiles for BigQuery
data</a>.</p>
<h2 data-text="Work with data profiles" id="work_with_data_profiles">Work with data profiles</h2>
<p>The workflow for using data profiles is as follows:</p>
<ol>
<li><a href="/dlp/docs/data-profiles#user-roles">Confirm that you have the required user roles</a></li>
<li><a href="/dlp/docs/profile-project">Profile a single project</a></li>
<li><a href="/dlp/docs/profile-org-folder">Profile an organization or folder</a></li>
<li><a href="/dlp/docs/grant-data-profiling-access">Organization or folder scans only: grant profiling access to the service agent</a></li>
<li><a href="/dlp/docs/view-data-profiles">View the data profiles</a></li>
<li><a href="/dlp/docs/analyze-data-profiles">Analyze the data profiles</a></li>
<li><a href="/dlp/docs/data-profiles-remediation">Remediate the findings</a></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about the <a href="/dlp/docs/data-profiles">data profiler</a>.</li>
<li>Refer to a <a href="/dlp/docs/metrics-reference">list of metrics available in data profiles</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/profile-project]</H1></p><div class="devsite-article-body clearfix">

    
      


This page describes how to configure profiling at the project level. If you
want to profile an organization or folder, see
<a href="/dlp/docs/profile-org-folder">Profile data in an organization or folder</a>.



<p>For more information about data profiles,
see <a href="/dlp/docs/data-profiles">Data profiles for BigQuery data</a>.</p>
<p>To start profiling data, you create a scan configuration.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<ol>
<li><p>Make sure the Cloud Data Loss Prevention API is enabled on your project:</p>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the required API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the required API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</slot>
</cloudx-free-trial-eligible-content>
</ol></li>
<li><p>Confirm that you have the IAM permissions that
are required to configure data profiles at the <a href="/dlp/docs/data-profiles#permissions-to-configure-project">project</a> level.</p></li>
<li><p>You can configure Cloud DLP to send notifications to
Pub/Sub when certain events occur, such as when
Cloud DLP profiles a new table. If you want to use this feature,
you must first
<a href="/pubsub/docs/create-topic-console">create a Pub/Sub topic</a>.</p></li>
</ol>
<h2 data-text="Create a scan configuration" id="create_a_scan_configuration">Create a scan configuration</h2>
<p>To create a scan configuration, perform the steps in the following sections.
At the end of each section, click <strong>Continue</strong>.</p>


<ol>
<li><p>Go to the <strong>Create scan configuration</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/discoveryConfiguration" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to Create scan configuration</a> </p></li>
<li><p>If needed, go to your project. On the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector and
select your project.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
</ol>
<p>The following sections provide more information about the steps in the
<strong>Create scan configuration</strong> page.</p>
<h3 data-text="Select resource to scan" id="select_resource_to_scan">Select resource to scan</h3>




Make sure <strong>Scan entire project</strong> is selected.


<h3 data-text="Manage schedules" id="manage-schedules">Manage schedules</h3>
<p>If the <a href="/dlp/docs/data-profiles#scan-frequency">default profiling frequency</a>
suits your needs, you can skip this section of the <strong>Create scan configuration</strong>
page. This section is useful if you want to make fine-grained adjustments to
the profiling frequency of all your data or certain subsets of your data. It's
also useful if you don't want certain tables to ever be profiled, or you want
them to be profiled once and then never again.</p>
<p>In this section, you create filters to specify certain subsets of your data that
are of interest. For these subsets, you define whether Cloud DLP
should profile the tables, and how often. Here, you also specify the types of
changes that should cause a table to be reprofiled. Finally,
you specify any conditions that each table in the subsets must meet before
Cloud DLP starts profiling the table.</p>
<p>To make fine-grained adjustments to profiling frequency, follow these steps:</p>
<ol>
<li>Click <strong>Add schedule</strong>.</li>
<li><p>In the <strong>Filters</strong> section, you define one or more filters that specify
which tables are in the schedule's scope.</p>
<p>Specify at least one of the following:</p>
<ul>
<li>A project ID or a regular expression that specifies one or more projects.</li>
<li>A dataset ID or a regular expression that specifies one or more datasets.</li>
<li>A table ID or a regular expression that specifies one or more tables.</li>
</ul>
<p>Regular expressions must follow the
<a class="external" href="https://github.com/google/re2/wiki/Syntax">RE2 syntax</a>.</p>
<p></p>
<p>
For example, if you want all tables in a dataset to be included in the filter,
specify that dataset's ID and leave the two other fields blank.
</p>
<p>If you want to add more filters, click <strong>Add filter</strong> and repeat this step.</p></li>
<li><p>Click <strong>Frequency</strong>.</p></li>
<li><p>In <strong>Frequency</strong> section, specify whether Cloud DLP should
profile the tables you defined in your filters, and if so, how often:</p>
<ul>
<li><p>If you never want the tables to be profiled, turn off
<strong>Profile the tables</strong>.</p></li>
<li><p>If you want the tables to be profiled at least once, leave
<strong>Profile the tables</strong> on, and follow these steps:</p>
<ol>
<li><p>In the <strong>When schema changes</strong> field, specify when you want the tables
to be reprofiled if they undergo <em>schema</em> changes after
they were last profiled.</p>
<ul>
<li><strong>Do not reprofile</strong>: Never reprofile after the initial profiles are generated.</li>
<li><strong>Reprofile daily</strong>: Reprofile once every 24 hours.</li>
<li><strong>Reprofile monthly</strong>: Reprofile once every 30 days.</li>
</ul></li>
<li><p>For <strong>Types of schema change</strong>, specify which types of schema change
should trigger a reprofile operation:</p>
<ul>
<li><strong>New columns</strong>: Reprofile the tables that gained new columns.</li>
<li><strong>Removed columns</strong>: Reprofile the tables that had columns
removed.</li>
</ul>
<p>Suppose you want reprofile operations to run every 24 hours.
Also, you want to reprofile only the tables that gained new
columns after they were last profiled. In this case, set
<strong>When schema changes</strong> to <strong>Reprofile daily</strong>, and set
<strong>Types of schema change</strong> to <strong>New columns</strong>.</p></li>
<li><p>In the <strong>When table changes</strong> field, specify when you want the tables
to be reprofiled if they undergo any change after they were last
profiled. Examples of table changes are row deletions and schema changes.</p>
<ul>
<li><strong>Do not reprofile</strong>: Never reprofile after the initial profiles are generated.</li>
<li><strong>Reprofile daily</strong>: Reprofile once every 24 hours.</li>
<li><strong>Reprofile monthly</strong>: Reprofile once every 30 days.</li>
</ul></li>
</ol>
<p>You must select a value that is the same as, or less frequent than, the
value you set in the <strong>When schema changes</strong> field.</p></li>
</ul></li>
<li><p>Click <strong>Conditions</strong>.</p></li>
<li><p>In <strong>Conditions</strong> section, specify any conditions that the tables,
defined in your filters, must meet before Cloud DLP profiles
them. If you set minimum conditions <em>and</em> the time condition,
Cloud DLP only profiles tables that meet both types of
conditions.</p>
<ul>
<li><strong>Minimum conditions</strong>: These conditions are useful if you want to delay
profiling of a table until it has enough rows or until it reaches a certain
age. Turn on the conditions you want to apply, and specify the minimum row
count or duration.</li>
<li><strong>Time condition</strong>: This condition is useful if you don't want old tables
to ever be profiled. Turn on the time condition, and pick a date and
time. Any table created on or before that date is excluded from profiling.</li>
</ul>
<p>Suppose you have the following configuration:</p>
<ul>
<li><p><strong>Minimum conditions</strong></p>
<ul>
<li>Minimum row count: 10 rows</li>
<li>Minimum duration: 24 hours</li>
</ul></li>
<li><p><strong>Time condition</strong></p>
<ul>
<li>Timestamp: 5/4/22, 11:59 PM</li>
</ul></li>
</ul>
<p>In this case, Cloud DLP excludes any tables created on or before
May 4, 2022, 11:59 PM. Among the tables created after this date and time,
Cloud DLP profiles only the tables that either have 10 rows <em>or</em>
are at least 24 hours old.</p></li>
<li><p>Click <strong>Done</strong>.</p></li>
<li><p>If you want to add more schedules, click <strong>Add schedule</strong> and repeat the
previous steps.</p></li>
<li><p>To reorder the
schedules according to priority, use the
<span aria-hidden="true" class="material-icons" translate="no">arrow_upward</span> up and
<span aria-hidden="true" class="material-icons" translate="no">arrow_downward</span> down arrows.
For example, if the filters in two different schedules match Table A,
the schedule higher on the priority list takes precedence.</p>
<p></p>
<p>
The last schedule in the list is always the one labeled <strong>Default schedule</strong>.
This default schedule covers the tables in your project that don't match any
of the schedules you created. This default schedule follows the
<a href="/dlp/docs/data-profiles#scan-frequency">system default profiling frequency</a>.
</p></li>
<li><p>If you want to adjust the default schedule, click
<span aria-hidden="true" class="material-icons" translate="no">edit</span> <strong>Edit schedule</strong>, and adjust
the settings as needed.</p></li>
</ol>
<h3 data-text="Select inspection template" id="select-inspection-template">Select inspection template</h3>
<p>Depending on how you want to provide an inspection configuration, choose one of the
following options. Regardless of which option you choose, Cloud DLP
scans your data in the region where you configured BigQuery to
store that data. Your BigQuery data doesn't leave its region
of origin.</p>
<h4 data-text="Option 1: Create an inspection template" id="option_1_create_an_inspection_template">Option 1: Create an inspection template</h4>
<p>Choose this option if you want to create a new inspection template in the
<code dir="ltr" translate="no">global</code> region.</p>
<ol>
<li>Click <strong>Create new inspection template</strong>.</li>
<li><p>Optional: To modify the default selection of infoTypes, click <strong>Manage infoTypes</strong>.
Use the filter to find and select
<a href="/dlp/docs/infotypes-reference">infoTypes</a>. Then, click <strong>Done</strong>.</p>
<aside class="note"><strong>Note:</strong><span> You must have at least one infoType selected to continue.</span></aside></li>
<li><p>Optional: Configure the inspection template further by adding rulesets
and setting a confidence threshold. For more information, see
<a href="/dlp/docs/creating-job-triggers#configure-detection">Configure detection</a>.</p>
<p>When Cloud DLP creates the scan configuration, it stores this
new inspection template in the <code dir="ltr" translate="no">global</code> region.</p></li>
</ol>
<h4 data-text="Option 2: Use an existing inspection template" id="option_2_use_an_existing_inspection_template">Option 2: Use an existing inspection template</h4>
<p>Choose this option if you have existing inspection templates that you
want to use.</p>
<ol>
<li><p>Click <strong>Select existing inspection template</strong>.</p></li>
<li><p>Enter the full resource name of the inspection template that you
want to use. The <strong>Region</strong> field is autopopulated with the name of the
region where your inspection template is stored.</p>
<p>The inspection template you enter must be in the same region as the data
to be profiled. To respect data residency, Cloud DLP doesn't
use an inspection template outside its own region.</p>
<p>To find the full resource name of an inspection template, follow these
steps:</p>
<ol>
<li><p>Go to your inspection templates list. This page opens on a separate tab.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/templates/inspect" target="_blank" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to inspection templates</a> </p></li>
<li><p>If needed, switch to the project that contains the inspection template
that you want to use.</p></li>
<li><p>On the <strong>Templates</strong> tab, click the template ID of the template that you want to use.</p></li>
<li><p>On the page that opens, copy the full resource name of the template. The
full resource name follows this format:</p>
<pre dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">REGION</var>/inspectTemplates/<var translate="no">TEMPLATE_ID</var></pre></li>
<li><p>On the <strong>Create scan configuration</strong> page, in the <strong>Template name</strong>
field, paste the full resource name of the template.</p></li>
</ol></li>
<li><p>If you have data in another region, and you have an inspection template that
you want to use for that region, follow these steps:</p>
<ol>
<li>Click <strong>Add inspection template</strong>.</li>
<li>Enter the inspection template's full resource name.</li>
</ol>
<p>Repeat these steps for each region where you have a dedicated inspection
template.</p></li>
<li><p>Optional: Add an inspection template that's stored in the <code dir="ltr" translate="no">global</code> region.
Cloud DLP automatically uses that template for data in regions
where you don't have a dedicated inspection template.</p>
<aside class="caution"><strong>Caution:</strong><span> If you don't include an inspection template that's stored in the
<code dir="ltr" translate="no">global</code> region, Cloud DLP can't profile data in regions that
don't have a dedicated inspection template. For more information, see
<a href="/dlp/docs/data-profiles#data-residency">Data residency considerations</a>.</span></aside></li>
</ol>
<h3 data-text="Manage scan outcome" id="manage-scan-outcome">Manage scan outcome</h3>
<p>In the following sections, you specify actions that you want Cloud DLP to
take after it generates the data profiles.</p>
<h4 data-text="Save data profile copies to BigQuery" id="save-to-bq">Save data profile copies to BigQuery</h4>
<p>Turning on <strong>Save data profile copies to BigQuery</strong> lets you keep a saved copy
or history of all of your generated
profiles. Doing so can be useful for creating audit reports and <a href="/dlp/docs/analyze-data-profiles">visualizing
data profiles</a>. You can also
load this information into other systems.</p>
<p>Also, this option lets you see all of your data profiles in a single view,
regardless of which region your data resides in. If you turn off
this option, you can still
<a href="/dlp/docs/view-data-profiles">view the data profiles in your dashboard</a>.
However, in your dashboard, you select one region at a time, and see only the
data profiles for that region.</p>
<aside class="note"><strong>Note:</strong><span> When Cloud DLP fails to profile a table, it periodically
retries. To minimize noise in the exported data, Cloud DLP
exports only the successfully generated profiles to BigQuery.
It skips the tables that it failed to profile.</span></aside>
<p>To export copies of the data profiles to a BigQuery table,
follow these steps:</p>
<ol>
<li><p>Turn on <strong>Save data profile copies to BigQuery</strong>.</p></li>
<li><p>Enter the details of the BigQuery
table where you want to save the data profiles:</p>
<ul>
<li><p>For <strong>Project ID</strong>, enter the ID of an existing project where you want
data profiles to be exported to.</p></li>
<li><p>For <strong>Dataset ID</strong>, enter the name of an existing dataset in the project
where you want data profiles to be exported to.</p></li>
<li><p>For <strong>Table ID</strong>, enter a name for the BigQuery table where
data profiles will be exported to. If you haven't created this table,
Cloud DLP automatically creates it for you using the name
you provide.</p></li>
</ul></li>
</ol>
<p>Cloud DLP starts exporting profiles from the time you turn on
this option. Profiles that were generated before you turned on exporting aren't
saved to BigQuery.</p>
<aside class="special"><strong>Note: </strong>The service agent associated with
  your project must have write access on the output table.</aside>
<h4 data-text="Publish to Pub/Sub" id="publish-pubsub">Publish to Pub/Sub</h4>
<p>Turning on <strong>Publish to Pub/Sub</strong> lets you take programmatic
actions based on profiling results. You can use Pub/Sub
notifications to develop a workflow for catching and remediating findings
with significant data risk or sensitivity.</p>
<p>To send notifications to a Pub/Sub topic, follow these steps:</p>
<ol>
<li><p>Turn on <strong>Publish to Pub/Sub</strong>.</p>
<p>A list of options appears. Each option describes an event that causes
Cloud DLP to send a notification to Pub/Sub.</p></li>
<li><p>Select the events that should trigger a Pub/Sub notification.</p>
<p>If you select <strong>Send a Pub/Sub notification each time a profile is
updated</strong>, Cloud DLP sends a notification when there's
a change in the following
<a href="/dlp/docs/metrics-reference#table-data-profile">table-level metrics</a>:</p>
<ul>
<li>Data risk</li>
<li>Sensitivity</li>
<li>Predicted infoTypes</li>
<li>Other infoTypes</li>
<li>Public</li>
<li>Encryption</li>
</ul></li>
<li><p>For each event you select, follow these steps:</p>
<ol>
<li><p>Enter the name of the topic. The name must be in the following format:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/topics/<var translate="no">TOPIC_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the ID of the project associated with the
Pub/Sub topic.</li>
<li><var translate="no">TOPIC_ID</var>: the ID of the Pub/Sub topic.</li>
</ul></li>
<li><p>Specify whether to include the full table profile in the notification,
or just the full resource name of the table that was profiled.
</p></li>
<li><p>Set the minimum data risk and sensitivity levels that must be met for
Cloud DLP to send a notification.</p></li>
<li><p>Specify whether only one or both of the data risk and sensitivity
conditions must be met. For example, if you choose <code dir="ltr" translate="no">AND</code>, then
both the data risk and the sensitivity conditions must be
met before Cloud DLP sends a notification.</p></li>
</ol></li>
</ol>
<aside class="special"><strong>Note: </strong>The service agent associated with
  your project must have
  <a href="/dlp/docs/troubleshoot-data-profiles#grant-publishing-access">
  publishing access</a> on the Pub/Sub topic.</aside>
<h3 data-text="Set location to store configuration" id="set-location">Set location to store configuration</h3>
<p>Click the <strong>Resource location</strong> list, and select the region where you
want to store this scan configuration. All scan configurations that you
later create will also be stored in this location.</p>
<p>Where you choose to store your scan configuration doesn't affect the
data to be scanned. Also, it doesn't affect where the data profiles are
stored. Your data is scanned in the same region where that data is stored
(as set in BigQuery). For more information, see
<a href="/dlp/docs/data-profiles#data-residency">Data residency considerations</a>.</p>
<aside class="note"><strong>Note:</strong><span> If you already have an existing scan configuration, you can't change the value
set in this field. All scan configurations are stored in the same location.
If you want to change the location of all your scan configurations, you must
<a href="/dlp/docs/manage-scan-configurations#delete-config">delete</a> them,
recreate them, and store them in the new location.</span></aside>
<h3 data-text="Review and create" id="review-create">Review and create</h3>
<ol>
<li><p>If you don't want profiling to begin shortly after you create the scan
configuration, select <strong>Create scan in paused mode</strong>.</p>
<p>This option is useful in the following cases:</p>
<ul>
<li>You opted to save data profiles to BigQuery, and you want
to make sure the service agent has write access to your output table.</li>
<li>You configured Pub/Sub notifications and you want to grant
<a href="/dlp/docs/troubleshoot-data-profiles#grant-publishing-access">publishing access</a>
to the service agent.</li>
</ul>
</li>
<li><p>Review your settings and click <strong>Create</strong>.</p>
<p>Cloud DLP creates the scan configuration and adds it to the
<strong>Configurations</strong> list.</p></li>
</ol>
<p>To view or manage your scan configurations, go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p>
<p>If your service agent has the roles needed to access and profile your data,
then Cloud DLP starts scanning your data shortly after you create
the scan configuration. Otherwise, Cloud DLP shows an
<a href="/dlp/docs/troubleshoot-data-profiles">error</a>
when you <a href="/dlp/docs/manage-scan-configurations#view-config">view the scan configuration details</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>

<li>Learn how to <a href="/dlp/docs/view-data-profiles">view the data profiles</a>.</li>
<li>Learn how to <a href="/dlp/docs/manage-scan-configurations">manage scan configurations</a>.</li>
<li>Learn how to <a href="/dlp/docs/troubleshoot-data-profiles">troubleshoot issues with data profiles</a>.</li>

<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/profile-org-folder]</H1></p><div class="devsite-article-body clearfix">

    
      




This page describes how to configure profiling at the level of an organization
or folder. If you want to profile a project, see
<a href="/dlp/docs/profile-project">Profile data in a single project</a>.
<aside class="note"><strong>Note:</strong><span> To generate data profiles, you need a
<a href="/dlp/docs/data-profiles#service-agent-container">service agent container and a service agent</a>
within it. This task lets you create them automatically.
</span></aside>
<p>For more information about data profiles,
see <a href="/dlp/docs/data-profiles">Data profiles for BigQuery data</a>.</p>
<p>To start profiling data, you create a scan configuration.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<ol>
<li><p>Confirm that you have the IAM permissions that
are required to configure data profiles at the
<a href="/dlp/docs/data-profiles#permissions-to-configure-org">organization</a> level.</p>
<p>If you don't have the Organization Administrator
(<code dir="ltr" translate="no">roles/resourcemanager.organizationAdmin</code>) or Security Admin
(<code dir="ltr" translate="no">roles/iam.securityAdmin</code>) role, you can still create a scan
configuration. However, after you create the scan configuration, someone with
either of those roles must <a href="/dlp/docs/grant-data-profiling-access">grant data profiling access</a> to your service agent.</p></li>
<li><p>You can configure Cloud DLP to send notifications to
Pub/Sub when certain events occur, such as when
Cloud DLP profiles a new table. If you want to use this feature,
you must first
<a href="/pubsub/docs/create-topic-console">create a Pub/Sub topic</a>.</p></li>
</ol>
<h2 data-text="Create a scan configuration" id="create_a_scan_configuration">Create a scan configuration</h2>
<p>To create a scan configuration, perform the steps in the following sections.
At the end of each section, click <strong>Continue</strong>.</p>
<ol>
<li><p>Go to the <strong>Create scan configuration</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/discoveryConfiguration" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to Create scan configuration</a> </p></li>
<li><p>If needed, go to your organization. On the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector and
select your organization.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
</ol>


<p>The following sections provide more information about the steps in the
<strong>Create scan configuration</strong> page.</p>
<h3 data-text="Select resource to scan" id="select_resource_to_scan">Select resource to scan</h3>


Do one of the following:
<ul>
<li>To configure profiling at the organization level, select <strong>Scan entire
organization</strong>.</li>
<li>To configure profiling at the level of a folder, select <strong>Scan selected
folder</strong>. Then, click <strong>Browse</strong> and select the folder.
</li>
</ul>
<h3 data-text="Manage schedules" id="manage-schedules">Manage schedules</h3>
<p>If the <a href="/dlp/docs/data-profiles#scan-frequency">default profiling frequency</a>
suits your needs, you can skip this section of the <strong>Create scan configuration</strong>
page. This section is useful if you want to make fine-grained adjustments to
the profiling frequency of all your data or certain subsets of your data. It's
also useful if you don't want certain tables to ever be profiled, or you want
them to be profiled once and then never again.</p>
<p>In this section, you create filters to specify certain subsets of your data that
are of interest. For these subsets, you define whether Cloud DLP
should profile the tables, and how often. Here, you also specify the types of
changes that should cause a table to be reprofiled. Finally,
you specify any conditions that each table in the subsets must meet before
Cloud DLP starts profiling the table.</p>
<p>To make fine-grained adjustments to profiling frequency, follow these steps:</p>
<ol>
<li>Click <strong>Add schedule</strong>.</li>
<li><p>In the <strong>Filters</strong> section, you define one or more filters that specify
which tables are in the schedule's scope.</p>
<p>Specify at least one of the following:</p>
<ul>
<li>A project ID or a regular expression that specifies one or more projects.</li>
<li>A dataset ID or a regular expression that specifies one or more datasets.</li>
<li>A table ID or a regular expression that specifies one or more tables.</li>
</ul>
<p>Regular expressions must follow the
<a class="external" href="https://github.com/google/re2/wiki/Syntax">RE2 syntax</a>.</p>
<p>
For example, if you want all tables in a project to be included in the filter,
specify that project's ID and leave the two other fields blank.
</p>
<p></p>
<p>If you want to add more filters, click <strong>Add filter</strong> and repeat this step.</p></li>
<li><p>Click <strong>Frequency</strong>.</p></li>
<li><p>In <strong>Frequency</strong> section, specify whether Cloud DLP should
profile the tables you defined in your filters, and if so, how often:</p>
<ul>
<li><p>If you never want the tables to be profiled, turn off
<strong>Profile the tables</strong>.</p></li>
<li><p>If you want the tables to be profiled at least once, leave
<strong>Profile the tables</strong> on, and follow these steps:</p>
<ol>
<li><p>In the <strong>When schema changes</strong> field, specify when you want the tables
to be reprofiled if they undergo <em>schema</em> changes after
they were last profiled.</p>
<ul>
<li><strong>Do not reprofile</strong>: Never reprofile after the initial profiles are generated.</li>
<li><strong>Reprofile daily</strong>: Reprofile once every 24 hours.</li>
<li><strong>Reprofile monthly</strong>: Reprofile once every 30 days.</li>
</ul></li>
<li><p>For <strong>Types of schema change</strong>, specify which types of schema change
should trigger a reprofile operation:</p>
<ul>
<li><strong>New columns</strong>: Reprofile the tables that gained new columns.</li>
<li><strong>Removed columns</strong>: Reprofile the tables that had columns
removed.</li>
</ul>
<p>Suppose you want reprofile operations to run every 24 hours.
Also, you want to reprofile only the tables that gained new
columns after they were last profiled. In this case, set
<strong>When schema changes</strong> to <strong>Reprofile daily</strong>, and set
<strong>Types of schema change</strong> to <strong>New columns</strong>.</p></li>
<li><p>In the <strong>When table changes</strong> field, specify when you want the tables
to be reprofiled if they undergo any change after they were last
profiled. Examples of table changes are row deletions and schema changes.</p>
<ul>
<li><strong>Do not reprofile</strong>: Never reprofile after the initial profiles are generated.</li>
<li><strong>Reprofile daily</strong>: Reprofile once every 24 hours.</li>
<li><strong>Reprofile monthly</strong>: Reprofile once every 30 days.</li>
</ul></li>
</ol>
<p>You must select a value that is the same as, or less frequent than, the
value you set in the <strong>When schema changes</strong> field.</p></li>
</ul></li>
<li><p>Click <strong>Conditions</strong>.</p></li>
<li><p>In <strong>Conditions</strong> section, specify any conditions that the tables,
defined in your filters, must meet before Cloud DLP profiles
them. If you set minimum conditions <em>and</em> the time condition,
Cloud DLP only profiles tables that meet both types of
conditions.</p>
<ul>
<li><strong>Minimum conditions</strong>: These conditions are useful if you want to delay
profiling of a table until it has enough rows or until it reaches a certain
age. Turn on the conditions you want to apply, and specify the minimum row
count or duration.</li>
<li><strong>Time condition</strong>: This condition is useful if you don't want old tables
to ever be profiled. Turn on the time condition, and pick a date and
time. Any table created on or before that date is excluded from profiling.</li>
</ul>
<p>Suppose you have the following configuration:</p>
<ul>
<li><p><strong>Minimum conditions</strong></p>
<ul>
<li>Minimum row count: 10 rows</li>
<li>Minimum duration: 24 hours</li>
</ul></li>
<li><p><strong>Time condition</strong></p>
<ul>
<li>Timestamp: 5/4/22, 11:59 PM</li>
</ul></li>
</ul>
<p>In this case, Cloud DLP excludes any tables created on or before
May 4, 2022, 11:59 PM. Among the tables created after this date and time,
Cloud DLP profiles only the tables that either have 10 rows <em>or</em>
are at least 24 hours old.</p></li>
<li><p>Click <strong>Done</strong>.</p></li>
<li><p>If you want to add more schedules, click <strong>Add schedule</strong> and repeat the
previous steps.</p></li>
<li><p>To reorder the
schedules according to priority, use the
<span aria-hidden="true" class="material-icons" translate="no">arrow_upward</span> up and
<span aria-hidden="true" class="material-icons" translate="no">arrow_downward</span> down arrows.
For example, if the filters in two different schedules match Table A,
the schedule higher on the priority list takes precedence.</p>
<p>
The last schedule in the list is always the one labeled <strong>Default schedule</strong>.
This default schedule covers the tables in your selected resource (organization
or folder) that don't match any of the schedules you created. This default
schedule follows the
<a href="/dlp/docs/data-profiles#scan-frequency">system default profiling frequency</a>.
</p>
<p></p></li>
<li><p>If you want to adjust the default schedule, click
<span aria-hidden="true" class="material-icons" translate="no">edit</span> <strong>Edit schedule</strong>, and adjust
the settings as needed.</p></li>
</ol>
<h3 data-text="Select inspection template" id="select-inspection-template">Select inspection template</h3>
<p>Depending on how you want to provide an inspection configuration, choose one of the
following options. Regardless of which option you choose, Cloud DLP
scans your data in the region where you configured BigQuery to
store that data. Your BigQuery data doesn't leave its region
of origin.</p>
<h4 data-text="Option 1: Create an inspection template" id="option_1_create_an_inspection_template">Option 1: Create an inspection template</h4>
<p>Choose this option if you want to create a new inspection template in the
<code dir="ltr" translate="no">global</code> region.</p>
<ol>
<li>Click <strong>Create new inspection template</strong>.</li>
<li><p>Optional: To modify the default selection of infoTypes, click <strong>Manage infoTypes</strong>.
Use the filter to find and select
<a href="/dlp/docs/infotypes-reference">infoTypes</a>. Then, click <strong>Done</strong>.</p>
<aside class="note"><strong>Note:</strong><span> You must have at least one infoType selected to continue.</span></aside></li>
<li><p>Optional: Configure the inspection template further by adding rulesets
and setting a confidence threshold. For more information, see
<a href="/dlp/docs/creating-job-triggers#configure-detection">Configure detection</a>.</p>
<p>When Cloud DLP creates the scan configuration, it stores this
new inspection template in the <code dir="ltr" translate="no">global</code> region.</p></li>
</ol>
<h4 data-text="Option 2: Use an existing inspection template" id="option_2_use_an_existing_inspection_template">Option 2: Use an existing inspection template</h4>
<p>Choose this option if you have existing inspection templates that you
want to use.</p>
<ol>
<li><p>Click <strong>Select existing inspection template</strong>.</p></li>
<li><p>Enter the full resource name of the inspection template that you
want to use. The <strong>Region</strong> field is autopopulated with the name of the
region where your inspection template is stored.</p>
<p>The inspection template you enter must be in the same region as the data
to be profiled. To respect data residency, Cloud DLP doesn't
use an inspection template outside its own region.</p>
<p>To find the full resource name of an inspection template, follow these
steps:</p>
<ol>
<li><p>Go to your inspection templates list. This page opens on a separate tab.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/templates/inspect" target="_blank" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to inspection templates</a> </p></li>
<li><p>If needed, switch to the project that contains the inspection template
that you want to use.</p></li>
<li><p>On the <strong>Templates</strong> tab, click the template ID of the template that you want to use.</p></li>
<li><p>On the page that opens, copy the full resource name of the template. The
full resource name follows this format:</p>
<pre dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">REGION</var>/inspectTemplates/<var translate="no">TEMPLATE_ID</var></pre></li>
<li><p>On the <strong>Create scan configuration</strong> page, in the <strong>Template name</strong>
field, paste the full resource name of the template.</p></li>
</ol></li>
<li><p>If you have data in another region, and you have an inspection template that
you want to use for that region, follow these steps:</p>
<ol>
<li>Click <strong>Add inspection template</strong>.</li>
<li>Enter the inspection template's full resource name.</li>
</ol>
<p>Repeat these steps for each region where you have a dedicated inspection
template.</p></li>
<li><p>Optional: Add an inspection template that's stored in the <code dir="ltr" translate="no">global</code> region.
Cloud DLP automatically uses that template for data in regions
where you don't have a dedicated inspection template.</p>
<aside class="caution"><strong>Caution:</strong><span> If you don't include an inspection template that's stored in the
<code dir="ltr" translate="no">global</code> region, Cloud DLP can't profile data in regions that
don't have a dedicated inspection template. For more information, see
<a href="/dlp/docs/data-profiles#data-residency">Data residency considerations</a>.</span></aside></li>
</ol>
<h3 data-text="Manage scan outcome" id="manage-scan-outcome">Manage scan outcome</h3>
<p>In the following sections, you specify actions that you want Cloud DLP to
take after it generates the data profiles.</p>
<h4 data-text="Publish to Chronicle" id="chronicle">Publish to Chronicle</h4>
<p><a href="/dlp/docs/metrics-reference">Metrics</a> gathered from data profiles can add
context to your Chronicle findings. The added context can help
you determine the most important security issues to address. For example, if
you're investigating a particular service agent in Chronicle,
data profiles can provide insight into whether that service agent has access
to tables that have high data risk levels.</p>
<p>To send your data profiles to your Chronicle account, turn on
<strong>Publish to Chronicle</strong>.</p>
<p>If Chronicle isn't
enabled for your organization, turning on this option has no effect.


<h4 data-text="Save data profile copies to BigQuery" id="save-to-bq">Save data profile copies to BigQuery</h4>
<p>Turning on <strong>Save data profile copies to BigQuery</strong> lets you keep a saved copy
or history of all of your generated
profiles. Doing so can be useful for creating audit reports and <a href="/dlp/docs/analyze-data-profiles">visualizing
data profiles</a>. You can also
load this information into other systems.</p>
<p>Also, this option lets you see all of your data profiles in a single view,
regardless of which region your data resides in. If you turn off
this option, you can still
<a href="/dlp/docs/view-data-profiles">view the data profiles in your dashboard</a>.
However, in your dashboard, you select one region at a time, and see only the
data profiles for that region.</p>
<aside class="note"><strong>Note:</strong><span> When Cloud DLP fails to profile a table, it periodically
retries. To minimize noise in the exported data, Cloud DLP
exports only the successfully generated profiles to BigQuery.
It skips the tables that it failed to profile.</span></aside>
<p>To export copies of the data profiles to a BigQuery table,
follow these steps:</p>
<ol>
<li><p>Turn on <strong>Save data profile copies to BigQuery</strong>.</p></li>
<li><p>Enter the details of the BigQuery
table where you want to save the data profiles:</p>
<ul>
<li><p>For <strong>Project ID</strong>, enter the ID of an existing project where you want
data profiles to be exported to.</p></li>
<li><p>For <strong>Dataset ID</strong>, enter the name of an existing dataset in the project
where you want data profiles to be exported to.</p></li>
<li><p>For <strong>Table ID</strong>, enter a name for the BigQuery table where
data profiles will be exported to. If you haven't created this table,
Cloud DLP automatically creates it for you using the name
you provide.</p></li>
</ul></li>
</ol>
<p>Cloud DLP starts exporting profiles from the time you turn on
this option. Profiles that were generated before you turned on exporting aren't
saved to BigQuery.</p>
<aside class="special"><strong>Note: </strong>Your service agent must
  have write access on the output table. If you don't have a
  service agent yet, Cloud DLP lets you create one later in the
  <b>Create scan configuration</b> page.</aside>
<h4 data-text="Publish to Pub/Sub" id="publish-pubsub">Publish to Pub/Sub</h4>
<p>Turning on <strong>Publish to Pub/Sub</strong> lets you take programmatic
actions based on profiling results. You can use Pub/Sub
notifications to develop a workflow for catching and remediating findings
with significant data risk or sensitivity.</p>
<p>To send notifications to a Pub/Sub topic, follow these steps:</p>
<ol>
<li><p>Turn on <strong>Publish to Pub/Sub</strong>.</p>
<p>A list of options appears. Each option describes an event that causes
Cloud DLP to send a notification to Pub/Sub.</p></li>
<li><p>Select the events that should trigger a Pub/Sub notification.</p>
<p>If you select <strong>Send a Pub/Sub notification each time a profile is
updated</strong>, Cloud DLP sends a notification when there's
a change in the following
<a href="/dlp/docs/metrics-reference#table-data-profile">table-level metrics</a>:</p>
<ul>
<li>Data risk</li>
<li>Sensitivity</li>
<li>Predicted infoTypes</li>
<li>Other infoTypes</li>
<li>Public</li>
<li>Encryption</li>
</ul></li>
<li><p>For each event you select, follow these steps:</p>
<ol>
<li><p>Enter the name of the topic. The name must be in the following format:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/topics/<var translate="no">TOPIC_ID</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the ID of the project associated with the
Pub/Sub topic.</li>
<li><var translate="no">TOPIC_ID</var>: the ID of the Pub/Sub topic.</li>
</ul></li>
<li><p>Specify whether to include the full table profile in the notification,
or just the full resource name of the table that was profiled.
</p></li>
<li><p>Set the minimum data risk and sensitivity levels that must be met for
Cloud DLP to send a notification.</p></li>
<li><p>Specify whether only one or both of the data risk and sensitivity
conditions must be met. For example, if you choose <code dir="ltr" translate="no">AND</code>, then
both the data risk and the sensitivity conditions must be
met before Cloud DLP sends a notification.</p></li>
</ol></li>
</ol>
<aside class="special"><strong>Note: </strong>Your service agent must have
<a href="/dlp/docs/troubleshoot-data-profiles#grant-publishing-access">
  publishing access</a> on the Pub/Sub topic. If you don't have a
  service agent yet, Cloud DLP lets you create one later in the
  <b>Create scan configuration</b> page.</aside></p>
<h3 data-text="Manage service agent container and billing" id="manage-sa-billing">Manage service agent container and billing</h3>
<p>In this section, you specify the project
to use as a <a href="/dlp/docs/data-profiles#service-agent-container">service agent container</a>.
You can have Cloud DLP automatically create a new project,
or you can choose an existing project.</p>
<ul>
<li><p>If you're creating a scan configuration for the first time, click
<strong>Create a new project as a service agent container</strong>.</p>
<p>Cloud DLP
creates a new project named <strong>DLP Service Agent Container</strong>. This project is
effectively a regular Google Cloud project that contains a new service agent.
Cloud DLP prompts you to
select the account to bill for all billable operations related to
this project, including operations that aren't related to data profiling.</p></li>
<li><p>If you have an existing service agent container that you want to reuse,
click <strong>Select an existing service agent container</strong>. Then, click <strong>Browse</strong>
to select the service agent container's project ID.</p></li>
</ul>
<p>Regardless of whether you're using a newly created service agent or reusing an
existing one, make sure it has read access to the data to be profiled. If you're
<a href="/dlp/docs/create-scan-configuration#manage-scan-outcome">exporting profiles</a>
to BigQuery, make sure it also has write access to the output table.</p>
<h3 data-text="Set location to store configuration" id="set-location">Set location to store configuration</h3>
<p>Click the <strong>Resource location</strong> list, and select the region where you
want to store this scan configuration. All scan configurations that you
later create will also be stored in this location.</p>
<p>Where you choose to store your scan configuration doesn't affect the
data to be scanned. Also, it doesn't affect where the data profiles are
stored. Your data is scanned in the same region where that data is stored
(as set in BigQuery). For more information, see
<a href="/dlp/docs/data-profiles#data-residency">Data residency considerations</a>.</p>
<aside class="note"><strong>Note:</strong><span> If you already have an existing scan configuration, you can't change the value
set in this field. All scan configurations are stored in the same location.
If you want to change the location of all your scan configurations, you must
<a href="/dlp/docs/manage-scan-configurations#delete-config">delete</a> them,
recreate them, and store them in the new location.</span></aside>
<h3 data-text="Review and create" id="review-create">Review and create</h3>
<ol>
<li><p>If you don't want profiling to begin shortly after you create the scan
configuration, select <strong>Create scan in paused mode</strong>.</p>
<p>This option is useful in the following cases:</p>
<ul>
<li>Your Google Cloud admin still needs to
<a href="/dlp/docs/grant-data-profiling-access">grant data profiling access</a>
to the service agent.</li>
<li>You want to create multiple scan configurations and you
want some configurations to <a href="/dlp/docs/data-profiles#overriding-scan-configs">override</a>
others.</li>
<li>You opted to save data profiles to BigQuery, and you want
to make sure the service agent has write access to your output table.</li>
<li>You configured Pub/Sub notifications and you want to grant
<a href="/dlp/docs/troubleshoot-data-profiles#grant-publishing-access">publishing access</a>
to the service agent.</li>
</ul>
</li>
<li><p>Review your settings and click <strong>Create</strong>.</p>
<p>Cloud DLP creates the scan configuration and adds it to the
<strong>Configurations</strong> list.</p></li>
</ol>
<p>To view or manage your scan configurations, go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p>
<p>If your service agent has the roles needed to access and profile your data,
then Cloud DLP starts scanning your data shortly after you create
the scan configuration. Otherwise, Cloud DLP shows an
<a href="/dlp/docs/troubleshoot-data-profiles">error</a>
when you <a href="/dlp/docs/manage-scan-configurations#view-config">view the scan configuration details</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>If you don't have the Organization Administrator
(<code dir="ltr" translate="no">roles/resourcemanager.organizationAdmin</code>) or Security Admin
(<code dir="ltr" translate="no">roles/iam.securityAdmin</code>) role, someone with one of those
roles must
<a href="/dlp/docs/grant-data-profiling-access">grant data profiling access</a> to your
service agent.
</li>
<li>Learn how to <a href="/dlp/docs/view-data-profiles">view the data profiles</a>.</li>
<li>Learn how to <a href="/dlp/docs/manage-scan-configurations">manage scan configurations</a>.</li>
<li>Learn how to <a href="/dlp/docs/troubleshoot-data-profiles">troubleshoot issues with data profiles</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/grant-data-profiling-access]</H1></p><div class="devsite-article-body clearfix">
<p>This page describes how to grant the required role to a service agent so
that it can be used to profile data at the organization or folder level.</p>
<p>Perform these tasks if both of the following conditions apply:</p>
<ul>
<li>You created a scan configuration at the organization or folder level.</li>
<li><p>Cloud DLP isn't generating any data profiles
for the scan configuration. When you <a href="/dlp/docs/manage-scan-configurations#view-config">view
the configuration details</a>,
you see the following error message:</p>
<p>
<pre dir="ltr" translate="no">None of the driver projects (<var translate="no">PROJECT_ID</var>) have <var translate="no">MISSING_PERMISSION</var>
permission for organizations/<var translate="no">ORGANIZATION_ID</var>.</pre></p></li>
</ul>
<h2 data-text="Get the ID of the service agent" id="get-sa-id">Get the ID of the service agent</h2>
<p>Get the service agent ID that is associated with
your scan configuration:</p>
<ol>
<li><p>Go to the data profile configurations list.</p>
<p>
<a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a>
</p></li>
<li>Select your scan configuration.</li>
<li>On the details page that opens, copy the service agent ID. This ID is in
   the format of an email address.</li>
</ol>
<p>Give your service agent ID to a Google Cloud administrator, who must then
<a href="/dlp/docs/grant-data-profiling-access#grant-roles-org">grant data profiling access</a>
to the service agent.</p>
<h2 data-text="Grant data profiling access" id="grant-roles-org">Grant data profiling access</h2>
<p>This section describes how to grant access to a service agent so
that it can be used to profile data at the organization or folder level.</p>
<p>Only someone who has the <a href="/dlp/docs/data-profiles#permissions-to-grant-profiling-access">permissions to
grant IAM roles to a service agent</a>,
such as a Google Cloud administrator, can perform these steps.</p>
<p>To complete these steps, you need the <a href="/dlp/docs/grant-data-profiling-access#get-sa-id">ID of the service agent</a> that you want to grant data profiling access
to.</p>
<p>To grant data profiling access at the organization or folder level,
follow these steps:</p>
<ol>
<li><p>In the Cloud console, go to the <strong>IAM</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-metadata-end-goal="grantIamRole" track-metadata-position="body" track-name="consoleLink" track-type="task">Go
  to IAM</a></p></li>
<li><p>If you're in the project view, switch to the organization view. On the
toolbar, click the <span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span>
project selector, and select your organization.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">person_add</span> <strong>Add</strong>.</p></li>
<li><p>In the <strong>New principals</strong> field, enter the service agent ID.</p></li>
<li><p>Grant the <strong>DLP Organization Data Profiles Driver</strong> role.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/view-data-profiles]</H1></p><div class="devsite-article-body clearfix">
<p>This page describes how to view project data profiles, table data profiles,
and column data profiles in the Google Cloud console.</p>
<p>To respect <a href="/dlp/docs/data-profiles#data-residency">data residency</a>,
Cloud DLP doesn't combine profiles that reside in different
regions. Consequently, in the Cloud console, you can only see data
profiles for the region that you select.</p>
<p>If you want to create or view reports that combine data profiles across regions
in a single view, consider
<a href="/dlp/docs/profile-org-folder#save-to-bq">exporting your data profiles</a>
to BigQuery and using
a <a href="/dlp/docs/analyze-data-profiles">premade report</a> to visualize them in
Data Studio.</p>
<p>For more information on data profiles, see
<a href="/dlp/docs/data-profiles">Data profiles for BigQuery data</a>.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Confirm that you have the IAM permissions that
are required to view
scan configurations and data profiles at the <a href="/dlp/docs/data-profiles#permissions-to-view-configs-profiles-org">organization</a> or <a href="/dlp/docs/data-profiles#permissions-to-view-configs-profiles-project">project</a> level.</p>
<h2 data-text="View the data profiles" id="view_the_data_profiles">View the data profiles</h2>
<p>To view the data profiles in the Cloud console, follow these steps:</p>
<ol>
<li><p>Go to the <strong>Data profiles</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/dataprofiles" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to Data profiles</a> </p></li>
<li><p>Make sure you're viewing the correct organization or project:</p>
<ul>
<li>If you generated the data profiles through an organization-level or
folder-level scan, then view the organization.</li>
<li>If you generated the data profiles using a project-level scan, then
view the proper project.</li>
</ul>
<p>To switch to a different view, on the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector.
Then, select the organization or project that you want to view.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p>
<p>Data profiles generated through a project-level scan only appear in the
project purview and are not combined with the results of organization- or
folder-level scans. Conversely, data profiles generated through an
organization- or folder-level scan only appear in the organization purview.</p></li>
<li><p>In the <strong>Location</strong> list, select the region that contains the data profiles
you want to view. Each data profile is stored in the same region as the
BigQuery data it pertains to.</p></li>
</ol>
<p>The page loads the data profiles. On this page, you can view
data profiles at the <a href="/dlp/docs/view-data-profiles#projects-view">project</a> and
<a href="/dlp/docs/view-data-profiles#tables-view">table</a> levels. When you drill down
to a specific table data profile, you can view the <a href="/dlp/docs/view-data-profiles#columns-view">column-level</a>
data profiles for that table.</p>
<h3 data-text="Projects view" id="projects-view">Projects view</h3>
<p>On the <strong>Projects</strong> tab, each project that has data that was
scanned in your selected region represents one data profile.</p>
<p><figure style="text-align: center">
<a href="/dlp/docs/images/project-data-profiles_2x.png">
<img alt="Screenshot of project data profiles" src="/dlp/docs/images/project-data-profiles.png">
</img></a></figure></p>
<p>Each project data profile is an aggregation of the metrics gathered from
tables that meet both of the following criteria:</p>
<ul>
<li>Tables that belong to that project.</li>
<li>Tables that reside in the currently selected region in the dashboard.</li>
</ul>
<p>Thus, it's possible to have two or more data profiles for the
same projectâone for each region. Those project data profiles
can have different risk and sensitivity levels.</p>
<p>Consider this example: Project A has tables in the <code dir="ltr" translate="no">us-west1</code> and
<code dir="ltr" translate="no">us-west2</code> regions. When viewing your dashboard, you select <code dir="ltr" translate="no">us-west1</code>. For that
view, there is a data profile for Project A. It only includes
metrics gathered from Project A's tables in the <code dir="ltr" translate="no">us-west1</code> region. If you switch
to the <code dir="ltr" translate="no">us-west2</code> region, another data profile for Project A is available. It
only shows data related to Project A's tables in the <code dir="ltr" translate="no">us-west2</code> region.</p>
<p>To learn more about a project's tables, click its project ID. The data
profiles list switches to <strong>Tables</strong> view, filtered for your selected project.</p>
<p>For more information on the metrics gathered in project data profiles, see
<a href="/dlp/docs/metrics-reference#project-data-profile">Project-level data profiles</a>.</p>
<h3 data-text="Tables view" id="tables-view">Tables view</h3>
<p>On the <strong>Tables</strong> tab, each table that was scanned in your
selected region represents one data profile.</p>
<p><figure style="text-align: center">
<a href="/dlp/docs/images/table-data-profiles_2x.png">
<img alt="Screenshot of table data profiles" src="/dlp/docs/images/table-data-profiles.png">
</img></a></figure></p>
<ul>
<li><p>To view the profile details of a particular table, click
<span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>
and then click <strong>View details</strong>.</p></li>
<li><p>To learn more about a table's columns, click its table ID. The page loads
the columns view, which is a list of column data profiles, filtered for your
selected table.</p></li>
<li><p>To go back to the <strong>Tables</strong> tab from the columns view, click <span aria-hidden="true" class="material-icons" translate="no">arrow_back
</span> <strong>Up to Profiles Dashboard</strong>.</p></li>
</ul>
<p>For more information on the metrics gathered in table data profiles, see
<a href="/dlp/docs/metrics-reference#table-data-profile">Table-level data profiles</a>.</p>
<h3 data-text="Columns view" id="columns-view">Columns view</h3>
<p>In the dashboard, when you click a table data profile in the <strong>Tables</strong>
tab, the columns view appears. In this view, each column of a table that
was scanned in your selected region represents one data profile.</p>
<p><figure style="text-align: center">
<a href="/dlp/docs/images/column-data-profiles_2x.png">
<img alt="Screenshot of column data profiles" src="/dlp/docs/images/column-data-profiles.png">
</img></a></figure></p>
<p>To view the profile details of a particular column, click
<span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>
and then click <strong>View details</strong>.</p>
<ul>
<li>To go back to the <strong>Tables</strong> tab from the columns view, click <span aria-hidden="true" class="material-icons" translate="no">arrow_back
</span> <strong>Up to Profiles Dashboard</strong>.</li>
</ul>
<p><aside class="special"><strong>Note:</strong>
If you delete a column from a table and that table is reprofiled, no
<a href="/dlp/docs/metrics-reference#column-data-profile">column data profile</a>
is generated for the deleted column. If you want to keep a
history of past data profilesâfor example, for auditing
purposesâ<a href="/dlp/docs/profile-org-folder#save-to-bq">configure the profiler to export
data profiles to BigQuery</a>.
</aside>
</p>
<p>For more information on the metrics gathered in column data profiles, see
<a href="/dlp/docs/metrics-reference#column-data-profile">Column-level data profiles</a>.</p>
<h2 data-text="Perform a deep inspection on a table" id="create-inspection-job">Perform a deep inspection on a table</h2>
<p>If you want to learn more about a table's contents, you can perform a deep
inspection on that table. To inspect a table, follow these steps:</p>
<ol>
<li><p>Go to the <strong>Data profiles</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/dataprofiles" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to Data profiles</a> </p></li>
<li><p>Find the table data profile or column data profile that you want to inspect.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span>
<strong>Actions</strong>, and then click <strong>Create inspection job</strong>.</p></li>
<li><p>Fill in the details of the inspection job that you
want to perform. For more information on filling in this form, see
<a href="/dlp/docs/inspecting-storage#inspect_a_table">Inspect a BigQuery table</a>.</p></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to <a href="/dlp/docs/manage-scan-configurations">manage scan configurations</a>.</li>
<li>Learn how to <a href="/dlp/docs/analyze-data-profiles">analyze the data profiles</a>.


    

    
      <devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</li></ul></div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/analyze-data-profiles]</H1></p><div class="devsite-article-body clearfix">
<p>If you <a href="/dlp/docs/profile-org-folder">configured the data profiler</a> to
send all successfully generated data profiles to
BigQuery, you can query those data profiles to gain insights about
your BigQuery data. You can also use visualization tools like
Google Data Studio to build custom reports tailored to your business needs.
Alternatively, you can use a premade report that Cloud DLP
provides, tune it, and share it as needed.</p>
<p>This page provides example SQL queries that you can use to learn more about your
BigQuery data. It also shows you how you can visualize data profiles in
in Google Data Studio.</p>
<p>For more information on data profiles, see
<a href="/dlp/docs/data-profiles">Data profiles for BigQuery data</a>.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>This page assumes that you have configured profiling at the
<a href="/dlp/docs/profile-org-folder">organization</a>,
<a href="/dlp/docs/profile-org-folder">folder</a>,
or <a href="/dlp/docs/profile-project">project</a> level. In your configuration, make sure
to turn on data profile exporting by clicking the
<strong>Save data profile copies to BigQuery</strong> toggle.</p>
<p>In this document, the table that contains the exported data
profiles is called the <em>output table</em>.</p>
<p>Make sure you have the project ID, dataset ID, and table ID of the output
table readily available. You need them to perform the procedures on this page.</p>
<h2 data-text="The latest view" id="latest-view">The <code dir="ltr" translate="no">latest</code> view</h2>
<p>When Cloud DLP exports data profiles to your output table, it
also creates the <code dir="ltr" translate="no">latest</code> <a href="/bigquery/docs/views-intro">view</a>. This view is a
prefiltered virtual table that includes only the latest snapshots of your data
profiles. The <code dir="ltr" translate="no">latest</code> view has the same schema as the output table, so you can
use the two interchangeably in your SQL queries and Data Studio
reports. The results can differ because the output table contains older
snapshots of the data profiles.</p>
<p>The <code dir="ltr" translate="no">latest</code> view is stored in the same location as the output table. Its name
has the following format:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no"><var translate="no">OUTPUT_TABLE</var>_latest_<var translate="no">VERSION</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">OUTPUT_TABLE</var>: the ID of the table that contains the exported data
profiles.</li>
<li><var translate="no">VERSION</var>: the version number of the view.</li>
</ul>
<p>For example, if your output table's name is <code dir="ltr" translate="no">table-profile</code>, then the <code dir="ltr" translate="no">latest</code>
view has a name like <code dir="ltr" translate="no">table-profile_latest_v1</code>.</p>
<p><img alt="Latest view" class="screenshot" src="/dlp/docs/images/latest-view.png"/> </p>
<p>When using the <code dir="ltr" translate="no">latest</code> view in SQL queries, use the view's full name, which
includes the project ID, dataset ID, table ID, and suffixâfor example,
<code dir="ltr" translate="no">myproject.mydataset.table-profile_latest_v1</code>.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var>.<var translate="no">DATASET_ID</var>.<var translate="no">OUTPUT_TABLE</var>_latest_<var translate="no">VERSION</var>
</code></pre><aside class="note"><strong>Note:</strong><span> Cloud DLP automatically creates the view. To avoid failures
when loading data into the Data Studio, don't edit or delete
the view.</span></aside>
<h2 data-text="Choose between the output table and the latest view" id="table-or-view">Choose between the output table and the <code dir="ltr" translate="no">latest</code> view</h2>
<p>The <code dir="ltr" translate="no">latest</code> view includes only the latest data profile snapshots, while the
output table has all data profile snapshots, including snapshots that are
outdated. For example, a query on the output table can return multiple
<a href="/dlp/docs/metrics-reference#column-data-profile">column data profiles</a>
for the same columnâone for each time that column was profiled.</p>
<p>When choosing between using the output table and the <code dir="ltr" translate="no">latest</code>
view in your SQL queries or Data Studio reports, consider the
following:</p>
<ul>
<li><p>The <code dir="ltr" translate="no">latest</code> view is useful if you have tables that have been reprofiled and
you only want to see the latest profilesânot their older versions. That
is, you want to see the current state of your BigQuery data.</p></li>
<li><p>The output table is useful if you want to get a historical view of your
BigQuery data. For example, you're
trying to determine whether your organization has ever stored a particular
infoType, or you want to see the changes a particular data profile has
undergone.</p></li>
</ul>
<h2 data-text="Sample SQL queries" id="sample_sql_queries">Sample SQL queries</h2>
<p>This section provides example queries that you can use when analyzing data
profiles. To run these queries, see
<a href="/bigquery/docs/running-queries#queries">Running interactive queries</a>.</p>
<p>In the following examples, replace <var translate="no">TABLE_OR_VIEW</var> with either of the
following:</p>
<ul>
<li>The name of the output table, which is the table that contains the exported
data profilesâfor example, <code dir="ltr" translate="no">myproject.mydataset.table-profile</code>.</li>
<li>The name of the <a href="#latest-view"><code dir="ltr" translate="no">latest</code> view</a> of the output tableâfor
example, <code dir="ltr" translate="no">myproject.mydataset.table-profile_latest_v1</code>.</li>
</ul>
<p>In either case, you must include the project ID and the dataset ID.</p>
<p>For more information, see
<a href="#table-or-view">Choose between the output table and the <code dir="ltr" translate="no">latest</code> view</a> on this
page.</p>
<p>To troubleshoot any errors you encounter, see
<a href="/bigquery/docs/error-messages">Error messages</a>.</p>
<h3 data-text="List all columns that have a high free-text score and evidence of other infoType matches" id="list_all_columns_that_have_a_high_free-text_score_and_evidence_of_other_infotype_matches">List all columns that have a high free-text score and evidence of other infoType matches</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">SELECT
  column_profile.table_full_resource,
  column_profile.COLUMN,
  other_matches.info_type.name,
  column_profile.profile_last_generated
FROM
   `<var translate="no">TABLE_OR_VIEW</var>`,
  UNNEST(column_profile.other_matches) AS other_matches
WHERE
  column_profile.free_text_score = 1
  AND ( column_profile.column_info_type.info_type.name&gt;""
    OR ARRAY_LENGTH(column_profile.other_matches)&gt;0 )
</code></pre>
<p>For information on how to remediate these findings, see
<a href="/dlp/docs/data-profiles-remediation#high-free-text-score">High free-text score</a>.</p>
<p>For more information about the <strong>Free text score</strong> and <strong>Other infoTypes</strong>
metrics,
see <a href="/dlp/docs/metrics-reference#column-data-profile">Column data profiles</a>.</p>
<h3 data-text="List all tables that contain a column of credit card numbers" id="list_all_tables_that_contain_a_column_of_credit_card_numbers">List all tables that contain a column of credit card numbers</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">SELECT
  column_profile.table_full_resource,
  column_profile.profile_last_generated
FROM
  `<var translate="no">TABLE_OR_VIEW</var>`
WHERE
  column_profile.column_info_type.info_type.name="CREDIT_CARD_NUMBER"
</code></pre>
<p><code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code> is a <a href="/dlp/docs/infotypes-reference">built-in infoType</a>
that represents a credit card number.</p>
<p>For information on how to remediate these findings, see
<a href="/dlp/docs/data-profiles-remediation#high-data-risk">High data risk</a>.</p>
<h3 data-text="List table profiles that contain columns of credit card numbers, US Social Security numbers, and person names" id="list_table_profiles_that_contain_columns_of_credit_card_numbers_us_social_security_numbers_and_person_names">List table profiles that contain columns of credit card numbers, US Social Security numbers, and person names</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">SELECT
  table_full_resource,
  COUNT(*) AS count_findings
FROM (
  SELECT
    DISTINCT column_profile.table_full_resource,
    column_profile.column_info_type.info_type.name
  FROM
    `<var translate="no">TABLE_OR_VIEW</var>`
  WHERE
    column_profile.column_info_type.info_type.name IN ('PERSON_NAME',
      'CREDIT_CARD_NUMBER',
      'US_SOCIAL_SECURITY_NUMBER')
  ORDER BY
    column_profile.table_full_resource ) ot1
GROUP BY
  table_full_resource
  #increase this number to match the total distinct infoTypes that must be present
HAVING
  count_findings&gt;=3
</code></pre>
<p>This query uses the following <a href="/dlp/docs/infotypes-reference">built-in infoTypes</a>:</p>
<ul>
<li><code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code>: represents a credit card number</li>
<li><code dir="ltr" translate="no">PERSON_NAME</code>: represents the full name of a person</li>
<li><code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> represents a US Social Security number</li>
</ul>
<p>For information on how to remediate these findings, see
<a href="/dlp/docs/data-profiles-remediation#high-data-risk">High data risk</a>.</p>
<h2 data-text="Work with data profiles in Data Studio" id="premade-report">Work with data profiles in Data Studio</h2>
<p>To visualize your data profiles in Data Studio, you can use
a premade report, or you <a href="#create-report">can create your own</a>.</p>
<h3 data-text="Use a premade report" id="use_a_premade_report">Use a premade report</h3>
<p>Cloud DLP provides a premade Data Studio report
that highlights the rich insights of data profiles. The
<strong>Automatic Data Profiler Dashboard</strong> is a multi-page report that
gives you a quick high-level view of your data profiles, including breakdowns
by risk, by infoType, and by location. To drill down to specific metrics,
explore the other tabs. You can use this premade report as is, or you can
customize it as needed.</p>
<p>To view the premade report with your data, enter the required values in the
following URL. Then, copy the resulting URL to your browser.</p>
<pre class="wrap-code devsite-click-to-copy" dir="ltr" translate="no">
https://datastudio.google.com/c/u/0/reporting/create?c.reportId=907a2b73-ffe4-40b2-b9a1-c2aa0bbd69fd&amp;ds.connector=BIG_QUERY&amp;ds.projectId=<var translate="no">PROJECT_ID</var>&amp;ds.datasetId=<var translate="no">DATASET_ID</var>&amp;ds.tableId=<var translate="no">TABLE_OR_VIEW</var>&amp;ds.type=TABLE&amp;ds.useFreshSchema=false
</pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: the project that contains the output table.</li>
<li><var translate="no">DATASET_ID</var>: the dataset that contains the output table.</li>
<li><p><var translate="no">TABLE_OR_VIEW</var>: either of the following:</p>
<ul>
<li>The name of the output table, which is the table that contains the exported
data profilesâfor example,<code dir="ltr" translate="no">myproject.mydataset.table-profile</code>.</li>
<li>The name of the <a href="#latest-view"><code dir="ltr" translate="no">latest</code> view</a> of the output tableâfor
example, <code dir="ltr" translate="no">myproject.mydataset.table-profile_latest_v1</code>.</li>
</ul>
<p>For more information, see
<a href="#table-or-view">Choose between the output table and the <code dir="ltr" translate="no">latest</code> view</a> on
this page.</p></li>
</ul>
<p>It can take a few minutes for Data Studio to load the report
with your data.</p>
<p><img alt="Premade report" class="screenshot" src="/dlp/docs/images/premade-report.png"/> </p>
<h3 data-text="Create a report" id="create-report">Create a report</h3>
<p><a href="https://datastudio.google.com/overview">Data Studio</a> lets you
create interactive reports. In this section, you create a simple
table report in Data Studio that is based on the data profiles
exported to your output table in BigQuery.</p>
<p>Make sure you have the
project ID, dataset ID, and table ID of the output table or the
<a href="#latest-view"><code dir="ltr" translate="no">latest</code> view</a> readily available. You need them to perform this
procedure.</p>
<p>This example shows you how to create a report containing a table that shows each
<a href="/dlp/docs/infotypes-reference">infoType</a> reported in your data profiles and its
corresponding frequency.</p>
<p>In general, you incur <a href="/bigquery/pricing">BigQuery usage costs</a>
when accessing BigQuery through Data Studio.
For more information, see
<a href="/bigquery/docs/visualize-data-studio">Visualizing BigQuery data using Data Studio</a>.</p>
<p>To create a report, do the following:</p>
<ol>
<li>Open
 <a class="external" href="https://datastudio.google.com/">Data Studio</a> 
 and log in.</li>
<li>Click <strong>Blank Report</strong>.</li>
<li>On the <strong>Connect to data</strong> tab, click the <strong>BigQuery</strong>
 card.</li>
<li>If prompted, authorize Data Studio to access your
 BigQuery projects.</li>
<li><p>Connect to your BigQuery data:</p>
<ol>
<li>For <strong>Project</strong>, select the project that contains the output table. You
can search for the project in the <strong>Recent projects</strong>, <strong>My projects</strong>,
and <strong>Shared projects</strong> tabs.</li>
<li>For <strong>Dataset</strong>, select the dataset that contains the output table.</li>
<li><p>For <strong>Table</strong>, select either the output table or the
<a href="#latest-view"><code dir="ltr" translate="no">latest</code> view</a> of the output table.</p>
<p>For more information, see
<a href="#table-or-view">Choose between the output table and the <code dir="ltr" translate="no">latest</code> view</a>
on this page.</p></li>
<li><p>Click <strong>Add</strong>.</p></li>
<li><p>In the dialog that appears, click <strong>Add to report</strong>.</p>
<p>A report is created. A table appears containing <a href="/dlp/docs/metrics-reference#table-data-profile">table data profiles</a> and their corresponding
record counts.</p></li>
</ol></li>
<li><p>To add a table that shows each infoType reported and its
 corresponding frequency (record count), follow these steps:</p>
<ol>
<li>Click <strong>Add a chart</strong>.</li>
<li>Select a table style.</li>
<li><p>Click the area where you want to position the chart.</p>
<p>The chart appears in table format.</p></li>
<li><p>Resize the table as needed.</p>
<p>As long as the table is selected, its properties appear in the
<strong>Chart &gt; Table</strong> pane.</p></li>
<li><p>In the <strong>Chart &gt; Table</strong> pane, in the <strong>Data</strong> tab, in the
<strong>Dimension</strong> field, remove the existing dimension.</p></li>
<li><p>Click <strong>Add dimension</strong>.</p></li>
<li><p>Search for <code dir="ltr" translate="no">column_profile.column_info_type.info_type.name</code>, and then
select it.</p></li>
</ol>
<p>The resulting table looks similar to the following:</p>
<p><img alt="A table showing the infoTypes detected and their corresponding
frequencies" class="screenshot" src="/dlp/docs/images/infotype-frequency.png"/> </p></li>
</ol>
<p>Learn more about <a class="external" href="https://support.google.com/datastudio/answer/7189044#zippy=%2Cin-this-article">tables in Data Studio</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<p>Learn about actions you can take to
<a href="/dlp/docs/data-profiles-remediation">remediate</a> data profile findings.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/data-profiles-remediation]</H1></p><div class="devsite-article-body clearfix">
<p>This page describes the steps you can take to remediate <a href="/dlp/docs/sensitivity-risk-calculation">findings</a> from data profiles.</p>
<h2 data-text="High data risk" id="high-data-risk">High data risk</h2>
<p>Columns or tables with high data risk have evidence of sensitive information
without additional protections. To lower the data risk score, consider doing the
following:</p>
<ul>
<li><p>For columns that contain sensitive data, apply a
<a href="/bigquery/docs/best-practices-policy-tags">BigQuery policy tag</a>
to restrict access to accounts with specific access rights.</p>
<p>Before you make this change, make sure your service agent has the permissions
required to profile tables with column-level restrictions. Otherwise,
Cloud DLP shows an error. For more information, see
<a href="/dlp/docs/troubleshoot-data-profiles#policy-tags">Troubleshoot issues with the data profiler</a>.</p></li>
<li><p>De-identify the raw sensitive data using de-identification techniques like
<a href="/dlp/docs/deidentify-sensitive-data#charactermaskconfig">masking</a> and <a href="/dlp/docs/pseudonymization">tokenization</a>.</p></li>
<li><p>If the high-risk data is not needed, consider removing the sensitive columns.</p>
<p><aside class="special"><strong>Note:</strong>
If you delete a column from a table and that table is reprofiled, no
<a href="/dlp/docs/metrics-reference#column-data-profile">column data profile</a>
is generated for the deleted column. If you want to keep a
history of past data profilesâfor example, for auditing
purposesâ<a href="/dlp/docs/profile-org-folder#save-to-bq">configure the profiler to export
data profiles to BigQuery</a>.
</aside>
</p></li>
</ul>
<h2 data-text="High free-text score" id="high-free-text-score">High free-text score</h2>
<p>A column with a high <a href="/dlp/docs/metrics-reference#free-text-score">free-text score</a>,
especially one that has evidence of multiple infoTypes (like
<code dir="ltr" translate="no">PHONE_NUMBER</code>, <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code>, and <code dir="ltr" translate="no">DATE_OF_BIRTH</code>), might contain
unstructured data and instances of personally identifiable
information (PII). This column can be a note or comment field. Freeform text
presents a potential risk. For example, in such fields, someone might enter
"Customer was born on January 1, 1985".</p>
<p>Cloud DLP is built to handle unstructured data. To
better understand this kind of data, consider doing the following:</p>
<ul>
<li><p>To identify the rows or cells where PII might exist, run an
<a href="/dlp/docs/inspecting-storage#inspect_a_table">on-demand inspection</a> on the BigQuery table.</p></li>
<li><p>De-identify the raw sensitive data using techniques like <a href="/dlp/docs/deidentify-sensitive-data#charactermaskconfig">masking</a>
and <a href="/dlp/docs/pseudonymization">tokenization</a>.</p></li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><p>Learn about how Cloud DLP <a href="/dlp/docs/sensitivity-risk-calculation">calculates the data risk and
sensitivity levels of your tables and columns</a>.</p></li>
<li><p>Learn about how <a href="https://cloud.google.com/blog/products/identity-security/take-charge-of-your-data-how-tokenization-makes-data-usable-without-sacrificing-privacy">tokenization makes data usable without sacrificing privacy</a>.</p></li>
<li><p>Learn about how
<a href="https://cloud.google.com/blog/products/identity-security/google-a-leader-in-unstructured-data-security-platforms">Forrester named Google Cloud a leader in unstructured data security platforms</a>.</p></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/manage-scan-configurations]</H1></p><div class="devsite-article-body clearfix">
<p>This page describes how to view, pause, resume, edit, and delete an existing
<a href="/dlp/docs/data-profiles#scan-configuration">scan configuration</a>.
For information on how to create a scan configuration,
see <a href="/dlp/docs/profile-project">Profile data in a project</a> or
<a href="/dlp/docs/profile-org-folder">Profile data in an organization or folder</a>.</p>
<h2 data-text="View a scan configuration" id="view-config">View a scan configuration</h2>
<ol>
<li><p>Go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p></li>
<li><p>Make sure you're viewing the correct organization or project:</p>
<ul>
<li>To manage scan configurations that you created at the organization or
folder level, view the organization.</li>
<li>To manage scan configurations that you created at the project level,
view the proper project.</li>
</ul>
<p>To switch to a different view, on the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector.
Then, select the organization or project that you want to view.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
<li><p>To open the <strong>Scan configuration details</strong> page, click the name of the
resource associated with the scan configuration.</p></li>
</ol>
<h2 data-text="Pause a scan configuration" id="pause-config">Pause a scan configuration</h2>
<ol>
<li><p>Go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p></li>
<li><p>Make sure you're viewing the correct organization or project:</p>
<ul>
<li>To manage scan configurations that you created at the organization or
folder level, view the organization.</li>
<li>To manage scan configurations that you created at the project level,
view the proper project.</li>
</ul>
<p>To switch to a different view, on the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector.
Then, select the organization or project that you want to view.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>,
and then click <strong>Pause scan</strong>.</p>
<p>As long as a scan configuration is paused, Cloud DLP doesn't
generate any new profiles under that configuration.</p></li>
</ol>
<h2 data-text="Resume a scan configuration" id="resume-config">Resume a scan configuration</h2>
<ol>
<li><p>Go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p></li>
<li><p>Make sure you're viewing the correct organization or project:</p>
<ul>
<li>To manage scan configurations that you created at the organization or
folder level, view the organization.</li>
<li>To manage scan configurations that you created at the project level,
view the proper project.</li>
</ul>
<p>To switch to a different view, on the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector.
Then, select the organization or project that you want to view.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>,
and then click <strong>Resume scan</strong>.</p></li>
</ol>
<h2 data-text="Edit a scan configuration" id="edit-config">Edit a scan configuration</h2>
<p>If you edit a scan configuration that has already been used to profile
tables, you might end up having different tables scanned according to
different configurations.</p>
<p>By default, Cloud DLP doesn't reprofile tables that have not
undergone schema changes since they were last profiled. If you want
Cloud DLP to reprofile existing tables, make a request by
<a href="/dlp/docs/data-profiles#getting-support">contacting Support</a>.</p>
<p>To edit a scan configuration, follow these steps:</p>
<ol>
<li><p>Go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p></li>
<li><p>Make sure you're viewing the correct organization or project:</p>
<ul>
<li>To manage scan configurations that you created at the organization or
folder level, view the organization.</li>
<li>To manage scan configurations that you created at the project level,
view the proper project.</li>
</ul>
<p>To switch to a different view, on the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector.
Then, select the organization or project that you want to view.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>,
and then click <strong>Edit</strong>.</p></li>
<li><p>Edit the configuration as needed. For more information about the options on
this page, see <a href="/dlp/docs/profile-project">Profile data in a project</a>
or <a href="/dlp/docs/profile-org-folder">Profile data in an organization or folder</a>.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol>
<h2 data-text="Delete a scan configuration" id="delete-config">Delete a scan configuration</h2>
<p>Deleting a scan configuration doesn't delete the data profiles that have
been generated through it. In addition, deleting a scan configuration and
creating a new one doesn't cause a reprofile operation on tables that are in the
scope of the new scan configuration. If you want
Cloud DLP to reprofile existing tables, you can
<a href="/dlp/docs/data-profiles#getting-support">send a request</a>.</p>
<p>For information on how long Cloud DLP
retains data profiles, see
<a href="/dlp/docs/data-profiles#retention">Retention of data profiles</a>.</p>
<p>To delete a scan configuration, follow these steps:</p>
<ol>
<li><p>Go to the data profile configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/dataProfiles/configurations" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to data profile configurations</a> </p></li>
<li><p>Make sure you're viewing the correct organization or project:</p>
<ul>
<li>To manage scan configurations that you created at the organization or
folder level, view the organization.</li>
<li>To manage scan configurations that you created at the project level,
view the proper project.</li>
</ul>
<p>To switch to a different view, on the toolbar, click the
<span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span> project selector.
Then, select the organization or project that you want to view.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>,
and then click <strong>Delete</strong>.</p></li>
<li><p>To confirm the deletion, in the dialog that appears, click <strong>Delete</strong>.</p></li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/dlp/docs/data-profiles">data profiles</a>.</li>
<li>Learn how to <a href="/dlp/docs/profile-project">profile data in a project</a>.</li>
<li>Learn how to <a href="/dlp/docs/profile-org-folder">profile data in an organization or folder</a>.</li>
<li>Learn how to <a href="/dlp/docs/troubleshoot-data-profiles">troubleshoot issues with data profiles</a>.</li>
<li>Refer to a list of <a href="/dlp/docs/metrics-reference">metrics</a> included in data profiles.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/troubleshoot-data-profiles]</H1></p><div class="devsite-article-body clearfix">
<p>This page shows you how to resolve issues with the data profiler
of Cloud Data Loss Prevention.</p>
<h2 data-text="Permissions" id="permissions">Permissions</h2>
<p>This section lists access issues that you might encounter, and provides
suggestions for how to fix each of them.</p>
<h3 data-text="The service agent doesn't have permission to read an access-controlled column" id="policy-tags">The service agent doesn't have permission to read an access-controlled column</h3>
<p>This issue occurs when profiling a table that enforces column-level security
through policy tags. If the service agent doesn't have permission to access
the restricted column, Cloud DLP shows the following error:</p>
<pre dir="ltr" translate="no">
Permission denied for DLP API service account '<var translate="no">SERVICE_AGENT_ID</var>'
while accessing a BigQuery table. Access Denied: BigQuery BigQuery: User does
not have permission to access policy tag "<var translate="no">POLICY_TAG_ID</var>" on column <var translate="no">FIELD_NAME</var>.
</pre>
<p>To resolve this issue, on the Identity and Access Management (IAM) page, grant
your service agent the <strong><a href="/bigquery/docs/column-level-security#fine_grained_reader">Fine-Grained Reader</a></strong> role.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="console" track-metadata-end-goal="viewIamRoles" track-metadata-position="body" track-name="consoleLink" track-type="task">Go
  to IAM</a></p>
<p><p>Cloud DLP periodically retries profiling tables
that it failed to profile.</p>
</p>
<p>For more information on granting a role, see
<a href="/iam/docs/granting-changing-revoking-access#grant-single-role">Grant a single role</a>.</p>
<h3 data-text="The service agent doesn't have data profiling access" id="data-profiling-access">The service agent doesn't have data profiling access</h3>
<p>This issue occurs after someone in your organization creates an organization- or
folder-level scan configuration. When you <a href="/dlp/docs/manage-scan-configurations#view-config">view the scan configuration details</a>, you see that the
value for <strong>Scan status</strong> is <strong>Active with errors</strong>. When you view the error,
Cloud DLP shows the following error message:</p>
<p>
<pre dir="ltr" translate="no">None of the driver projects (<var translate="no">PROJECT_ID</var>) have <var translate="no">MISSING_PERMISSION</var>
permission for organizations/<var translate="no">ORGANIZATION_ID</var>.</pre></p>
<p>This error occurred because Cloud DLP couldn't automatically grant
the <strong>DLP Organization Data Profiles Driver</strong> role to your service agent while it
was creating your scan configuration. The creator of the scan configuration
doesn't have <a href="/dlp/docs/data-profiles#permissions-to-grant-profiling-access">permissions to grant data profiling access</a>, and so
Cloud DLP was unable to do it on their behalf.</p>
<p>To resolve this issue, see  <a href="/dlp/docs/grant-data-profiling-access">Grant data profiling access to a service agent</a>.</p>
<h3 data-text="The service account doesn't have permission to query a table" id="query-table">The service account doesn't have permission to query a table</h3>
<p>This issue occurs when Cloud DLP attempts to profile a table that
the service agent doesn't have
permission to query. Cloud DLP shows the following error:</p>
<pre dir="ltr" translate="no">
Permission denied error: Permission denied for DLP API service account '<var translate="no">SERVICE_AGENT_ID</var>'
while accessing BigQuery table. Access Denied: Table <var translate="no">TABLE</var>: User does not have
permission to query table <var translate="no">TABLE</var>. Permission denied for DLP API service account
'<var translate="no">SERVICE_AGENT_ID</var>' while accessing BigQuery table. Access Denied: Table <var translate="no">TABLE</var>:
User does not have permission to query <var translate="no">TABLE</var>. [<var translate="no">TIMESTAMP</var>]
</pre>
<p>To resolve this issue, follow these steps:</p>
<ol>
<li><p>Confirm that the table still exists. If the table exists, perform the
next steps.</p></li>
<li><p>Activate <a href="/shell/docs">Cloud Shell</a>.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/bigquery?cloudshell=true" target="console">Activate Cloud Shell</a> </p>
<p>If you're prompted to authorize Cloud Shell, click <strong>Authorize</strong>.</p>
<p>Alternatively, if you want to use the <code dir="ltr" translate="no">bq</code> command-line tool from the
Google Cloud CLI, <a href="/sdk/docs/install">install and initialize the Google Cloud CLI</a>.</p></li>
<li><p>Get the current IAM policy for the table, and print it to <code dir="ltr" translate="no">stdout</code>:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">bq get-iam-policy <var translate="no">TABLE</var>
</code></pre>
<p>Replace <var translate="no">TABLE</var> with the full resource name of the BigQuery
table, in the format <var translate="no">PROJECT_ID</var>:<var translate="no">DATASET_ID</var>.<var translate="no">TABLE_ID</var>âfor
example, <code dir="ltr" translate="no">project-id:dataset-id.table-id</code>.</p></li>
<li><p>Grant the <strong>DLP API Service Agent</strong> (<code dir="ltr" translate="no">roles/dlp.serviceAgent</code>) role to the
service agent:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">bq add-iam-policy-binding --member=serviceAccount:<var translate="no">SERVICE_AGENT_ID</var> \
    --role=roles/dlp.serviceAgent <var translate="no">TABLE</var>
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">SERVICE_AGENT_ID</var>: the ID of the service agent that needs to query
the tableâfor example, <code dir="ltr" translate="no">service-0123456789@dlp-api.iam.gserviceaccount.com</code>.</li>
<li><p><var translate="no">TABLE</var>: the full resource name of the BigQuery
table, in the format <var translate="no">PROJECT_ID</var>:<var translate="no">DATASET_ID</var>.<var translate="no">TABLE_ID</var>âfor
example, <code dir="ltr" translate="no">project-id:dataset-id.table-id</code>.</p>
<p>The output is similar to the following:</p></li>
</ul>
<pre dir="ltr" translate="no">
Successfully added member '<var translate="no">SERVICE_AGENT_ID</var>' to role 'roles/dlp.serviceAgent' in IAM policy for table '<var translate="no">TABLE</var>':

{
 "bindings": [
   {
     "members": [
       "serviceAccount:<var translate="no">SERVICE_AGENT_ID</var>"
     ],
     "role": "roles/dlp.serviceAgent"
   }
 ],
 "etag": "BwXNAPbVq+A=",
 "version": 1
}
</pre>
<p><p>Cloud DLP periodically retries profiling tables
that it failed to profile.</p>
</p></li>
</ol>
<h3 data-text="The service account doesn't have permission to publish to a Pub/Sub topic" id="grant-publishing-access">The service account doesn't have permission to publish to a Pub/Sub topic</h3>
<p>This issue occurs when Cloud DLP attempts to publish notifications
to a Pub/Sub topic where the service agent has no publishing access.
Cloud DLP shows the following error:</p>
<pre dir="ltr" translate="no">
Permission missing to publish notifications on Cloud Pub/Sub topic '<var translate="no">TOPIC_NAME</var>'.
The DLP API service account '<var translate="no">SERVICE_AGENT_ID</var>' must must have at least the Pub/Sub Publisher role.
</pre>
<p>To resolve this issue, <a href="/pubsub/docs/access-control#console">grant publishing access</a>,
at a project or topic level, to your service agent. An example of a role that
has publishing access is the <strong>Pub/Sub Publisher</strong> role.</p>
<h2 data-text="Inspection templates" id="inspection_templates">Inspection templates</h2>
<p>This section lists issues that you might encounter with inspection templates,
and provides suggestions for how to fix each of them.</p>
<h3 data-text="The inspection template can't be used to profile data in a different region" id="the_inspection_template_cant_be_used_to_profile_data_in_a_different_region">The inspection template can't be used to profile data in a different region</h3>
<p>This issue occurs when Cloud DLP attempts to profile data that
doesn't reside in the same region where the inspection template resides.
Cloud DLP shows the following error:</p>
<pre dir="ltr" translate="no">
Data in region <var translate="no">DATA_REGION</var> cannot be profiled using template in region
<var translate="no">TEMPLATE_REGION</var>. Regional template can only be used to profile data
in the same region. If profiling data in multiple regions, use a global template.
</pre>
<p>In this error message, <var translate="no">DATA_REGION</var> is the region where the data
resides, and <var translate="no">TEMPLATE_REGION</var> is the region where the inspection
template resides.</p>
<p>To resolve this issue, you can copy the region-specific template to the <code dir="ltr" translate="no">global</code>
region:</p>
<ol>
<li><p><a href="/dlp/docs/creating-templates-inspect#copy-to-global">Copy the inspection template to the <code dir="ltr" translate="no">global</code> region</a>.</p></li>
<li><p>On the <strong>Inspection template details</strong> page, copy the full resource name of
the template. The full resource name follows this format:</p>
<pre dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">REGION</var>/inspectTemplates/<var translate="no">TEMPLATE_ID</var></pre></li>
<li><p><a href="/dlp/docs/manage-scan-configurations#edit-config">Edit the scan configuration</a>
and enter the full resource name of the new inspection template.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
</ol>
<p><p>Cloud DLP periodically retries profiling tables
that it failed to profile.</p>
</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspecting-storage]</H1></p><div class="devsite-article-body clearfix">
<p>Properly managing sensitive data that is stored in a storage repository starts
with <a href="/dlp/docs/classification-redaction#storage_classification">storage classification</a>:
identifying where your sensitive data is in the repository, what type of
sensitive data it is, and how it's being used. This knowledge can help you
properly set access control and sharing permissions, and it can be part of an
ongoing monitoring plan.</p>
<p>Cloud Data Loss Prevention can detect and classify sensitive data stored in a
<a href="/storage">Cloud Storage</a> location, <a href="/datastore">Datastore</a> kind, or
<a href="/bigquery">BigQuery</a> table. When scanning files in Cloud Storage
locations, Cloud DLP supports scanning of binary, text, image,
Microsoft Word, Microsoft Excel, Microsoft Powerpoint, PDF, and Apache Avro
files. A list of file extensions for the file types within Cloud Storage
that Cloud DLP can scan is available on the API reference page for
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#filetype"><code dir="ltr" translate="no">FileType</code></a>.
Files of types that are unrecognized are scanned as binary files.</p>
<p>To inspect storage and databases for sensitive data, you specify the location
of the data and the type of sensitive data that Cloud DLP should
look for. Cloud DLP initiates a job that inspects the data at the
given location, and then it makes available details about
<a href="/dlp/docs/concepts-infotypes">infoTypes</a> found in the content, <a href="/dlp/docs/likelihood">likelihood</a>
values, and more.</p>
<p>You can set up inspection of storage and databases using Cloud DLP
in the Cloud console, via the RESTful DLP API, or
programmatically using a <a href="/dlp/docs/libraries">Cloud DLP client library</a>
in one of several languages.</p>
<p>This topic includes:</p>
<ul>
<li>Best practices for setting up scans of Google Cloud storage repositories and
databases.</li>
<li>Instructions for setting up an inspection scan using Cloud DLP
in the Cloud console, and (optionally) for scheduling periodic
repeating inspection scans.</li>
<li>Example JSON for each Google Cloud storage repository type
(Cloud Storage, Datastore, and
BigQuery), and code samples in several programming
languages.</li>
<li>A detailed overview of the configuration options for scan jobs.</li>
<li>Instructions for how to retrieve scan results and how to manage the scan
jobs that are created from each successful request.</li>
</ul>
<h2 data-text="Best practices" id="best_practices">Best practices</h2>
<h3 data-text="Identify and prioritize scanning" id="identify_and_prioritize_scanning">Identify and prioritize scanning</h3>
<p>It's important to first evaluate your assets and specify which have the highest
priority for scanning. When just getting started you may have a large backlog of
data that needs classification, and it will be impossible to scan it all
immediately. Choose data initially that poses the highest potential
riskâfor example, data that is frequently accessed, widely accessible, or
unknown.</p>
<h3 data-text="Ensure that Cloud DLP can access your data" id="ensure_that_can_access_your_data">Ensure that Cloud DLP can access your data</h3>
<p>Cloud DLP must be able to access data to be scanned. Be sure that
the Cloud DLP <a href="/dlp/docs/iam-permissions#service_account">service account</a> is
permitted to read your resources.</p>
<h3 data-text="Limit the scope of your first scans" id="limit_the_scope_of_your_first_scans">Limit the scope of your first scans</h3>
<p>For best results, limit the scope of your first jobs instead of scanning all of
your data. Start with one table, one bucket, or a few files and use
<a href="#sampling">sampling</a>. By limiting the scope of your first scans, you can better
determine what detectors to enable and what <a href="/dlp/docs/creating-custom-infotypes-rules#exclusion-rules">exclusion
rules</a> might be needed to
reduce false positives so that your findings will be more meaningful. Avoid
turning on all infoTypes if you don't need them all, as false positives or
unusable findings may make it harder to assess your risk. While useful in
certain scenarios, infoTypes such as <code dir="ltr" translate="no">DATE</code>, <code dir="ltr" translate="no">TIME</code>, <code dir="ltr" translate="no">DOMAIN_NAME</code>, and <code dir="ltr" translate="no">URL</code>
match on a broad range of findings and may not be useful to turn on for large
data scans.</p>
<h3 data-text="Schedule your scans" id="schedule_your_scans">Schedule your scans</h3>
<p>Use Cloud DLP <a href="/dlp/docs/creating-job-triggers">job triggers</a> to
automatically run scans and generate findings daily, weekly, or quarterly.
These scans can also be configured to only inspect data that has changed since
the last scan, which can save time and reduce costs. Running scans on a regular
basis can help you identify trends or anomalies in your scan results.</p>
<h3 data-text="Reduce latency" id="reduce_latency">Reduce latency</h3>
<p>Latency is affected by several factors: the amount of data to scan, the storage
repository being scanned, and the type and number of infoTypes that are enabled.</p>
<p>To help reduce job latency, you can try the following:</p>
<ul>
<li>Enable <a href="/dlp/docs/inspecting-storage#sampling">sampling</a>.</li>
<li>Avoid enabling infoTypes you don't need. While useful in
certain scenarios, some infoTypesâincluding <code dir="ltr" translate="no">PERSON_NAME</code>,
<code dir="ltr" translate="no">FEMALE_NAME</code>, <code dir="ltr" translate="no">MALE_NAME</code>, <code dir="ltr" translate="no">FIRST_NAME</code>, <code dir="ltr" translate="no">LAST_NAME</code>,
<code dir="ltr" translate="no">DATE_OF_BIRTH</code>, <code dir="ltr" translate="no">LOCATION</code>, <code dir="ltr" translate="no">STREET_ADDRESS</code>,
<code dir="ltr" translate="no">ORGANIZATION_NAME</code>âcan make requests run much more
slowly than requests that do not include them.</li>
<li>Always specify infoTypes explicitly. Do not use an empty infoTypes list.</li>
</ul>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>The instructions provided in this topic assume the following:</p>
<ul>
<li><p>You have enabled billing.</p>
<p><a class="button button-primary" href="/billing/docs/how-to/modify-project" target="console">Learn how to enable billing</a> </p></li>
<li><p>You have enabled Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console">Enable
Cloud DLP</a> </p></li>
</ul>
<p>Storage classification requires the following OAuth scope:
<code dir="ltr" translate="no">https://www.googleapis.com/auth/cloud-platform</code>. For more information, see
<a href="/dlp/docs/auth">Authenticating to the DLP API</a>.</p>
<h2 data-text="Inspect a Cloud Storage location" id="inspecting-gcs">Inspect a Cloud Storage location</h2>
<p>You can set up a Cloud DLP inspection of a Cloud Storage
location using the Google Cloud console, the DLP API via
<a href="/dlp/docs/reference/rest">REST</a> or <a href="/dlp/docs/reference/rpc">RPC</a> requests, or programmatically
in several languages using a <a href="/dlp/docs/libraries">client library</a>. For information about
the parameters included with the following JSON and code samples, see
"<a href="#configuring-storage-inspection">Configure storage inspection</a>," later in this
topic.</p>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<p><aside class="special"><strong>Note:</strong>
  Cloud DLP will only scan the version of the file that was present when
  the job was started. If <a href="/storage/docs/object-versioning">Cloud Storage
  versioning</a> is disabled and a file is modified after a job is started but before the job is
  completed, that file will be skipped. Otherwise, Cloud DLP will scan an older version
  of the file. To enable versioning for your Cloud Storage objects, see the
  <a href="/storage/docs/using-object-versioning">Cloud Storage documentation</a>.
  </aside>
</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<p>To set up a scan job of a Cloud Storage bucket using
Cloud DLP:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-storage-code-sample">
<section>
<h3 data-text="Console" id="dlp-inspect-storage-console" track-metadata-position="dlp-inspect-storage" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, point to <strong>Job or job trigger</strong>, and then click
 <strong>Inspection</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p>
<aside class="note"><strong>Note:</strong><span> You can also initiate a Cloud DLP scan directly from
the <a href="https://console.cloud.google.com/storage/browser">Cloud Storage browser</a>. In the
right-most column for the bucket you want to scan, click the
<b>more actions</b> menu (displayed as three dots arranged vertically) <img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>,
and then click <strong>Scan with Cloud Data Loss Prevention</strong>. The Cloud DLP job
creation page opens in a separate tab.</span></aside></li>
<li><p>Enter the Cloud DLP job information and click <strong>Continue</strong> to
 complete each step:</p>
<ul>
<li><p>For <strong>Step 1: Choose input data</strong>, name the job by entering a value in
the <strong>Name</strong> field. In <strong>Location</strong>, choose Cloud Storage from the
<strong>Storage type</strong> menu, and then enter the location of the data to scan.
The <strong>Sampling</strong> section is pre-configured to run a sample scan against
your data. You can adjust the <strong>Percentage of objects scanned within
bucket</strong> field to save resources if you have a large amount of data. For
more details, see <a href="/dlp/docs/creating-job-triggers#choose-input-data">Choose input
data</a>.</p></li>
<li><p>(Optional) For <strong>Step 2: Configure detection</strong>, you can configure what
types of data to look for, called "<a href="/dlp/docs/concepts-infotypes">infoTypes</a>." You
can select from the <a href="/dlp/docs/infotypes-reference">list of pre-defined infoTypes</a>,
or you can select a template if one exists. For more details, see
<a href="/dlp/docs/creating-job-triggers#configure-detection">Configure detection</a>.</p></li>
<li><p>(Optional) For <strong>Step 3: Add actions</strong>, make sure <strong>Notify by email</strong> is
enabled.</p>
<p>Enable <strong>Save to BigQuery</strong> to publish your
Cloud DLP findings to a BigQuery table.
Provide the following:</p>
<ul>
<li>For <strong>Project ID</strong>, enter the project ID where your results are stored.</li>
<li>For <strong>Dataset ID</strong>, enter the name of the dataset that stores your
results.</li>
<li>(Optional) For <strong>Table ID</strong>, enter the name of the table that stores
your results. If no table ID is specified, a default name is assigned
to a new table similar to the following:
<code dir="ltr" translate="no">dlp_googleapis_[DATE]_1234567890</code>, where <code dir="ltr" translate="no">[DATE]</code> represents the date
the scan is run. If you specify an existing table, findings are
appended to it.</li>
<li>(Optional) Enable <strong>Include Quote</strong> to include the strings that match
an infoType detector. Quotes are potentially sensitive, so by default,
Cloud DLP doesn't include them in findings.</li>
</ul>
<p>You can also save results to Pub/Sub, Security Command Center,
Data Catalog, and Cloud Monitoring. For more details, see
<a href="/dlp/docs/creating-job-triggers#add-actions">Add actions</a>.</p></li>
<li><p>(Optional) For <strong>Step 4: Schedule</strong>, to run the scan one time only,
leave the menu set to <strong>None</strong>. To schedule scans to run periodically,
click <strong>Create a trigger to run the job on a periodic schedule</strong>. For
more details, see <a href="/dlp/docs/creating-job-triggers#schedule-job">Schedule</a>.</p></li>
</ul></li>
<li><p>Click <strong>Create</strong>.</p></li>
<li><p>After the Cloud DLP job completes, you are redirected to the
 job details page and notified via email. You can view the results of the
 inspection on the job details page.</p></li>
<li><p>(Optional) If you chose to publish Cloud DLP findings to
 BigQuery, on the <strong>Job details</strong> page, click <strong>View Findings
 in BigQuery</strong> to open the table in the
 BigQuery web UI. You can then query the table and analyze
 your findings. For more information on querying your results in
 BigQuery, see <a href="/dlp/docs/querying-findings">Querying Cloud DLP findings in
 BigQuery</a>.</p></li>
</ol>
</section>
<section>
<h3 data-text="Protocol" id="dlp-inspect-storage-protocol" track-metadata-position="dlp-inspect-storage" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>Following is sample JSON that can be sent in a POST request to the specified
Cloud DLP REST endpoint. This example JSON demonstrates how to
use the DLP API to inspect Cloud Storage buckets. For
information about the parameters included with the request, see "<a href="#configuring-storage-inspection">Configure
storage inspection</a>," later in this topic.</p>
<aside class="note"><strong>Note:</strong><span> To specify a Cloud Storage bucket to scan, enter the URL using the
following pattern: <code dir="ltr" translate="no">gs://[GCS_BUCKET_NAME]/*</code>. To scan only the specified
directory and no deeper, use one asterisk (<code dir="ltr" translate="no">*</code>). To scan the directory
recursively, use two asterisks (<code dir="ltr" translate="no">**</code>).</span></aside>
<p>You can quickly try this out in the APIs Explorer on the reference page for
<code dir="ltr" translate="no">content.inspect</code>:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.content/inspect?apix=true">Go to APIs Explorer</a> </p>
<p>Keep in mind that a successful request, even in APIs Explorer, will create a new
scan job. For information about how to control scan jobs, see "<a href="#retrieving-inspection-results">Retrieve
inspection results</a>," later in this topic. For
general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs?key={YOUR_API_KEY}

{
  "inspectJob":{
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://[BUCKET-NAME]/*"
        },
        "bytesLimitPerFile":"1073741824"
      },
      "timespanConfig":{
        "startTime":"2017-11-13T12:34:29.965633345Z",
        "endTime":"2018-01-05T04:45:04.240912125Z"
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "excludeInfoTypes":false,
      "includeQuote":true,
      "minLikelihood":"LIKELY"
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT-ID]",
              "datasetId":"[DATASET-ID]"
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT-ID]/dlpJobs/[JOB-ID]",
  "type":"INSPECT_JOB",
  "state":"PENDING",
  "inspectDetails":{
    "requestedOptions":{
      "snapshotInspectTemplate":{

      },
      "jobConfig":{
        "storageConfig":{
          "cloudStorageOptions":{
            "fileSet":{
              "url":"gs://[BUCKET-NAME]/*"
            },
            "bytesLimitPerFile":"1073741824"
          },
          "timespanConfig":{
            "startTime":"2017-11-13T12:34:29.965633345Z",
            "endTime":"2018-01-05T04:45:04.240912125Z"
          }
        },
        "inspectConfig":{
          "infoTypes":[
            {
              "name":"PHONE_NUMBER"
            }
          ],
          "minLikelihood":"LIKELY",
          "limits":{

          },
          "includeQuote":true
        },
        "actions":[
          {
            "saveFindings":{
              "outputConfig":{
                "table":{
                  "projectId":"[PROJECT-ID]",
                  "datasetId":"[DATASET-ID]",
                  "tableId":"[NEW-TABLE-ID]"
                }
              }
            }
          }
        ]
      }
    }
  },
  "createTime":"2018-11-07T18:01:14.225Z"
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-storage-java" track-metadata-position="dlp-inspect-storage" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-storage" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectGcsFile.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectGcsFile.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-storage" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-storage" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectGcsFile.java" data-region-tag="dlp_inspect_gcs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectGcsFile.java/HEAD/dlp_inspect_gcs" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.CloudStorageOptions;
import com.google.privacy.dlp.v2.CloudStorageOptions.FileSet;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeStats;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectDataSourceDetails;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class InspectGcsFile {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String gcsUri = "gs://" + "your-bucket-name" + "/path/to/your/file.txt";
    String topicId = "your-pubsub-topic-id";
    String subscriptionId = "your-pubsub-subscription-id";
    inspectGcsFile(projectId, gcsUri, topicId, subscriptionId);
  }

  // Inspects a file in a Google Cloud Storage Bucket.
  public static void inspectGcsFile(
      String projectId, String gcsUri, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the GCS file to be inspected.
      CloudStorageOptions cloudStorageOptions =
          CloudStorageOptions.newBuilder().setFileSet(FileSet.newBuilder().setUrl(gcsUri)).build();

      StorageConfig storageConfig =
          StorageConfig.newBuilder().setCloudStorageOptions(cloudStorageOptions).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      List&lt;InfoType&gt; infoTypes =
          Stream.of("PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER")
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());

      // Specify how the content should be inspected.
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(infoTypes).setIncludeQuote(true).build();

      // Specify the action that is triggered when the job completes.
      String pubSubTopic = String.format("projects/%s/topics/%s", projectId, topicId);
      Action.PublishToPubSub publishToPubSub =
          Action.PublishToPubSub.newBuilder().setTopic(pubSubTopic).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the long running job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setStorageConfig(storageConfig)
              .setInspectConfig(inspectConfig)
              .addActions(action)
              .build();

      // Create the request for the job configured above.
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectJob(inspectJobConfig)
              .build();

      // Use the client to send the request.
      final DlpJob dlpJob = dlp.createDlpJob(createDlpJobRequest);
      System.out.println("Job created: " + dlpJob.getName());

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Get the latest state of the job from the service
      GetDlpJobRequest request = GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();
      DlpJob completedJob = dlp.getDlpJob(request);

      // Parse the response and process results.
      System.out.println("Job status: " + completedJob.getState());
      InspectDataSourceDetails.Result result = completedJob.getInspectDetails().getResult();
      System.out.println("Findings: ");
      for (InfoTypeStats infoTypeStat : result.getInfoTypeStatsList()) {
        System.out.print("\tInfo type: " + infoTypeStat.getInfoType().getName());
        System.out.println("\tCount: " + infoTypeStat.getCount());
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-inspect-storage-nodejs" track-metadata-position="dlp-inspect-storage" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-storage" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectGCSFile.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectGCSFile.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-storage" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-inspect-storage" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/inspectGCSFile.js" data-region-tag="dlp_inspect_gcs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/inspectGCSFile.js/HEAD/dlp_inspect_gcs" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The name of the bucket where the file resides.
// const bucketName = 'YOUR-BUCKET';

// The path to the file within the bucket to inspect.
// Can contain wildcards, e.g. "my-image.*"
// const fileName = 'my-image.png';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The customInfoTypes of information to match
// const customInfoTypes = [{ infoType: { name: 'DICT_TYPE' }, dictionary: { wordList: { words: ['foo', 'bar', 'baz']}}},
//   { infoType: { name: 'REGEX_TYPE' }, regex: {pattern: '\\(\\d{3}\\) \\d{3}-\\d{4}'}}];

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

async function inspectGCSFile() {
  // Get reference to the file to be inspected
  const storageItem = {
    cloudStorageOptions: {
      fileSet: {url: `gs://${bucketName}/${fileName}`},
    },
  };

  // Construct request for creating an inspect job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectJob: {
      inspectConfig: {
        infoTypes: infoTypes,
        customInfoTypes: customInfoTypes,
        minLikelihood: minLikelihood,
        limits: {
          maxFindingsPerRequest: maxFindings,
        },
      },
      storageConfig: storageItem,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };

  // Create a GCS File inspection job and wait for it to complete
  const [topicResponse] = await pubsub.topic(topicId).get();
  // Verify the Pub/Sub topic and listen for job notifications via an
  // existing subscription.
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  // Get the job's ID
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });

  setTimeout(() =&gt; {
    console.log('Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  console.log(`Job ${job.name} status: ${job.state}`);

  const infoTypeStats = job.inspectDetails.result.infoTypeStats;
  if (infoTypeStats.length &gt; 0) {
    infoTypeStats.forEach(infoTypeStat =&gt; {
      console.log(
        `  Found ${infoTypeStat.count} instance(s) of infoType ${infoTypeStat.infoType.name}.`
      );
    });
  } else {
    console.log('No findings.');
  }
}
inspectGCSFile();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-storage-python" track-metadata-position="dlp-inspect-storage" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-storage" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-storage" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-storage" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_gcs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_gcs" translate="no"><code dir="ltr" translate="no">def inspect_gcs_file(
    project,
    bucket,
    filename,
    topic_id,
    subscription_id,
    info_types,
    custom_dictionaries=None,
    custom_regexes=None,
    min_likelihood=None,
    max_findings=None,
    timeout=300,
):
    """Uses the Data Loss Prevention API to analyze a file on GCS.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        bucket: The name of the GCS bucket containing the file, as a string.
        filename: The name of the file in the bucket, including the path, as a
            string; e.g. 'images/myfile.png'.
        topic_id: The id of the Cloud Pub/Sub topic to which the API will
            broadcast job completion. The topic must already exist.
        subscription_id: The id of the Cloud Pub/Sub subscription to listen on
            while waiting for job completion. The subscription must already
            exist and be subscribed to the topic.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        timeout: The number of seconds to wait for a response from the API.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    # This sample also uses threading.Event() to wait for the job to finish.
    import threading

    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    if not info_types:
        info_types = ["FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS"]
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "limits": {"max_findings_per_request": max_findings},
    }

    # Construct a storage_config containing the file's URL.
    url = "gs://{}/{}".format(bucket, filename)
    storage_config = {"cloud_storage_options": {"file_set": {"url": url}}}

    # Convert the project id into full resource ids.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Construct the inspect_job, which defines the entire inspect content task.
    inspect_job = {
        "inspect_config": inspect_config,
        "storage_config": storage_config,
        "actions": actions,
    }

    operation = dlp.create_dlp_job(
        request={"parent": parent, "inspect_job": inspect_job}
    )
    print("Inspection operation started: {}".format(operation.name))

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)

    # Set up a callback to acknowledge a message. This closes around an event
    # so that it can signal that it is done and the main thread can continue.
    job_done = threading.Event()

    def callback(message):
        try:
            if message.attributes["DlpJobName"] == operation.name:
                # This is the message we're looking for, so acknowledge it.
                message.ack()

                # Now that the job is done, fetch the results and print them.
                job = dlp.get_dlp_job(request={"name": operation.name})
                if job.inspect_details.result.info_type_stats:
                    for finding in job.inspect_details.result.info_type_stats:
                        print(
                            "Info type: {}; Count: {}".format(
                                finding.info_type.name, finding.count
                            )
                        )
                else:
                    print("No findings.")

                # Signal to the main thread that we can exit.
                job_done.set()
            else:
                # This is not the message we're looking for.
                message.drop()
        except Exception as e:
            # Because this is executing in a thread, an exception won't be
            # noted unless we print it manually.
            print(e)
            raise

    subscriber.subscribe(subscription_path, callback=callback)
    finished = job_done.wait(timeout=timeout)
    if not finished:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-inspect-storage-go" track-metadata-position="dlp-inspect-storage" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-storage" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_gcs.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_gcs.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-storage" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-inspect-storage" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_gcs.go" data-region-tag="dlp_inspect_gcs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_gcs.go/HEAD/dlp_inspect_gcs" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"strings"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// inspectGCSFile searches for the given info types in the given file.
func inspectGCSFile(w io.Writer, projectID string, infoTypeNames []string, customDictionaries []string, customRegexes []string, pubSubTopic, pubSubSub, bucketName, fileName string) error {
	// projectID := "my-project-id"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// customDictionaries := []string{...}
	// customRegexes := []string{...}
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// bucketName := "my-bucket"
	// fileName := "my-file.txt"

	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}

	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Convert the custom dictionary word lists and custom regexes to a list of CustomInfoTypes.
	var customInfoTypes []*dlppb.CustomInfoType
	for idx, it := range customDictionaries {
		customInfoTypes = append(customInfoTypes, &amp;dlppb.CustomInfoType{
			InfoType: &amp;dlppb.InfoType{
				Name: fmt.Sprintf("CUSTOM_DICTIONARY_%d", idx),
			},
			Type: &amp;dlppb.CustomInfoType_Dictionary_{
				Dictionary: &amp;dlppb.CustomInfoType_Dictionary{
					Source: &amp;dlppb.CustomInfoType_Dictionary_WordList_{
						WordList: &amp;dlppb.CustomInfoType_Dictionary_WordList{
							Words: strings.Split(it, ","),
						},
					},
				},
			},
		})
	}
	for idx, it := range customRegexes {
		customInfoTypes = append(customInfoTypes, &amp;dlppb.CustomInfoType{
			InfoType: &amp;dlppb.InfoType{
				Name: fmt.Sprintf("CUSTOM_REGEX_%d", idx),
			},
			Type: &amp;dlppb.CustomInfoType_Regex_{
				Regex: &amp;dlppb.CustomInfoType_Regex{
					Pattern: it,
				},
			},
		})
	}

	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("pubsub.NewClient: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	// Create the Topic if it doesn't exist.
	t := pubsubClient.Topic(pubSubTopic)
	if exists, err := t.Exists(ctx); err != nil {
		return fmt.Errorf("t.Exists: %v", err)
	} else if !exists {
		if t, err = pubsubClient.CreateTopic(ctx, pubSubTopic); err != nil {
			return fmt.Errorf("CreateTopic: %v", err)
		}
	}

	// Create the Subscription if it doesn't exist.
	s := pubsubClient.Subscription(pubSubSub)
	if exists, err := s.Exists(ctx); err != nil {
		return fmt.Errorf("s.Exists: %v", err)
	} else if !exists {
		if s, err = pubsubClient.CreateSubscription(ctx, pubSubSub, pubsub.SubscriptionConfig{Topic: t}); err != nil {
			return fmt.Errorf("CreateSubscription: %v", err)
		}
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_InspectJob{
			InspectJob: &amp;dlppb.InspectJobConfig{
				// StorageConfig describes where to find the data.
				StorageConfig: &amp;dlppb.StorageConfig{
					Type: &amp;dlppb.StorageConfig_CloudStorageOptions{
						CloudStorageOptions: &amp;dlppb.CloudStorageOptions{
							FileSet: &amp;dlppb.CloudStorageOptions_FileSet{
								Url: "gs://" + bucketName + "/" + fileName,
							},
						},
					},
				},
				// InspectConfig describes what fields to look for.
				InspectConfig: &amp;dlppb.InspectConfig{
					InfoTypes:       infoTypes,
					CustomInfoTypes: customInfoTypes,
					MinLikelihood:   dlppb.Likelihood_POSSIBLE,
					Limits: &amp;dlppb.InspectConfig_FindingLimits{
						MaxFindingsPerRequest: 10,
					},
					IncludeQuote: true,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the inspect job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the inspect job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()

		// Stop listening for more messages.
		defer cancel()

		resp, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "Cloud not get job: %v", err)
			return
		}
		r := resp.GetInspectDetails().GetResult().GetInfoTypeStats()
		if len(r) == 0 {
			fmt.Fprintf(w, "No results")
		}
		for _, s := range r {
			fmt.Fprintf(w, "  Found %v instances of infoType %v\n", s.GetCount(), s.GetInfoType().GetName())
		}
	})
	if err != nil {
		return fmt.Errorf("Receive: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-inspect-storage-php" track-metadata-position="dlp-inspect-storage" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-storage" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_gcs.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_gcs.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-storage" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-inspect-storage" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_gcs.php" data-region-tag="dlp_inspect_gcs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_gcs.php/HEAD/dlp_inspect_gcs" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\CloudStorageOptions;
use Google\Cloud\Dlp\V2\CloudStorageOptions\FileSet;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\StorageConfig;
use Google\Cloud\Dlp\V2\Likelihood;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\InspectConfig\FindingLimits;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\InspectJobConfig;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Inspect a file stored on Google Cloud Storage , using Pub/Sub for job status notifications.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $topicId           The name of the Pub/Sub topic to notify once the job completes
 * @param string $subscriptionId    The name of the Pub/Sub subscription to use when listening for job
 * @param string $bucketId          The name of the bucket where the file resides
 * @param string $file              The path to the file within the bucket to inspect. Can contain wildcards e.g. "my-image.*"
 * @param int    $maxFindings       (Optional) The maximum number of findings to report per request (0 = server maximum)
 */
function inspect_gcs(
    string $callingProjectId,
    string $topicId,
    string $subscriptionId,
    string $bucketId,
    string $file,
    int $maxFindings = 0
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $pubsub = new PubSubClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $topic = $pubsub-&gt;topic($topicId);

    // The infoTypes of information to match
    $personNameInfoType = (new InfoType())
        -&gt;setName('PERSON_NAME');
    $creditCardNumberInfoType = (new InfoType())
        -&gt;setName('CREDIT_CARD_NUMBER');
    $infoTypes = [$personNameInfoType, $creditCardNumberInfoType];

    // The minimum likelihood required before returning a match
    $minLikelihood = likelihood::LIKELIHOOD_UNSPECIFIED;

    // Specify finding limits
    $limits = (new FindingLimits())
        -&gt;setMaxFindingsPerRequest($maxFindings);

    // Construct items to be inspected
    $fileSet = (new FileSet())
        -&gt;setUrl('gs://' . $bucketId . '/' . $file);

    $cloudStorageOptions = (new CloudStorageOptions())
        -&gt;setFileSet($fileSet);

    $storageConfig = (new StorageConfig())
        -&gt;setCloudStorageOptions($cloudStorageOptions);

    // Construct the inspect config object
    $inspectConfig = (new InspectConfig())
        -&gt;setMinLikelihood($minLikelihood)
        -&gt;setLimits($limits)
        -&gt;setInfoTypes($infoTypes);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct inspect job config to run
    $inspectJob = (new InspectJobConfig())
        -&gt;setInspectConfig($inspectConfig)
        -&gt;setStorageConfig($storageConfig)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'inspectJob' =&gt; $inspectJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $infoTypeStats = $job-&gt;getInspectDetails()-&gt;getResult()-&gt;getInfoTypeStats();
            if (count($infoTypeStats) === 0) {
                print('No findings.' . PHP_EOL);
            } else {
                foreach ($infoTypeStats as $infoTypeStat) {
                    printf('  Found %s instance(s) of infoType %s' . PHP_EOL, $infoTypeStat-&gt;getCount(), $infoTypeStat-&gt;getInfoType()-&gt;getName());
                }
            }
            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            print('Unexpected job state. Most likely, the job is either running or has not yet started.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-inspect-storage-csharp" track-metadata-position="dlp-inspect-storage" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-storage" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectGoogleCloudStorage.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectGoogleCloudStorage.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-storage" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-inspect-storage" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectGoogleCloudStorage.cs" data-region-tag="dlp_inspect_gcs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectGoogleCloudStorage.cs/HEAD/dlp_inspect_gcs" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Cloud.PubSub.V1;
using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using static Google.Cloud.Dlp.V2.InspectConfig.Types;

public class InspectGoogleCloudStorage
{
    public static DlpJob InspectGCS(
        string projectId,
        Likelihood minLikelihood,
        int maxFindings,
        bool includeQuote,
        IEnumerable&lt;InfoType&gt; infoTypes,
        IEnumerable&lt;CustomInfoType&gt; customInfoTypes,
        string bucketName,
        string topicId,
        string subscriptionId)
    {
        var inspectJob = new InspectJobConfig
        {
            StorageConfig = new StorageConfig
            {
                CloudStorageOptions = new CloudStorageOptions
                {
                    FileSet = new CloudStorageOptions.Types.FileSet { Url = $"gs://{bucketName}/*.txt" },
                    BytesLimitPerFile = 1073741824
                },
            },
            InspectConfig = new InspectConfig
            {
                InfoTypes = { infoTypes },
                CustomInfoTypes = { customInfoTypes },
                ExcludeInfoTypes = false,
                IncludeQuote = includeQuote,
                Limits = new FindingLimits
                {
                    MaxFindingsPerRequest = maxFindings
                },
                MinLikelihood = minLikelihood
            },
            Actions =
                {
                    new Google.Cloud.Dlp.V2.Action
                    {
                        // Send results to Pub/Sub topic
                        PubSub = new Google.Cloud.Dlp.V2.Action.Types.PublishToPubSub
                        {
                            Topic = topicId,
                        }
                    }
                }
        };

        // Issue Create Dlp Job Request
        var client = DlpServiceClient.Create();
        var request = new CreateDlpJobRequest
        {
            InspectJob = inspectJob,
            Parent = new LocationName(projectId, "global").ToString(),
        };

        // We need created job name
        var dlpJob = client.CreateDlpJob(request);

        // Get a pub/sub subscription and listen for DLP results
        var fireEvent = new ManualResetEventSlim();

        var subscriptionName = new SubscriptionName(projectId, subscriptionId);
        var subscriber = SubscriberClient.CreateAsync(subscriptionName).Result;
        subscriber.StartAsync(
            (pubSubMessage, cancellationToken) =&gt;
            {
                // Given a message that we receive on this subscription, we should either acknowledge or decline it
                if (pubSubMessage.Attributes["DlpJobName"] == dlpJob.Name)
                {
                    fireEvent.Set();
                    return Task.FromResult(SubscriberClient.Reply.Ack);
                }

                return Task.FromResult(SubscriberClient.Reply.Nack);
            });

        // We block here until receiving a signal from a separate thread that is waiting on a message indicating receiving a result of Dlp job
        if (fireEvent.Wait(TimeSpan.FromMinutes(1)))
        {
            // Stop the thread that is listening to messages as a result of StartAsync call earlier
            subscriber.StopAsync(CancellationToken.None).Wait();

            // Now we can inspect full job results
            var job = client.GetDlpJob(new GetDlpJobRequest { DlpJobName = new DlpJobName(projectId, dlpJob.Name) });

            // Inspect Job details
            Console.WriteLine($"Processed bytes: {job.InspectDetails.Result.ProcessedBytes}");
            Console.WriteLine($"Total estimated bytes: {job.InspectDetails.Result.TotalEstimatedBytes}");
            var stats = job.InspectDetails.Result.InfoTypeStats;
            Console.WriteLine("Found stats:");
            foreach (var stat in stats)
            {
                Console.WriteLine($"{stat.InfoType.Name}");
            }

            return job;
        }

        throw new InvalidOperationException("The wait failed on timeout");
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Inspect a Datastore kind" id="inspecting-datastore">Inspect a Datastore kind</h2>
<p>You can set up an inspection of a Datastore kind using the
Google Cloud console, the DLP API via <a href="/dlp/docs/reference/rest">REST</a>
or <a href="/dlp/docs/reference/rpc">RPC</a> requests, or programmatically in several
languages using a <a href="/dlp/docs/libraries">client library</a>.</p>
<aside class="note"><strong>Note:</strong><span> For information about the parameters included with the following JSON and
code samples, see "<a href="#configuring-storage-inspection">Configure storage
inspection</a>," later in this topic.</span></aside>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<p>To set up a scan job of a Datastore kind using
Cloud DLP:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-datastore-code-sample">
<section>
<h3 data-text="Console" id="dlp-inspect-datastore-console" track-metadata-position="dlp-inspect-datastore" track-name="console" track-type="sampleTabNav">Console</h3>
<p>To set up a scan job of a Datastore bucket using
Cloud DLP:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Job or job trigger</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p></li>
<li><p>Enter the Cloud DLP job information and click <strong>Continue</strong> to
 complete each step:</p>
<ul>
<li><p>For <strong>Step 1: Choose input data</strong>, enter the identifiers for the project,
namespace (optional), and kind that you want to scan. For more details,
see <a href="/dlp/docs/creating-job-triggers#choose-input-data">Choose input data</a>.</p></li>
<li><p>(Optional) For <strong>Step 2: Configure detection</strong>, you can configure what
types of data to look for, called "<a href="/dlp/docs/concepts-infotypes">infoTypes</a>." You
can select from the <a href="/dlp/docs/infotypes-reference">list of pre-defined infoTypes</a>,
or you can select a template if one exists. For more details, see
<a href="/dlp/docs/creating-job-triggers#configure-detection">Configure detection</a>.</p></li>
<li><p>(Optional) For <strong>Step 3: Add actions</strong>, make sure <strong>Notify by email</strong> is
enabled.</p>
<p>Enable <strong>Save to BigQuery</strong> to publish your
Cloud DLP findings to a BigQuery table.
Provide the following:</p>
<ul>
<li>For <strong>Project ID</strong>, enter the project ID where your results are stored.</li>
<li>For <strong>Dataset ID</strong>, enter the name of the dataset that stores your
results.</li>
<li>(Optional) For <strong>Table ID</strong>, enter the name of the table that stores
your results. If no table ID is specified, a default name is assigned
to a new table similar to the following:
<code dir="ltr" translate="no">dlp_googleapis_[DATE]_1234567890</code>. If you specify an existing table,
findings are appended to it.</li>
</ul>
<p>For more information about the other actions listed, see <a href="/dlp/docs/creating-job-triggers#add-actions">Add
actions</a>.</p></li>
<li><p>(Optional) For <strong>Step 4: Schedule</strong>, configure a time span or schedule by
selecting either <strong>Specify time span</strong> or <strong>Create a trigger to run the
job on a periodic schedule</strong>. For more information, see
<a href="/dlp/docs/creating-job-triggers#schedule-job">Schedule</a>.</p></li>
</ul></li>
<li><p>Click <strong>Create</strong>.</p></li>
<li><p>After the Cloud DLP job completes, you are redirected to the
 job details page and notified via email. You can view the results of the
 inspection on the job details page.</p></li>
<li><p>(Optional) If you chose to publish Cloud DLP findings to
 BigQuery, on the <strong>Job details</strong> page, click <strong>View Findings
 in BigQuery</strong> to open the table in the
 BigQuery web UI. You can then query the table and analyze
 your findings. For more information on querying your results in
 BigQuery, see <a href="/dlp/docs/querying-findings">Querying Cloud DLP findings in
 BigQuery</a>.</p></li>
</ol>
</section>
<section>
<h3 data-text="Protocol" id="dlp-inspect-datastore-protocol" track-metadata-position="dlp-inspect-datastore" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>Following is sample JSON that can be sent in a POST request to the specified
DLP API REST endpoint. This example JSON demonstrates how to
use the DLP API to inspect Datastore kinds.
For information about the parameters included with the request, see
"<a href="#configuring-storage-inspection">Configure storage inspection</a>," later in
this topic.</p>
<p>You can quickly try this out in the APIs Explorer on the reference page for
<code dir="ltr" translate="no">dlpJobs.create</code>:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create?apix=true">Go to APIs Explorer</a> </p>
<p>Keep in mind that a successful request, even in APIs Explorer, will create a new
scan job. For information about how to control scan jobs, see <a href="#retrieving-inspection-results">Retrieve
inspection results</a>, later in this topic. For
general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs?key={YOUR_API_KEY}

{
  "inspectJob":{
    "storageConfig":{
      "datastoreOptions":{
        "kind":{
          "name":"Example-Kind"
        },
        "partitionId":{
          "namespaceId":"[NAMESPACE-ID]",
          "projectId":"[PROJECT-ID]"
        }
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "excludeInfoTypes":false,
      "includeQuote":true,
      "minLikelihood":"LIKELY"
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT-ID]",
              "datasetId":"[BIGQUERY-DATASET-NAME]",
              "tableId":"[BIGQUERY-TABLE-NAME]"
            }
          }
        }
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-datastore-java" track-metadata-position="dlp-inspect-datastore" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-datastore" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectDatastoreEntity.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectDatastoreEntity.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-datastore" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-datastore" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectDatastoreEntity.java" data-region-tag="dlp_inspect_datastore" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectDatastoreEntity.java/HEAD/dlp_inspect_datastore" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DatastoreOptions;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeStats;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectDataSourceDetails;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.KindExpression;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PartitionId;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class InspectDatastoreEntity {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String datastoreNamespace = "your-datastore-namespace";
    String datastoreKind = "your-datastore-kind";
    String topicId = "your-pubsub-topic-id";
    String subscriptionId = "your-pubsub-subscription-id";
    insepctDatastoreEntity(projectId, datastoreNamespace, datastoreKind, topicId, subscriptionId);
  }

  // Inspects a Datastore Entity.
  public static void insepctDatastoreEntity(
      String projectId,
      String datastoreNamespce,
      String datastoreKind,
      String topicId,
      String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the Datastore entity to be inspected.
      PartitionId partitionId =
          PartitionId.newBuilder()
              .setProjectId(projectId)
              .setNamespaceId(datastoreNamespce)
              .build();
      KindExpression kindExpression = KindExpression.newBuilder().setName(datastoreKind).build();

      DatastoreOptions datastoreOptions =
          DatastoreOptions.newBuilder().setKind(kindExpression).setPartitionId(partitionId).build();

      StorageConfig storageConfig =
          StorageConfig.newBuilder().setDatastoreOptions(datastoreOptions).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      List&lt;InfoType&gt; infoTypes =
          Stream.of("PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER")
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());

      // Specify how the content should be inspected.
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(infoTypes).setIncludeQuote(true).build();

      // Specify the action that is triggered when the job completes.
      String pubSubTopic = String.format("projects/%s/topics/%s", projectId, topicId);
      Action.PublishToPubSub publishToPubSub =
          Action.PublishToPubSub.newBuilder().setTopic(pubSubTopic).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the long running job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setStorageConfig(storageConfig)
              .setInspectConfig(inspectConfig)
              .addActions(action)
              .build();

      // Create the request for the job configured above.
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectJob(inspectJobConfig)
              .build();

      // Use the client to send the request.
      final DlpJob dlpJob = dlp.createDlpJob(createDlpJobRequest);
      System.out.println("Job created: " + dlpJob.getName());

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Get the latest state of the job from the service
      GetDlpJobRequest request = GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();
      DlpJob completedJob = dlp.getDlpJob(request);

      // Parse the response and process results.
      System.out.println("Job status: " + completedJob.getState());
      InspectDataSourceDetails.Result result = completedJob.getInspectDetails().getResult();
      System.out.println("Findings: ");
      for (InfoTypeStats infoTypeStat : result.getInfoTypeStatsList()) {
        System.out.print("\tInfo type: " + infoTypeStat.getInfoType().getName());
        System.out.println("\tCount: " + infoTypeStat.getCount());
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-inspect-datastore-nodejs" track-metadata-position="dlp-inspect-datastore" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-datastore" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectDatastore.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectDatastore.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-datastore" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-inspect-datastore" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/inspectDatastore.js" data-region-tag="dlp_inspect_datastore" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/inspectDatastore.js/HEAD/dlp_inspect_datastore" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the target Datastore is stored under
// This may or may not equal the calling project ID
// const dataProjectId = 'my-project';

// (Optional) The ID namespace of the Datastore document to inspect.
// To ignore Datastore namespaces, set this to an empty string ('')
// const namespaceId = '';

// The kind of the Datastore entity to inspect.
// const kind = 'Person';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The customInfoTypes of information to match
// const customInfoTypes = [{ infoType: { name: 'DICT_TYPE' }, dictionary: { wordList: { words: ['foo', 'bar', 'baz']}}},
//   { infoType: { name: 'REGEX_TYPE' }, regex: {pattern: '\\(\\d{3}\\) \\d{3}-\\d{4}'}}];

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

async function inspectDatastore() {
  // Construct items to be inspected
  const storageItems = {
    datastoreOptions: {
      partitionId: {
        projectId: dataProjectId,
        namespaceId: namespaceId,
      },
      kind: {
        name: kind,
      },
    },
  };

  // Construct request for creating an inspect job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectJob: {
      inspectConfig: {
        infoTypes: infoTypes,
        customInfoTypes: customInfoTypes,
        minLikelihood: minLikelihood,
        limits: {
          maxFindingsPerRequest: maxFindings,
        },
      },
      storageConfig: storageItems,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };
  // Run inspect-job creation request
  const [topicResponse] = await pubsub.topic(topicId).get();
  // Verify the Pub/Sub topic and listen for job notifications via an
  // existing subscription.
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  // Wait for DLP job to fully complete
  setTimeout(() =&gt; {
    console.log('Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  console.log(`Job ${job.name} status: ${job.state}`);

  const infoTypeStats = job.inspectDetails.result.infoTypeStats;
  if (infoTypeStats.length &gt; 0) {
    infoTypeStats.forEach(infoTypeStat =&gt; {
      console.log(
        `  Found ${infoTypeStat.count} instance(s) of infoType ${infoTypeStat.infoType.name}.`
      );
    });
  } else {
    console.log('No findings.');
  }
}
inspectDatastore();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-datastore-python" track-metadata-position="dlp-inspect-datastore" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-datastore" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-datastore" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-datastore" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_datastore" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_datastore" translate="no"><code dir="ltr" translate="no">def inspect_datastore(
    project,
    datastore_project,
    kind,
    topic_id,
    subscription_id,
    info_types,
    custom_dictionaries=None,
    custom_regexes=None,
    namespace_id=None,
    min_likelihood=None,
    max_findings=None,
    timeout=300,
):
    """Uses the Data Loss Prevention API to analyze Datastore data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        datastore_project: The Google Cloud project id of the target Datastore.
        kind: The kind of the Datastore entity to inspect, e.g. 'Person'.
        topic_id: The id of the Cloud Pub/Sub topic to which the API will
            broadcast job completion. The topic must already exist.
        subscription_id: The id of the Cloud Pub/Sub subscription to listen on
            while waiting for job completion. The subscription must already
            exist and be subscribed to the topic.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        namespace_id: The namespace of the Datastore document, if applicable.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        timeout: The number of seconds to wait for a response from the API.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    # This sample also uses threading.Event() to wait for the job to finish.
    import threading

    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    if not info_types:
        info_types = ["FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS"]
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "limits": {"max_findings_per_request": max_findings},
    }

    # Construct a storage_config containing the target Datastore info.
    storage_config = {
        "datastore_options": {
            "partition_id": {
                "project_id": datastore_project,
                "namespace_id": namespace_id,
            },
            "kind": {"name": kind},
        }
    }

    # Convert the project id into full resource ids.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Construct the inspect_job, which defines the entire inspect content task.
    inspect_job = {
        "inspect_config": inspect_config,
        "storage_config": storage_config,
        "actions": actions,
    }

    operation = dlp.create_dlp_job(
        request={"parent": parent, "inspect_job": inspect_job}
    )
    print("Inspection operation started: {}".format(operation.name))

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)

    # Set up a callback to acknowledge a message. This closes around an event
    # so that it can signal that it is done and the main thread can continue.
    job_done = threading.Event()

    def callback(message):
        try:
            if message.attributes["DlpJobName"] == operation.name:
                # This is the message we're looking for, so acknowledge it.
                message.ack()

                # Now that the job is done, fetch the results and print them.
                job = dlp.get_dlp_job(request={"name": operation.name})
                if job.inspect_details.result.info_type_stats:
                    for finding in job.inspect_details.result.info_type_stats:
                        print(
                            "Info type: {}; Count: {}".format(
                                finding.info_type.name, finding.count
                            )
                        )
                else:
                    print("No findings.")

                # Signal to the main thread that we can exit.
                job_done.set()
            else:
                # This is not the message we're looking for.
                message.drop()
        except Exception as e:
            # Because this is executing in a thread, an exception won't be
            # noted unless we print it manually.
            print(e)
            raise

    # Register the callback and wait on the event.
    subscriber.subscribe(subscription_path, callback=callback)

    finished = job_done.wait(timeout=timeout)
    if not finished:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-inspect-datastore-go" track-metadata-position="dlp-inspect-datastore" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-datastore" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_datastore.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_datastore.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-datastore" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-inspect-datastore" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_datastore.go" data-region-tag="dlp_inspect_datastore" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_datastore.go/HEAD/dlp_inspect_datastore" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"strings"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// inspectDatastore searches for the given info types in the given dataset kind.
func inspectDatastore(w io.Writer, projectID string, infoTypeNames []string, customDictionaries []string, customRegexes []string, pubSubTopic, pubSubSub, dataProject, namespaceID, kind string) error {
	// projectID := "my-project-id"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// customDictionaries := []string{...}
	// customRegexes := []string{...}
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// namespaceID := "namespace-id"
	// kind := "MyKind"

	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}

	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Convert the custom dictionary word lists and custom regexes to a list of CustomInfoTypes.
	var customInfoTypes []*dlppb.CustomInfoType
	for idx, it := range customDictionaries {
		customInfoTypes = append(customInfoTypes, &amp;dlppb.CustomInfoType{
			InfoType: &amp;dlppb.InfoType{
				Name: fmt.Sprintf("CUSTOM_DICTIONARY_%d", idx),
			},
			Type: &amp;dlppb.CustomInfoType_Dictionary_{
				Dictionary: &amp;dlppb.CustomInfoType_Dictionary{
					Source: &amp;dlppb.CustomInfoType_Dictionary_WordList_{
						WordList: &amp;dlppb.CustomInfoType_Dictionary_WordList{
							Words: strings.Split(it, ","),
						},
					},
				},
			},
		})
	}
	for idx, it := range customRegexes {
		customInfoTypes = append(customInfoTypes, &amp;dlppb.CustomInfoType{
			InfoType: &amp;dlppb.InfoType{
				Name: fmt.Sprintf("CUSTOM_REGEX_%d", idx),
			},
			Type: &amp;dlppb.CustomInfoType_Regex_{
				Regex: &amp;dlppb.CustomInfoType_Regex{
					Pattern: it,
				},
			},
		})
	}

	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("pubsub.NewClient: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	// Create the Topic if it doesn't exist.
	t := pubsubClient.Topic(pubSubTopic)
	if exists, err := t.Exists(ctx); err != nil {
		return fmt.Errorf("t.Exists: %v", err)
	} else if !exists {
		if t, err = pubsubClient.CreateTopic(ctx, pubSubTopic); err != nil {
			return fmt.Errorf("CreateTopic: %v", err)
		}
	}

	// Create the Subscription if it doesn't exist.
	s := pubsubClient.Subscription(pubSubSub)
	if exists, err := s.Exists(ctx); err != nil {
		return fmt.Errorf("s.Exists: %v", err)
	} else if !exists {
		if s, err = pubsubClient.CreateSubscription(ctx, pubSubSub, pubsub.SubscriptionConfig{Topic: t}); err != nil {
			return fmt.Errorf("CreateSubscription: %v", err)
		}
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_InspectJob{
			InspectJob: &amp;dlppb.InspectJobConfig{
				// StorageConfig describes where to find the data.
				StorageConfig: &amp;dlppb.StorageConfig{
					Type: &amp;dlppb.StorageConfig_DatastoreOptions{
						DatastoreOptions: &amp;dlppb.DatastoreOptions{
							PartitionId: &amp;dlppb.PartitionId{
								ProjectId:   dataProject,
								NamespaceId: namespaceID,
							},
							Kind: &amp;dlppb.KindExpression{
								Name: kind,
							},
						},
					},
				},
				// InspectConfig describes what fields to look for.
				InspectConfig: &amp;dlppb.InspectConfig{
					InfoTypes:       infoTypes,
					CustomInfoTypes: customInfoTypes,
					MinLikelihood:   dlppb.Likelihood_POSSIBLE,
					Limits: &amp;dlppb.InspectConfig_FindingLimits{
						MaxFindingsPerRequest: 10,
					},
					IncludeQuote: true,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the inspect job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the inspect job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()

		// Stop listening for more messages.
		defer cancel()

		resp, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "Error getting completed job: %v\n", err)
			return
		}
		r := resp.GetInspectDetails().GetResult().GetInfoTypeStats()
		if len(r) == 0 {
			fmt.Fprintf(w, "No results")
			return
		}
		for _, s := range r {
			fmt.Fprintf(w, "  Found %v instances of infoType %v\n", s.GetCount(), s.GetInfoType().GetName())
		}
	})
	if err != nil {
		return fmt.Errorf("Receive: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-inspect-datastore-php" track-metadata-position="dlp-inspect-datastore" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-datastore" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_datastore.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_datastore.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-datastore" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-inspect-datastore" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_datastore.php" data-region-tag="dlp_inspect_datastore" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_datastore.php/HEAD/dlp_inspect_datastore" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\DatastoreOptions;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\InspectJobConfig;
use Google\Cloud\Dlp\V2\KindExpression;
use Google\Cloud\Dlp\V2\PartitionId;
use Google\Cloud\Dlp\V2\StorageConfig;
use Google\Cloud\Dlp\V2\Likelihood;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\InspectConfig\FindingLimits;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Inspect Datastore, using Pub/Sub for job status notifications.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $dataProjectId     The project ID containing the target Datastore
 * @param string $topicId           The name of the Pub/Sub topic to notify once the job completes
 * @param string $subscriptionId    The name of the Pub/Sub subscription to use when listening for job
 * @param string $kind              The datastore kind to inspect
 * @param string $namespaceId       The ID namespace of the Datastore document to inspect
 * @param int    $maxFindings       (Optional) The maximum number of findings to report per request (0 = server maximum)
 */
function inspect_datastore(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $kind,
    string $namespaceId,
    int $maxFindings = 0
): void {
    // Instantiate clients
    $dlp = new DlpServiceClient();
    $pubsub = new PubSubClient();
    $topic = $pubsub-&gt;topic($topicId);

    // The infoTypes of information to match
    $personNameInfoType = (new InfoType())
        -&gt;setName('PERSON_NAME');
    $phoneNumberInfoType = (new InfoType())
        -&gt;setName('PHONE_NUMBER');
    $infoTypes = [$personNameInfoType, $phoneNumberInfoType];

    // The minimum likelihood required before returning a match
    $minLikelihood = likelihood::LIKELIHOOD_UNSPECIFIED;

    // Specify finding limits
    $limits = (new FindingLimits())
        -&gt;setMaxFindingsPerRequest($maxFindings);

    // Construct items to be inspected
    $partitionId = (new PartitionId())
        -&gt;setProjectId($dataProjectId)
        -&gt;setNamespaceId($namespaceId);

    $kindExpression = (new KindExpression())
        -&gt;setName($kind);

    $datastoreOptions = (new DatastoreOptions())
        -&gt;setPartitionId($partitionId)
        -&gt;setKind($kindExpression);

    // Construct the inspect config object
    $inspectConfig = (new InspectConfig())
        -&gt;setInfoTypes($infoTypes)
        -&gt;setMinLikelihood($minLikelihood)
        -&gt;setLimits($limits);

    // Construct the storage config object
    $storageConfig = (new StorageConfig())
        -&gt;setDatastoreOptions($datastoreOptions);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct inspect job config to run
    $inspectJob = (new InspectJobConfig())
        -&gt;setInspectConfig($inspectConfig)
        -&gt;setStorageConfig($storageConfig)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'inspectJob' =&gt; $inspectJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $infoTypeStats = $job-&gt;getInspectDetails()-&gt;getResult()-&gt;getInfoTypeStats();
            if (count($infoTypeStats) === 0) {
                print('No findings.' . PHP_EOL);
            } else {
                foreach ($infoTypeStats as $infoTypeStat) {
                    printf('  Found %s instance(s) of infoType %s' . PHP_EOL, $infoTypeStat-&gt;getCount(), $infoTypeStat-&gt;getInfoType()-&gt;getName());
                }
            }
            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            print('Unexpected job state.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-inspect-datastore-csharp" track-metadata-position="dlp-inspect-datastore" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-datastore" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectCloudDataStore.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectCloudDataStore.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-datastore" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-inspect-datastore" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectCloudDataStore.cs" data-region-tag="dlp_inspect_datastore" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectCloudDataStore.cs/HEAD/dlp_inspect_datastore" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.BigQuery.V2;
using Google.Cloud.Dlp.V2;
using Google.Protobuf.WellKnownTypes;
using System;
using System.Collections.Generic;
using System.Threading;
using static Google.Cloud.Dlp.V2.InspectConfig.Types;

public class InspectCloudDataStore
{
    public static object Inspect(
        string projectId,
        Likelihood minLikelihood,
        int maxFindings,
        bool includeQuote,
        string kindName,
        string namespaceId,
        IEnumerable&lt;InfoType&gt; infoTypes,
        IEnumerable&lt;CustomInfoType&gt; customInfoTypes,
        string datasetId,
        string tableId)
    {
        var inspectJob = new InspectJobConfig
        {
            StorageConfig = new StorageConfig
            {
                DatastoreOptions = new DatastoreOptions
                {
                    Kind = new KindExpression { Name = kindName },
                    PartitionId = new PartitionId
                    {
                        NamespaceId = namespaceId,
                        ProjectId = projectId,
                    }
                },
                TimespanConfig = new StorageConfig.Types.TimespanConfig
                {
                    StartTime = Timestamp.FromDateTime(System.DateTime.UtcNow.AddYears(-1)),
                    EndTime = Timestamp.FromDateTime(System.DateTime.UtcNow)
                }
            },

            InspectConfig = new InspectConfig
            {
                InfoTypes = { infoTypes },
                CustomInfoTypes = { customInfoTypes },
                Limits = new FindingLimits
                {
                    MaxFindingsPerRequest = maxFindings
                },
                ExcludeInfoTypes = false,
                IncludeQuote = includeQuote,
                MinLikelihood = minLikelihood
            },
            Actions =
                {
                    new Google.Cloud.Dlp.V2.Action
                    {
                        // Save results in BigQuery Table
                        SaveFindings = new Google.Cloud.Dlp.V2.Action.Types.SaveFindings
                        {
                            OutputConfig = new OutputStorageConfig
                            {
                                Table = new Google.Cloud.Dlp.V2.BigQueryTable
                                {
                                    ProjectId = projectId,
                                    DatasetId = datasetId,
                                    TableId = tableId
                                }
                            }
                        },
                    }
                }
        };

        // Issue Create Dlp Job Request
        var client = DlpServiceClient.Create();
        var request = new CreateDlpJobRequest
        {
            InspectJob = inspectJob,
            Parent = new LocationName(projectId, "global").ToString(),
        };

        // We need created job name
        var dlpJob = client.CreateDlpJob(request);
        var jobName = dlpJob.Name;

        // Make sure the job finishes before inspecting the results.
        // Alternatively, we can inspect results opportunistically, but
        // for testing purposes, we want consistent outcome
        var finishedJob = EnsureJobFinishes(projectId, jobName);
        var bigQueryClient = BigQueryClient.Create(projectId);
        var table = bigQueryClient.GetTable(datasetId, tableId);

        // Return only first page of 10 rows
        Console.WriteLine("DLP v2 Results:");
        var firstPage = table.ListRows(new ListRowsOptions { StartIndex = 0, PageSize = 10 });
        foreach (var item in firstPage)
        {
            Console.WriteLine($"\t {item[""]}");
        }

        return finishedJob;
    }

    private static DlpJob EnsureJobFinishes(string projectId, string jobName)
    {
        var client = DlpServiceClient.Create();
        var request = new GetDlpJobRequest
        {
            DlpJobName = new DlpJobName(projectId, jobName),
        };

        // Simple logic that gives the job 5*30 sec at most to complete - for testing purposes only
        var numOfAttempts = 5;
        do
        {
            var dlpJob = client.GetDlpJob(request);
            numOfAttempts--;
            if (dlpJob.State != DlpJob.Types.JobState.Running)
            {
                return dlpJob;
            }

            Thread.Sleep(TimeSpan.FromSeconds(30));
        } while (numOfAttempts &gt; 0);

        throw new InvalidOperationException("Job did not complete in time");
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Inspect a BigQuery table" id="inspect_a_table">Inspect a BigQuery table</h2>
<p>You can set up an inspection of a BigQuery table using
Cloud DLP via REST requests, or programmatically in several
languages using a <a href="/dlp/docs/libraries">client library</a>.</p>
<aside class="note"><strong>Note:</strong><span> For information about the parameters included with the following JSON and
code samples, see "<a href="#configuring-storage-inspection">Configure storage
inspection</a>," later in this topic.</span></aside>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<p>To set up a scan job of a BigQuery table using
Cloud DLP:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-bigquery-code-sample">
<section>
<h3 data-text="Console" id="dlp-inspect-bigquery-console" track-metadata-position="dlp-inspect-bigquery" track-name="console" track-type="sampleTabNav">Console</h3>
<p>To set up a scan job of a BigQuery table using
Cloud DLP:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Job or job trigger</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p></li>
<li><p>Enter the Cloud DLP job information and click <strong>Continue</strong> to
 complete each step:</p>
<ul>
<li><p>For <strong>Step 1: Choose input data</strong>, name the job by entering a value in
the <strong>Name</strong> field. In <strong>Location</strong>, choose BigQuery from
the <strong>Storage type</strong> menu, and then enter the information for the table
to scan. The <strong>Sampling</strong> section is pre-configured to run a sample scan
against your data. You can adjust the <strong>Limit rows by</strong> and <strong>Maximum
number of rows</strong> fields to save resources if you have a large amount of
data. For more details, see <a href="/dlp/docs/creating-job-triggers#choose-input-data">Choose input
data</a>.</p></li>
<li><p>(Optional) For <strong>Step 2: Configure detection</strong>, you can configure what
types of data to look for, called "<a href="/dlp/docs/concepts-infotypes">infoTypes</a>." You
can select from the <a href="/dlp/docs/infotypes-reference">list of pre-defined infoTypes</a>,
or you can select a template if one exists. For more details, see
<a href="/dlp/docs/creating-job-triggers#configure-detection">Configure detection</a>.</p></li>
<li><p>(Optional) For <strong>Step 3: Add actions</strong>, make sure <strong>Notify by email</strong> is
enabled.</p>
<p>Enable <strong>Save to BigQuery</strong> to publish your
Cloud DLP findings to a BigQuery table.
Provide the following:</p>
<ul>
<li>For <strong>Project ID</strong>, enter the project ID where your results are stored.</li>
<li>For <strong>Dataset ID</strong>, enter the name of the dataset that stores your
results.</li>
<li>(Optional) For <strong>Table ID</strong>, enter the name of the table that stores
your results. If no table ID is specified, a default name is assigned
to a new table similar to the following:
<code dir="ltr" translate="no">dlp_googleapis_[DATE]_1234567890</code>. If you specify an existing table,
findings are appended to it.</li>
</ul>
<p>You can also save results to Pub/Sub, Security Command Center, and
Data Catalog. For more details, see <a href="/dlp/docs/creating-job-triggers#add-actions">Add
actions</a>.</p></li>
<li><p>(Optional) For <strong>Step 4: Schedule</strong>, to run the scan one time only,
leave the menu set to <strong>None</strong>. To schedule scans to run periodically,
click <strong>Create a trigger to run the job on a periodic schedule</strong>. For
more details, see <a href="/dlp/docs/creating-job-triggers#schedule-job">Schedule</a>.</p></li>
</ul></li>
<li><p>Click <strong>Create</strong>.</p></li>
<li><p>After the Cloud DLP job completes, you are redirected to the
 job details page and notified via email. You can view the results of the
 inspection on the job details page.</p></li>
<li><p>(Optional) If you chose to publish Cloud DLP findings to
 BigQuery, on the <strong>Job details</strong> page, click <strong>View Findings
 in BigQuery</strong> to open the table in the
 BigQuery web UI. You can then query the table and analyze
 your findings. For more information on querying your results in
 BigQuery, see <a href="/dlp/docs/querying-findings">Querying Cloud DLP findings in
 BigQuery</a>.</p></li>
</ol>
</section>
<section>
<h3 data-text="Protocol" id="dlp-inspect-bigquery-protocol" track-metadata-position="dlp-inspect-bigquery" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
  
  
  
  
Following is sample JSON that can be sent in a POST request to the specified
DLP API REST endpoint. This example JSON demonstrates how to
use the DLP API to inspect BigQuery tables.
For information about the parameters included with the request, see
"<a href="#configuring-storage-inspection">Configure storage inspection</a>,"
later in this topic.
<p>You can quickly try this out in the APIs Explorer on the reference page for
<code dir="ltr" translate="no">dlpJobs.create</code>:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create?apix=true">Go to APIs Explorer</a> </p>
<p>Keep in mind that a successful request, even in APIs Explorer, will create a new
scan job. For information about how to control scan jobs, see "<a href="#retrieving-inspection-results">Retrieve
inspection results</a>," later in this topic. For
general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs?key={YOUR_API_KEY}

{
  "inspectJob":{
    "storageConfig":{
      "bigQueryOptions":{
        "tableReference":{
          "projectId":"[PROJECT-ID]",
          "datasetId":"[BIGQUERY-DATASET-NAME]",
          "tableId":"[BIGQUERY-TABLE-NAME]"
        },
        "identifyingFields":[
          {
            "name":"person.contactinfo"
          }
        ]
      },
      "timespanConfig":{
        "startTime":"2017-11-13T12:34:29.965633345Z ",
        "endTime":"2018-01-05T04:45:04.240912125Z "
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "excludeInfoTypes":false,
      "includeQuote":true,
      "minLikelihood":"LIKELY"
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT-ID]",
              "datasetId":"[BIGQUERY-DATASET-NAME]",
              "tableId":"[BIGQUERY-TABLE-NAME]"
            }
          },
          "outputSchema": "BASIC_COLUMNS"
        }
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-bigquery-java" track-metadata-position="dlp-inspect-bigquery" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-bigquery" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTable.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTable.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-bigquery" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-bigquery" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTable.java" data-region-tag="dlp_inspect_bigquery" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTable.java/HEAD/dlp_inspect_bigquery" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.BigQueryOptions;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeStats;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectDataSourceDetails;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class InspectBigQueryTable {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String bigQueryDatasetId = "your-bigquery-dataset-id";
    String bigQueryTableId = "your-bigquery-table-id";
    String topicId = "your-pubsub-topic-id";
    String subscriptionId = "your-pubsub-subscription-id";
    inspectBigQueryTable(projectId, bigQueryDatasetId, bigQueryTableId, topicId, subscriptionId);
  }

  // Inspects a BigQuery Table
  public static void inspectBigQueryTable(
      String projectId,
      String bigQueryDatasetId,
      String bigQueryTableId,
      String topicId,
      String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the BigQuery table to be inspected.
      BigQueryTable tableReference =
          BigQueryTable.newBuilder()
              .setProjectId(projectId)
              .setDatasetId(bigQueryDatasetId)
              .setTableId(bigQueryTableId)
              .build();

      BigQueryOptions bigQueryOptions =
          BigQueryOptions.newBuilder().setTableReference(tableReference).build();

      StorageConfig storageConfig =
          StorageConfig.newBuilder().setBigQueryOptions(bigQueryOptions).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      List&lt;InfoType&gt; infoTypes =
          Stream.of("PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER")
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());

      // Specify how the content should be inspected.
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(infoTypes).setIncludeQuote(true).build();

      // Specify the action that is triggered when the job completes.
      String pubSubTopic = String.format("projects/%s/topics/%s", projectId, topicId);
      Action.PublishToPubSub publishToPubSub =
          Action.PublishToPubSub.newBuilder().setTopic(pubSubTopic).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the long running job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setStorageConfig(storageConfig)
              .setInspectConfig(inspectConfig)
              .addActions(action)
              .build();

      // Create the request for the job configured above.
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectJob(inspectJobConfig)
              .build();

      // Use the client to send the request.
      final DlpJob dlpJob = dlp.createDlpJob(createDlpJobRequest);
      System.out.println("Job created: " + dlpJob.getName());

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Get the latest state of the job from the service
      GetDlpJobRequest request = GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();
      DlpJob completedJob = dlp.getDlpJob(request);

      // Parse the response and process results.
      System.out.println("Job status: " + completedJob.getState());
      InspectDataSourceDetails.Result result = completedJob.getInspectDetails().getResult();
      System.out.println("Findings: ");
      for (InfoTypeStats infoTypeStat : result.getInfoTypeStatsList()) {
        System.out.print("\tInfo type: " + infoTypeStat.getInfoType().getName());
        System.out.println("\tCount: " + infoTypeStat.getCount());
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-inspect-bigquery-nodejs" track-metadata-position="dlp-inspect-bigquery" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-bigquery" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectBigQuery.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectBigQuery.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-bigquery" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-inspect-bigquery" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/inspectBigQuery.js" data-region-tag="dlp_inspect_bigquery" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/inspectBigQuery.js/HEAD/dlp_inspect_bigquery" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the table is stored under
// This may or (for public datasets) may not equal the calling project ID
// const dataProjectId = 'my-project';

// The ID of the dataset to inspect, e.g. 'my_dataset'
// const datasetId = 'my_dataset';

// The ID of the table to inspect, e.g. 'my_table'
// const tableId = 'my_table';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The customInfoTypes of information to match
// const customInfoTypes = [{ infoType: { name: 'DICT_TYPE' }, dictionary: { wordList: { words: ['foo', 'bar', 'baz']}}},
//   { infoType: { name: 'REGEX_TYPE' }, regex: {pattern: '\\(\\d{3}\\) \\d{3}-\\d{4}'}}];

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

async function inspectBigquery() {
  // Construct item to be inspected
  const storageItem = {
    bigQueryOptions: {
      tableReference: {
        projectId: dataProjectId,
        datasetId: datasetId,
        tableId: tableId,
      },
    },
  };

  // Construct request for creating an inspect job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectJob: {
      inspectConfig: {
        infoTypes: infoTypes,
        customInfoTypes: customInfoTypes,
        minLikelihood: minLikelihood,
        limits: {
          maxFindingsPerRequest: maxFindings,
        },
      },
      storageConfig: storageItem,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };

  // Run inspect-job creation request
  const [topicResponse] = await pubsub.topic(topicId).get();
  // Verify the Pub/Sub topic and listen for job notifications via an
  // existing subscription.
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  // Wait for DLP job to fully complete
  setTimeout(() =&gt; {
    console.log('Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  console.log(`Job ${job.name} status: ${job.state}`);

  const infoTypeStats = job.inspectDetails.result.infoTypeStats;
  if (infoTypeStats.length &gt; 0) {
    infoTypeStats.forEach(infoTypeStat =&gt; {
      console.log(
        `  Found ${infoTypeStat.count} instance(s) of infoType ${infoTypeStat.infoType.name}.`
      );
    });
  } else {
    console.log('No findings.');
  }
}

inspectBigquery();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-bigquery-python" track-metadata-position="dlp-inspect-bigquery" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-bigquery" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-bigquery" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-bigquery" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_bigquery" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_bigquery" translate="no"><code dir="ltr" translate="no">def inspect_bigquery(
    project,
    bigquery_project,
    dataset_id,
    table_id,
    topic_id,
    subscription_id,
    info_types,
    custom_dictionaries=None,
    custom_regexes=None,
    min_likelihood=None,
    max_findings=None,
    timeout=300,
):
    """Uses the Data Loss Prevention API to analyze BigQuery data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        bigquery_project: The Google Cloud project id of the target table.
        dataset_id: The id of the target BigQuery dataset.
        table_id: The id of the target BigQuery table.
        topic_id: The id of the Cloud Pub/Sub topic to which the API will
            broadcast job completion. The topic must already exist.
        subscription_id: The id of the Cloud Pub/Sub subscription to listen on
            while waiting for job completion. The subscription must already
            exist and be subscribed to the topic.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        namespace_id: The namespace of the Datastore document, if applicable.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        timeout: The number of seconds to wait for a response from the API.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    # This sample also uses threading.Event() to wait for the job to finish.
    import threading

    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    if not info_types:
        info_types = ["FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS"]
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "limits": {"max_findings_per_request": max_findings},
    }

    # Construct a storage_config containing the target Bigquery info.
    storage_config = {
        "big_query_options": {
            "table_reference": {
                "project_id": bigquery_project,
                "dataset_id": dataset_id,
                "table_id": table_id,
            }
        }
    }

    # Convert the project id into full resource ids.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Construct the inspect_job, which defines the entire inspect content task.
    inspect_job = {
        "inspect_config": inspect_config,
        "storage_config": storage_config,
        "actions": actions,
    }

    operation = dlp.create_dlp_job(
        request={"parent": parent, "inspect_job": inspect_job}
    )
    print("Inspection operation started: {}".format(operation.name))

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)

    # Set up a callback to acknowledge a message. This closes around an event
    # so that it can signal that it is done and the main thread can continue.
    job_done = threading.Event()

    def callback(message):
        try:
            if message.attributes["DlpJobName"] == operation.name:
                # This is the message we're looking for, so acknowledge it.
                message.ack()

                # Now that the job is done, fetch the results and print them.
                job = dlp.get_dlp_job(request={"name": operation.name})
                if job.inspect_details.result.info_type_stats:
                    for finding in job.inspect_details.result.info_type_stats:
                        print(
                            "Info type: {}; Count: {}".format(
                                finding.info_type.name, finding.count
                            )
                        )
                else:
                    print("No findings.")

                # Signal to the main thread that we can exit.
                job_done.set()
            else:
                # This is not the message we're looking for.
                message.drop()
        except Exception as e:
            # Because this is executing in a thread, an exception won't be
            # noted unless we print it manually.
            print(e)
            raise

    # Register the callback and wait on the event.
    subscriber.subscribe(subscription_path, callback=callback)
    finished = job_done.wait(timeout=timeout)
    if not finished:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-inspect-bigquery-go" track-metadata-position="dlp-inspect-bigquery" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-bigquery" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_bigquery.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_bigquery.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-bigquery" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-inspect-bigquery" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_bigquery.go" data-region-tag="dlp_inspect_bigquery" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_bigquery.go/HEAD/dlp_inspect_bigquery" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"strings"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// inspectBigquery searches for the given info types in the given Bigquery dataset table.
func inspectBigquery(w io.Writer, projectID string, infoTypeNames []string, customDictionaries []string, customRegexes []string, pubSubTopic, pubSubSub, dataProject, datasetID, tableID string) error {
	// projectID := "my-project-id"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// customDictionaries := []string{...}
	// customRegexes := []string{...}
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// dataProject := "my-data-project-ID"
	// datasetID := "my_dataset"
	// tableID := "mytable"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}

	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Convert the custom dictionary word lists and custom regexes to a list of CustomInfoTypes.
	var customInfoTypes []*dlppb.CustomInfoType
	for idx, it := range customDictionaries {
		customInfoTypes = append(customInfoTypes, &amp;dlppb.CustomInfoType{
			InfoType: &amp;dlppb.InfoType{
				Name: fmt.Sprintf("CUSTOM_DICTIONARY_%d", idx),
			},
			Type: &amp;dlppb.CustomInfoType_Dictionary_{
				Dictionary: &amp;dlppb.CustomInfoType_Dictionary{
					Source: &amp;dlppb.CustomInfoType_Dictionary_WordList_{
						WordList: &amp;dlppb.CustomInfoType_Dictionary_WordList{
							Words: strings.Split(it, ","),
						},
					},
				},
			},
		})
	}
	for idx, it := range customRegexes {
		customInfoTypes = append(customInfoTypes, &amp;dlppb.CustomInfoType{
			InfoType: &amp;dlppb.InfoType{
				Name: fmt.Sprintf("CUSTOM_REGEX_%d", idx),
			},
			Type: &amp;dlppb.CustomInfoType_Regex_{
				Regex: &amp;dlppb.CustomInfoType_Regex{
					Pattern: it,
				},
			},
		})
	}

	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("pubsub.NewClient: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	// Create the Topic if it doesn't exist.
	t := pubsubClient.Topic(pubSubTopic)
	if exists, err := t.Exists(ctx); err != nil {
		return fmt.Errorf("t.Exists: %v", err)
	} else if !exists {
		if t, err = pubsubClient.CreateTopic(ctx, pubSubTopic); err != nil {
			return fmt.Errorf("CreateTopic: %v", err)
		}
	}

	// Create the Subscription if it doesn't exist.
	s := pubsubClient.Subscription(pubSubSub)
	if exists, err := s.Exists(ctx); err != nil {
		return fmt.Errorf("s.Exits: %v", err)
	} else if !exists {
		if s, err = pubsubClient.CreateSubscription(ctx, pubSubSub, pubsub.SubscriptionConfig{Topic: t}); err != nil {
			return fmt.Errorf("CreateSubscription: %v", err)
		}
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_InspectJob{
			InspectJob: &amp;dlppb.InspectJobConfig{
				// StorageConfig describes where to find the data.
				StorageConfig: &amp;dlppb.StorageConfig{
					Type: &amp;dlppb.StorageConfig_BigQueryOptions{
						BigQueryOptions: &amp;dlppb.BigQueryOptions{
							TableReference: &amp;dlppb.BigQueryTable{
								ProjectId: dataProject,
								DatasetId: datasetID,
								TableId:   tableID,
							},
						},
					},
				},
				// InspectConfig describes what fields to look for.
				InspectConfig: &amp;dlppb.InspectConfig{
					InfoTypes:       infoTypes,
					CustomInfoTypes: customInfoTypes,
					MinLikelihood:   dlppb.Likelihood_POSSIBLE,
					Limits: &amp;dlppb.InspectConfig_FindingLimits{
						MaxFindingsPerRequest: 10,
					},
					IncludeQuote: true,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the inspect job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the inspect job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()

		// Stop listening for more messages.
		defer cancel()

		resp, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "Error getting completed job: %v\n", err)
			return
		}
		r := resp.GetInspectDetails().GetResult().GetInfoTypeStats()
		if len(r) == 0 {
			fmt.Fprintf(w, "No results")
			return
		}
		for _, s := range r {
			fmt.Fprintf(w, "  Found %v instances of infoType %v\n", s.GetCount(), s.GetInfoType().GetName())
		}
	})
	if err != nil {
		return fmt.Errorf("Receive: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-inspect-bigquery-php" track-metadata-position="dlp-inspect-bigquery" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-bigquery" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_bigquery.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_bigquery.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-bigquery" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-inspect-bigquery" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_bigquery.php" data-region-tag="dlp_inspect_bigquery" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_bigquery.php/HEAD/dlp_inspect_bigquery" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\BigQueryOptions;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\StorageConfig;
use Google\Cloud\Dlp\V2\BigQueryTable;
use Google\Cloud\Dlp\V2\Likelihood;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\InspectConfig\FindingLimits;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\InspectJobConfig;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Inspect a BigQuery table , using Pub/Sub for job status notifications.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $dataProjectId     The project ID containing the target Datastore
 * @param string $topicId           The name of the Pub/Sub topic to notify once the job completes
 * @param string $subscriptionId    The name of the Pub/Sub subscription to use when listening for job
 * @param string $datasetId         The ID of the dataset to inspect
 * @param string $tableId           The ID of the table to inspect
 * @param int    $maxFindings       (Optional) The maximum number of findings to report per request (0 = server maximum)
 */
function inspect_bigquery(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $datasetId,
    string $tableId,
    int $maxFindings = 0
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();
    $pubsub = new PubSubClient();
    $topic = $pubsub-&gt;topic($topicId);

    // The infoTypes of information to match
    $personNameInfoType = (new InfoType())
        -&gt;setName('PERSON_NAME');
    $creditCardNumberInfoType = (new InfoType())
        -&gt;setName('CREDIT_CARD_NUMBER');
    $infoTypes = [$personNameInfoType, $creditCardNumberInfoType];

    // The minimum likelihood required before returning a match
    $minLikelihood = likelihood::LIKELIHOOD_UNSPECIFIED;

    // Specify finding limits
    $limits = (new FindingLimits())
        -&gt;setMaxFindingsPerRequest($maxFindings);

    // Construct items to be inspected
    $bigqueryTable = (new BigQueryTable())
        -&gt;setProjectId($dataProjectId)
        -&gt;setDatasetId($datasetId)
        -&gt;setTableId($tableId);

    $bigQueryOptions = (new BigQueryOptions())
        -&gt;setTableReference($bigqueryTable);

    $storageConfig = (new StorageConfig())
        -&gt;setBigQueryOptions($bigQueryOptions);

    // Construct the inspect config object
    $inspectConfig = (new InspectConfig())
        -&gt;setMinLikelihood($minLikelihood)
        -&gt;setLimits($limits)
        -&gt;setInfoTypes($infoTypes);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct inspect job config to run
    $inspectJob = (new InspectJobConfig())
        -&gt;setInspectConfig($inspectConfig)
        -&gt;setStorageConfig($storageConfig)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'inspectJob' =&gt; $inspectJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $infoTypeStats = $job-&gt;getInspectDetails()-&gt;getResult()-&gt;getInfoTypeStats();
            if (count($infoTypeStats) === 0) {
                print('No findings.' . PHP_EOL);
            } else {
                foreach ($infoTypeStats as $infoTypeStat) {
                    printf(
                        '  Found %s instance(s) of infoType %s' . PHP_EOL,
                        $infoTypeStat-&gt;getCount(),
                        $infoTypeStat-&gt;getInfoType()-&gt;getName()
                    );
                }
            }
            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            printf('Unexpected job state. Most likely, the job is either running or has not yet started.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-inspect-bigquery-csharp" track-metadata-position="dlp-inspect-bigquery" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-bigquery" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectBigQuery.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectBigQuery.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-bigquery" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-inspect-bigquery" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectBigQuery.cs" data-region-tag="dlp_inspect_bigquery" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectBigQuery.cs/HEAD/dlp_inspect_bigquery" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.BigQuery.V2;
using Google.Cloud.Dlp.V2;
using Google.Protobuf.WellKnownTypes;
using System;
using System.Collections.Generic;
using System.Threading;
using static Google.Cloud.Dlp.V2.InspectConfig.Types;

public class InspectBigQuery
{
    public static object Inspect(
        string projectId,
        Likelihood minLikelihood,
        int maxFindings,
        bool includeQuote,
        IEnumerable&lt;FieldId&gt; identifyingFields,
        IEnumerable&lt;InfoType&gt; infoTypes,
        IEnumerable&lt;CustomInfoType&gt; customInfoTypes,
        string datasetId,
        string tableId)
    {
        var inspectJob = new InspectJobConfig
        {
            StorageConfig = new StorageConfig
            {
                BigQueryOptions = new BigQueryOptions
                {
                    TableReference = new Google.Cloud.Dlp.V2.BigQueryTable
                    {
                        ProjectId = projectId,
                        DatasetId = datasetId,
                        TableId = tableId,
                    },
                    IdentifyingFields =
                        {
                            identifyingFields
                        }
                },

                TimespanConfig = new StorageConfig.Types.TimespanConfig
                {
                    StartTime = Timestamp.FromDateTime(System.DateTime.UtcNow.AddYears(-1)),
                    EndTime = Timestamp.FromDateTime(System.DateTime.UtcNow)
                }
            },

            InspectConfig = new InspectConfig
            {
                InfoTypes = { infoTypes },
                CustomInfoTypes = { customInfoTypes },
                Limits = new FindingLimits
                {
                    MaxFindingsPerRequest = maxFindings
                },
                ExcludeInfoTypes = false,
                IncludeQuote = includeQuote,
                MinLikelihood = minLikelihood
            },
            Actions =
                {
                    new Google.Cloud.Dlp.V2.Action
                    {
                        // Save results in BigQuery Table
                        SaveFindings = new Google.Cloud.Dlp.V2.Action.Types.SaveFindings
                        {
                            OutputConfig = new OutputStorageConfig
                            {
                                Table = new Google.Cloud.Dlp.V2.BigQueryTable
                                {
                                    ProjectId = projectId,
                                    DatasetId = datasetId,
                                    TableId = tableId
                                }
                            }
                        },
                    }
                }
        };

        // Issue Create Dlp Job Request
        var client = DlpServiceClient.Create();
        var request = new CreateDlpJobRequest
        {
            InspectJob = inspectJob,
            Parent = new LocationName(projectId, "global").ToString(),
        };

        // We need created job name
        var dlpJob = client.CreateDlpJob(request);
        var jobName = dlpJob.Name;

        // Make sure the job finishes before inspecting the results.
        // Alternatively, we can inspect results opportunistically, but
        // for testing purposes, we want consistent outcome
        var finishedJob = EnsureJobFinishes(projectId, jobName);
        var bigQueryClient = BigQueryClient.Create(projectId);
        var table = bigQueryClient.GetTable(datasetId, tableId);

        // Return only first page of 10 rows
        Console.WriteLine("DLP v2 Results:");
        var firstPage = table.ListRows(new ListRowsOptions { StartIndex = 0, PageSize = 10 });
        foreach (var item in firstPage)
        {
            Console.WriteLine($"\t {item[""]}");
        }

        return finishedJob;
    }

    private static DlpJob EnsureJobFinishes(string projectId, string jobName)
    {
        var client = DlpServiceClient.Create();
        var request = new GetDlpJobRequest
        {
            DlpJobName = new DlpJobName(projectId, jobName),
        };

        // Simple logic that gives the job 5*30 sec at most to complete - for testing purposes only
        var numOfAttempts = 5;
        do
        {
            var dlpJob = client.GetDlpJob(request);
            numOfAttempts--;
            if (dlpJob.State != DlpJob.Types.JobState.Running)
            {
                return dlpJob;
            }

            Thread.Sleep(TimeSpan.FromSeconds(30));
        } while (numOfAttempts &gt; 0);

        throw new InvalidOperationException("Job did not complete in time");
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Configure storage inspection" id="configuring-storage-inspection">Configure storage inspection</h2>
<p>To inspect a Cloud Storage location, Datastore kind, or
BigQuery table, you send a request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create"><code dir="ltr" translate="no">projects.dlpJobs.create</code></a>
method of the DLP API that contains at least the location of
the data to scan and what to scan for. Beyond those required parameters, you can
also specify where to write the scan results, size and likelihood thresholds,
and more. A successful request results in the creation of a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>
object instance, which is discussed in "<a href="#retrieving-inspection-results">Retrieve inspection
results</a>."</p>
<p>The available configuration options are summarized here:</p>
<ul>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig"><code dir="ltr" translate="no">InspectJobConfig</code></a>
object: Contains the configuration information for the inspection job. Note
that the <code dir="ltr" translate="no">InspectJobConfig</code> object is also used by the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers"><code dir="ltr" translate="no">JobTriggers</code></a>
object for scheduling the creation of
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>s.
This object includes:</p>
<ul>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#StorageConfig"><code dir="ltr" translate="no">StorageConfig</code></a>
object: Required. Contains details about the storage repository to scan:</p>
<ul>
<li><p>One of the following must be included in the <code dir="ltr" translate="no">StorageConfig</code> object,
depending on the type of storage repository being scanned:</p></li>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#CloudStorageOptions"><code dir="ltr" translate="no">CloudStorageOptions</code></a>
object: Contains information about the Cloud Storage bucket to scan.</p></li>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#DatastoreOptions"><code dir="ltr" translate="no">DatastoreOptions</code></a>
object: Contains information about the Datastore data set to
scan.</p></li>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#BigQueryOptions"><code dir="ltr" translate="no">BigQueryOptions</code></a>
object: Contains information about the BigQuery table
(and, optionally, identifying fields) to scan. This object also
enables results sampling. For more information, see <a href="#sampling">Enabling results
sampling</a> below.</p></li>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#TimespanConfig"><code dir="ltr" translate="no">TimespanConfig</code></a>
object: Optional. Specifies the timespan of the items to include in the
scan.</p></li>
</ul></li>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
object: Required. Specifies what to scan for, such as
<a href="/dlp/docs/concepts-infotypes">infoTypes</a> and <a href="/dlp/docs/likelihood">likelihood</a>Â values.</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/InfoType"><code dir="ltr" translate="no">InfoType</code></a> objects:
Required. One or more <a href="/dlp/docs/infotypes-reference">infoType</a>  values to scan
for.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectConfig#Likelihood"><code dir="ltr" translate="no">Likelihood</code></a>
enumeration: Optional. When set, Cloud DLP will only
return findings equal to or above this <a href="/dlp/docs/likelihood">likelihood</a>
threshold. If this enum is omitted, the default value is <code dir="ltr" translate="no">POSSIBLE</code>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectConfig#FindingLimits"><code dir="ltr" translate="no">FindingLimits</code></a>
object: Optional. When set, this object enables you to specify a limit
for the number of findings returned.</li>
<li><code dir="ltr" translate="no">includeQuote</code> parameter: Optional. Defaults to <code dir="ltr" translate="no">false</code>. When set to
<code dir="ltr" translate="no">true</code>, each finding will include a contextual quote from the data that
triggered it.</li>
<li><code dir="ltr" translate="no">excludeInfoTypes</code> parameter: Optional. Defaults to <code dir="ltr" translate="no">false</code>. When set to
<code dir="ltr" translate="no">true</code>, scan results will exclude type information for the findings.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType"><code dir="ltr" translate="no">CustomInfoType</code></a>
objects: One or more custom, user-created infoTypes. For more
information about creating custom infoTypes, see <a href="/dlp/docs/creating-custom-infotypes">Creating custom
infoType detectors</a>.</li>
</ul></li>
<li><p><code dir="ltr" translate="no">inspectTemplateName</code> string: Optional. Specifies a template to
use to populate default values in the
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a> object.
If you've already specified <code dir="ltr" translate="no">InspectConfig</code>, template values will be
merged in.</p></li>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>
objects: Optional. One or more actions to execute at the completion of
the job. Each action is executed in the order in which they're listed.
This is where you specify where to write results, or whether to
publish a notification to a Pub/Sub topic.</p></li>
</ul></li>
<li><p><code dir="ltr" translate="no">jobId</code>: Optional. An identifier for the job returned by
Cloud DLP. If <code dir="ltr" translate="no">jobId</code> is omitted or empty, the system
creates an ID for the job. If specified, the job is assigned this ID value.
The job ID must be unique, and can contain uppercase and lowercase letters,
numbers, and hyphens; that is, it must match the following regular
expression: <code dir="ltr" translate="no">[a-zA-Z\\d-]+</code>.</p></li>
</ul>
<h2 data-text="Limit the amount of content inspected" id="sampling">Limit the amount of content inspected</h2>
<p>If you are scanning BigQuery tables or Cloud Storage
buckets, Cloud DLP includes a way to scan a subset of the
dataset. This has the effect of providing a sampling of scan results without
incurring the potential costs of scanning an entire dataset.</p>
<p>The following sections contain information about limiting the size of both
<a href="#limiting-gcs">Cloud Storage scans</a> and <a href="#limiting-bq">BigQuery
scans</a>.</p>
<h3 data-text="Limit Cloud Storage scans" id="limiting-gcs">Limit Cloud Storage scans</h3>
<p>You can enable sampling in Cloud Storage by limiting the amount of
data that is scanned. You can instruct the DLP API to scan
only files under a certain size, only certain file types, and only a certain
percentage of the total number of files in the input file set. To do so, specify
the following optional fields within
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#CloudStorageOptions"><code dir="ltr" translate="no">CloudStorageOptions</code></a>:</p>
<ul>
<li><code dir="ltr" translate="no">bytesLimitPerFile</code>: Sets the maximum number of bytes to scan from a file.
If a scanned file's size is larger than this value, the rest of the bytes
are omitted.</li>
<li><code dir="ltr" translate="no">fileTypes[]</code>: Lists the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#FileType"><code dir="ltr" translate="no">FileTypes</code></a> to
include in the scan. This can be set to one or more of the following
<a href="/dlp/docs/supported-file-types">enumerated types</a>.</li>
<li><code dir="ltr" translate="no">filesLimitPercent</code>: Limits the number of files to scan to the specified
percentage of the input
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#fileset"><code dir="ltr" translate="no">FileSet</code></a>.
Specifying either <code dir="ltr" translate="no">0</code> or <code dir="ltr" translate="no">100</code> here indicates there is no limit.</li>
<li><code dir="ltr" translate="no">sampleMethod</code>: How to sample bytes if not all bytes are scanned. Specifying
this value is meaningful only when used in conjunction with
<code dir="ltr" translate="no">bytesLimitPerFile</code>. If not specified, scanning starts from the top. This
field can be set to one of two values:
<ul>
<li><code dir="ltr" translate="no">TOP</code>: Scanning starts from the top.</li>
<li><code dir="ltr" translate="no">RANDOM_START</code>: For each file larger than the size specified in
<code dir="ltr" translate="no">bytesLimitPerFile</code>, randomly pick the offset to start scanning. The
scanned bytes are contiguous.</li>
</ul></li>
</ul>
<aside class="note"><strong>Note:</strong><span> Due to the need to scan the entire image for sensitive data, sampling is
not supported for image file types. Any images scanned will be billed according
to the size of the image file.</span></aside>
<p>The following examples demonstrate using the DLP API to
scan a 90% subset of a Cloud Storage bucket for person names. The scan
starts from a random location in the dataset, and only includes text files under
200 bytes.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_gcs_with_sampling-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_gcs_with_sampling-protocol" track-metadata-position="dlp_inspect_gcs_with_sampling" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs?key={YOUR_API_KEY}

{
  "inspectJob":{
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://[BUCKET-NAME]/*"
        },
        "bytesLimitPerFile":"200",
        "fileTypes":[
          "TEXT_FILE"
        ],
        "filesLimitPercent":90,
        "sampleMethod":"RANDOM_START"
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PERSON_NAME"
        }
      ],
      "excludeInfoTypes":true,
      "includeQuote":true,
      "minLikelihood":"POSSIBLE"
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT-ID]",
              "datasetId":"testingdlp"
            },
            "outputSchema":"BASIC_COLUMNS"
          }
        }
      }
    ]
  }
}
</code></pre>
<p>After sending the JSON input in a POST request to the specified endpoint, a
Cloud DLP job is created, and the API sends the following response.</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT-ID]/dlpJobs/[JOB-ID]",
  "type":"INSPECT_JOB",
  "state":"PENDING",
  "inspectDetails":{
    "requestedOptions":{
      "snapshotInspectTemplate":{

      },
      "jobConfig":{
        "storageConfig":{
          "cloudStorageOptions":{
            "fileSet":{
              "url":"gs://[BUCKET_NAME]/*"
            },
            "bytesLimitPerFile":"200",
            "fileTypes":[
              "TEXT_FILE"
            ],
            "sampleMethod":"TOP",
            "filesLimitPercent":90
          }
        },
        "inspectConfig":{
          "infoTypes":[
            {
              "name":"PERSON_NAME"
            }
          ],
          "minLikelihood":"POSSIBLE",
          "limits":{

          },
          "includeQuote":true,
          "excludeInfoTypes":true
        },
        "actions":[
          {
            "saveFindings":{
              "outputConfig":{
                "table":{
                  "projectId":"[PROJECT-ID]",
                  "datasetId":"[DATASET-ID]",
                  "tableId":"[TABLE-ID]"
                },
                "outputSchema":"BASIC_COLUMNS"
              }
            }
          }
        ]
      }
    }
  },
  "createTime":"2018-05-30T22:22:08.279Z"
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_gcs_with_sampling-java" track-metadata-position="dlp_inspect_gcs_with_sampling" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_gcs_with_sampling" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectGcsFileWithSampling.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectGcsFileWithSampling.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_gcs_with_sampling" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_gcs_with_sampling" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectGcsFileWithSampling.java" data-region-tag="dlp_inspect_gcs_with_sampling" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectGcsFileWithSampling.java/HEAD/dlp_inspect_gcs_with_sampling" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.CloudStorageOptions;
import com.google.privacy.dlp.v2.CloudStorageOptions.FileSet;
import com.google.privacy.dlp.v2.CloudStorageOptions.SampleMethod;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FileType;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeStats;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectDataSourceDetails;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

public class InspectGcsFileWithSampling {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String gcsUri = "gs://" + "your-bucket-name" + "/path/to/your/file.txt";
    String topicId = "your-pubsub-topic-id";
    String subscriptionId = "your-pubsub-subscription-id";
    inspectGcsFileWithSampling(projectId, gcsUri, topicId, subscriptionId);
  }

  // Inspects a file in a Google Cloud Storage Bucket.
  public static void inspectGcsFileWithSampling(
      String projectId, String gcsUri, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the GCS file to be inspected and sampling configuration
      CloudStorageOptions cloudStorageOptions =
          CloudStorageOptions.newBuilder()
              .setFileSet(FileSet.newBuilder().setUrl(gcsUri))
              .setBytesLimitPerFile(200)
              .addFileTypes(FileType.TEXT_FILE)
              .setFilesLimitPercent(90)
              .setSampleMethod(SampleMethod.RANDOM_START)
              .build();

      StorageConfig storageConfig =
          StorageConfig.newBuilder().setCloudStorageOptions(cloudStorageOptions).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("PERSON_NAME").build();

      // Specify how the content should be inspected.
      InspectConfig inspectConfig =
          InspectConfig.newBuilder()
              .addInfoTypes(infoType)
              .setExcludeInfoTypes(true)
              .setIncludeQuote(true)
              .setMinLikelihood(Likelihood.POSSIBLE)
              .build();

      // Specify the action that is triggered when the job completes.
      String pubSubTopic = String.format("projects/%s/topics/%s", projectId, topicId);
      Action.PublishToPubSub publishToPubSub =
          Action.PublishToPubSub.newBuilder().setTopic(pubSubTopic).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the long running job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setStorageConfig(storageConfig)
              .setInspectConfig(inspectConfig)
              .addActions(action)
              .build();

      // Create the request for the job configured above.
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectJob(inspectJobConfig)
              .build();

      // Use the client to send the request.
      final DlpJob dlpJob = dlp.createDlpJob(createDlpJobRequest);
      System.out.println("Job created: " + dlpJob.getName());

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Get the latest state of the job from the service
      GetDlpJobRequest request = GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();
      DlpJob completedJob = dlp.getDlpJob(request);

      // Parse the response and process results.
      System.out.println("Job status: " + completedJob.getState());
      InspectDataSourceDetails.Result result = completedJob.getInspectDetails().getResult();
      System.out.println("Findings: ");
      for (InfoTypeStats infoTypeStat : result.getInfoTypeStatsList()) {
        System.out.print("\tInfo type: " + infoTypeStat.getInfoType().getName());
        System.out.println("\tCount: " + infoTypeStat.getCount());
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
</div>
<h3 data-text="Limit BigQuery scans" id="limiting-bq">Limit BigQuery scans</h3>
<p>To enable sampling in BigQuery by limiting the amount of
data that is scanned, specify the following optional fields within
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#BigQueryOptions"><code dir="ltr" translate="no">BigQueryOptions</code></a>:</p>
<ul>
<li><code dir="ltr" translate="no">rowsLimit</code>: The maximum number of rows to scan. If the table has more rows
than this value, the rest of the rows are omitted. If not set, or if set to
0, all rows will be scanned.</li>
<li><code dir="ltr" translate="no">sampleMethod</code>: How to sample rows if not all rows are scanned. If not
specified, scanning starts from the top. This field can be set to one of
two values:
<ul>
<li><code dir="ltr" translate="no">TOP</code>: Scanning starts from the top.</li>
<li><code dir="ltr" translate="no">RANDOM_START</code>: Scanning starts from a randomly selected row.</li>
</ul></li>
<li><code dir="ltr" translate="no">excludedFields</code>: Exclude certain columns from being read. This can help
 reduce the amount of data scanned and bring down the overall cost of
 an inspection job.</li>
</ul>
<p>Another feature that is useful for limiting the data being scanned, particularly
when scanning partitioned tables, is
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#TimespanConfig"><code dir="ltr" translate="no">TimespanConfig</code></a>.
<code dir="ltr" translate="no">TimespanConfig</code> allows you to filter out BigQuery table rows by
providing start and end time values to define a timespan. Cloud DLP
then only scans rows that contain a timestamp within that timespan.</p>
<p>The following examples demonstrate using the DLP API to
scan a 1000-row subset of a BigQuery table. The scan starts from
a random row.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_bigquery_with_sampling-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_bigquery_with_sampling-protocol" track-metadata-position="dlp_inspect_bigquery_with_sampling" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs?key={YOUR_API_KEY}

{
  "inspectJob":{
    "storageConfig":{
      "bigQueryOptions":{
        "tableReference":{
          "projectId":"bigquery-public-data",
          "datasetId":"usa_names",
          "tableId":"usa_1910_current"
        },
        "rowsLimit":"1000",
        "sampleMethod":"RANDOM_START",
        "identifyingFields":[
          {
            "name":"name"
          }
        ]
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"FIRST_NAME"
        }
      ],
      "includeQuote":true
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT-ID]",
              "datasetId":"testingdlp",
              "tableId":"bqsample3"
            },
            "outputSchema":"BASIC_COLUMNS"
          }
        }
      }
    ]
  }
}
</code></pre>
<p>After sending the JSON input in a POST request to the specified endpoint, a
Cloud DLP job is created, and the API sends the following response.</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT-ID]/dlpJobs/[JOB-ID]",
  "type":"INSPECT_JOB",
  "state":"PENDING",
  "inspectDetails":{
    "requestedOptions":{
      "snapshotInspectTemplate":{

      },
      "jobConfig":{
        "storageConfig":{
          "bigQueryOptions":{
            "tableReference":{
              "projectId":"bigquery-public-data",
              "datasetId":"usa_names",
              "tableId":"usa_1910_current"
            },
            "rowsLimit":"1000",
            "sampleMethod":"RANDOM_START"
          }
        },
        "inspectConfig":{
          "infoTypes":[
            {
              "name":"FIRST_NAME"
            }
          ],
          "minLikelihood":"POSSIBLE",
          "limits":{

          },
          "includeQuote":true
        },
        "actions":[
          {
            "saveFindings":{
              "outputConfig":{
                "table":{
                  "projectId":"[PROJECT-ID]",
                  "datasetId":"testingdlp",
                  "tableId":"bqsample3"
                },
                "outputSchema":"BASIC_COLUMNS"
              }
            }
          }
        ]
      }
    }
  },
  "createTime":"2018-05-25T21:02:50.655Z"
}
</code></pre>
<p>When the inspect job finishes running and its results have been processed by
BigQuery, the results of the scan are available in the
specified BigQuery output table. For more information about
retrieving inspection results, see <a href="#retrieving-inspection-results">the next
section</a>.</p>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_bigquery_with_sampling-java" track-metadata-position="dlp_inspect_bigquery_with_sampling" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_bigquery_with_sampling" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTableWithSampling.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTableWithSampling.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_bigquery_with_sampling" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_bigquery_with_sampling" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTableWithSampling.java" data-region-tag="dlp_inspect_bigquery_with_sampling" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectBigQueryTableWithSampling.java/HEAD/dlp_inspect_bigquery_with_sampling" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.BigQueryOptions;
import com.google.privacy.dlp.v2.BigQueryOptions.SampleMethod;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeStats;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectDataSourceDetails;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

public class InspectBigQueryTableWithSampling {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String topicId = "your-pubsub-topic-id";
    String subscriptionId = "your-pubsub-subscription-id";
    inspectBigQueryTableWithSampling(projectId, topicId, subscriptionId);
  }

  // Inspects a BigQuery Table
  public static void inspectBigQueryTableWithSampling(
      String projectId, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the BigQuery table to be inspected.
      BigQueryTable tableReference =
          BigQueryTable.newBuilder()
              .setProjectId("bigquery-public-data")
              .setDatasetId("usa_names")
              .setTableId("usa_1910_current")
              .build();

      BigQueryOptions bigQueryOptions =
          BigQueryOptions.newBuilder()
              .setTableReference(tableReference)
              .setRowsLimit(1000)
              .setSampleMethod(SampleMethod.RANDOM_START)
              .addIdentifyingFields(FieldId.newBuilder().setName("name"))
              .build();

      StorageConfig storageConfig =
          StorageConfig.newBuilder().setBigQueryOptions(bigQueryOptions).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("PERSON_NAME").build();

      // Specify how the content should be inspected.
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addInfoTypes(infoType).setIncludeQuote(true).build();

      // Specify the action that is triggered when the job completes.
      String pubSubTopic = String.format("projects/%s/topics/%s", projectId, topicId);
      Action.PublishToPubSub publishToPubSub =
          Action.PublishToPubSub.newBuilder().setTopic(pubSubTopic).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the long running job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setStorageConfig(storageConfig)
              .setInspectConfig(inspectConfig)
              .addActions(action)
              .build();

      // Create the request for the job configured above.
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectJob(inspectJobConfig)
              .build();

      // Use the client to send the request.
      final DlpJob dlpJob = dlp.createDlpJob(createDlpJobRequest);
      System.out.println("Job created: " + dlpJob.getName());

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Get the latest state of the job from the service
      GetDlpJobRequest request = GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();
      DlpJob completedJob = dlp.getDlpJob(request);

      // Parse the response and process results.
      System.out.println("Job status: " + completedJob.getState());
      InspectDataSourceDetails.Result result = completedJob.getInspectDetails().getResult();
      System.out.println("Findings: ");
      for (InfoTypeStats infoTypeStat : result.getInfoTypeStatsList()) {
        System.out.print("\tInfo type: " + infoTypeStat.getInfoType().getName());
        System.out.println("\tCount: " + infoTypeStat.getCount());
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Retrieve inspection results" id="retrieving-inspection-results">Retrieve inspection results</h2>
<aside class="note"><strong>Note:</strong><span> This section describes how to view inspection results using the
DLP API. To view results using Cloud DLP in the
Cloud console, click the <strong>Jobs &amp; job triggers</strong> tab, click
the <strong>All jobs</strong> tab, and then click the job you want to view results for.</span></aside>
<p>You can retrieve a summary of a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a> using the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs.get</code></a>
method. The returned <code dir="ltr" translate="no">DlpJob</code> includes its
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#inspectdatasourcedetails"><code dir="ltr" translate="no">InspectDataSourceDetails</code></a>
object, which contains both a summary of the job's configuration
(<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#requestedoptions"><code dir="ltr" translate="no">RequestedOptions</code></a>)
and a summary of the outcome of the job
(<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#result"><code dir="ltr" translate="no">Result</code></a>).
The outcome summary includes:</p>
<ul>
<li><code dir="ltr" translate="no">processedBytes</code>: The total size in bytes that have been processed.</li>
<li><code dir="ltr" translate="no">totalEstimatedBytes</code>: Estimate of the number of bytes remaining to process.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.InfoTypeStats"><code dir="ltr" translate="no">InfoTypeStatistics</code></a>
object: Statistics of how many instances of each infoType were found during
the inspection job.</li>
</ul>
<p>For complete inspection job results, you have two options. Depending on the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>
you've chosen, inspection jobs are:</p>
<ul>
<li>Saved to BigQuery (the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#SaveFindings"><code dir="ltr" translate="no">SaveFindings</code></a>
object) in the table specified. Before viewing or analyzing the results,
first ensure that the job has completed by using the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs.get</code></a>
method, which is described below. Note that you can specify a schema for
storing findings using the
<a href="/dlp/docs/reference/rest/v2/Action#OutputSchema"><code dir="ltr" translate="no">OutputSchema</code></a>
object.</li>
<li>Published to a <a href="/pubsub">Pub/Sub</a> topic (the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToPubSub"><code dir="ltr" translate="no">PublishToPubSub</code></a> object). The
topic must have given publishing access rights to Cloud DLP
service account that runs the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a> sending
the notifications.</li>
</ul>
<p>To help sift through large amounts of data generated by Cloud DLP,
you can use built-in BigQuery tools to run rich SQL analytics or
tools such as Google Data Studio to generate reports. For more information,
see <a href="/dlp/docs/analyzing-and-reporting">Analyzing and reporting on Cloud DLP
findings</a>. For some sample queries, see <a href="/dlp/docs/querying-findings">Querying
findings in BigQuery</a>.</p>
<p>Sending a storage repository inspection request to Cloud DLP
creates and runs a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>
object instance in response. These jobs can take seconds, minutes, or hours to
run depending on the size of your data and the configuration that you have
specified. Choosing to publish to a Pub/Sub topic (by specifying
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToPubSub"><code dir="ltr" translate="no">PublishToPubSub</code></a>
in <a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>)
automatically sends notifications to the topic with the specified name when the
job's status changes. The name of the Pub/Sub topic is specified
in the form <code dir="ltr" translate="no">projects/[PROJECT-ID]/topics/[PUBSUB-TOPIC-NAME]</code>.</p>
<aside class="note"><strong>Note:</strong><span> For more information about how to create a Pub/Sub
function, see
<a href="/functions/docs/tutorials/pubsub">Pub/Sub tutorial</a>.</span></aside>
<p>You have full control over the jobs you create, including the following
management methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/cancel"><code dir="ltr" translate="no">projects.dlpJobs.cancel</code></a>
method: Stops a job that is currently in progress. The server makes a best
effort to cancel the job, but success is not guaranteed.Â The job and its
configuration will remain until you delete it (with .</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/delete"><code dir="ltr" translate="no">projects.dlpJobs.delete</code></a>
method: Deletes a job and its configuration.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs.get</code></a>
method: Retrieves a single job and returns its status, its configuration,
and, if the job is done, summary results.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs.list</code></a>
method: Retrieves a list of all jobs, and includes the ability to filter
results.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/how-to-hybrid-jobs]</H1></p><div class="devsite-article-body clearfix">
<p>Hybrid jobs and job triggers enable you to broaden the scope of protection that
Cloud DLP provides beyond <a href="/dlp/docs/inspecting-text">simple content inspection
requests</a> and <a href="/dlp/docs/inspecting-storage">Google Cloud storage repository
scanning</a>. Using hybrid jobs and job triggers, you
can stream data from virtually any sourceâincluding outside
Google Cloudâdirectly to Cloud DLP, and let
Cloud DLP inspect the data for sensitive information and
automatically save and aggregate the scan results for further analysis.</p>
<p>Hybrid jobs run as soon as they are created until you stop them. They accept
all incoming data as long as it is properly <a href="#endpoints">routed</a> and
<a href="#formatting">formatted</a>. Hybrid job triggers work in a similar manner to hybrid
jobs, but they enable you to stop and start new jobs within the trigger without
having to change where your inspection requests are sent to. For example, you
can send data to the hybrid trigger name, then stop the active job, change
its configuration, start a new job within that trigger, and then continue to
send data to the same hybrid trigger name.</p>
<p>This topic describes how to use hybrid jobs and job triggers to inspect data for
sensitive information. To learn more about hybrid jobs and job
triggersâincluding examples of hybrid environments and usage
scenariosâsee the conceptual topic <a href="/dlp/docs/concepts-hybrid-jobs">Hybrid jobs and job
triggers</a>.</p>
<h2 data-text="Hybrid inspection process" id="hybrid_inspection_process">Hybrid inspection process</h2>
<p>The remainder of this topic describes how to set up Cloud DLP to
carry out the following process. There are three distinct steps in the hybrid
inspection process, as illustrated in the following diagram. The legend that
follows the diagram explains each step in detail.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/how-to-hybrid-jobs.png">
<img alt="Diagram depicting the hybrid job inspection process" src="/dlp/docs/images/how-to-hybrid-jobs.png" width="570">
</img></a></figure>
<ol>
<li>First, choose the data you want to send to Cloud DLP. The data
can originate from within Google Cloud or outside it. For example, you can
configure a custom script or application to send data to
Cloud DLP, enabling you to inspect data in flight, from another
cloud service, an on-premises data repository, or virtually any other data
source. Data sent to Cloud DLP should include metadata (also
referred to as "labels" and "table identifiers") that describes the content
and enables Cloud DLP to identify the information you want to
track. For example, if you're scanning related data across several requests
(such as rows in the same database table), you could make this metadata the
same so that you can collect, tally, and analyze findings for that database
table together.</li>
<li>Next, set up a hybrid job or job trigger in Cloud DLP from
scratch or using <a href="/dlp/docs/creating-templates-inspect">an inspection
template</a>. Once you set up a hybrid job
or trigger, Cloud DLP actively listens for data sent to it. When
your custom script or application sends data to this hybrid job or trigger,
the data will be inspected and its results stored according to the
configuration.</li>
<li>When you set up the hybrid job, you can specify where you want to save or
publish the findings. Options include saving to BigQuery and
publishing notifications to Pub/Sub, Cloud Monitoring, or email.
As the hybrid job runs and inspects requests, inspection results are
available as soon as Cloud DLP generates them, while actions
like Pub/Sub notifications won't occur until the hybrid job is
ended by your application.</li>
</ol>
<h2 data-text="Types of metadata you can provide" id="types">Types of metadata you can provide</h2>
<p>Following are the types of metadata <a href="#choose-input-data">you can provide</a> when
sending your data to Cloud DLP. For more information about how to
format your hybrid data, see <a href="#sending-data">Sending data to the hybrid job
trigger</a>, later in this topic.</p>
<h3 data-text="Container details" id="container_details">Container details</h3>
<p>Every request can specify details about the data source, including elements like
<code dir="ltr" translate="no">fullPath</code>, <code dir="ltr" translate="no">rootPath</code>, <code dir="ltr" translate="no">relativePath</code>, <code dir="ltr" translate="no">type</code>, <code dir="ltr" translate="no">version</code>, and others. For
example, if you were scanning tables in a database you might set these as
follows:</p>
<ul>
<li><code dir="ltr" translate="no">fullPath: "10.0.0.20/database1/table1"</code></li>
<li><code dir="ltr" translate="no">rootPath: "10.0.0.20/database1"</code></li>
<li><code dir="ltr" translate="no">relativePath: "table1"</code></li>
<li><code dir="ltr" translate="no">type: "postgres"</code></li>
<li><code dir="ltr" translate="no">version: "9.6"</code></li>
</ul>
<h3 data-text="Additional required labels" id="additional_required_labels">Additional required labels</h3>
<p>You can provide key/value labels with each request to track additional metadata
not captured in container details. You can specify the labels in the hybrid job
or in each request, and Cloud DLP saves the metadata with each
finding. The hybrid job can also optionally specify a list of required label
"keys" that must be included. Any requests for that job that don't include these
required labels are rejected.</p>
<h3 data-text="Optional labels" id="optional_labels">Optional labels</h3>
<p>In each request you can optionally specify additional labels that will be
associated with any findings in that request.  Using this method allows you to
have different labels with each request if needed. Alternatively, if you'd like
to associate the same key and value with every request, then you can specify
those as well when creating the hybrid job. For example, if you wanted every
request to have the label <code dir="ltr" translate="no">"env"="prod"</code> you could specify this when creating
the hybrid job.</p>
<h3 data-text="Tabular data options" id="tabular_data_options">Tabular data options</h3>
<p>Finally, you can specify any columns that are row identifiers for table objects
in your data. If the specified columns exist in the table, the value for the
given cells will be included alongside each finding so you can trace the finding
to the row it came from. These tabular options will only apply to requests that
send tabular data such as an <code dir="ltr" translate="no">item.table</code> or
<a href="/dlp/docs/reference/rest/v2/ByteContentItem"><code dir="ltr" translate="no">byteItem</code></a> formats
like CSV.</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Before setting up and using hybrid job triggers and hybrid job resources, be
sure you've done the following:</p>
<h3 data-text="Create a new project, enable billing, and enable Cloud DLP" id="create_a_new_project_enable_billing_and_enable">Create a new project, enable billing, and enable Cloud DLP</h3>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
<li>
<p>
        
          
            
              Enable the Cloud DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
</li>
</ol>
<h3 data-text="Configure the data source" id="configure_the_data_source">Configure the data source</h3>
<p>Before Cloud DLP can inspect your data, you must send the data to
Cloud DLP. Regardless of what method you use to configure the
inspection (Cloud DLP in Google Cloud console, the DLP API,
or a <a href="/dlp/docs/libraries">client library</a>), you must set up your external
source to send data to the DLP API.</p>
<p>For more information about the types of metadata that you can include with the
data in your request, see <a href="#types">Types of metadata you can provide</a>, above.
The following section describes how to specify this metadata to
Cloud DLP.</p>
<h2 data-text="Hybrid job or job trigger setup" id="hybrid_job_or_job_trigger_setup">Hybrid job or job trigger setup</h2>
<p>To enable Cloud DLP to inspect the data you'll be sending to it,
you must first set up a hybrid job or job trigger.</p>
<p>To set up a new hybrid job or job trigger:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>From the <strong>Create</strong> menu, point to <strong>Job or job trigger</strong>, and then choose
<strong>Inspection</strong>.</p>
<p><img alt="Screenshot of Create new job or job trigger menu choice." class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p>
<p>Alternatively, click the following button:</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/job;source=7" target="console">Create new job trigger</a> </p></li>
</ol>
<h3 data-text="Choose input data" id="choose-input-data">Choose input data</h3>
<p>In this section, you specify the input data for Cloud DLP to
inspect.</p>
<ol>
<li>Under <strong>Name</strong>, optionally name the job by entering a value in the
<strong>Job ID</strong> field. (Leaving this field blank causes Cloud DLP
to auto-generate an identifier.)</li>
<li>From the <strong>Resource location</strong> menu, choose a region, if desired. For
more information, see <a href="/dlp/docs/specifying-location">Specifying processing
locations</a>.</li>
<li>Under <strong>Location</strong>, choose <strong>Hybrid</strong> from the <strong>Storage type</strong> menu.
You can also optionally enter a <strong>Description</strong> for the job.</li>
</ol>
<h3 data-text="Configure detection" id="configure_detection">Configure detection</h3>
<p>In this section, you specify the types of sensitive data that
Cloud DLP will inspect the input data for. Your choices are:</p>
<ul>
<li><strong>Template</strong>: If you've already <a href="/dlp/docs/creating-templates-inspect">created a
template</a> in the current project
that you want to use to define the Cloud DLP detection
parameters, click the <strong>Template name</strong> field, and then choose the template
from the list that appears.</li>
<li><strong>InfoTypes</strong>: Cloud DLP selects the most common
built-in infoTypes to detect. To change these, or to choose a custom
infoType to use, click <strong>Manage infoTypes</strong>. You can also fine-tune the
detection criteria in the <strong>Inspection rulesets</strong> and <strong>Confidence
threshold</strong> sections. For more details, see <a href="/dlp/docs/creating-job-triggers#configure-detection">Configure
detection</a>.</li>
</ul>
<p>When you're done configuring detection parameters, click <strong>Next</strong>.</p>
<h3 data-text="Add actions" id="add_actions">Add actions</h3>
<p>This section is where you specify where to save the findings from each
inspection scan and whether to be notified by email or Pub/Sub
notification message whenever a scan has completed. It's important to note
that, if you don't save findings to
BigQuery, the job resource will only contain statistics
about the number and infoTypes of the findings.</p>
<ul>
<li><strong>Save to BigQuery</strong>: Every time a scan runs,
Cloud DLP saves scan findings to the BigQuery
table you specify here. If you don't specify a table ID,
BigQuery will assign a default name to a new table the first
time the scan runs. If you specify an existing table,
Cloud DLP appends scan findings to it.</li>
<li><strong>Publish to Pub/Sub</strong>: When a job is done, a
Pub/Sub message will be emitted.</li>
<li><strong>Notify by email</strong>: When a job is done, an email message will be sent.</li>
<li><strong>Publish to Cloud Monitoring</strong>: When a job is done, its findings will
be published to Monitoring.</li>
</ul>
<p>When you're done choosing actions, click <strong>Next</strong>.</p>
<h3 data-text="Time span or schedule" id="time_span_or_schedule">Time span or schedule</h3>
<p>This section is where you specify whether to create a single job that runs
imemediately or a job trigger that runs every time properly routed and
formatted data is received by Cloud DLP.</p>
<p>To run the hybrid job immediately, choose <strong>None (run the one-off job
immediately upon creation)</strong>. To configure the job so that data received from
the source triggers the job, choose <strong>Create a trigger to run the job on a
periodic schedule</strong>. Hybrid data source-triggered jobs aggregate API calls,
allowing you to see finding results and trends over time.</p>
<h3 data-text="Review" id="review">Review</h3>
<p>You can review a JSON summary of the scan here. Be sure to note the name of the
job or job trigger; you'll need this information when sending data to
Cloud DLP for inspection. For more information on the format of
data sent to Cloud DLP, see <a href="#sending-data">Sending data to the hybrid job
trigger</a>.</p>
<p>When you're done, click <strong>Create</strong>. Cloud DLP starts the hybrid job
immediately. An inspection scan is triggered as soon as Cloud DLP
receives data.</p>
<h2 data-text="Sending data to the hybrid job or job trigger" id="sending-data">Sending data to the hybrid job or job trigger</h2>
<p>For data to be inspected using a hybrid job or job trigger, it must be formatted
in a specific way and sent to the correct endpoint.</p>
<h3 data-text="Hybrid content item formatting" id="formatting">Hybrid content item formatting</h3>
<p>Following is a simple example of a request sent to Cloud DLP for
processing by a hybrid job. Note the structure of the JSON object, including
the <code dir="ltr" translate="no">"hybridItem"</code> attribute, inside which are nested these attributes:</p>
<ul>
<li><code dir="ltr" translate="no">"item"</code>: Contains the actual content to inspect.</li>
<li><code dir="ltr" translate="no">"findingDetails"</code>: Contains metadata to associate with the content.</li>
</ul>
<pre dir="ltr" translate="no">{
  "hybridItem": {
    "item": {
      "value": "My email is test@example.org"
    },
    "findingDetails": {
      "containerDetails": {
        "fullPath": "10.0.0.2:logs1:app1",
        "relativePath": "app1",
        "rootPath": "10.0.0.2:logs1",
        "type": "logging_sys",
        "version": "1.2"
      },
      "labels": {
        "env": "prod"
      }
    }
  }
}</pre>
<p>For comprehensive information about the contents of hybrid inspection items,
see the API reference content for the <a href="/dlp/docs/reference/rest/v2/HybridContentItem"><code dir="ltr" translate="no">HybridContentItem</code>
object</a>.</p>
<h3 data-text="Hybrid endpoints" id="endpoints">Hybrid endpoints</h3>
<p>For Cloud DLP to process the object, it must be POSTed to either a
hybrid job or a job trigger. Example endpoint paths for both follow. You must
replace the following placeholders with their actual values:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: Your <a href="/resource-manager/docs/creating-managing-projects">project identifier
(ID)</a>.</li>
<li><var translate="no">LOCATION_ID</var>: Your project's
<a href="/dlp/docs/specifying-location">location</a>.</li>
<li><var translate="no">JOB_ID</var>: The job's ID. This value is the name you gave the hybrid
job, prefixed with <code dir="ltr" translate="no">i-</code>. If you didn't name the job, or to retrieve the name
of the job, from within Cloud DLP, select <strong>Jobs &amp; job
triggers</strong>, and then select <strong>Inspect jobs</strong>. Under the <strong>Actions</strong> column,
click the <b>more actions</b> menu (displayed as three dots arranged vertically)
<img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then click <strong>View details</strong>. The job ID is on the
line following "Container: Hybrid."</li>
<li><var translate="no">TRIGGER_NAME</var>: The job trigger's name. This value is the name you
gave the hybrid job trigger. If you didn't name the job, or to retrieve the
name of the trigger, from within Cloud DLP, select <strong>Jobs &amp; job
triggers</strong>, and then select <strong>Job triggers</strong>. Under the <strong>Actions</strong> column,
click the <b>more actions</b> menu (displayed as three dots arranged vertically)
<img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then click <strong>View details</strong>.</li>
</ul>
<h4 data-text="Hybrid DLP jobs:" id="hybrid_jobs">Hybrid DLP jobs:</h4>
<pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/{name=projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION_ID</var>/dlpJobs/<var translate="no">JOB_ID</var>}:hybridInspect</pre>
<p>For more information about this endpoint, see the API reference page for the
<a href="/dlp/docs/reference/rest/v2/projects.locations.dlpJobs/hybridInspect"><code dir="ltr" translate="no">projects.locations.dlpJobs.hybridInspect</code>
method</a>.</p>
<h4 data-text="Hybrid DLP job triggers:" id="hybrid_job_triggers">Hybrid DLP job triggers:</h4>
<pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/{name=projects/<var translate="no">PROJECT_ID</var>/locations/<var translate="no">LOCATION_ID</var>/jobTriggers/<var translate="no">TRIGGER_NAME</var>}:hybridInspect</pre>
<p>For more information about this endpoint, see the API reference page for the
<a href="/dlp/docs/reference/rest/v2/projects.locations.jobTriggers/hybridInspect"><code dir="ltr" translate="no">projects.locations.jobTriggers.hybridInspect</code>
method</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about how <a href="/dlp/docs/concepts-hybrid-jobs">hybrid jobs and job
triggers</a> work.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspecting-text]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention can detect and classify sensitive data within text
content. Given text input, DLP API returns details about any
<a href="/dlp/docs/infotypes-reference" title="InfoTypes Reference">infoTypes</a> found in the text, a
<a href="/dlp/docs/likelihood" title="Likelihood Concept Page">likelihood</a> value, and offset
information.</p>
<h2 data-text="Best Practices" id="best_practices">Best Practices</h2>
<h3 data-text="Identify and prioritize scanning" id="identify_and_prioritize_scanning">Identify and prioritize scanning</h3>
<p>It's important to identify your resources and specify which have the highest
priority for scanning. When just getting started you may have a large backlog of
data that needs classification, and it'll be impossible to scan it all
immediately. Choose data initially that poses the highest riskâfor
example, data that is frequently accessed, widely accessible, or unknown.</p>
<h3 data-text="Reduce latency" id="reduce_latency">Reduce latency</h3>
<p>Latency is affected by several factors: the amount of data to scan, the storage
repository being scanned, and the type and number of infoTypes that are enabled.</p>
<p>To help reduce job latency, you can try the following:</p>
<ul>
<li>Enable <a href="/dlp/docs/inspecting-storage#sampling">sampling</a>.</li>
<li>Avoid enabling infoTypes you don't need. While useful in
certain scenarios, some infoTypesâincluding <code dir="ltr" translate="no">PERSON_NAME</code>,
<code dir="ltr" translate="no">FEMALE_NAME</code>, <code dir="ltr" translate="no">MALE_NAME</code>, <code dir="ltr" translate="no">FIRST_NAME</code>, <code dir="ltr" translate="no">LAST_NAME</code>,
<code dir="ltr" translate="no">DATE_OF_BIRTH</code>, <code dir="ltr" translate="no">LOCATION</code>, <code dir="ltr" translate="no">STREET_ADDRESS</code>,
<code dir="ltr" translate="no">ORGANIZATION_NAME</code>âcan make requests run much more slowly
than requests that do not include them.</li>
<li>Always specify infoTypes explicitly. Do not use an empty infoTypes list.</li>
<li>Consider organizing the data to be inspected into a
<a href="/dlp/docs/reference/rpc/google.privacy.dlp.v2#table">table</a> with
rows and columns, if possible, to reduce network roundtrips.</li>
</ul>
<h3 data-text="Limit the scope of your first scans" id="limit_the_scope_of_your_first_scans">Limit the scope of your first scans</h3>
<p>For best results, limit the scope of your first scans instead of scanning all of
your data. Start with a few requests. Your findings will be more meaningful
when you fine-tune what detectors to enable and what
<a href="/dlp/docs/creating-custom-infotypes-rules#exclusion-rules">exclusion rules</a>
might be needed to reduce false positives. Avoid turning on all infoTypes if you
don't need them all, as false positives or unusable findings may make it harder
to assess your risk. While useful in certain scenarios, some infoTypes such as
<code dir="ltr" translate="no">DATE</code>, <code dir="ltr" translate="no">TIME</code>, <code dir="ltr" translate="no">DOMAIN_NAME</code>, and <code dir="ltr" translate="no">URL</code> detect a broad range of findings and
may not be useful to turn on.</p>
<h3 data-text="On-premises, hybrid, and multi-cloud scans" id="on-premises_hybrid_and_multi-cloud_scans">On-premises, hybrid, and multi-cloud scans</h3>
<p>If the data to be scanned resides on-premises or outside of Google Cloud,
use the API methods
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">content.inspect</code></a>
and
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content.deidentify</code></a>
to scan the content to classify findings and pseudonymize content without
persisting the content outside of your local storage.</p>
<h2 data-text="Inspecting a text string" id="inspecting_a_text_string">Inspecting a text string</h2>
<p>Following is sample JSON and code in several languages that demonstrate how to
use the DLP API to inspect strings of text for sensitive data.
<!-- For information about the parameters included with the request, see
[Configuring storage inspection](#configuring-storage-inspection),
later in this topic.--></p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-text-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-text-protocol" track-metadata-position="dlp-inspect-text" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:inspect?key={YOUR_API_KEY}

{
  "item":{
    "value":"My phone number is (415) 555-0890"
  },
  "inspectConfig":{
    "includeQuote":true,
    "minLikelihood":"POSSIBLE",
    "infoTypes":{
      "name":"PHONE_NUMBER"
    }
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "result":{
    "findings":[
      {
        "quote":"(415) 555-0890",
        "infoType":{
          "name":"PHONE_NUMBER"
        },
        "likelihood":"VERY_LIKELY",
        "location":{
          "byteRange":{
            "start":"19",
            "end":"33"
          },
          "codepointRange":{
            "start":"19",
            "end":"33"
          }
        },
        "createTime":"2018-11-13T19:29:15.412Z"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-text-java" track-metadata-position="dlp-inspect-text" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectString.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectString.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectString.java" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectString.java/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class InspectString {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "My name is Gary and my email is gary@example.com";
    inspectString(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void inspectString(String projectId, String textToInspect) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      for (String typeName : new String[] {"PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder().addAllInfoTypes(infoTypes).setIncludeQuote(true).build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-inspect-text-nodejs" track-metadata-position="dlp-inspect-text" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectString.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectString.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/inspectString.js" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/inspectString.js/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The string to inspect
// const string = 'My name is Gary and my email is gary@example.com';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The customInfoTypes of information to match
// const customInfoTypes = [{ infoType: { name: 'DICT_TYPE' }, dictionary: { wordList: { words: ['foo', 'bar', 'baz']}}},
//   { infoType: { name: 'REGEX_TYPE' }, regex: {pattern: '\\(\\d{3}\\) \\d{3}-\\d{4}'}}];

// Whether to include the matching string
// const includeQuote = true;

async function inspectString() {
  // Construct item to inspect
  const item = {value: string};

  // Construct request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectConfig: {
      infoTypes: infoTypes,
      customInfoTypes: customInfoTypes,
      minLikelihood: minLikelihood,
      includeQuote: includeQuote,
      limits: {
        maxFindingsPerRequest: maxFindings,
      },
    },
    item: item,
  };

  // Run request
  const [response] = await dlp.inspectContent(request);
  const findings = response.result.findings;
  if (findings.length &gt; 0) {
    console.log('Findings:');
    findings.forEach(finding =&gt; {
      if (includeQuote) {
        console.log(`\tQuote: ${finding.quote}`);
      }
      console.log(`\tInfo type: ${finding.infoType.name}`);
      console.log(`\tLikelihood: ${finding.likelihood}`);
    });
  } else {
    console.log('No findings.');
  }
}
inspectString();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-text-python" track-metadata-position="dlp-inspect-text" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no">def inspect_string(
    project,
    content_string,
    info_types,
    custom_dictionaries=None,
    custom_regexes=None,
    min_likelihood=None,
    max_findings=None,
    include_quote=True,
):
    """Uses the Data Loss Prevention API to analyze strings for protected data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        include_quote: Boolean for whether to display a quote of the detected
            information in the results.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "include_quote": include_quote,
        "limits": {"max_findings_per_request": max_findings},
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            try:
                if finding.quote:
                    print("Quote: {}".format(finding.quote))
            except AttributeError:
                pass
            print("Info type: {}".format(finding.info_type.name))
            print("Likelihood: {}".format(finding.likelihood))
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-inspect-text-go" track-metadata-position="dlp-inspect-text" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_string.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_string.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_string.go" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_string.go/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// inspectString inspects the a given string, and prints results.
func inspectString(w io.Writer, projectID, textToInspect string) error {
	// projectID := "my-project-id"
	// textToInspect := "My name is Gary and my email is gary@example.com"
	ctx := context.Background()

	// Initialize client.
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return err
	}
	defer client.Close() // Closing the client safely cleans up background resources.

	// Create and send the request.
	req := &amp;dlppb.InspectContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: textToInspect,
			},
		},
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: []*dlppb.InfoType{
				{Name: "PHONE_NUMBER"},
				{Name: "EMAIL_ADDRESS"},
				{Name: "CREDIT_CARD_NUMBER"},
			},
			IncludeQuote: true,
		},
	}
	resp, err := client.InspectContent(ctx, req)
	if err != nil {
		return err
	}

	// Process the results.
	result := resp.Result
	fmt.Fprintf(w, "Findings: %d\n", len(result.Findings))
	for _, f := range result.Findings {
		fmt.Fprintf(w, "\tQoute: %s\n", f.Quote)
		fmt.Fprintf(w, "\tInfo type: %s\n", f.InfoType.Name)
		fmt.Fprintf(w, "\tLikelihood: %s\n", f.Likelihood)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-inspect-text-php" track-metadata-position="dlp-inspect-text" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_string.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_string.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_string.php" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_string.php/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\ContentItem;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\Likelihood;

/**
 * @param string $projectId
 * @param string $textToInspect
 */
function inspect_string(string $projectId, string $textToInspect): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Construct request
    $parent = "projects/$projectId/locations/global";
    $item = (new ContentItem())
        -&gt;setValue($textToInspect);
    $inspectConfig = (new InspectConfig())
        // The infoTypes of information to match
        -&gt;setInfoTypes([
            (new InfoType())-&gt;setName('PHONE_NUMBER'),
            (new InfoType())-&gt;setName('EMAIL_ADDRESS'),
            (new InfoType())-&gt;setName('CREDIT_CARD_NUMBER')
        ])
        // Whether to include the matching string
        -&gt;setIncludeQuote(true);

    // Run request
    $response = $dlp-&gt;inspectContent([
        'parent' =&gt; $parent,
        'inspectConfig' =&gt; $inspectConfig,
        'item' =&gt; $item
    ]);

    // Print the results
    $findings = $response-&gt;getResult()-&gt;getFindings();
    if (count($findings) == 0) {
        print('No findings.' . PHP_EOL);
    } else {
        print('Findings:' . PHP_EOL);
        foreach ($findings as $finding) {
            print('  Quote: ' . $finding-&gt;getQuote() . PHP_EOL);
            print('  Info type: ' . $finding-&gt;getInfoType()-&gt;getName() . PHP_EOL);
            $likelihoodString = Likelihood::name($finding-&gt;getLikelihood());
            print('  Likelihood: ' . $likelihoodString . PHP_EOL);
        }
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Ruby" id="dlp-inspect-text-ruby" track-metadata-position="dlp-inspect-text" track-name="ruby" track-type="sampleTabNav">Ruby</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="ruby" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-dlp/samples/sample.rb" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-dlp/samples/sample.rb" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="ruby" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-rb" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/google-cloud-ruby/google-cloud-dlp/samples/sample.rb" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/google-cloud-ruby/google-cloud-dlp/samples/sample.rb/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no"># project_id   = "Your Google Cloud project ID"
# content      = "The text to inspect"
# max_findings = "Maximum number of findings to report per request (0 = server maximum)"

require "google/cloud/dlp"

dlp = Google::Cloud::Dlp.dlp_service
inspect_config = {
  # The types of information to match
  info_types:     [{ name: "PERSON_NAME" }, { name: "US_STATE" }],

  # Only return results above a likelihood threshold (0 for all)
  min_likelihood: :POSSIBLE,

  # Limit the number of findings (0 for no limit)
  limits:         { max_findings_per_request: max_findings },

  # Whether to include the matching string in the response
  include_quote:  true
}

# The item to inspect
item_to_inspect = { value: content }

# Run request
parent = "projects/#{project_id}/locations/global"
response = dlp.inspect_content parent:         parent,
                               inspect_config: inspect_config,
                               item:           item_to_inspect

# Print the results
if response.result.findings.empty?
  puts "No findings"
else
  response.result.findings.each do |finding|
    puts "Quote:      #{finding.quote}"
    puts "Info type:  #{finding.info_type.name}"
    puts "Likelihood: #{finding.likelihood}"
  end
end</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-inspect-text-csharp" track-metadata-position="dlp-inspect-text" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-text" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectString.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectString.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-text" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-inspect-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectString.cs" data-region-tag="dlp_inspect_string" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectString.cs/HEAD/dlp_inspect_string" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using static Google.Cloud.Dlp.V2.InspectConfig.Types;

public class InspectString
{
    public static InspectContentResponse Inspect(
        string projectId,
        string dataValue,
        string minLikelihood,
        int maxFindings,
        bool includeQuote,
        IEnumerable&lt;InfoType&gt; infoTypes,
        IEnumerable&lt;CustomInfoType&gt; customInfoTypes)
    {
        var inspectConfig = new InspectConfig
        {
            MinLikelihood = (Likelihood)Enum.Parse(typeof(Likelihood), minLikelihood, true),
            Limits = new FindingLimits
            {
                MaxFindingsPerRequest = maxFindings
            },
            IncludeQuote = includeQuote,
            InfoTypes = { infoTypes },
            CustomInfoTypes = { customInfoTypes }
        };
        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = new ContentItem
            {
                Value = dataValue
            },
            InspectConfig = inspectConfig
        };

        var dlp = DlpServiceClient.Create();
        var response = dlp.InspectContent(request);

        PrintResponse(includeQuote, response);

        return response;
    }

    private static void PrintResponse(bool includeQuote, InspectContentResponse response)
    {
        var findings = response.Result.Findings;
        if (findings.Any())
        {
            Console.WriteLine("Findings:");
            foreach (var finding in findings)
            {
                if (includeQuote)
                {
                    Console.WriteLine($"  Quote: {finding.Quote}");
                }
                Console.WriteLine($"  InfoType: {finding.InfoType}");
                Console.WriteLine($"  Likelihood: {finding.Likelihood}");
            }
        }
        else
        {
            Console.WriteLine("No findings.");
        }
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Inspecting a text file" id="inspecting_a_text_file">Inspecting a text file</h2>
<p>The code samples below demonstrate how to check a text file for sensitive
content.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-file-code-sample">
<section>
<h3 data-text="Java" id="dlp-inspect-file-java" track-metadata-position="dlp-inspect-file" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectTextFile.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectTextFile.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectTextFile.java" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectTextFile.java/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class InspectTextFile {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String filePath = "path/to/file.txt";
    inspectTextFile(projectId, filePath);
  }

  // Inspects the specified text file.
  public static void inspectTextFile(String projectId, String filePath) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(filePath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.TEXT_UTF8).setData(fileBytes).build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      for (String typeName : new String[] {"PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder().addAllInfoTypes(infoTypes).setIncludeQuote(true).build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-inspect-file-nodejs" track-metadata-position="dlp-inspect-file" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectFile.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectFile.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/inspectFile.js" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/inspectFile.js/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Import other required libraries
const fs = require('fs');
const mime = require('mime');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The path to a local file to inspect. Can be a text, JPG, or PNG file.
// const filepath = 'path/to/image.png';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The customInfoTypes of information to match
// const customInfoTypes = [{ infoType: { name: 'DICT_TYPE' }, dictionary: { wordList: { words: ['foo', 'bar', 'baz']}}},
//   { infoType: { name: 'REGEX_TYPE' }, regex: {pattern: '\\(\\d{3}\\) \\d{3}-\\d{4}'}}];

// Whether to include the matching string
// const includeQuote = true;

async function inspectFile() {
  // Construct file data to inspect
  const fileTypeConstant =
    ['image/jpeg', 'image/bmp', 'image/png', 'image/svg'].indexOf(
      mime.getType(filepath)
    ) + 1;
  const fileBytes = Buffer.from(fs.readFileSync(filepath)).toString('base64');
  const item = {
    byteItem: {
      type: fileTypeConstant,
      data: fileBytes,
    },
  };

  // Construct request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectConfig: {
      infoTypes: infoTypes,
      customInfoTypes: customInfoTypes,
      minLikelihood: minLikelihood,
      includeQuote: includeQuote,
      limits: {
        maxFindingsPerRequest: maxFindings,
      },
    },
    item: item,
  };

  // Run request
  const [response] = await dlp.inspectContent(request);
  const findings = response.result.findings;
  if (findings.length &gt; 0) {
    console.log('Findings:');
    findings.forEach(finding =&gt; {
      if (includeQuote) {
        console.log(`\tQuote: ${finding.quote}`);
      }
      console.log(`\tInfo type: ${finding.infoType.name}`);
      console.log(`\tLikelihood: ${finding.likelihood}`);
    });
  } else {
    console.log('No findings.');
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-file-python" track-metadata-position="dlp-inspect-file" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">

def inspect_file(
    project,
    filename,
    info_types,
    min_likelihood=None,
    custom_dictionaries=None,
    custom_regexes=None,
    max_findings=None,
    include_quote=True,
    mime_type=None,
):
    """Uses the Data Loss Prevention API to analyze a file for protected data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        filename: The path to the file to inspect.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        include_quote: Boolean for whether to display a quote of the detected
            information in the results.
        mime_type: The MIME type of the file. If not specified, the type is
            inferred via the Python standard library's mimetypes module.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    import mimetypes

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    if not info_types:
        info_types = ["FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS"]
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "limits": {"max_findings_per_request": max_findings},
    }

    # If mime_type is not specified, guess it from the filename.
    if mime_type is None:
        mime_guess = mimetypes.MimeTypes().guess_type(filename)
        mime_type = mime_guess[0]

    # Select the content type index from the list of supported types.
    supported_content_types = {
        None: 0,  # "Unspecified"
        "image/jpeg": 1,
        "image/bmp": 2,
        "image/png": 3,
        "image/svg": 4,
        "text/plain": 5,
    }
    content_type_index = supported_content_types.get(mime_type, 0)

    # Construct the item, containing the file's byte data.
    with open(filename, mode="rb") as f:
        item = {"byte_item": {"type_": content_type_index, "data": f.read()}}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            try:
                print("Quote: {}".format(finding.quote))
            except AttributeError:
                pass
            print("Info type: {}".format(finding.info_type.name))
            print("Likelihood: {}".format(finding.likelihood))
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-inspect-file-go" track-metadata-position="dlp-inspect-file" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_text_file.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_text_file.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_text_file.go" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_text_file.go/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"io/ioutil"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// inspectTextFile inspects a text file at a given filePath, and prints results.
func inspectTextFile(w io.Writer, projectID, filePath string) error {
	// projectID := "my-project-id"
	// filePath := "path/to/image.png"
	ctx := context.Background()

	// Initialize client.
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return err
	}
	defer client.Close() // Closing the client safely cleans up background resources.

	// Gather the resources for the request.
	data, err := ioutil.ReadFile(filePath)
	if err != nil {
		return err
	}

	// Create and send the request.
	req := &amp;dlppb.InspectContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_ByteItem{
				ByteItem: &amp;dlppb.ByteContentItem{
					Type: dlppb.ByteContentItem_TEXT_UTF8,
					Data: data,
				},
			},
		},
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: []*dlppb.InfoType{
				{Name: "PHONE_NUMBER"},
				{Name: "EMAIL_ADDRESS"},
				{Name: "CREDIT_CARD_NUMBER"},
			},
			IncludeQuote: true,
		},
	}
	resp, err := client.InspectContent(ctx, req)
	if err != nil {
		return fmt.Errorf("InspectContent: %v", err)
	}

	// Process the results.
	fmt.Fprintf(w, "Findings: %d\n", len(resp.Result.Findings))
	for _, f := range resp.Result.Findings {
		fmt.Fprintf(w, "\tQoute: %s\n", f.Quote)
		fmt.Fprintf(w, "\tInfo type: %s\n", f.InfoType.Name)
		fmt.Fprintf(w, "\tLikelihood: %s\n", f.Likelihood)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-inspect-file-php" track-metadata-position="dlp-inspect-file" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_text_file.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_text_file.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_text_file.php" data-region-tag="dlp_inspect_text_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_text_file.php/HEAD/dlp_inspect_text_file" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\ContentItem;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\ByteContentItem;
use Google\Cloud\Dlp\V2\ByteContentItem\BytesType;
use Google\Cloud\Dlp\V2\Likelihood;

/**
 * @param string $projectId
 * @param string $filepath
 */
function inspect_text_file(string $projectId, string $filepath): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Get the bytes of the file
    $fileBytes = (new ByteContentItem())
        -&gt;setType(BytesType::TEXT_UTF8)
        -&gt;setData(file_get_contents($filepath));

    // Construct request
    $parent = "projects/$projectId/locations/global";
    $item = (new ContentItem())
        -&gt;setByteItem($fileBytes);
    $inspectConfig = (new InspectConfig())
        // The infoTypes of information to match
        -&gt;setInfoTypes([
            (new InfoType())-&gt;setName('PHONE_NUMBER'),
            (new InfoType())-&gt;setName('EMAIL_ADDRESS'),
            (new InfoType())-&gt;setName('CREDIT_CARD_NUMBER')
        ])
        // Whether to include the matching string
        -&gt;setIncludeQuote(true);

    // Run request
    $response = $dlp-&gt;inspectContent([
        'parent' =&gt; $parent,
        'inspectConfig' =&gt; $inspectConfig,
        'item' =&gt; $item
    ]);

    // Print the results
    $findings = $response-&gt;getResult()-&gt;getFindings();
    if (count($findings) == 0) {
        print('No findings.' . PHP_EOL);
    } else {
        print('Findings:' . PHP_EOL);
        foreach ($findings as $finding) {
            print('  Quote: ' . $finding-&gt;getQuote() . PHP_EOL);
            print('  Info type: ' . $finding-&gt;getInfoType()-&gt;getName() . PHP_EOL);
            $likelihoodString = Likelihood::name($finding-&gt;getLikelihood());
            print('  Likelihood: ' . $likelihoodString . PHP_EOL);
        }
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Ruby" id="dlp-inspect-file-ruby" track-metadata-position="dlp-inspect-file" track-name="ruby" track-type="sampleTabNav">Ruby</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="ruby" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-dlp/samples/sample.rb" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-dlp/samples/sample.rb" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="ruby" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-rb" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/google-cloud-ruby/google-cloud-dlp/samples/sample.rb" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/google-cloud-ruby/google-cloud-dlp/samples/sample.rb/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no"># project_id   = "Your Google Cloud project ID"
# filename     = "The file path to the file to inspect"
# max_findings = "Maximum number of findings to report per request (0 = server maximum)"

require "google/cloud/dlp"

dlp = Google::Cloud::Dlp.dlp_service
inspect_config = {
  # The types of information to match
  info_types:     [{ name: "PERSON_NAME" }, { name: "PHONE_NUMBER" }],

  # Only return results above a likelihood threshold (0 for all)
  min_likelihood: :POSSIBLE,

  # Limit the number of findings (0 for no limit)
  limits:         { max_findings_per_request: max_findings },

  # Whether to include the matching string in the response
  include_quote:  true
}

# The item to inspect
file = File.open filename, "rb"
item_to_inspect = { byte_item: { type: :BYTES_TYPE_UNSPECIFIED, data: file.read } }

# Run request
parent = "projects/#{project_id}/locations/global"
response = dlp.inspect_content parent:         parent,
                               inspect_config: inspect_config,
                               item:           item_to_inspect

# Print the results
if response.result.findings.empty?
  puts "No findings"
else
  response.result.findings.each do |finding|
    puts "Quote:      #{finding.quote}"
    puts "Info type:  #{finding.info_type.name}"
    puts "Likelihood: #{finding.likelihood}"
  end
end</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-inspect-file-csharp" track-metadata-position="dlp-inspect-file" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectFile.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectFile.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectFile.cs" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectFile.cs/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;
using static Google.Cloud.Dlp.V2.ByteContentItem.Types;

public class DlpInspectFile
{
    public static IEnumerable&lt;Finding&gt; InspectFile(string projectId, string filePath, BytesType fileType)
    {
        // Instantiate a client.
        var dlp = DlpServiceClient.Create();

        // Get the bytes from the file.
        ByteString fileBytes;
        using (Stream f = new FileStream(filePath, FileMode.Open))
        {
            fileBytes = ByteString.FromStream(f);
        }

        // Construct a request.
        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = new ContentItem
            {
                ByteItem = new ByteContentItem()
                {
                    Data = fileBytes,
                    Type = fileType
                }
            },
            InspectConfig = new InspectConfig
            {
                // The info types of information to match
                InfoTypes =
                {
                    new InfoType { Name = "PHONE_NUMBER" },
                    new InfoType { Name = "EMAIL_ADDRESS" },
                    new InfoType { Name = "CREDIT_CARD_NUMBER" }
                },
                // The minimum likelihood before returning a match
                MinLikelihood = Likelihood.Unspecified,
                // Whether to include the matching string
                IncludeQuote = true,
                Limits = new InspectConfig.Types.FindingLimits
                {
                    // The maximum number of findings to report per request
                    // (0 = server maximum)
                    MaxFindingsPerRequest = 0
                }
            }
        };

        // Execute request
        var response = dlp.InspectContent(request);

        // Inspect response
        var findings = response.Result.Findings;
        if (findings.Any())
        {
            Console.WriteLine("Findings:");
            foreach (var finding in findings)
            {
                Console.WriteLine($"Quote: {finding.Quote}");
                Console.WriteLine($"InfoType: {finding.InfoType}");
                Console.WriteLine($"Likelihood: {finding.Likelihood}");
            }
        }
        else
        {
            Console.WriteLine("No findings.");
        }
        return findings;
    }
}
</code></pre>
</div>
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspecting-structured-text]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention can detect and classify sensitive data within structured
content such as CSV. By inspecting or de-identifying as a table, the
structure and columns provide Cloud DLP with additional clues that
may enable it to provide better results for some use cases.</p>
<h2 data-text="Inspecting a table" id="inspecting_a_table">Inspecting a table</h2>
<p>The code samples below demonstrate how to check a table of data for sensitive
content.
<a href="/dlp/docs/reference/rpc/google.privacy.dlp.v2#table">Tables</a>
support a variety of
<a href="/dlp/docs/reference/rpc/google.privacy.dlp.v2#google.privacy.dlp.v2.Value">types</a>.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-table-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-table-protocol" track-metadata-position="dlp-inspect-table" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/quickstart-json">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:inspect?key={YOUR_API_KEY}

{
  "item":{
    "table":{
      "headers": [{"name":"name"}, {"name":"phone"}],
      "rows": [{
        "values":[
          {"string_value": "John Doe"},
          {"string_value": "(206) 555-0123"}
        ]}
      ],
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"PHONE_NUMBER"
      }
    ],
    "includeQuote":true
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "result": {
    "findings": [
     {
      "quote": "(206) 555-0123",
      "infoType": {
       "name": "PHONE_NUMBER"
      },
      "likelihood": "VERY_LIKELY",
      "location": {
         "byteRange": {
          "end": "14"
         },
         "codepointRange": {
          "end": "14"
         },
         "contentLocations": [
          {
           "recordLocation": {
              "fieldId": {
               "name": "phone"
              },
              "tableLocation": {
              }
           }
          }
         ]
      },
      "createTime": "2019-03-08T23:55:10.980Z"
     }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-table-java" track-metadata-position="dlp-inspect-table" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-table" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectTable.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectTable.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-table" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-table" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectTable.java" data-region-tag="dlp_inspect_table" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectTable.java/HEAD/dlp_inspect_table" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Table.Row;
import com.google.privacy.dlp.v2.Value;

public class InspectTable {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Table tableToInspect =
        Table.newBuilder()
            .addHeaders(FieldId.newBuilder().setName("name").build())
            .addHeaders(FieldId.newBuilder().setName("phone").build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("John Doe").build())
                    .addValues(Value.newBuilder().setStringValue("(206) 555-0123").build()))
            .build();

    inspectTable(projectId, tableToInspect);
  }

  // Inspects the provided text.
  public static void inspectTable(String projectId, Table tableToInspect) {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the table to be inspected.
      ContentItem item = ContentItem.newBuilder().setTable(tableToInspect).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("PHONE_NUMBER").build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder().addInfoTypes(infoType).setIncludeQuote(true).build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    } catch (Exception e) {
      System.out.println("Error during inspectString: \n" + e.toString());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-table-python" track-metadata-position="dlp-inspect-table" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-table" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-table" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-table" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_table" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_table" translate="no"><code dir="ltr" translate="no">

def inspect_table(
    project,
    data,
    info_types,
    custom_dictionaries=None,
    custom_regexes=None,
    min_likelihood=None,
    max_findings=None,
    include_quote=True,
):
    """Uses the Data Loss Prevention API to analyze strings for protected data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        data: Json string representing table data.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        include_quote: Boolean for whether to display a quote of the detected
            information in the results.
    Returns:
        None; the response from the API is printed to the terminal.
    Example:
        data = {
            "header":[
                "email",
                "phone number"
            ],
            "rows":[
                [
                    "robertfrost@xyz.com",
                    "4232342345"
                ],
                [
                    "johndoe@pqr.com",
                    "4253458383"
                ]
            ]
        }

        &gt;&gt; $ python inspect_content.py table \
        '{"header": ["email", "phone number"],
        "rows": [["robertfrost@xyz.com", "4232342345"],
        ["johndoe@pqr.com", "4253458383"]]}'
        &gt;&gt;  Quote: robertfrost@xyz.com
            Info type: EMAIL_ADDRESS
            Likelihood: 4
            Quote: johndoe@pqr.com
            Info type: EMAIL_ADDRESS
            Likelihood: 4
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "include_quote": include_quote,
        "limits": {"max_findings_per_request": max_findings},
    }

    # Construct the `table`. For more details on the table schema, please see
    # https://cloud.google.com/dlp/docs/reference/rest/v2/ContentItem#Table
    headers = [{"name": val} for val in data["header"]]
    rows = []
    for row in data["rows"]:
        rows.append({"values": [{"string_value": cell_val} for cell_val in row]})

    table = {}
    table["headers"] = headers
    table["rows"] = rows
    item = {"table": table}
    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            try:
                if finding.quote:
                    print("Quote: {}".format(finding.quote))
            except AttributeError:
                pass
            print("Info type: {}".format(finding.info_type.name))
            print("Likelihood: {}".format(finding.likelihood))
    else:
        print("No findings.")

</code></pre>
</div>
</section>
</div>
<h2 data-text="Text versus structured text" id="text_versus_structured_text">Text versus structured text</h2>
<p>Structuring text can help provide context. The same request as the one in the
previous example, if inspected as a stringâthat is, as just "John Doe,
(206) 555-0123"âwould provide less accurate findings. That's because
Cloud DLP has fewer contextual clues about what the purpose of the
number might be. When possible, consider parsing your strings into a table
object for the most accurate scan results.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/inspecting-images]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention can detect and classify sensitive data within an image.
Using <a href="/dlp/docs/infotypes-reference">infoType detectors</a> and optical character
recognition (OCR), Cloud DLP inspects a base64-encoded image for
text, detects sensitive data within the text, and then returns the
locations of any sensitive data that it has detected.</p>
<aside class="note"><p><strong>Notes:</strong> Cloud DLP can inspect
  many image types for sensitive data, including JPEG, BMP, PNG, and SVG.
  Cloud DLP can also inspect other file formats such as PDF, DOCX,
  XLSX, and PPTX, but may generate mixed findingsâincluding byte offsets
  and bounding boxesâdepending on the contents of each specific file. For
  more information, see <a href="/dlp/docs/supported-file-types">Supported file
  types</a>.</p>
<p>Inspecting files using the method described in this topic is subject to
    file size limits. For larger files, consider using Cloud DLP to
    <a href="/dlp/docs/inspecting-storage">scan a storage repository</a> containing the
    files. To learn more about file size limits and Cloud DLP, see
    <a href="/dlp/limits">Usage limits</a>.</p></aside>
<p>Given an image as input, Cloud DLP detects sensitive data
in the image. The output of an inspection operation includes the found
<a href="/dlp/docs/infotypes-reference" title="InfoTypes Reference">infoTypes</a>, the
<a href="/dlp/docs/likelihood" title="Likelihood Concept Page">likelihood</a> of the match, and pixel
coordinate and length values that indicate the areas within which
Cloud DLP found the sensitive data. The coordinates at the bottom
left corner of an image are <code dir="ltr" translate="no">(0,0)</code>.</p>
<h2 data-text="Inspecting an image for all default infoTypes" id="inspecting_an_image_for_all_default_infotypes">Inspecting an image for all default infoTypes</h2>
<p>To inspect an image for sensitive data, you submit a base64-encoded image to the
DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">content.inspect</code></a>
method. Unless you specify specific information types
(<a href="/dlp/docs/infotypes-reference">infoTypes</a>) to search for, Cloud DLP
searches for the most common infoTypes.</p>
<aside class="note"><strong>Note:</strong><span> To learn how to base64-encode an image using built-in OS or programming
language tools, see <a href="/vision/docs/base64">Base64 encoding</a> in the
Cloud Vision documentation.</span></aside>
<p><strong>To inspect an image for default infoTypes:</strong></p>
<ol>
<li>Encode the image as base64.</li>
<li>Submit a request to the DLP API's <code dir="ltr" translate="no">content.inspect</code> method. The
 request need only contain the base64-encoded image if you want to inspect
 for default infoTypes.</li>
</ol>
<p>For example, consider the following image. This image is an example of a typical
image file generated from a scan of a paper document.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpbefore.jpg">
<img alt="Original image (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpbefore.jpg" title="Original image (click to enlarge)" width="500">
</img></a>
</figure>
<p>To inspect this image for default infoTypes, send the following request to
the DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">content.inspect</code></a>
method:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-image-all-infotypes-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-image-all-infotypes-protocol" track-metadata-position="dlp-inspect-image-all-infotypes" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<aside class="important"><strong>Important:</strong> Before sending this
  request, use a base64 utility to encode the image into ASCII text data, and
  then replace the <code dir="ltr" translate="no">[BASE64-ENCODED-IMAGE]</code> placeholder with the
  base64-encoded text. Most development environments contain a native
  <code dir="ltr" translate="no">base64</code> utility. To encode an image file:
  <ul>
<li>Linux: <code dir="ltr" translate="no">base64 input.jpg &gt; output.txt</code></li>
<li>macOS: <code dir="ltr" translate="no">base64 -i input.jpg -o output.txt</code></li>
<li>Windows: <code dir="ltr" translate="no">C:&gt; Base64.exe -e input.jpg &gt; output.txt</code></li>
<li>PowerShell: <code dir="ltr" translate="no">[Convert]::ToBase64String([IO.File]::ReadAllBytes("./input.jpg")) &gt; output.txt</code></li>
</ul></aside>
<pre class="prettyprint devsite-click-to-copy lang-json" dir="ltr" translate="no">
{
  "item": {
    "byteItem": {
      "data": "[BASE64-ENCODED-IMAGE]",
      "type": "IMAGE_JPEG"
    }
  }
}
</pre>
<p>Cloud DLP returns the following:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no">
{
  "result": {
    "findings": [
      {
        "infoType": {
          "name": "PHONE_NUMBER"
        },
        "likelihood": "UNLIKELY",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 98,
                    "left": 986,
                    "width": 102,
                    "height": 117
                  },
                  {
                    "top": 98,
                    "left": 1092,
                    "width": 29,
                    "height": 114
                  },
                  {
                    "top": 95,
                    "left": 1111,
                    "width": 82,
                    "height": 115
                  },
                  {
                    "top": 95,
                    "left": 1197,
                    "width": 29,
                    "height": 114
                  },
                  {
                    "top": 90,
                    "left": 1203,
                    "width": 185,
                    "height": 118
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:07:05.870Z"
      },
      {
        "infoType": {
          "name": "US_SOCIAL_SECURITY_NUMBER"
        },
        "likelihood": "VERY_LIKELY",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 98,
                    "left": 986,
                    "width": 102,
                    "height": 117
                  },
                  {
                    "top": 98,
                    "left": 1092,
                    "width": 29,
                    "height": 114
                  },
                  {
                    "top": 95,
                    "left": 1111,
                    "width": 82,
                    "height": 115
                  },
                  {
                    "top": 95,
                    "left": 1197,
                    "width": 29,
                    "height": 114
                  },
                  {
                    "top": 90,
                    "left": 1203,
                    "width": 185,
                    "height": 118
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:07:05.871Z"
      },
      {
        "infoType": {
          "name": "EMAIL_ADDRESS"
        },
        "likelihood": "LIKELY",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 340,
                    "left": 334,
                    "width": 57,
                    "height": 58
                  },
                  {
                    "top": 340,
                    "left": 384,
                    "width": 12,
                    "height": 58
                  },
                  {
                    "top": 340,
                    "left": 387,
                    "width": 79,
                    "height": 59
                  },
                  {
                    "top": 341,
                    "left": 467,
                    "width": 12,
                    "height": 58
                  },
                  {
                    "top": 340,
                    "left": 476,
                    "width": 119,
                    "height": 61
                  },
                  {
                    "top": 341,
                    "left": 589,
                    "width": 12,
                    "height": 58
                  },
                  {
                    "top": 342,
                    "left": 592,
                    "width": 45,
                    "height": 58
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:07:05.869Z"
      },
      {
        "infoType": {
          "name": "PHONE_NUMBER"
        },
        "likelihood": "POSSIBLE",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 394,
                    "left": 335,
                    "width": 50,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 380,
                    "width": 17,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 387,
                    "width": 51,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 433,
                    "width": 17,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 436,
                    "width": 77,
                    "height": 77
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:07:05.870Z"
      },
      {
        "infoType": {
          "name": "DATE"
        },
        "likelihood": "LIKELY",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 572,
                    "left": 1129,
                    "width": 71,
                    "height": 38
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:07:05.921Z"
      }
    ]
  }
}
</pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-image-all-infotypes-java" track-metadata-position="dlp-inspect-image-all-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-image-all-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectImageFileAllInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectImageFileAllInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-image-all-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-image-all-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectImageFileAllInfoTypes.java" data-region-tag="dlp_inspect_image_all_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectImageFileAllInfoTypes.java/HEAD/dlp_inspect_image_all_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.IOException;

class InspectImageFileAllInfoTypes {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "my-project-id";
    String inputPath = "src/test/resources/sensitive-data-image.jpeg";
    inspectImageFileAllInfoTypes(projectId, inputPath);
  }

  static void inspectImageFileAllInfoTypes(String projectId, String inputPath) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(inputPath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.IMAGE_JPEG).setData(fileBytes).build();

      // Construct the Inspect request to be sent by the client.
      // Do not specify the type of info to inspect.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(ContentItem.newBuilder().setByteItem(byteItem).build())
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results.
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
</div>
<p>Cloud DLP has found the following infoTypes, though its <a href="/dlp/docs/likelihood">match
confidence</a> for each one varies:</p>
<ul>
<li>A phone number (unlikely)</li>
<li>A US Social Security number (very likely)</li>
<li>An email address (likely)</li>
<li>A phone number (possible)</li>
<li>A date (likely)</li>
</ul>
<p>If you were to draw each of the bounding boxes on the image, it would look like
the following. Be aware that Cloud DLP often uses multiple boxes to
indicate where a single instance of sensitive data is in the image.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/inspecting-sensitive-data-images-boxes.png">
<img alt="Bounding boxes overlaid on image (click to enlarge)" class="screenshot" src="/dlp/docs/images/inspecting-sensitive-data-images-boxes.png" title="Bounding boxes overlaid on image (click to enlarge)" width="500">
</img></a>
</figure>
<p>Note that, in addition to detecting the handwritten Social Security number,
the email address, and the phone number, Cloud DLP has also
detected the year. Assuming that's not optimal behavior, the next example
demonstrates how to inspect for only certain infoTypes.</p>
<h2 data-text="Inspecting an image for specific infoTypes" id="inspecting_an_image_for_specific_infotypes">Inspecting an image for specific infoTypes</h2>
<p>If you want to inspect an image for only certain sensitive data types, specify
their corresponding built-in infoTypes.</p>
<aside class="note"><strong>Note:</strong><span> You can also inspect for data matching your <a href="/dlp/docs/creating-custom-infotypes">custom infoType
detectors</a>.</span></aside>
<p><strong>To inspect an image for specific infoTypes:</strong></p>
<ol>
<li>Encode the image as base64.</li>
<li>Submit a request to the DLP API's <code dir="ltr" translate="no">content.inspect</code> method. The
 request must include:
<ul>
<li>The base64-encoded image.</li>
<li>One or more <a href="/dlp/docs/infotypes-reference">infoType detectors</a>.</li>
</ul></li>
</ol>
<p>Consider the original image from the previous section. To inspect for only
US Social Security numbers, email addresses, and telephone numbers, send the
following JSON to the DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">content.inspect</code></a>
method:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-image-listed-infotypes-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-image-listed-infotypes-protocol" track-metadata-position="dlp-inspect-image-listed-infotypes" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<aside class="important"><strong>Important:</strong> Before sending this
  request, use a base64 utility to encode the image into ASCII text data, and
  then replace the <code dir="ltr" translate="no">[BASE64-ENCODED-IMAGE]</code> placeholder with the
  base64-encoded text. Most development environments contain a native
  <code dir="ltr" translate="no">base64</code> utility. To encode an image file:
  <ul>
<li>Linux: <code dir="ltr" translate="no">base64 input.jpg &gt; output.txt</code></li>
<li>macOS: <code dir="ltr" translate="no">base64 -i input.jpg -o output.txt</code></li>
<li>Windows: <code dir="ltr" translate="no">C:&gt; Base64.exe -e input.jpg &gt; output.txt</code></li>
<li>PowerShell: <code dir="ltr" translate="no">[Convert]::ToBase64String([IO.File]::ReadAllBytes("./input.jpg")) &gt; output.txt</code></li>
</ul></aside>
<pre class="prettyprint devsite-click-to-copy lang-json" dir="ltr" translate="no">
{
  "item": {
    "byteItem": {
      "data": "[BASE64-ENCODED-IMAGE]",
      "type": "IMAGE_JPEG"
    }
  },
  "inspectConfig": {
    "infoTypes": [
      {
        "name": "US_SOCIAL_SECURITY_NUMBER"
      },
      {
        "name": "PHONE_NUMBER"
      },
      {
        "name": "EMAIL_ADDRESS"
      }
    ]
  }
}
</pre>
<p>Cloud DLP returns the following:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no">
{
  "result": {
    "findings": [
      {
        "infoType": {
          "name": "US_SOCIAL_SECURITY_NUMBER"
        },
        "likelihood": "VERY_LIKELY",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 98,
                    "left": 986,
                    "width": 102,
                    "height": 117
                  },
                  {
                    "top": 98,
                    "left": 1092,
                    "width": 29,
                    "height": 114
                  },
                  {
                    "top": 95,
                    "left": 1111,
                    "width": 82,
                    "height": 115
                  },
                  {
                    "top": 95,
                    "left": 1197,
                    "width": 29,
                    "height": 114
                  },
                  {
                    "top": 90,
                    "left": 1203,
                    "width": 185,
                    "height": 118
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:58:56.985Z"
      },
      {
        "infoType": {
          "name": "EMAIL_ADDRESS"
        },
        "likelihood": "LIKELY",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 340,
                    "left": 334,
                    "width": 57,
                    "height": 58
                  },
                  {
                    "top": 340,
                    "left": 384,
                    "width": 12,
                    "height": 58
                  },
                  {
                    "top": 340,
                    "left": 387,
                    "width": 79,
                    "height": 59
                  },
                  {
                    "top": 341,
                    "left": 467,
                    "width": 12,
                    "height": 58
                  },
                  {
                    "top": 340,
                    "left": 476,
                    "width": 119,
                    "height": 61
                  },
                  {
                    "top": 341,
                    "left": 589,
                    "width": 12,
                    "height": 58
                  },
                  {
                    "top": 342,
                    "left": 592,
                    "width": 45,
                    "height": 58
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:58:56.984Z"
      },
      {
        "infoType": {
          "name": "PHONE_NUMBER"
        },
        "likelihood": "POSSIBLE",
        "location": {
          "contentLocations": [
            {
              "imageLocation": {
                "boundingBoxes": [
                  {
                    "top": 394,
                    "left": 335,
                    "width": 50,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 380,
                    "width": 17,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 387,
                    "width": 51,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 433,
                    "width": 17,
                    "height": 77
                  },
                  {
                    "top": 394,
                    "left": 436,
                    "width": 77,
                    "height": 77
                  }
                ]
              }
            }
          ]
        },
        "createTime": "2019-11-01T22:58:56.985Z"
      }
    ]
  }
}
</pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-image-listed-infotypes-java" track-metadata-position="dlp-inspect-image-listed-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-image-listed-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectImageFileListedInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectImageFileListedInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-image-listed-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-image-listed-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectImageFileListedInfoTypes.java" data-region-tag="dlp_inspect_image_listed_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectImageFileListedInfoTypes.java/HEAD/dlp_inspect_image_listed_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

class InspectImageFileListedInfoTypes {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "my-project-id";
    String inputPath = "src/test/resources/sensitive-data-image.jpeg";
    inspectImageFileListedInfoTypes(projectId, inputPath);
  }

  static void inspectImageFileListedInfoTypes(String projectId, String inputPath)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(inputPath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.IMAGE_JPEG).setData(fileBytes).build();

      // Specify the type of info the inspection will look for.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      for (String typeName :
          new String[] {"US_SOCIAL_SECURITY_NUMBER", "EMAIL_ADDRESS", "PHONE_NUMBER"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Construct the configuration for the Inspect request.
      InspectConfig inspectConfig = InspectConfig.newBuilder().addAllInfoTypes(infoTypes).build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(ContentItem.newBuilder().setByteItem(byteItem).build())
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results.
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
</div>
<p>As you can see from the output, Cloud DLP has found a US Social
Security number, an email address, and a telephone number.</p>
<p>See the <a href="/dlp/docs/quickstart-json">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<h2 data-text="Code examples" id="code_examples">Code examples</h2>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to inspect an image for sensitive data.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-file-code-sample">
<section>
<h3 data-text="Node.js" id="dlp-inspect-file-nodejs" track-metadata-position="dlp-inspect-file" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectFile.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/inspectFile.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/inspectFile.js" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/inspectFile.js/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Import other required libraries
const fs = require('fs');
const mime = require('mime');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The path to a local file to inspect. Can be a text, JPG, or PNG file.
// const filepath = 'path/to/image.png';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The customInfoTypes of information to match
// const customInfoTypes = [{ infoType: { name: 'DICT_TYPE' }, dictionary: { wordList: { words: ['foo', 'bar', 'baz']}}},
//   { infoType: { name: 'REGEX_TYPE' }, regex: {pattern: '\\(\\d{3}\\) \\d{3}-\\d{4}'}}];

// Whether to include the matching string
// const includeQuote = true;

async function inspectFile() {
  // Construct file data to inspect
  const fileTypeConstant =
    ['image/jpeg', 'image/bmp', 'image/png', 'image/svg'].indexOf(
      mime.getType(filepath)
    ) + 1;
  const fileBytes = Buffer.from(fs.readFileSync(filepath)).toString('base64');
  const item = {
    byteItem: {
      type: fileTypeConstant,
      data: fileBytes,
    },
  };

  // Construct request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectConfig: {
      infoTypes: infoTypes,
      customInfoTypes: customInfoTypes,
      minLikelihood: minLikelihood,
      includeQuote: includeQuote,
      limits: {
        maxFindingsPerRequest: maxFindings,
      },
    },
    item: item,
  };

  // Run request
  const [response] = await dlp.inspectContent(request);
  const findings = response.result.findings;
  if (findings.length &gt; 0) {
    console.log('Findings:');
    findings.forEach(finding =&gt; {
      if (includeQuote) {
        console.log(`\tQuote: ${finding.quote}`);
      }
      console.log(`\tInfo type: ${finding.infoType.name}`);
      console.log(`\tLikelihood: ${finding.likelihood}`);
    });
  } else {
    console.log('No findings.');
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-file-python" track-metadata-position="dlp-inspect-file" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">

def inspect_file(
    project,
    filename,
    info_types,
    min_likelihood=None,
    custom_dictionaries=None,
    custom_regexes=None,
    max_findings=None,
    include_quote=True,
    mime_type=None,
):
    """Uses the Data Loss Prevention API to analyze a file for protected data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        filename: The path to the file to inspect.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        include_quote: Boolean for whether to display a quote of the detected
            information in the results.
        mime_type: The MIME type of the file. If not specified, the type is
            inferred via the Python standard library's mimetypes module.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    import mimetypes

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    if not info_types:
        info_types = ["FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS"]
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare custom_info_types by parsing the dictionary word lists and
    # regex patterns.
    if custom_dictionaries is None:
        custom_dictionaries = []
    dictionaries = [
        {
            "info_type": {"name": "CUSTOM_DICTIONARY_{}".format(i)},
            "dictionary": {"word_list": {"words": custom_dict.split(",")}},
        }
        for i, custom_dict in enumerate(custom_dictionaries)
    ]
    if custom_regexes is None:
        custom_regexes = []
    regexes = [
        {
            "info_type": {"name": "CUSTOM_REGEX_{}".format(i)},
            "regex": {"pattern": custom_regex},
        }
        for i, custom_regex in enumerate(custom_regexes)
    ]
    custom_info_types = dictionaries + regexes

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "custom_info_types": custom_info_types,
        "min_likelihood": min_likelihood,
        "limits": {"max_findings_per_request": max_findings},
    }

    # If mime_type is not specified, guess it from the filename.
    if mime_type is None:
        mime_guess = mimetypes.MimeTypes().guess_type(filename)
        mime_type = mime_guess[0]

    # Select the content type index from the list of supported types.
    supported_content_types = {
        None: 0,  # "Unspecified"
        "image/jpeg": 1,
        "image/bmp": 2,
        "image/png": 3,
        "image/svg": 4,
        "text/plain": 5,
    }
    content_type_index = supported_content_types.get(mime_type, 0)

    # Construct the item, containing the file's byte data.
    with open(filename, mode="rb") as f:
        item = {"byte_item": {"type_": content_type_index, "data": f.read()}}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            try:
                print("Quote: {}".format(finding.quote))
            except AttributeError:
                pass
            print("Info type: {}".format(finding.info_type.name))
            print("Likelihood: {}".format(finding.likelihood))
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-inspect-file-go" track-metadata-position="dlp-inspect-file" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_text_file.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/inspect/inspect_text_file.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_text_file.go" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/inspect/inspect_text_file.go/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"io/ioutil"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// inspectTextFile inspects a text file at a given filePath, and prints results.
func inspectTextFile(w io.Writer, projectID, filePath string) error {
	// projectID := "my-project-id"
	// filePath := "path/to/image.png"
	ctx := context.Background()

	// Initialize client.
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return err
	}
	defer client.Close() // Closing the client safely cleans up background resources.

	// Gather the resources for the request.
	data, err := ioutil.ReadFile(filePath)
	if err != nil {
		return err
	}

	// Create and send the request.
	req := &amp;dlppb.InspectContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_ByteItem{
				ByteItem: &amp;dlppb.ByteContentItem{
					Type: dlppb.ByteContentItem_TEXT_UTF8,
					Data: data,
				},
			},
		},
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: []*dlppb.InfoType{
				{Name: "PHONE_NUMBER"},
				{Name: "EMAIL_ADDRESS"},
				{Name: "CREDIT_CARD_NUMBER"},
			},
			IncludeQuote: true,
		},
	}
	resp, err := client.InspectContent(ctx, req)
	if err != nil {
		return fmt.Errorf("InspectContent: %v", err)
	}

	// Process the results.
	fmt.Fprintf(w, "Findings: %d\n", len(resp.Result.Findings))
	for _, f := range resp.Result.Findings {
		fmt.Fprintf(w, "\tQoute: %s\n", f.Quote)
		fmt.Fprintf(w, "\tInfo type: %s\n", f.InfoType.Name)
		fmt.Fprintf(w, "\tLikelihood: %s\n", f.Likelihood)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-inspect-file-php" track-metadata-position="dlp-inspect-file" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_image_file.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/inspect_image_file.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_image_file.php" data-region-tag="dlp_inspect_image_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/inspect_image_file.php/HEAD/dlp_inspect_image_file" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\ContentItem;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\ByteContentItem;
use Google\Cloud\Dlp\V2\ByteContentItem\BytesType;
use Google\Cloud\Dlp\V2\Likelihood;

/**
 * @param string $projectId
 * @param string $filepath
 */
function inspect_image_file(string $projectId, string $filepath): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Get the bytes of the file
    $fileBytes = (new ByteContentItem())
        -&gt;setType(BytesType::IMAGE_PNG)
        -&gt;setData(file_get_contents($filepath));

    // Construct request
    $parent = "projects/$projectId/locations/global";
    $item = (new ContentItem())
        -&gt;setByteItem($fileBytes);
    $inspectConfig = (new InspectConfig())
        // The infoTypes of information to match
        -&gt;setInfoTypes([
            (new InfoType())-&gt;setName('PHONE_NUMBER'),
            (new InfoType())-&gt;setName('EMAIL_ADDRESS'),
            (new InfoType())-&gt;setName('CREDIT_CARD_NUMBER')
        ])
        // Whether to include the matching string
        -&gt;setIncludeQuote(true);

    // Run request
    $response = $dlp-&gt;inspectContent([
        'parent' =&gt; $parent,
        'inspectConfig' =&gt; $inspectConfig,
        'item' =&gt; $item
    ]);

    // Print the results
    $findings = $response-&gt;getResult()-&gt;getFindings();
    if (count($findings) == 0) {
        print('No findings.' . PHP_EOL);
    } else {
        print('Findings:' . PHP_EOL);
        foreach ($findings as $finding) {
            print('  Quote: ' . $finding-&gt;getQuote() . PHP_EOL);
            print('  Info type: ' . $finding-&gt;getInfoType()-&gt;getName() . PHP_EOL);
            $likelihoodString = Likelihood::name($finding-&gt;getLikelihood());
            print('  Likelihood: ' . $likelihoodString . PHP_EOL);
        }
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Ruby" id="dlp-inspect-file-ruby" track-metadata-position="dlp-inspect-file" track-name="ruby" track-type="sampleTabNav">Ruby</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="ruby" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-dlp/samples/sample.rb" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-dlp/samples/sample.rb" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="ruby" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-rb" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/google-cloud-ruby/google-cloud-dlp/samples/sample.rb" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/google-cloud-ruby/google-cloud-dlp/samples/sample.rb/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no"># project_id   = "Your Google Cloud project ID"
# filename     = "The file path to the file to inspect"
# max_findings = "Maximum number of findings to report per request (0 = server maximum)"

require "google/cloud/dlp"

dlp = Google::Cloud::Dlp.dlp_service
inspect_config = {
  # The types of information to match
  info_types:     [{ name: "PERSON_NAME" }, { name: "PHONE_NUMBER" }],

  # Only return results above a likelihood threshold (0 for all)
  min_likelihood: :POSSIBLE,

  # Limit the number of findings (0 for no limit)
  limits:         { max_findings_per_request: max_findings },

  # Whether to include the matching string in the response
  include_quote:  true
}

# The item to inspect
file = File.open filename, "rb"
item_to_inspect = { byte_item: { type: :BYTES_TYPE_UNSPECIFIED, data: file.read } }

# Run request
parent = "projects/#{project_id}/locations/global"
response = dlp.inspect_content parent:         parent,
                               inspect_config: inspect_config,
                               item:           item_to_inspect

# Print the results
if response.result.findings.empty?
  puts "No findings"
else
  response.result.findings.each do |finding|
    puts "Quote:      #{finding.quote}"
    puts "Info type:  #{finding.info_type.name}"
    puts "Likelihood: #{finding.likelihood}"
  end
end</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-inspect-file-csharp" track-metadata-position="dlp-inspect-file" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-file" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectFile.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectFile.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-file" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-inspect-file" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectFile.cs" data-region-tag="dlp_inspect_file" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectFile.cs/HEAD/dlp_inspect_file" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;
using static Google.Cloud.Dlp.V2.ByteContentItem.Types;

public class DlpInspectFile
{
    public static IEnumerable&lt;Finding&gt; InspectFile(string projectId, string filePath, BytesType fileType)
    {
        // Instantiate a client.
        var dlp = DlpServiceClient.Create();

        // Get the bytes from the file.
        ByteString fileBytes;
        using (Stream f = new FileStream(filePath, FileMode.Open))
        {
            fileBytes = ByteString.FromStream(f);
        }

        // Construct a request.
        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = new ContentItem
            {
                ByteItem = new ByteContentItem()
                {
                    Data = fileBytes,
                    Type = fileType
                }
            },
            InspectConfig = new InspectConfig
            {
                // The info types of information to match
                InfoTypes =
                {
                    new InfoType { Name = "PHONE_NUMBER" },
                    new InfoType { Name = "EMAIL_ADDRESS" },
                    new InfoType { Name = "CREDIT_CARD_NUMBER" }
                },
                // The minimum likelihood before returning a match
                MinLikelihood = Likelihood.Unspecified,
                // Whether to include the matching string
                IncludeQuote = true,
                Limits = new InspectConfig.Types.FindingLimits
                {
                    // The maximum number of findings to report per request
                    // (0 = server maximum)
                    MaxFindingsPerRequest = 0
                }
            }
        };

        // Execute request
        var response = dlp.InspectContent(request);

        // Inspect response
        var findings = response.Result.Findings;
        if (findings.Any())
        {
            Console.WriteLine("Findings:");
            foreach (var finding in findings)
            {
                Console.WriteLine($"Quote: {finding.Quote}");
                Console.WriteLine($"InfoType: {finding.InfoType}");
                Console.WriteLine($"Likelihood: {finding.Likelihood}");
            }
        }
        else
        {
            Console.WriteLine("No findings.");
        }
        return findings;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Try it out" id="try_it_out">Try it out</h2>
<p>You can try each of these examples out yourselfâor experiment with your
own imagesâin the API Explorer on the reference page for
<code dir="ltr" translate="no">content.inspect</code>:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.content/inspect?apix=true">Go to API Explorer</a> </p>
<aside class="note"><strong>Tip:</strong> For experiments with non-sensitive
  materials, it's sufficient to uncheck <strong>Google OAuth 2.0</strong> and
  enter <code dir="ltr" translate="no">projects/testff</code> in the <strong>parent</strong>
  field.</aside>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/dlp/docs/concepts-image-redaction">image inspection and redaction</a>.</li>
<li>Learn how to <a href="/dlp/docs/redacting-sensitive-data-images">redact sensitive data from images</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-templates-inspect]</H1></p><div class="devsite-article-body clearfix">
<p>This topic describes in detail how to create a new inspection template. For a
quick walkthrough of how to create a new inspection template using the
Cloud Data Loss Prevention UI, see <a href="/dlp/docs/quickstart-create-template-inspect">Quickstart: Creating a Cloud DLP
inspection template</a>.</p>
<h2 data-text="About templates" id="about_templates">About templates</h2>
<p>You can use <em>templates</em> to create and persist configuration information to use
with Cloud DLP. Templates are useful for decoupling configuration
informationâsuch as what you inspect for and how you de-identify
itâfrom the implementation of your requests. Templates provide a way to
re-use configuration and enable consistency across users and datasets. In
addition, whenever you update a template, it's updated for any job trigger
that uses it.</p>
<p>Cloud DLP supports inspection templates, which are discussed in
this topic, and de-identification templates, which are discussed in
<a href="/dlp/docs/creating-templates-deid">Creating Cloud DLP de-identification
templates</a>.</p>
<p>For conceptual information about templates in Cloud DLP, see
<a href="/dlp/docs/concepts-templates">Templates</a>.</p>
<h2 data-text="Create a new inspection template" id="create_a_new_inspection_template">Create a new inspection template</h2>
<p>To create a new Cloud DLP template:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-create-template-code-sample">
<section>
<h3 data-text="Console" id="dlp-create-template-console" track-metadata-position="dlp-create-template" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Template</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/creating-inspection-templates-create-new.png" width="800"/></p>
<p>Alternatively, click the following button:</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/list/templates;source=7" target="console">Create new template</a> </p></li>
</ol>
<p>The Create template page contains the following sections:</p>
<ul>
<li><a href="#define-template">Define template</a></li>
<li><a href="#configure-detection">Configure detection</a></li>
</ul>
<h3 data-text="Define template" id="define-template">Define template</h3>
<p>Under <strong>Define template</strong>, enter an identifier for the inspection template. This
is how you'll refer to the template when you run a job, create a job trigger,
and so on. You can use letters, numbers, and hyphens. If you want, you can also
enter a more human-friendly display name, as well as a description to better
remember what the template does.</p>
<h3 data-text="Configure detection" id="configure-detection">Configure detection</h3>
<p>Next, you configure what Cloud DLP detects in your content by
choosing an infoType and other options.</p>
<p>InfoType detectors find sensitive data of a certain type. For example, the
Cloud DLP <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> infoType detector finds
US Social Security numbers. In addition to the built-in infoType detectors, you
can create your own <a href="/dlp/docs/creating-custom-infotypes">custom infoType detectors</a>.</p>
<p>Under <strong>InfoTypes</strong>, choose the infoType detector that corresponds to a data
type you want to scan for. You can also leave this field blank to scan for all
default infoTypes. More information about each detector is provided in
<a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</p>
<p>You can also add custom infoType detectors in the <strong>Custom infoTypes</strong> section,
and customize both built-in and custom infoType detectors in the <strong>Inspection
rulesets</strong> section.</p>
<h5 data-text="Custom infoTypes" id="custom_infotypes">Custom infoTypes</h5>
<aside class="note">
<p><strong>Note:</strong> Be aware that any custom infoType detector you create here is
         specific to this workflow and can't be reused elsewhere. The one exception is "Stored
         infoType," which requires that you create the stored custom infoType detector before
         specifying it here. To create a custom infoType detector that you can use in multiple jobs
         or templates, see <a href="/dlp/docs/creating-custom-infotypes">Creating custom infoType
         detectors</a>.</p></aside>
<p>
  To add a custom infoType detector:
</p>
<ol>
<li>Click <strong>Add custom infoType</strong>.</li>
<li>Choose the type of custom infoType detector you want to create:
  <ul>
<li><strong>Words or phrases:</strong> Matches on one or more words or phrases that you enter
      into the field. Use this custom infoType when you have just a few words or phrases to search
      for. Give your custom infoType a name, and then, under <strong>List of words or
      phrases</strong>, type the word or phrase you want Cloud DLP to match on. To
      search on multiple words or phrases, press Enter after each one. For more information, see
      <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
      detector</a>.</li>
<li><strong>Dictionary path:</strong> Searches your content for items in a list of words and
      phrases. The list is stored in a text file in Cloud Storage. Use this custom infoType
      when you have anywhere from a few to several hundred thousand words or phrases to search for.
      This method is also useful if your list contains sensitive elements and you don't want to
      store them inside of a job or template. Give your custom infoType a name, and then, under
      <strong>Dictionary location</strong>, enter or browse to the Cloud Storage path where the
      dictionary file is stored. For more information, see
      <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
      detector</a>.</li>
<li><strong>Regex:</strong> Matches content based on a regular expression. Give your custom
      infoType a name, and then, in the <strong>Regex</strong> field, enter a regex pattern to match
      words and phrases. See the <a href="https://github.com/google/re2/wiki/Syntax">supported regex
      syntax</a>.</li>
<li><strong>Stored infoType:</strong> This option adds a stored custom dictionary detector,
      which is a kind of dictionary detector that is built from either a large text file stored in
      Cloud Storage or a single column of a BigQuery table. Use this kind of
      custom infoType when you have anywhere from several hundred thousand to tens of millions of
      words or phrases to search for. Be aware that this is the only option in this menu for which
      you must have already created the stored infoType to use it. Give your custom infoType a
      name (different from the name you gave the stored infoType), and then, in the <strong>Stored
      infoType</strong> field, enter the name of the stored infoType. For more information about
      creating stored custom dictionaries, see
      <a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary
        detector</a>.</li>
</ul></li>
</ol>
<p>
  Click <strong>Add custom infoType</strong> again to add additional custom infoType detectors.
</p>
<h5 data-text="Inspection rulesets" id="inspection_rulesets">Inspection rulesets</h5>
<p>
  Inspection rulesets allow you to customize both built-in and custom infoType detectors using
  context rules. The two types of inspection rules are:
</p>
<ul>
<li><em><a href="/dlp/docs/creating-custom-infotypes-rules#exclusion-rules">Exclusion
    rules</a></em>, which help exclude false or unwanted findings.</li>
<li><em><a href="/dlp/docs/creating-custom-infotypes-rules#hotword_rules">Hotword rules</a></em>,
    which help detect additional findings.</li>
</ul>
<p>
  To add a new ruleset, first specify one or more built-in or custom infoType detectors in the
  <strong>InfoTypes</strong> section. These are the infoType detectors that your rulesets will be
  modifying. Then, do the following:
</p>
<ol>
<li>Click in the <strong>Choose infoTypes</strong> field. The infoType or infoTypes you specified
    previously appear below the field in a menu, as shown here:</li>
<img alt="Screenshot of the DLP UI's inspection rulesets configuration." class="screenshot" src="https://cloud.google.com/dlp/docs/images/inspection-rulesets-new-ruleset.png" width="532">
<li>Choose an infoType from the menu, and then click <strong>Add rule</strong>. A menu appears
    with the two options <strong>Hotword rule</strong> and <strong>Exclusion rule</strong>.</li>
</img></ol>
<p>
  For hotword rules, choose <strong>Hotword rules</strong>. Then, do the following:
</p>
<ol>
<li>In the <strong>Hotword</strong> field, enter a regular expression that Cloud DLP
    should look for.</li>
<li>From the <strong>Hotword proximity</strong> menu, choose whether the hotword you entered is
    found before or after the chosen infoType.</li>
<li>In <strong>Hotword distance from infoType</strong>, enter the approximate number of characters
    between the hotword and the chosen infoType.</li>
<li>In <strong>Confidence level adjustment</strong>, choose whether to assign matches a fixed
    <a href="/dlp/docs/likelihood">likelihood</a> level, or to increase or decrease the default
    likelihood level by a certain amount.</li>
</ol>
<p>
  For exclusion rules, choose <strong>Exclusion rules</strong>. Then, do the following:
</p>
<ol>
<li>In the <strong>Exclude</strong> field, enter a regular expression (regex) that
    Cloud DLP should look for.</li>
<li>From the <strong>Matching type</strong> menu, choose one of the following:</li>
<ul>
<li><strong>Full match</strong>: The finding must completely match the regex.</li>
<li><strong>Partial match</strong>: A substring of the finding can match the regex.</li>
<li><strong>Inverse match</strong>: The finding doesn't match the regex.</li>
</ul>
</ol>
<p>
  You can add additional hotword or exclusion rules and rulesets to further refine your scan
  results.
</p>
<h3 data-text="Confidence threshold" id="confidence">Confidence threshold</h3>
<p>Every time Cloud DLP detects a potential match for sensitive data,
it assigns it a <a href="/dlp/docs/likelihood">likelihood</a> value on a scale from "Very unlikely"
to "Very likely." When you set a likelihood value here, you are instructing
Cloud DLP to only match on data that corresponds to that likelihood
value or higher.</p>
<p>The default value of "Possible" is sufficient for most purposes. If you
routinely get matches that are too broad, move the slider up. If you get
too few matches, move the slider down.</p>
<p>When you're done, click <strong>Create</strong> to create the template. The template's
summary information page appears.</p>
<p>To return to the main Cloud DLP page, click the <strong>Back</strong> arrow in
the Cloud console.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-create-template-protocol" track-metadata-position="dlp-create-template" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>An inspection template is a reusable inspection configuration plus some
metadata. In API terms, the
<a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates#InspectTemplate"><code dir="ltr" translate="no">InspectTemplate</code></a>
object is effectively an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
object that includes a few more fields of metadata, such as a display name and
a description. Therefore, to create a new inspection template, the basic steps
are:</p>
<ol>
<li>Start with an
 <a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
 object.</li>
<li>Call or POST the <code dir="ltr" translate="no">create</code> method of either the
 <a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates"><code dir="ltr" translate="no">projects.inspectTemplates</code></a>
 or
 <a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates"><code dir="ltr" translate="no">organizations.inspectTemplates</code></a>
 resource, including in your request an
 <a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates#InspectTemplate"><code dir="ltr" translate="no">InspectTemplate</code></a>
 object that contains a display name, a description, and that
 <code dir="ltr" translate="no">InspectConfig</code> object.</li>
</ol>
<p>The returned <code dir="ltr" translate="no">InspectTemplate</code> will be ready for use immediately. You can
reference it in other calls or jobs by its <code dir="ltr" translate="no">name</code>. You can list the existing
templates by calling the <code dir="ltr" translate="no">*.inspectTemplates.list</code> method. To view a specific
template, call the <code dir="ltr" translate="no">*.inspectTemplates.get</code> method. Note that the limit for the
number of templates you can create is 1000.</p>
<p>If you've already had some experience inspecting text, images, or structured
content for sensitive content using Cloud DLP, you've already
created an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
object. One additional step turns it into an
<a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates#InspectTemplate"><code dir="ltr" translate="no">InspectTemplate</code></a>
object.</p>
<p>The following JSON is an example of what you can send to the
<a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/create"><code dir="ltr" translate="no">projects.inspectTemplates.create</code></a>
method. This JSON creates a new template with the given display name and
description, and scans for matches on the infoTypes <code dir="ltr" translate="no">PHONE_NUMBER</code> and
<code dir="ltr" translate="no">US_TOLLFREE_PHONE_NUMBER</code>. It will include in its findings up to 100 matches
whose likelihoods are at least <code dir="ltr" translate="no">POSSIBLE</code>, and will include a snippet of
context for each.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/inspectTemplates?key={YOUR_API_KEY}

{
  "inspectTemplate":{
    "displayName":"Phone number inspection",
    "description":"Scans for phone numbers",
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PHONE_NUMBER"
        },
        {
          "name":"US_TOLLFREE_PHONE_NUMBER"
        }
      ],
      "minLikelihood":"POSSIBLE",
      "limits":{
        "maxFindingsPerRequest":100
      },
      "includeQuote":true
    }
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<p>The response JSON looks like the following:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT_ID]/inspectTemplates/[JOB_ID]",
  "displayName":"Phone number inspection",
  "description":"Scans for phone numbers",
  "createTime":"2018-11-30T07:26:28.164136Z",
  "updateTime":"2018-11-30T07:26:28.164136Z",
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"PHONE_NUMBER"
      },
      {
        "name":"US_TOLLFREE_PHONE_NUMBER"
      }
    ],
    "minLikelihood":"POSSIBLE",
    "limits":{
      "maxFindingsPerRequest":100
    },
    "includeQuote":true
  }
}
</code></pre><aside class="note"><strong>Note:</strong><span> This template was created at the project level, but you could also create
it at the organization level using the
<a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/create"><code dir="ltr" translate="no">organizations.inspectTemplates.create</code></a>
method.</span></aside>
<p>To quickly try this out, you can use the APIs Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.inspectTemplates.create"></div>
</section>
<section>
<h3 data-text="Java" id="dlp-create-template-java" track-metadata-position="dlp-create-template" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-template" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesCreate.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesCreate.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-template" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-create-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesCreate.java" data-region-tag="dlp_create_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesCreate.java/HEAD/dlp_create_inspect_template" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.CreateInspectTemplateRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectTemplate;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

class TemplatesCreate {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    createInspectTemplate(projectId);
  }

  // Creates a template to persist configuration information
  public static void createInspectTemplate(String projectId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {
      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      List&lt;InfoType&gt; infoTypes =
          Stream.of("PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER")
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());

      // Construct the inspection configuration for the template
      InspectConfig inspectConfig = InspectConfig.newBuilder().addAllInfoTypes(infoTypes).build();

      // Optionally set a display name and a description for the template
      String displayName = "Inspection Config Template";
      String description = "Save configuration for future inspection jobs";

      // Build the template
      InspectTemplate inspectTemplate =
          InspectTemplate.newBuilder()
              .setInspectConfig(inspectConfig)
              .setDisplayName(displayName)
              .setDescription(description)
              .build();

      // Create the request to be sent by the client
      CreateInspectTemplateRequest createInspectTemplateRequest =
          CreateInspectTemplateRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectTemplate(inspectTemplate)
              .build();

      // Send the request to the API and process the response
      InspectTemplate response =
          dlpServiceClient.createInspectTemplate(createInspectTemplateRequest);
      System.out.printf("Template created: %s", response.getName());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-create-template-nodejs" track-metadata-position="dlp-create-template" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-template" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/createInspectTemplate.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/createInspectTemplate.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-template" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-create-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/createInspectTemplate.js" data-region-tag="dlp_create_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/createInspectTemplate.js/HEAD/dlp_create_inspect_template" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// Whether to include the matching string
// const includeQuote = true;

// (Optional) The name of the template to be created.
// const templateId = 'my-template';

// (Optional) The human-readable name to give the template
// const displayName = 'My template';

async function createInspectTemplate() {
  // Construct the inspection configuration for the template
  const inspectConfig = {
    infoTypes: infoTypes,
    minLikelihood: minLikelihood,
    includeQuote: includeQuote,
    limits: {
      maxFindingsPerRequest: maxFindings,
    },
  };

  // Construct template-creation request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    inspectTemplate: {
      inspectConfig: inspectConfig,
      displayName: displayName,
    },
    templateId: templateId,
  };

  const [response] = await dlp.createInspectTemplate(request);
  const templateName = response.name;
  console.log(`Successfully created template ${templateName}.`);
}
createInspectTemplate();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-create-template-python" track-metadata-position="dlp-create-template" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-template" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-template" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-create-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/templates.py" data-region-tag="dlp_create_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/templates.py/HEAD/dlp_create_inspect_template" translate="no"><code dir="ltr" translate="no">def create_inspect_template(
    project,
    info_types,
    template_id=None,
    display_name=None,
    min_likelihood=None,
    max_findings=None,
    include_quote=None,
):
    """Creates a Data Loss Prevention API inspect template.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        template_id: The id of the template. If omitted, an id will be randomly
            generated.
        display_name: The optional display name of the template.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        include_quote: Boolean for whether to display a quote of the detected
            information in the results.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "min_likelihood": min_likelihood,
        "include_quote": include_quote,
        "limits": {"max_findings_per_request": max_findings},
    }

    inspect_template = {
        "inspect_config": inspect_config,
        "display_name": display_name,
    }

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.create_inspect_template(
        request={
            "parent": parent,
            "inspect_template": inspect_template,
            "template_id": template_id,
        }
    )

    print("Successfully created template {}".format(response.name))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-create-template-go" track-metadata-position="dlp-create-template" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-template" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/create.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/create.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-template" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-create-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/template/create.go" data-region-tag="dlp_create_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/template/create.go/HEAD/dlp_create_inspect_template" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// createInspectTemplate creates a template with the given configuration.
func createInspectTemplate(w io.Writer, projectID string, templateID, displayName, description string, infoTypeNames []string) error {
	// projectID := "my-project-id"
	// templateID := "my-template"
	// displayName := "My Template"
	// description := "My template description"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}

	// Create a configured request.
	req := &amp;dlppb.CreateInspectTemplateRequest{
		Parent:     fmt.Sprintf("projects/%s/locations/global", projectID),
		TemplateId: templateID,
		InspectTemplate: &amp;dlppb.InspectTemplate{
			DisplayName: displayName,
			Description: description,
			InspectConfig: &amp;dlppb.InspectConfig{
				InfoTypes:     infoTypes,
				MinLikelihood: dlppb.Likelihood_POSSIBLE,
				Limits: &amp;dlppb.InspectConfig_FindingLimits{
					MaxFindingsPerRequest: 10,
				},
			},
		},
	}
	// Send the request.
	resp, err := client.CreateInspectTemplate(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateInspectTemplate: %v", err)
	}
	// Print the result.
	fmt.Fprintf(w, "Successfully created inspect template: %v", resp.GetName())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-create-template-php" track-metadata-position="dlp-create-template" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-template" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/create_inspect_template.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/create_inspect_template.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-template" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-create-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/create_inspect_template.php" data-region-tag="dlp_create_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/create_inspect_template.php/HEAD/dlp_create_inspect_template" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\InspectTemplate;
use Google\Cloud\Dlp\V2\Likelihood;
use Google\Cloud\Dlp\V2\InspectConfig\FindingLimits;

/**
 * Create a new DLP inspection configuration template.
 *
 * @param string $callingProjectId project ID to run the API call under
 * @param string $templateId       name of the template to be created
 * @param string $displayName      (Optional) The human-readable name to give the template
 * @param string $description      (Optional) A description for the trigger to be created
 * @param int    $maxFindings      (Optional) The maximum number of findings to report per request (0 = server maximum)
 */
function create_inspect_template(
    string $callingProjectId,
    string $templateId,
    string $displayName = '',
    string $description = '',
    int $maxFindings = 0
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // ----- Construct inspection config -----
    // The infoTypes of information to match
    $personNameInfoType = (new InfoType())
        -&gt;setName('PERSON_NAME');
    $phoneNumberInfoType = (new InfoType())
        -&gt;setName('PHONE_NUMBER');
    $infoTypes = [$personNameInfoType, $phoneNumberInfoType];

    // Whether to include the matching string in the response
    $includeQuote = true;

    // The minimum likelihood required before returning a match
    $minLikelihood = likelihood::LIKELIHOOD_UNSPECIFIED;

    // Specify finding limits
    $limits = (new FindingLimits())
        -&gt;setMaxFindingsPerRequest($maxFindings);

    // Create the configuration object
    $inspectConfig = (new InspectConfig())
        -&gt;setMinLikelihood($minLikelihood)
        -&gt;setLimits($limits)
        -&gt;setInfoTypes($infoTypes)
        -&gt;setIncludeQuote($includeQuote);

    // Construct inspection template
    $inspectTemplate = (new InspectTemplate())
        -&gt;setInspectConfig($inspectConfig)
        -&gt;setDisplayName($displayName)
        -&gt;setDescription($description);

    // Run request
    $parent = "projects/$callingProjectId/locations/global";
    $template = $dlp-&gt;createInspectTemplate($parent, $inspectTemplate, [
        'templateId' =&gt; $templateId
    ]);

    // Print results
    printf('Successfully created template %s' . PHP_EOL, $template-&gt;getName());
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-create-template-csharp" track-metadata-position="dlp-create-template" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-template" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateCreate.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateCreate.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-template" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-create-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateCreate.cs" data-region-tag="dlp_create_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateCreate.cs/HEAD/dlp_create_inspect_template" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using System;

public class InspectTemplateCreate
{
    public static InspectTemplate Create(
        string projectId,
        string templateId,
        string displayName,
        string description,
        Likelihood likelihood,
        int maxFindings,
        bool includeQuote)
    {
        var client = DlpServiceClient.Create();

        var request = new CreateInspectTemplateRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectTemplate = new InspectTemplate
            {
                DisplayName = displayName,
                Description = description,
                InspectConfig = new InspectConfig
                {
                    MinLikelihood = likelihood,
                    Limits = new InspectConfig.Types.FindingLimits
                    {
                        MaxFindingsPerRequest = maxFindings
                    },
                    IncludeQuote = includeQuote
                },
            },
            TemplateId = templateId
        };

        var response = client.CreateInspectTemplate(request);

        Console.WriteLine($"Successfully created template {response.Name}.");

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Use inspection templates" id="use_inspection_templates">Use inspection templates</h2>
<p>After you create a new inspection template, you can use it when creating a new
inspection job or job trigger. Whenever you update that template, it's
updated in any job trigger that uses it. For more information, including code
samples, see:</p>
<ul>
<li><a href="/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive data</a></li>
<li><a href="/dlp/docs/creating-job-triggers">Creating and scheduling Cloud DLP inspection
jobs</a></li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-use-template-code-sample">
<section>
<h3 data-text="Console" id="dlp-use-template-console" track-metadata-position="dlp-use-template" track-name="console" track-type="sampleTabNav">Console</h3>
<p>To get started quickly using your new template, follow the instructions
provided in <a href="/dlp/docs/quickstart-create-job-trigger">Quickstart creating a Cloud DLP inspection
template</a> with the following change:</p>
<ul>
<li>In the <strong>Configure detection</strong> &gt; <strong>Templates</strong> section, click in the
<strong>Template name</strong> field and select the template you just created.</li>
</ul>
<p>For a more in-depth walkthrough of how to scan your content, see <a href="/dlp/docs/creating-job-triggers">Creating and
scheduling Cloud DLP inspection jobs</a>,
paying particular attention to the "<a href="/dlp/docs/creating-job-triggers#configure-detection">Configure
detection</a>" section.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-use-template-protocol" track-metadata-position="dlp-use-template" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>You can use the template identifier you specified when creating the template
anywhere <code dir="ltr" translate="no">inspectTemplateName</code> is accepted, such as:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">projects.content.inspect</code></a>:
Finds potentially sensitive data in content using the template as its
configuration.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">projects.content.deidentify</code></a>:
Finds and de-identifies potentially sensitive data in content using the
template as its configuration. Be aware that this method uses both an
inspection template and a de-identification template.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create"><code dir="ltr" translate="no">projects.dlpJobs.create</code></a>,
in the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig"><code dir="ltr" translate="no">InspectJobConfig</code></a>
object: Creates an inspection job that includes the template as its
configuration.</li>
</ul>
</section>
</div>
<h2 data-text="List inspection templates" id="list_inspection_templates">List inspection templates</h2>
<p>To list all inspection templates that have been created in the current project
or organization:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-list-templates-code-sample">
<section>
<h3 data-text="Console" id="dlp-list-templates-console" track-metadata-position="dlp-list-templates" track-name="console" track-type="sampleTabNav">Console</h3>
<aside class="note"><strong>Note:</strong><span> There is currently no way to view organization-level templates in the
Cloud DLP UI.</span></aside>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP UI</a> </p></li>
<li><p>Click the <strong>Templates</strong> tab.</p></li>
</ol>
<p>The console displays a list of all inspection templates for the current project.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-list-templates-protocol" track-metadata-position="dlp-list-templates" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>Use one of the <code dir="ltr" translate="no">*.*.list</code> methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/list"><code dir="ltr" translate="no">organizations.inspectTemplates.list</code></a></li>
<li><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/list"><code dir="ltr" translate="no">projects.inspectTemplates.list</code></a></li>
</ul>
</section>
<section>
<h3 data-text="Java" id="dlp-list-templates-java" track-metadata-position="dlp-list-templates" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.dlp.v2.DlpServiceClient.ListInspectTemplatesPagedResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectTemplate;
import com.google.privacy.dlp.v2.ListInspectTemplatesRequest;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;

class TemplatesList {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    listInspectTemplates(projectId);
  }

  // Lists all templates associated with a given project
  public static void listInspectTemplates(String projectId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Create the request to be sent by the client
      ListInspectTemplatesRequest request =
          ListInspectTemplatesRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setPageSize(1)
              .build();

      // Send the request
      ListInspectTemplatesPagedResponse response = dlpServiceClient.listInspectTemplates(request);

      // Parse through and process the response
      System.out.println("Templates found:");
      for (InspectTemplate template : response.getPage().getResponse().getInspectTemplatesList()) {
        System.out.printf("Template name: %s\n", template.getName());
        if (template.getDisplayName() != null) {
          System.out.printf("\tDisplay name: %s \n", template.getDisplayName());
          System.out.printf("\tCreate time: %s \n", template.getCreateTime());
          System.out.printf("\tUpdate time: %s \n", template.getUpdateTime());

          // print inspection config
          InspectConfig inspectConfig = template.getInspectConfig();
          for (InfoType infoType : inspectConfig.getInfoTypesList()) {
            System.out.printf("\tInfoType: %s\n", infoType.getName());
          }
          System.out.printf("\tMin likelihood: %s\n", inspectConfig.getMinLikelihood());
          System.out.printf("\tLimits: %s\n", inspectConfig.getLimits().getMaxFindingsPerRequest());
        }
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-list-templates-nodejs" track-metadata-position="dlp-list-templates" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listInspectTemplates.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listInspectTemplates.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/listInspectTemplates.js" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/listInspectTemplates.js/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// Helper function to pretty-print dates
const formatDate = date =&gt; {
  const msSinceEpoch = parseInt(date.seconds, 10) * 1000;
  return new Date(msSinceEpoch).toLocaleString('en-US');
};

async function listInspectTemplates() {
  // Construct template-listing request
  const request = {
    parent: `projects/${projectId}/locations/global`,
  };

  // Run template-deletion request
  const [templates] = await dlp.listInspectTemplates(request);

  templates.forEach(template =&gt; {
    console.log(`Template ${template.name}`);
    if (template.displayName) {
      console.log(`  Display name: ${template.displayName}`);
    }

    console.log(`  Created: ${formatDate(template.createTime)}`);
    console.log(`  Updated: ${formatDate(template.updateTime)}`);

    const inspectConfig = template.inspectConfig;
    const infoTypes = inspectConfig.infoTypes.map(x =&gt; x.name);
    console.log('  InfoTypes:', infoTypes.join(' '));
    console.log('  Minimum likelihood:', inspectConfig.minLikelihood);
    console.log('  Include quotes:', inspectConfig.includeQuote);

    const limits = inspectConfig.limits;
    console.log('  Max findings per request:', limits.maxFindingsPerRequest);
  });
}

listInspectTemplates();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-list-templates-python" track-metadata-position="dlp-list-templates" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/templates.py" data-region-tag="dlp_list_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/templates.py/HEAD/dlp_list_templates" translate="no"><code dir="ltr" translate="no">def list_inspect_templates(project):
    """Lists all Data Loss Prevention API inspect templates.
    Args:
        project: The Google Cloud project id to use as a parent resource.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.list_inspect_templates(request={"parent": parent})

    for template in response:
        print("Template {}:".format(template.name))
        if template.display_name:
            print("  Display Name: {}".format(template.display_name))
        print("  Created: {}".format(template.create_time))
        print("  Updated: {}".format(template.update_time))

        config = template.inspect_config
        print(
            "  InfoTypes: {}".format(", ".join([it.name for it in config.info_types]))
        )
        print("  Minimum likelihood: {}".format(config.min_likelihood))
        print("  Include quotes: {}".format(config.include_quote))
        print(
            "  Max findings per request: {}".format(
                config.limits.max_findings_per_request
            )
        )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-list-templates-go" track-metadata-position="dlp-list-templates" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/list.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/list.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/template/list.go" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/template/list.go/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"github.com/golang/protobuf/ptypes"
	"google.golang.org/api/iterator"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// listInspectTemplates lists the inspect templates in the project.
func listInspectTemplates(w io.Writer, projectID string) error {
	// projectID := "my-project-id"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Create a configured request.
	req := &amp;dlppb.ListInspectTemplatesRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
	}

	// Send the request and iterate over the results.
	it := client.ListInspectTemplates(ctx, req)
	for {
		t, err := it.Next()
		if err == iterator.Done {
			break
		}
		if err != nil {
			return fmt.Errorf("Next: %v", err)
		}
		fmt.Fprintf(w, "Inspect template %v\n", t.GetName())
		c, err := ptypes.Timestamp(t.GetCreateTime())
		if err != nil {
			return fmt.Errorf("CreateTime Timestamp: %v", err)
		}
		fmt.Fprintf(w, "  Created: %v\n", c.Format(time.RFC1123))
		u, err := ptypes.Timestamp(t.GetUpdateTime())
		if err != nil {
			return fmt.Errorf("UpdateTime Timestamp: %v", err)
		}
		fmt.Fprintf(w, "  Updated: %v\n", u.Format(time.RFC1123))
		fmt.Fprintf(w, "  Display Name: %q\n", t.GetDisplayName())
		fmt.Fprintf(w, "  Description: %q\n", t.GetDescription())
	}

	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-list-templates-php" track-metadata-position="dlp-list-templates" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_inspect_templates.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_inspect_templates.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/list_inspect_templates.php" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/list_inspect_templates.php/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * List DLP inspection configuration templates.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 */
function list_inspect_templates(string $callingProjectId): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;listInspectTemplates($parent);

    // Print results
    $templates = $response-&gt;iterateAllElements();

    foreach ($templates as $template) {
        printf('Template %s' . PHP_EOL, $template-&gt;getName());
        printf('  Created: %s' . PHP_EOL, $template-&gt;getCreateTime()-&gt;getSeconds());
        printf('  Updated: %s' . PHP_EOL, $template-&gt;getUpdateTime()-&gt;getSeconds());
        printf('  Display Name: %s' . PHP_EOL, $template-&gt;getDisplayName());
        printf('  Description: %s' . PHP_EOL, $template-&gt;getDescription());

        $inspectConfig = $template-&gt;getInspectConfig();
        if ($inspectConfig === null) {
            print('  No inspect config.' . PHP_EOL);
        } else {
            printf('  Minimum likelihood: %s' . PHP_EOL, $inspectConfig-&gt;getMinLikelihood());
            printf('  Include quotes: %s' . PHP_EOL, $inspectConfig-&gt;getIncludeQuote());
            $limits = $inspectConfig-&gt;getLimits();
            printf('  Max findings per request: %s' . PHP_EOL, $limits-&gt;getMaxFindingsPerRequest());
        }
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-list-templates-csharp" track-metadata-position="dlp-list-templates" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateList.cs" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateList.cs/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using System;
using Google.Api.Gax;

public class InspectTemplateList
{
    public static PagedEnumerable&lt;ListInspectTemplatesResponse, InspectTemplate&gt; List(string projectId)
    {
        var client = DlpServiceClient.Create();

        var response = client.ListInspectTemplates(
            new ListInspectTemplatesRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
            }
        );

        // Uncomment to list templates
        //PrintTemplates(response);

        return response;
    }

    public static void PrintTemplates(PagedEnumerable&lt;ListInspectTemplatesResponse, InspectTemplate&gt; response)
    {
        foreach (var template in response)
        {
            Console.WriteLine($"Template {template.Name}:");
            Console.WriteLine($"\tDisplay Name: {template.DisplayName}");
            Console.WriteLine($"\tDescription: {template.Description}");
            Console.WriteLine($"\tCreated: {template.CreateTime}");
            Console.WriteLine($"\tUpdated: {template.UpdateTime}");
            Console.WriteLine("Configuration:");
            Console.WriteLine($"\tMin Likelihood: {template.InspectConfig?.MinLikelihood}");
            Console.WriteLine($"\tInclude quotes: {template.InspectConfig?.IncludeQuote}");
            Console.WriteLine($"\tMax findings per request: {template.InspectConfig?.Limits.MaxFindingsPerRequest}");
        }
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Copy an inspection template to the global region" id="copy-to-global">Copy an inspection template to the <code dir="ltr" translate="no">global</code> region</h2>
<ol>
<li><p>Go to your configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/templates/inspect" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to Configurations</a> </p></li>
<li><p>If needed, switch to the project that contains the inspection template
that you want to use.</p></li>
<li><p>Click the <strong>Templates</strong> tab, and then click the <strong>Inspect</strong> subtab.</p></li>
<li><p>Find the template that you want to use.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>,
and then click <strong>Copy</strong>.</p></li>
<li><p>On the <strong>Create template</strong> page, in the <strong>Resource location</strong> list, select
<strong>Global (any region)</strong>.</p></li>
<li><p>Click <strong>Create</strong>.</p></li>
</ol>
<p>The template is copied to the <code dir="ltr" translate="no">global</code> region.</p>
<h2 data-text="Copy an inspection template to another project" id="copy_an_inspection_template_to_another_project">Copy an inspection template to another project</h2>
<ol>
<li><p>Go to your configurations list.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/landing/configuration/templates/inspect" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tasks">Go to Configurations</a> </p></li>
<li><p>If needed, switch to the project that contains the inspection template
that you want to use.</p></li>
<li><p>Click the <strong>Templates</strong> tab, and then click the <strong>Inspect</strong> subtab.</p></li>
<li><p>Find the template that you want to use.</p></li>
<li><p>Click <span aria-hidden="true" class="material-icons" translate="no">more_vert</span> <strong>Actions</strong>,
and then click <strong>Copy</strong>.</p></li>
<li><p>On the toolbar, click the <span aria-hidden="true" class="material-icons" translate="no">arrow_drop_down</span>
project selector, and select the project you want to copy the inspection
template to.</p>
<p>
<figure>
<img alt="Screenshot of the project selector on the toolbar" src="/dlp/docs/images/project-selector.png">
</img></figure>
</p>
<p>The <strong>Create template</strong> page reloads in the project you selected.</p></li>
<li><p>Click <strong>Create</strong>.</p></li>
</ol>
<p>The template is created in the project you selected.</p>
<h2 data-text="Delete inspection templates" id="delete_inspection_templates">Delete inspection templates</h2>
<p>To delete an inspection template:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-delete-template-code-sample">
<section>
<h3 data-text="Console" id="dlp-delete-template-console" track-metadata-position="dlp-delete-template" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP UI</a> </p></li>
<li><p>Click the <strong>Configuration</strong> tab, and then the <strong>Templates</strong> tab. The
 console displays a list of all templates for the current project.</p></li>
<li><p>In the <strong>Actions</strong> column for the template you want to delete, click the
 <b>more actions</b> menu (displayed as three dots arranged vertically)
 <img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then click <strong>Delete</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/creating-inspection-templates-templatelist-actionmenu.png" width="800"/></p></li>
</ol>
<p>Alternatively, from the list of templates, click the name of the template you
want to delete. On the template's detail page, click <strong>Delete</strong>.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-delete-template-protocol" track-metadata-position="dlp-delete-template" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>Use one of the <code dir="ltr" translate="no">*.*.delete</code> methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/delete"><code dir="ltr" translate="no">organizations.inspectTemplates.delete</code></a></li>
<li><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/delete"><code dir="ltr" translate="no">projects.inspectTemplates.delete</code></a></li>
</ul>
<p>With each <code dir="ltr" translate="no">*.*.delete</code> method, you include the resource name of the template to
be deleted.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-delete-template-java" track-metadata-position="dlp-delete-template" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.DeleteInspectTemplateRequest;
import java.io.IOException;

class TemplatesDelete {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String templateId = "your-template-id";
    deleteInspectTemplate(projectId, templateId);
  }

  // Delete an existing template
  public static void deleteInspectTemplate(String projectId, String templateId) throws IOException {
    // Construct the template name to be deleted
    String templateName = String.format("projects/%s/inspectTemplates/%s", projectId, templateId);

    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Create delete template request to be sent by the client
      DeleteInspectTemplateRequest request =
          DeleteInspectTemplateRequest.newBuilder().setName(templateName).build();

      // Send the request with the client
      dlpServiceClient.deleteInspectTemplate(request);
      System.out.printf("Deleted template: %s\n", templateName);
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-delete-template-nodejs" track-metadata-position="dlp-delete-template" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteInspectTemplate.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteInspectTemplate.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deleteInspectTemplate.js" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deleteInspectTemplate.js/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The name of the template to delete
// Parent project ID is automatically extracted from this parameter
// const templateName = 'projects/YOUR_PROJECT_ID/inspectTemplates/#####'
async function deleteInspectTemplate() {
  // Construct template-deletion request
  const request = {
    name: templateName,
  };

  // Run template-deletion request
  await dlp.deleteInspectTemplate(request);
  console.log(`Successfully deleted template ${templateName}.`);
}

deleteInspectTemplate();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-delete-template-python" track-metadata-position="dlp-delete-template" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/templates.py" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/templates.py/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">def delete_inspect_template(project, template_id):
    """Deletes a Data Loss Prevention API template.
    Args:
        project: The id of the Google Cloud project which owns the template.
        template_id: The id of the template to delete.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Combine the template id with the parent id.
    template_resource = "{}/inspectTemplates/{}".format(parent, template_id)

    # Call the API.
    dlp.delete_inspect_template(request={"name": template_resource})

    print("Template {} successfully deleted.".format(template_resource))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-delete-template-go" track-metadata-position="dlp-delete-template" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/delete.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/delete.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/template/delete.go" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/template/delete.go/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deleteInspectTemplate deletes the given template.
func deleteInspectTemplate(w io.Writer, templateID string) error {
	// projectID := "my-project-id"
	// templateID := "my-template"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	req := &amp;dlppb.DeleteInspectTemplateRequest{
		Name: templateID,
	}

	if err := client.DeleteInspectTemplate(ctx, req); err != nil {
		return fmt.Errorf("DeleteInspectTemplate: %v", err)
	}
	fmt.Fprintf(w, "Successfully deleted inspect template %v", templateID)
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-delete-template-php" track-metadata-position="dlp-delete-template" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_inspect_template.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_inspect_template.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_inspect_template.php" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_inspect_template.php/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * Delete a DLP inspection configuration template.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $templateId        The name of the template to delete
 */
function delete_inspect_template(
    string $callingProjectId,
    string $templateId
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Run template deletion request
    $templateName = "projects/$callingProjectId/locations/global/inspectTemplates/$templateId";
    $dlp-&gt;deleteInspectTemplate($templateName);

    // Print results
    printf('Successfully deleted template %s' . PHP_EOL, $templateName);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-delete-template-csharp" track-metadata-position="dlp-delete-template" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateDelete.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateDelete.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateDelete.cs" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateDelete.cs/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">
using Google.Cloud.Dlp.V2;
using System;

public class InspectTemplateDelete
{
    public static object Delete(string projectId, string templateName)
    {
        var client = DlpServiceClient.Create();

        var request = new DeleteInspectTemplateRequest
        {
            Name = templateName
        };

        client.DeleteInspectTemplate(request);
        Console.WriteLine($"Successfully deleted template {templateName}.");

        return templateName;
    }
}
</code></pre>
</div>
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/listing-infotypes]</H1></p><div class="devsite-article-body clearfix">
<p>InfoTypes are types of sensitive data. Cloud Data Loss Prevention supports both
built-in and custom infoTypes. You can view all built-in infoTypes in the
<a href="/dlp/docs/infotypes-reference">infoTypes reference</a>, or you can use the
DLP API to list all built-in infoTypes programmatically.</p>
<p>The <a href="/dlp/docs/reference/rest/v2/infoTypes/list"><code dir="ltr" translate="no">infoTypes.list</code></a>
method lists all built-in infoTypes that are currently supported in
Cloud DLP. Each infoType includes the following information:</p>
<ul>
<li>The infoType identifier (ID), the internal name of the infoType.</li>
<li>The infoType display name, a human readable infoType name.</li>
<li>Whether the infoType is supported by <a href="/dlp/docs/inspecting-text">inspection</a> or <a href="/dlp/docs/concepts-risk-analysis">risk
analysis</a> operations.</li>
</ul>
<h2 data-text="Code examples" id="code_examples">Code examples</h2>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<p>To list all built-in infoType detectors:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-list-info-types-code-sample">
<section>
<h3 data-text="Console" id="dlp-list-info-types-console" track-metadata-position="dlp-list-info-types" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>Click the <strong>Configuration</strong> tab, and then click <strong>InfoTypes</strong>.</p></li>
<li><p>A table containing all built-in infoType detectors appears.</p></li>
</ol>
</section>
<section>
<h3 data-text="Protocol" id="dlp-list-info-types-protocol" track-metadata-position="dlp-list-info-types" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/infoTypes?key={YOUR_API_KEY}
</code></pre>
<p>The preceding request, when sent to the indicated endpoint, returns a list of
all predefined detectors in the following format, where:</p>
<ul>
<li><code dir="ltr" translate="no">[INFOTYPE-NAME]</code> represents the name of the infoType detector.</li>
<li><code dir="ltr" translate="no">[INFOTYPE-DISPLAY-NAME]</code> represents the display name for the detector</li>
<li><code dir="ltr" translate="no">"supportedBy"</code> is set to <code dir="ltr" translate="no">"INSPECT"</code>, <code dir="ltr" translate="no">"RISK_ANALYSIS"</code>, or both, depending
on whether the detector is supported by <a href="/dlp/docs/inspecting-text">inspection</a> or
<a href="/dlp/docs/concepts-risk-analysis">risk analysis</a> operations</li>
<li><code dir="ltr" translate="no">[INFOTYPE-DESCRIPTION]</code> represents the detector's description.</li>
</ul>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "infoTypes":[
    {
      "name":"[INFOTYPE-NAME]",
      "displayName":"[INFOTYPE-DISPLAY-NAME]",
      "supportedBy":[
        "INSPECT"
      ],
      "description":"[INFOTYPE-DESCRIPTION]"
    },
    ...
  ]
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-list-info-types-java" track-metadata-position="dlp-list-info-types" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-info-types" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InfoTypesList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InfoTypesList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-info-types" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-list-info-types" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InfoTypesList.java" data-region-tag="dlp_list_info_types" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InfoTypesList.java/HEAD/dlp_list_info_types" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.InfoTypeDescription;
import com.google.privacy.dlp.v2.ListInfoTypesRequest;
import com.google.privacy.dlp.v2.ListInfoTypesResponse;
import java.io.IOException;

public class InfoTypesList {

  public static void main(String[] args) throws IOException {
    listInfoTypes();
  }

  // Lists the types of sensitive information the DLP API supports.
  public static void listInfoTypes() throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpClient = DlpServiceClient.create()) {

      // Construct the request to be sent by the client
      ListInfoTypesRequest listInfoTypesRequest =
          ListInfoTypesRequest.newBuilder()
              // Only return infoTypes supported by certain parts of the API.
              // Supported filters are "supported_by=INSPECT" and "supported_by=RISK_ANALYSIS"
              // Defaults to "supported_by=INSPECT"
              .setFilter("supported_by=INSPECT")
              // BCP-47 language code for localized infoType friendly names.
              // Defaults to "en_US"
              .setLanguageCode("en-US")
              .build();

      // Use the client to send the API request.
      ListInfoTypesResponse response = dlpClient.listInfoTypes(listInfoTypesRequest);

      // Parse the response and process the results
      System.out.println("Infotypes found:");
      for (InfoTypeDescription infoTypeDescription : response.getInfoTypesList()) {
        System.out.println("Name : " + infoTypeDescription.getName());
        System.out.println("Display name : " + infoTypeDescription.getDisplayName());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-list-info-types-nodejs" track-metadata-position="dlp-list-info-types" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-info-types" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/metadata.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/metadata.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-info-types" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-list-info-types" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/metadata.js" data-region-tag="dlp_list_info_types" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/metadata.js/HEAD/dlp_list_info_types" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The BCP-47 language code to use, e.g. 'en-US'
// const languageCode = 'en-US';

// The filter to use
// const filter = 'supported_by=INSPECT'

async function listInfoTypes() {
  const [response] = await dlp.listInfoTypes({
    languageCode: languageCode,
    filter: filter,
  });
  const infoTypes = response.infoTypes;
  console.log('Info types:');
  infoTypes.forEach(infoType =&gt; {
    console.log(`\t${infoType.name} (${infoType.displayName})`);
  });
}

listInfoTypes();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-list-info-types-python" track-metadata-position="dlp-list-info-types" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-info-types" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/metadata.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/metadata.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-info-types" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-list-info-types" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/metadata.py" data-region-tag="dlp_list_info_types" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/metadata.py/HEAD/dlp_list_info_types" translate="no"><code dir="ltr" translate="no">def list_info_types(language_code=None, result_filter=None):
    """List types of sensitive information within a category.
    Args:
        language_code: The BCP-47 language code to use, e.g. 'en-US'.
        filter: An optional filter to only return info types supported by
                certain parts of the API. Defaults to "supported_by=INSPECT".
    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Make the API call.
    response = dlp.list_info_types(
        request={"parent": language_code, "filter": result_filter}
    )

    # Print the results to the console.
    print("Info types:")
    for info_type in response.info_types:
        print(
            "{name}: {display_name}".format(
                name=info_type.name, display_name=info_type.display_name
            )
        )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-list-info-types-go" track-metadata-position="dlp-list-info-types" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-info-types" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/metadata/info_types.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/metadata/info_types.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-info-types" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-list-info-types" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/metadata/info_types.go" data-region-tag="dlp_list_info_types" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/metadata/info_types.go/HEAD/dlp_list_info_types" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// infoTypes returns the info types in the given language and matching the given filter.
func infoTypes(w io.Writer, languageCode, filter string) error {
	// languageCode := "en-US"
	// filter := "supported_by=INSPECT"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	req := &amp;dlppb.ListInfoTypesRequest{
		LanguageCode: languageCode,
		Filter:       filter,
	}
	resp, err := client.ListInfoTypes(ctx, req)
	if err != nil {
		return fmt.Errorf("ListInfoTypes: %v", err)
	}
	for _, it := range resp.GetInfoTypes() {
		fmt.Fprintln(w, it.GetName())
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-list-info-types-php" track-metadata-position="dlp-list-info-types" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-info-types" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_info_types.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_info_types.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-info-types" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-list-info-types" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/list_info_types.php" data-region-tag="dlp_list_info_types" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/list_info_types.php/HEAD/dlp_list_info_types" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * Lists all Info Types for the Data Loss Prevention (DLP) API.
 *
 * @param string $filter        (Optional) filter to use
 * @param string $languageCode  (Optional) language code, empty for 'en-US'
 */
function list_info_types(string $filter = '', string $languageCode = ''): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Run request
    $response = $dlp-&gt;listInfoTypes([
        'languageCode' =&gt; $languageCode,
        'filter' =&gt; $filter
    ]);

    // Print the results
    print('Info Types:' . PHP_EOL);
    foreach ($response-&gt;getInfoTypes() as $infoType) {
        printf(
            '  %s (%s)' . PHP_EOL,
            $infoType-&gt;getDisplayName(),
            $infoType-&gt;getName()
        );
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-list-info-types-csharp" track-metadata-position="dlp-list-info-types" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-info-types" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InfoTypesList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InfoTypesList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-info-types" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-list-info-types" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InfoTypesList.cs" data-region-tag="dlp_list_info_types" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InfoTypesList.cs/HEAD/dlp_list_info_types" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Cloud.Dlp.V2;

public class InfoTypesList
{
    public static ListInfoTypesResponse ListInfoTypes(string languageCode, string filter)
    {
        var dlp = DlpServiceClient.Create();
        var response = dlp.ListInfoTypes(
            new ListInfoTypesRequest
            {
                LanguageCode = languageCode,
                Filter = filter
            });

        // Uncomment to print infotypes
        // Console.WriteLine("Info Types:");
        // foreach (var InfoType in response.InfoTypes)
        // {
        //     Console.WriteLine($"\t{InfoType.Name} ({InfoType.DisplayName})");
        // }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="APIs Explorer" id="apis_explorer">APIs Explorer</h2>
<p>You can list infoType detectors using APIs Explorer:</p>
<ol>
<li><p>Go to the APIs Explorer on the API reference page for <code dir="ltr" translate="no">infoTypes.list</code>
 by clicking the following button:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/infoTypes/list?apix=true">Open APIs
Explorer</a> </p></li>
<li><p>Uncheck <strong>Google OAuth 2.0</strong>.</p>
<aside class="note"><strong>Note:</strong><span> Authenticating with just an API key is only recommended for testing
 Cloud DLP with non-sensitive data.</span></aside></li>
<li><p>Click <strong>Execute</strong>.</p></li>
</ol>
<p>APIs Explorer sends a request to Cloud DLP, which sends back a
JSON object containing all supported infoType detectors.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-custom-infotypes]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention contains many built-in <a href="/dlp/docs/concepts-infotypes">infoType
detectors</a>, but you can also create your own. You can
customize detection behavior by defining your own <em>custom infoType detectors</em>,
so that Cloud DLP will inspect or de-identify sensitive data that
matches patterns that you specify. There are three kinds of custom infoType
detectors:</p>
<ul>
<li><em>Regular custom dictionary detectors</em> are simple word and phrase lists that
Cloud DLP matches on. Use regular custom dictionary detectors
when you have at most several hundred thousand words.</li>
<li><em>Stored custom dictionary detectors</em> are generated by Cloud DLP
using large lists of words or phrases stored in either Cloud Storage or
BigQuery. Use stored custom dictionary detectors when you
have a large list of words or phrasesâup to tens of millions.</li>
<li><em>Regular expressions (regex)</em> enable Cloud DLP to detect
matches based on a regular expression pattern.</li>
</ul>
<aside class="note"><strong>Note:</strong><span> You can create all three types of custom infoType detectors by using the
<a href="/dlp/docs/reference/rpc">Cloud DLP RPC service</a>, the
<a href="/dlp/docs/reference/rest">Cloud DLP REST API</a>, or one of the
<a href="/dlp/docs/libraries">Cloud DLP client libraries</a> in the programming language
of your choice. At this time, the <a href="https://console.cloud.google.com/security/dlp">Cloud DLP
UI</a> in the Google Cloud console only supports
creating new stored custom dictionary detectors.</span></aside>
<p>In addition, Cloud DLP includes the concept of <em>inspection rules</em>,
which enable you to fine-tune scan results using the following:</p>
<ul>
<li><em>Exclusion rules</em> enable you to exclude false or unwanted findings by
adding rules to a built-in or custom infoType detector.</li>
<li><em>Hotword rules</em> enable you to increase the quantity or accuracy of
findings returned by adding rules to a built-in or custom infoType detector.</li>
</ul>
<p>To learn more about custom infoType detectors, see the <a href="/dlp/docs/concepts-infotypes#custom">InfoTypes and infoType
detectors</a> concept page. For several examples that
you can use or alter as you see fit, see <a href="/dlp/docs/examples-custom-infotypes">Examples of custom infoType
detectors</a>. The rest of this topic describes how to
use Cloud DLP to create your own custom infoType detectors.</p>
<aside class="note"><strong>Note:</strong><span> A third kind of custom infoType detector, <em>surrogates</em>, is not extensively
described in these topics. Surrogates detect output from Cloud DLP
de-identification transformation
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a>.
This custom infoType detector is only used with the
<a href="/dlp/docs/reference/rest/v2/projects.content/reidentify"><code dir="ltr" translate="no">content:reidentify</code></a>
method to reverse de-identification using format-preserving encryption (FPE) in
FFX mode. For more information about how and when to use surrogate custom
infoType detectors, see <a href="/dlp/docs/pseudonymization">Pseudonymization</a>.</span></aside>
<h2 data-text="Where to use custom infoType detectors" id="where_to_use_custom_infotype_detectors">Where to use custom infoType detectors</h2>
<p>Custom infoType detectors are defined in the
<a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType"><code dir="ltr" translate="no">CustomInfoType</code></a>
object. You specify a <code dir="ltr" translate="no">CustomInfoType</code> in the
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
object when configuring the following:</p>
<ul>
<li>Inspection using
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">projects.content.inspect</code></a>.</li>
<li>Inspection jobs inside
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig"><code dir="ltr" translate="no">InspectJobConfig</code></a>.</li>
<li>Inspection templates inside
<a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates#InspectTemplate"><code dir="ltr" translate="no">InspectTemplate</code></a>.</li>
<li>De-identification using
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">projects.content.deidentify</code></a>.</li>
<li>De-identification templates inside
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#resource-deidentifytemplate"><code dir="ltr" translate="no">DeidentifyTemplate</code></a>.</li>
<li>Re-identification of content that has been de-identified with FPE in FFX
mode using
<a href="/dlp/docs/reference/rest/v2/projects.content/reidentify"><code dir="ltr" translate="no">projects.content.reidentify</code></a>.
This scenario is specific to surrogate custom infoType detectors.</li>
</ul>
<h2 data-text="API overview" id="api-overview">API overview</h2>
<p>The
<a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType"><code dir="ltr" translate="no">CustomInfoType</code></a>
object allows you to create a custom infoType detector for new content or to
fine-tune the results returned by pre-defined infoType detectors.</p>
<p>The <code dir="ltr" translate="no">CustomInfoType</code> object is comprised of the following fields, which are set
as described:</p>
<ul>
<li><code dir="ltr" translate="no">"infotype"</code>: The name of the custom infoType detector, contained in an
<a href="/dlp/docs/reference/rest/v2/InfoType"><code dir="ltr" translate="no">InfoType</code></a>
object.</li>
<li><code dir="ltr" translate="no">"likelihood"</code>: The default
<a href="/dlp/docs/reference/rest/v2/InspectConfig#Likelihood"><code dir="ltr" translate="no">Likelihood</code></a>
value to return for this custom infoType detector. You can specify alternate
<code dir="ltr" translate="no">Likelihood</code> values in <code dir="ltr" translate="no">"detectionRules"</code> that will supersede this base
<code dir="ltr" translate="no">Likelihood</code> if the finding meets the criteria specified by the rule. If
you don't include the <code dir="ltr" translate="no">"likelihood"</code> field, the custom infoType detector
defaults to <code dir="ltr" translate="no">VERY_LIKELY</code>. For more information about likelihood, see the
<a href="/dlp/docs/likelihood">Likelihood</a> concept page.</li>
<li><code dir="ltr" translate="no">"detectionRules"</code>: A set of
<a href="/dlp/docs/reference/rest/v2/InspectConfig#DetectionRule"><code dir="ltr" translate="no">DetectionRule</code></a>
objects to additionally apply to all findings of this custom infoType
detector. This is where you specify hotword rules, as
<a href="/dlp/docs/reference/rest/v2/InspectConfig#HotwordRule"><code dir="ltr" translate="no">HotwordRule</code></a>
objects. Rules are applied in the order in which they are specified. This
field does not apply to <code dir="ltr" translate="no">SurrogateType</code> objects.</li>
<li><p>One of the following fields, depending on the kind of custom infoType
detector you're creating:</p>
<ul>
<li><code dir="ltr" translate="no">"dictionary"</code>: A
<a href="/dlp/docs/reference/rest/v2/Dictionary"><code dir="ltr" translate="no">Dictionary</code></a>
object, which contains a list of words or phrases to search for.</li>
<li><code dir="ltr" translate="no">"regex"</code>: A
<a href="/dlp/docs/reference/rest/v2/Regex"><code dir="ltr" translate="no">Regex</code></a>
object, which contains a single pattern defining the regular expression.</li>
<li><code dir="ltr" translate="no">"surrogateType"</code>: A
<a href="/dlp/docs/reference/rest/v2/InspectConfig#SurrogateType"><code dir="ltr" translate="no">SurrogateType</code></a>
object, if present, indicates that the custom infoType detector is a
surrogate. For more information about how to use surrogate custom
infoType detectors, see <a href="/dlp/docs/pseudonymization">Pseudonymization</a>.</li>
</ul></li>
</ul>
<aside class="note"><strong>Note:</strong><span> Stored dictionary custom infoType detectors are another form of custom
infoType detectors. They are created in a different way. For more
information, see <a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary
Detector</a>.</span></aside>
<h2 data-text="Next steps" id="next_steps">Next steps</h2>
<p>Learn more about creating custom infoTypes from the following topics:</p>
<ul>
<li><a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary detector</a>:
Learn how to create a custom infoType detector to match findings on a list
of words and phrases.</li>
<li><a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary detector</a>:
Learn how to match findings on a very large list of words and phrases.
Stored custom infoType detectors can match on up to tens of millions of
words.</li>
<li><a href="/dlp/docs/creating-custom-infotypes-regex">Creating a custom regex detector</a>:
Learn how to create a custom infoType detector to match findings on a
regular expression.</li>
<li><a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to refine scan results</a>:
Learn how to create modifiers for both built-in and custom infoType
detectors that can fine-tune scan results.</li>
<li><a href="/dlp/docs/creating-custom-infotypes-likelihood">Customizing match likelihood</a>:
Learn how to use detection rules and hotwords to customize the likelihood
values that are assigned to custom detector matches.</li>
<li><a href="/dlp/docs/examples-custom-infotypes">Examples of custom infoType detectors</a>: Several
example JSON custom infoType detector definitions that you can use or alter
as you see fit.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-custom-infotypes-dictionary]</H1></p><div class="devsite-article-body clearfix">
<p>Custom dictionaries provide the simple but powerful ability to match a list of
words or phrases. This can act as its own unique detector and can be used to
create an exception list for built-in detectors. You can also use custom
dictionaries to augment built-in infoType detectors to match additional
findings.</p>
<aside class="note"><strong>Note:</strong><span> If you have a list of anywhere from several hundred to tens of millions
of words that you want to scan for, consider using a stored custom dictionary
detector instead of the regular custom dictionary detector described in this
topic. For more information, see <a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary
detector</a>.</span></aside>
<h2 data-text="Anatomy of a dictionary custom infoType detector" id="anatomy_of_a_dictionary_custom_infotype_detector">Anatomy of a dictionary custom infoType detector</h2>
<p>As summarized in
<a href="/dlp/docs/creating-custom-infotypes#api-overview">API overview</a>, to create a
dictionary custom infoType detector, you define a
<a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType"><code dir="ltr" translate="no">CustomInfoType</code></a>
object that contains:</p>
<ul>
<li>The name you want to give the custom infoType detector, within in an
<a href="/dlp/docs/reference/rest/v2/InfoType"><code dir="ltr" translate="no">InfoType</code></a>
object.</li>
<li>An optional
<a href="/dlp/docs/reference/rest/v2/InspectConfig#Likelihood"><code dir="ltr" translate="no">Likelihood</code></a>
value. If you omit this, matches to the dictionary items will return a
default likelihood of <code dir="ltr" translate="no">POSSIBLE</code>.</li>
<li>Optional
<a href="/dlp/docs/reference/rest/v2/InspectConfig#DetectionRule"><code dir="ltr" translate="no">DetectionRule</code></a>
objects, or hotword rules. These rules adjust the likelihood of findings
within a given proximity of specified hotwords. Learn more about hotword
rules in <a href="/dlp/docs/creating-custom-infotypes-likelihood">Customizing match
likelihood</a>.</li>
<li>A
<a href="/dlp/docs/reference/rest/v2/InspectConfig#Dictionary"><code dir="ltr" translate="no">Dictionary</code></a>,
as either a
<a href="/dlp/docs/reference/rest/v2/Dictionary#wordlist"><code dir="ltr" translate="no">WordList</code></a>
containing a list of words to scan for or a
<a href="/dlp/docs/reference/rest/v2/CloudStoragePath"><code dir="ltr" translate="no">CloudStoragePath</code></a> to a
single text file containing a newline-delimited list of words to scan for.</li>
</ul>
<p>As a JSON object, a dictionary custom infoType detector that includes all
optional components looks like the following. (This JSON includes a path to a
dictionary text file stored in Cloud Storage. To see an inline word list,
see the <a href="#examples">Examples</a> section, later in this topic.)</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "customInfoTypes":[
    {
      "infoType":{
        "name":"[CUSTOM_INFOTYPE_NAME]"
      },
      "likelihood":"[LIKELIHOOD_VALUE]",
      "detectionRules":[
        {
          "hotwordRule":{
            [HOTWORDRULE_OBJECT]
          }
        },
        ...
      ],
      "dictionary":
      {
        "cloudStoragePath":
        {
          "path": "gs://[PATH_TO_TXT_FILE]"
        }
      }
    }
  ],
  ...
}
</code></pre>
<h2 data-text="Stored custom dictionaries" id="stored_custom_dictionaries">Stored custom dictionaries</h2>
<p>Cloud DLP also supports stored custom dictionaries for
<a href="/dlp/docs/inspecting-storage">inspecting storage repositories</a>. With a stored
custom dictionary, Cloud DLP can scan for, for instance,
hundreds of millions of usernames, email addresses, or any other strings
as defined in "<a href="#specifics">Dictionary matching specifics</a>." In addition,
Cloud DLP includes built-in functionality for you to
programmatically rebuild your stored custom dictionary as needed.</p>
<aside class="note"><strong>Note:</strong><span> The upper limit for the size of stored custom dictionaries is
defined on the <a href="/dlp/limits">Usage limits</a> page.</span></aside>
<p>Stored custom dictionaries are built from collections of phrases located in
either a Cloud Storage bucket or BigQuery table owned by your
organization. The first time you create a stored custom dictionary, you enter
the phrases to search on in Cloud Storage or BigQuery, and
then use Cloud DLP to generate the stored custom dictionary. The
custom dictionary is stored in Cloud Storage. When you add or remove words
from the Cloud Storage bucket or BigQuery table where
you're storing them, you then use Cloud DLP to rebuild the
stored custom dictionary.</p>
<p>For more information about creating stored custom dictionaries, see
<a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary detector</a>.</p>
<h2 data-text="Dictionary matching specifics" id="specifics">Dictionary matching specifics</h2>
<p>Following is guidance about how Cloud DLP matches
dictionary words and phrases. These points apply to both regular and stored
custom dictionaries:</p>
<ul>
<li>Dictionary words are case-insensitive. If your dictionary includes
<code dir="ltr" translate="no">Abby</code>, it will match on <code dir="ltr" translate="no">abby</code>, <code dir="ltr" translate="no">ABBY</code>, <code dir="ltr" translate="no">Abby</code>, and so on.</li>
<li>All charactersâin dictionaries or in content to be scannedâother
than letters and digits contained within the Unicode
<a href="https://en.wikipedia.org/wiki/Plane_%28Unicode%29#Basic_Multilingual_Plane">Basic Multilingual
Plane</a>
are considered as whitespace when scanning for matches. If your dictionary
scans for <code dir="ltr" translate="no">Abby Abernathy</code>, it will match on <code dir="ltr" translate="no">abby abernathy</code>, <code dir="ltr" translate="no">Abby,
Abernathy</code>, <code dir="ltr" translate="no">Abby (ABERNATHY)</code>, and so on.</li>
<li>The characters surrounding any match must be of a different type (letters
or digits) than the adjacent characters within the word. If your dictionary
scans for <code dir="ltr" translate="no">Abi</code>, it will match the first three characters of <code dir="ltr" translate="no">Abi904</code>, but
not of <code dir="ltr" translate="no">Abigail</code>.</li>
<li>Dictionary words containing a large number of characters that are not
letters or digits may result in unexpected findings, because those
characters are treated as whitespace.</li>
</ul>
<h2 data-text="Examples" id="examples">Examples</h2>
<h3 data-text="Simple word list" id="simple_word_list">Simple word list</h3>
<p>Suppose you have data that includes what hospital room a patient was treated in
during a visit. These locations may be considered sensitive in a particular data
set, but they are not something that would be picked up by
Cloud DLP's built-in detectors.</p>
<p>The rooms were listed as:</p>
<ul>
<li>"RM-Orange"</li>
<li>"RM-Yellow"</li>
<li>"RM-Green"</li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-word-list-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-deidentify-word-list-protocol" track-metadata-position="dlp-deidentify-word-list" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The following example JSON defines a custom dictionary that you could use to
de-identify custom room numbers.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"Patient was seen in RM-YELLOW then transferred to rm green."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "primitiveTransformation":{
            "replaceWithInfoTypeConfig":{

            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"CUSTOM_ROOM_ID"
        },
        "dictionary":{
          "wordList":{
            "words":[
              "RM-GREEN",
              "RM-YELLOW",
              "RM-ORANGE"
            ]
          }
        }
      }
    ]
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<p>When we POST the JSON input to
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content:deidentify</code></a>,
it returns the following JSON response:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"Patient was seen in [CUSTOM_ROOM_ID] then transferred to [CUSTOM_ROOM_ID]."
  },
  "overview":{
    "transformedBytes":"17",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"CUSTOM_ROOM_ID"
        },
        "transformation":{
          "replaceWithInfoTypeConfig":{

          }
        },
        "results":[
          {
            "count":"2",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"17"
      }
    ]
  }
}
</code></pre>
<p>Cloud DLP has correctly identified the room numbers
specified in the custom dictionary's
<a href="/dlp/docs/reference/rest/v2/InspectConfig#WordList"><code dir="ltr" translate="no">WordList</code></a>
message. Note that items are even matched when the case and the hyphen (<code dir="ltr" translate="no">-</code>) are
missing, as in the second example, "rm green."</p>
</section>
<section>
<h3 data-text="Java" id="dlp-deidentify-word-list-java" track-metadata-position="dlp-deidentify-word-list" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-word-list" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithSimpleWordList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithSimpleWordList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-word-list" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-word-list" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithSimpleWordList.java" data-region-tag="dlp_deidentify_simple_word_list" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithSimpleWordList.java/HEAD/dlp_deidentify_simple_word_list" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary.WordList;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import java.io.IOException;

public class DeIdentifyWithSimpleWordList {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToDeIdentify = "Patient was seen in RM-YELLOW then transferred to rm green.";
    deidentifyWithSimpleWordList(projectId, textToDeIdentify);
  }

  public static void deidentifyWithSimpleWordList(String projectId, String textToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {

      // Specify what content you want the service to DeIdentify.
      ContentItem contentItem = ContentItem.newBuilder().setValue(textToDeIdentify).build();

      // Construct the word list to be detected
      Dictionary wordList =
          Dictionary.newBuilder()
              .setWordList(
                  WordList.newBuilder()
                      .addWords("RM-GREEN")
                      .addWords("RM-YELLOW")
                      .addWords("RM-ORANGE")
                      .build())
              .build();

      // Specify the word list custom info type the inspection will look for.
      InfoType infoType = InfoType.newBuilder().setName("CUSTOM_ROOM_ID").build();
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder().setInfoType(infoType).setDictionary(wordList).build();
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addCustomInfoTypes(customInfoType).build();

      // Define type of deidentification as replacement.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(ReplaceWithInfoTypeConfig.getDefaultInstance())
              .build();

      // Associate deidentification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();

      // Construct the configuration for the Redact request and list all desired transformations.
      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setInspectConfig(inspectConfig)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results
      System.out.println(
          "Text after replace with infotype config: " + response.getItem().getValue());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-word-list-csharp" track-metadata-position="dlp-deidentify-word-list" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-word-list" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithSimpleWordList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithSimpleWordList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-word-list" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-word-list" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithSimpleWordList.cs" data-region-tag="dlp_deidentify_simple_word_list" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithSimpleWordList.cs/HEAD/dlp_deidentify_simple_word_list" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class DeidentifyWithSimpleWordList
{
    public static DeidentifyContentResponse Deidentify(string projectId, string text)
    {
        // Instantiate a client.
        var dlp = DlpServiceClient.Create();

        var contentItem = new ContentItem { Value = text };

        var wordList = new CustomInfoType.Types.Dictionary.Types.WordList
        {
            Words = { new string[] { "RM-GREEN", "RM-YELLOW", "RM-ORANGE" } }
        };

        var infoType = new InfoType
        {
            Name = "CUSTOM_ROOM_ID"
        };

        var customInfoType = new CustomInfoType
        {
            InfoType = infoType,
            Dictionary = new CustomInfoType.Types.Dictionary
            {
                WordList = wordList
            }
        };

        var inspectConfig = new InspectConfig
        {
            CustomInfoTypes =
            {
                customInfoType,
            }
        };
        var primitiveTransformation = new PrimitiveTransformation
        {
            ReplaceWithInfoTypeConfig = new ReplaceWithInfoTypeConfig { }
        };

        var transformation = new InfoTypeTransformations.Types.InfoTypeTransformation
        {
            InfoTypes = { infoType },
            PrimitiveTransformation = primitiveTransformation
        };

        var deidentifyConfig = new DeidentifyConfig
        {
            InfoTypeTransformations = new InfoTypeTransformations
            {
                Transformations = { transformation }
            }
        };

        var request = new DeidentifyContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectConfig = inspectConfig,
            DeidentifyConfig = deidentifyConfig,
            Item = contentItem
        };

        // Call the API.
        var response = dlp.DeidentifyContent(request);

        // Inspect the results.
        Console.WriteLine($"Deidentified content: {response.Item.Value}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h3 data-text="Exception list" id="exception_list">Exception list</h3>
<p>Suppose you have log data that includes customer identifiers such as email
addresses, and you want to redact this information. However, these logs also
include the email addresses of internal developers, and you don't want to redact
those.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_deidentify_exception_list-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_deidentify_exception_list-protocol" track-metadata-position="dlp_deidentify_exception_list" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The following JSON example creates a custom dictionary that lists a subset of
email addresses within the
<a href="/dlp/docs/reference/rest/v2/InspectConfig#WordList"><code dir="ltr" translate="no">WordList</code></a>
message (jack@example.org and jill@example.org), and assigns them the custom
infoType name <code dir="ltr" translate="no">DEVELOPER_EMAIL</code>. This JSON instructs
Cloud DLP to ignore the specified email addresses, while
replacing any other email addresses it detects with a string that corresponds
to its infoType (in this case, <code dir="ltr" translate="no">EMAIL_ADDRESS</code>):</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"jack@example.org accessed customer record of user5@example.com"
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "primitiveTransformation":{
            "replaceWithInfoTypeConfig":{

            }
          },
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ]
        }
      ]
    }
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"DEVELOPER_EMAIL"
        },
        "dictionary":{
          "wordList":{
            "words":[
              "jack@example.org",
              "jill@example.org"
            ]
          }
        }
      }
    ],
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
    "ruleSet": [
      {
        "infoTypes": [
          {
            "name": "EMAIL_ADDRESS"
          }
        ],
        "rules": [
          {
            "exclusionRule": {
              "excludeInfoTypes": {
                "infoTypes": [
                  {
                    "name": "DEVELOPER_EMAIL"
                  }
                ]
              },
              "matchingType": "MATCHING_TYPE_FULL_MATCH"
            }
          }
        ]
      }
    ]
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<p>When we POST this JSON to
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content:deidentify</code></a>,
it returns the following JSON response:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"jack@example.org accessed customer record of [EMAIL_ADDRESS]"
  },
  "overview":{
    "transformedBytes":"17",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "replaceWithInfoTypeConfig":{

          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"17"
      }
    ]
  }
}
</code></pre>
<p>The output has correctly identified user1@example.com as matched by the
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoType detector and jack@example.org as matched by the
<code dir="ltr" translate="no">DEVELOPER_EMAIL</code> custom infoType detector. Note that because we chose to only
transform <code dir="ltr" translate="no">EMAIL_ADDRESS</code>, jack@example.org was left intact.</p>
</section>
<section>
<h3 data-text="Java" id="dlp_deidentify_exception_list-java" track-metadata-position="dlp_deidentify_exception_list" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_exception_list" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithExceptionList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithExceptionList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_exception_list" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_deidentify_exception_list" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithExceptionList.java" data-region-tag="dlp_deidentify_exception_list" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithExceptionList.java/HEAD/dlp_deidentify_exception_list" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary.WordList;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import java.io.IOException;

public class DeIdentifyWithExceptionList {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToDeIdentify = "jack@example.org accessed customer record of user5@example.com";
    deIdentifyWithExceptionList(projectId, textToDeIdentify);
  }

  public static void deIdentifyWithExceptionList(String projectId, String textToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {

      // Specify what content you want the service to DeIdentify.
      ContentItem contentItem = ContentItem.newBuilder().setValue(textToDeIdentify).build();

      // Construct the custom word list to be detected.
      Dictionary wordList =
          Dictionary.newBuilder()
              .setWordList(
                  WordList.newBuilder()
                      .addWords("jack@example.org")
                      .addWords("jill@example.org")
                      .build())
              .build();

      // Construct the custom dictionary detector associated with the word list.
      InfoType developerEmail = InfoType.newBuilder().setName("DEVELOPER_EMAIL").build();
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder().setInfoType(developerEmail).setDictionary(wordList).build();

      // Specify the word list custom info type and build-in info type the inspection will look for.
      InfoType emailAddress = InfoType.newBuilder().setName("EMAIL_ADDRESS").build();
      InspectConfig inspectConfig =
          InspectConfig.newBuilder()
              .addInfoTypes(emailAddress)
              .addCustomInfoTypes(customInfoType)
              .build();

      // Define type of deidentification as replacement.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(ReplaceWithInfoTypeConfig.getDefaultInstance())
              .build();

      // Associate de-identification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(emailAddress)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();

      // Construct the configuration for the de-id request and list all desired transformations.
      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setInspectConfig(inspectConfig)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results
      System.out.println(
          "Text after replace with infotype config: " + response.getItem().getValue());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_deidentify_exception_list-csharp" track-metadata-position="dlp_deidentify_exception_list" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_exception_list" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithExceptionList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithExceptionList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_exception_list" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_deidentify_exception_list" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithExceptionList.cs" data-region-tag="dlp_deidentify_exception_list" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithExceptionList.cs/HEAD/dlp_deidentify_exception_list" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class DeidentifyWithExceptionList
{
    public static DeidentifyContentResponse Deidentify(string projectId, string text)
    {
        // Instantiate a client.
        var dlp = DlpServiceClient.Create();

        var contentItem = new ContentItem { Value = text };

        var wordList = new CustomInfoType.Types.Dictionary.Types.WordList
        {
            Words = { new string[] { "jack@example.org", "jill@example.org" } }
        };

        var exclusionRule = new ExclusionRule
        {
            MatchingType = MatchingType.FullMatch,
            Dictionary = new CustomInfoType.Types.Dictionary
            {
                WordList = wordList
            }
        };

        var infoType = new InfoType { Name = "EMAIL_ADDRESS" };

        var inspectionRuleSet = new InspectionRuleSet
        {
            InfoTypes = { infoType },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        var inspectConfig = new InspectConfig
        {
            InfoTypes = { infoType },
            RuleSet = { inspectionRuleSet }
        };
        var primitiveTransformation = new PrimitiveTransformation
        {
            ReplaceWithInfoTypeConfig = new ReplaceWithInfoTypeConfig { }
        };

        var transformation = new InfoTypeTransformations.Types.InfoTypeTransformation
        {
            InfoTypes = { infoType },
            PrimitiveTransformation = primitiveTransformation
        };

        var deidentifyConfig = new DeidentifyConfig
        {
            InfoTypeTransformations = new InfoTypeTransformations
            {
                Transformations = { transformation }
            }
        };

        var request = new DeidentifyContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectConfig = inspectConfig,
            DeidentifyConfig = deidentifyConfig,
            Item = contentItem
        };

        // Call the API.
        var response = dlp.DeidentifyContent(request);

        // Inspect the results.
        Console.WriteLine($"Deidentified content: {response.Item.Value}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h3 data-text="Augment a built-in infotype detector" id="augment_a_built-in_infotype_detector">Augment a built-in infotype detector</h3>
<p>Consider a scenario in which a built-in infoType detector isnât returning the
correct values. For example, you want to return matches on person names, but
Cloud DLP's built-in <code dir="ltr" translate="no">PERSON_NAME</code> detector is failing to
return matches on some person names that are common in your dataset.</p>
<p>Cloud DLP allows you to augment built-in infoType detectors
by including a built-in detector in the declaration for a custom infoType
detector, as shown in the following example. This snippet illustrates how to
configure Cloud DLP so that the <code dir="ltr" translate="no">PERSON_NAME</code> built-in
infoType detector will additionally match the name âQuasimodo:â</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"PERSON_NAME"
        },
        "dictionary":{
          "wordList":{
            "words":[
              "quasimodo"
            ]
          }
        }
      }
    ]
  }
...
</code></pre>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-stored-infotypes]</H1></p><div class="devsite-article-body clearfix">
<p>Regular <a href="/dlp/docs/creating-custom-infotypes-dictionary">custom dictionary detectors</a>
are sufficient when you have a list of up to several tens of thousands of
sensitive words or phrases that you want to scan your content for. If you have
more than this many words or phrases to scan for, or if your list of words or
phrases changes frequently, consider creating a <em>stored custom dictionary</em>,
which you can use to scan for up to tens of millions of words or phrases.</p>
<aside class="note"><strong>Note:</strong><span> For the exact usage limit amounts for dictionaries, see <a href="/dlp/limits">Usage
limits</a>.</span></aside>
<p>This topic describes how to create and rebuild stored custom dictionaries, and
it covers several error scenarios.</p>
<h2 data-text="Anatomy of a stored custom dictionary" id="anatomy_of_a_stored_custom_dictionary">Anatomy of a stored custom dictionary</h2>
<p>You may be familiar with how to create a <a href="/dlp/docs/creating-custom-infotypes-dictionary">regular dictionary custom
infoType</a> or a <a href="/dlp/docs/creating-custom-infotypes-regex">regex custom
infoType</a>: You configure the <a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType">custom
infoType</a>, and
then use it when you set up your inspection or de-identification scan. Stored
custom dictionaries are different from these custom infoTypes, though, in that
each stored custom dictionary has two components:</p>
<ul>
<li>A list of phrases that you create and define. The list is stored as either
a text file within Cloud Storage or a column in a BigQuery table.</li>
<li>The generated dictionary files, which are generated by
Cloud DLP based on your phrase list. The dictionary files
are stored in Cloud Storage, and are comprised of a copy of the
source phrase data plus bloom filters, which aid in searching and matching.
You can't edit these files directly.</li>
</ul>
<aside class="warning"><strong>Warning:</strong><span> Do not alter custom dictionary files directly in Cloud Storage.
Doing so will render the dictionary invalid and unusable.</span></aside>
<h2 data-text="Create a new stored custom dictionary" id="create_a_new_stored_custom_dictionary">Create a new stored custom dictionary</h2>
<p>This section describes how to create, edit, and rebuild a stored custom
dictionary.</p>
<h3 data-text="Create a phrase list" id="create_a_phrase_list">Create a phrase list</h3>
<p>The first step to creating a stored custom dictionary is to create a word and
phrase list. You have two choices:</p>
<ul>
<li>Place a text file with each word or phrase on its own line into a
Cloud Storage bucket.</li>
<li>Designate one column of a BigQuery table as the
container for the phrases. Give each phrase its own row in the column. You
can use an existing BigQuery table, as long as all of the
dictionary words and phrases are in a single column.</li>
</ul>
<p>Be aware that it is possible to assemble a term list that is too large for
Cloud DLP to process. If you see an error message, see
"<a href="#troubleshooting_errors">Troubleshooting errors</a>," later in this topic.</p>
<h3 data-text="Create the dictionary" id="create_the_dictionary">Create the dictionary</h3>
<p>After you've created your term list, use Cloud DLP to create
a dictionary:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-create-stored-dictionary-infotype-code-sample">
<section>
<h3 data-text="Console" id="dlp-create-stored-dictionary-infotype-console" track-metadata-position="dlp-create-stored-dictionary-infotype" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li>Create a new folder for the dictionary in a Cloud Storage bucket.
 Cloud DLP creates folders containing the dictionary files
 at the location you specify.</li>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Stored infoType</strong>.</p>
<p><img alt="Screenshot of DLP UI with Create menu &gt; Stored infoType selected." class="screenshot" src="/dlp/docs/images/creating-custom-infotypes-create-new.png" width="800"/></p>
<p>Alternatively, click the following button:</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/storedInfoType" target="console">Create new infoType</a> </p></li>
</ol>
<p>The Create infoType page contains the following sections:</p>
<ul>
<li><a href="#configure-infotype">Configure infoType</a></li>
<li><a href="#choose-data-loc">Choose data location</a></li>
</ul>
<h4 data-text="Configure infoType" id="configure-infotype">Configure infoType</h4>
<p>The <strong>Configure infoType</strong> section is where you name and describe your stored
custom dictionary infoType.</p>
<ul>
<li>In the <strong>InfoType ID</strong> field, enter an identifier for the custom infoType.
This will be how you refer to the infoType when configuring your
inspection and de-identification jobs. You can use letters, numbers,
hyphens, and underscores in the name.</li>
<li>In the <strong>InfoType display name</strong> field, enter a name for your custom
infoType. You can use spaces and punctuation in the name.</li>
<li>In the <strong>Description</strong> field, enter a description for what your custom
infoType detects.</li>
</ul>
<h4 data-text="Choose data location" id="choose-data-loc">Choose data location</h4>
<p>The <strong>Choose data location</strong> section is where you specify where to find the list
of words and phrases from which to create your stored custom dictionary.</p>
<ul>
<li>Choose <strong>BigQuery</strong> if the words and phrases to search for are listed in a
BigQuery table. Remember that you can designate at most one
column from the table. Enter the project ID, dataset ID, and table ID in the
specified fields. In the <strong>Field name</strong> field, enter the column identifier.</li>
<li>Choose <strong>Google Cloud Storage</strong> if the words and phrases to search for are
listed in a text file in Cloud Storage. Enter the path to the file in
the specified field.</li>
</ul>
<p>The final section is where you specify a location for Cloud DLP to
save the compacted stored custom dictionary.</p>
<p>In the <strong>Output bucket or folder</strong> field, enter the path to which you want the
dictionary saved.</p>
<aside class="note"><strong>Note: </strong>Do not place files inside the
  folders that Cloud DLP creates when it builds your
  dictionary. Cloud DLP will, when it creates or rebuilds
  dictionary files, delete any other files stored in folders that it
  creates. Any folders at the same level as the folders that
  Cloud DLP creates will be maintained.</aside>
<p>Click <strong>Create</strong> to create the stored custom dictionary. The infoType details
screen appears.</p>
<p>When the status is "Ready," the stored custom dictionary has been generated, and
the new custom infoType is ready to use.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-create-stored-dictionary-infotype-protocol" track-metadata-position="dlp-create-stored-dictionary-infotype" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<ol>
<li>Create a new folder for the dictionary in a Cloud Storage bucket.
     Cloud DLP creates folders containing the dictionary
    files at the location you specify.</li>
<aside class="note"><strong>Note: </strong>Do not place files inside the
  folders that Cloud DLP creates when it builds your
  dictionary. Cloud DLP will, when it creates or rebuilds
  dictionary files, delete any other files stored in folders that it
  creates. Any folders at the same level as the folders that
  Cloud DLP creates will be maintained.</aside>
<li>Use the DLP API's
    <a href="/dlp/docs/reference/rest/v2/projects.storedInfoTypes/create"><code dir="ltr" translate="no">storedInfoTypes.create</code></a>
    method to create the dictionary. The <code dir="ltr" translate="no">create</code> method takes the
    following parameters:
    <ul>
<li>A <a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes#storedinfotypeconfig"><code dir="ltr" translate="no">StoredInfoTypeConfig</code></a>
        object, which contains the stored infoType's configuration. It includes:
         <ul>
<li><code dir="ltr" translate="no">description</code>: A description of the dictionary.</li>
<li><code dir="ltr" translate="no">displayName</code>: The name you want to give the dictionary.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#largecustomdictionaryconfig"><code dir="ltr" translate="no">LargeCustomDictionaryConfig</code></a>:
             Contains the configuration of the stored custom dictionary. It
             includes:
           <ul>
<li><a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#bigqueryfield"><code dir="ltr" translate="no">BigQueryField</code></a>:
             Specified if your term list is stored in BigQuery.
             Includes a reference to the table your list is stored in, plus the
             field that contains each dictionary phrase.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#cloudstoragefileset"><code dir="ltr" translate="no">CloudStorageFileSet</code></a>:
               Specified if your term list is stored in Cloud Storage.
               Includes the URL to the source location in Cloud Storage,
               in the following form: <code dir="ltr" translate="no">"gs://[PATH_TO_GS]"</code>.
               Wildcards are supported.</li>
<aside class="note"><strong>Note: </strong>You can specify either
             <code dir="ltr" translate="no">BigQueryField</code> or <code dir="ltr" translate="no">CloudStorageFileSet</code>
               in <code dir="ltr" translate="no">LargeCustomDictionaryConfig</code>, but not both.</aside>
<li><code dir="ltr" translate="no">outputPath</code>: The path to the location in a
             Cloud Storage bucket to store the created dictionary.</li>
</ul></li>
</ul></li>
<li><code dir="ltr" translate="no">storedInfoTypeId</code>: The identifier for the stored custom
        infoType. This value is how you will refer to the stored custom infoType
        when you rebuild or delete it, or use it in an inspection or
        de-identification job. If you leave this field empty, the system
        generates an identifier for you.</li>
</ul>
</li>
</ol>
<p>Following is example JSON that, when sent to the <code dir="ltr" translate="no">storedInfoTypes.create</code>
method, creates a new stored custom dictionary. In this example, we've
instructed Cloud DLP to create a stored custom dictionary
from a term list stored in the publicly available BigQuery
database of all GitHub usernames used in commits
(<code dir="ltr" translate="no">bigquery-public-data.samples.github_nested</code>). The output path for the
generated dictionary is set to a Cloud Storage bucket called
<code dir="ltr" translate="no">dlptesting</code>, and the stored custom dictionary has been given the name
<code dir="ltr" translate="no">github-usernames</code>.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/storedInfoTypes?key={YOUR_API_KEY}

{
  "config":{
    "displayName":"GitHub usernames",
    "description":"Dictionary of github usernames used in commits",
    "largeCustomDictionary":{
      "outputPath":{
        "path":"gs://[PATH_TO_GS]"
      },
      "bigQueryField":{
        "table":{
          "datasetId":"samples",
          "projectId":"bigquery-public-data",
          "tableId":"github_nested"
        }
      }
    }
  },
  "storedInfoTypeId":"github-usernames"
}
</code></pre>
</section>
</div>
<h3 data-text="Rebuild the dictionary" id="rebuild_the_dictionary">Rebuild the dictionary</h3>
<p>If you want to add or remove terms or phrases to your dictionary, you first
update your source term list, and then you instruct Cloud DLP
to rebuild the dictionary.</p>
<ol>
<li>Update the existing source term list in either Cloud Storage or
 BigQuery. Add, remove, or change the terms or phrases as
 needed.</li>
<li>Create a new version of the dictionary by "rebuilding" it using either
 the Cloud console or the Cloud DLP's
 <a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/patch"><code dir="ltr" translate="no">storedInfoTypes.patch</code></a>
 method. Doing this creates a new version of the dictionary, which replaces
 the old dictionary.</li>
</ol>
<p>To rebuild the stored custom dictionary:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-update-stored-dictionary-infotype-code-sample">
<section>
<h3 data-text="Console" id="dlp-update-stored-dictionary-infotype-console" track-metadata-position="dlp-update-stored-dictionary-infotype" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li>Update and save your term list in either Cloud Storage or
 BigQuery.</li>
<li>In the Cloud console, open Cloud DLP.</li>
<li>Click the <strong>Configuration</strong> tab, and then <strong>InfoTypes</strong>.</li>
<li><p>On the infoTypes screen, click the <strong>Custom</strong> tab. Your stored custom
 infoTypes appear here.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7/landing/configuration/storedInfoTypes" target="console">Go to custom infoTypes listing</a> </p></li>
<li><p>Click the row with the stored infoType you want to update.</p></li>
<li><p>On the infoType details screen, click <strong>Rebuild data</strong>.</p></li>
</ol>
<p>Cloud DLP rebuilds the stored custom dictionary with the changes
you made to the source term list. Once the status of the custom infoType is
"Ready," you can use it. Any templates or job triggers that use the custom
infoType will automatically use the rebuilt custom infoType.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-update-stored-dictionary-infotype-protocol" track-metadata-position="dlp-update-stored-dictionary-infotype" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>If the only thing you're trying to do is to add new terms or delete or change
existing terms in the stored custom dictionary, you need only call the
<a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/patch"><code dir="ltr" translate="no">storedInfoTypes.patch</code></a>
method by itself to rebuild the dictionary. Be sure to populate the <code dir="ltr" translate="no">name</code> field
with the resource name of the organization or project, and of the stored custom
infoType to be rebuilt. You provided the name of the stored infoType when you
created it in the <code dir="ltr" translate="no">storedInfoTypeId</code> parameter. If you don't remember the
identifier for the stored custom infoType you want to rebuild, call the
<a href="/dlp/docs/reference/rest/v2/projects.storedInfoTypes/list"><code dir="ltr" translate="no">storedInfoTypes.list</code></a>
method to view a list of all current stored infoTypes.</p>
<p>The following patterns represent valid entries for the <code dir="ltr" translate="no">name</code> field:</p>
<ul>
<li><code dir="ltr" translate="no">organizations/[ORG_ID]/storedInfoTypes/[STORED_INFOTYPE_ID]</code></li>
<li><code dir="ltr" translate="no">projects/[PROJECT_ID]/storedInfoTypes/[STORED_INFOTYPE_ID]</code></li>
</ul>
<p>When you rebuild a stored custom dictionary to a new version, the old version
of the stored custom dictionary is deleted. While Cloud DLP
is updating the stored custom dictionary, the dictionary's status is
"pending." When the status of the new version of the dictionary is pending,
the old version of the dictionary still exists. Any scans that you run while
the dictionary is being rebuilt will be run using the old version of the
dictionary.</p>
<aside class="note"><strong>Note:</strong><span> Though stored custom dictionaries don't have version numbers, each one
has a <code dir="ltr" translate="no">createTime</code> field, which is refreshed with each rebuild. Use the
<a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/get"><code dir="ltr" translate="no">storedInfoTypes.get</code></a>
method to retrieve information about the stored custom dictionary detector, and
use the <code dir="ltr" translate="no">createTime</code> field to determine when it was last rebuilt.</span></aside>
<p>You can change the source term list for an existing stored custom dictionary
from one stored in a BigQuery table to one stored in a
Cloud Storage bucket, and vice-versa. Use the
<a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/patch"><code dir="ltr" translate="no">storedInfoTypes.patch</code></a>
method, but include a
<a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#cloudstoragefileset"><code dir="ltr" translate="no">CloudStorageFileSet</code></a>
object in
<a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#largecustomdictionaryconfig"><code dir="ltr" translate="no">LargeCustomDictionaryConfig</code></a>
where you'd used a
<a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#bigqueryfield"><code dir="ltr" translate="no">BigQueryField</code></a>
object before, or vice-versa. You must also specify the <code dir="ltr" translate="no">updateMask</code>
parameter, setting it to the stored custom dictionary parameter that you
rebuilt, in
<a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#google.protobuf.FieldMask"><code dir="ltr" translate="no">FieldMask</code></a>
format. For instance, the following JSON, when sent to the
<code dir="ltr" translate="no">storedInfoTypes.patch</code> method, states in the <code dir="ltr" translate="no">updateMask</code> parameter that the
URL of the Cloud Storage path has been updated
(<code dir="ltr" translate="no">large_custom_dictionary.cloud_storage_file_set.url</code>):</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">PATCH https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/storedInfoTypes/github-usernames?key={YOUR_API_KEY}

{
  "config":{
    "largeCustomDictionary":{
      "cloudStorageFileSet":{
        "url":"gs://[BUCKET_NAME]/[PATH_TO_FILE]"
      }
    }
  },
  "updateMask":"large_custom_dictionary.cloud_storage_file_set.url"
}
</code></pre>
</section>
</div>
<h2 data-text="Scan content using stored custom dictionary detectors" id="scan_content_using_stored_custom_dictionary_detectors">Scan content using stored custom dictionary detectors</h2>
<p>Scanning content using a stored custom dictionary detector is similar to
scanning content using any other custom infoType detector.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-scan-with-stored-infotype-code-sample">
<section>
<h3 data-text="Console" id="dlp-scan-with-stored-infotype-console" track-metadata-position="dlp-scan-with-stored-infotype" track-name="console" track-type="sampleTabNav">Console</h3>
<p>You can use a custom dictionary detector when creating a new job, job trigger,
or template. In the <strong>Configure detection</strong> section of the job or template
creation workflow, you can specify your stored custom dictionary infoType in the
<strong>Custom infoTypes</strong> subsection:</p>
<ol>
<li><p>Click <strong>Add custom infoType</strong>, and then click <strong>Stored infoType</strong>.</p>
<p><img alt="Screenshot of DLP UI's create job trigger workflow, in the
      Custom infoTypes section." class="screenshot" src="/dlp/docs/images/creating-custom-infotypes-use.png" width="531"/></p></li>
<li><p>In the <strong>Add custom infoType</strong> section, type an infoType name in the
 <strong>InfoType</strong> field. You can use letters, numbers, and underscores.</p></li>
<li><p>Click in the <strong>Stored infoType name</strong> field, and a menu will appear
 under the field with the paths to your stored custom dictionary infoTypes,
 as shown here:</p>
<p><img alt="Screenshot of DLP UI's create job trigger workflow, in the
      Add custom infoType section." class="screenshot" src="/dlp/docs/images/creating-custom-infotypes-add.png" width="571"/></p></li>
<li><p>Choose the stored custom dictionary you want, and then click <strong>Done</strong>.</p></li>
</ol>
<p>The custom infoType you added appears as in the following screen shot. Note that
you can add additional custom infoTypes if you want.</p>
<p><img alt="Screenshot of DLP UI's create job trigger workflow, with custom infoType
    added." class="screenshot" src="/dlp/docs/images/creating-custom-infotypes-added.png" width="571"/></p>
<p>You can now continue with the job, job trigger, or template creation process.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-scan-with-stored-infotype-protocol" track-metadata-position="dlp-scan-with-stored-infotype" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The following JSON, when sent to the
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">content.inspect</code></a>
method, scans the given snippet of text using the specified stored custom
dictionary detector. Note that the <code dir="ltr" translate="no">infoType</code> parameter is required because
all custom infoTypes, including stored custom dictionaries, must have a name
that does not conflict with built-in infoTypes or other custom infoTypes. The
<code dir="ltr" translate="no">storedType</code> parameter contains the full resource path of the stored custom
infoType.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:inspect?key={YOUR_API_KEY}

{
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"GITHUB_LOGINS"
        },
        "storedType":{
          "name":"projects/[PROJECT_ID]/storedInfoTypes/github-logins"
        }
      }
    ]
  },
  "item":{
    "value":"The commit was made by githubuser."
  }
}
</code></pre>
</section>
</div>
<h2 data-text="Troubleshooting errors" id="troubleshooting_errors">Troubleshooting errors</h2>
<p>If, when you attempt to create a stored custom dictionary, you see an error
that explains that Cloud DLP can't create a dictionary
from your Cloud Storage-based term list, there are a few possible causes:</p>
<ul>
<li>You've run into an upper limit for stored custom dictionaries. Depending on
the problem, there are several workarounds:
<ul>
<li>If you run into the upper limit for a single stored custom dictionary in
Cloud Storage (200 MB), you can
try splitting the file into multiple files. You can still use these files
to assemble a single custom dictionary, as long as the total size of the
files doesn't exceed the maximum combined size for all stored custom
dictionary files in Cloud Storage
(1 GB).</li>
<li>BigQuery does not have the same limits as
Cloud Storage. Consider moving the terms into a
BigQuery table, but be aware of both the maximum size of
custom dictionary column in BigQuery
(1 GB) and the maximum
number of rows (5,000,000).</li>
<li>If your term list file exceeds all of the applicable limits for
custom dictionary source term lists, you must split the term list file
into multiple files in Cloud Storage, create a dictionary for each
file, and then create a separate scan job for each dictionary that's
created.</li>
</ul></li>
<li>One or more of your terms doesn't contain at least one letter or number.
Cloud DLP can't scan for terms that are comprised solely
of spaces or symbols. It must have at least one letter or number. Look at
your term list and see if there are any such terms included, and then
fix or delete them.</li>
<li>Your term list contains a phrase with too many "components." A component in
this context is a continuous sequence containing only letters, only numbers,
or only non-letter and non-digit characters such as spaces or symbols. Look
at your term list and see if there are any such terms included, and then
fix or delete them.</li>
<li>The DLP service account does not have access to
dictionary source data or to the Cloud Storage bucket for storing
dictionary files. To fix this issue, grant the DLP
service account the Cloud Storage admin role or
BigQuery dataOwner and jobUser roles.</li>
</ul>
<h2 data-text="API overview" id="api_overview">API overview</h2>
<p>A stored custom dictionary is considered a <em>stored infoType</em> because of its
size and complexity. At this time, stored custom dictionaries are the only type
of stored infoType.</p>
<p>A stored infoType is represented in Cloud DLP by the
<a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes#resource-storedinfotype"><code dir="ltr" translate="no">StoredInfoType</code></a>
object. It's accompanied by the following related objects:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes#storedinfotypeconfig"><code dir="ltr" translate="no">StoredInfoTypeConfig</code></a>
contains the stored infoType's configuration, which includes details such as
name and description.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#storedinfotypeversion"><code dir="ltr" translate="no">StoredInfoTypeVersion</code></a>
contains more information about the stored infoType, such as its creation
date and time and the last five error messages that occurred when the
current version of the stored infoType was created.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#storedinfotypestate"><code dir="ltr" translate="no">StoredInfoTypeState</code></a>
contains the state of the most current version and any pending versions of
the stored infoType. State information includes whether the stored infoType
is being rebuilt, is ready to use, or is invalid.</li>
</ul>
<p>To create, edit, or delete a stored infoType, you use the following methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.storedInfoTypes/create"><code dir="ltr" translate="no">storedInfoTypes.create</code></a>:
Creates a new stored infoType given the
<code dir="ltr" translate="no">StoredInfoTypeConfig</code> that you specify.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/patch"><code dir="ltr" translate="no">storedInfoTypes.patch</code></a>:
Rebuilds the stored infoType with a new <code dir="ltr" translate="no">StoredInfoTypeConfig</code> that you
specify, or if none is specified, creates a new version of the stored
infoType with the existing <code dir="ltr" translate="no">StoredInfoTypeConfig</code>.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/get"><code dir="ltr" translate="no">storedInfoTypes.get</code></a>:
Retrieves the <code dir="ltr" translate="no">StoredInfoTypeConfig</code> and any pending versions of the
specified stored infoType.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.storedInfoTypes/list"><code dir="ltr" translate="no">storedInfoTypes.list</code></a>:
Lists all current stored infoTypes.</li>
<li><a href="/dlp/docs/reference/rest/v2/projects.locations.storedInfoTypes/delete"><code dir="ltr" translate="no">storedInfoTypes.delete</code></a>:
Deletes the specified stored infoType.</li>
</ul>
<p>In addition to the stored infoType APIs described here, the following object
applies specifically to stored custom dictionaries:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/organizations.locations.storedInfoTypes#largecustomdictionaryconfig"><code dir="ltr" translate="no">LargeCustomDictionaryConfig</code></a>
specifies both of the following:
<ul>
<li>The location within Cloud Storage or BigQuery
where your list of phrases is stored.</li>
<li>The location in Cloud Storage to store the generated dictionary
files.</li>
</ul></li>
</ul>
<h2 data-text="Dictionary matching specifics" id="specifics">Dictionary matching specifics</h2>
<p>Following is guidance about how Cloud DLP matches dictionary words
and phrases. These points apply to both regular and stored custom dictionaries:</p>
<ul>
<li>Dictionary words are case-insensitive. If your dictionary includes
<code dir="ltr" translate="no">Abby</code>, it will match on <code dir="ltr" translate="no">abby</code>, <code dir="ltr" translate="no">ABBY</code>, <code dir="ltr" translate="no">Abby</code>, and so on.</li>
<li>All charactersâin dictionaries or in content to be scannedâother
than letters and digits contained within the Unicode
<a href="https://en.wikipedia.org/wiki/Plane_%28Unicode%29#Basic_Multilingual_Plane">Basic Multilingual Plane</a>
are considered as whitespace when scanning for matches. If your dictionary
scans for <code dir="ltr" translate="no">Abby Abernathy</code>, it will match on <code dir="ltr" translate="no">abby abernathy</code>, <code dir="ltr" translate="no">Abby,
Abernathy</code>, <code dir="ltr" translate="no">Abby (ABERNATHY)</code>, and so on.</li>
<li>The characters surrounding any match must be of a different type (letters
or digits) than the adjacent characters within the word. If your dictionary
scans for <code dir="ltr" translate="no">Abi</code>, it will match the first three characters of <code dir="ltr" translate="no">Abi904</code>, but
not of <code dir="ltr" translate="no">Abigail</code>.</li>
<li>Dictionary words containing a large number of characters that are not
letters or digits may result in unexpected findings, because those
characters are treated as whitespace.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-custom-infotypes-regex]</H1></p><div class="devsite-article-body clearfix">
<p>A regular expression (regex) custom infoType detector allows you to create your
own detectors that enable Cloud DLP to detect matches based
on a regex pattern. For example, suppose that you had medical record numbers in
the form <code dir="ltr" translate="no">###-#-#####</code>. You could define a regex pattern such as the following:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">[0-9]{3}-[0-9]{1}-[0-9]{5}
</code></pre>
<p>Cloud DLP would then match items like the following:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">012-4-56789
</code></pre>
<h2 data-text="Anatomy of a regex custom infoType detector" id="anatomy_of_a_regex_custom_infotype_detector">Anatomy of a regex custom infoType detector</h2>
<p>As summarized in
<a href="/dlp/docs/creating-custom-infotypes#api-overview">API Overview</a>, to create a
custom regex infoType detector, you define a
<a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType"><code dir="ltr" translate="no">CustomInfoType</code></a>
object that contains:</p>
<ul>
<li>The name you want to give the custom infoType detector, within in an
<a href="/dlp/docs/reference/rest/v2/InfoType"><code dir="ltr" translate="no">InfoType</code></a>
object.</li>
<li>An optional
<a href="/dlp/docs/reference/rest/v2/InspectConfig#Likelihood"><code dir="ltr" translate="no">Likelihood</code></a>
value. If you omit this, regex matches will return a default likelihood of
<code dir="ltr" translate="no">VERY_LIKELY</code>. If you notice a regex custom infoType detector returning too
many false positives, try reducing the base likelihood and using detection
rules to boost the likelihood using contextual information. To learn more,
see <a href="/dlp/docs/creating-custom-infotypes-likelihood">Customizing finding likelihood</a>.</li>
<li>Optional
<a href="/dlp/docs/reference/rest/v2/InspectConfig#DetectionRule"><code dir="ltr" translate="no">DetectionRule</code></a>s,
or hotword rules. These rules adjust the likelihood of findings within a
given proximity of specified hotwords. Learn more about hotword rules in
<a href="/dlp/docs/creating-custom-infotypes-likelihood">Customizing finding likelihood</a>.</li>
<li>A
<a href="/dlp/docs/reference/rest/v2/InspectConfig#Regex"><code dir="ltr" translate="no">Regex</code></a>
object consisting of a single pattern defining the regular expression.</li>
</ul>
<p>As a JSON object, a regex custom infoType detector that includes all optional
components looks like this:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "customInfoTypes":[
    {
      "infoType":{
        "name":"[CUSTOM_INFOTYPE_NAME]"
      },
      "likelihood":"[LIKELIHOOD_VALUE]",
      "detectionRules":[
        {
          "hotwordRule":{
            [HOTWORDRULE_OBJECT]
          }
        },
        ...
      ],
      "regex":{
        "pattern":"[REGEX_PATTERN]"
      }
    }
  ],
  ...
}
</code></pre>
<h2 data-text="Regex example: Match medical record numbers" id="regex-example">Regex example: Match medical record numbers</h2>
<p>The following JSON snippet and code in several languages below show
a regular expression custom infoType detector that instructs
Cloud DLP to match a medical record number
(MRN) in the input text "Patient's MRN 444-5-22222," and assign each match a
likelihood of <code dir="ltr" translate="no">POSSIBLE</code>.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-custom-regex-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-custom-regex-protocol" track-metadata-position="dlp-inspect-custom-regex" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:inspect?key={YOUR_API_KEY}

{
  "item":{
    "value":"Patients MRN 444-5-22222"
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"C_MRN"
        },
        "regex":{
          "pattern":"[1-9]{3}-[1-9]{1}-[1-9]{5}"
        },
        "likelihood":"POSSIBLE"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "result":{
    "findings":[
      {
        "infoType":{
          "name":"C_MRN"
        },
        "likelihood":"POSSIBLE",
        "location":{
          "byteRange":{
            "start":"13",
            "end":"24"
          },
          "codepointRange":{
            "start":"13",
            "end":"24"
          }
        },
        "createTime":"2018-11-30T01:29:37.799Z"
      }
    ]
  }
}
</code></pre>
<p>The output shows that, using the custom infoType detector we gave the name
<code dir="ltr" translate="no">C_MRN</code> and its custom regex, Cloud DLP has correctly
identified the medical record number and assigned it a certainty of <code dir="ltr" translate="no">POSSIBLE</code>,
as we specified.</p>
<p><a href="/dlp/docs/creating-custom-infotypes-likelihood">Customizing match likelihood</a>
builds on this example to include context words.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-custom-regex-java" track-metadata-position="dlp-inspect-custom-regex" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-custom-regex" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-custom-regex" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-custom-regex" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java" data-region-tag="dlp_inspect_custom_regex" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java/HEAD/dlp_inspect_custom_regex" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.IOException;

public class InspectWithCustomRegex {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Patients MRN 444-5-22222";
    String customRegexPattern = "[1-9]{3}-[1-9]{1}-[1-9]{5}";
    inspectWithCustomRegex(projectId, textToInspect, customRegexPattern);
  }

  // Inspects a BigQuery Table
  public static void inspectWithCustomRegex(
      String projectId, String textToInspect, String customRegexPattern) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the regex pattern the inspection will look for.
      Regex regex = Regex.newBuilder().setPattern(customRegexPattern).build();

      // Construct the custom regex detector.
      InfoType infoType = InfoType.newBuilder().setName("C_MRN").build();
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder().setInfoType(infoType).setRegex(regex).build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addCustomInfoTypes(customInfoType)
              .setIncludeQuote(true)
              .setMinLikelihood(Likelihood.POSSIBLE)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-custom-regex-python" track-metadata-position="dlp-inspect-custom-regex" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-custom-regex" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-custom-regex" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-custom-regex" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_with_medical_record_number_custom_regex_detector" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_with_medical_record_number_custom_regex_detector" translate="no"><code dir="ltr" translate="no">def inspect_with_medical_record_number_custom_regex_detector(
    project,
    content_string,
):
    """Uses the Data Loss Prevention API to analyze string with medical record
       number custom regex detector

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a custom regex detector info type called "C_MRN",
    # with ###-#-##### pattern, where each # represents a digit from 1 to 9.
    # The detector has a detection likelihood of POSSIBLE.
    custom_info_types = [
        {
            "info_type": {"name": "C_MRN"},
            "regex": {"pattern": "[1-9]{3}-[1-9]{1}-[1-9]{5}"},
            "likelihood": google.cloud.dlp_v2.Likelihood.POSSIBLE,
        }
    ]

    # Construct the configuration dictionary with the custom regex info type.
    inspect_config = {
        "custom_info_types": custom_info_types,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-custom-infotypes-rules]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention's <a href="/dlp/docs/concepts-infotypes">built-in infoType detectors</a> are
effective at finding common types of sensitive data. <a href="/dlp/docs/creating-custom-infotypes">Custom infoType
detectors</a> enable you to fully customize your own
sensitive data detector. <em>Inspection rules</em> help refine the scan results that
the Cloud DLP returns by modifying the detection mechanism of a
given infoType detector.</p>
<p>If you want to exclude or include more values from the results that are
returned by a built-in infoType detector, you can create a new custom infoType
from scratch and define all the criteria that Cloud DLP should look
for. Alternatively, you can refine the findings that Cloud DLP's
built-in or custom detectors return according to criteria that you specify. You
can do this by adding inspection rules that can help reduce noise, increase
precision and recall, or adjust likelihood certainty of scan findings.</p>
<p>This topic discusses how to use the two types of inspection rules to either
exclude certain findings or add additional findings, all according to custom
criteria that you specify. Presented in this topic are several scenarios in
which you might want to alter an existing infoType detector.</p>
<aside class="note"><strong>Note:</strong><span> The methods described in this topic are not intended to speed scans, but
they can help lessen noise by reducing the volume of output and the number of
findings stored.</span></aside>
<p>The two types of inspection rules are:</p>
<ul>
<li><a href="#exclusion-rules"><em>Exclusion rules</em></a>, which help exclude false or unwanted
findings.</li>
<li><a href="#hotword_rules"><em>Hotword rules</em></a>, which help detect additional findings.</li>
</ul>
<h2 data-text="Exclusion rules" id="exclusion-rules">Exclusion rules</h2>
<p>Exclusion rules are useful in situations like the following:</p>
<ul>
<li>You want to exclude duplicate scan matches in results that are caused by
overlapping infoType detectors. For example, you're scanning for email
addresses and phone numbers, but you are receiving two hits for email
addresses with phone numbers in them, such as "206-555-0764@example.org."</li>
<li>You're experiencing noise in your scan findings. For example, you're seeing
the same dummy email address (such as example@example.com") or domain (such
as "example.com") returned an inordinate number of times by a scan for
legitimate email addresses.</li>
<li>You have a list of terms, phrases, or combination of characters that you
want to exclude from findings.</li>
</ul>
<h3 data-text="Exclusion rules API overview" id="exclusion_rules_api_overview">Exclusion rules API overview</h3>
<p>Cloud DLP defines an exclusion rule in the
<code dir="ltr" translate="no">ExclusionRule</code>
object. Within <code dir="ltr" translate="no">ExclusionRule</code> you specify one of the following:</p>
<ul>
<li>A <a href="/dlp/docs/reference/rest/v2/InspectConfig#Dictionary"><code dir="ltr" translate="no">Dictionary</code></a>
object, which indicates that the exclusion rule is a regular dictionary
rule.</li>
<li>A <a href="/dlp/docs/reference/rest/v2/InspectConfig#regex"><code dir="ltr" translate="no">Regex</code></a>
object, which indicates that the exclusion rule is a regular expression
rule.</li>
<li>An <code dir="ltr" translate="no">ExcludeInfoTypes</code>
object, which contains an array of infoType detectors. If a finding is
matched by any of the infoType detectors listed here, the finding will be
excluded from the scan results.</li>
</ul>
<h3 data-text="Exclusion rule example scenarios" id="exclusion_rule_example_scenarios">Exclusion rule example scenarios</h3>
<p>Each of the following JSON snippets illustrates how to configure
Cloud DLP for the given scenario.</p>
<h4 data-text="Omit specific email address from EMAIL_ADDRESS detector scan" id="omit_specific_email_address_from_email_address_detector_scan">Omit specific email address from EMAIL_ADDRESS detector scan</h4>
<p>The following JSON snippet and code in several languages illustrates how to
indicate to Cloud DLP using an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
that it should avoid matching on
"example@example.com" in a scan that uses the infoType detector <code dir="ltr" translate="no">EMAIL_ADDRESS</code>:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_with_exclusion_dict-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_with_exclusion_dict-protocol" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"EMAIL_ADDRESS"
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "dictionary":{
                  "wordList":{
                    "words":[
                      "example@example.com"
                    ]
                  }
                },
                "matchingType": "MATCHING_TYPE_FULL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_with_exclusion_dict-python" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_dict" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_with_exclusion_dict" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_with_exclusion_dict" translate="no"><code dir="ltr" translate="no">def inspect_string_with_exclusion_dict(
    project, content_string, exclusion_list=["example@example.com"]
):
    """Inspects the provided text, avoiding matches specified in the exclusion list

    Uses the Data Loss Prevention API to omit matches on EMAIL_ADDRESS if they are
    in the specified exclusion list.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        exclusion_list: The list of strings to ignore matches on

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a list of infoTypes for DLP to locate in `content_string`. See
    # https://cloud.google.com/dlp/docs/concepts-infotypes for more information
    # about supported infoTypes.
    info_types_to_locate = [{"name": "EMAIL_ADDRESS"}]

    # Construct a rule set that will only match on EMAIL_ADDRESS
    # if the match text is not in the exclusion list.
    rule_set = [
        {
            "info_types": info_types_to_locate,
            "rules": [
                {
                    "exclusion_rule": {
                        "dictionary": {"word_list": {"words": exclusion_list}},
                        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_FULL_MATCH,
                    }
                }
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "info_types": info_types_to_locate,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_with_exclusion_dict-java" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDict.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDict.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_dict" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDict.java" data-region-tag="dlp_inspect_string_with_exclusion_dict" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDict.java/HEAD/dlp_inspect_string_with_exclusion_dict" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary.WordList;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class InspectStringWithExclusionDict {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Some email addresses: gary@example.com, example@example.com";
    List&lt;String&gt; excludedMatchList = Arrays.asList("example@example.com");
    inspectStringWithExclusionDict(projectId, textToInspect, excludedMatchList);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringWithExclusionDict(
      String projectId, String textToInspect, List&lt;String&gt; excludedMatchList) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      for (String typeName : new String[] {"PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Exclude matches from the specified excludedMatchList.
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setMatchingType(MatchingType.MATCHING_TYPE_FULL_MATCH)
              .setDictionary(
                  Dictionary.newBuilder()
                      .setWordList(WordList.newBuilder().addAllWords(excludedMatchList)))
              .build();

      // Construct a ruleset that applies the exclusion rule to the EMAIL_ADDRESSES infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("EMAIL_ADDRESS"))
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addAllInfoTypes(infoTypes)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_with_exclusion_dict-csharp" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithExclusionDict.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithExclusionDict.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_dict" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_with_exclusion_dict" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithExclusionDict.cs" data-region-tag="dlp_inspect_string_with_exclusion_dict" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithExclusionDict.cs/HEAD/dlp_inspect_string_with_exclusion_dict" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class InspectStringWithExclusionDict
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect, List&lt;String&gt; excludedMatchList)
    {
        var dlp = DlpServiceClient.Create();

        var byteContentItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem { ByteItem = byteContentItem };

        var infoTypes = new string[] { "PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER" }.Select(it =&gt; new InfoType { Name = it });

        var exclusionRule = new ExclusionRule
        {
            MatchingType = MatchingType.FullMatch,
            Dictionary = new CustomInfoType.Types.Dictionary
            {
                WordList = new CustomInfoType.Types.Dictionary.Types.WordList
                {
                    Words = { excludedMatchList }
                }
            }
        };

        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { new InfoType { Name = "EMAIL_ADDRESS" } },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        var config = new InspectConfig
        {
            InfoTypes = { infoTypes },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text="Omit email addresses ending with a specific domain from EMAIL_ADDRESS detector scan" id="omit_email_addresses_ending_with_a_specific_domain_from_email_address_detector_scan">Omit email addresses ending with a specific domain from EMAIL_ADDRESS detector scan</h4>
<p>The following JSON snippet and code in several languages illustrates how to
indicate to Cloud DLP using an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
that it should avoid matching on any email addresses that end with
"@example.com" in a scan that uses the infoType detector <code dir="ltr" translate="no">EMAIL_ADDRESS</code>:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_with_exclusion_regex-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_with_exclusion_regex-protocol" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"EMAIL_ADDRESS"
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "regex":{
                  "pattern":".+@example.com"
                },
                "matchingType": "MATCHING_TYPE_FULL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_with_exclusion_regex-python" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_regex" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_with_exclusion_regex" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_with_exclusion_regex" translate="no"><code dir="ltr" translate="no">def inspect_string_with_exclusion_regex(
    project, content_string, exclusion_regex=".+@example.com"
):
    """Inspects the provided text, avoiding matches specified in the exclusion regex

    Uses the Data Loss Prevention API to omit matches on EMAIL_ADDRESS if they match
    the specified exclusion regex.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        exclusion_regex: The regular expression to exclude matches on

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a list of infoTypes for DLP to locate in `content_string`. See
    # https://cloud.google.com/dlp/docs/concepts-infotypes for more information
    # about supported infoTypes.
    info_types_to_locate = [{"name": "EMAIL_ADDRESS"}]

    # Construct a rule set that will only match on EMAIL_ADDRESS
    # if the specified regex doesn't also match.
    rule_set = [
        {
            "info_types": info_types_to_locate,
            "rules": [
                {
                    "exclusion_rule": {
                        "regex": {"pattern": exclusion_regex},
                        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_FULL_MATCH,
                    }
                }
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "info_types": info_types_to_locate,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_with_exclusion_regex-java" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionRegex.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionRegex.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_regex" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionRegex.java" data-region-tag="dlp_inspect_string_with_exclusion_regex" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionRegex.java/HEAD/dlp_inspect_string_with_exclusion_regex" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class InspectStringWithExclusionRegex {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Some email addresses: gary@example.com, bob@example.org";
    String excludedRegex = ".+@example.com";
    inspectStringWithExclusionRegex(projectId, textToInspect, excludedRegex);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringWithExclusionRegex(
      String projectId, String textToInspect, String excludedRegex) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      for (String typeName : new String[] {"PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Exclude matches from the specified excludedMatchList.
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setMatchingType(MatchingType.MATCHING_TYPE_FULL_MATCH)
              .setRegex(Regex.newBuilder().setPattern(excludedRegex))
              .build();

      // Construct a ruleset that applies the exclusion rule to the EMAIL_ADDRESSES infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("EMAIL_ADDRESS"))
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addAllInfoTypes(infoTypes)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_with_exclusion_regex-csharp" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithExclusionRegex.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithExclusionRegex.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_regex" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_with_exclusion_regex" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithExclusionRegex.cs" data-region-tag="dlp_inspect_string_with_exclusion_regex" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithExclusionRegex.cs/HEAD/dlp_inspect_string_with_exclusion_regex" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class InspectStringWithExclusionRegex
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect, string excludedRegex)
    {
        var dlp = DlpServiceClient.Create();

        var byteContentItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem { ByteItem = byteContentItem };

        var infoTypes = new string[] { "PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER" }.Select(it =&gt; new InfoType { Name = it });

        var exclusionRule = new ExclusionRule
        {
            MatchingType = MatchingType.FullMatch,
            Regex = new CustomInfoType.Types.Regex { Pattern = excludedRegex }
        };

        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { new InfoType { Name = "EMAIL_ADDRESS" } },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        var config = new InspectConfig
        {
            InfoTypes = { infoTypes },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text='Omit scan matches that include the substring "TEST"' id="omit_scan_matches_that_include_the_substring_test">Omit scan matches that include the substring "TEST"</h4>
<p>The following JSON snippet and code in several languages illustrates how to
indicate to Cloud DLP using an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
that it should exclude any findings that include the token "TEST" from the
specified list of infoTypes.</p>
<p>Note that this matches on "TEST" as a token, not a substring, so that although
something like "TEST@email.com" will match, "TESTER@email.com" will not.
If matching on a substring is desired, use a regex in the exclusion rule instead
of a dictionary.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_with_exclusion_dict_substring-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_with_exclusion_dict_substring-protocol" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"EMAIL_ADDRESS"
        },
        {
          "name":"DOMAIN_NAME"
        },
        {
          "name":"PHONE_NUMBER"
        },
        {
          "name":"PERSON_NAME"
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            },
            {
              "name":"DOMAIN_NAME"
            },
            {
              "name":"PHONE_NUMBER"
            },
            {
              "name":"PERSON_NAME"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "dictionary":{
                  "wordList":{
                    "words":[
                      "TEST"
                    ]
                  }
                },
                "matchingType": "MATCHING_TYPE_PARTIAL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_with_exclusion_dict_substring-python" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_dict_substring" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_with_exclusion_dict_substring" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_with_exclusion_dict_substring" translate="no"><code dir="ltr" translate="no">def inspect_string_with_exclusion_dict_substring(
    project, content_string, exclusion_list=["TEST"]
):
    """Inspects the provided text, avoiding matches that contain excluded tokens

    Uses the Data Loss Prevention API to omit matches if they include tokens
    in the specified exclusion list.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        exclusion_list: The list of strings to ignore partial matches on

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a list of infoTypes for DLP to locate in `content_string`. See
    # https://cloud.google.com/dlp/docs/concepts-infotypes for more information
    # about supported infoTypes.
    info_types_to_locate = [{"name": "EMAIL_ADDRESS"}, {"name": "DOMAIN_NAME"}]

    # Construct a rule set that will only match if the match text does not
    # contains tokens from the exclusion list.
    rule_set = [
        {
            "info_types": info_types_to_locate,
            "rules": [
                {
                    "exclusion_rule": {
                        "dictionary": {"word_list": {"words": exclusion_list}},
                        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_PARTIAL_MATCH,
                    }
                }
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "info_types": info_types_to_locate,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_with_exclusion_dict_substring-java" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDictSubstring.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDictSubstring.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_dict_substring" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDictSubstring.java" data-region-tag="dlp_inspect_string_with_exclusion_dict_substring" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithExclusionDictSubstring.java/HEAD/dlp_inspect_string_with_exclusion_dict_substring" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary.WordList;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class InspectStringWithExclusionDictSubstring {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Some email addresses: gary@example.com, TEST@example.com";
    List&lt;String&gt; excludedSubstringList = Arrays.asList("TEST");
    inspectStringWithExclusionDictSubstring(projectId, textToInspect, excludedSubstringList);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringWithExclusionDictSubstring(
      String projectId, String textToInspect, List&lt;String&gt; excludedSubstringList)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      for (String typeName :
          new String[] {"EMAIL_ADDRESS", "DOMAIN_NAME", "PHONE_NUMBER", "PERSON_NAME"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Exclude partial matches from the specified excludedSubstringList.
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setMatchingType(MatchingType.MATCHING_TYPE_PARTIAL_MATCH)
              .setDictionary(
                  Dictionary.newBuilder()
                      .setWordList(WordList.newBuilder().addAllWords(excludedSubstringList)))
              .build();

      // Construct a ruleset that applies the exclusion rule to the EMAIL_ADDRESSES infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addAllInfoTypes(infoTypes)
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addAllInfoTypes(infoTypes)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_with_exclusion_dict_substring-csharp" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithExclusionDictSubstring.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithExclusionDictSubstring.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_with_exclusion_dict_substring" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_with_exclusion_dict_substring" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithExclusionDictSubstring.cs" data-region-tag="dlp_inspect_string_with_exclusion_dict_substring" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithExclusionDictSubstring.cs/HEAD/dlp_inspect_string_with_exclusion_dict_substring" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class InspectStringWithExclusionDictSubstring
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect, List&lt;String&gt; excludedSubstringList)
    {
        var dlp = DlpServiceClient.Create();

        var byteItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem { ByteItem = byteItem };

        var infoTypes = new string[]
        {
            "EMAIL_ADDRESS",
            "DOMAIN_NAME",
            "PHONE_NUMBER",
            "PERSON_NAME"
        }.Select(it =&gt; new InfoType { Name = it });

        var exclusionRule = new ExclusionRule
        {
            MatchingType = MatchingType.PartialMatch,
            Dictionary = new CustomInfoType.Types.Dictionary
            {
                WordList = new CustomInfoType.Types.Dictionary.Types.WordList
                {
                    Words = { excludedSubstringList }
                }
            }
        };

        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { infoTypes },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        var config = new InspectConfig
        {
            InfoTypes = { infoTypes },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text='Omit scan matches that include the substring "Jimmy" from a custom infoType detector scan' id="omit_scan_matches_that_include_the_substring_jimmy_from_a_custom_infotype_detector_scan">Omit scan matches that include the substring "Jimmy" from a custom infoType detector scan</h4>
<p>The following JSON snippet and code in several languages illustrates how to
indicate to Cloud DLP using an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
that it should avoid matching on the name "Jimmy" in a scan that
uses the specified custom regex detector:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_custom_excluding_substring-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_custom_excluding_substring-protocol" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "customInfoTypes":[
        {
          "infoType":{
            "name":"CUSTOM_NAME_DETECTOR"
          },
          "regex":{
            "pattern":"[A-Z][a-z]{1,15}, [A-Z][a-z]{1,15}"
          }
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"CUSTOM_NAME_DETECTOR"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "dictionary":{
                  "wordList":{
                    "words":[
                      "Jimmy"
                    ]
                  }
                },
                "matchingType": "MATCHING_TYPE_PARTIAL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_custom_excluding_substring-python" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_excluding_substring" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_custom_excluding_substring" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_custom_excluding_substring" translate="no"><code dir="ltr" translate="no">def inspect_string_custom_excluding_substring(
    project, content_string, exclusion_list=["jimmy"]
):
    """Inspects the provided text with a custom detector, avoiding matches on specific tokens

    Uses the Data Loss Prevention API to omit matches on a custom detector
    if they include tokens in the specified exclusion list.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        exclusion_list: The list of strings to ignore matches on

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a custom regex detector for names
    custom_info_types = [
        {
            "info_type": {"name": "CUSTOM_NAME_DETECTOR"},
            "regex": {"pattern": "[A-Z][a-z]{1,15}, [A-Z][a-z]{1,15}"},
        }
    ]

    # Construct a rule set that will only match if the match text does not
    # contains tokens from the exclusion list.
    rule_set = [
        {
            "info_types": [{"name": "CUSTOM_NAME_DETECTOR"}],
            "rules": [
                {
                    "exclusion_rule": {
                        "dictionary": {"word_list": {"words": exclusion_list}},
                        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_PARTIAL_MATCH,
                    }
                }
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "custom_info_types": custom_info_types,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_custom_excluding_substring-java" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomExcludingSubstring.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomExcludingSubstring.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_excluding_substring" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomExcludingSubstring.java" data-region-tag="dlp_inspect_string_custom_excluding_substring" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomExcludingSubstring.java/HEAD/dlp_inspect_string_custom_excluding_substring" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary.WordList;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;

public class InspectStringCustomExcludingSubstring {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Name: Doe, John. Name: Example, Jimmy";
    String customDetectorPattern = "[A-Z][a-z]{1,15}, [A-Z][a-z]{1,15}";
    List&lt;String&gt; excludedSubstringList = Arrays.asList("Jimmy");
    inspectStringCustomExcludingSubstring(
        projectId, textToInspect, customDetectorPattern, excludedSubstringList);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringCustomExcludingSubstring(
      String projectId,
      String textToInspect,
      String customDetectorPattern,
      List&lt;String&gt; excludedSubstringList)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      InfoType infoType = InfoType.newBuilder().setName("CUSTOM_NAME_DETECTOR").build();
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder()
              .setInfoType(infoType)
              .setRegex(Regex.newBuilder().setPattern(customDetectorPattern))
              .build();

      // Exclude partial matches from the specified excludedSubstringList.
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setMatchingType(MatchingType.MATCHING_TYPE_PARTIAL_MATCH)
              .setDictionary(
                  Dictionary.newBuilder()
                      .setWordList(WordList.newBuilder().addAllWords(excludedSubstringList)))
              .build();

      // Construct a ruleset that applies the exclusion rule to the EMAIL_ADDRESSES infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(infoType)
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addCustomInfoTypes(customInfoType)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_custom_excluding_substring-csharp" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringCustomExcludingSubstring.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringCustomExcludingSubstring.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_excluding_substring" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_custom_excluding_substring" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringCustomExcludingSubstring.cs" data-region-tag="dlp_inspect_string_custom_excluding_substring" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringCustomExcludingSubstring.cs/HEAD/dlp_inspect_string_custom_excluding_substring" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class InspectStringCustomExcludingSubstring
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect, string customDetectorPattern, List&lt;String&gt; excludedSubstringList)
    {
        var dlp = DlpServiceClient.Create();

        var byteContentItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem { ByteItem = byteContentItem };

        var infoType = new InfoType
        {
            Name = "CUSTOM_NAME_DETECTOR"
        };
        var customInfoType = new CustomInfoType
        {
            InfoType = infoType,
            Regex = new CustomInfoType.Types.Regex { Pattern = customDetectorPattern }
        };

        var exclusionRule = new ExclusionRule
        {
            MatchingType = MatchingType.PartialMatch,
            Dictionary = new CustomInfoType.Types.Dictionary
            {
                WordList = new CustomInfoType.Types.Dictionary.Types.WordList
                {
                    Words = { excludedSubstringList }
                }
            }
        };

        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { infoType },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        var config = new InspectConfig
        {
            CustomInfoTypes = { customInfoType },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text="Omit scan matches from a PERSON_NAME detector scan that overlap with a custom detector" id="omit_scan_matches_from_a_person_name_detector_scan_that_overlap_with_a_custom_detector">Omit scan matches from a PERSON_NAME detector scan that overlap with a custom detector</h4>
<p>In this scenario, the user does not want a match from a Cloud DLP
scan using the <code dir="ltr" translate="no">PERSON_NAME</code> built-in detector returned if the match would also
be matched in a scan using the custom regex detector defined in the first part
of the snippet.</p>
<p>The following JSON snippet and code in several languages specifies both a custom
regex detector and an exclusion rule in the
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>.
The custom regex detector specifies the names to exclude from results. The
exclusion rule specifies that if any results returned from a scan for
<code dir="ltr" translate="no">PERSON_NAME</code> would also be matched by the custom regex detector, they are
omitted. Note that <code dir="ltr" translate="no">VIP_DETECTOR</code> in this case is marked as
<code dir="ltr" translate="no">EXCLUSION_TYPE_EXCLUDE</code>, so it will not produce results itself. It will only
affect results produced by the <code dir="ltr" translate="no">PERSON_NAME</code> detector.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_custom_omit_overlap-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_custom_omit_overlap-protocol" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PERSON_NAME"
        }
      ],
      "customInfoTypes":[
        {
          "infoType":{
            "name":"VIP_DETECTOR"
          },
          "regex":{
            "pattern":"Larry Page|Sergey Brin"
          },
          "exclusionType":"EXCLUSION_TYPE_EXCLUDE"
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"PERSON_NAME"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "excludeInfoTypes":{
                  "infoTypes":[
                    {
                      "name":"VIP_DETECTOR"
                    }
                  ]
                },
                "matchingType": "MATCHING_TYPE_FULL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_custom_omit_overlap-python" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_omit_overlap" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_custom_omit_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_custom_omit_overlap" translate="no"><code dir="ltr" translate="no">def inspect_string_custom_omit_overlap(project, content_string):
    """Matches PERSON_NAME and a custom detector,
    but if they overlap only matches the custom detector

    Uses the Data Loss Prevention API to omit matches on a built-in detector
    if they overlap with matches from a custom detector

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a custom regex detector for names
    custom_info_types = [
        {
            "info_type": {"name": "VIP_DETECTOR"},
            "regex": {"pattern": "Larry Page|Sergey Brin"},
            "exclusion_type": google.cloud.dlp_v2.CustomInfoType.ExclusionType.EXCLUSION_TYPE_EXCLUDE,
        }
    ]

    # Construct a rule set that will exclude PERSON_NAME matches
    # that overlap with VIP_DETECTOR matches
    rule_set = [
        {
            "info_types": [{"name": "PERSON_NAME"}],
            "rules": [
                {
                    "exclusion_rule": {
                        "exclude_info_types": {
                            "info_types": [{"name": "VIP_DETECTOR"}]
                        },
                        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_FULL_MATCH,
                    }
                }
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "info_types": [{"name": "PERSON_NAME"}],
        "custom_info_types": custom_info_types,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_custom_omit_overlap-java" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomOmitOverlap.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomOmitOverlap.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_omit_overlap" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomOmitOverlap.java" data-region-tag="dlp_inspect_string_custom_omit_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomOmitOverlap.java/HEAD/dlp_inspect_string_custom_omit_overlap" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.ExclusionType;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.ExcludeInfoTypes;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;

public class InspectStringCustomOmitOverlap {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Name: Jane Doe. Name: Larry Page.";
    inspectStringCustomOmitOverlap(projectId, textToInspect);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringCustomOmitOverlap(String projectId, String textToInspect)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Construct the custom infotype.
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder()
              .setInfoType(InfoType.newBuilder().setName("VIP_DETECTOR"))
              .setRegex(Regex.newBuilder().setPattern("Larry Page|Sergey Brin"))
              .setExclusionType(ExclusionType.EXCLUSION_TYPE_EXCLUDE)
              .build();

      // Exclude matches that also match the custom infotype.
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setExcludeInfoTypes(
                  ExcludeInfoTypes.newBuilder().addInfoTypes(customInfoType.getInfoType()))
              .setMatchingType(MatchingType.MATCHING_TYPE_FULL_MATCH)
              .build();

      // Construct a ruleset that applies the exclusion rule to the PERSON_NAME infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME"))
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME"))
              .addCustomInfoTypes(customInfoType)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_custom_omit_overlap-csharp" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringCustomOmitOverlap.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringCustomOmitOverlap.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_omit_overlap" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_custom_omit_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringCustomOmitOverlap.cs" data-region-tag="dlp_inspect_string_custom_omit_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringCustomOmitOverlap.cs/HEAD/dlp_inspect_string_custom_omit_overlap" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using static Google.Cloud.Dlp.V2.CustomInfoType.Types;

public class InspectStringCustomOmitOverlap
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect)
    {
        var dlp = DlpServiceClient.Create();

        var byteItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem { ByteItem = byteItem };

        var customInfoType = new CustomInfoType
        {
            InfoType = new InfoType { Name = "VIP_DETECTOR" },
            Regex = new CustomInfoType.Types.Regex { Pattern = "Larry Page|Sergey Brin" },
            ExclusionType = ExclusionType.Exclude
        };

        var exclusionRule = new ExclusionRule
        {
            ExcludeInfoTypes = new ExcludeInfoTypes { InfoTypes = { customInfoType.InfoType } },
            MatchingType = MatchingType.FullMatch
        };

        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { new InfoType { Name = "PERSON_NAME" } },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        var config = new InspectConfig
        {
            InfoTypes = { new InfoType { Name = "PERSON_NAME" } },
            CustomInfoTypes = { customInfoType },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text="Omit matches on PERSON_NAME detector if also matched by EMAIL_ADDRESS detector" id="omit_matches_on_person_name_detector_if_also_matched_by_email_address_detector">Omit matches on PERSON_NAME detector if also matched by EMAIL_ADDRESS detector</h4>
<p>The following JSON snippet and code in several languages illustrate how to
indicate to Cloud DLP using an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
that it should only return one match in the case that matches for the
<code dir="ltr" translate="no">PERSON_NAME</code> detector overlap with matches for the <code dir="ltr" translate="no">EMAIL_ADDRESS</code> detector.
Doing this is to avoid the situation where an email address such as
"james@example.com" matches on both the <code dir="ltr" translate="no">PERSON_NAME</code> and <code dir="ltr" translate="no">EMAIL_ADDRESS</code>
detectors.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_omit_overlap-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_omit_overlap-protocol" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PERSON_NAME"
        },
        {
          "name":"EMAIL_ADDRESS"
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"PERSON_NAME"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "excludeInfoTypes":{
                  "infoTypes":[
                    {
                      "name":"EMAIL_ADDRESS"
                    }
                  ]
                },
                "matchingType": "MATCHING_TYPE_PARTIAL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_omit_overlap-python" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_omit_overlap" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_omit_name_if_also_email" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_omit_name_if_also_email" translate="no"><code dir="ltr" translate="no">def omit_name_if_also_email(
    project,
    content_string,
):
    """Matches PERSON_NAME and EMAIL_ADDRESS, but not both.

    Uses the Data Loss Prevention API omit matches on PERSON_NAME if the
    EMAIL_ADDRESS detector also matches.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a list of infoTypes for DLP to locate in `content_string`. See
    # https://cloud.google.com/dlp/docs/concepts-infotypes for more information
    # about supported infoTypes.
    info_types_to_locate = [{"name": "PERSON_NAME"}, {"name": "EMAIL_ADDRESS"}]

    # Construct the configuration dictionary that will only match on PERSON_NAME
    # if the EMAIL_ADDRESS doesn't also match. This configuration helps reduce
    # the total number of findings when there is a large overlap between different
    # infoTypes.
    inspect_config = {
        "info_types": info_types_to_locate,
        "rule_set": [
            {
                "info_types": [{"name": "PERSON_NAME"}],
                "rules": [
                    {
                        "exclusion_rule": {
                            "exclude_info_types": {
                                "info_types": [{"name": "EMAIL_ADDRESS"}]
                            },
                            "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_PARTIAL_MATCH,
                        }
                    }
                ],
            }
        ],
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_omit_overlap-java" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringOmitOverlap.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringOmitOverlap.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_omit_overlap" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringOmitOverlap.java" data-region-tag="dlp_inspect_string_omit_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringOmitOverlap.java/HEAD/dlp_inspect_string_omit_overlap" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.ExcludeInfoTypes;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class InspectStringOmitOverlap {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "james@example.com";
    inspectStringOmitOverlap(projectId, textToInspect);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringOmitOverlap(String projectId, String textToInspect)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      for (String typeName : new String[] {"PERSON_NAME", "EMAIL_ADDRESS"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Exclude EMAIL_ADDRESS matches
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setExcludeInfoTypes(
                  ExcludeInfoTypes.newBuilder()
                      .addInfoTypes(InfoType.newBuilder().setName("EMAIL_ADDRESS")))
              .setMatchingType(MatchingType.MATCHING_TYPE_PARTIAL_MATCH)
              .build();

      // Construct a ruleset that applies the exclusion rule to the PERSON_NAME infotype.
      // If a PERSON_NAME match overlaps with an EMAIL_ADDRESS match, the PERSON_NAME match will
      // be excluded.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME"))
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addAllInfoTypes(infoTypes)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_omit_overlap-csharp" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringOmitOverlap.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringOmitOverlap.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_omit_overlap" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_omit_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringOmitOverlap.cs" data-region-tag="dlp_inspect_string_omit_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringOmitOverlap.cs/HEAD/dlp_inspect_string_omit_overlap" translate="no"><code dir="ltr" translate="no">
using System;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class InspectStringOmitOverlap
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect)
    {
        // Initialize client that will be used to send requests. This client only needs to be created
        // once, and can be reused for multiple requests. After completing all of your requests, call
        // the "close" method on the client to safely clean up any remaining background resources.
        var dlp = DlpServiceClient.Create();

        // Specify the type and content to be inspected.
        var byteItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };
        var contentItem = new ContentItem { ByteItem = byteItem };

        // Specify the type of info the inspection will look for.
        // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
        var infoTypes = new string[] { "PERSON_NAME", "EMAIL_ADDRESS" }.Select(it =&gt; new InfoType { Name = it });

        // Exclude EMAIL_ADDRESS matches
        var exclusionRule = new ExclusionRule
        {
            ExcludeInfoTypes = new ExcludeInfoTypes { InfoTypes = { new InfoType { Name = "EMAIL_ADDRESS" } } },
            MatchingType = MatchingType.PartialMatch
        };

        // Construct a ruleset that applies the exclusion rule to the PERSON_NAME infotype.
        // If a PERSON_NAME match overlaps with an EMAIL_ADDRESS match, the PERSON_NAME match will
        // be excluded.
        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { new InfoType { Name = "PERSON_NAME" } },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        // Construct the configuration for the Inspect request, including the ruleset.
        var config = new InspectConfig
        {
            InfoTypes = { infoTypes },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        // Construct the Inspect request to be sent by the client.
        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        // Use the client to send the API request.
        var response = dlp.InspectContent(request);

        // Parse the response and process results
        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text="Omit matches on domain names that are part of email addresses in a DOMAIN_NAME detector scan" id="omit_matches_on_domain_names_that_are_part_of_email_addresses_in_a_domain_name_detector_scan">Omit matches on domain names that are part of email addresses in a DOMAIN_NAME detector scan</h4>
<p>The following JSON snippet and code in several languages illustrate how to
indicate to Cloud DLP using an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
that it should only return matches for a <code dir="ltr" translate="no">DOMAIN_NAME</code> detector scan if the
match does not overlap with a match in an <code dir="ltr" translate="no">EMAIL_ADDRESS</code> detector scan. In
this scenario, the main scan is a <code dir="ltr" translate="no">DOMAIN_NAME</code> detector scan. The user does not
want a domain name match returned in findings if the domain name is used in an
email address:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_without_overlap-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_without_overlap-protocol" track-metadata-position="dlp_inspect_string_without_overlap" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"DOMAIN_NAME"
        },
        {
          "name":"EMAIL_ADDRESS"
        }
      ],
      "customInfoTypes":[
        {
          "infoType":{
            "name":"EMAIL_ADDRESS"
          },
          "exclusionType":"EXCLUSION_TYPE_EXCLUDE"
        }
      ],
      "ruleSet":[
        {
          "infoTypes":[
            {
              "name":"DOMAIN_NAME"
            }
          ],
          "rules":[
            {
              "exclusionRule":{
                "excludeInfoTypes":{
                  "infoTypes":[
                    {
                      "name":"EMAIL_ADDRESS"
                    }
                  ]
                },
                "matchingType": "MATCHING_TYPE_PARTIAL_MATCH"
              }
            }
          ]
        }
      ]
    }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_without_overlap-python" track-metadata-position="dlp_inspect_string_without_overlap" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_without_overlap" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_without_overlap" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_without_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_without_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_without_overlap" translate="no"><code dir="ltr" translate="no">def inspect_string_without_overlap(project, content_string):
    """Matches EMAIL_ADDRESS and DOMAIN_NAME, but DOMAIN_NAME is omitted
    if it overlaps with EMAIL_ADDRESS

    Uses the Data Loss Prevention API to omit matches of one infotype
    that overlap with another.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a list of infoTypes for DLP to locate in `content_string`. See
    # https://cloud.google.com/dlp/docs/concepts-infotypes for more information
    # about supported infoTypes.
    info_types_to_locate = [{"name": "DOMAIN_NAME"}, {"name": "EMAIL_ADDRESS"}]

    # Define a custom info type to exclude email addresses
    custom_info_types = [
        {
            "info_type": {"name": "EMAIL_ADDRESS"},
            "exclusion_type": google.cloud.dlp_v2.CustomInfoType.ExclusionType.EXCLUSION_TYPE_EXCLUDE,
        }
    ]

    # Construct a rule set that will exclude DOMAIN_NAME matches
    # that overlap with EMAIL_ADDRESS matches
    rule_set = [
        {
            "info_types": [{"name": "DOMAIN_NAME"}],
            "rules": [
                {
                    "exclusion_rule": {
                        "exclude_info_types": {
                            "info_types": [{"name": "EMAIL_ADDRESS"}]
                        },
                        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_PARTIAL_MATCH,
                    }
                }
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "info_types": info_types_to_locate,
        "custom_info_types": custom_info_types,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_without_overlap-java" track-metadata-position="dlp_inspect_string_without_overlap" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_without_overlap" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithoutOverlap.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringWithoutOverlap.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_without_overlap" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_without_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithoutOverlap.java" data-region-tag="dlp_inspect_string_without_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringWithoutOverlap.java/HEAD/dlp_inspect_string_without_overlap" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.ExclusionType;
import com.google.privacy.dlp.v2.ExcludeInfoTypes;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class InspectStringWithoutOverlap {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "example.com is a domain, james@example.org is an email.";
    inspectStringWithoutOverlap(projectId, textToInspect);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringWithoutOverlap(String projectId, String textToInspect)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      for (String typeName : new String[] {"DOMAIN_NAME", "EMAIL_ADDRESS"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }

      // Define a custom info type to exclude email addresses
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder()
              .setInfoType(InfoType.newBuilder().setName("EMAIL_ADDRESS"))
              .setExclusionType(ExclusionType.EXCLUSION_TYPE_EXCLUDE)
              .build();

      // Exclude EMAIL_ADDRESS matches
      ExclusionRule exclusionRule =
          ExclusionRule.newBuilder()
              .setExcludeInfoTypes(
                  ExcludeInfoTypes.newBuilder()
                      .addInfoTypes(InfoType.newBuilder().setName("EMAIL_ADDRESS")))
              .setMatchingType(MatchingType.MATCHING_TYPE_PARTIAL_MATCH)
              .build();

      // Construct a ruleset that applies the exclusion rule to the DOMAIN_NAME infotype.
      // If a DOMAIN_NAME match is part of an EMAIL_ADDRESS match, the DOMAIN_NAME match will
      // be excluded.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("DOMAIN_NAME"))
              .addRules(InspectionRule.newBuilder().setExclusionRule(exclusionRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addAllInfoTypes(infoTypes)
              .addCustomInfoTypes(customInfoType)
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_without_overlap-csharp" track-metadata-position="dlp_inspect_string_without_overlap" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_without_overlap" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithoutOverlap.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringWithoutOverlap.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_without_overlap" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_without_overlap" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithoutOverlap.cs" data-region-tag="dlp_inspect_string_without_overlap" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringWithoutOverlap.cs/HEAD/dlp_inspect_string_without_overlap" translate="no"><code dir="ltr" translate="no">
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using static Google.Cloud.Dlp.V2.CustomInfoType.Types;

public class InspectStringWithoutOverlap
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect)
    {
        // Initialize client that will be used to send requests. This client only needs to be created
        // once, and can be reused for multiple requests. After completing all of your requests, call
        // the "close" method on the client to safely clean up any remaining background resources.
        var dlp = DlpServiceClient.Create();

        // Specify the type and content to be inspected.
        var byteContentItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };
        var contentItem = new ContentItem
        {
            ByteItem = byteContentItem
        };

        // Specify the type of info the inspection will look for.
        // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types.
        var infoTypes = new string[] { "DOMAIN_NAME", "EMAIL_ADDRESS" }.Select(it =&gt; new InfoType { Name = it });

        // Define a custom info type to exclude email addresses
        var customInfoType = new CustomInfoType
        {
            InfoType = new InfoType { Name = "EMAIL_ADDRESS" },
            ExclusionType = ExclusionType.Exclude
        };

        // Exclude EMAIL_ADDRESS matches
        var exclusionRule = new ExclusionRule
        {
            ExcludeInfoTypes = new ExcludeInfoTypes
            {
                InfoTypes = { new InfoType { Name = "EMAIL_ADDRESS" } }
            },
            MatchingType = MatchingType.PartialMatch
        };

        // Construct a ruleset that applies the exclusion rule to the DOMAIN_NAME infotype.
        // If a DOMAIN_NAME match is part of an EMAIL_ADDRESS match, the DOMAIN_NAME match will
        // be excluded.
        var ruleSet = new InspectionRuleSet
        {
            InfoTypes = { new InfoType { Name = "DOMAIN_NAME" } },
            Rules = { new InspectionRule { ExclusionRule = exclusionRule } }
        };

        // Construct the configuration for the Inspect request, including the ruleset.
        var config = new InspectConfig
        {
            InfoTypes = { infoTypes },
            CustomInfoTypes = { customInfoType },
            IncludeQuote = true,
            RuleSet = { ruleSet }
        };

        // Construct the Inspect request to be sent by the client.
        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = config
        };

        // Use the client to send the API request.
        var response = dlp.InspectContent(request);

        return response;
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Hotword rules" id="hotword_rules">Hotword rules</h2>
<p>Hotword rules are useful in situations such as the following:</p>
<ul>
<li>You want to change likelihood values assigned to scan matches based on
the match's proximity to a hotword. For example, you want to set the
likelihood value higher for matches on patient names depending on the
names' proximity to the word "patient."</li>
<li>When inspecting structured, tabular data, you want to change likelihood
values assigned to matches <a href="/dlp/docs/creating-custom-infotypes-likelihood#match-column-values">based on a column header name</a>. For example, you
want to set the likelihood value higher for <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> when
found in a column with header <code dir="ltr" translate="no">ACCOUNT_ID</code>.</li>
</ul>
<h3 data-text="Hotword rules API overview" id="hotword_rules_api_overview">Hotword rules API overview</h3>
<p>Within Cloud DLP's
<a href="/dlp/docs/reference/rest/v2/InspectConfig#InspectionRule"><code dir="ltr" translate="no">InspectionRule</code></a>
object, you specify a
<a href="/dlp/docs/reference/rest/v2/InspectConfig#HotwordRule"><code dir="ltr" translate="no">HotwordRule</code></a>
object, which adjusts the likelihood of findings within a certain proximity
of hotwords.</p>
<p><code dir="ltr" translate="no">InspectionRule</code> objects are grouped as a "rule set" in an <code dir="ltr" translate="no">InspectionRuleSet</code>
object, along with a list of infoType detectors the rule set applies to. Rules
within a rule set are applied in the order specified.</p>
<h3 data-text="Hotword rule example scenarios" id="hotword-examples">Hotword rule example scenarios</h3>
<p>The following code snippet illustrates how to configure
Cloud DLP for the given scenario.</p>
<h4 data-text='Increase the likelihood of a PERSON_NAME match if there is the hotword "patient" nearby' id="increase_the_likelihood_of_a_person_name_match_if_there_is_the_hotword_patient_nearby">Increase the likelihood of a PERSON_NAME match if there is the hotword "patient" nearby</h4>
<p>The following JSON snippet and code in several languages illustrate using the
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a> property
for the purpose of scanning a medical database for patient names. You
can use Cloud DLP's built-in <code dir="ltr" translate="no">PERSON_NAME</code> infoType detector,
but that will cause Cloud DLP to match on all names of
people, not just names of patients. To fix this, you can include a hotword rule
that looks for the word "patient" within a certain character proximity from the
first character of potential matches. You can then assign findings matching this
pattern a <a href="/dlp/docs/likelihood">likelihood</a> of
"very likely," since they correspond to your special criteria. Setting the
minimum
<a href="/dlp/docs/reference/rest/v2/InspectConfig#Likelihood"><code dir="ltr" translate="no">Likelihood</code></a>
to <code dir="ltr" translate="no">VERY_LIKELY</code> within
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
ensures that only matches to this configuration are returned in findings.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_custom_hotword-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_custom_hotword-protocol" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"PERSON_NAME"
      }
    ],
    "ruleSet":[
      {
        "infoTypes":[
          {
            "name":"PERSON_NAME"
          }
        ],
        "rules":[
          {
            "hotwordRule":{
              "hotwordRegex":{
                "pattern":"patient"
              },
              "proximity":{
                "windowBefore":50
              },
              "likelihoodAdjustment":{
                "fixedLikelihood":"VERY_LIKELY"
              }
            }
          }
        ]
      }
    ],
    "minLikelihood":"VERY_LIKELY"
  }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_custom_hotword-python" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_hotword" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="inspect_with_person_name_w_custom_hotword" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/inspect_with_person_name_w_custom_hotword" translate="no"><code dir="ltr" translate="no">def inspect_with_person_name_w_custom_hotword(
    project, content_string, custom_hotword="patient"
):
    """Uses the Data Loss Prevention API increase likelihood for matches on
       PERSON_NAME if the user specified custom hotword is present. Only
       includes findings with the increased likelihood by setting a minimum
       likelihood threshold of VERY_LIKELY.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        custom_hotword: The custom hotword used for likelihood boosting.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a rule set with caller provided hotword, with a likelihood
    # boost to VERY_LIKELY when the hotword are present within the 50 character-
    # window preceding the PII finding.
    hotword_rule = {
        "hotword_regex": {"pattern": custom_hotword},
        "likelihood_adjustment": {
            "fixed_likelihood": google.cloud.dlp_v2.Likelihood.VERY_LIKELY
        },
        "proximity": {"window_before": 50},
    }

    rule_set = [
        {
            "info_types": [{"name": "PERSON_NAME"}],
            "rules": [{"hotword_rule": hotword_rule}],
        }
    ]

    # Construct the configuration dictionary with the custom regex info type.
    inspect_config = {
        "rule_set": rule_set,
        "min_likelihood": google.cloud.dlp_v2.Likelihood.VERY_LIKELY,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_custom_hotword-java" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomHotword.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomHotword.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_hotword" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomHotword.java" data-region-tag="dlp_inspect_string_custom_hotword" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringCustomHotword.java/HEAD/dlp_inspect_string_custom_hotword" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.HotwordRule;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.LikelihoodAdjustment;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.Proximity;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.IOException;

public class InspectStringCustomHotword {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "patient name: John Doe";
    String customHotword = "patient";
    inspectStringCustomHotword(projectId, textToInspect, customHotword);
  }

  // Inspects the provided text.
  public static void inspectStringCustomHotword(
      String projectId, String textToInspect, String customHotword) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Increase likelihood of matches that have customHotword nearby
      HotwordRule hotwordRule =
          HotwordRule.newBuilder()
              .setHotwordRegex(Regex.newBuilder().setPattern(customHotword))
              .setProximity(Proximity.newBuilder().setWindowBefore(50))
              .setLikelihoodAdjustment(
                  LikelihoodAdjustment.newBuilder().setFixedLikelihood(Likelihood.VERY_LIKELY))
              .build();

      // Construct a ruleset that applies the hotword rule to the PERSON_NAME infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME").build())
              .addRules(InspectionRule.newBuilder().setHotwordRule(hotwordRule))
              .build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME").build())
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .setMinLikelihood(Likelihood.VERY_LIKELY)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_custom_hotword-csharp" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringCustomHotword.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringCustomHotword.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_custom_hotword" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_custom_hotword" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringCustomHotword.cs" data-region-tag="dlp_inspect_string_custom_hotword" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringCustomHotword.cs/HEAD/dlp_inspect_string_custom_hotword" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using System;
using static Google.Cloud.Dlp.V2.CustomInfoType.Types;

public class InspectStringCustomHotword
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect, string customHotword)
    {
        var dlp = DlpServiceClient.Create();

        var byteContentItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem
        {
            ByteItem = byteContentItem
        };

        var hotwordRule = new DetectionRule.Types.HotwordRule
        {
            HotwordRegex = new Regex { Pattern = customHotword },
            Proximity = new DetectionRule.Types.Proximity { WindowBefore = 50 },
            LikelihoodAdjustment = new DetectionRule.Types.LikelihoodAdjustment { FixedLikelihood = Likelihood.VeryLikely }
        };

        var infoType = new InfoType { Name = "PERSON_NAME" };

        var inspectionRuleSet = new InspectionRuleSet
        {
            InfoTypes = { infoType },
            Rules = { new InspectionRule { HotwordRule = hotwordRule } }
        };

        var inspectConfig = new InspectConfig
        {
            InfoTypes = { infoType },
            IncludeQuote = true,
            RuleSet = { inspectionRuleSet },
            MinLikelihood = Likelihood.VeryLikely
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = inspectConfig
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}</code></pre>
</div>
</section>
</div>
<p>For more detailed information about hotwords, see <a href="/dlp/docs/creating-custom-infotypes-likelihood">Customizing match
likelihood</a>.</p>
<h2 data-text="Multiple inspection rules scenario" id="multiple_inspection_rules_scenario">Multiple inspection rules scenario</h2>
<p>The following
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
JSON snippet and code in several languages illustrate applying both exclusion
and hotword rules. This snippet's rule set includes both hotword rules and
dictionary and regex exclusion rules. Notice that the four rules are specified
in an array within the <code dir="ltr" translate="no">rules</code> element.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_string_multiple_rules-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_string_multiple_rules-protocol" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"PERSON_NAME"
      }
    ],
    "ruleSet":[
      {
        "infoTypes":[
          {
            "name":"PERSON_NAME"
          }
        ],
        "rules":[
          {
            "hotwordRule":{
              "hotwordRegex":{
                "pattern":"patient"
              },
              "proximity":{
                "windowBefore":10
              },
              "likelihoodAdjustment":{
                "fixedLikelihood":"VERY_LIKELY"
              }
            }
          },
          {
            "hotwordRule":{
              "hotwordRegex":{
                "pattern":"doctor"
              },
              "proximity":{
                "windowBefore":10
              },
              "likelihoodAdjustment":{
                "fixedLikelihood":"UNLIKELY"
              }
            }
          },
          {
            "exclusionRule":{
              "dictionary":{
                "wordList":{
                  "words":[
                    "Quasimodo"
                  ]
                }
              },
              "matchingType": "MATCHING_TYPE_PARTIAL_MATCH"
            }
          },
          {
            "exclusionRule":{
              "regex":{
                "pattern":"REDACTED"
              },
              "matchingType": "MATCHING_TYPE_PARTIAL_MATCH"
            }
          }
        ]
      }
    ]
  }
...
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_string_multiple_rules-python" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_multiple_rules" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_string_multiple_rules" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_string_multiple_rules" translate="no"><code dir="ltr" translate="no">def inspect_string_multiple_rules(project, content_string):
    """Uses the Data Loss Prevention API to modify likelihood for matches on
       PERSON_NAME combining multiple hotword and exclusion rules.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct hotword rules
    patient_rule = {
        "hotword_regex": {"pattern": "patient"},
        "proximity": {"window_before": 10},
        "likelihood_adjustment": {
            "fixed_likelihood": google.cloud.dlp_v2.Likelihood.VERY_LIKELY
        },
    }
    doctor_rule = {
        "hotword_regex": {"pattern": "doctor"},
        "proximity": {"window_before": 10},
        "likelihood_adjustment": {
            "fixed_likelihood": google.cloud.dlp_v2.Likelihood.UNLIKELY
        },
    }

    # Construct exclusion rules
    quasimodo_rule = {
        "dictionary": {"word_list": {"words": ["quasimodo"]}},
        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_PARTIAL_MATCH,
    }
    redacted_rule = {
        "regex": {"pattern": "REDACTED"},
        "matching_type": google.cloud.dlp_v2.MatchingType.MATCHING_TYPE_PARTIAL_MATCH,
    }

    # Construct the rule set, combining the above rules
    rule_set = [
        {
            "info_types": [{"name": "PERSON_NAME"}],
            "rules": [
                {"hotword_rule": patient_rule},
                {"hotword_rule": doctor_rule},
                {"exclusion_rule": quasimodo_rule},
                {"exclusion_rule": redacted_rule},
            ],
        }
    ]

    # Construct the configuration dictionary
    inspect_config = {
        "info_types": [{"name": "PERSON_NAME"}],
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_string_multiple_rules-java" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringMultipleRules.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectStringMultipleRules.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_multiple_rules" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringMultipleRules.java" data-region-tag="dlp_inspect_string_multiple_rules" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectStringMultipleRules.java/HEAD/dlp_inspect_string_multiple_rules" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.HotwordRule;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.LikelihoodAdjustment;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.Proximity;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary;
import com.google.privacy.dlp.v2.CustomInfoType.Dictionary.WordList;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.ExclusionRule;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.MatchingType;
import com.google.protobuf.ByteString;
import java.io.IOException;

public class InspectStringMultipleRules {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "patient: Jane Doe";
    inspectStringMultipleRules(projectId, textToInspect);
  }

  // Inspects the provided text, avoiding matches specified in the exclusion list.
  public static void inspectStringMultipleRules(String projectId, String textToInspect)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Construct hotword rules
      HotwordRule patientRule =
          HotwordRule.newBuilder()
              .setHotwordRegex(Regex.newBuilder().setPattern("patient"))
              .setProximity(Proximity.newBuilder().setWindowBefore(10))
              .setLikelihoodAdjustment(
                  LikelihoodAdjustment.newBuilder().setFixedLikelihood(Likelihood.VERY_LIKELY))
              .build();

      HotwordRule doctorRule =
          HotwordRule.newBuilder()
              .setHotwordRegex(Regex.newBuilder().setPattern("doctor"))
              .setProximity(Proximity.newBuilder().setWindowBefore(10))
              .setLikelihoodAdjustment(
                  LikelihoodAdjustment.newBuilder().setFixedLikelihood(Likelihood.UNLIKELY))
              .build();

      // Construct exclusion rules
      ExclusionRule quasimodoRule =
          ExclusionRule.newBuilder()
              .setDictionary(
                  Dictionary.newBuilder().setWordList(WordList.newBuilder().addWords("Quasimodo")))
              .setMatchingType(MatchingType.MATCHING_TYPE_PARTIAL_MATCH)
              .build();

      ExclusionRule redactedRule =
          ExclusionRule.newBuilder()
              .setRegex(Regex.newBuilder().setPattern("REDACTED"))
              .setMatchingType(MatchingType.MATCHING_TYPE_PARTIAL_MATCH)
              .build();

      // Construct a ruleset that applies the rules to the PERSON_NAME infotype.
      InspectionRuleSet ruleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME"))
              .addRules(InspectionRule.newBuilder().setHotwordRule(patientRule))
              .addRules(InspectionRule.newBuilder().setHotwordRule(doctorRule))
              .addRules(InspectionRule.newBuilder().setExclusionRule(quasimodoRule))
              .addRules(InspectionRule.newBuilder().setExclusionRule(redactedRule))
              .build();

      // Construct the configuration for the Inspect request, including the ruleset.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addInfoTypes(InfoType.newBuilder().setName("PERSON_NAME"))
              .setIncludeQuote(true)
              .addRuleSet(ruleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp_inspect_string_multiple_rules-csharp" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringMultipleRules.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectStringMultipleRules.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_string_multiple_rules" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp_inspect_string_multiple_rules" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringMultipleRules.cs" data-region-tag="dlp_inspect_string_multiple_rules" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectStringMultipleRules.cs/HEAD/dlp_inspect_string_multiple_rules" translate="no"><code dir="ltr" translate="no">
using System;
using System.Text.RegularExpressions;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using static Google.Cloud.Dlp.V2.CustomInfoType.Types;

public class InspectStringMultipleRules
{
    public static InspectContentResponse Inspect(string projectId, string textToInspect)
    {
        var dlp = DlpServiceClient.Create();

        var byteContentItem = new ByteContentItem
        {
            Type = ByteContentItem.Types.BytesType.TextUtf8,
            Data = Google.Protobuf.ByteString.CopyFromUtf8(textToInspect)
        };

        var contentItem = new ContentItem
        {
            ByteItem = byteContentItem
        };

        var patientRule = new DetectionRule.Types.HotwordRule
        {
            HotwordRegex = new CustomInfoType.Types.Regex { Pattern = "patient" },
            Proximity = new DetectionRule.Types.Proximity { WindowBefore = 10 },
            LikelihoodAdjustment = new DetectionRule.Types.LikelihoodAdjustment { FixedLikelihood = Likelihood.VeryLikely }
        };

        var doctorRule = new DetectionRule.Types.HotwordRule
        {
            HotwordRegex = new CustomInfoType.Types.Regex { Pattern = "doctor" },
            Proximity = new DetectionRule.Types.Proximity { WindowBefore = 10 },
            LikelihoodAdjustment = new DetectionRule.Types.LikelihoodAdjustment { FixedLikelihood = Likelihood.Unlikely }
        };

        // Construct exclusion rules
        var quasimodoRule = new ExclusionRule
        {
            Dictionary = new Dictionary { WordList = new Dictionary.Types.WordList { Words = { "Quasimodo" } } },
            MatchingType = MatchingType.PartialMatch
        };

        var redactedRule = new ExclusionRule
        {
            Regex = new CustomInfoType.Types.Regex { Pattern = "REDACTED" },
            MatchingType = MatchingType.PartialMatch
        };

        var infoType = new InfoType { Name = "PERSON_NAME" };

        var inspectionRuleSet = new InspectionRuleSet
        {
            InfoTypes = { infoType },
            Rules =
            {
                new InspectionRule { HotwordRule = patientRule },
                new InspectionRule { HotwordRule = doctorRule},
                new InspectionRule { ExclusionRule = quasimodoRule },
                new InspectionRule { ExclusionRule = redactedRule }
            }
        };

        var inspectConfig = new InspectConfig
        {
            InfoTypes = { infoType },
            IncludeQuote = true,
            RuleSet = { inspectionRuleSet }
        };

        var request = new InspectContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Item = contentItem,
            InspectConfig = inspectConfig
        };

        var response = dlp.InspectContent(request);

        Console.WriteLine($"Findings: {response.Result.Findings.Count}");
        foreach (var f in response.Result.Findings)
        {
            Console.WriteLine("\tQuote: " + f.Quote);
            Console.WriteLine("\tInfo type: " + f.InfoType.Name);
            Console.WriteLine("\tLikelihood: " + f.Likelihood);
        }

        return response;
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Overlapping infoType detectors" id="overlapping_infotype_detectors">Overlapping infoType detectors</h2>
<p>It is possible to define a custom infoType detector that has the same name as a
built-in infoType detector. As shown in the example in the "<a href="#hotword-examples">Hotword rule
example scenarios</a>" section, when you create a custom
infoType detector with the same name as a built-in infoType, any findings
detected by the new infoType detector are added to those detected by the
built-in detector. This is only true as long as the built-in infoType is
specified in the list of infoTypes in the
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
object.</p>
<p>When creating new custom infoType detectors, test them thoroughly on example
content to ensure they work as you intend.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-custom-infotypes-likelihood]</H1></p><div class="devsite-article-body clearfix">
<p>Using hotword rules, you can further extend <a href="/dlp/docs/infotypes-reference">built-in</a>
and <a href="/dlp/docs/creating-custom-infotypes">custom</a> infoType
detectors with powerful context rules. A hotword rule instructs Cloud DLP
to adjust the likelihood of a finding, depending on whether a hotword occurs near that
finding. A hotword rule is a kind of <a href="/dlp/docs/creating-custom-infotypes-rules">inspection rule</a>, which is specified in rule sets. Each rule is applied
to a set of built-in or custom infoTypes.</p>
<h2 data-text="Anatomy of a hotword rule" id="anatomy_of_a_hotword_rule">Anatomy of a hotword rule</h2>
<p>An infoType detector can have zero or more hotword rules. In your
<a href="/dlp/docs/reference/rest/v2/InspectConfig">inspection configuration</a>, you
define each <a href="/dlp/docs/reference/rest/v2/InspectConfig#hotwordrule"><code dir="ltr" translate="no">HotwordRule</code></a>
object inside the <code dir="ltr" translate="no">rules</code> array, as follows:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no"><code dir="ltr" translate="no">"rules":[
  {
    "hotwordRule":{
      "hotwordRegex":{
        "pattern":"<var translate="no">REGEX_PATTERN</var>"
      },
      "proximity":{
        "windowAfter":"<var translate="no">NUM_CHARS_TO_CONSIDER_AFTER_FINDING</var>",
        "windowBefore":"<var translate="no">NUM_CHARS_TO_CONSIDER_BEFORE_FINDING</var>"
      }
      "likelihoodAdjustment":{
        "fixedLikelihood":"<var translate="no">LIKELIHOOD_VALUE</var>"
             -- OR --
        "relativeLikelihood":"<var translate="no">LIKELIHOOD_ADJUSTMENT</var>"
      },
    }
  },
  ...
]
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">REGEX_PATTERN</var>: a regular expression
(<a href="/dlp/docs/reference/rest/v2/Regex"><code dir="ltr" translate="no">Regex</code></a>
object) that defines what qualifies as a hotword.</li>
<li><var translate="no">NUM_CHARS_TO_CONSIDER_AFTER_FINDING</var>: a range of characters after
the finding. Cloud DLP analyzes this range to
determine whether a hotword occurs near the finding.</li>
<li><p><var translate="no">NUM_CHARS_TO_CONSIDER_BEFORE_FINDING</var>: a range of characters before
the finding. Cloud DLP analyzes this range to
determine whether a hotword occurs near the finding.</p></li>
<li><p><var translate="no">LIKELIHOOD_VALUE</var>: a fixed <a href="/dlp/docs/reference/rest/v2/InspectConfig#Likelihood"><code dir="ltr" translate="no">Likelihood</code></a>
level to set the finding to.</p></li>
<li><p><var translate="no">LIKELIHOOD_ADJUSTMENT</var>: a number that indicates how much Cloud DLP must
    increase or decrease the likelihood of the finding. A positive
    integer increases the likelihood level, and a negative integer decreases
    it. For example, if a finding would be <code dir="ltr" translate="no">POSSIBLE</code> without the detection rule
    and <code dir="ltr" translate="no">relativeLikelihood</code> is 1, then the finding is upgraded to <code dir="ltr" translate="no">LIKELY</code>.
    If <code dir="ltr" translate="no">relativeLikelihood</code> is -1, then the finding is downgraded to <code dir="ltr" translate="no">UNLIKELY</code>.
    Likelihood can never drop lower than
    <code dir="ltr" translate="no">VERY_UNLIKELY</code> or exceed <code dir="ltr" translate="no">VERY_LIKELY</code>. In these cases, the likelihood
    level remains the same. For example, if the base likelihood is
    <code dir="ltr" translate="no">VERY_LIKELY</code> and the <code dir="ltr" translate="no">relativeLikelihood</code> is 1, the final likelihood
    remains to be <code dir="ltr" translate="no">VERY_LIKELY</code>.</p></li>
</ul>
<h2 data-text="Hotword example: Match medical record numbers" id="match-mrn">Hotword example: Match medical record numbers</h2>
<p>Suppose you want to detect a custom infoType such as a medical record number (MRN)
in the form "###-#-#####". Also, you want Cloud DLP to increase the
match likelihood of each finding that follows the hotword "MRN".</p>
<p><strong>Example values:</strong></p>
<ul>
<li>123-4-56789 would match as <code dir="ltr" translate="no">POSSIBLE</code>.</li>
<li>MRN 123-4-56789 would match as <code dir="ltr" translate="no">VERY_LIKELY</code>.</li>
</ul>
<p>The following JSON example and code snippets show you how to configure the
hotword rule. This example uses a <a href="/dlp/docs/creating-custom-infotypes-regex">custom regular expression detector</a>.</p>
<p>In this example, note the following:</p>
<ul>
<li>The request defines the <code dir="ltr" translate="no">C_MRN</code> custom infoType, which is a detector for
any string that matches the regular expression <code dir="ltr" translate="no">[0-9]{3}-[0-9]{1}-[0-9]{5}</code>.</li>
<li>The regular expression <code dir="ltr" translate="no">(?i)(mrn|medical)(?-i)</code> defines the hotword.
Cloud DLP searches for this hotword within the range of characters
defined in the <code dir="ltr" translate="no">proximity</code> field.</li>
<li>For each <code dir="ltr" translate="no">C_MRN</code> finding that has a hotword within the set <code dir="ltr" translate="no">proximity</code>,
Cloud DLP sets the likelihood level to <code dir="ltr" translate="no">VERY_LIKELY</code>.</li>
</ul>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_inspect_hotword_rule-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_inspect_hotword_rule-protocol" track-metadata-position="dlp_inspect_hotword_rule" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/quickstart-json">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<aside class="note"><strong>Note:</strong><span> The following example requires an
<a href="/dlp/docs/auth#using_a_service_account">OAuth 2.0 access token</a>.</span></aside>
<p><strong>HTTP method and URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/content:inspect
</code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the <a href="/resource-manager/docs/creating-managing-projects#before_you_begin">project ID</a>.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint lang-json" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"Patient's MRN 444-5-22222 and just a number 333-2-33333"
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"C_MRN"
        },
        "regex":{
          "pattern":"[0-9]{3}-[0-9]{1}-[0-9]{5}"
        },
        "likelihood":"POSSIBLE",
      }
    ],
    "ruleSet":[
        {
        "infoTypes": [{"name" : "C_MRN"}],
        "rules":[
          {
            "hotwordRule":{
              "hotwordRegex":{
                "pattern":"(?i)(mrn|medical)(?-i)"
              },
              "likelihoodAdjustment":{
                "fixedLikelihood":"VERY_LIKELY"
              },
              "proximity":{
                "windowBefore":10
              }
            }
          }
        ]
      }
    ]
  }
}
</code></pre>
<p><strong>JSON output (abbreviated):</strong></p>
<pre class="lang-json" dir="ltr" translate="no">
{
  "result": {
    "findings": [
      {
        "infoType": {
          "name": "C_MRN"
        },
        "likelihood": "VERY_LIKELY",
        "location": {
          "byteRange": {
            "start": "14",
            "end": "25"
          },
          "codepointRange": { ... }
        }
      },
      {
        "infoType": {
          "name": "C_MRN"
        },
        "likelihood": "POSSIBLE",
          "byteRange": {
            "start": "44",
            "end": "55"
          },
          "codepointRange": { ... }
        }
      }
    ]
  }
}
</pre>
<p>The output shows that Cloud DLP correctly
identified the medical record number using the <code dir="ltr" translate="no">C_MRN</code> custom infoType detector.
Further, because of the context matching
in the hotword rule, Cloud DLP assigned the first resultâwhich
had an MRN within the set <code dir="ltr" translate="no">proximity</code>âa likelihood of <code dir="ltr" translate="no">VERY_LIKELY</code>, as configured. The second
finding lacked the context, so the <code dir="ltr" translate="no">likelihood</code> stayed at <code dir="ltr" translate="no">POSSIBLE</code>.</p>
</section>
<section>
<h3 data-text="Java" id="dlp_inspect_hotword_rule-java" track-metadata-position="dlp_inspect_hotword_rule" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_hotword_rule" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectWithHotwordRules.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectWithHotwordRules.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_hotword_rule" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_inspect_hotword_rule" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectWithHotwordRules.java" data-region-tag="dlp_inspect_hotword_rule" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectWithHotwordRules.java/HEAD/dlp_inspect_hotword_rule" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.HotwordRule;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.LikelihoodAdjustment;
import com.google.privacy.dlp.v2.CustomInfoType.DetectionRule.Proximity;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.InspectionRule;
import com.google.privacy.dlp.v2.InspectionRuleSet;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.IOException;

public class InspectWithHotwordRules {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Patient's MRN 444-5-22222 and just a number 333-2-33333";
    String customRegexPattern = "[1-9]{3}-[1-9]{1}-[1-9]{5}";
    String hotwordRegexPattern = "(?i)(mrn|medical)(?-i)";
    inspectWithHotwordRules(projectId, textToInspect, customRegexPattern, hotwordRegexPattern);
  }

  // Inspects a BigQuery Table
  public static void inspectWithHotwordRules(
      String projectId, String textToInspect, String customRegexPattern, String hotwordRegexPattern)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the regex pattern the inspection will look for.
      Regex regex = Regex.newBuilder().setPattern(customRegexPattern).build();

      // Construct the custom regex detector.
      InfoType infoType = InfoType.newBuilder().setName("C_MRN").build();
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder().setInfoType(infoType).setRegex(regex).build();

      // Specify hotword likelihood adjustment.
      LikelihoodAdjustment likelihoodAdjustment =
          LikelihoodAdjustment.newBuilder().setFixedLikelihood(Likelihood.VERY_LIKELY).build();

      // Specify a window around a finding to apply a detection rule.
      Proximity proximity = Proximity.newBuilder().setWindowBefore(10).build();

      // Construct hotword rule.
      HotwordRule hotwordRule =
          HotwordRule.newBuilder()
              .setHotwordRegex(Regex.newBuilder().setPattern(hotwordRegexPattern).build())
              .setLikelihoodAdjustment(likelihoodAdjustment)
              .setProximity(proximity)
              .build();

      // Construct rule set for the inspect config.
      InspectionRuleSet inspectionRuleSet =
          InspectionRuleSet.newBuilder()
              .addInfoTypes(infoType)
              .addRules(InspectionRule.newBuilder().setHotwordRule(hotwordRule))
              .build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addCustomInfoTypes(customInfoType)
              .setIncludeQuote(true)
              .setMinLikelihood(Likelihood.POSSIBLE)
              .addRuleSet(inspectionRuleSet)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp_inspect_hotword_rule-python" track-metadata-position="dlp_inspect_hotword_rule" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_inspect_hotword_rule" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/custom_infotype.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_inspect_hotword_rule" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_inspect_hotword_rule" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/custom_infotype.py" data-region-tag="dlp_inspect_with_medical_record_number_w_custom_hotwords" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/custom_infotype.py/HEAD/dlp_inspect_with_medical_record_number_w_custom_hotwords" translate="no"><code dir="ltr" translate="no">def inspect_with_medical_record_number_w_custom_hotwords(
    project,
    content_string,
):
    """Uses the Data Loss Prevention API to analyze string with medical record
       number custom regex detector, with custom hotwords rules to boost finding
       certainty under some circumstances.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct a custom regex detector info type called "C_MRN",
    # with ###-#-##### pattern, where each # represents a digit from 1 to 9.
    # The detector has a detection likelihood of POSSIBLE.
    custom_info_types = [
        {
            "info_type": {"name": "C_MRN"},
            "regex": {"pattern": "[1-9]{3}-[1-9]{1}-[1-9]{5}"},
            "likelihood": google.cloud.dlp_v2.Likelihood.POSSIBLE,
        }
    ]

    # Construct a rule set with hotwords "mrn" and "medical", with a likelohood
    # boost to VERY_LIKELY when hotwords are present within the 10 character-
    # window preceding the PII finding.
    hotword_rule = {
        "hotword_regex": {"pattern": "(?i)(mrn|medical)(?-i)"},
        "likelihood_adjustment": {
            "fixed_likelihood": google.cloud.dlp_v2.Likelihood.VERY_LIKELY
        },
        "proximity": {"window_before": 10},
    }

    rule_set = [
        {"info_types": [{"name": "C_MRN"}], "rules": [{"hotword_rule": hotword_rule}]}
    ]

    # Construct the configuration dictionary with the custom regex info type.
    inspect_config = {
        "custom_info_types": custom_info_types,
        "rule_set": rule_set,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print(f"Quote: {finding.quote}")
            print(f"Info type: {finding.info_type.name}")
            print(f"Likelihood: {finding.likelihood}")
    else:
        print("No findings.")

</code></pre>
</div>
</section>
</div>
<h2 data-text="Hotword example: Set the match likelihood of a table column" id="match-column-values">Hotword example: Set the match likelihood of a table column</h2>
<p>This example demonstrates how you can set the match likelihood of an entire
column of data. This approach is helpful, for example, if you want to exclude a
column of data from inspection results.</p>
<p>Consider the following table. One column contains placeholder Social Security
numbers (SSNs), and another contains real SSNs.</p>
<table>
<thead>
<tr>
<th>Fake Social Security Number</th>
<th>Real Social Security Number</th>
</tr>
</thead>
<tbody>
<tr>
<td>111-11-1111</td>
<td>222-22-2222</td>
</tr>
</tbody>
</table>
<p>To minimize noise in inspection results, you can exclude any findings in the
<code dir="ltr" translate="no">Fake Social Security Number</code> column. Assign a low likelihood level to this
column. Then, configure the request such that matches with that likelihood level
are excluded from the results.</p>
<p>In this example, note the following:</p>
<ul>
<li>The hotword rule is applied to the <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> infoType.</li>
<li>The hotword regular expression <code dir="ltr" translate="no">(Fake Social Security Number)</code>
contains the name of the column that has the placeholder values.</li>
<li>For each <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> finding in this column,
Cloud DLP sets the likelihood level to <code dir="ltr" translate="no">VERY_UNLIKELY</code>.</li>
<li>The <code dir="ltr" translate="no">minLikelihood</code> property is set to <code dir="ltr" translate="no">POSSIBLE</code>, which means that any finding
that has a <a href="/dlp/docs/likelihood">likelihood level</a> lower than <code dir="ltr" translate="no">POSSIBLE</code>
is excluded from the inspection results.</li>
</ul>
<p>See the <a href="/dlp/docs/quickstart-json">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<aside class="note"><strong>Note:</strong><span> The following example requires an
<a href="/dlp/docs/auth#using_a_service_account">OAuth 2.0 access token</a>.</span></aside>
<p><strong>HTTP method and URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/content:inspect
</code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the <a href="/resource-manager/docs/creating-managing-projects#before_you_begin">project ID</a>.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint lang-json" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item": {
    "table": {
      "headers": [
        {
          "name": "Fake Social Security Number"
        },
        {
          "name": "Real Social Security Number"
        }
      ],
      "rows": [
        {
          "values": [
            {
              "stringValue": "111-11-1111"
            },
            {
              "stringValue": "222-22-2222"
            }
          ]
        }
      ]
    }
  },
  "inspectConfig": {
    "infoTypes": [
      {
        "name": "US_SOCIAL_SECURITY_NUMBER"
      }
    ],
    "includeQuote": true,
    "ruleSet": [
      {
        "infoTypes": [
          {
            "name": "US_SOCIAL_SECURITY_NUMBER"
          }
        ],
        "rules": [
          {
            "hotwordRule": {
              "hotwordRegex": {
                "pattern": "(Fake Social Security Number)"
              },
              "likelihoodAdjustment": {
                "fixedLikelihood": "VERY_UNLIKELY"
              },
              "proximity": {
                "windowBefore": 1
              }
            }
          }
        ]
      }
    ],
    "minLikelihood": "POSSIBLE"
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<pre class="lang-json" dir="ltr" translate="no">
{
  "result": {
    "findings": [
      {
        "quote": "222-22-2222",
        "infoType": {
          "name": "US_SOCIAL_SECURITY_NUMBER"
        },
        "likelihood": "VERY_LIKELY",
        "location": {
          "byteRange": {
            "end": "11"
          },
          "codepointRange": {
            "end": "11"
          },
          "contentLocations": [
            {
              "recordLocation": {
                "fieldId": {
                  "name": "Real Social Security Number"
                },
                "tableLocation": {}
              }
            }
          ]
        },
        "createTime": "<var translate="no">TIMESTAMP</var>",
        "findingId": "<var translate="no">TIMESTAMP</var>"
      }
    ]
  }
}
</pre>
<p>The value 111-11-1111, which is in the <code dir="ltr" translate="no">Fake Social Security Number</code>
column, matched the hotword rule, so Cloud DLP assigned to it the
<code dir="ltr" translate="no">VERY_UNLIKELY</code> likelihood level . This level is lower than the minimum
likelihood set in the inspection configuration (<code dir="ltr" translate="no">POSSIBLE</code>), so this finding
is excluded from the inspection result.</p>
<p>You can experiment with this example by removing the rule set. Notice that
Cloud DLP includes 111-11-1111 in the results.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/deidentify-sensitive-data]</H1></p><div class="devsite-article-body clearfix">
<div class="video-wrapper">
<iframe allowfullscreen="" class="devsite-embedded-youtube-video" data-autohide="1" data-showinfo="0" data-video-id="JLDpbXbT6wo" frameborder="0">
</iframe>
</div>
<p>Cloud Data Loss Prevention can de-identify sensitive data in text content, including
text stored in container structures such as tables. De-identification is the
process of removing identifying information from data. The API detects
sensitive data such as personally identifiable information (PII), and then
uses a de-identification transformation to mask, delete, or otherwise obscure
the data. For example, de-identification techniques can include any of the
following:</p>
<ul>
<li>Masking sensitive data by partially or fully replacing characters with a
symbol, such as an asterisk (*) or hash (#).</li>
<li>Replacing each instance of sensitive data with a token, or surrogate,
string.</li>
<li>Encrypting and replacing sensitive data using a randomly generated or
pre-determined key.</li>
</ul>
<p>When you de-identify data using the
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a>
or
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptodeterministicconfig"><code dir="ltr" translate="no">CryptoDeterministicConfig</code></a>
infoType transformations, you can re-identify that data, as long as you have the
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>
used to originally de-identify the data.</p>
<p>You can feed information to the API using JSON over HTTPS, as well as the CLI
and several programming languages using the <a href="/dlp/docs/reference/libraries" title="Cloud DLP Client Libraries">DLP client
libraries</a>.
To set up the CLI, refer to the
<a href="/dlp/docs/quickstart" title="Quickstarts">quickstart</a>.
For more information about submitting information in JSON format, see the <a href="/dlp/docs/quickstart-json" title="Quickstart: Using a JSON Request">JSON
quickstart</a>.</p>
<h2 data-text="API overview" id="api_overview">API overview</h2>
<p>To de-identify sensitive data, use Cloud DLP's
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content.deidentify</code></a>
method.</p>
<p>There are three parts to a de-identification API call:</p>
<ul>
<li><em>The data to inspect:</em> A string or table structure
(<a href="/dlp/docs/reference/rest/v2/ContentItem"><code dir="ltr" translate="no">ContentItem</code></a>
object) for the API to inspect.</li>
<li><em>What to inspect for:</em> Detection configuration information
(<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>)
such as what types of data (or <a href="/dlp/docs/concepts-infotypes"><em>infoTypes</em></a>)
to look for, whether to filter findings that are above a certain likelihood
threshold, whether to return no more than a certain number of results, and
so on. Not specifying at least one infoType in an <code dir="ltr" translate="no">InspectConfig</code> argument
is equivalent to specifying all built-in infoTypes. Doing so is not
recommended, as it can cause decreased performance and increased cost.</li>
<li><em>What to do with the inspection findings:</em> Configuration information
(<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>)
that defines how you want the sensitive data de-identified. This argument
is covered in more detail in the following section.</li>
</ul>
<p>The API returns the same items you gave it, in the same format, but any text
identified as containing sensitive information according to your criteria
has been de-identified.</p>
<h2 data-text="Specifying detection criteria" id="specifying_detection_criteria">Specifying detection criteria</h2>
<p>Information type (or "infoType") detectors are the mechanisms that
Cloud DLP uses to find sensitive data.</p>
<p>Cloud DLP includes several kinds of infoType detectors, all
of which are summarized here:</p>
<ul>
<li><a href="/dlp/docs/concepts-de-identification#built-in"><em>Built-in infoType detectors</em></a> are built into
Cloud DLP. They include detectors for country- or
region-specific sensitive data types as well as globally applicable data
types.</li>
<li><a href="/dlp/docs/concepts-de-identification#custom"><em>Custom infoType detectors</em></a> are detectors that you create
yourself. There are three kinds of custom infoType detectors:
<ul>
<li><em>Regular custom dictionary detectors</em> are simple word lists that
Cloud DLP matches on. Use regular custom dictionary
detectors when you have a list of up to several tens of thousands of
words or phrases. Regular custom dictionary detectors are preferred if
you don't anticipate your word list changing significantly.</li>
<li><em>Stored custom dictionary detectors</em> are generated by
Cloud DLP using large lists of words or phrases stored
in either Cloud Storage or BigQuery. Use stored custom dictionary
detectors when you have a large list of words or phrasesâup to tens
of millions.</li>
<li><em>Regular expressions (regex) detectors</em> enable
Cloud DLP to detect matches based on a regular expression
pattern.</li>
</ul></li>
</ul>
<p>In addition, Cloud DLP includes the concept of
<a href="/dlp/docs/concepts-de-identification#inspection-rules"><em>inspection rules</em></a>, which enable you to fine-tune scan
results using the following:</p>
<ul>
<li><em>Exclusion rules</em> enable you to decrease the number of findings returned
by adding rules to a built-in or custom infoType detector.</li>
<li><em>Hotword rules</em> enable you to increase the quantity or change the
<a href="/dlp/docs/likelihood">likelihood value</a> of findings returned by adding
rules to a built-in or custom infoType detector.</li>
</ul>
<h2 data-text="De-identification transformations" id="de-identification_transformations">De-identification transformations</h2>
<p>You must specify one or more transformations when you set the de-identification
configuration
(<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>).
There are two categories of transformations:</p>
<ul>
<li><a href="/dlp/docs/deidentify-sensitive-data#infotype_transformations"><code dir="ltr" translate="no">InfoTypeTransformations</code></a>:
Transformations that are only applied to values within submitted text that
are identified as a specific infoType.</li>
<li><a href="/dlp/docs/deidentify-sensitive-data#record_transformations"><code dir="ltr" translate="no">RecordTransformations</code></a>:
Transformations that are only applied to values within submitted tabular
text data that are identified as a specific infoType, or on an entire column
of tabular data.</li>
</ul>
<h3 data-text="InfoType transformations" id="infotype_transformations">InfoType transformations</h3>
<p>You can specify one or more infoType transformations per request. Within each
<code dir="ltr" translate="no">InfoTypeTransformation</code> object, you specify both of the following:</p>
<ul>
<li>One or more <a href="/dlp/docs/infotypes-reference">infoTypes</a> to which a
transformation should be applied (the <code dir="ltr" translate="no">infoTypes[]</code> array object).</li>
<li>A primitive transformation (the
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#primitivetransformation"><code dir="ltr" translate="no">PrimitiveTransformation</code></a>
object).</li>
</ul>
<p>Note that specifying an infoType is optional, but not specifying at least one
infoType in an
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
argument causes the transformation to apply to all built-in infoTypes that
don't have a transformation provided. Doing so is not recommended, as it can
cause decreased performance and increased cost.</p>
<h4 data-text="Primitive transformations" id="primitive_transformations">Primitive transformations</h4>
<p>You must specify at least one primitive transformation to apply to input,
regardless of whether you're applying it only to certain infoTypes or to the
entire text string. You have several transformation options, which are
summarized in the following table. Click the object name for more information.</p>
<p><a href="/dlp/docs/transformations-reference">The full list of possible transformations</a>.</p>
<h5 data-text="replaceConfig" id="replaceconfig">replaceConfig</h5>
<p>Setting <code dir="ltr" translate="no">replaceConfig</code> to a <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#replacevalueconfig"><code dir="ltr" translate="no">ReplaceValueConfig</code></a>
object replaces matched input values with a value you specify.</p>
<p>For example, suppose youâve set <code dir="ltr" translate="no">replaceConfig</code> to "<code dir="ltr" translate="no">[email-address]</code>"
for all <code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoTypes, and the following string is sent to
Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string will be the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is [email-address].</pre>
<p>The following JSON example and code in several languages shows how to form the
API request and what the DLP API returns:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_deidentify_replace-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_deidentify_replace-protocol" track-metadata-position="dlp_deidentify_replace" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation":{
            "replaceConfig":{
              "newValue":{
                "stringValue":"[email-address]"
              }
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is [email-address]."
  },
  "overview":{
    "transformedBytes":"22",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "replaceConfig":{
            "newValue":{
              "stringValue":"[email-address]"
            }
          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"22"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp_deidentify_replace-python" track-metadata-position="dlp_deidentify_replace" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_replace" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_replace" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_deidentify_replace" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_replace" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_replace" translate="no"><code dir="ltr" translate="no">def deidentify_with_replace(
    project,
    input_str,
    info_types,
    replacement_str="REPLACEMENT_STR",
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by replacing matched input values with a value you specify.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        info_types: A list of strings representing info types to look for.
        replacement_str: The string to replace all values that match given
            info types.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {
                    "primitive_transformation": {
                        "replace_config": {
                            "new_value": {"string_value": replacement_str}
                        }
                    }
                }
            ]
        }
    }

    # Construct item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp_deidentify_replace-java" track-metadata-position="dlp_deidentify_replace" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_replace" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_replace" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_deidentify_replace" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java" data-region-tag="dlp_deidentify_replace" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java/HEAD/dlp_deidentify_replace" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceValueConfig;
import com.google.privacy.dlp.v2.Value;

public class DeIdentifyWithReplacement {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect =
        "My name is Alicia Abernathy, and my email address is aabernathy@example.com.";
    deIdentifyWithReplacement(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void deIdentifyWithReplacement(String projectId, String textToRedact) {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToRedact).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("EMAIL_ADDRESS").build();
      InspectConfig inspectConfig = InspectConfig.newBuilder().addInfoTypes(infoType).build();
      // Specify replacement string to be used for the finding.
      ReplaceValueConfig replaceValueConfig =
          ReplaceValueConfig.newBuilder()
              .setNewValue(Value.newBuilder().setStringValue("[email-address]").build())
              .build();
      // Define type of deidentification as replacement.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder().setReplaceConfig(replaceValueConfig).build();
      // Associate deidentification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      // Construct the configuration for the Redact request and list all desired transformations.
      DeidentifyConfig redactConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Construct the Redact request to be sent by the client.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(redactConfig)
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Parse the response and process results
      System.out.println("Text after redaction: " + response.getItem().getValue());
    } catch (Exception e) {
      System.out.println("Error during inspectString: \n" + e.toString());
    }
  }
}</code></pre>
</div>
</section>
</div>
<h5 data-text="redactConfig" id="redactconfig">redactConfig</h5>
<p>Specifying
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#redactconfig"><code dir="ltr" translate="no">redactConfig</code></a>
redacts a given value by removing it completely. The <code dir="ltr" translate="no">redactConfig</code> message
has no arguments; specifying it enables its transformation.</p>
<p>For example, suppose youâve specified <code dir="ltr" translate="no">redactConfig</code> for all <code dir="ltr" translate="no">EMAIL_ADDRESS</code>
infoTypes, and the following string is sent to Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string will be the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is .</pre>
<p>The following examples show how to form the API request and what the
DLP API returns:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_deidentify_redact-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_deidentify_redact-protocol" track-metadata-position="dlp_deidentify_redact" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation":{
            "redactConfig":{

            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is ."
  },
  "overview":{
    "transformedBytes":"22",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "redactConfig":{

          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"22"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp_deidentify_redact-java" track-metadata-position="dlp_deidentify_redact" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_redact" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_redact" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_deidentify_redact" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java" data-region-tag="dlp_deidentify_redact" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java/HEAD/dlp_deidentify_redact" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RedactConfig;

public class DeIdentifyWithRedaction {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect =
        "My name is Alicia Abernathy, and my email address is aabernathy@example.com.";
    deIdentifyWithRedaction(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void deIdentifyWithRedaction(String projectId, String textToRedact) {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToRedact).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("EMAIL_ADDRESS").build();
      InspectConfig inspectConfig = InspectConfig.newBuilder().addInfoTypes(infoType).build();
      // Define type of deidentification.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setRedactConfig(RedactConfig.getDefaultInstance())
              .build();
      // Associate deidentification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      // Construct the configuration for the Redact request and list all desired transformations.
      DeidentifyConfig redactConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Construct the Redact request to be sent by the client.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(redactConfig)
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Parse the response and process results
      System.out.println("Text after redaction: " + response.getItem().getValue());
    } catch (Exception e) {
      System.out.println("Error during inspectString: \n" + e.toString());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp_deidentify_redact-python" track-metadata-position="dlp_deidentify_redact" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_redact" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_redact" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_deidentify_redact" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_redact" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_redact" translate="no"><code dir="ltr" translate="no">def deidentify_with_redact(
    project,
    input_str,
    info_types,
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by redacting matched input values.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        info_types: A list of strings representing info types to look for.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [{"primitive_transformation": {"redact_config": {}}}]
        }
    }

    # Construct item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
</div>
<h5 data-text="characterMaskConfig" id="charactermaskconfig">characterMaskConfig</h5>
<p>Setting <code dir="ltr" translate="no">characterMaskConfig</code> to a <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#charactermaskconfig"><code dir="ltr" translate="no">CharacterMaskConfig</code></a>
object partially masks a string by replacing a given number of characters
with a fixed character. Masking can start from the beginning or end of the
string. This transformation also works with number types such as long
integers.</p>
<p>The <code dir="ltr" translate="no">CharacterMaskConfig</code> object has several of its own arguments:</p>
<ul>
<li><code dir="ltr" translate="no">maskingCharacter</code>: The character to use to mask each character of a
sensitive value. For example, you could specify an asterisk (*) or hash
(#) to mask a series of numbers such as those in a credit card number.</li>
<li><code dir="ltr" translate="no">numberToMask</code>: The number of characters to mask. If you donât set this
value, all matching characters will be masked.</li>
<li><code dir="ltr" translate="no">reverseOrder</code>: Whether to mask characters in reverse order. Setting
<code dir="ltr" translate="no">reverseOrder</code> to true causes characters in matched values to be masked
from the end toward the beginning of the value. Setting it to false causes
masking to begin at the start of the value.</li>
<li><code dir="ltr" translate="no">charactersToIgnore[]</code>: One or more characters to skip when masking
values. For example, specify a hyphen here to leave the hyphens in place
when masking a telephone number. You can also specify a group of common
characters (<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.CharsToIgnore"><code dir="ltr" translate="no">CharsToIgnore</code></a>)
to ignore when masking.</li>
</ul>
<p>For example, suppose you've set <code dir="ltr" translate="no">characterMaskConfig</code> to mask with '#' for
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> infotypes, except for the '.' and '@' characters. If the
following string is sent to Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string will be the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is ##########@#######.###.</pre>
<p>Following are examples that demonstrate how to use the
DLP API to de-identify sensitive data using masking
techniques.<!-- For
information about the parameters included with the request, see
[Configuring storage inspection](#configuring-storage-inspection),
later in this topic.--></p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-masking-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-deidentify-masking-protocol" track-metadata-position="dlp-deidentify-masking" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The following JSON example shows how to form the API request and what the
DLP API returns:</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation":{
            "characterMaskConfig":{
              "maskingCharacter":"#",
              "reverseOrder":false,
              "charactersToIgnore":[
                {
                  "charactersToSkip":".@"
                }
              ]
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is ##########@#######.###."
  },
  "overview":{
    "transformedBytes":"22",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "characterMaskConfig":{
            "maskingCharacter":"#",
            "charactersToIgnore":[
              {
                "charactersToSkip":".@"
              }
            ]
          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"22"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-deidentify-masking-java" track-metadata-position="dlp-deidentify-masking" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.CharacterMaskConfig;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import java.io.IOException;
import java.util.Arrays;

public class DeIdentifyWithMasking {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToDeIdentify = "My SSN is 372819127";
    deIdentifyWithMasking(projectId, textToDeIdentify);
  }

  public static void deIdentifyWithMasking(String projectId, String textToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {

      // Specify what content you want the service to DeIdentify
      ContentItem contentItem = ContentItem.newBuilder().setValue(textToDeIdentify).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("US_SOCIAL_SECURITY_NUMBER").build();
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(Arrays.asList(infoType)).build();

      // Specify how the info from the inspection should be masked.
      CharacterMaskConfig characterMaskConfig =
          CharacterMaskConfig.newBuilder()
              .setMaskingCharacter("X") // Character to replace the found info with
              .setNumberToMask(5) // How many characters should be masked
              .build();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(ReplaceWithInfoTypeConfig.getDefaultInstance())
              .build();
      InfoTypeTransformation infoTypeTransformation =
          InfoTypeTransformation.newBuilder()
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      InfoTypeTransformations transformations =
          InfoTypeTransformations.newBuilder().addTransformations(infoTypeTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setInfoTypeTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setInspectConfig(inspectConfig)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results
      System.out.println("Text after masking: " + response.getItem().getValue());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-deidentify-masking-nodejs" track-metadata-position="dlp-deidentify-masking" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithMask.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithMask.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithMask.js" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithMask.js/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project-id';

// The string to deidentify
// const string = 'My SSN is 372819127';

// (Optional) The maximum number of sensitive characters to mask in a match
// If omitted from the request or set to 0, the API will mask any matching characters
// const numberToMask = 5;

// (Optional) The character to mask matching sensitive data with
// const maskingCharacter = 'x';

// Construct deidentification request
const item = {value: string};

async function deidentifyWithMask() {
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      infoTypeTransformations: {
        transformations: [
          {
            primitiveTransformation: {
              characterMaskConfig: {
                maskingCharacter: maskingCharacter,
                numberToMask: numberToMask,
              },
            },
          },
        ],
      },
    },
    item: item,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const deidentifiedItem = response.item;
  console.log(deidentifiedItem.value);
}

deidentifyWithMask();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-masking-python" track-metadata-position="dlp-deidentify-masking" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">def deidentify_with_mask(
    project, input_str, info_types, masking_character=None, number_to_mask=0
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by masking it with a character.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        masking_character: The character to mask matching sensitive data with.
        number_to_mask: The maximum number of sensitive characters to mask in
            a match. If omitted or set to zero, the API will default to no
            maximum.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {
                    "primitive_transformation": {
                        "character_mask_config": {
                            "masking_character": masking_character,
                            "number_to_mask": number_to_mask,
                        }
                    }
                }
            ]
        }
    }

    # Construct item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-deidentify-masking-go" track-metadata-position="dlp-deidentify-masking" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/mask.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/mask.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/mask.go" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/mask.go/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// mask deidentifies the input by masking all provided info types with maskingCharacter
// and prints the result to w.
func mask(w io.Writer, projectID, input string, infoTypeNames []string, maskingCharacter string, numberToMask int32) error {
	// projectID := "my-project-id"
	// input := "My SSN is 111222333"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// maskingCharacter := "+"
	// numberToMask := 6
	// Will print "My SSN is ++++++333"

	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Create a configured request.
	req := &amp;dlppb.DeidentifyContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: infoTypes,
		},
		DeidentifyConfig: &amp;dlppb.DeidentifyConfig{
			Transformation: &amp;dlppb.DeidentifyConfig_InfoTypeTransformations{
				InfoTypeTransformations: &amp;dlppb.InfoTypeTransformations{
					Transformations: []*dlppb.InfoTypeTransformations_InfoTypeTransformation{
						{
							InfoTypes: []*dlppb.InfoType{}, // Match all info types.
							PrimitiveTransformation: &amp;dlppb.PrimitiveTransformation{
								Transformation: &amp;dlppb.PrimitiveTransformation_CharacterMaskConfig{
									CharacterMaskConfig: &amp;dlppb.CharacterMaskConfig{
										MaskingCharacter: maskingCharacter,
										NumberToMask:     numberToMask,
									},
								},
							},
						},
					},
				},
			},
		},
		// The item to analyze.
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: input,
			},
		},
	}
	// Send the request.
	r, err := client.DeidentifyContent(ctx, req)
	if err != nil {
		return fmt.Errorf("DeidentifyContent: %v", err)
	}
	// Print the result.
	fmt.Fprint(w, r.GetItem().GetValue())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-masking-php" track-metadata-position="dlp-deidentify-masking" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_mask.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_mask.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_mask.php" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_mask.php/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\CharacterMaskConfig;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\PrimitiveTransformation;
use Google\Cloud\Dlp\V2\DeidentifyConfig;
use Google\Cloud\Dlp\V2\InfoTypeTransformations\InfoTypeTransformation;
use Google\Cloud\Dlp\V2\InfoTypeTransformations;
use Google\Cloud\Dlp\V2\ContentItem;

/**
 * Deidentify sensitive data in a string by masking it with a character.
 *
 * @param string $callingProjectId The GCP Project ID to run the API call under
 * @param string $string           The string to deidentify
 * @param int    $numberToMask     (Optional) The maximum number of sensitive characters to mask in a match
 * @param string $maskingCharacter (Optional) The character to mask matching sensitive data with (defaults to "x")
 */
function deidentify_mask(
    string $callingProjectId,
    string $string,
    int $numberToMask = 0,
    string $maskingCharacter = 'x'
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // The infoTypes of information to mask
    $ssnInfoType = (new InfoType())
        -&gt;setName('US_SOCIAL_SECURITY_NUMBER');
    $infoTypes = [$ssnInfoType];

    // Create the masking configuration object
    $maskConfig = (new CharacterMaskConfig())
        -&gt;setMaskingCharacter($maskingCharacter)
        -&gt;setNumberToMask($numberToMask);

    // Create the information transform configuration objects
    $primitiveTransformation = (new PrimitiveTransformation())
        -&gt;setCharacterMaskConfig($maskConfig);

    $infoTypeTransformation = (new InfoTypeTransformation())
        -&gt;setPrimitiveTransformation($primitiveTransformation)
        -&gt;setInfoTypes($infoTypes);

    $infoTypeTransformations = (new InfoTypeTransformations())
        -&gt;setTransformations([$infoTypeTransformation]);

    // Create the deidentification configuration object
    $deidentifyConfig = (new DeidentifyConfig())
        -&gt;setInfoTypeTransformations($infoTypeTransformations);

    $item = (new ContentItem())
        -&gt;setValue($string);

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;deidentifyContent([
        'parent' =&gt; $parent,
        'deidentifyConfig' =&gt; $deidentifyConfig,
        'item' =&gt; $item
    ]);

    // Print the results
    $deidentifiedValue = $response-&gt;getItem()-&gt;getValue();
    print($deidentifiedValue);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-masking-csharp" track-metadata-position="dlp-deidentify-masking" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithMasking.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithMasking.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithMasking.cs" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithMasking.cs/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class DeidentifyWithMasking
{
    public static DeidentifyContentResponse Deidentify(string projectId, string text)
    {
        // Instantiate a client.
        var dlp = DlpServiceClient.Create();

        // Construct a request.
        var transformation = new InfoTypeTransformations.Types.InfoTypeTransformation
        {
            PrimitiveTransformation = new PrimitiveTransformation
            {
                CharacterMaskConfig = new CharacterMaskConfig
                {
                    MaskingCharacter = "*",
                    NumberToMask = 5,
                    ReverseOrder = false,
                }
            }
        };
        var request = new DeidentifyContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectConfig = new InspectConfig
            {
                InfoTypes =
                {
                    new InfoType { Name = "US_SOCIAL_SECURITY_NUMBER" }
                }
            },
            DeidentifyConfig = new DeidentifyConfig
            {
                InfoTypeTransformations = new InfoTypeTransformations
                {
                    Transformations = { transformation }
                }
            },
            Item = new ContentItem { Value = text }
        };

        // Call the API.
        var response = dlp.DeidentifyContent(request);

        // Inspect the results.
        Console.WriteLine($"Deidentified content: {response.Item.Value}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h5 data-text="cryptoHashConfig" id="cryptohashconfig">cryptoHashConfig</h5>
<p>Setting <code dir="ltr" translate="no">cryptoHashConfig</code> to a <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptohashconfig"><code dir="ltr" translate="no">CryptoHashConfig</code></a>
object performs <a href="/dlp/docs/pseudonymization">pseudonymization</a> on an input value
by generating a surrogate value using cryptographic hashing.</p>
<p>This method replaces the input value with an encrypted "digest," or hash value.
The digest is computed by taking the SHA-256 hash of the input value.
The cryptographic key used to make the hash is a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>
object, and must be either 32 or 64 bytes in size.</p>
<p>The method outputs a base64-encoded representation of the hashed output.
Currently, only string and integer values can be hashed.</p>
<p>For example, suppose youâve specified <code dir="ltr" translate="no">cryptoHashConfig</code> for all
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoTypes, and the <code dir="ltr" translate="no">CryptoKey</code> object consists of a
randomly-generated key (a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.TransientCryptoKey"><code dir="ltr" translate="no">TransientCryptoKey</code></a>).
Then, the following string is sent to Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The cryptographically generated returned string will look like the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is 41D1567F7F99F1DC2A5FAB886DEE5BEE.</pre>
<p>Of course, the hex string will be cryptographically generated and different
from the one shown here.</p>
<h5 data-text="dateShiftConfig" id="dateshiftconfig">dateShiftConfig</h5>
<p>Setting <code dir="ltr" translate="no">dateShiftConfig</code> to a <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.DateShiftConfig"><code dir="ltr" translate="no">DateShiftConfig</code></a> object performs <a href="/dlp/docs/concepts-date-shifting">date shifting</a> on
a date input value by shifting the dates by a random number of days.</p>
<p>Date shifting techniques randomly shift a set of dates but preserve the
sequence and duration of a period of time. Shifting dates is usually done in
context to an individual or an entity. That is, you want to shift all of the
dates for a specific individual using the same shift differential, but use a
separate shift differential for each other individual.</p>
<p>For more information about date shifting, see the <a href="/dlp/docs/concepts-date-shifting">date
shifting concept topic</a>.</p>
<p>Following is sample code in several languages that demonstrates how to
use the DLP API to de-identify dates using date shifting.
<!-- For information about the parameters included with the request, see
[Configuring storage inspection](#configuring-storage-inspection),
later in this topic.--></p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-date-shift-code-sample">
<section>
<h3 data-text="Java" id="dlp-deidentify-date-shift-java" track-metadata-position="dlp-deidentify-date-shift" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.common.base.Splitter;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DateShiftConfig;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.FieldTransformation;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Value;
import com.google.type.Date;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public class DeIdentifyWithDateShift {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Path inputCsvFile = Paths.get("path/to/your/input/file.csv");
    Path outputCsvFile = Paths.get("path/to/your/output/file.csv");
    deIdentifyWithDateShift(projectId, inputCsvFile, outputCsvFile);
  }

  public static void deIdentifyWithDateShift(
      String projectId, Path inputCsvFile, Path outputCsvFile) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Read the contents of the CSV file into a Table
      List&lt;FieldId&gt; headers;
      List&lt;Table.Row&gt; rows;
      try (BufferedReader input = Files.newBufferedReader(inputCsvFile)) {
        // Parse and convert the first line into header names
        headers =
            Arrays.stream(input.readLine().split(","))
                .map(header -&gt; FieldId.newBuilder().setName(header).build())
                .collect(Collectors.toList());
        // Parse the remainder of the file as Table.Rows
        rows =
            input.lines().map(DeIdentifyWithDateShift::parseLineAsRow).collect(Collectors.toList());
      }
      Table table = Table.newBuilder().addAllHeaders(headers).addAllRows(rows).build();
      ContentItem item = ContentItem.newBuilder().setTable(table).build();

      // Set the maximum days to shift dates backwards (lower bound) or forward (upper bound)
      DateShiftConfig dateShiftConfig =
          DateShiftConfig.newBuilder().setLowerBoundDays(5).setUpperBoundDays(5).build();
      PrimitiveTransformation transformation =
          PrimitiveTransformation.newBuilder().setDateShiftConfig(dateShiftConfig).build();
      // Specify which fields the DateShift should apply too
      List&lt;FieldId&gt; dateFields = Arrays.asList(headers.get(1), headers.get(3));
      FieldTransformation fieldTransformation =
          FieldTransformation.newBuilder()
              .addAllFields(dateFields)
              .setPrimitiveTransformation(transformation)
              .build();
      RecordTransformations recordTransformations =
          RecordTransformations.newBuilder().addFieldTransformations(fieldTransformation).build();
      // Specify the config for the de-identify request
      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(recordTransformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Write the results to the target CSV file
      try (BufferedWriter writer = Files.newBufferedWriter(outputCsvFile)) {
        Table outTable = response.getItem().getTable();
        String headerOut =
            outTable.getHeadersList().stream()
                .map(FieldId::getName)
                .collect(Collectors.joining(","));
        writer.write(headerOut + "\n");

        List&lt;String&gt; rowOutput =
            outTable.getRowsList().stream()
                .map(row -&gt; joinRow(row.getValuesList()))
                .collect(Collectors.toList());
        for (String line : rowOutput) {
          writer.write(line + "\n");
        }
        System.out.println("Content written to file: " + outputCsvFile.toString());
      }
    }
  }

  // Convert the string from the csv file into com.google.type.Date
  public static Date parseAsDate(String s) {
    LocalDate date = LocalDate.parse(s, DateTimeFormatter.ofPattern("MM/dd/yyyy"));
    return Date.newBuilder()
        .setDay(date.getDayOfMonth())
        .setMonth(date.getMonthValue())
        .setYear(date.getYear())
        .build();
  }

  // Each row is in the format: Name,BirthDate,CreditCardNumber,RegisterDate
  public static Table.Row parseLineAsRow(String line) {
    List&lt;String&gt; values = Splitter.on(",").splitToList(line);
    Value name = Value.newBuilder().setStringValue(values.get(0)).build();
    Value birthDate = Value.newBuilder().setDateValue(parseAsDate(values.get(1))).build();
    Value creditCardNumber = Value.newBuilder().setStringValue(values.get(2)).build();
    Value registerDate = Value.newBuilder().setDateValue(parseAsDate(values.get(3))).build();
    return Table.Row.newBuilder()
        .addValues(name)
        .addValues(birthDate)
        .addValues(creditCardNumber)
        .addValues(registerDate)
        .build();
  }

  public static String formatDate(Date d) {
    return String.format("%s/%s/%s", d.getMonth(), d.getDay(), d.getYear());
  }

  public static String joinRow(List&lt;Value&gt; values) {
    String name = values.get(0).getStringValue();
    String birthDate = formatDate(values.get(1).getDateValue());
    String creditCardNumber = values.get(2).getStringValue();
    String registerDate = formatDate(values.get(3).getDateValue());
    return String.join(",", name, birthDate, creditCardNumber, registerDate);
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-deidentify-date-shift-nodejs" track-metadata-position="dlp-deidentify-date-shift" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithDateShift.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithDateShift.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithDateShift.js" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithDateShift.js/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// Import other required libraries
const fs = require('fs');

// The project ID to run the API call under
// const projectId = 'my-project';

// The path to the CSV file to deidentify
// The first row of the file must specify column names, and all other rows
// must contain valid values
// const inputCsvFile = '/path/to/input/file.csv';

// The path to save the date-shifted CSV file to
// const outputCsvFile = '/path/to/output/file.csv';

// The list of (date) fields in the CSV file to date shift
// const dateFields = [{ name: 'birth_date'}, { name: 'register_date' }];

// The maximum number of days to shift a date backward
// const lowerBoundDays = 1;

// The maximum number of days to shift a date forward
// const upperBoundDays = 1;

// (Optional) The column to determine date shift amount based on
// If this is not specified, a random shift amount will be used for every row
// If this is specified, then 'wrappedKey' and 'keyName' must also be set
// const contextFieldId = [{ name: 'user_id' }];

// (Optional) The name of the Cloud KMS key used to encrypt ('wrap') the AES-256 key
// If this is specified, then 'wrappedKey' and 'contextFieldId' must also be set
// const keyName = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME';

// (Optional) The encrypted ('wrapped') AES-256 key to use when shifting dates
// This key should be encrypted using the Cloud KMS key specified above
// If this is specified, then 'keyName' and 'contextFieldId' must also be set
// const wrappedKey = 'YOUR_ENCRYPTED_AES_256_KEY'

// Helper function for converting CSV rows to Protobuf types
const rowToProto = row =&gt; {
  const values = row.split(',');
  const convertedValues = values.map(value =&gt; {
    if (Date.parse(value)) {
      const date = new Date(value);
      return {
        dateValue: {
          year: date.getFullYear(),
          month: date.getMonth() + 1,
          day: date.getDate(),
        },
      };
    } else {
      // Convert all non-date values to strings
      return {stringValue: value.toString()};
    }
  });
  return {values: convertedValues};
};

async function deidentifyWithDateShift() {
  // Read and parse a CSV file
  const csvLines = fs
    .readFileSync(inputCsvFile)
    .toString()
    .split('\n')
    .filter(line =&gt; line.includes(','));
  const csvHeaders = csvLines[0].split(',');
  const csvRows = csvLines.slice(1);

  // Construct the table object
  const tableItem = {
    table: {
      headers: csvHeaders.map(header =&gt; {
        return {name: header};
      }),
      rows: csvRows.map(row =&gt; rowToProto(row)),
    },
  };

  // Construct DateShiftConfig
  const dateShiftConfig = {
    lowerBoundDays: lowerBoundDays,
    upperBoundDays: upperBoundDays,
  };

  if (contextFieldId &amp;&amp; keyName &amp;&amp; wrappedKey) {
    dateShiftConfig.context = {name: contextFieldId};
    dateShiftConfig.cryptoKey = {
      kmsWrapped: {
        wrappedKey: wrappedKey,
        cryptoKeyName: keyName,
      },
    };
  } else if (contextFieldId || keyName || wrappedKey) {
    throw new Error(
      'You must set either ALL or NONE of {contextFieldId, keyName, wrappedKey}!'
    );
  }

  // Construct deidentification request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      recordTransformations: {
        fieldTransformations: [
          {
            fields: dateFields,
            primitiveTransformation: {
              dateShiftConfig: dateShiftConfig,
            },
          },
        ],
      },
    },
    item: tableItem,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const tableRows = response.item.table.rows;

  // Write results to a CSV file
  tableRows.forEach((row, rowIndex) =&gt; {
    const rowValues = row.values.map(
      value =&gt;
        value.stringValue ||
        `${value.dateValue.month}/${value.dateValue.day}/${value.dateValue.year}`
    );
    csvLines[rowIndex + 1] = rowValues.join(',');
  });
  csvLines.push('');
  fs.writeFileSync(outputCsvFile, csvLines.join('\n'));

  // Print status
  console.log(`Successfully saved date-shift output to ${outputCsvFile}`);
}

deidentifyWithDateShift();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-date-shift-python" track-metadata-position="dlp-deidentify-date-shift" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">def deidentify_with_date_shift(
    project,
    input_csv_file=None,
    output_csv_file=None,
    date_fields=None,
    lower_bound_days=None,
    upper_bound_days=None,
    context_field_id=None,
    wrapped_key=None,
    key_name=None,
):
    """Uses the Data Loss Prevention API to deidentify dates in a CSV file by
        pseudorandomly shifting them.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_csv_file: The path to the CSV file to deidentify. The first row
            of the file must specify column names, and all other rows must
            contain valid values.
        output_csv_file: The path to save the date-shifted CSV file.
        date_fields: The list of (date) fields in the CSV file to date shift.
            Example: ['birth_date', 'register_date']
        lower_bound_days: The maximum number of days to shift a date backward
        upper_bound_days: The maximum number of days to shift a date forward
        context_field_id: (Optional) The column to determine date shift amount
            based on. If this is not specified, a random shift amount will be
            used for every row. If this is specified, then 'wrappedKey' and
            'keyName' must also be set. Example:
            contextFieldId = [{ 'name': 'user_id' }]
        key_name: (Optional) The name of the Cloud KMS key used to encrypt
            ('wrap') the AES-256 key. Example:
            key_name = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/
            keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME'
        wrapped_key: (Optional) The encrypted ('wrapped') AES-256 key to use.
            This key should be encrypted using the Cloud KMS key specified by
            key_name.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Convert date field list to Protobuf type
    def map_fields(field):
        return {"name": field}

    if date_fields:
        date_fields = map(map_fields, date_fields)
    else:
        date_fields = []

    # Read and parse the CSV file
    import csv
    from datetime import datetime

    f = []
    with open(input_csv_file, "r") as csvfile:
        reader = csv.reader(csvfile)
        for row in reader:
            f.append(row)

    #  Helper function for converting CSV rows to Protobuf types
    def map_headers(header):
        return {"name": header}

    def map_data(value):
        try:
            date = datetime.strptime(value, "%m/%d/%Y")
            return {
                "date_value": {"year": date.year, "month": date.month, "day": date.day}
            }
        except ValueError:
            return {"string_value": value}

    def map_rows(row):
        return {"values": map(map_data, row)}

    # Using the helper functions, convert CSV rows to protobuf-compatible
    # dictionaries.
    csv_headers = map(map_headers, f[0])
    csv_rows = map(map_rows, f[1:])

    # Construct the table dict
    table_item = {"table": {"headers": csv_headers, "rows": csv_rows}}

    # Construct date shift config
    date_shift_config = {
        "lower_bound_days": lower_bound_days,
        "upper_bound_days": upper_bound_days,
    }

    # If using a Cloud KMS key, add it to the date_shift_config.
    # The wrapped key is base64-encoded, but the library expects a binary
    # string, so decode it here.
    if context_field_id and key_name and wrapped_key:
        import base64

        date_shift_config["context"] = {"name": context_field_id}
        date_shift_config["crypto_key"] = {
            "kms_wrapped": {
                "wrapped_key": base64.b64decode(wrapped_key),
                "crypto_key_name": key_name,
            }
        }
    elif context_field_id or key_name or wrapped_key:
        raise ValueError(
            """You must set either ALL or NONE of
        [context_field_id, key_name, wrapped_key]!"""
        )

    # Construct Deidentify Config
    deidentify_config = {
        "record_transformations": {
            "field_transformations": [
                {
                    "fields": date_fields,
                    "primitive_transformation": {
                        "date_shift_config": date_shift_config
                    },
                }
            ]
        }
    }

    # Write to CSV helper methods
    def write_header(header):
        return header.name

    def write_data(data):
        return data.string_value or "%s/%s/%s" % (
            data.date_value.month,
            data.date_value.day,
            data.date_value.year,
        )

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "item": table_item,
        }
    )

    # Write results to CSV file
    with open(output_csv_file, "w") as csvfile:
        write_file = csv.writer(csvfile, delimiter=",")
        write_file.writerow(map(write_header, response.item.table.headers))
        for row in response.item.table.rows:
            write_file.writerow(map(write_data, row.values))
    # Print status
    print("Successfully saved date-shift output to {}".format(output_csv_file))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-deidentify-date-shift-go" track-metadata-position="dlp-deidentify-date-shift" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/date_shift.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/date_shift.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/date_shift.go" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/date_shift.go/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deidentifyDateShift shifts dates found in the input between lowerBoundDays and
// upperBoundDays.
func deidentifyDateShift(w io.Writer, projectID string, lowerBoundDays, upperBoundDays int32, input string) error {
	// projectID := "my-project-id"
	// lowerBoundDays := -1
	// upperBound := -1
	// input := "2016-01-10"
	// Will print "2016-01-09"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	// Create a configured request.
	req := &amp;dlppb.DeidentifyContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		DeidentifyConfig: &amp;dlppb.DeidentifyConfig{
			Transformation: &amp;dlppb.DeidentifyConfig_InfoTypeTransformations{
				InfoTypeTransformations: &amp;dlppb.InfoTypeTransformations{
					Transformations: []*dlppb.InfoTypeTransformations_InfoTypeTransformation{
						{
							InfoTypes: []*dlppb.InfoType{}, // Match all info types.
							PrimitiveTransformation: &amp;dlppb.PrimitiveTransformation{
								Transformation: &amp;dlppb.PrimitiveTransformation_DateShiftConfig{
									DateShiftConfig: &amp;dlppb.DateShiftConfig{
										LowerBoundDays: lowerBoundDays,
										UpperBoundDays: upperBoundDays,
									},
								},
							},
						},
					},
				},
			},
		},
		// The InspectConfig is used to identify the DATE fields.
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: []*dlppb.InfoType{
				{
					Name: "DATE",
				},
			},
		},
		// The item to analyze.
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: input,
			},
		},
	}
	// Send the request.
	r, err := client.DeidentifyContent(ctx, req)
	if err != nil {
		return fmt.Errorf("DeidentifyContent: %v", err)
	}
	// Print the result.
	fmt.Fprint(w, r.GetItem().GetValue())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-date-shift-php" track-metadata-position="dlp-deidentify-date-shift" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_dates.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_dates.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_dates.php" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_dates.php/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">use DateTime;
use Exception;
use Google\Cloud\Dlp\V2\ContentItem;
use Google\Cloud\Dlp\V2\CryptoKey;
use Google\Cloud\Dlp\V2\DateShiftConfig;
use Google\Cloud\Dlp\V2\DeidentifyConfig;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\FieldId;
use Google\Cloud\Dlp\V2\FieldTransformation;
use Google\Cloud\Dlp\V2\KmsWrappedCryptoKey;
use Google\Cloud\Dlp\V2\PrimitiveTransformation;
use Google\Cloud\Dlp\V2\RecordTransformations;
use Google\Cloud\Dlp\V2\Table;
use Google\Cloud\Dlp\V2\Table\Row;
use Google\Cloud\Dlp\V2\Value;
use Google\Type\Date;

/**
 * Deidentify dates in a CSV file by pseudorandomly shifting them.
 * If contextFieldName is not specified, a random shift amount will be used for every row.
 * If contextFieldName is specified, then 'wrappedKey' and 'keyName' must also be set.
 *
 * @param string $callingProjectId  The GCP Project ID to run the API call under
 * @param string $inputCsvFile      The path to the CSV file to deidentify
 * @param string $outputCsvFile     The path to save the date-shifted CSV file to
 * @param string $dateFieldNames    The comma-separated list of (date) fields in the CSV file to date shift
 * @param string $lowerBoundDays    The maximum number of days to shift a date backward
 * @param string $upperBoundDays    The maximum number of days to shift a date forward
 * @param string $contextFieldName  (Optional) The column to determine date shift amount based on
 * @param string $keyName           (Optional) The encrypted ('wrapped') AES-256 key to use when shifting dates
 * @param string $wrappedKey        (Optional) The name of the Cloud KMS key used to encrypt (wrap) the AES-256 key
 */
function deidentify_dates(
    string $callingProjectId,
    string $inputCsvFile,
    string $outputCsvFile,
    string $dateFieldNames,
    string $lowerBoundDays,
    string $upperBoundDays,
    string $contextFieldName = '',
    string $keyName = '',
    string $wrappedKey = ''
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Read a CSV file
    $csvLines = file($inputCsvFile, FILE_IGNORE_NEW_LINES);
    $csvHeaders = explode(',', $csvLines[0]);
    $csvRows = array_slice($csvLines, 1);

    // Convert CSV file into protobuf objects
    $tableHeaders = array_map(function ($csvHeader) {
        return (new FieldId)-&gt;setName($csvHeader);
    }, $csvHeaders);

    $tableRows = array_map(function ($csvRow) {
        $rowValues = array_map(function ($csvValue) {
            if ($csvDate = DateTime::createFromFormat('m/d/Y', $csvValue)) {
                $date = (new Date())
                    -&gt;setYear((int) $csvDate-&gt;format('Y'))
                    -&gt;setMonth((int) $csvDate-&gt;format('m'))
                    -&gt;setDay((int) $csvDate-&gt;format('d'));
                return (new Value())
                    -&gt;setDateValue($date);
            } else {
                return (new Value())
                    -&gt;setStringValue($csvValue);
            }
        }, explode(',', $csvRow));

        return (new Row())
            -&gt;setValues($rowValues);
    }, $csvRows);

    // Convert date fields into protobuf objects
    $dateFields = array_map(function ($dateFieldName) {
        return (new FieldId())-&gt;setName($dateFieldName);
    }, explode(',', $dateFieldNames));

    // Construct the table object
    $table = (new Table())
        -&gt;setHeaders($tableHeaders)
        -&gt;setRows($tableRows);

    $item = (new ContentItem())
        -&gt;setTable($table);

    // Construct dateShiftConfig
    $dateShiftConfig = (new DateShiftConfig())
        -&gt;setLowerBoundDays($lowerBoundDays)
        -&gt;setUpperBoundDays($upperBoundDays);

    if ($contextFieldName &amp;&amp; $keyName &amp;&amp; $wrappedKey) {
        $contextField = (new FieldId())
            -&gt;setName($contextFieldName);

        // Create the wrapped crypto key configuration object
        $kmsWrappedCryptoKey = (new KmsWrappedCryptoKey())
            -&gt;setWrappedKey(base64_decode($wrappedKey))
            -&gt;setCryptoKeyName($keyName);

        $cryptoKey = (new CryptoKey())
            -&gt;setKmsWrapped($kmsWrappedCryptoKey);

        $dateShiftConfig
            -&gt;setContext($contextField)
            -&gt;setCryptoKey($cryptoKey);
    } elseif ($contextFieldName || $keyName || $wrappedKey) {
        throw new Exception('You must set either ALL or NONE of {$contextFieldName, $keyName, $wrappedKey}!');
    }

    // Create the information transform configuration objects
    $primitiveTransformation = (new PrimitiveTransformation())
        -&gt;setDateShiftConfig($dateShiftConfig);

    $fieldTransformation = (new FieldTransformation())
        -&gt;setPrimitiveTransformation($primitiveTransformation)
        -&gt;setFields($dateFields);

    $recordTransformations = (new RecordTransformations())
        -&gt;setFieldTransformations([$fieldTransformation]);

    // Create the deidentification configuration object
    $deidentifyConfig = (new DeidentifyConfig())
        -&gt;setRecordTransformations($recordTransformations);

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;deidentifyContent([
        'parent' =&gt; $parent,
        'deidentifyConfig' =&gt; $deidentifyConfig,
        'item' =&gt; $item
    ]);

    // Check for errors
    foreach ($response-&gt;getOverview()-&gt;getTransformationSummaries() as $summary) {
        foreach ($summary-&gt;getResults() as $result) {
            if ($details = $result-&gt;getDetails()) {
                printf('Error: %s' . PHP_EOL, $details);
                return;
            }
        }
    }

    // Save the results to a file
    $csvRef = fopen($outputCsvFile, 'w');
    fputcsv($csvRef, $csvHeaders);
    foreach ($response-&gt;getItem()-&gt;getTable()-&gt;getRows() as $tableRow) {
        $values = array_map(function ($tableValue) {
            if ($tableValue-&gt;getStringValue()) {
                return $tableValue-&gt;getStringValue();
            }
            $protoDate = $tableValue-&gt;getDateValue();
            $date = mktime(0, 0, 0, $protoDate-&gt;getMonth(), $protoDate-&gt;getDay(), $protoDate-&gt;getYear());
            return strftime('%D', $date);
        }, iterator_to_array($tableRow-&gt;getValues()));
        fputcsv($csvRef, $values);
    };
    fclose($csvRef);
    printf('Deidentified dates written to %s' . PHP_EOL, $outputCsvFile);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-date-shift-csharp" track-metadata-position="dlp-deidentify-date-shift" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithDateShift.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithDateShift.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithDateShift.cs" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithDateShift.cs/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">
using System;
using System.IO;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;

public class DeidentifyWithDateShift
{
    public static DeidentifyContentResponse Deidentify(
        string projectId,
        string inputCsvFilePath,
        int lowerBoundDays,
        int upperBoundDays,
        string dateFields,
        string contextField,
        string keyName,
        string wrappedKey)
    {
        var hasKeyName = !string.IsNullOrEmpty(keyName);
        var hasWrappedKey = !string.IsNullOrEmpty(wrappedKey);
        var hasContext = !string.IsNullOrEmpty(contextField);
        bool allFieldsSet = hasKeyName &amp;&amp; hasWrappedKey &amp;&amp; hasContext;
        bool noFieldsSet = !hasKeyName &amp;&amp; !hasWrappedKey &amp;&amp; !hasContext;
        if (!(allFieldsSet || noFieldsSet))
        {
            throw new ArgumentException("Must specify ALL or NONE of: {contextFieldId, keyName, wrappedKey}!");
        }

        var dlp = DlpServiceClient.Create();

        // Read file
        var csvLines = File.ReadAllLines(inputCsvFilePath);
        var csvHeaders = csvLines[0].Split(',');
        var csvRows = csvLines.Skip(1).ToArray();

        // Convert dates to protobuf format, and everything else to a string
        var protoHeaders = csvHeaders.Select(header =&gt; new FieldId { Name = header });
        var protoRows = csvRows.Select(csvRow =&gt;
        {
            var rowValues = csvRow.Split(',');
            var protoValues = rowValues.Select(rowValue =&gt;
               System.DateTime.TryParse(rowValue, out var parsedDate)
               ? new Value { DateValue = Google.Type.Date.FromDateTime(parsedDate) }
               : new Value { StringValue = rowValue });

            var rowObject = new Table.Types.Row();
            rowObject.Values.Add(protoValues);
            return rowObject;
        });

        var dateFieldList = dateFields
            .Split(',')
            .Select(field =&gt; new FieldId { Name = field });

        // Construct + execute the request
        var dateShiftConfig = new DateShiftConfig
        {
            LowerBoundDays = lowerBoundDays,
            UpperBoundDays = upperBoundDays
        };

        dateShiftConfig.Context = new FieldId { Name = contextField };
        dateShiftConfig.CryptoKey = new CryptoKey
        {
            KmsWrapped = new KmsWrappedCryptoKey
            {
                WrappedKey = ByteString.FromBase64(wrappedKey),
                CryptoKeyName = keyName
            }
        };

        var deidConfig = new DeidentifyConfig
        {
            RecordTransformations = new RecordTransformations
            {
                FieldTransformations =
                {
                    new FieldTransformation
                    {
                        PrimitiveTransformation = new PrimitiveTransformation
                        {
                            DateShiftConfig = dateShiftConfig
                        },
                        Fields = { dateFieldList }
                    }
                }
            }
        };

        var response = dlp.DeidentifyContent(
            new DeidentifyContentRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
                DeidentifyConfig = deidConfig,
                Item = new ContentItem
                {
                    Table = new Table
                    {
                        Headers = { protoHeaders },
                        Rows = { protoRows }
                    }
                }
            });

        return response;
    }
}</code></pre>
</div>
</section>
</div>
<h5 data-text="cryptoReplaceFfxFpeConfig" id="cryptoreplaceffxfpeconfig">cryptoReplaceFfxFpeConfig</h5>
<p>Setting <code dir="ltr" translate="no">cryptoReplaceFfxFpeConfig</code> to a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a>
object performs <a href="/dlp/docs/pseudonymization">pseudonymization</a> on an input
value by replacing an input value with a token. This token is:</p>
<ul>
<li>The encrypted input value.</li>
<li>The same length as the input value.</li>
<li>Computed using format-preserving encryption in FFX mode ("FPE-FFX") keyed
on the cryptographic key specified by <code dir="ltr" translate="no">cryptoKey</code>.</li>
<li>Comprised of the characters specified by <code dir="ltr" translate="no">alphabet</code>. Valid options:
<ul>
<li><code dir="ltr" translate="no">NUMERIC</code></li>
<li><code dir="ltr" translate="no">HEXADECIMAL</code></li>
<li><code dir="ltr" translate="no">UPPER_CASE_ALPHA_NUMERIC</code></li>
<li><code dir="ltr" translate="no">ALPHA_NUMERIC</code></li>
</ul></li>
</ul>
<p>The input value:</p>
<ul>
<li>Must be at least two characters long (or the empty string).</li>
<li>Must be comprised of the characters specified by an <code dir="ltr" translate="no">alphabet</code>. The <code dir="ltr" translate="no">alphabet</code>
can be comprised of between 2 and 95 characters. (An <code dir="ltr" translate="no">alphabet</code> with 95
characters includes all printable characters in the US-ASCII character set.)</li>
</ul>
<p>Cloud DLP computes the replacement token using a
cryptographic key. You provide this key in one of three ways:</p>
<ul>
<li>By embedding it unencrypted in the API request. This is not recommended.</li>
<li>By requesting that Cloud DLP generate it.</li>
<li>By embedding it encrypted in the API request.</li>
</ul>
<p>If you choose to embed the key in the API request, you need to
<a href="/dlp/docs/create-wrapped-key">create a key and wrap (encrypt) it</a> using a
Cloud Key Management Service (Cloud KMS) key. The value returned is a
base64-encoded string by default. To set this value in
Cloud DLP, you must decode it into a byte string. The following
code snippets highlight how to do this in several languages.
End-to-end examples are provided following these snippets.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="decoding-key">
<section>
<h3 data-text="Java" id="dlp-deidentify-date-shift-java" track-metadata-position="dlp-deidentify-date-shift" track-name="java" track-type="sampleTabNav">Java</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">KmsWrappedCryptoKey.newBuilder()
    .setWrappedKey(ByteString.copyFrom(BaseEncoding.base64().decode(wrappedKey)))
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-date-shift-python" track-metadata-position="dlp-deidentify-date-shift" track-name="python" track-type="sampleTabNav">Python</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no"># The wrapped key is base64-encoded, but the library expects a binary
# string, so decode it here.
import base64
wrapped_key = base64.b64decode(wrapped_key)
</code></pre>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-date-shift-php" track-metadata-position="dlp-deidentify-date-shift" track-name="php" track-type="sampleTabNav">PHP</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">// Create the wrapped crypto key configuration object
$kmsWrappedCryptoKey = (new KmsWrappedCryptoKey())
    -&gt;setWrappedKey(base64_decode($wrappedKey))
    -&gt;setCryptoKeyName($keyName);
</code></pre>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-date-shift-csharp" track-metadata-position="dlp-deidentify-date-shift" track-name="csharp" track-type="sampleTabNav">C#</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">WrappedKey = ByteString.FromBase64(wrappedKey)
</code></pre>
</section>
</div>
<p>For more information about encrypting and decrypting data using
Cloud KMS, see
<a href="/kms/docs/encrypt-decrypt">Encrypting and Decrypting Data</a>.</p>
<p><aside class="special"><strong>Note:</strong> When you use
  Cloud KMS for cryptographic operations,
  <a href="https://cloud.google.com/kms/pricing">charges apply</a>.</aside></p>
<p>By design, FPE-FFX preserves the length and character set of the input
text. This means that it lacks authentication and an initialization vector,
which would cause a length expansion in the output token. Other methods like
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#cryptodeterministicconfig">AES-SIV</a>
provide these stronger security guarantees and are recommended for tokenization
use cases unless length and character set preservation are strict
requirementsâfor example, for backward compatibility with a legacy data
system.</p>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to de-identify sensitive data by replacing an
input value with a token.<!-- For
information about the parameters included with the request, see
[Configuring storage inspection](#configuring-storage-inspection),
later in this topic.--></p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-fpe-code-sample">
<section>
<h3 data-text="Java" id="dlp-deidentify-fpe-java" track-metadata-position="dlp-deidentify-fpe" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.common.io.BaseEncoding;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CryptoKey;
import com.google.privacy.dlp.v2.CryptoReplaceFfxFpeConfig;
import com.google.privacy.dlp.v2.CryptoReplaceFfxFpeConfig.FfxCommonNativeAlphabet;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.KmsWrappedCryptoKey;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.Arrays;

public class DeIdentifyWithFpe {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToDeIdentify = "I'm Gary and my email is gary@example.com";
    String kmsKeyName =
        "projects/YOUR_PROJECT/"
            + "locations/YOUR_KEYRING_REGION/"
            + "keyRings/YOUR_KEYRING_NAME/"
            + "cryptoKeys/YOUR_KEY_NAME";
    String wrappedAesKey = "YOUR_ENCRYPTED_AES_256_KEY";
    deIdentifyWithFpe(projectId, textToDeIdentify, kmsKeyName, wrappedAesKey);
  }

  public static void deIdentifyWithFpe(
      String projectId, String textToDeIdentify, String kmsKeyName, String wrappedAesKey)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to DeIdentify
      ContentItem contentItem = ContentItem.newBuilder().setValue(textToDeIdentify).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("US_SOCIAL_SECURITY_NUMBER").build();
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(Arrays.asList(infoType)).build();

      // Specify an encrypted AES-256 key and the name of the Cloud KMS key that encrypted it
      KmsWrappedCryptoKey kmsWrappedCryptoKey =
          KmsWrappedCryptoKey.newBuilder()
              .setWrappedKey(ByteString.copyFrom(BaseEncoding.base64().decode(wrappedAesKey)))
              .setCryptoKeyName(kmsKeyName)
              .build();
      CryptoKey cryptoKey = CryptoKey.newBuilder().setKmsWrapped(kmsWrappedCryptoKey).build();

      // Specify how the info from the inspection should be encrypted.
      InfoType surrogateInfoType = InfoType.newBuilder().setName("SSN_TOKEN").build();
      CryptoReplaceFfxFpeConfig cryptoReplaceFfxFpeConfig =
          CryptoReplaceFfxFpeConfig.newBuilder()
              .setCryptoKey(cryptoKey)
              // Set of characters in the input text. For more info, see
              // https://cloud.google.com/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.FfxCommonNativeAlphabet
              .setCommonAlphabet(FfxCommonNativeAlphabet.NUMERIC)
              .setSurrogateInfoType(surrogateInfoType)
              .build();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setCryptoReplaceFfxFpeConfig(cryptoReplaceFfxFpeConfig)
              .build();
      InfoTypeTransformation infoTypeTransformation =
          InfoTypeTransformation.newBuilder()
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      InfoTypeTransformations transformations =
          InfoTypeTransformations.newBuilder().addTransformations(infoTypeTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setInfoTypeTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setInspectConfig(inspectConfig)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results
      System.out.println(
          "Text after format-preserving encryption: " + response.getItem().getValue());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-deidentify-fpe-nodejs" track-metadata-position="dlp-deidentify-fpe" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithFpe.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithFpe.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithFpe.js" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithFpe.js/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The string to deidentify
// const string = 'My SSN is 372819127';

// The set of characters to replace sensitive ones with
// For more information, see https://cloud.google.com/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#ffxcommonnativealphabet
// const alphabet = 'ALPHA_NUMERIC';

// The name of the Cloud KMS key used to encrypt ('wrap') the AES-256 key
// const keyName = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME';

// The encrypted ('wrapped') AES-256 key to use
// This key should be encrypted using the Cloud KMS key specified above
// const wrappedKey = 'YOUR_ENCRYPTED_AES_256_KEY'

// (Optional) The name of the surrogate custom info type to use
// Only necessary if you want to reverse the deidentification process
// Can be essentially any arbitrary string, as long as it doesn't appear
// in your dataset otherwise.
// const surrogateType = 'SOME_INFO_TYPE_DEID';

async function deidentifyWithFpe() {
  // Construct FPE config
  const cryptoReplaceFfxFpeConfig = {
    cryptoKey: {
      kmsWrapped: {
        wrappedKey: wrappedKey,
        cryptoKeyName: keyName,
      },
    },
    commonAlphabet: alphabet,
  };
  if (surrogateType) {
    cryptoReplaceFfxFpeConfig.surrogateInfoType = {
      name: surrogateType,
    };
  }

  // Construct deidentification request
  const item = {value: string};
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      infoTypeTransformations: {
        transformations: [
          {
            primitiveTransformation: {
              cryptoReplaceFfxFpeConfig: cryptoReplaceFfxFpeConfig,
            },
          },
        ],
      },
    },
    item: item,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const deidentifiedItem = response.item;
  console.log(deidentifiedItem.value);
}
deidentifyWithFpe();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-fpe-python" track-metadata-position="dlp-deidentify-fpe" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">

def deidentify_with_fpe(
    project,
    input_str,
    info_types,
    alphabet=None,
    surrogate_type=None,
    key_name=None,
    wrapped_key=None,
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string using Format Preserving Encryption (FPE).
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        alphabet: The set of characters to replace sensitive ones with. For
            more information, see https://cloud.google.com/dlp/docs/reference/
            rest/v2beta2/organizations.deidentifyTemplates#ffxcommonnativealphabet
        surrogate_type: The name of the surrogate custom info type to use. Only
            necessary if you want to reverse the deidentification process. Can
            be essentially any arbitrary string, as long as it doesn't appear
            in your dataset otherwise.
        key_name: The name of the Cloud KMS key used to encrypt ('wrap') the
            AES-256 key. Example:
            key_name = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/
            keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME'
        wrapped_key: The encrypted ('wrapped') AES-256 key to use. This key
            should be encrypted using the Cloud KMS key specified by key_name.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # The wrapped key is base64-encoded, but the library expects a binary
    # string, so decode it here.
    import base64

    wrapped_key = base64.b64decode(wrapped_key)

    # Construct FPE configuration dictionary
    crypto_replace_ffx_fpe_config = {
        "crypto_key": {
            "kms_wrapped": {"wrapped_key": wrapped_key, "crypto_key_name": key_name}
        },
        "common_alphabet": alphabet,
    }

    # Add surrogate type
    if surrogate_type:
        crypto_replace_ffx_fpe_config["surrogate_info_type"] = {"name": surrogate_type}

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {
                    "primitive_transformation": {
                        "crypto_replace_ffx_fpe_config": crypto_replace_ffx_fpe_config
                    }
                }
            ]
        }
    }

    # Convert string to item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print results
    print(response.item.value)

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-deidentify-fpe-go" track-metadata-position="dlp-deidentify-fpe" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/deid_fpe.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/deid_fpe.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/deid_fpe.go" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/deid_fpe.go/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"io/ioutil"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deidentifyFPE deidentifies the input with FPE (Format Preserving Encryption).
// keyFileName is the file name with the KMS wrapped key and cryptoKeyName is the
// full KMS key resource name used to wrap the key. surrogateInfoType is an
// optional identifier needed for reidentification. surrogateInfoType can be any
// value not found in your input.
// Info types can be found with the infoTypes.list method or on https://cloud.google.com/dlp/docs/infotypes-reference
func deidentifyFPE(w io.Writer, projectID, input string, infoTypeNames []string, keyFileName, cryptoKeyName, surrogateInfoType string) error {
	// projectID := "my-project-id"
	// input := "My SSN is 123456789"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// keyFileName := "projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME"
	// cryptoKeyName := "YOUR_ENCRYPTED_AES_256_KEY"
	// surrogateInfoType := "AGE"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Read the key file.
	keyBytes, err := ioutil.ReadFile(keyFileName)
	if err != nil {
		return fmt.Errorf("ReadFile: %v", err)
	}
	// Create a configured request.
	req := &amp;dlppb.DeidentifyContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: infoTypes,
		},
		DeidentifyConfig: &amp;dlppb.DeidentifyConfig{
			Transformation: &amp;dlppb.DeidentifyConfig_InfoTypeTransformations{
				InfoTypeTransformations: &amp;dlppb.InfoTypeTransformations{
					Transformations: []*dlppb.InfoTypeTransformations_InfoTypeTransformation{
						{
							InfoTypes: []*dlppb.InfoType{}, // Match all info types.
							PrimitiveTransformation: &amp;dlppb.PrimitiveTransformation{
								Transformation: &amp;dlppb.PrimitiveTransformation_CryptoReplaceFfxFpeConfig{
									CryptoReplaceFfxFpeConfig: &amp;dlppb.CryptoReplaceFfxFpeConfig{
										CryptoKey: &amp;dlppb.CryptoKey{
											Source: &amp;dlppb.CryptoKey_KmsWrapped{
												KmsWrapped: &amp;dlppb.KmsWrappedCryptoKey{
													WrappedKey:    keyBytes,
													CryptoKeyName: cryptoKeyName,
												},
											},
										},
										// Set the alphabet used for the output.
										Alphabet: &amp;dlppb.CryptoReplaceFfxFpeConfig_CommonAlphabet{
											CommonAlphabet: dlppb.CryptoReplaceFfxFpeConfig_ALPHA_NUMERIC,
										},
										// Set the surrogate info type, used for reidentification.
										SurrogateInfoType: &amp;dlppb.InfoType{
											Name: surrogateInfoType,
										},
									},
								},
							},
						},
					},
				},
			},
		},
		// The item to analyze.
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: input,
			},
		},
	}
	// Send the request.
	r, err := client.DeidentifyContent(ctx, req)
	if err != nil {
		return fmt.Errorf("DeidentifyContent: %v", err)
	}
	// Print the result.
	fmt.Fprint(w, r.GetItem().GetValue())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-fpe-php" track-metadata-position="dlp-deidentify-fpe" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_fpe.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_fpe.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_fpe.php" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_fpe.php/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\CryptoReplaceFfxFpeConfig;
use Google\Cloud\Dlp\V2\CryptoReplaceFfxFpeConfig\FfxCommonNativeAlphabet;
use Google\Cloud\Dlp\V2\CryptoKey;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\PrimitiveTransformation;
use Google\Cloud\Dlp\V2\KmsWrappedCryptoKey;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\DeidentifyConfig;
use Google\Cloud\Dlp\V2\InfoTypeTransformations\InfoTypeTransformation;
use Google\Cloud\Dlp\V2\InfoTypeTransformations;
use Google\Cloud\Dlp\V2\ContentItem;

/**
 * Deidentify a string using Format-Preserving Encryption (FPE).
 *
 * @param string $callingProjectId  The GCP Project ID to run the API call under
 * @param string $string            The string to deidentify
 * @param string $keyName           The name of the Cloud KMS key used to encrypt (wrap) the AES-256 key
 * @param string $wrappedKey        The name of the Cloud KMS key use, encrypted with the KMS key in $keyName
 * @param string $surrogateTypeName (Optional) surrogate custom info type to enable reidentification
 */
function deidentify_fpe(
    string $callingProjectId,
    string $string,
    string $keyName,
    string $wrappedKey,
    string $surrogateTypeName = ''
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // The infoTypes of information to mask
    $ssnInfoType = (new InfoType())
        -&gt;setName('US_SOCIAL_SECURITY_NUMBER');
    $infoTypes = [$ssnInfoType];

    // Create the wrapped crypto key configuration object
    $kmsWrappedCryptoKey = (new KmsWrappedCryptoKey())
        -&gt;setWrappedKey(base64_decode($wrappedKey))
        -&gt;setCryptoKeyName($keyName);

    // The set of characters to replace sensitive ones with
    // For more information, see https://cloud.google.com/dlp/docs/reference/rest/V2/organizations.deidentifyTemplates#ffxcommonnativealphabet
    $commonAlphabet = FfxCommonNativeAlphabet::NUMERIC;

    // Create the crypto key configuration object
    $cryptoKey = (new CryptoKey())
        -&gt;setKmsWrapped($kmsWrappedCryptoKey);

    // Create the crypto FFX FPE configuration object
    $cryptoReplaceFfxFpeConfig = (new CryptoReplaceFfxFpeConfig())
        -&gt;setCryptoKey($cryptoKey)
        -&gt;setCommonAlphabet($commonAlphabet);

    if ($surrogateTypeName) {
        $surrogateType = (new InfoType())
            -&gt;setName($surrogateTypeName);
        $cryptoReplaceFfxFpeConfig-&gt;setSurrogateInfoType($surrogateType);
    }

    // Create the information transform configuration objects
    $primitiveTransformation = (new PrimitiveTransformation())
        -&gt;setCryptoReplaceFfxFpeConfig($cryptoReplaceFfxFpeConfig);

    $infoTypeTransformation = (new InfoTypeTransformation())
        -&gt;setPrimitiveTransformation($primitiveTransformation)
        -&gt;setInfoTypes($infoTypes);

    $infoTypeTransformations = (new InfoTypeTransformations())
        -&gt;setTransformations([$infoTypeTransformation]);

    // Create the deidentification configuration object
    $deidentifyConfig = (new DeidentifyConfig())
        -&gt;setInfoTypeTransformations($infoTypeTransformations);

    $content = (new ContentItem())
        -&gt;setValue($string);

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;deidentifyContent([
        'parent' =&gt; $parent,
        'deidentifyConfig' =&gt; $deidentifyConfig,
        'item' =&gt; $content
    ]);

    // Print the results
    $deidentifiedValue = $response-&gt;getItem()-&gt;getValue();
    print($deidentifiedValue);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-fpe-csharp" track-metadata-position="dlp-deidentify-fpe" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithFpe.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithFpe.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithFpe.cs" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithFpe.cs/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;
using static Google.Cloud.Dlp.V2.CryptoReplaceFfxFpeConfig.Types;

public class DeidentifyWithFpe
{
    public static DeidentifyContentResponse Deidentify(
        string projectId,
        string dataValue,
        IEnumerable&lt;InfoType&gt; infoTypes,
        string keyName,
        string wrappedKey,
        FfxCommonNativeAlphabet alphabet)
    {
        var deidentifyConfig = new DeidentifyConfig
        {
            InfoTypeTransformations = new InfoTypeTransformations
            {
                Transformations =
                {
                    new InfoTypeTransformations.Types.InfoTypeTransformation
                    {
                        PrimitiveTransformation = new PrimitiveTransformation
                        {
                            CryptoReplaceFfxFpeConfig = new CryptoReplaceFfxFpeConfig
                            {
                                CommonAlphabet = alphabet,
                                CryptoKey = new CryptoKey
                                {
                                    KmsWrapped = new KmsWrappedCryptoKey
                                    {
                                        CryptoKeyName = keyName,
                                        WrappedKey = ByteString.FromBase64 (wrappedKey)
                                    }
                                },
                                SurrogateInfoType = new InfoType
                                {
                                    Name = "TOKEN"
                                }
                            }
                        }
                    }
                }
            }
        };

        var dlp = DlpServiceClient.Create();
        var response = dlp.DeidentifyContent(
            new DeidentifyContentRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
                InspectConfig = new InspectConfig
                {
                    InfoTypes = { infoTypes }
                },
                DeidentifyConfig = deidentifyConfig,
                Item = new ContentItem { Value = dataValue }
            });

        Console.WriteLine($"Deidentified content: {response.Item.Value}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h5 data-text="fixedSizeBucketingConfig" id="fixedsizebucketingconfig">fixedSizeBucketingConfig</h5>
<p>The bucketing transformationsâthis one and
<a href="#bucketingConfig"><code dir="ltr" translate="no">bucketingConfig</code></a>âserve to mask numerical data by
âbucketingâ it into ranges. The resulting number range is a hyphenated string
consisting of a lower bound, a hyphen, and an upper bound.</p>
<p>Setting <code dir="ltr" translate="no">fixedSizeBucketingConfig</code> to a <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#fixedsizebucketingconfig"><code dir="ltr" translate="no">FixedSizeBucketingConfig</code></a>
object buckets input values based on fixed size ranges. The
<code dir="ltr" translate="no">FixedSizeBucketingConfig</code> object consists of the following:</p>
<ul>
<li><code dir="ltr" translate="no">lowerBound</code>: The lower bound value of all of the buckets. Values less than
this one are grouped together in a single bucket.</li>
<li><code dir="ltr" translate="no">upperBound</code>: The upper bound value of all of the buckets. Values greater
than this one are grouped together in a single bucket.</li>
<li><code dir="ltr" translate="no">bucketSize</code>: The size of each bucket other than the minimum and maximum
buckets.</li>
</ul>
<p>For example, if <code dir="ltr" translate="no">lowerBound</code> is set to 10, <code dir="ltr" translate="no">upperBound</code> is set to 89, and
<code dir="ltr" translate="no">bucketSize</code> is set to 10, then the following buckets would be used: -10,
10-20, 20-30, 30-40, 40-50, 50-60, 60-70, 70-80, 80-89, 89+.</p>
<p>For more information about the concept of bucketing, see <a href="/dlp/docs/concepts-bucketing">Generalization and
Bucketing</a>.</p>
<h5 data-text="bucketingConfig" id="bucketingconfig">bucketingConfig</h5>
<p>The <code dir="ltr" translate="no">bucketingConfig</code> transformation offers more flexibility than the other
bucketing transformation, <a href="#fixedSizeBucketingConfig"><code dir="ltr" translate="no">fixedSizeBucketingConfig</code></a>.
Instead of specifying upper and lower bounds and an interval value with which
to create equal-sized buckets, you specify the maximum and minimum values for
each bucket you want created. Each maximum and minimum value pair must have
the same type.</p>
<p>Setting <code dir="ltr" translate="no">bucketingConfig</code> to a <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#bucketingconfig"><code dir="ltr" translate="no">BucketingConfig</code></a>
object specifies custom buckets. The <code dir="ltr" translate="no">BucketingConfig</code> object consists of a
<code dir="ltr" translate="no">buckets[]</code> array of <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#bucket"><code dir="ltr" translate="no">Bucket</code></a>
objects. Each <code dir="ltr" translate="no">Bucket</code> object consists of the following:</p>
<ul>
<li><code dir="ltr" translate="no">min</code>: The lower bound of the bucketâs range. Omit this value to create a
bucket that has no lower bound.</li>
<li><code dir="ltr" translate="no">max</code>: The upper bound of the bucketâs range. Omit this value to create a
bucket that has no upper bound.</li>
<li><code dir="ltr" translate="no">replacementValue</code>: The value with which to replace values that fall within
the lower and upper bounds. If you donât provide a <code dir="ltr" translate="no">replacementValue</code>, a
hyphenated <code dir="ltr" translate="no">min-max</code> range will be used instead.</li>
</ul>
<p>If a value falls outside of the defined ranges, the <a href="/dlp/docs/reference/rest/v2/TransformationOverview#transformationsummary"><code dir="ltr" translate="no">TransformationSummary</code></a>
returned will contain an error message.</p>
<p>For example, consider the following configuration for the <code dir="ltr" translate="no">bucketingConfig</code>
transformation:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"bucketingConfig":{
  "buckets":[
    {
      "min":{
        "integerValue":"1"
      },
      "max":{
        "integerValue":"30"
      },
      "replacementValue":{
        "stringValue":"LOW"
      }
    },
    {
      "min":{
        "integerValue":"31"
      },
      "max":{
        "integerValue":"65"
      },
      "replacementValue":{
        "stringValue":"MEDIUM"
      }
    },
    {
      "min":{
        "integerValue":"66"
      },
      "max":{
        "integerValue":"100"
      },
      "replacementValue":{
        "stringValue":"HIGH"
      }
    }
  ]
}
</code></pre>
<p>This defines the following behavior:</p>
<ul>
<li>Integer values falling between 1 and 30 are masked by being replaced with
<code dir="ltr" translate="no">LOW</code>.</li>
<li>Integer values falling between 31-65 are masked by being replaced with
<code dir="ltr" translate="no">MEDIUM</code>.</li>
<li>Integer values falling between 66-100 are masked by being replaced with
<code dir="ltr" translate="no">HIGH</code>.</li>
</ul>
<p>For more information about the concept of bucketing, see <a href="/dlp/docs/concepts-bucketing">Generalization and
Bucketing</a>.</p>
<h5 data-text="replaceWithInfoTypeConfig" id="replacewithinfotypeconfig">replaceWithInfoTypeConfig</h5>
<p>Specifying
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#replacewithinfotypeconfig"><code dir="ltr" translate="no">replaceWithInfoTypeConfig</code></a>
replaces each matched value with the name of the infoType. The
<code dir="ltr" translate="no">replaceWithInfoTypeConfig</code> message has no arguments; specifying it enables
 its transformation.</p>
<p>For example, suppose youâve specified <code dir="ltr" translate="no">replaceWithInfoTypeConfig</code> for all
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoTypes, and the following string is sent to
Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string will be the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is EMAIL_ADDRESS.</pre>
<h5 data-text="timePartConfig" id="timepartconfig">timePartConfig</h5>
<p>Setting <code dir="ltr" translate="no">timePartConfig</code> to a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#timepartconfig"><code dir="ltr" translate="no">TimePartConfig</code></a>
object preserves a portion of a matched value that includes <code dir="ltr" translate="no">Date</code>,
<code dir="ltr" translate="no">Timestamp</code>, and <code dir="ltr" translate="no">TimeOfDay</code> values. The <code dir="ltr" translate="no">TimePartConfig</code> object consists of
a <code dir="ltr" translate="no">partToExtract</code> argument, which can be set to any of the <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#timepart"><code dir="ltr" translate="no">TimePart</code></a>
enumerated values, including year, month, day of the month, and so on.</p>
<p>For example, suppose youâve configured a <code dir="ltr" translate="no">timePartConfig</code> transformation by
setting <code dir="ltr" translate="no">partToExtract</code> to <code dir="ltr" translate="no">YEAR</code>. After sending the data in the first column
below to Cloud DLP, you'd end up with the transformed values
in the second column:</p>
<table>
<tr>
<th>Original values</th>
<th>Transformed values</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">9/21/1976</code></td>
<td><code dir="ltr" translate="no">1976</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">6/7/1945</code></td>
<td><code dir="ltr" translate="no">1945</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">1/20/2009</code></td>
<td><code dir="ltr" translate="no">2009</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">7/4/1776</code></td>
<td><code dir="ltr" translate="no">1776</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">8/1/1984</code></td>
<td><code dir="ltr" translate="no">1984</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">4/21/1982</code></td>
<td><code dir="ltr" translate="no">1982</code></td>
</tr>
</table>
<h3 data-text="Record transformations" id="record_transformations">Record transformations</h3>
<p>Record transformations (the
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#recordtransformations"><code dir="ltr" translate="no">RecordTransformations</code></a>
object) are only applied to values within tabular data that are identified as
a specific infoType. Within <code dir="ltr" translate="no">RecordTransformations</code>, there are two further
subcategories of transformations:</p>
<ul>
<li><a href="/dlp/docs/deidentify-sensitive-data#field_transformations"><code dir="ltr" translate="no">fieldTransformations[]</code></a>:
Transformations that apply various field transformations.</li>
<li><a href="/dlp/docs/deidentify-sensitive-data#record_suppressions"><code dir="ltr" translate="no">recordSuppressions[]</code></a>:
Rules defining which records get suppressed completely. Records that match
any suppression rule within <code dir="ltr" translate="no">recordSuppressions[]</code> are omitted from the
output.</li>
</ul>
<h4 data-text="Field transformations" id="field_transformations">Field transformations</h4>
<p>Each
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#fieldtransformation"><code dir="ltr" translate="no">FieldTransformation</code></a>
object includes three arguments:</p>
<ul>
<li><code dir="ltr" translate="no">fields</code>: One or more input fields (<a href="/dlp/docs/reference/rest/v2/FieldId"><code dir="ltr" translate="no">FieldID</code></a>
objects) to apply the transformation to.</li>
<li><code dir="ltr" translate="no">condition</code>: A condition (a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#recordcondition"><code dir="ltr" translate="no">RecordCondition</code></a>
object) that must evaluate to true for the transformation to be applied. For
example, apply a bucket transformation to an age column of a record only if
the ZIP code column for the same record is within a specific range. Or,
redact a field only if the birthdate field puts a person's age at 85 or above.</li>
<li>One of the following two transformation type arguments. Specifying one is
required:
<ul>
<li><code dir="ltr" translate="no">infoTypeTransformations</code>: Treat the contents of the field as free text,
and apply a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#primitivetransformation"><code dir="ltr" translate="no">PrimitiveTransformation</code></a>
only to content that matches an
<a href="/dlp/docs/reference/rest/v2/InfoType"><code dir="ltr" translate="no">InfoType</code></a>. These
transformations were discussed
<a href="/dlp/docs/deidentify-sensitive-data#infotype_transformations">earlier in this topic</a>.</li>
<li><code dir="ltr" translate="no">primitiveTransformation</code>: Apply the specified primitive transformation
(<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#primitivetransformation"><code dir="ltr" translate="no">PrimitiveTransformation</code></a>
object) to the entire field. These transformations were discussed
<a href="/dlp/docs/deidentify-sensitive-data#primitive_transformations">earlier in this topic</a>.</li>
</ul></li>
</ul>
<h4 data-text="Record suppressions" id="record_suppressions">Record suppressions</h4>
<p>In addition to applying transformations to field data, you can also instruct
Cloud DLP to de-identify data by simply suppressing records
when certain suppression conditions evaluate to true. You can apply both field
transformations and record suppressions in the same request.</p>
<p>You set the <code dir="ltr" translate="no">recordSuppressions</code> message of the <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#recordtransformations"><code dir="ltr" translate="no">RecordTransformations</code></a>
object to an array of one or more <code dir="ltr" translate="no">RecordSuppression</code> objects.</p>
<p>Each
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#recordsuppression"><code dir="ltr" translate="no">RecordSuppression</code></a>
object contains a single
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#recordcondition"><code dir="ltr" translate="no">RecordCondition</code></a>
object, which in turn contains a single
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#expressions"><code dir="ltr" translate="no">Expressions</code></a>
object.</p>
<p>An <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#expressions"><code dir="ltr" translate="no">Expressions</code></a>
object contains:</p>
<ul>
<li><code dir="ltr" translate="no">logicalOperator</code>: One of the <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#logicaloperator"><code dir="ltr" translate="no">LogicalOperator</code></a> enumerated
types.</li>
<li><code dir="ltr" translate="no">conditions</code>: A
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#conditions"><code dir="ltr" translate="no">Conditions</code></a>
object, containing an array of one or more
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#condition"><code dir="ltr" translate="no">Condition</code></a>
objects. A <code dir="ltr" translate="no">Condition</code> is a comparison of a field value and another value,
both of which be of type <code dir="ltr" translate="no">string</code>, <code dir="ltr" translate="no">boolean</code>, <code dir="ltr" translate="no">integer</code>, <code dir="ltr" translate="no">double</code>,
<code dir="ltr" translate="no">Timestamp</code>, or <code dir="ltr" translate="no">TimeofDay</code>.</li>
</ul>
<p>If the comparison evaluates to true, the record is suppressed, and vice-versa.
If the compared values are not the same type, a warning is given and the
condition evaluates to false.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><p>Learn more about <a href="/architecture/de-identification-re-identification-pii-using-cloud-dlp">how a de-identification workflow fits into real-life
deployments</a>.</p></li>
<li><p>Work through an end-to-end example that demonstrates how to <a href="/dlp/docs/inspect-sensitive-text-de-identify">create a wrapped
key, tokenize content, and re-identify tokenized content</a>.</p></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/redacting-sensitive-data-images]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention can redact sensitive text from an image. Using <a href="/dlp/docs/infotypes-reference">infoType
detectors</a> and <a href="/vision">Cloud Vision</a>,
Cloud DLP inspects an image for text, detects
sensitive data within the text, and then returns an image with
any matching sensitive data obscured by an opaque rectangle.</p>
<aside class="note"><strong>Note:</strong><span> Cloud DLP can redact sensitive data from many image types,
including JPEG, BMP, and PNG. For more information, see <a href="/dlp/docs/supported-file-types">Supported file
types</a>. Note that content redaction is currently
not supported for SVG, PDF, XLSX, PPTX, or DOCX files.</span></aside>
<p>For example, consider the following "before" and "after" images. The original
image is an example of a typical image file generated from a scan of a paper
document. In this example, Cloud DLP has been configured to redact
US Social Security numbers, email addresses, and telephone numbers using
rectangles of different colors, depending on the content.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-beforeafter.png">
<img alt="Before and after redacted image (click to enlarge)" border="0" src="/dlp/docs/images/redacting-sensitive-data-images-beforeafter.png" title="Before and after redacted image (click to enlarge)">
</img></a>
</figure>
<ol>
<li>Scanned image before image redaction</li>
<li>Scanned image after image redaction</li>
</ol>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
<li>
<p>
        
          
            
              Enable the DLP API.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the API</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
<aside class="note"><strong>Note:</strong><span> You can do these tasks with your Google Cloud user account, or
you can use a service account. In either case, make sure the account you use
has a role with the
<a href="/iam/docs/permissions-reference"><code dir="ltr" translate="no">serviceusage.services.use</code>
permission</a>, such as Owner (<code dir="ltr" translate="no">roles/owner</code>), Editor
(<code dir="ltr" translate="no">roles/editor</code>),
or a <a href="/iam/docs/understanding-custom-roles">custom role</a>.</span></aside>
<h2 data-text="Redacting all default infoTypes from an image" id="redacting_all_default_infotypes_from_an_image">Redacting all default infoTypes from an image</h2>
<p>To redact sensitive data from an image, submit the image to the
DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">image.redact</code></a> method.
Unless you specify specific information types (<a href="/dlp/docs/infotypes-reference">infoTypes</a>)
to search for, Cloud DLP searches for the most common infoTypes.</p>
<p>For example, consider the following image. This image is an example of a
typical image file generated from a scan of a paper document.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpbefore.jpg">
<img alt="Original unredacted image (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpbefore.jpg" title="Original unredacted image (click to enlarge)" width="500">
</img></a>
</figure>
<p>To redact the default infoTypes from this image, send the following request to
the DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">image.redact</code></a> method:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-redact-image-all-infotypes-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-redact-image-all-infotypes-protocol" track-metadata-position="dlp-redact-image-all-infotypes" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<aside class="important"><strong>Important:</strong> Before sending this
  request to the REST API, use a base64 utility to encode the image into ASCII text data, and
  then replace the <code dir="ltr" translate="no">[BASE64-ENCODED-IMAGE]</code> placeholder with the
  base64-encoded text. Most development environments contain a native
  <code dir="ltr" translate="no">base64</code> utility. To encode an image file:
  <ul>
<li>Linux: <code dir="ltr" translate="no">base64 input.jpg &gt; output.txt</code></li>
<li>macOS: <code dir="ltr" translate="no">base64 -i input.jpg -o output.txt</code></li>
<li>Windows: <code dir="ltr" translate="no">C:&gt; Base64.exe -e input.jpg &gt; output.txt</code></li>
<li>PowerShell: <code dir="ltr" translate="no">[Convert]::ToBase64String([IO.File]::ReadAllBytes("./input.jpg")) &gt; output.txt</code></li>
</ul></aside>
<pre class="prettyprint devsite-click-to-copy lang-json" dir="ltr" translate="no">
{
  "byteItem": {
    "data": "[BASE64-ENCODED-IMAGE]",
    "type": "IMAGE_JPEG"
  }
}</pre>
<p>Cloud DLP returns the following:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no">
    {
      "redactedImage": "[BASE64-ENCODED-IMAGE]"
    }</pre>
<p>Decode the base64-encoded image.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-redact-image-all-infotypes-java" track-metadata-position="dlp-redact-image-all-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image-all-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image-all-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-redact-image-all-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllInfoTypes.java" data-region-tag="dlp_redact_image_all_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllInfoTypes.java/HEAD/dlp_redact_image_all_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.RedactImageRequest;
import com.google.privacy.dlp.v2.RedactImageResponse;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

class RedactImageFileAllInfoTypes {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "my-project-id";
    String inputPath = "src/test/resources/sensitive-data-image.jpeg";
    String outputPath = "sensitive-data-image-redacted.jpeg";
    redactImageFileAllInfoTypes(projectId, inputPath, outputPath);
  }

  static void redactImageFileAllInfoTypes(String projectId, String inputPath, String outputPath)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be redacted.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(inputPath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.IMAGE_JPEG).setData(fileBytes).build();

      // Construct the Redact request to be sent by the client.
      // Do not specify the type of info to redact.
      RedactImageRequest request =
          RedactImageRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setByteItem(byteItem)
              .build();

      // Use the client to send the API request.
      RedactImageResponse response = dlp.redactImage(request);

      // Parse the response and process results.
      FileOutputStream redacted = new FileOutputStream(outputPath);
      redacted.write(response.getRedactedImage().toByteArray());
      redacted.close();
      System.out.println("Redacted image written to " + outputPath);
    }
  }
}</code></pre>
</div>
</section>
</div>
<p>The resulting image appears as follows:</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpafter1.jpg">
<img alt="Redacted image, all infoTypes (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpafter1.jpg" title="Redacted image, all infoTypes (click to enlarge)" width="500">
</img></a>
</figure>
<p>Note that, in addition to masking the handwritten Social Security number, the
email address, and the phone number, Cloud DLP has also redacted
the year. Assuming that's not optimal behavior, the next example demonstrates
how to redact only certain infoTypes.</p>
<aside class="note"><strong>Tip:</strong> Along with the resulting image, you can
  get a report of pixel coordinate and length values that indicate the areas the
  redaction boxes were drawn. This is the same information that <a href="/dlp/docs/inspecting-images">image inspection</a> returns. To enable this
  functionality, set <a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">includeFindings</code></a>
  to <code dir="ltr" translate="no">true</code> in your request to <code dir="ltr" translate="no">image.redact</code>.</aside>
<h2 data-text="Redacting specific infoTypes from an image" id="redacting_specific_infotypes_from_an_image">Redacting specific infoTypes from an image</h2>
<p>If you want to redact only certain sensitive data from an image, specify their
corresponding built-in infoTypes.</p>
<aside class="note"><strong>Note:</strong><span> You can also redact data matching your <a href="/dlp/docs/creating-custom-infotypes">custom infoType
detectors</a>.</span></aside>
<p>To redact specific infoTypes from an image, submit a request to the DLP API's <code dir="ltr" translate="no">image.redact</code> method. The request must include the following:
     * The image.
     * One or more <a href="/dlp/docs/infotypes-reference">infoType detectors</a>.</p>
<p>Consider the original image from the previous section. To redact only
US Social Security numbers, email addresses, and telephone numbers, send the
following JSON to the DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">image.redact</code></a> method:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-redact-image-listed-infotypes-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-redact-image-listed-infotypes-protocol" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<aside class="important"><strong>Important:</strong> Before sending this
  request, use a base64 utility to encode the image into ASCII text data, and
  then replace the <code dir="ltr" translate="no">[BASE64-ENCODED-IMAGE]</code> placeholder with the
  base64-encoded text. Most development environments contain a native
  <code dir="ltr" translate="no">base64</code> utility. To encode an image file:
  <ul>
<li>Linux: <code dir="ltr" translate="no">base64 input.jpg &gt; output.txt</code></li>
<li>macOS: <code dir="ltr" translate="no">base64 -i input.jpg -o output.txt</code></li>
<li>Windows: <code dir="ltr" translate="no">C:&gt; Base64.exe -e input.jpg &gt; output.txt</code></li>
<li>PowerShell: <code dir="ltr" translate="no">[Convert]::ToBase64String([IO.File]::ReadAllBytes("./input.jpg")) &gt; output.txt</code></li>
</ul></aside>
<pre class="prettyprint devsite-click-to-copy lang-json" dir="ltr" translate="no">
    {
      "byteItem": {
        "data": "[BASE64-ENCODED-IMAGE]",
        "type": "IMAGE_JPEG"
      },
      "imageRedactionConfigs": [
        {
          "infoType": {
            "name": "US_SOCIAL_SECURITY_NUMBER"
          }
        },
        {
          "infoType": {
            "name": "EMAIL_ADDRESS"
          }
        },
        {
          "infoType": {
            "name": "PHONE_NUMBER"
          }
        }
      ]
    }</pre>
<p>Cloud DLP returns the following:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no">
    {
      "redactedImage": "[BASE64-ENCODED-IMAGE]"
    }</pre>
<p>Decode the base64-encoded image.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-redact-image-listed-infotypes-java" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileListedInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileListedInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image-listed-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileListedInfoTypes.java" data-region-tag="dlp_redact_image_listed_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileListedInfoTypes.java/HEAD/dlp_redact_image_listed_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.RedactImageRequest;
import com.google.privacy.dlp.v2.RedactImageRequest.ImageRedactionConfig;
import com.google.privacy.dlp.v2.RedactImageResponse;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

class RedactImageFileListedInfoTypes {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "my-project-id";
    String inputPath = "src/test/resources/sensitive-data-image.jpeg";
    String outputPath = "sensitive-data-image-redacted.jpeg";
    redactImageFileListedInfoTypes(projectId, inputPath, outputPath);
  }

  static void redactImageFileListedInfoTypes(String projectId, String inputPath, String outputPath)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be redacted.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(inputPath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.IMAGE_JPEG).setData(fileBytes).build();

      // Specify the types of info necessary to redact.
      List&lt;InfoType&gt; infoTypes = new ArrayList&lt;&gt;();
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      for (String typeName :
          new String[] {"US_SOCIAL_SECURITY_NUMBER", "EMAIL_ADDRESS", "PHONE_NUMBER"}) {
        infoTypes.add(InfoType.newBuilder().setName(typeName).build());
      }
      InspectConfig inspectConfig = InspectConfig.newBuilder().addAllInfoTypes(infoTypes).build();

      // Prepare redaction configs.
      List&lt;ImageRedactionConfig&gt; imageRedactionConfigs =
          infoTypes.stream()
              .map(infoType -&gt; ImageRedactionConfig.newBuilder().setInfoType(infoType).build())
              .collect(Collectors.toList());

      // Construct the Redact request to be sent by the client.
      RedactImageRequest request =
          RedactImageRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setByteItem(byteItem)
              .addAllImageRedactionConfigs(imageRedactionConfigs)
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      RedactImageResponse response = dlp.redactImage(request);

      // Parse the response and process results.
      FileOutputStream redacted = new FileOutputStream(outputPath);
      redacted.write(response.getRedactedImage().toByteArray());
      redacted.close();
      System.out.println("Redacted image written to " + outputPath);
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-redact-image-listed-infotypes-csharp" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RedactImage.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RedactImage.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image-listed-infotypes" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-redact-image-listed-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RedactImage.cs" data-region-tag="redact_image" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RedactImage.cs/HEAD/redact_image" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;
using System;
using System.IO;

public class RedactImage
{
    public static RedactImageResponse Redact(string projectId, string originalImagePath, string redactedImagePath)
    {
        var request = new RedactImageRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectConfig = new InspectConfig
            {
                MinLikelihood = Likelihood.Likely,
                Limits = new InspectConfig.Types.FindingLimits() { MaxFindingsPerItem = 5 },
                IncludeQuote = true,
                InfoTypes =
                    {
                        new InfoType { Name = "PHONE_NUMBER" },
                        new InfoType { Name = "EMAIL_ADDRESS" }
                    }
            },
            ByteItem = new ByteContentItem
            {
                Type = ByteContentItem.Types.BytesType.ImagePng,
                Data = ByteString.FromStream(new FileStream(originalImagePath, FileMode.Open))
            },
        };

        var client = DlpServiceClient.Create();
        var response = client.RedactImage(request);

        Console.WriteLine($"Extracted text: {response.ExtractedText}");

        // Writes redacted image into file
        response.RedactedImage.WriteTo(new FileStream(redactedImagePath, FileMode.Create, FileAccess.Write));

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<p>The resulting image appears as follows:</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpafter2.jpg">
<img alt="Redacted image, 3 infoTypes (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpafter2.jpg" title="Redacted image, 3 infoTypes (click to enlarge)" width="500">
</img></a>
</figure>
<p>You can color code redacted information by infoType when you want to tell
at a glance what's been redacted. See the following section for more
information.</p>
<h2 data-text="Redacting infoTypes from an image with color coding" id="redacting_infotypes_from_an_image_with_color_coding">Redacting infoTypes from an image with color coding</h2>
<p>To color code redacted information by infoType, you pair infoType detectors with
RGB color space values.</p>
<p>To color-code infoTypes  redacted from an image, submit a request to the DLP API's <code dir="ltr" translate="no">image.redact</code> method. The request must include the following:
     * The image.
     * One or more <a href="/dlp/docs/infotypes-reference">infoType detectors</a>, each of which is
       assigned a color using <a href="/dlp/docs/reference/rest/v2/projects.image/redact#Color">RGB color space
       values</a>.</p>
<aside class="note"><strong>Note:</strong><span> Color space values are expressed in the three chromaticities of red,
green, and blue. Each value is between 0 and 1, inclusive. If you're used to
expressing RGB chromaticity values between 0 and 255, inclusive, you'll need to
divide each one by 255 before including it in the call to <code dir="ltr" translate="no">image.redact</code>. For
example, a purple RGB value of (77,26,153) would be approximately (0.3,0.1,0.6).</span></aside>
<p>Consider the original image from the first section. To redact
US Social Security numbers with a purple box, email addresses with a green box,
and telephone numbers with an orange box, send the following JSON to the
DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">image.redact</code></a> method:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-redact-image-colored-infotypes-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-redact-image-colored-infotypes-protocol" track-metadata-position="dlp-redact-image-colored-infotypes" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<aside class="important"><strong>Important:</strong> Before sending this
  request, use a base64 utility to encode the image into ASCII text data, and
  then replace the <code dir="ltr" translate="no">[BASE64-ENCODED-IMAGE]</code> placeholder with the
  base64-encoded text. Most development environments contain a native
  <code dir="ltr" translate="no">base64</code> utility. To encode an image file:
  <ul>
<li>Linux: <code dir="ltr" translate="no">base64 input.jpg &gt; output.txt</code></li>
<li>macOS: <code dir="ltr" translate="no">base64 -i input.jpg -o output.txt</code></li>
<li>Windows: <code dir="ltr" translate="no">C:&gt; Base64.exe -e input.jpg &gt; output.txt</code></li>
<li>PowerShell: <code dir="ltr" translate="no">[Convert]::ToBase64String([IO.File]::ReadAllBytes("./input.jpg")) &gt; output.txt</code></li>
</ul></aside>
<pre class="prettyprint devsite-click-to-copy lang-json" dir="ltr" translate="no">
    {
      "byteItem": {
        "data": "[BASE64-ENCODED-IMAGE]",
        "type": "IMAGE_JPEG"
      },
      "imageRedactionConfigs": [
        {
          "infoType": {
            "name": "US_SOCIAL_SECURITY_NUMBER"
          },
          "redactionColor": {
            "red": 0.3,
            "green": 0.1,
            "blue": 0.6
          }
        },
        {
          "infoType": {
            "name": "EMAIL_ADDRESS"
          },
          "redactionColor": {
            "red": 0.5,
            "blue": 0.5,
            "green": 1
          }
        },
        {
          "infoType": {
            "name": "PHONE_NUMBER"
          },
          "redactionColor": {
            "red": 1,
            "blue": 0,
            "green": 0.6
          }
        }
      ]
    }</pre>
<p>Cloud DLP returns the following:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no">
    {
      "redactedImage": "[BASE64-ENCODED-IMAGE]"
    }</pre>
<p>Decode the base64-encoded image.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-redact-image-colored-infotypes-java" track-metadata-position="dlp-redact-image-colored-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image-colored-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileColoredInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileColoredInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image-colored-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-redact-image-colored-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileColoredInfoTypes.java" data-region-tag="dlp_redact_image_colored_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileColoredInfoTypes.java/HEAD/dlp_redact_image_colored_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.Color;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.RedactImageRequest;
import com.google.privacy.dlp.v2.RedactImageRequest.ImageRedactionConfig;
import com.google.privacy.dlp.v2.RedactImageResponse;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

class RedactImageFileColoredInfoTypes {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "my-project-id";
    String inputPath = "src/test/resources/test.png";
    String outputPath = "redacted.png";
    redactImageFileColoredInfoTypes(projectId, inputPath, outputPath);
  }

  static void redactImageFileColoredInfoTypes(String projectId, String inputPath, String outputPath)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be redacted.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(inputPath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.IMAGE_JPEG).setData(fileBytes).build();

      // Define types of info to redact associate each one with a different color.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      ImageRedactionConfig ssnRedactionConfig =
          ImageRedactionConfig.newBuilder()
              .setInfoType(InfoType.newBuilder().setName("US_SOCIAL_SECURITY_NUMBER").build())
              .setRedactionColor(Color.newBuilder().setRed(.3f).setGreen(.1f).setBlue(.6f).build())
              .build();
      ImageRedactionConfig emailRedactionConfig =
          ImageRedactionConfig.newBuilder()
              .setInfoType(InfoType.newBuilder().setName("EMAIL_ADDRESS").build())
              .setRedactionColor(Color.newBuilder().setRed(.5f).setGreen(.5f).setBlue(1).build())
              .build();
      ImageRedactionConfig phoneRedactionConfig =
          ImageRedactionConfig.newBuilder()
              .setInfoType(InfoType.newBuilder().setName("PHONE_NUMBER").build())
              .setRedactionColor(Color.newBuilder().setRed(1).setGreen(0).setBlue(.6f).build())
              .build();

      // Create collection of all redact configurations.
      List&lt;ImageRedactionConfig&gt; imageRedactionConfigs =
          Arrays.asList(ssnRedactionConfig, emailRedactionConfig, phoneRedactionConfig);

      // List types of info to search for.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addAllInfoTypes(
                  imageRedactionConfigs.stream()
                      .map(ImageRedactionConfig::getInfoType)
                      .collect(Collectors.toList()))
              .build();

      // Construct the Redact request to be sent by the client.
      RedactImageRequest request =
          RedactImageRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setByteItem(byteItem)
              .addAllImageRedactionConfigs(imageRedactionConfigs)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      RedactImageResponse response = dlp.redactImage(request);

      // Parse the response and process results.
      FileOutputStream redacted = new FileOutputStream(outputPath);
      redacted.write(response.getRedactedImage().toByteArray());
      redacted.close();
      System.out.println("Redacted image written to " + outputPath);
    }
  }
}</code></pre>
</div>
</section>
</div>
<p>The resulting image appears as follows:</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpafter3.jpg">
<img alt="Redacted image, 3 infoTypes color-coded (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpafter3.jpg" title="Redacted image, 3 infoTypes color-coded (click to enlarge)" width="500">
</img></a>
</figure>
<h2 data-text="Redacting all text from an image" id="redacting_all_text_from_an_image">Redacting all text from an image</h2>
<p>Cloud DLP also contains an option to redact all detected text in
an image.</p>
<p>To redact all text from an image, submit a request to the DLP API's <code dir="ltr" translate="no">image.redact</code> method. The request must include the following:
     * The image.
     * The <code dir="ltr" translate="no">redactAllText</code> option set to <code dir="ltr" translate="no">true</code>.</p>
<p>Consider the original image from the first section. To redact all text, send the
following JSON to the DLP API's
<a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">image.redact</code></a> method:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-redact-image-all-text-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-redact-image-all-text-protocol" track-metadata-position="dlp-redact-image-all-text" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<aside class="important"><strong>Important:</strong> Before sending this
  request, use a base64 utility to encode the image into ASCII text data, and
  then replace the <code dir="ltr" translate="no">[BASE64-ENCODED-IMAGE]</code> placeholder with the
  base64-encoded text. Most development environments contain a native
  <code dir="ltr" translate="no">base64</code> utility. To encode an image file:
  <ul>
<li>Linux: <code dir="ltr" translate="no">base64 input.jpg &gt; output.txt</code></li>
<li>macOS: <code dir="ltr" translate="no">base64 -i input.jpg -o output.txt</code></li>
<li>Windows: <code dir="ltr" translate="no">C:&gt; Base64.exe -e input.jpg &gt; output.txt</code></li>
<li>PowerShell: <code dir="ltr" translate="no">[Convert]::ToBase64String([IO.File]::ReadAllBytes("./input.jpg")) &gt; output.txt</code></li>
</ul></aside>
<pre class="prettyprint devsite-click-to-copy lang-json" dir="ltr" translate="no">
    {
      "byteItem": {
        "data": "[BASE64-ENCODED-IMAGE]",
        "type": "IMAGE_JPEG"
      },
      "imageRedactionConfigs": [
        {
          "redactAllText": true
        }
      ]
    }</pre>
<p>Cloud DLP returns the following:</p>
<pre class="prettyprint lang-json" dir="ltr" translate="no">
    {
      "redactedImage": "[BASE64-ENCODED-IMAGE]"
    }</pre>
<p>Decode the base64-encoded image.</p>
</section>
<section>
<h3 data-text="Python" id="dlp-redact-image-all-text-python" track-metadata-position="dlp-redact-image-all-text" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image-all-text" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/redact.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/redact.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image-all-text" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-redact-image-all-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/redact.py" data-region-tag="dlp_redact_image_all_text" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/redact.py/HEAD/dlp_redact_image_all_text" translate="no"><code dir="ltr" translate="no">

def redact_image_all_text(
    project,
    filename,
    output_filename,
):
    """Uses the Data Loss Prevention API to redact all text in an image.

    Args:
        project: The Google Cloud project id to use as a parent resource.
        filename: The path to the file to inspect.
        output_filename: The path to which the redacted image will be written.

    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Construct the image_redaction_configs, indicating to DLP that all text in
    # the input image should be redacted.
    image_redaction_configs = [{"redact_all_text": True}]

    # Construct the byte_item, containing the file's byte data.
    with open(filename, mode="rb") as f:
        byte_item = {"type_": google.cloud.dlp_v2.FileType.IMAGE, "data": f.read()}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.redact_image(
        request={
            "parent": parent,
            "image_redaction_configs": image_redaction_configs,
            "byte_item": byte_item,
        }
    )

    # Write out the results.
    with open(output_filename, mode="wb") as f:
        f.write(response.redacted_image)

    print(
        "Wrote {byte_count} to {filename}".format(
            byte_count=len(response.redacted_image), filename=output_filename
        )
    )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Java" id="dlp-redact-image-all-text-java" track-metadata-position="dlp-redact-image-all-text" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image-all-text" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllText.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllText.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image-all-text" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-redact-image-all-text" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllText.java" data-region-tag="dlp_redact_image_all_text" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RedactImageFileAllText.java/HEAD/dlp_redact_image_all_text" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.RedactImageRequest;
import com.google.privacy.dlp.v2.RedactImageRequest.ImageRedactionConfig;
import com.google.privacy.dlp.v2.RedactImageResponse;
import com.google.protobuf.ByteString;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

class RedactImageFileAllText {

  public static void main(String[] args) throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "my-project-id";
    String inputPath = "src/test/resources/sensitive-data-image.jpeg";
    String outputPath = "sensitive-data-image-redacted.jpeg";
    redactImageFileAllText(projectId, inputPath, outputPath);
  }

  static void redactImageFileAllText(String projectId, String inputPath, String outputPath)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be redacted.
      ByteString fileBytes = ByteString.readFrom(new FileInputStream(inputPath));
      ByteContentItem byteItem =
          ByteContentItem.newBuilder().setType(BytesType.IMAGE_JPEG).setData(fileBytes).build();

      // Enable redaction of all text.
      ImageRedactionConfig imageRedactionConfig =
          ImageRedactionConfig.newBuilder().setRedactAllText(true).build();

      // Construct the Redact request to be sent by the client.
      // Do not specify the type of info to redact.
      RedactImageRequest request =
          RedactImageRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setByteItem(byteItem)
              .addImageRedactionConfigs(imageRedactionConfig)
              .build();

      // Use the client to send the API request.
      RedactImageResponse response = dlp.redactImage(request);

      // Parse the response and process results.
      FileOutputStream redacted = new FileOutputStream(outputPath);
      redacted.write(response.getRedactedImage().toByteArray());
      redacted.close();
      System.out.println("Redacted image written to " + outputPath);
    }
  }
}</code></pre>
</div>
</section>
</div>
<p>The API returns the same image(s) you gave it, but any text identified as
containing sensitive information according to your criteria has been redacted.</p>
<p>The resulting image appears as follows:</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpafter4.jpg">
<img alt="Redacted image, all text (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpafter4.jpg" title="Redacted image, all text (click to enlarge)" width="500">
</img></a>
</figure>
<h2 data-text="Code examples" id="code_examples">Code examples</h2>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to redact sensitive text from an image.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-redact-image-code-sample">
<section>
<h3 data-text="Node.js" id="dlp-redact-image-nodejs" track-metadata-position="dlp-redact-image" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/redactImage.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/redactImage.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-redact-image" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/redactImage.js" data-region-tag="dlp_redact_image" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/redactImage.js/HEAD/dlp_redact_image" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Imports required Node.js libraries
const mime = require('mime');
const fs = require('fs');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The path to a local file to inspect. Can be a JPG or PNG image file.
// const filepath = 'path/to/image.png';

// The minimum likelihood required before redacting a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The infoTypes of information to redact
// const infoTypes = [{ name: 'EMAIL_ADDRESS' }, { name: 'PHONE_NUMBER' }];

// The local path to save the resulting image to.
// const outputPath = 'result.png';
async function redactImage() {
  const imageRedactionConfigs = infoTypes.map(infoType =&gt; {
    return {infoType: infoType};
  });

  // Load image
  const fileTypeConstant =
    ['image/jpeg', 'image/bmp', 'image/png', 'image/svg'].indexOf(
      mime.getType(filepath)
    ) + 1;
  const fileBytes = Buffer.from(fs.readFileSync(filepath)).toString('base64');

  // Construct image redaction request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    byteItem: {
      type: fileTypeConstant,
      data: fileBytes,
    },
    inspectConfig: {
      minLikelihood: minLikelihood,
      infoTypes: infoTypes,
    },
    imageRedactionConfigs: imageRedactionConfigs,
  };

  // Run image redaction request
  const [response] = await dlp.redactImage(request);
  const image = response.redactedImage;
  fs.writeFileSync(outputPath, image);
  console.log(`Saved image redaction results to path: ${outputPath}`);
}
redactImage();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-redact-image-python" track-metadata-position="dlp-redact-image" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/redact.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/redact.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-redact-image" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/redact.py" data-region-tag="dlp_redact_image" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/redact.py/HEAD/dlp_redact_image" translate="no"><code dir="ltr" translate="no">import mimetypes



def redact_image(
    project,
    filename,
    output_filename,
    info_types,
    min_likelihood=None,
    mime_type=None,
):
    """Uses the Data Loss Prevention API to redact protected data in an image.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        filename: The path to the file to inspect.
        output_filename: The path to which the redacted image will be written.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        mime_type: The MIME type of the file. If not specified, the type is
            inferred via the Python standard library's mimetypes module.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Prepare image_redaction_configs, a list of dictionaries. Each dictionary
    # contains an info_type and optionally the color used for the replacement.
    # The color is omitted in this sample, so the default (black) will be used.
    image_redaction_configs = []

    if info_types is not None:
        for info_type in info_types:
            image_redaction_configs.append({"info_type": info_type})

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "min_likelihood": min_likelihood,
        "info_types": info_types,
    }

    # If mime_type is not specified, guess it from the filename.
    if mime_type is None:
        mime_guess = mimetypes.MimeTypes().guess_type(filename)
        mime_type = mime_guess[0] or "application/octet-stream"

    # Select the content type index from the list of supported types.
    supported_content_types = {
        None: 0,  # "Unspecified"
        "image/jpeg": 1,
        "image/bmp": 2,
        "image/png": 3,
        "image/svg": 4,
        "text/plain": 5,
    }
    content_type_index = supported_content_types.get(mime_type, 0)

    # Construct the byte_item, containing the file's byte data.
    with open(filename, mode="rb") as f:
        byte_item = {"type_": content_type_index, "data": f.read()}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.redact_image(
        request={
            "parent": parent,
            "inspect_config": inspect_config,
            "image_redaction_configs": image_redaction_configs,
            "byte_item": byte_item,
        }
    )

    # Write out the results.
    with open(output_filename, mode="wb") as f:
        f.write(response.redacted_image)
    print(
        "Wrote {byte_count} to {filename}".format(
            byte_count=len(response.redacted_image), filename=output_filename
        )
    )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-redact-image-go" track-metadata-position="dlp-redact-image" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/redact/redact.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/redact/redact.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-redact-image" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/redact/redact.go" data-region-tag="dlp_redact_image" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/redact/redact.go/HEAD/dlp_redact_image" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"io/ioutil"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// redactImage blacks out the identified portions of the input image (with type bytesType)
// and stores the result in outputPath.
func redactImage(w io.Writer, projectID string, infoTypeNames []string, bytesType dlppb.ByteContentItem_BytesType, inputPath, outputPath string) error {
	// projectID := "my-project-id"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// bytesType := dlppb.ByteContentItem_IMAGE_PNG
	// inputPath := /tmp/input
	// outputPath := /tmp/output

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}

	// Convert the info type strings to a list of types to redact in the image.
	var redactInfoTypes []*dlppb.RedactImageRequest_ImageRedactionConfig
	for _, it := range infoTypeNames {
		redactInfoTypes = append(redactInfoTypes, &amp;dlppb.RedactImageRequest_ImageRedactionConfig{
			Target: &amp;dlppb.RedactImageRequest_ImageRedactionConfig_InfoType{
				InfoType: &amp;dlppb.InfoType{Name: it},
			},
		})
	}

	// Read the input file.
	b, err := ioutil.ReadFile(inputPath)
	if err != nil {
		return fmt.Errorf("ioutil.ReadFile: %v", err)
	}

	// Create a configured request.
	req := &amp;dlppb.RedactImageRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes:     infoTypes,
			MinLikelihood: dlppb.Likelihood_POSSIBLE,
		},
		// The item to analyze.
		ByteItem: &amp;dlppb.ByteContentItem{
			Type: bytesType,
			Data: b,
		},
		ImageRedactionConfigs: redactInfoTypes,
	}
	// Send the request.
	resp, err := client.RedactImage(ctx, req)
	if err != nil {
		return fmt.Errorf("RedactImage: %v", err)
	}
	// Write the output file.
	if err := ioutil.WriteFile(outputPath, resp.GetRedactedImage(), 0644); err != nil {
		return fmt.Errorf("ioutil.WriteFile: %v", err)
	}
	fmt.Fprintf(w, "Wrote output to %s", outputPath)
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-redact-image-php" track-metadata-position="dlp-redact-image" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/redact_image.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/redact_image.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-redact-image" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/redact_image.php" data-region-tag="dlp_redact_image" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/redact_image.php/HEAD/dlp_redact_image" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\RedactImageRequest\ImageRedactionConfig;
use Google\Cloud\Dlp\V2\Likelihood;
use Google\Cloud\Dlp\V2\ByteContentItem;

/**
 * Redact sensitive data from an image.
 *
 * @param string $callingProjectId    The project ID to run the API call under
 * @param string $imagePath           The local filepath of the image to inspect
 * @param string $outputPath          The local filepath to save the resulting image to
 */
function redact_image(
    string $callingProjectId,
    string $imagePath,
    string $outputPath
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // The infoTypes of information to match
    $phoneNumberInfoType = (new InfoType())
        -&gt;setName('PHONE_NUMBER');
    $infoTypes = [$phoneNumberInfoType];

    // The minimum likelihood required before returning a match
    $minLikelihood = likelihood::LIKELIHOOD_UNSPECIFIED;

    // Whether to include the matching string in the response
    $includeQuote = true;

    // Create the configuration object
    $inspectConfig = (new InspectConfig())
        -&gt;setMinLikelihood($minLikelihood)
        -&gt;setInfoTypes($infoTypes);

    // Read image file into a buffer
    $imageRef = fopen($imagePath, 'rb');
    $imageBytes = fread($imageRef, filesize($imagePath));
    fclose($imageRef);

    // Get the image's content type
    $typeConstant = (int) array_search(
        mime_content_type($imagePath),
        [false, 'image/jpeg', 'image/bmp', 'image/png', 'image/svg']
    );

    // Create the byte-storing object
    $byteContent = (new ByteContentItem())
        -&gt;setType($typeConstant)
        -&gt;setData($imageBytes);

    // Create the image redaction config objects
    $imageRedactionConfigs = [];
    foreach ($infoTypes as $infoType) {
        $config = (new ImageRedactionConfig())
            -&gt;setInfoType($infoType);
        $imageRedactionConfigs[] = $config;
    }

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;redactImage([
        'parent' =&gt; $parent,
        'inspectConfig' =&gt; $inspectConfig,
        'byteItem' =&gt; $byteContent,
        'imageRedactionConfigs' =&gt; $imageRedactionConfigs
    ]);

    // Save result to file
    file_put_contents($outputPath, $response-&gt;getRedactedImage());

    // Print completion message
    print('Redacted image saved to ' . $outputPath . PHP_EOL);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-redact-image-csharp" track-metadata-position="dlp-redact-image" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact-image" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RedactImage.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RedactImage.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact-image" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-redact-image" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RedactImage.cs" data-region-tag="redact_image" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RedactImage.cs/HEAD/redact_image" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;
using System;
using System.IO;

public class RedactImage
{
    public static RedactImageResponse Redact(string projectId, string originalImagePath, string redactedImagePath)
    {
        var request = new RedactImageRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectConfig = new InspectConfig
            {
                MinLikelihood = Likelihood.Likely,
                Limits = new InspectConfig.Types.FindingLimits() { MaxFindingsPerItem = 5 },
                IncludeQuote = true,
                InfoTypes =
                    {
                        new InfoType { Name = "PHONE_NUMBER" },
                        new InfoType { Name = "EMAIL_ADDRESS" }
                    }
            },
            ByteItem = new ByteContentItem
            {
                Type = ByteContentItem.Types.BytesType.ImagePng,
                Data = ByteString.FromStream(new FileStream(originalImagePath, FileMode.Open))
            },
        };

        var client = DlpServiceClient.Create();
        var response = client.RedactImage(request);

        Console.WriteLine($"Extracted text: {response.ExtractedText}");

        // Writes redacted image into file
        response.RedactedImage.WriteTo(new FileStream(redactedImagePath, FileMode.Create, FileAccess.Write));

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Try it out" id="try_it_out">Try it out</h2>
<p>You can try out each of the examples on this page yourselfâor experiment
with your own imagesâin the APIs Explorer on the reference page for
<code dir="ltr" translate="no">image.redact</code>:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.image/redact?apix=true">Go to APIs Explorer</a> </p>
<aside class="note"><strong>Tip:</strong> For experiments with non-sensitive
  materials, it's sufficient to uncheck <strong>Google OAuth 2.0</strong> and
  enter <code dir="ltr" translate="no">projects/testff</code> in the <strong>parent</strong>
  field.</aside>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/dlp/docs/concepts-image-redaction">image inspection and redaction</a>.</li>
<li>Learn how to <a href="/dlp/docs/inspecting-images">inspect images for sensitive data</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/create-wrapped-key]</H1></p><div class="devsite-article-body clearfix">
<meta content="Create a wrapped key for the purpose of
                                  de-identifying and re-identifying content." name="description"/>
<p>This page describes how to use Cloud Key Management Service (Cloud KMS) to create a
wrapped key that you can
then use to send <a href="/dlp/docs/reference/rest/v2/projects.locations.content/deidentify"><code dir="ltr" translate="no">deidentify</code></a>
and <a href="/dlp/docs/reference/rest/v2/projects.locations.content/reidentify"><code dir="ltr" translate="no">reidentify</code></a>
requests to the Cloud Data Loss Prevention API.</p>
<p>The process of using a cryptographic key to de-identify and re-identify content
is called <em>pseudonymization</em> (or <em>tokenization</em>). For conceptual information on
this process, see <a href="/dlp/docs/pseudonymization">Pseudonymization</a>.</p>
<p>For an end-to-end example that
demonstrates how to create a wrapped key, tokenize content, and re-identify
tokenized content, see <a href="/dlp/docs/inspect-sensitive-text-de-identify">Quickstart: De-identifying and re-identifying sensitive
text</a> instead.</p>
<p>You can complete the steps in this topic in 5 to 10 minutes, not including the
<a href="/dlp/docs/create-wrapped-key#before-you-begin">Before you begin</a> steps.</p>
<p><aside class="special"><strong>Note:</strong> When you use
  Cloud KMS for cryptographic operations,
  <a href="https://cloud.google.com/kms/pricing">charges apply</a>.</aside></p>
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
        
          
            
              Enable the Cloud DLP and Cloud KMS APIs.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com,cloudkms.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the APIs</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
        
          
            
              Enable the Cloud DLP and Cloud KMS APIs.
            
          
        
      </p><p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com,cloudkms.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Enable the APIs</a></p>
</li>
<style>
  .henhouse-text {
    font-size:85%;
    padding:2px 4px;
    line-height:1;
  }
</style>
<li>
<p>
    Create a service account:
  </p>
<ol>
<li>
<p>
        In the Cloud console, go to the <b>Create service account</b> page.
      </p>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts/create?supportedpurview=project" target="console" track-metadata-position="body" track-name="consoleLink" track-type="quickstart">Go to Create service account</a>
</li>
<li>
      Select your project.
    </li>
<li>
<p>
        In the <b>Service account name</b> field, enter a name. The Cloud console fills
        in the <b>Service account ID</b> field based on this name.
      </p>
<p>
        In the <b>Service account description</b> field, enter a description. For example,
        <code dir="ltr" translate="no">Service account for quickstart</code>.
      </p>
</li>
<li>
      Click <b>Create and continue</b>.
    </li>
<li>
<p>To provide access to your project, grant the following role(s) to your
          service account: <b>Project &gt; Owner</b>.
        </p>
<p>
          In the <b>Select a role</b> list, select a role.
        </p>
<p>
          For additional roles, click <span aria-hidden="true" class="material-icons" translate="no">add</span> <b>Add another
          role</b> and add each additional role.
        </p>
<aside class="note">
<b>Note</b>: The <b>Role</b> field affects which resources your service account can access in your
  project. You can revoke these roles or grant additional roles later. In production environments,
  do not grant the Owner, Editor, or Viewer roles. Instead, grant a
  <a href="/iam/docs/understanding-roles#predefined_roles">predefined role</a> or
  <a href="/iam/docs/understanding-custom-roles">custom role</a> that meets your needs.
</aside>
</li>
<li>
        Click <b>Continue</b>.
      </li>
<li>
<p>
        Click <b>Done</b> to finish creating the service account.
      </p>
<p>
    Do not close your browser window. You will use it in the next step.
  </p>
</li>
</ol>
</li>
<li>
<p>
    Create a service account key:
  </p>
<ol>
<li>
        In the Cloud console, click the email address for the service account that you
        created.
      </li>
<li>
        Click <b>Keys</b>.
      </li>
<li>
        Click <b>Add key</b>, and then click <b>Create new key</b>.
      </li>
<li>
        Click <b>Create</b>. A JSON key file is downloaded to your computer.
      </li>
<li>
        Click <b>Close</b>.
      </li>
</ol>
</li>
<li>
<p>
    Set the environment variable <code dir="ltr" translate="no">GOOGLE_APPLICATION_CREDENTIALS</code>
    to the path of the JSON file that contains your service account key.
    This variable only applies to your current shell session, so if you open
    a new session, set the variable again.
  </p>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Linux or macOS</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">export GOOGLE_APPLICATION_CREDENTIALS="/home/user/Downloads/service-account-file.json"</pre>
</section>
<section class="expandable">
<p class="showalways"><strong>Example:</strong> Windows</p>
<p>For PowerShell:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code>"</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
<p>For example:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">$env:GOOGLE_APPLICATION_CREDENTIALS="C:\Users\username\Downloads\service-account-file.json"</pre>
<p>For command prompt:</p>
<pre class="prettyprint lang-sh" dir="ltr" translate="no">set GOOGLE_APPLICATION_CREDENTIALS=<code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">KEY_PATH</var></code> with the path of the JSON file that contains your service account key.</p>
</section>
</li>
<li>
<a href="/sdk/docs/install" target="_blank" track-name="sdkLink" track-type="commonIncludes">Install</a> and <a href="/sdk/docs/initializing" target="_blank" track-name="sdkLink" track-type="commonIncludes">initialize</a> the Google Cloud CLI.

  

  
  
  
    </li>
</slot>
</cloudx-free-trial-eligible-content>
</ol>
<h2 data-text="Step 1: Create a key ring and a key" id="create-kms-key">Step 1: Create a key ring and a key</h2>
<p>Before you start this procedure, decide where you want Cloud DLP
to process your de-identification and re-identification requests. When you
create a Cloud KMS key, you must store it in either <code dir="ltr" translate="no">global</code> or in the
same region that you will use for your Cloud DLP requests.
Otherwise, the Cloud DLP requests will fail.</p>
<p>You can find a list of supported locations in
<a href="/dlp/docs/locations">Cloud DLP locations</a>. Take note of the name
of your chosen region (for example, <code dir="ltr" translate="no">us-west1</code>).</p>
<p>This procedure uses <code dir="ltr" translate="no">global</code> as the location for all API requests. If you want
to use a different region, replace <code dir="ltr" translate="no">global</code> with the region name.</p>
<ol>
<li><p>Create a key ring:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keyrings create "dlp-keyring" \
    --location "global"
</code></pre></li>
<li><p>Create a key:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys create "dlp-key" \
    --location "global" \
    --keyring "dlp-keyring" \
    --purpose "encryption"
</code></pre></li>
<li><p>List your key ring and key:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud kms keys list \
    --location "global" \
    --keyring "dlp-keyring"
</code></pre>
<p>You get the following output:</p>
<pre dir="ltr" translate="no">
NAME                                                                                   PURPOSE          ALGORITHM                    PROTECTION_LEVEL  LABELS  PRIMARY_ID  PRIMARY_STATE
projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key  ENCRYPT_DECRYPT  GOOGLE_SYMMETRIC_ENCRYPTION  SOFTWARE                  1           ENABLED
</pre>
<p>In this output, <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> is the ID of your project.</p>
<p>The path under <code dir="ltr" translate="no">NAME</code> is the full resource name of your Cloud KMS
key. Take note of it because the de-identify and re-identify requests
require it.</p></li>
</ol>
<h2 data-text="Step 2: Create a base64-encoded AES key" id="create-base64-key">Step 2: Create a base64-encoded AES key</h2>
<p>This section describes how to create an Advanced Encryption Standard (AES) key
and encode it in base64 format.</p>
<aside class="note"><strong>Note:</strong><span> These steps use the <code dir="ltr" translate="no">openssl</code> and <code dir="ltr" translate="no">base64</code> commands, but there are
<a href="/storage/docs/encryption/using-customer-supplied-keys#generate-csek">many other ways</a>
to perform this task.</span></aside>
<ol>
<li><p>Create a 128-, 192-, or 256-bit AES key. The following command uses <code dir="ltr" translate="no">openssl</code>
to create a 256-bit key in the current directory:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">openssl rand -out "./aes_key.bin" 32
</code></pre>
<p>The file <code dir="ltr" translate="no">aes_key.bin</code> is added to your current directory.</p></li>
<li><p>Encode the AES key as a base64 string:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">base64 -i ./aes_key.bin
</code></pre>
<p>You get an output similar to the following:</p>
<pre dir="ltr" translate="no">
uEDo6/yKx+zCg2cZ1DBwpwvzMVNk/c+jWs7OwpkMc/s=
</pre>
<aside class="warning"><strong>Warning:</strong><span> Do not use this example key to protect actual sensitive workloads.
This key is provided only to serve as an example. Because it's shared here,
this key is not safe to use.</span></aside></li>
</ol>
<h2 data-text="Step 3: Wrap the AES key using the Cloud KMS key" id="wrap-aes-key">Step 3: Wrap the AES key using the Cloud KMS key</h2>
<p>This section describes how to use the Cloud KMS key that you created
in <a href="#create-kms-key">Step 1</a> to wrap the
base64-encoded AES key that you created in <a href="#create-base64-key">Step 2</a>.</p>
<p>To wrap the AES key, use <code dir="ltr" translate="no">curl</code> to send the following request to the
Cloud KMS API
<a href="/kms/docs/reference/rest/v1/projects.locations.keyRings.cryptoKeys/encrypt"><code dir="ltr" translate="no">projects.locations.keyRings.cryptoKeys.encrypt</code></a>:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">curl "https://cloudkms.googleapis.com/v1/projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key:encrypt" \
  --request "POST" \
  --header "Authorization:Bearer $(gcloud auth application-default print-access-token)" \
  --header "content-type: application/json" \
  --data "{\"plaintext\": \"<var translate="no">BASE64_ENCODED_AES_KEY</var>\"}"
</code></pre>
<p>Replace the following:</p>
<ul>
<li><code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>: the <a href="/resource-manager/docs/creating-managing-projects#before_you_begin">ID of your project</a>.</li>
<li><code dir="ltr" translate="no"><var translate="no">BASE64_ENCODED_AES_KEY</var></code>: the base64-encoded string
returned in <a href="#create-base64-key">Step 2</a>.</li>
</ul>
<p>The response that you get from Cloud KMS is similar to the following
JSON:</p>
<pre dir="ltr" translate="no">
{
  "name": "projects/<var translate="no">PROJECT_ID</var>/locations/global/keyRings/dlp-keyring/cryptoKeys/dlp-key/cryptoKeyVersions/1",
  "ciphertext": "CiQAYuuIGo5DVaqdE0YLioWxEhC8LbTmq7Uy2G3qOJlZB7WXBw0SSQAjdwP8ZusZJ3Kr8GD9W0vaFPMDksmHEo6nTDaW/j5sSYpHa1ym2JHk+lUgkC3Zw5bXhfCNOkpXUdHGZKou1893O8BDby/82HY=",
  "ciphertextCrc32c": "901327763",
  "protectionLevel": "SOFTWARE"
}
</pre>
<p>In this output, <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> is the ID of your project.</p>
<p>Take note of the value of <code dir="ltr" translate="no">ciphertext</code> in the response that you get.
That is your wrapped key.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><p>Learn more about <a href="/dlp/docs/pseudonymization">tokenizing data through a cryptographic key</a>.</p></li>
<li><p>Work through an end-to-end example that demonstrates how to <a href="/dlp/docs/inspect-sensitive-text-de-identify">create a wrapped
key, tokenize content, and re-identify tokenized content</a>.</p></li>
<li><p>Learn more about <a href="/dlp/docs/transformations-reference#crypto">de-identification methods that accept this wrapped key,
and look through code samples</a>.</p></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-templates-deid]</H1></p><div class="devsite-article-body clearfix">
<div class="video-wrapper">
<iframe allowfullscreen="" class="devsite-embedded-youtube-video" data-autohide="1" data-showinfo="0" data-video-id="lf9qwP0rhUk" frameborder="0">
</iframe>
</div>
<p>You can use <em>templates</em> to create and persist configuration information to use
with Cloud Data Loss Prevention. Templates are useful for decoupling configuration
such as what you inspect for and how you de-identify it from the
implementation of your requests. Templates provide a robust way to re-use
configuration and enable consistency across users and data sets.</p>
<p>The Cloud DLP supports two types of templates:</p>
<ul>
<li><em>De-identification templates</em>: Templates for saving configuration
information for de-identification jobs, including both infoType and
record (structured dataset) transformations.</li>
<li><em>Inspection templates</em>: Templates for persisting configuration information
for inspection scan jobs, including what predefined or custom detectors to
use. For more information about inspection templates, see <a href="/dlp/docs/creating-templates">Creating
Cloud DLP inspection templates</a>.</li>
</ul>
<p>For conceptual information about templates in Cloud DLP, see
<a href="/dlp/docs/concepts-templates">Templates</a>.</p>
<p>The remainder of this topic shows you how to create de-identification templates
for use with the Cloud DLP.</p>
<h2 data-text="Create a de-identification template" id="create_a_de-identification_template">Create a de-identification template</h2>
<p>Itâs useful to note that a de-identification template is simply a reusable
de-identification configuration plus some metadata. In API terms, the
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#resource-deidentifytemplate"><code dir="ltr" translate="no">DeidentifyTemplate</code></a>
object is effectively a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>
object that includes a few more fields of metadata, such as a display name and
a description. Therefore, to create a new de-identification template, the basic
steps are:</p>
<ol>
<li>Start with a
 <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>
 object.</li>
<li>Call or POST the <code dir="ltr" translate="no">create</code> method of the
 <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates"><code dir="ltr" translate="no">projects.deidentifyTemplates</code></a>
 resource, including in your request a
 <a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#resource-deidentifytemplate"><code dir="ltr" translate="no">DeidentifyTemplate</code></a>
 object that contains a display name, a description, and that
 <code dir="ltr" translate="no">DeidentifyConfig</code> object.</li>
</ol>
<p>The returned <code dir="ltr" translate="no">DeidentifyTemplate</code> will be usable immediately. You can
reference it in other calls or jobs by its <code dir="ltr" translate="no">name</code>. You can list the existing
templates by calling the <code dir="ltr" translate="no">*.deidentifyTemplates.list</code> method. To view a
specific template, call the <code dir="ltr" translate="no">*.deidentifyTemplates.get</code> method. Note that the
limit for the number of templates you can create is 1000.</p>
<p>If you've already had some experience de-identifying sensitive data from text,
images, or structured content using Cloud DLP, you've already
created a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>
object. One additional step turns it into a
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates#resource-deidentifytemplate"><code dir="ltr" translate="no">DeidentifyTemplate</code></a>
object.</p>
<h3 data-text="REST example" id="rest_example">REST example</h3>
<p>The following JSON is an example of what you could send to the
<a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/create"><code dir="ltr" translate="no">projects.deidentifyTemplates.create</code></a>
method. This JSON creates a new template with the given display name and
description, and scans for matches on the infoTypes <code dir="ltr" translate="no">EMAIL_ADDRESS</code> and
<code dir="ltr" translate="no">GENERIC_ID</code>. When it finds content matching those infoTypes, it will mask the
first three characters with an asterisk (<code dir="ltr" translate="no">*</code>) character.</p>
<aside class="note"><strong>Note:</strong><span> The following example requires an
<a href="/dlp/docs/auth#using_a_service_account">OAuth 2.0 access token</a>.</span></aside>
<p><strong>HTTP method and URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/deidentifyTemplates
</code></pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the <a href="/resource-manager/docs/creating-managing-projects#before_you_begin">project ID</a>.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "deidentifyTemplate":{
    "displayName":"Email and id masker",
    "description":"De-identifies emails and ids with a series of asterisks.",
    "deidentifyConfig":{
      "infoTypeTransformations":{
        "transformations":[
          {
            "infoTypes":[
              {
                "name":"GENERIC_ID"
              }
            ],
            "primitiveTransformation":{
              "replaceWithInfoTypeConfig":{

              }
            }
          },
          {
            "infoTypes":[
              {
                "name":"EMAIL_ADDRESS"
              }
            ],
            "primitiveTransformation":{
              "characterMaskConfig":{
                "charactersToIgnore":[
                  {
                    "charactersToSkip":"@"
                  }
                ],
                "maskingCharacter":"*"
              }
            }
          }
        ]
      }
    }
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint lang-sh devsite-disable-click-to-copy" dir="ltr" translate="no">
    {
      "name":"projects/<var translate="no">PROJECT_ID</var>/deidentifyTemplates/<var translate="no">JOB-ID</var>",
      "displayName":"Email and id masker",
      "description":"De-identifies emails and ids with a series of asterisks.",
      "createTime":"2018-11-30T07:17:59.536022Z",
      "updateTime":"2018-11-30T07:17:59.536022Z",
      "deidentifyConfig":{
        "infoTypeTransformations":{
          "transformations":[
            {
              "infoTypes":[
                {
                  "name":"GENERIC_ID"
                }
              ],
              "primitiveTransformation":{
                "replaceWithInfoTypeConfig":{

                }
              }
            },
            {
              "infoTypes":[
                {
                  "name":"EMAIL_ADDRESS"
                }
              ],
              "primitiveTransformation":{
                "characterMaskConfig":{
                  "maskingCharacter":"*",
                  "charactersToIgnore":[
                    {
                      "charactersToSkip":"@"
                    }
                  ]
                }
              }
            }
          ]
        }
      }
    }
</pre>
<p>To quickly try this out, you can use the APIs Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.deidentifyTemplates.create"></div>
<h2 data-text="Using de-identification templates" id="using_de-identification_templates">Using de-identification templates</h2>
<p>Once youâve created a new template, you can use its <code dir="ltr" translate="no">name</code> identifier anywhere
<code dir="ltr" translate="no">deidentifyTemplateName</code> is accepted, such as:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">projects.content.deidentify</code></a>:
De-identifies potentially sensitive data in content using the template as its
configuration. Be aware that this method can use either an inspection
template or a de-identification template.</li>
</ul>
<h2 data-text="Listing de-identification templates" id="listing_de-identification_templates">Listing de-identification templates</h2>
<p>To list all de-identification templates that have been created, use one of the
<code dir="ltr" translate="no">*.*.list</code> methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/list"><code dir="ltr" translate="no">projects.deidentifyTemplates.list</code></a></li>
</ul>
<h3 data-text="Code examples" id="code_examples">Code examples</h3>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to list inspection templates. The process is
identical to the one for listing de-identification templates.<!-- For
information about the parameters included with the request, see
[Configuring storage inspection](#configuring-storage-inspection),
later in this topic.--></p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-list-templates-code-sample">
<section>
<h3 data-text="Java" id="dlp-list-templates-java" track-metadata-position="dlp-list-templates" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesList.java/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.dlp.v2.DlpServiceClient.ListInspectTemplatesPagedResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectTemplate;
import com.google.privacy.dlp.v2.ListInspectTemplatesRequest;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;

class TemplatesList {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    listInspectTemplates(projectId);
  }

  // Lists all templates associated with a given project
  public static void listInspectTemplates(String projectId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Create the request to be sent by the client
      ListInspectTemplatesRequest request =
          ListInspectTemplatesRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setPageSize(1)
              .build();

      // Send the request
      ListInspectTemplatesPagedResponse response = dlpServiceClient.listInspectTemplates(request);

      // Parse through and process the response
      System.out.println("Templates found:");
      for (InspectTemplate template : response.getPage().getResponse().getInspectTemplatesList()) {
        System.out.printf("Template name: %s\n", template.getName());
        if (template.getDisplayName() != null) {
          System.out.printf("\tDisplay name: %s \n", template.getDisplayName());
          System.out.printf("\tCreate time: %s \n", template.getCreateTime());
          System.out.printf("\tUpdate time: %s \n", template.getUpdateTime());

          // print inspection config
          InspectConfig inspectConfig = template.getInspectConfig();
          for (InfoType infoType : inspectConfig.getInfoTypesList()) {
            System.out.printf("\tInfoType: %s\n", infoType.getName());
          }
          System.out.printf("\tMin likelihood: %s\n", inspectConfig.getMinLikelihood());
          System.out.printf("\tLimits: %s\n", inspectConfig.getLimits().getMaxFindingsPerRequest());
        }
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-list-templates-nodejs" track-metadata-position="dlp-list-templates" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listInspectTemplates.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listInspectTemplates.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/listInspectTemplates.js" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/listInspectTemplates.js/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// Helper function to pretty-print dates
const formatDate = date =&gt; {
  const msSinceEpoch = parseInt(date.seconds, 10) * 1000;
  return new Date(msSinceEpoch).toLocaleString('en-US');
};

async function listInspectTemplates() {
  // Construct template-listing request
  const request = {
    parent: `projects/${projectId}/locations/global`,
  };

  // Run template-deletion request
  const [templates] = await dlp.listInspectTemplates(request);

  templates.forEach(template =&gt; {
    console.log(`Template ${template.name}`);
    if (template.displayName) {
      console.log(`  Display name: ${template.displayName}`);
    }

    console.log(`  Created: ${formatDate(template.createTime)}`);
    console.log(`  Updated: ${formatDate(template.updateTime)}`);

    const inspectConfig = template.inspectConfig;
    const infoTypes = inspectConfig.infoTypes.map(x =&gt; x.name);
    console.log('  InfoTypes:', infoTypes.join(' '));
    console.log('  Minimum likelihood:', inspectConfig.minLikelihood);
    console.log('  Include quotes:', inspectConfig.includeQuote);

    const limits = inspectConfig.limits;
    console.log('  Max findings per request:', limits.maxFindingsPerRequest);
  });
}

listInspectTemplates();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-list-templates-python" track-metadata-position="dlp-list-templates" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/templates.py" data-region-tag="dlp_list_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/templates.py/HEAD/dlp_list_templates" translate="no"><code dir="ltr" translate="no">def list_inspect_templates(project):
    """Lists all Data Loss Prevention API inspect templates.
    Args:
        project: The Google Cloud project id to use as a parent resource.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.list_inspect_templates(request={"parent": parent})

    for template in response:
        print("Template {}:".format(template.name))
        if template.display_name:
            print("  Display Name: {}".format(template.display_name))
        print("  Created: {}".format(template.create_time))
        print("  Updated: {}".format(template.update_time))

        config = template.inspect_config
        print(
            "  InfoTypes: {}".format(", ".join([it.name for it in config.info_types]))
        )
        print("  Minimum likelihood: {}".format(config.min_likelihood))
        print("  Include quotes: {}".format(config.include_quote))
        print(
            "  Max findings per request: {}".format(
                config.limits.max_findings_per_request
            )
        )

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-list-templates-go" track-metadata-position="dlp-list-templates" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/list.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/list.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/template/list.go" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/template/list.go/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"github.com/golang/protobuf/ptypes"
	"google.golang.org/api/iterator"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// listInspectTemplates lists the inspect templates in the project.
func listInspectTemplates(w io.Writer, projectID string) error {
	// projectID := "my-project-id"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Create a configured request.
	req := &amp;dlppb.ListInspectTemplatesRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
	}

	// Send the request and iterate over the results.
	it := client.ListInspectTemplates(ctx, req)
	for {
		t, err := it.Next()
		if err == iterator.Done {
			break
		}
		if err != nil {
			return fmt.Errorf("Next: %v", err)
		}
		fmt.Fprintf(w, "Inspect template %v\n", t.GetName())
		c, err := ptypes.Timestamp(t.GetCreateTime())
		if err != nil {
			return fmt.Errorf("CreateTime Timestamp: %v", err)
		}
		fmt.Fprintf(w, "  Created: %v\n", c.Format(time.RFC1123))
		u, err := ptypes.Timestamp(t.GetUpdateTime())
		if err != nil {
			return fmt.Errorf("UpdateTime Timestamp: %v", err)
		}
		fmt.Fprintf(w, "  Updated: %v\n", u.Format(time.RFC1123))
		fmt.Fprintf(w, "  Display Name: %q\n", t.GetDisplayName())
		fmt.Fprintf(w, "  Description: %q\n", t.GetDescription())
	}

	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-list-templates-php" track-metadata-position="dlp-list-templates" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_inspect_templates.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_inspect_templates.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/list_inspect_templates.php" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/list_inspect_templates.php/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * List DLP inspection configuration templates.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 */
function list_inspect_templates(string $callingProjectId): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;listInspectTemplates($parent);

    // Print results
    $templates = $response-&gt;iterateAllElements();

    foreach ($templates as $template) {
        printf('Template %s' . PHP_EOL, $template-&gt;getName());
        printf('  Created: %s' . PHP_EOL, $template-&gt;getCreateTime()-&gt;getSeconds());
        printf('  Updated: %s' . PHP_EOL, $template-&gt;getUpdateTime()-&gt;getSeconds());
        printf('  Display Name: %s' . PHP_EOL, $template-&gt;getDisplayName());
        printf('  Description: %s' . PHP_EOL, $template-&gt;getDescription());

        $inspectConfig = $template-&gt;getInspectConfig();
        if ($inspectConfig === null) {
            print('  No inspect config.' . PHP_EOL);
        } else {
            printf('  Minimum likelihood: %s' . PHP_EOL, $inspectConfig-&gt;getMinLikelihood());
            printf('  Include quotes: %s' . PHP_EOL, $inspectConfig-&gt;getIncludeQuote());
            $limits = $inspectConfig-&gt;getLimits();
            printf('  Max findings per request: %s' . PHP_EOL, $limits-&gt;getMaxFindingsPerRequest());
        }
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-list-templates-csharp" track-metadata-position="dlp-list-templates" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-templates" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-templates" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-list-templates" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateList.cs" data-region-tag="dlp_list_inspect_templates" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateList.cs/HEAD/dlp_list_inspect_templates" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using System;
using Google.Api.Gax;

public class InspectTemplateList
{
    public static PagedEnumerable&lt;ListInspectTemplatesResponse, InspectTemplate&gt; List(string projectId)
    {
        var client = DlpServiceClient.Create();

        var response = client.ListInspectTemplates(
            new ListInspectTemplatesRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
            }
        );

        // Uncomment to list templates
        //PrintTemplates(response);

        return response;
    }

    public static void PrintTemplates(PagedEnumerable&lt;ListInspectTemplatesResponse, InspectTemplate&gt; response)
    {
        foreach (var template in response)
        {
            Console.WriteLine($"Template {template.Name}:");
            Console.WriteLine($"\tDisplay Name: {template.DisplayName}");
            Console.WriteLine($"\tDescription: {template.Description}");
            Console.WriteLine($"\tCreated: {template.CreateTime}");
            Console.WriteLine($"\tUpdated: {template.UpdateTime}");
            Console.WriteLine("Configuration:");
            Console.WriteLine($"\tMin Likelihood: {template.InspectConfig?.MinLikelihood}");
            Console.WriteLine($"\tInclude quotes: {template.InspectConfig?.IncludeQuote}");
            Console.WriteLine($"\tMax findings per request: {template.InspectConfig?.Limits.MaxFindingsPerRequest}");
        }
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Deleting de-identification templates" id="deleting_de-identification_templates">Deleting de-identification templates</h2>
<p>To delete a specific de-identification template, use one of the <code dir="ltr" translate="no">*.*.delete</code>
methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/delete"><code dir="ltr" translate="no">projects.deidentifyTemplates.delete</code></a></li>
</ul>
<p>With each <code dir="ltr" translate="no">*.*.delete</code> method, you include the resource name of the template to
be deleted.</p>
<h3 data-text="Code examples" id="code_examples_2">Code examples</h3>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to delete an inspection template. The process
is identical to the one for listing de-identification templates.<!-- For
information about the parameters included with the request, see
[Configuring storage inspection](#configuring-storage-inspection),
later in this topic.--></p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-delete-template-code-sample">
<section>
<h3 data-text="Java" id="dlp-delete-template-java" track-metadata-position="dlp-delete-template" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TemplatesDelete.java/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.DeleteInspectTemplateRequest;
import java.io.IOException;

class TemplatesDelete {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String templateId = "your-template-id";
    deleteInspectTemplate(projectId, templateId);
  }

  // Delete an existing template
  public static void deleteInspectTemplate(String projectId, String templateId) throws IOException {
    // Construct the template name to be deleted
    String templateName = String.format("projects/%s/inspectTemplates/%s", projectId, templateId);

    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Create delete template request to be sent by the client
      DeleteInspectTemplateRequest request =
          DeleteInspectTemplateRequest.newBuilder().setName(templateName).build();

      // Send the request with the client
      dlpServiceClient.deleteInspectTemplate(request);
      System.out.printf("Deleted template: %s\n", templateName);
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-delete-template-nodejs" track-metadata-position="dlp-delete-template" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteInspectTemplate.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteInspectTemplate.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deleteInspectTemplate.js" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deleteInspectTemplate.js/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The name of the template to delete
// Parent project ID is automatically extracted from this parameter
// const templateName = 'projects/YOUR_PROJECT_ID/inspectTemplates/#####'
async function deleteInspectTemplate() {
  // Construct template-deletion request
  const request = {
    name: templateName,
  };

  // Run template-deletion request
  await dlp.deleteInspectTemplate(request);
  console.log(`Successfully deleted template ${templateName}.`);
}

deleteInspectTemplate();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-delete-template-python" track-metadata-position="dlp-delete-template" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/templates.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/templates.py" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/templates.py/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">def delete_inspect_template(project, template_id):
    """Deletes a Data Loss Prevention API template.
    Args:
        project: The id of the Google Cloud project which owns the template.
        template_id: The id of the template to delete.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Combine the template id with the parent id.
    template_resource = "{}/inspectTemplates/{}".format(parent, template_id)

    # Call the API.
    dlp.delete_inspect_template(request={"name": template_resource})

    print("Template {} successfully deleted.".format(template_resource))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-delete-template-go" track-metadata-position="dlp-delete-template" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/delete.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/template/delete.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/template/delete.go" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/template/delete.go/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deleteInspectTemplate deletes the given template.
func deleteInspectTemplate(w io.Writer, templateID string) error {
	// projectID := "my-project-id"
	// templateID := "my-template"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	req := &amp;dlppb.DeleteInspectTemplateRequest{
		Name: templateID,
	}

	if err := client.DeleteInspectTemplate(ctx, req); err != nil {
		return fmt.Errorf("DeleteInspectTemplate: %v", err)
	}
	fmt.Fprintf(w, "Successfully deleted inspect template %v", templateID)
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-delete-template-php" track-metadata-position="dlp-delete-template" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_inspect_template.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_inspect_template.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_inspect_template.php" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_inspect_template.php/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * Delete a DLP inspection configuration template.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $templateId        The name of the template to delete
 */
function delete_inspect_template(
    string $callingProjectId,
    string $templateId
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Run template deletion request
    $templateName = "projects/$callingProjectId/locations/global/inspectTemplates/$templateId";
    $dlp-&gt;deleteInspectTemplate($templateName);

    // Print results
    printf('Successfully deleted template %s' . PHP_EOL, $templateName);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-delete-template-csharp" track-metadata-position="dlp-delete-template" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-template" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateDelete.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/InspectTemplateDelete.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-template" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-delete-template" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateDelete.cs" data-region-tag="dlp_delete_inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/InspectTemplateDelete.cs/HEAD/dlp_delete_inspect_template" translate="no"><code dir="ltr" translate="no">
using Google.Cloud.Dlp.V2;
using System;

public class InspectTemplateDelete
{
    public static object Delete(string projectId, string templateName)
    {
        var client = DlpServiceClient.Create();

        var request = new DeleteInspectTemplateRequest
        {
            Name = templateName
        };

        client.DeleteInspectTemplate(request);
        Console.WriteLine($"Successfully deleted template {templateName}.");

        return templateName;
    }
}
</code></pre>
</div>
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/compute-risk-analysis]</H1></p><div class="devsite-article-body clearfix">
<p><em>Re-identification risk analysis</em>, or just <em>risk analysis</em>, is the process of
analyzing sensitive data to find properties that might increase the risk of
subjects being identified. You can use risk analysis methods before
de-identification to help determine an effective de-identification strategy or
after de-identification to monitor for any changes or outliers.</p>
<p>Cloud Data Loss Prevention can compute four re-identification risk metrics: <em>k</em>-anonymity,
<em>l</em>-diversity, <em>k</em>-map, and <em>Î´</em>-presence. If you're not familiar with risk
analysis or these metrics, see the <a href="/dlp/docs/concepts-risk-analysis">risk analysis concept
topic</a> before continuing on.</p>
<p>This section provides overviews of how to use Cloud DLP for risk
analysis of structured data using any of these metrics, plus other related
topics.</p>
<h2 data-text="Calculate re-identification risk" id="risk-analysis">Calculate re-identification risk</h2>
<p>Cloud DLP can analyze your structured data stored in
BigQuery tables and compute the following re-identification risk
metrics. Click the link for the metric you want to calculate to learn more.</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/dlp/docs/compute-k-anonymity"><em>k</em>-anonymity</a></td>
<td>A property of a dataset that indicates the re-identifiability of its records. A dataset is <em>k</em>-anonymous if quasi-identifiers for each person in the dataset are identical to at least <em>k</em> â 1 other people also in the dataset.</td>
</tr>
<tr>
<td><a href="/dlp/docs/compute-l-diversity"><em>l</em>-diversity</a></td>
<td>An extension of <em>k</em>-anonymity that additionally measures the diversity of sensitive values for each column in which they occur. A dataset has <em>l</em>-diversity if, for every set of rows with identical quasi-identifiers, there are at least <em>l</em> distinct values for each sensitive attribute.</td>
</tr>
<tr>
<td><a href="/dlp/docs/compute-k-map"><em>k</em>-map</a></td>
<td>Computes re-identifiability risk by comparing a given de-identified dataset of subjects with a larger re-identificationâor "attack"âdataset.</td>
</tr>
<tr>
<td><a href="/dlp/docs/compute-d-presence"><em>Î´</em>-presence</a></td>
<td>Estimates the probability that a given user in a larger population is present in the dataset. This is used when membership in the dataset is itself sensitive information.</td>
</tr>
</tbody>
</table>
<h2 data-text="Calculate other statistics" id="other">Calculate other statistics</h2>
<p>Cloud DLP can also compute numerical and categorical
statistics for data stored in BigQuery tables using the same
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">DlpJob</code></a> resource as the
risk analysis APIs.</p>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/dlp/docs/compute-stats#compute-num-stats">Numerical statistics</a></td>
<td>Determines minimum, maximum, and quantile values for an individual BigQuery column.</td>
</tr>
<tr>
<td><a href="/dlp/docs/compute-stats#compute-cat-num-stats">Categorical numerical statistics</a></td>
<td>Computes categorical numerical statistics for the individual histogram buckets within a BigQuery column.</td>
</tr>
</tbody>
</table>
<p>For more information, see
<a href="/dlp/docs/compute-stats">Computing numerical and categorical statistics</a>.</p>
<h2 data-text="Visualize re-identification risk" id="viz">Visualize re-identification risk</h2>
<p>You can visualize the risk metrics that Cloud DLP calculates
directly in the Cloud console using Cloud DLP
(<a href="/dlp/docs/compute-k-anonymity#viewing-results"><em>k</em>-anonymity</a> or
<a href="/dlp/docs/compute-l-diversity#viewing-results"><em>l</em>-diversity</a>), or using other
Google Cloud products.</p>
<table>
<thead>
<tr>
<th>Product</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/dlp/docs/visualizing_re-id_risk">Data Studio</a></td>
<td>After calculating <a href="/dlp/docs/concepts-risk-analysis#about-k-anonymity"><em>k</em>-anonymity</a> values for a dataset using Cloud DLP, you can visualize the results in Google Data Studio. By doing so, you'll also be able to better understand re-identificaiton risk and help evaluate the trade-offs in utility you might be making if you redact or de-identify data.</td>
</tr>
</tbody>
</table>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/compute-k-anonymity]</H1></p><div class="devsite-article-body clearfix">
<p><a href="/dlp/docs/concepts-risk-analysis#about-k-anonymity"><em>K-anonymity</em></a> is a property of a
dataset that indicates the re-identifiability of its records. A dataset is
<em>k</em>-anonymous if quasi-identifiers for each person in the dataset are identical
to at least <em>k</em> â 1 other people also in the dataset.</p>
<p>You can compute the <em>k</em>-anonymity value based on one or more columns, or fields,
of a dataset. This topic demonstrates how to compute <em>k</em>-anonymity values for a
dataset using Cloud Data Loss Prevention. For more information about <em>k</em>-anonymity or risk
analysis in general, see the <a href="/dlp/docs/concepts-risk-analysis">risk analysis concept
topic</a> before continuing on.</p>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<h2 data-text="   Before you begin " id="before-you-begin">
  Before you begin
</h2>
<p>
  Before continuing, be sure you've done the following:
</p>
<ol>
<li><a href="https://accounts.google.com/Login">Sign in</a> to your Google Account.</li>
<li>In the Google Cloud console, on the project selector page, select or create a
     Google Cloud project.</li>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console">Go to the project selector</a>
<li>Make sure that billing is enabled for your Google Cloud project. <a href="/billing/docs/how-to/modify-project">Learn how to confirm billing is enabled for your
        project.</a></li>
<li>Enable Cloud DLP.</li>
<a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console">Enable Cloud DLP</a>
<!--- Must close the ordered list! ---->
<p><li>Select a BigQuery dataset to analyze. Cloud DLP
  calculates the <em>k</em>-anonymity metric by scanning a BigQuery
  table.</li>
<li>Determine an identifier (if applicable) and at least one quasi-identifier
  in the dataset. For more information, see <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">Risk
  analysis terms and techniques</a>.</li>
</p></ol>
<h2 data-text="Compute k-anonymity" id="compute-k">Compute k-anonymity</h2>
<p>Cloud DLP performs risk analysis whenever a risk analysis
job runs. You must create the job first, either by using the
Cloud console, sending a DLP API request, or using a
Cloud DLP client library.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-k-anonymity-code-sample">
<section>
<h3 data-text="Console" id="dlp-k-anonymity-console" track-metadata-position="dlp-k-anonymity" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>On the <strong>Create</strong> menu, point to <strong>Job or job trigger</strong>, and then select
 <strong>Re-identification risk analysis</strong>.
 <img alt="" class="screenshot" src="/dlp/docs/images/compute-risk-analysis-new-job.png" width="800"/></p></li>
<li><p>In the <strong>Choose input data</strong> section of the <strong>New risk analysis job</strong> page,
 first specify the BigQuery table to scan by entering the project
 ID of the project containing the table, the dataset ID of the table, and
 the name of the table where specified.</p></li>
<li><p>Under <strong>Privacy metric to compute</strong>, select <strong>k-anonymity</strong>.</p></li>
<li><p>In the <strong>Job ID</strong> section, you can optionally give the job a custom
 identifier and select <a href="/dlp/docs/specifying-location">a resource location</a>
 in which Cloud DLP will process your data. When you're done,
 click <strong>Continue</strong>.</p></li>
<li><p>In the <strong>Define fields</strong> section, you specify <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">identifiers and
 quasi-identifiers</a>
 for the <em>k</em>-anonymity risk job. Cloud DLP accesses the
 metadata of the BigQuery table you specified in the previous
 step and attempts to populate the list of fields.</p>
<ol>
<li>Select the appropriate checkbox to specify a field as either an
identifier (ID) or quasi-identifier (QI). You must select either 0 or 1
identifiers and at least 1 quasi-identifier.</li>
<li>If Cloud DLP isn't able to populate the fields, click
<strong>Enter field name</strong> to manually enter one or more fields and set each
one as identifier or quasi-identifier.
When you're done, click <strong>Continue</strong>.</li>
</ol></li>
<li><p>In the <strong>Add actions</strong> section, you can add optional
 <a href="/dlp/docs/concepts-actions">actions</a> to perform when the risk job is
 complete. The available options are:</p>
<aside class="special"><strong>Important:</strong><span> Be aware that running a risk analysis job may persist some of the
  <a href="/dlp/docs/quote">quote</a> values of the selected quasi-identifiers to the
  risk analysis job results. These quote values are used to build the
  histogram and output tables.</span></aside>
<ul>
<li><strong>Save to BigQuery</strong>: Saves the results of the risk
analysis scan to a BigQuery table.</li>
<li><strong>Publish to Pub/Sub</strong>: Publishes a notification to a
<a href="/pubsub/docs/publisher">Pub/Sub topic</a>.</li>
<li><strong>Notify by email</strong>: Sends you an email with results.
When you're done, click <strong>Create</strong>.</li>
</ul></li>
</ol>
<p>The <em>k</em>-anonymity risk analysis job starts immediately.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-k-anonymity-protocol" track-metadata-position="dlp-k-anonymity" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>To run a new risk analysis job to compute <em>k</em>-anonymity, send a request to the
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
  resource, where <var translate="no">PROJECT_ID</var> indicates your <a href="/resource-manager/docs/creating-managing-projects#identifying_projects">project
  identifier</a>:</p>
<p><pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs</pre></p>
<p>The request contains a
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create#riskanalysisjobconfig"><code dir="ltr" translate="no">RiskAnalysisJobConfig</code></a>
  object, which is composed of the following:</p>
<ul>
<li><p>A
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#privacymetric"><code dir="ltr" translate="no">PrivacyMetric</code></a>
object. This is where you specify that you're calculating <em>k</em>-anonymity by
including a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#kanonymityconfig"><code dir="ltr" translate="no">KAnonymityConfig</code></a>
object.</p></li>
<li><p>A <a href="/dlp/docs/reference/rest/v2/BigQueryTable"><code dir="ltr" translate="no">BigQueryTable</code></a>
object. Specify the BigQuery table to scan by including all of
the following:</p>
<ul>
<li><code dir="ltr" translate="no">projectId</code>: The project ID of the project containing the table.</li>
<li><code dir="ltr" translate="no">datasetId</code>: The dataset ID of the table.</li>
<li><code dir="ltr" translate="no">tableId</code>: The name of the table.</li>
</ul></li>
<li><p>A set of one or more
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>
objects, which represent actions to run, in the order given, at the
completion of the job. Each <code dir="ltr" translate="no">Action</code> object can contain one of the
following actions:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#SaveFindings"><code dir="ltr" translate="no">SaveFindings</code></a>
object: Saves the results of the risk analysis scan to a
BigQuery table.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToPubSub"><code dir="ltr" translate="no">PublishToPubSub</code></a>
object:
<a href="/pubsub/docs/publisher">Publishes a notification to a Pub/Sub topic</a>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#JobNotificationEmails"><code dir="ltr" translate="no">JobNotificationEmails</code></a>
object: Sends you an email with results.</li>
</ul>
<p>Within the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#kanonymityconfig"><code dir="ltr" translate="no">KAnonymityConfig</code></a>
object, you specify the following:</p>
<aside class="special"><strong>Important:</strong><span> Be aware that running a risk analysis job may persist some of the
<a href="/dlp/docs/quote">quote</a> values of the selected quasi-identifiers to the
risk analysis job results. These quote values are used to build the
histogram and output tables.</span></aside>
<ul>
<li><code dir="ltr" translate="no">quasiIds[]</code>: One or more quasi-identifiers
(<a href="/dlp/docs/reference/rest/v2/FieldId"><code dir="ltr" translate="no">FieldId</code></a> objects) to scan and
use to compute <em>k</em>-anonymity. When you specify multiple quasi-identifiers,
they are considered a single composite key. Structs and repeated data
types are not supported, but nested fields are supported as long as they
are not structs themselves or nested within a repeated field.</li>
<li><code dir="ltr" translate="no">entityId</code>: Optional identifier value that, when set, indicates that all
rows corresponding to each distinct <code dir="ltr" translate="no">entityId</code> should be grouped together
for <em>k</em>-anonymity computation. Typically, an <code dir="ltr" translate="no">entityId</code> will be a column
that represents a unique user, like a customer ID or a user ID.
When an <code dir="ltr" translate="no">entityId</code> appears on several rows with different quasi-identifier
values, these rows will be joined to form a multiset that will be used as
the quasi-identifiers for that entity. For more information about entity
IDs, see <a href="/dlp/docs/concepts-risk-analysis#entity-ids">Entity IDs and computing
<em>k</em>-anonymity</a> in the <a href="/dlp/docs/concepts-risk-analysis">Risk
analysis</a> conceptual topic.</li>
</ul></li>
</ul>
<p>As soon as you send a request to the DLP API, it starts the risk
analysis job.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-k-anonymity-java" track-metadata-position="dlp-k-anonymity" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-anonymity" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKAnonymity.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKAnonymity.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-anonymity" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-k-anonymity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKAnonymity.java" data-region-tag="dlp_k_anonymity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKAnonymity.java/HEAD/dlp_k_anonymity" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.Action.PublishToPubSub;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.KAnonymityResult;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.KAnonymityResult.KAnonymityEquivalenceClass;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.KAnonymityResult.KAnonymityHistogramBucket;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrivacyMetric;
import com.google.privacy.dlp.v2.PrivacyMetric.KAnonymityConfig;
import com.google.privacy.dlp.v2.RiskAnalysisJobConfig;
import com.google.privacy.dlp.v2.Value;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.ProjectTopicName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import java.util.stream.Collectors;

class RiskAnalysisKAnonymity {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String datasetId = "your-bigquery-dataset-id";
    String tableId = "your-bigquery-table-id";
    String topicId = "pub-sub-topic";
    String subscriptionId = "pub-sub-subscription";
    calculateKAnonymity(projectId, datasetId, tableId, topicId, subscriptionId);
  }

  public static void calculateKAnonymity(
      String projectId, String datasetId, String tableId, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Specify the BigQuery table to analyze
      BigQueryTable bigQueryTable =
          BigQueryTable.newBuilder()
              .setProjectId(projectId)
              .setDatasetId(datasetId)
              .setTableId(tableId)
              .build();

      // These values represent the column names of quasi-identifiers to analyze
      List&lt;String&gt; quasiIds = Arrays.asList("Age", "Mystery");

      // Configure the privacy metric for the job
      List&lt;FieldId&gt; quasiIdFields =
          quasiIds.stream()
              .map(columnName -&gt; FieldId.newBuilder().setName(columnName).build())
              .collect(Collectors.toList());
      KAnonymityConfig kanonymityConfig =
          KAnonymityConfig.newBuilder().addAllQuasiIds(quasiIdFields).build();
      PrivacyMetric privacyMetric =
          PrivacyMetric.newBuilder().setKAnonymityConfig(kanonymityConfig).build();

      // Create action to publish job status notifications over Google Cloud Pub/Sub
      ProjectTopicName topicName = ProjectTopicName.of(projectId, topicId);
      PublishToPubSub publishToPubSub =
          PublishToPubSub.newBuilder().setTopic(topicName.toString()).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the risk analysis job to perform
      RiskAnalysisJobConfig riskAnalysisJobConfig =
          RiskAnalysisJobConfig.newBuilder()
              .setSourceTable(bigQueryTable)
              .setPrivacyMetric(privacyMetric)
              .addActions(action)
              .build();

      // Build the request to be sent by the client
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setRiskJob(riskAnalysisJobConfig)
              .build();

      // Send the request to the API using the client
      DlpJob dlpJob = dlpServiceClient.createDlpJob(createDlpJobRequest);

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Build a request to get the completed job
      GetDlpJobRequest getDlpJobRequest =
          GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();

      // Retrieve completed job status
      DlpJob completedJob = dlpServiceClient.getDlpJob(getDlpJobRequest);
      System.out.println("Job status: " + completedJob.getState());

      // Get the result and parse through and process the information
      KAnonymityResult kanonymityResult = completedJob.getRiskDetails().getKAnonymityResult();
      List&lt;KAnonymityHistogramBucket&gt; histogramBucketList =
          kanonymityResult.getEquivalenceClassHistogramBucketsList();
      for (KAnonymityHistogramBucket result : histogramBucketList) {
        System.out.printf(
            "Bucket size range: [%d, %d]\n",
            result.getEquivalenceClassSizeLowerBound(), result.getEquivalenceClassSizeUpperBound());

        for (KAnonymityEquivalenceClass bucket : result.getBucketValuesList()) {
          List&lt;String&gt; quasiIdValues =
              bucket.getQuasiIdsValuesList().stream()
                  .map(Value::toString)
                  .collect(Collectors.toList());

          System.out.println("\tQuasi-ID values: " + String.join(", ", quasiIdValues));
          System.out.println("\tClass size: " + bucket.getEquivalenceClassSize());
        }
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-k-anonymity-nodejs" track-metadata-position="dlp-k-anonymity" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-anonymity" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/kAnonymityAnalysis.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/kAnonymityAnalysis.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-anonymity" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-k-anonymity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/kAnonymityAnalysis.js" data-region-tag="dlp_k_anonymity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/kAnonymityAnalysis.js/HEAD/dlp_k_anonymity" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the table is stored under
// This may or (for public datasets) may not equal the calling project ID
// const tableProjectId = 'my-project';

// The ID of the dataset to inspect, e.g. 'my_dataset'
// const datasetId = 'my_dataset';

// The ID of the table to inspect, e.g. 'my_table'
// const tableId = 'my_table';

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

// A set of columns that form a composite key ('quasi-identifiers')
// const quasiIds = [{ name: 'age' }, { name: 'city' }];
async function kAnonymityAnalysis() {
  const sourceTable = {
    projectId: tableProjectId,
    datasetId: datasetId,
    tableId: tableId,
  };
  // Construct request for creating a risk analysis job

  const request = {
    parent: `projects/${projectId}/locations/global`,
    riskJob: {
      privacyMetric: {
        kAnonymityConfig: {
          quasiIds: quasiIds,
        },
      },
      sourceTable: sourceTable,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };

  // Create helper function for unpacking values
  const getValue = obj =&gt; obj[Object.keys(obj)[0]];

  // Run risk analysis job
  const [topicResponse] = await pubsub.topic(topicId).get();
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  setTimeout(() =&gt; {
    console.log(' Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  const histogramBuckets =
    job.riskDetails.kAnonymityResult.equivalenceClassHistogramBuckets;

  histogramBuckets.forEach((histogramBucket, histogramBucketIdx) =&gt; {
    console.log(`Bucket ${histogramBucketIdx}:`);
    console.log(
      `  Bucket size range: [${histogramBucket.equivalenceClassSizeLowerBound}, ${histogramBucket.equivalenceClassSizeUpperBound}]`
    );

    histogramBucket.bucketValues.forEach(valueBucket =&gt; {
      const quasiIdValues = valueBucket.quasiIdsValues
        .map(getValue)
        .join(', ');
      console.log(`  Quasi-ID values: {${quasiIdValues}}`);
      console.log(`  Class size: ${valueBucket.equivalenceClassSize}`);
    });
  });
}
kAnonymityAnalysis();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-k-anonymity-python" track-metadata-position="dlp-k-anonymity" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-anonymity" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-anonymity" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-k-anonymity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/risk.py" data-region-tag="dlp_k_anonymity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/risk.py/HEAD/dlp_k_anonymity" translate="no"><code dir="ltr" translate="no">def k_anonymity_analysis(
    project,
    table_project_id,
    dataset_id,
    table_id,
    topic_id,
    subscription_id,
    quasi_ids,
    timeout=300,
):
    """Uses the Data Loss Prevention API to compute the k-anonymity of a
        column set in a Google BigQuery table.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        table_project_id: The Google Cloud project id where the BigQuery table
            is stored.
        dataset_id: The id of the dataset to inspect.
        table_id: The id of the table to inspect.
        topic_id: The name of the Pub/Sub topic to notify once the job
            completes.
        subscription_id: The name of the Pub/Sub subscription to use when
            listening for job completion notifications.
        quasi_ids: A set of columns that form a composite key.
        timeout: The number of seconds to wait for a response from the API.

    Returns:
        None; the response from the API is printed to the terminal.
    """
    import concurrent.futures

    # Import the client library.
    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Create helper function for unpacking values
    def get_values(obj):
        return int(obj.integer_value)

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Location info of the BigQuery table.
    source_table = {
        "project_id": table_project_id,
        "dataset_id": dataset_id,
        "table_id": table_id,
    }

    # Convert quasi id list to Protobuf type
    def map_fields(field):
        return {"name": field}

    quasi_ids = map(map_fields, quasi_ids)

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Configure risk analysis job
    # Give the name of the numeric column to compute risk metrics for
    risk_job = {
        "privacy_metric": {"k_anonymity_config": {"quasi_ids": quasi_ids}},
        "source_table": source_table,
        "actions": actions,
    }

    # Call API to start risk analysis job
    operation = dlp.create_dlp_job(request={"parent": parent, "risk_job": risk_job})

    def callback(message):
        if message.attributes["DlpJobName"] == operation.name:
            # This is the message we're looking for, so acknowledge it.
            message.ack()

            # Now that the job is done, fetch the results and print them.
            job = dlp.get_dlp_job(request={"name": operation.name})
            histogram_buckets = (
                job.risk_details.k_anonymity_result.equivalence_class_histogram_buckets
            )
            # Print bucket stats
            for i, bucket in enumerate(histogram_buckets):
                print("Bucket {}:".format(i))
                if bucket.equivalence_class_size_lower_bound:
                    print(
                        "   Bucket size range: [{}, {}]".format(
                            bucket.equivalence_class_size_lower_bound,
                            bucket.equivalence_class_size_upper_bound,
                        )
                    )
                    for value_bucket in bucket.bucket_values:
                        print(
                            "   Quasi-ID values: {}".format(
                                map(get_values, value_bucket.quasi_ids_values)
                            )
                        )
                        print(
                            "   Class size: {}".format(
                                value_bucket.equivalence_class_size
                            )
                        )
            subscription.set_result(None)
        else:
            # This is not the message we're looking for.
            message.drop()

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)
    subscription = subscriber.subscribe(subscription_path, callback)

    try:
        subscription.result(timeout=timeout)
    except concurrent.futures.TimeoutError:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )
        subscription.close()

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-k-anonymity-go" track-metadata-position="dlp-k-anonymity" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-anonymity" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/k_anonymity.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/k_anonymity.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-anonymity" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-k-anonymity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/k_anonymity.go" data-region-tag="dlp_k_anonymity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/k_anonymity.go/HEAD/dlp_k_anonymity" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"strings"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// riskKAnonymity computes the risk of the given columns using K Anonymity.
func riskKAnonymity(w io.Writer, projectID, dataProject, pubSubTopic, pubSubSub, datasetID, tableID string, columnNames ...string) error {
	// projectID := "my-project-id"
	// dataProject := "bigquery-public-data"
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// datasetID := "nhtsa_traffic_fatalities"
	// tableID := "accident_2015"
	// columnNames := "state_number" "county"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}

	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("Error creating PubSub client: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	s, err := setupPubSub(projectID, pubSubTopic, pubSubSub)
	if err != nil {
		return fmt.Errorf("setupPubSub: %v", err)
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Build the QuasiID slice.
	var q []*dlppb.FieldId
	for _, c := range columnNames {
		q = append(q, &amp;dlppb.FieldId{Name: c})
	}

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_RiskJob{
			RiskJob: &amp;dlppb.RiskAnalysisJobConfig{
				// PrivacyMetric configures what to compute.
				PrivacyMetric: &amp;dlppb.PrivacyMetric{
					Type: &amp;dlppb.PrivacyMetric_KAnonymityConfig_{
						KAnonymityConfig: &amp;dlppb.PrivacyMetric_KAnonymityConfig{
							QuasiIds: q,
						},
					},
				},
				// SourceTable describes where to find the data.
				SourceTable: &amp;dlppb.BigQueryTable{
					ProjectId: dataProject,
					DatasetId: datasetID,
					TableId:   tableID,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the risk job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the risk job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()
		time.Sleep(500 * time.Millisecond)
		j, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "GetDlpJob: %v", err)
			return
		}
		h := j.GetRiskDetails().GetKAnonymityResult().GetEquivalenceClassHistogramBuckets()
		for i, b := range h {
			fmt.Fprintf(w, "Histogram bucket %v\n", i)
			fmt.Fprintf(w, "  Size range: [%v,%v]\n", b.GetEquivalenceClassSizeLowerBound(), b.GetEquivalenceClassSizeUpperBound())
			fmt.Fprintf(w, "  %v unique values total\n", b.GetBucketSize())
			for _, v := range b.GetBucketValues() {
				var qvs []string
				for _, qv := range v.GetQuasiIdsValues() {
					qvs = append(qvs, qv.String())
				}
				fmt.Fprintf(w, "    QuasiID values: %s\n", strings.Join(qvs, ", "))
				fmt.Fprintf(w, "    Class size: %v\n", v.GetEquivalenceClassSize())
			}
		}
		// Stop listening for more messages.
		cancel()
	})
	if err != nil {
		return fmt.Errorf("Receive: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-k-anonymity-php" track-metadata-position="dlp-k-anonymity" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-anonymity" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/k_anonymity.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/k_anonymity.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-anonymity" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-k-anonymity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/k_anonymity.php" data-region-tag="dlp_k_anomymity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/k_anonymity.php/HEAD/dlp_k_anomymity" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\RiskAnalysisJobConfig;
use Google\Cloud\Dlp\V2\BigQueryTable;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\PrivacyMetric\KAnonymityConfig;
use Google\Cloud\Dlp\V2\PrivacyMetric;
use Google\Cloud\Dlp\V2\FieldId;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Computes the k-anonymity of a column set in a Google BigQuery table.
 *
 * @param string    $callingProjectId  The project ID to run the API call under
 * @param string    $dataProjectId     The project ID containing the target Datastore
 * @param string    $topicId           The name of the Pub/Sub topic to notify once the job completes
 * @param string    $subscriptionId    The name of the Pub/Sub subscription to use when listening for job
 * @param string    $datasetId         The ID of the dataset to inspect
 * @param string    $tableId           The ID of the table to inspect
 * @param string[]  $quasiIdNames      Array columns that form a composite key (quasi-identifiers)
 */
function k_anonymity(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $datasetId,
    string $tableId,
    array $quasiIdNames
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $pubsub = new PubSubClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $topic = $pubsub-&gt;topic($topicId);

    // Construct risk analysis config
    $quasiIds = array_map(
        function ($id) {
            return (new FieldId())-&gt;setName($id);
        },
        $quasiIdNames
    );

    $statsConfig = (new KAnonymityConfig())
        -&gt;setQuasiIds($quasiIds);

    $privacyMetric = (new PrivacyMetric())
        -&gt;setKAnonymityConfig($statsConfig);

    // Construct items to be analyzed
    $bigqueryTable = (new BigQueryTable())
        -&gt;setProjectId($dataProjectId)
        -&gt;setDatasetId($datasetId)
        -&gt;setTableId($tableId);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct risk analysis job config to run
    $riskJob = (new RiskAnalysisJobConfig())
        -&gt;setPrivacyMetric($privacyMetric)
        -&gt;setSourceTable($bigqueryTable)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'riskJob' =&gt; $riskJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $histBuckets = $job-&gt;getRiskDetails()-&gt;getKAnonymityResult()-&gt;getEquivalenceClassHistogramBuckets();

            foreach ($histBuckets as $bucketIndex =&gt; $histBucket) {
                // Print bucket stats
                printf('Bucket %s:' . PHP_EOL, $bucketIndex);
                printf(
                    '  Bucket size range: [%s, %s]' . PHP_EOL,
                    $histBucket-&gt;getEquivalenceClassSizeLowerBound(),
                    $histBucket-&gt;getEquivalenceClassSizeUpperBound()
                );

                // Print bucket values
                foreach ($histBucket-&gt;getBucketValues() as $percent =&gt; $valueBucket) {
                    // Pretty-print quasi-ID values
                    print('  Quasi-ID values:' . PHP_EOL);
                    foreach ($valueBucket-&gt;getQuasiIdsValues() as $index =&gt; $value) {
                        print('    ' . $value-&gt;serializeToJsonString() . PHP_EOL);
                    }
                    printf(
                        '  Class size: %s' . PHP_EOL,
                        $valueBucket-&gt;getEquivalenceClassSize()
                    );
                }
            }

            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            printf('Unexpected job state. Most likely, the job is either running or has not yet started.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-k-anonymity-csharp" track-metadata-position="dlp-k-anonymity" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-anonymity" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateKAnonymity.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateKAnonymity.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-anonymity" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-k-anonymity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateKAnonymity.cs" data-region-tag="dlp_k_anonymity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateKAnonymity.cs/HEAD/dlp_k_anonymity" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Cloud.PubSub.V1;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using static Google.Cloud.Dlp.V2.Action.Types;
using static Google.Cloud.Dlp.V2.PrivacyMetric.Types;

public class RiskAnalysisCreateKAnonymity
{
    public static AnalyzeDataSourceRiskDetails.Types.KAnonymityResult KAnonymity(
        string callingProjectId,
        string tableProjectId,
        string datasetId,
        string tableId,
        string topicId,
        string subscriptionId,
        IEnumerable&lt;FieldId&gt; quasiIds)
    {
        var dlp = DlpServiceClient.Create();

        // Construct + submit the job
        var KAnonymityConfig = new KAnonymityConfig
        {
            QuasiIds = { quasiIds }
        };

        var config = new RiskAnalysisJobConfig
        {
            PrivacyMetric = new PrivacyMetric
            {
                KAnonymityConfig = KAnonymityConfig
            },
            SourceTable = new BigQueryTable
            {
                ProjectId = tableProjectId,
                DatasetId = datasetId,
                TableId = tableId
            },
            Actions =
            {
                new Google.Cloud.Dlp.V2.Action
                {
                    PubSub = new PublishToPubSub
                    {
                        Topic = $"projects/{callingProjectId}/topics/{topicId}"
                    }
                }
            }
        };

        var submittedJob = dlp.CreateDlpJob(
            new CreateDlpJobRequest
            {
                ParentAsProjectName = new ProjectName(callingProjectId),
                RiskJob = config
            });

        // Listen to pub/sub for the job
        var subscriptionName = new SubscriptionName(callingProjectId, subscriptionId);
        var subscriber = SubscriberClient.CreateAsync(
            subscriptionName).Result;

        // SimpleSubscriber runs your message handle function on multiple
        // threads to maximize throughput.
        var done = new ManualResetEventSlim(false);
        subscriber.StartAsync((PubsubMessage message, CancellationToken cancel) =&gt;
        {
            if (message.Attributes["DlpJobName"] == submittedJob.Name)
            {
                Thread.Sleep(500); // Wait for DLP API results to become consistent
                done.Set();
                return Task.FromResult(SubscriberClient.Reply.Ack);
            }
            else
            {
                return Task.FromResult(SubscriberClient.Reply.Nack);
            }
        });

        done.Wait(TimeSpan.FromMinutes(10)); // 10 minute timeout; may not work for large jobs
        subscriber.StopAsync(CancellationToken.None).Wait();

        // Process results
        var resultJob = dlp.GetDlpJob(new GetDlpJobRequest
        {
            DlpJobName = DlpJobName.Parse(submittedJob.Name)
        });

        var result = resultJob.RiskDetails.KAnonymityResult;

        for (var bucketIdx = 0; bucketIdx &lt; result.EquivalenceClassHistogramBuckets.Count; bucketIdx++)
        {
            var bucket = result.EquivalenceClassHistogramBuckets[bucketIdx];
            Console.WriteLine($"Bucket {bucketIdx}");
            Console.WriteLine($"  Bucket size range: [{bucket.EquivalenceClassSizeLowerBound}, {bucket.EquivalenceClassSizeUpperBound}].");
            Console.WriteLine($"  {bucket.BucketSize} unique value(s) total.");

            foreach (var bucketValue in bucket.BucketValues)
            {
                // 'UnpackValue(x)' is a prettier version of 'x.toString()'
                Console.WriteLine($"    Quasi-ID values: [{String.Join(',', bucketValue.QuasiIdsValues.Select(x =&gt; UnpackValue(x)))}]");
                Console.WriteLine($"    Class size: {bucketValue.EquivalenceClassSize}");
            }
        }

        return result;
    }

    public static string UnpackValue(Value protoValue)
    {
        var jsonValue = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, object&gt;&gt;(protoValue.ToString());
        return jsonValue.Values.ElementAt(0).ToString();
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="List completed risk analysis jobs" id="list-jobs">List completed risk analysis jobs</h2>
<p>You can view a list of the risk analysis jobs that have been run in the current
project.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Console " id="console"> Console </h3><p>To list running and previously run risk analysis jobs in the
Cloud console, do the following:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>Click the <strong>Jobs &amp; job triggers</strong> tab at the top of the page.</p></li>
<li><p>Click the <strong>Risk jobs</strong> tab.</p></li>
</ol>
<p>The risk job listing appears.</p></section>
<section><h3 data-text=" Protocol " id="protocol"> Protocol </h3><p>To list running and previously run risk analysis jobs, send a GET request to
the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource. Adding a job type filter (<code dir="ltr" translate="no">?type=RISK_ANALYSIS_JOB</code>) narrows the
response to only risk analysis jobs.</p>
<pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs?type=RISK_ANALYSIS_JOB</pre>
<p>The response you receive contains a JSON representation of all current and
previous risk analysis jobs.</p></section>
</div>
<h2 data-text="View k-anonymity job results" id="viewing-results">View k-anonymity job results</h2>
<p>Cloud DLP in the Cloud console features built-in
visualizations for completed <em>k</em>-anonymity jobs. After following the
instructions in the previous section, from the risk analysis job listing, select
the job for which you want to view results. Assuming the job has run
successfully, the top of the <strong>Risk analysis details</strong> page looks like this:</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/compute-risk-analysis-k-results1.png" width="800"/></p>
<p>At the top of the page is information about the <em>k</em>-anonymity risk job,
including its job ID and, under <strong>Container</strong>, its resource location.</p>
<p>To view the results of the <em>k</em>-anonymity calculation, click the <strong>K-anonymity</strong>
tab. To view the risk analysis job's configuration, click the <strong>Configuration</strong>
tab.</p>
<p>The <strong>K-anonymity</strong> tab first lists the entity ID (if any) and the
quasi-identifiers used to calculate <em>k</em>-anonymity.</p>
<h3 data-text="Risk chart" id="risk_chart">Risk chart</h3>
<p>The <strong>Re-identification risk</strong> chart plots, on the <em>y</em>-axis, the potential
percentage of data loss for both unique rows and unique quasi-identifier
combinations to achieve, on the <em>x</em>-axis, a <em>k</em>-anonymity value. The chart's
color also indicates risk potential. Darker shades of blue indicate a higher
risk, while lighter shades indicate less risk.</p>
<p>Higher <em>k</em>-anonymity values indicate less risk of re-identification. To achieve
higher <em>k</em>-anonymity values, however, you would need to remove higher
percentages of the total rows and higher unique quasi-identifier combinations,
which might decrease the utility of the data. To see a specific potential
percentage loss value for a certain <em>k</em>-anonymity value, hover your cursor over
the chart. As shown in the screenshot, a tooltip appears on the chart.</p>
<p>To view more detail about a specific <em>k</em>-anonymity value, click the
corresponding data point. A detailed explanation is shown under the chart and a
sample data table appears further down the page.</p>
<h3 data-text="Risk sample data table" id="risk_sample_data_table">Risk sample data table</h3>
<p>The second component to the risk job results page is the sample data table. It
displays quasi-identifier combinations for a given target <em>k</em>-anonymity value.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/compute-risk-analysis-k-results2.png" width="800"/></p>
<p>The first column of the table lists the k-anonymity values. Click a
<em>k</em>-anonymity value to view corresponding sample data that would need to be
dropped to achieve that value.</p>
<p>The second column displays the respective potential data loss of
unique rows and quasi-identifier combinations, as well as the number of groups
with at least <em>k</em> records and the total number of records.</p>
<p>The last column displays a sample of groups that share a quasi-identifier
combination, along with the number of records that exist for that combination.</p>
<h2 data-text="Retrieve job details using REST" id="retrieve_job_details_using_rest">Retrieve job details using REST</h2>
<p>To retrieve the results of the <em>k</em>-anonymity risk analysis job using the REST
API, send the following GET request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource. Replace <var translate="no">PROJECT_ID</var> with your project ID and
<var translate="no">JOB_ID</var> with the identifier of the job you want to obtain results for.
The job ID was returned when you started the job, and can also be retrieved by
<a href="#list-jobs">listing all jobs</a>.</p>
<pre dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs/<var translate="no">JOB_ID</var></pre>
<p>The request returns a JSON object containing an instance of the job. The results
of the analysis are inside the <code dir="ltr" translate="no">"riskDetails"</code> key, in an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AnalyzeDataSourceRiskDetails"><code dir="ltr" translate="no">AnalyzeDataSourceRiskDetails</code></a>
object. For more information, see the API reference for the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>
resource.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to calculate the <a href="/dlp/docs/compute-l-diversity"><em>l</em>-diversity</a>
value for a dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-k-map"><em>k</em>-map</a> value for a
dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-d-presence"><em>Î´</em>-presence</a> value
for a dataset.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/compute-l-diversity]</H1></p><div class="devsite-article-body clearfix">
<p><a href="/dlp/docs/concepts-risk-analysis#about-l-diversity"><em>L</em>-diversity</a> is a property of a
dataset and an extension of <em>k</em>-anonymity that measures the diversity of
sensitive values for each column in which they occur. A dataset has
<em>l</em>-diversity if, for every set of rows with identical quasi-identifiers, there
are at least <em>l</em> distinct values for each sensitive attribute.</p>
<p>You can compute the <em>l</em>-diversity value based on one or more columns, or fields,
of a dataset. This topic demonstrates how to compute <em>l</em>-diversity values for a
dataset using Cloud Data Loss Prevention. For more information about <em>l</em>-diversity or risk
analysis in general, see the <a href="/dlp/docs/concepts-risk-analysis">risk analysis concept
topic</a> before continuing on.</p>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<h2 data-text="   Before you begin " id="before-you-begin">
  Before you begin
</h2>
<p>
  Before continuing, be sure you've done the following:
</p>
<ol>
<li><a href="https://accounts.google.com/Login">Sign in</a> to your Google Account.</li>
<li>In the Google Cloud console, on the project selector page, select or create a
     Google Cloud project.</li>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console">Go to the project selector</a>
<li>Make sure that billing is enabled for your Google Cloud project. <a href="/billing/docs/how-to/modify-project">Learn how to confirm billing is enabled for your
        project.</a></li>
<li>Enable Cloud DLP.</li>
<a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console">Enable Cloud DLP</a>
<!--- Must close the ordered list! ---->
<p><li>Select a BigQuery dataset to analyze. Cloud DLP
  calculates the <em>l</em>-diversity metric by scanning a BigQuery
  table.</li>
<li>Determine a sensitive field identifier (if applicable) and at least one
  quasi-identifier in the dataset. For more information, see <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">Risk
  analysis terms and techniques</a>.</li>
</p></ol>
<h2 data-text="Compute l-diversity" id="compute-l">Compute l-diversity</h2>
<p>Cloud DLP performs risk analysis whenever a risk analysis
job runs. You must create the job first, either by using the
Cloud console, sending a DLP API request, or using a
Cloud DLP client library.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-l-diversity-code-sample">
<section>
<h3 data-text="Console" id="dlp-l-diversity-console" track-metadata-position="dlp-l-diversity" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>On the <strong>Create</strong> menu, point to <strong>Job or job trigger</strong>, and then select
 <strong>Re-identification risk analysis</strong>.
 <img alt="" class="screenshot" src="/dlp/docs/images/compute-risk-analysis-new-job.png" width="800"/></p></li>
<li><p>In the <strong>Choose input data</strong> section of the <strong>New risk analysis job</strong> page,
 first specify the BigQuery table to scan by entering the project
 ID of the project containing the table, the dataset ID of the table, and
 the name of the table where specified.</p></li>
<li><p>Under <strong>Privacy metric to compute</strong>, select <strong>l-diversity</strong>.</p></li>
<li><p>In the <strong>Job ID</strong> section, you can optionally give the job a custom
 identifier and select <a href="/dlp/docs/specifying-location">a resource location</a>
 in which Cloud DLP will process your data. When you're done,
 click <strong>Continue</strong>.</p></li>
<li><p>In the <strong>Define fields</strong> section, you specify <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">sensitive fields and
 quasi-identifiers</a>
 for the <em>l</em>-diversity risk job. Cloud DLP accesses the
 metadata of the BigQuery table you specified in the previous
 step and attempts to populate the list of fields.</p>
<ol>
<li>Select the appropriate checkbox to specify a field as either a
sensitive field (S) or quasi-identifier (QI). You must select 1
sensitive field and at least 1 quasi-identifier.</li>
<li>If Cloud DLP isn't able to populate the fields, click
<strong>Enter field name</strong> to manually enter one or more fields and set each
one as sensitive field or quasi-identifier.
When you're done, click <strong>Continue</strong>.</li>
</ol></li>
<li><p>In the <strong>Add actions</strong> section, you can add optional
 <a href="/dlp/docs/concepts-actions">actions</a> to perform when the risk job is
 complete. The available options are:</p>
<aside class="special"><strong>Important:</strong><span> Be aware that running a risk analysis job may persist some of the
  <a href="/dlp/docs/quote">quote</a> values of the selected quasi-identifiers to the
  risk analysis job results. These quote values are used to build the
  histogram and output tables.</span></aside>
<ul>
<li><strong>Save to BigQuery</strong>: Saves the results of the risk
analysis scan to a BigQuery table.</li>
<li><strong>Publish to Pub/Sub</strong>: Publishes a notification to a
<a href="/pubsub/docs/publisher">Pub/Sub topic</a>.</li>
<li><strong>Notify by email</strong>: Sends you an email with results.
When you're done, click <strong>Create</strong>.</li>
</ul></li>
</ol>
<p>The <em>l</em>-diversity risk analysis job starts immediately.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-l-diversity-protocol" track-metadata-position="dlp-l-diversity" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>To run a new risk analysis job to compute <em>l</em>-diversity, send a request to the
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
  resource, where <var translate="no">PROJECT_ID</var> indicates your <a href="/resource-manager/docs/creating-managing-projects#identifying_projects">project
  identifier</a>:</p>
<p><pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs</pre></p>
<p>The request contains a
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create#riskanalysisjobconfig"><code dir="ltr" translate="no">RiskAnalysisJobConfig</code></a>
  object, which is composed of the following:</p>
<ul>
<li><p>A
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#privacymetric"><code dir="ltr" translate="no">PrivacyMetric</code></a>
object. This is where you specify that you're calculating <em>l</em>-diversity by
including an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#ldiversityconfig"><code dir="ltr" translate="no">LDiversityConfig</code></a>
object.</p></li>
<li><p>A <a href="/dlp/docs/reference/rest/v2/BigQueryTable"><code dir="ltr" translate="no">BigQueryTable</code></a>
object. Specify the BigQuery table to scan by including all of
the following:</p>
<ul>
<li><code dir="ltr" translate="no">projectId</code>: The project ID of the project containing the table.</li>
<li><code dir="ltr" translate="no">datasetId</code>: The dataset ID of the table.</li>
<li><code dir="ltr" translate="no">tableId</code>: The name of the table.</li>
</ul></li>
<li><p>A set of one or more
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>
objects, which represent actions to run, in the order given, at the
completion of the job. Each <code dir="ltr" translate="no">Action</code> object can contain one of the
following actions:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#SaveFindings"><code dir="ltr" translate="no">SaveFindings</code></a>
object: Saves the results of the risk analysis scan to a
BigQuery table.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToPubSub"><code dir="ltr" translate="no">PublishToPubSub</code></a>
object:
<a href="/pubsub/docs/publisher">Publishes a notification to a Pub/Sub topic</a>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#JobNotificationEmails"><code dir="ltr" translate="no">JobNotificationEmails</code></a>
object: Sends you an email with results.</li>
</ul>
<p>Within the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#ldiversityconfig"><code dir="ltr" translate="no">LDiversityConfig</code></a>
object, you specify the following:</p>
<aside class="special"><strong>Important:</strong><span> Be aware that running a risk analysis job may persist some of the
<a href="/dlp/docs/quote">quote</a> values of the selected quasi-identifiers to the
risk analysis job results. These quote values are used to build the
histogram and output tables.</span></aside>
<ul>
<li><code dir="ltr" translate="no">quasiIds[]</code>: A set of quasi-identifiers
(<a href="/dlp/docs/reference/rest/v2/FieldId"><code dir="ltr" translate="no">FieldId</code></a>
objects) that indicate how equivalence classes are defined for the
<em>l</em>-diversity computation. As with <code dir="ltr" translate="no">KAnonymityConfig</code>, when you specify
multiple fields, they are considered a single composite key.</li>
<li><code dir="ltr" translate="no">sensitiveAttribute</code>: Sensitive field
(<a href="/dlp/docs/reference/rest/v2/FieldId"><code dir="ltr" translate="no">FieldId</code></a>
object) for computing the <em>l</em>-diversity value.</li>
</ul></li>
</ul>
<p>As soon as you send a request to the DLP API, it starts the risk
analysis job.</p>
</section>
<section>
<h3 data-text="Java" id="dlp-l-diversity-java" track-metadata-position="dlp-l-diversity" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-l-diversity" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisLDiversity.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisLDiversity.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-l-diversity" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-l-diversity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisLDiversity.java" data-region-tag="dlp_l_diversity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisLDiversity.java/HEAD/dlp_l_diversity" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.dlp.v2.DlpServiceSettings;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.Action.PublishToPubSub;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.LDiversityResult;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.LDiversityResult.LDiversityEquivalenceClass;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.LDiversityResult.LDiversityHistogramBucket;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrivacyMetric;
import com.google.privacy.dlp.v2.PrivacyMetric.LDiversityConfig;
import com.google.privacy.dlp.v2.RiskAnalysisJobConfig;
import com.google.privacy.dlp.v2.Value;
import com.google.privacy.dlp.v2.ValueFrequency;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.ProjectTopicName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import java.util.stream.Collectors;
import org.threeten.bp.Duration;

class RiskAnalysisLDiversity {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String datasetId = "your-bigquery-dataset-id";
    String tableId = "your-bigquery-table-id";
    String topicId = "pub-sub-topic";
    String subscriptionId = "pub-sub-subscription";
    calculateLDiversity(projectId, datasetId, tableId, topicId, subscriptionId);
  }

  public static void calculateLDiversity(
      String projectId, String datasetId, String tableId, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {

    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    DlpServiceSettings.Builder dlpServiceSettingsBuilder = DlpServiceSettings.newBuilder();
    dlpServiceSettingsBuilder
        .getDlpJobSettings()
        .setRetrySettings(
            dlpServiceSettingsBuilder
                .getDlpJobSettings()
                .getRetrySettings()
                .toBuilder()
                .setTotalTimeout(Duration.ofSeconds(600))
                .build());
    try (DlpServiceClient dlpServiceClient =
        DlpServiceClient.create(dlpServiceSettingsBuilder.build())) {
      // Specify the BigQuery table to analyze
      BigQueryTable bigQueryTable =
          BigQueryTable.newBuilder()
              .setProjectId(projectId)
              .setDatasetId(datasetId)
              .setTableId(tableId)
              .build();

      // These values represent the column names of quasi-identifiers to analyze
      List&lt;String&gt; quasiIds = Arrays.asList("Age", "Mystery");

      // This value represents the column name to compare the quasi-identifiers against
      String sensitiveAttribute = "Name";

      // Configure the privacy metric for the job
      FieldId sensitiveAttributeField = FieldId.newBuilder().setName(sensitiveAttribute).build();
      List&lt;FieldId&gt; quasiIdFields =
          quasiIds.stream()
              .map(columnName -&gt; FieldId.newBuilder().setName(columnName).build())
              .collect(Collectors.toList());
      LDiversityConfig ldiversityConfig =
          LDiversityConfig.newBuilder()
              .addAllQuasiIds(quasiIdFields)
              .setSensitiveAttribute(sensitiveAttributeField)
              .build();
      PrivacyMetric privacyMetric =
          PrivacyMetric.newBuilder().setLDiversityConfig(ldiversityConfig).build();

      // Create action to publish job status notifications over Google Cloud Pub/
      ProjectTopicName topicName = ProjectTopicName.of(projectId, topicId);
      PublishToPubSub publishToPubSub =
          PublishToPubSub.newBuilder().setTopic(topicName.toString()).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the risk analysis job to perform
      RiskAnalysisJobConfig riskAnalysisJobConfig =
          RiskAnalysisJobConfig.newBuilder()
              .setSourceTable(bigQueryTable)
              .setPrivacyMetric(privacyMetric)
              .addActions(action)
              .build();

      // Build the request to be sent by the client
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setRiskJob(riskAnalysisJobConfig)
              .build();

      // Send the request to the API using the client
      DlpJob dlpJob = dlpServiceClient.createDlpJob(createDlpJobRequest);

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Build a request to get the completed job
      GetDlpJobRequest getDlpJobRequest =
          GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();

      // Retrieve completed job status
      DlpJob completedJob = dlpServiceClient.getDlpJob(getDlpJobRequest);
      System.out.println("Job status: " + completedJob.getState());

      // Get the result and parse through and process the information
      LDiversityResult ldiversityResult = completedJob.getRiskDetails().getLDiversityResult();
      List&lt;LDiversityHistogramBucket&gt; histogramBucketList =
          ldiversityResult.getSensitiveValueFrequencyHistogramBucketsList();
      for (LDiversityHistogramBucket result : histogramBucketList) {
        for (LDiversityEquivalenceClass bucket : result.getBucketValuesList()) {
          List&lt;String&gt; quasiIdValues =
              bucket.getQuasiIdsValuesList().stream()
                  .map(Value::toString)
                  .collect(Collectors.toList());

          System.out.println("\tQuasi-ID values: " + String.join(", ", quasiIdValues));
          System.out.println("\tClass size: " + bucket.getEquivalenceClassSize());

          for (ValueFrequency valueFrequency : bucket.getTopSensitiveValuesList()) {
            System.out.printf(
                "\t\tSensitive value %s occurs %d time(s).\n",
                valueFrequency.getValue().toString(), valueFrequency.getCount());
          }
        }
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-l-diversity-nodejs" track-metadata-position="dlp-l-diversity" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-l-diversity" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/lDiversityAnalysis.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/lDiversityAnalysis.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-l-diversity" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-l-diversity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/lDiversityAnalysis.js" data-region-tag="dlp_l_diversity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/lDiversityAnalysis.js/HEAD/dlp_l_diversity" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the table is stored under
// This may or (for public datasets) may not equal the calling project ID
// const tableProjectId = 'my-project';

// The ID of the dataset to inspect, e.g. 'my_dataset'
// const datasetId = 'my_dataset';

// The ID of the table to inspect, e.g. 'my_table'
// const tableId = 'my_table';

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

// The column to measure l-diversity relative to, e.g. 'firstName'
// const sensitiveAttribute = 'name';

// A set of columns that form a composite key ('quasi-identifiers')
// const quasiIds = [{ name: 'age' }, { name: 'city' }];

async function lDiversityAnalysis() {
  const sourceTable = {
    projectId: tableProjectId,
    datasetId: datasetId,
    tableId: tableId,
  };

  // Construct request for creating a risk analysis job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    riskJob: {
      privacyMetric: {
        lDiversityConfig: {
          quasiIds: quasiIds,
          sensitiveAttribute: {
            name: sensitiveAttribute,
          },
        },
      },
      sourceTable: sourceTable,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };

  // Create helper function for unpacking values
  const getValue = obj =&gt; obj[Object.keys(obj)[0]];

  // Run risk analysis job
  const [topicResponse] = await pubsub.topic(topicId).get();
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  setTimeout(() =&gt; {
    console.log(' Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  const histogramBuckets =
    job.riskDetails.lDiversityResult.sensitiveValueFrequencyHistogramBuckets;

  histogramBuckets.forEach((histogramBucket, histogramBucketIdx) =&gt; {
    console.log(`Bucket ${histogramBucketIdx}:`);

    console.log(
      `Bucket size range: [${histogramBucket.sensitiveValueFrequencyLowerBound}, ${histogramBucket.sensitiveValueFrequencyUpperBound}]`
    );
    histogramBucket.bucketValues.forEach(valueBucket =&gt; {
      const quasiIdValues = valueBucket.quasiIdsValues
        .map(getValue)
        .join(', ');
      console.log(`  Quasi-ID values: {${quasiIdValues}}`);
      console.log(`  Class size: ${valueBucket.equivalenceClassSize}`);
      valueBucket.topSensitiveValues.forEach(valueObj =&gt; {
        console.log(
          `    Sensitive value ${getValue(valueObj.value)} occurs ${
            valueObj.count
          } time(s).`
        );
      });
    });
  });
}

lDiversityAnalysis();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-l-diversity-python" track-metadata-position="dlp-l-diversity" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-l-diversity" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-l-diversity" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-l-diversity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/risk.py" data-region-tag="dlp_l_diversity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/risk.py/HEAD/dlp_l_diversity" translate="no"><code dir="ltr" translate="no">def l_diversity_analysis(
    project,
    table_project_id,
    dataset_id,
    table_id,
    topic_id,
    subscription_id,
    sensitive_attribute,
    quasi_ids,
    timeout=300,
):
    """Uses the Data Loss Prevention API to compute the l-diversity of a
        column set in a Google BigQuery table.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        table_project_id: The Google Cloud project id where the BigQuery table
            is stored.
        dataset_id: The id of the dataset to inspect.
        table_id: The id of the table to inspect.
        topic_id: The name of the Pub/Sub topic to notify once the job
            completes.
        subscription_id: The name of the Pub/Sub subscription to use when
            listening for job completion notifications.
        sensitive_attribute: The column to measure l-diversity relative to.
        quasi_ids: A set of columns that form a composite key.
        timeout: The number of seconds to wait for a response from the API.

    Returns:
        None; the response from the API is printed to the terminal.
    """
    import concurrent.futures

    # Import the client library.
    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Create helper function for unpacking values
    def get_values(obj):
        return int(obj.integer_value)

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Location info of the BigQuery table.
    source_table = {
        "project_id": table_project_id,
        "dataset_id": dataset_id,
        "table_id": table_id,
    }

    # Convert quasi id list to Protobuf type
    def map_fields(field):
        return {"name": field}

    quasi_ids = map(map_fields, quasi_ids)

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Configure risk analysis job
    # Give the name of the numeric column to compute risk metrics for
    risk_job = {
        "privacy_metric": {
            "l_diversity_config": {
                "quasi_ids": quasi_ids,
                "sensitive_attribute": {"name": sensitive_attribute},
            }
        },
        "source_table": source_table,
        "actions": actions,
    }

    # Call API to start risk analysis job
    operation = dlp.create_dlp_job(request={"parent": parent, "risk_job": risk_job})

    def callback(message):
        if message.attributes["DlpJobName"] == operation.name:
            # This is the message we're looking for, so acknowledge it.
            message.ack()

            # Now that the job is done, fetch the results and print them.
            job = dlp.get_dlp_job(request={"name": operation.name})
            histogram_buckets = (
                job.risk_details.l_diversity_result.sensitive_value_frequency_histogram_buckets  # noqa: E501
            )
            # Print bucket stats
            for i, bucket in enumerate(histogram_buckets):
                print("Bucket {}:".format(i))
                print(
                    "   Bucket size range: [{}, {}]".format(
                        bucket.sensitive_value_frequency_lower_bound,
                        bucket.sensitive_value_frequency_upper_bound,
                    )
                )
                for value_bucket in bucket.bucket_values:
                    print(
                        "   Quasi-ID values: {}".format(
                            map(get_values, value_bucket.quasi_ids_values)
                        )
                    )
                    print(
                        "   Class size: {}".format(value_bucket.equivalence_class_size)
                    )
                    for value in value_bucket.top_sensitive_values:
                        print(
                            (
                                "   Sensitive value {} occurs {} time(s)".format(
                                    value.value, value.count
                                )
                            )
                        )
            subscription.set_result(None)
        else:
            # This is not the message we're looking for.
            message.drop()

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)
    subscription = subscriber.subscribe(subscription_path, callback)

    try:
        subscription.result(timeout=timeout)
    except concurrent.futures.TimeoutError:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )
        subscription.close()

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-l-diversity-go" track-metadata-position="dlp-l-diversity" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-l-diversity" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/l_diversity.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/l_diversity.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-l-diversity" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-l-diversity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/l_diversity.go" data-region-tag="dlp_l_diversity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/l_diversity.go/HEAD/dlp_l_diversity" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"strings"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// riskLDiversity computes the L Diversity of the given columns.
func riskLDiversity(w io.Writer, projectID, dataProject, pubSubTopic, pubSubSub, datasetID, tableID, sensitiveAttribute string, columnNames ...string) error {
	// projectID := "my-project-id"
	// dataProject := "bigquery-public-data"
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// datasetID := "nhtsa_traffic_fatalities"
	// tableID := "accident_2015"
	// sensitiveAttribute := "city"
	// columnNames := "state_number", "county"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}

	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("Error creating PubSub client: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	s, err := setupPubSub(projectID, pubSubTopic, pubSubSub)
	if err != nil {
		return fmt.Errorf("setupPubSub: %v", err)
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Build the QuasiID slice.
	var q []*dlppb.FieldId
	for _, c := range columnNames {
		q = append(q, &amp;dlppb.FieldId{Name: c})
	}

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_RiskJob{
			RiskJob: &amp;dlppb.RiskAnalysisJobConfig{
				// PrivacyMetric configures what to compute.
				PrivacyMetric: &amp;dlppb.PrivacyMetric{
					Type: &amp;dlppb.PrivacyMetric_LDiversityConfig_{
						LDiversityConfig: &amp;dlppb.PrivacyMetric_LDiversityConfig{
							QuasiIds: q,
							SensitiveAttribute: &amp;dlppb.FieldId{
								Name: sensitiveAttribute,
							},
						},
					},
				},
				// SourceTable describes where to find the data.
				SourceTable: &amp;dlppb.BigQueryTable{
					ProjectId: dataProject,
					DatasetId: datasetID,
					TableId:   tableID,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the risk job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the risk job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()
		time.Sleep(500 * time.Millisecond)
		j, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "GetDlpJob: %v", err)
			return
		}
		h := j.GetRiskDetails().GetLDiversityResult().GetSensitiveValueFrequencyHistogramBuckets()
		for i, b := range h {
			fmt.Fprintf(w, "Histogram bucket %v\n", i)
			fmt.Fprintf(w, "  Size range: [%v,%v]\n", b.GetSensitiveValueFrequencyLowerBound(), b.GetSensitiveValueFrequencyUpperBound())
			fmt.Fprintf(w, "  %v unique values total\n", b.GetBucketSize())
			for _, v := range b.GetBucketValues() {
				var qvs []string
				for _, qv := range v.GetQuasiIdsValues() {
					qvs = append(qvs, qv.String())
				}
				fmt.Fprintf(w, "    QuasiID values: %s\n", strings.Join(qvs, ", "))
				fmt.Fprintf(w, "    Class size: %v\n", v.GetEquivalenceClassSize())
				for _, sv := range v.GetTopSensitiveValues() {
					fmt.Fprintf(w, "    Sensitive value %v occurs %v times\n", sv.GetValue(), sv.GetCount())
				}
			}
		}
		// Stop listening for more messages.
		cancel()
	})
	if err != nil {
		return fmt.Errorf("Recieve: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-l-diversity-php" track-metadata-position="dlp-l-diversity" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-l-diversity" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/l_diversity.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/l_diversity.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-l-diversity" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-l-diversity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/l_diversity.php" data-region-tag="dlp_l_diversity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/l_diversity.php/HEAD/dlp_l_diversity" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\RiskAnalysisJobConfig;
use Google\Cloud\Dlp\V2\BigQueryTable;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\PrivacyMetric\LDiversityConfig;
use Google\Cloud\Dlp\V2\PrivacyMetric;
use Google\Cloud\Dlp\V2\FieldId;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Computes the l-diversity of a column set in a Google BigQuery table.
 *
 * @param string    $callingProjectId    The project ID to run the API call under
 * @param string    $dataProjectId       The project ID containing the target Datastore
 * @param string    $topicId             The name of the Pub/Sub topic to notify once the job completes
 * @param string    $subscriptionId      The name of the Pub/Sub subscription to use when listening for job
 * @param string    $datasetId           The ID of the dataset to inspect
 * @param string    $tableId             The ID of the table to inspect
 * @param string    $sensitiveAttribute  The column to measure l-diversity relative to, e.g. "firstName"
 * @param string[]  $quasiIdNames        Array columns that form a composite key (quasi-identifiers)
 */
function l_diversity(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $datasetId,
    string $tableId,
    string $sensitiveAttribute,
    array  $quasiIdNames
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $pubsub = new PubSubClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $topic = $pubsub-&gt;topic($topicId);

    // Construct risk analysis config
    $quasiIds = array_map(
        function ($id) {
            return (new FieldId())-&gt;setName($id);
        },
        $quasiIdNames
    );

    $sensitiveField = (new FieldId())
        -&gt;setName($sensitiveAttribute);

    $statsConfig = (new LDiversityConfig())
        -&gt;setQuasiIds($quasiIds)
        -&gt;setSensitiveAttribute($sensitiveField);

    $privacyMetric = (new PrivacyMetric())
        -&gt;setLDiversityConfig($statsConfig);

    // Construct items to be analyzed
    $bigqueryTable = (new BigQueryTable())
        -&gt;setProjectId($dataProjectId)
        -&gt;setDatasetId($datasetId)
        -&gt;setTableId($tableId);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct risk analysis job config to run
    $riskJob = (new RiskAnalysisJobConfig())
        -&gt;setPrivacyMetric($privacyMetric)
        -&gt;setSourceTable($bigqueryTable)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'riskJob' =&gt; $riskJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $histBuckets = $job-&gt;getRiskDetails()-&gt;getLDiversityResult()-&gt;getSensitiveValueFrequencyHistogramBuckets();

            foreach ($histBuckets as $bucketIndex =&gt; $histBucket) {
                // Print bucket stats
                printf('Bucket %s:' . PHP_EOL, $bucketIndex);
                printf(
                    '  Bucket size range: [%s, %s]' . PHP_EOL,
                    $histBucket-&gt;getSensitiveValueFrequencyLowerBound(),
                    $histBucket-&gt;getSensitiveValueFrequencyUpperBound()
                );

                // Print bucket values
                foreach ($histBucket-&gt;getBucketValues() as $percent =&gt; $valueBucket) {
                    printf(
                        '  Class size: %s' . PHP_EOL,
                        $valueBucket-&gt;getEquivalenceClassSize()
                    );

                    // Pretty-print quasi-ID values
                    print('  Quasi-ID values:' . PHP_EOL);
                    foreach ($valueBucket-&gt;getQuasiIdsValues() as $index =&gt; $value) {
                        print('    ' . $value-&gt;serializeToJsonString() . PHP_EOL);
                    }

                    // Pretty-print sensitive values
                    $topValues = $valueBucket-&gt;getTopSensitiveValues();
                    foreach ($topValues as $topValue) {
                        printf(
                            '  Sensitive value %s occurs %s time(s).' . PHP_EOL,
                            $topValue-&gt;getValue()-&gt;serializeToJsonString(),
                            $topValue-&gt;getCount()
                        );
                    }
                }
            }
            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            printf('Unexpected job state. Most likely, the job is either running or has not yet started.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-l-diversity-csharp" track-metadata-position="dlp-l-diversity" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-l-diversity" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateLDiversity.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateLDiversity.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-l-diversity" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-l-diversity" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateLDiversity.cs" data-region-tag="dlp_l_diversity" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateLDiversity.cs/HEAD/dlp_l_diversity" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Cloud.PubSub.V1;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using static Google.Cloud.Dlp.V2.Action.Types;
using static Google.Cloud.Dlp.V2.PrivacyMetric.Types;

public class RiskAnalysisCreateLDiversity
{
    public static object LDiversity(
        string callingProjectId,
        string tableProjectId,
        string datasetId,
        string tableId,
        string topicId,
        string subscriptionId,
        IEnumerable&lt;FieldId&gt; quasiIds,
        string sensitiveAttribute)
    {
        var dlp = DlpServiceClient.Create();

        // Construct + submit the job
        var ldiversityConfig = new LDiversityConfig
        {
            SensitiveAttribute = new FieldId { Name = sensitiveAttribute },
            QuasiIds = { quasiIds }
        };

        var config = new RiskAnalysisJobConfig
        {
            PrivacyMetric = new PrivacyMetric
            {
                LDiversityConfig = ldiversityConfig
            },
            SourceTable = new BigQueryTable
            {
                ProjectId = tableProjectId,
                DatasetId = datasetId,
                TableId = tableId
            },
            Actions =
            {
                new Google.Cloud.Dlp.V2.Action
                {
                    PubSub = new PublishToPubSub
                    {
                        Topic = $"projects/{callingProjectId}/topics/{topicId}"
                    }
                }
            }
        };

        var submittedJob = dlp.CreateDlpJob(
            new CreateDlpJobRequest
            {
                ParentAsProjectName = new ProjectName(callingProjectId),
                RiskJob = config
            });

        // Listen to pub/sub for the job
        var subscriptionName = new SubscriptionName(callingProjectId, subscriptionId);
        var subscriber = SubscriberClient.CreateAsync(subscriptionName).Result;

        // SimpleSubscriber runs your message handle function on multiple
        // threads to maximize throughput.
        var done = new ManualResetEventSlim(false);
        subscriber.StartAsync((PubsubMessage message, CancellationToken cancel) =&gt;
        {
            if (message.Attributes["DlpJobName"] == submittedJob.Name)
            {
                Thread.Sleep(500); // Wait for DLP API results to become consistent
                done.Set();
                return Task.FromResult(SubscriberClient.Reply.Ack);
            }
            else
            {
                return Task.FromResult(SubscriberClient.Reply.Nack);
            }
        });

        done.Wait(TimeSpan.FromMinutes(10)); // 10 minute timeout; may not work for large jobs
        subscriber.StopAsync(CancellationToken.None).Wait();

        // Process results
        var resultJob = dlp.GetDlpJob(
            new GetDlpJobRequest
            {
                DlpJobName = DlpJobName.Parse(submittedJob.Name)
            });

        var result = resultJob.RiskDetails.LDiversityResult;

        for (var bucketIdx = 0; bucketIdx &lt; result.SensitiveValueFrequencyHistogramBuckets.Count; bucketIdx++)
        {
            var bucket = result.SensitiveValueFrequencyHistogramBuckets[bucketIdx];
            Console.WriteLine($"Bucket {bucketIdx}");
            Console.WriteLine($"  Bucket size range: [{bucket.SensitiveValueFrequencyLowerBound}, {bucket.SensitiveValueFrequencyUpperBound}].");
            Console.WriteLine($"  {bucket.BucketSize} unique value(s) total.");

            foreach (var bucketValue in bucket.BucketValues)
            {
                // 'UnpackValue(x)' is a prettier version of 'x.toString()'
                Console.WriteLine($"    Quasi-ID values: [{String.Join(',', bucketValue.QuasiIdsValues.Select(x =&gt; UnpackValue(x)))}]");
                Console.WriteLine($"    Class size: {bucketValue.EquivalenceClassSize}");

                foreach (var topValue in bucketValue.TopSensitiveValues)
                {
                    Console.WriteLine($"    Sensitive value {UnpackValue(topValue.Value)} occurs {topValue.Count} time(s).");
                }
            }
        }

        return result;
    }

    public static string UnpackValue(Value protoValue)
    {
        var jsonValue = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, object&gt;&gt;(protoValue.ToString());
        return jsonValue.Values.ElementAt(0).ToString();
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="List completed risk analysis jobs" id="list-jobs">List completed risk analysis jobs</h2>
<p>You can view a list of the risk analysis jobs that have been run in the current
project.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Console " id="console"> Console </h3><p>To list running and previously run risk analysis jobs in the
Cloud console, do the following:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>Click the <strong>Jobs &amp; job triggers</strong> tab at the top of the page.</p></li>
<li><p>Click the <strong>Risk jobs</strong> tab.</p></li>
</ol>
<p>The risk job listing appears.</p></section>
<section><h3 data-text=" Protocol " id="protocol"> Protocol </h3><p>To list running and previously run risk analysis jobs, send a GET request to
the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource. Adding a job type filter (<code dir="ltr" translate="no">?type=RISK_ANALYSIS_JOB</code>) narrows the
response to only risk analysis jobs.</p>
<pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs?type=RISK_ANALYSIS_JOB</pre>
<p>The response you receive contains a JSON representation of all current and
previous risk analysis jobs.</p></section>
</div>
<h2 data-text="View l-diversity job results" id="viewing-results">View l-diversity job results</h2>
<p>Cloud DLP in the Cloud console features built-in
visualizations for completed <em>l</em>-diversity jobs. After following the
instructions in the previous section, from the risk analysis job listing, select
the job for which you want to view results. Assuming the job has run
successfully, the top of the <strong>Risk analysis details</strong> page looks like this:</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/compute-risk-analysis-l-results1.png" width="800"/></p>
<p>At the top of the page is information about the <em>l</em>-diversity risk job,
including its job ID and, under <strong>Container</strong>, its resource location.</p>
<p>To view the results of the <em>l</em>-diversity calculation, click the <strong>L-diversity</strong>
tab. To view the risk analysis job's configuration, click the <strong>Configuration</strong>
tab.</p>
<p>The <strong>L-diversity</strong> tab first lists the sensitive value and the
quasi-identifiers used to calculate <em>l</em>-diversity.</p>
<h3 data-text="Risk chart" id="risk_chart">Risk chart</h3>
<p>The <strong>Re-identification risk</strong> chart plots, on the <em>y</em>-axis, the potential
percentage of data loss for both unique rows and unique quasi-identifier
combinations to achieve, on the <em>x</em>-axis, an <em>l</em>-diversity value. The chart's
color also indicates risk potential. Darker shades of blue indicate a higher
risk, while lighter shades indicate less risk.</p>
<p>Higher <em>l</em>-diversity values indicate less diversity of values, which can make a
dataset less re-identifiable and more secure. To achieve higher <em>l</em>-diversity
values, however, you would need to remove higher percentages of the total rows
and higher unique quasi-identifier combinations, which might decrease the
utility of the data. To see a specific potential percentage loss value for a
certain <em>l</em>-diversity value, hover your cursor over the chart. As shown in the
screenshot, a tooltip appears on the chart.</p>
<p>To view more detail about a specific <em>l</em>-diversity value, click the
corresponding data point. A detailed explanation is shown under the chart and a
sample data table appears further down the page.</p>
<h3 data-text="Risk sample data table" id="risk_sample_data_table">Risk sample data table</h3>
<p>The second component to the risk job results page is the sample data table. It
displays quasi-identifier combinations for a given target <em>l</em>-diversity value.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/compute-risk-analysis-l-results2.png" width="800"/></p>
<p>The first column of the table lists the k-anonymity values. Click an
<em>l</em>-diversity value to view corresponding sample data that would need to be
dropped to achieve that value.</p>
<p>The second column displays the respective potential data loss of unique rows and
quasi-identifier combinations to achieve the selected <em>l</em>-diversity value, as
well as the number of groups with at least <em>l</em> sensitive attributes and the
total number of records.</p>
<p>The last column displays a sample of groups that share a quasi-identifier
combination, along with the number of records that exist for that combination.</p>
<h2 data-text="Retrieve job details using REST" id="retrieve_job_details_using_rest">Retrieve job details using REST</h2>
<p>To retrieve the results of the <em>l</em>-diversity risk analysis job using the REST
API, send the following GET request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource. Replace <var translate="no">PROJECT_ID</var> with your project ID and
<var translate="no">JOB_ID</var> with the identifier of the job you want to obtain results for.
The job ID was returned when you started the job, and can also be retrieved by
<a href="#list-jobs">listing all jobs</a>.</p>
<pre dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs/<var translate="no">JOB_ID</var></pre>
<p>The request returns a JSON object containing an instance of the job. The results
of the analysis are inside the <code dir="ltr" translate="no">"riskDetails"</code> key, in an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AnalyzeDataSourceRiskDetails"><code dir="ltr" translate="no">AnalyzeDataSourceRiskDetails</code></a>
object. For more information, see the API reference for the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>
resource.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to calculate the <a href="/dlp/docs/compute-k-anonymity"><em>k</em>-anonymity</a>
value for a dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-k-map"><em>k</em>-map</a> value for a
dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-d-presence"><em>Î´</em>-presence</a> value
for a dataset.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/compute-k-map]</H1></p><div class="devsite-article-body clearfix">
<p><em>K-map</em> is very similar to <em>k</em>-anonymity, except that it assumes that the
attacker most likely doesn't know who is in the dataset. Use <em>k</em>-map if your
dataset is relatively small, or if the level of effort involved in generalizing
attributes would be too high.</p>
<p>Just like <em>k</em>-anonymity, <em>k</em>-map requires you to determine which columns of your
database are quasi-identifiers. In doing this, you are stating what data an
attacker will most likely use to re-identify subjects. In addition, computing a
<em>k</em>-map value requires a re-identification dataset: a larger table with which to
compare rows in the original dataset.</p>
<p>This topic demonstrates how to compute <em>k</em>-map values for a dataset using
Cloud Data Loss Prevention. For more information about <em>k</em>-map or risk analysis in
general, see the <a href="/dlp/docs/concepts-risk-analysis">risk analysis concept topic</a>
before continuing on.</p>
<aside class="note"><strong>Note:</strong><span> At this time, you can only compute <em>k</em>-map values using the
DLP API or Cloud DLP-supported <a href="/dlp/docs/libraries">client
libraries</a>. Cloud DLP in the
Cloud console doesn't support computing <em>k</em>-map values.</span></aside>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<h2 data-text="   Before you begin " id="before-you-begin">
  Before you begin
</h2>
<p>
  Before continuing, be sure you've done the following:
</p>
<ol>
<li><a href="https://accounts.google.com/Login">Sign in</a> to your Google Account.</li>
<li>In the Google Cloud console, on the project selector page, select or create a
     Google Cloud project.</li>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console">Go to the project selector</a>
<li>Make sure that billing is enabled for your Google Cloud project. <a href="/billing/docs/how-to/modify-project">Learn how to confirm billing is enabled for your
        project.</a></li>
<li>Enable Cloud DLP.</li>
<a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console">Enable Cloud DLP</a>
<!--- Must close the ordered list! ---->
<p><li>Select a BigQuery dataset to analyze. Cloud DLP
  estimates the <em>k</em>-map metric by scanning a BigQuery table.</li>
<li>Determine the types of datasets you want to use to model the attack
  dataset. For more information, see the reference page for the
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.KMapEstimationConfig"><code dir="ltr" translate="no">KMapEstimationConfig</code></a>
  object, as well as <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">Risk
  analysis terms and techniques</a>.</li>
</p></ol>
<h2 data-text="Compute k-map estimates" id="compute-k-map">Compute <em>k</em>-map estimates</h2>
<p>You can estimate <em>k</em>-map values using Cloud DLP, which uses
a statistical model to estimate a re-identification dataset. This is in contrast
to the other risk analysis methods, in which the attack dataset is explicitly
known. Depending on the type of data, Cloud DLP uses publicly
available datasets (for example, from the US Census) or a custom statistical
model (for example, one or more BigQuery tables that you specify), or
it extrapolates from the distribution of values in your input dataset. For more
information, see the reference page for the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.KMapEstimationConfig"><code dir="ltr" translate="no">KMapEstimationConfig</code></a>
object.</p>
<p>To compute a <em>k</em>-map estimate using Cloud DLP, first configure the
risk job. Compose a request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource, where <var translate="no">PROJECT_ID</var> indicates your <a href="/resource-manager/docs/creating-managing-projects#identifying_projects">project
identifier</a>:</p>
<pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs</pre>
<p>The request contains a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create#riskanalysisjobconfig"><code dir="ltr" translate="no">RiskAnalysisJobConfig</code></a>
object, which is composed of the following:</p>
<ul>
<li><p>A
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#privacymetric"><code dir="ltr" translate="no">PrivacyMetric</code></a>
object. This is where you specify that you want to calculate <em>k</em>-map by
specifying a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#kmapestimationconfig"><code dir="ltr" translate="no">KMapEstimationConfig</code></a>
object containing the following:</p>
<ul>
<li><p><code dir="ltr" translate="no">quasiIds[]</code>: Required. Fields
(<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.TaggedField"><code dir="ltr" translate="no">TaggedField</code></a>
objects) considered to be quasi-identifiers to scan and use to compute
<em>k</em>-map. No two columns can have the same tag. These can be any of the
following:</p>
<ul>
<li>An <a href="/dlp/docs/reference/rest/v2/InfoType">infoType</a>:
This causes Cloud DLP to use the relevant public
dataset as a statistical model of population, including US ZIP codes,
region codes, ages, and genders.</li>
<li>A custom infoType: A custom tag wherein you indicate an
auxiliary table (an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AuxiliaryTable"><code dir="ltr" translate="no">AuxiliaryTable</code></a>
object) that contains statistical information about the possible values
of this column.</li>
<li>The <code dir="ltr" translate="no">inferred</code> tag: If no semantic tag is indicated, specify
<code dir="ltr" translate="no">inferred</code>. Cloud DLP infers the statistical model
from the distribution of values in the input data.</li>
</ul></li>
<li><p><code dir="ltr" translate="no">regionCode</code>: An
<a class="external" href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2 region code</a> 
for Cloud DLP to use in statistical modeling. This value
is required if no column is tagged with a region-specific infoType (for
example, a US ZIP code) or a region code.</p></li>
<li><p><code dir="ltr" translate="no">auxiliaryTables[]</code>: Auxiliary tables
(<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AuxiliaryTable"><code dir="ltr" translate="no">AuxiliaryTable</code></a>
objects) to use in the analysis. Each custom tag used to tag a
quasi-identifier column (from <code dir="ltr" translate="no">quasiIds[]</code>) must appear in exactly one
column of one auxiliary table.</p></li>
</ul></li>
<li><p>A <a href="/dlp/docs/reference/rest/v2/BigQueryTable"><code dir="ltr" translate="no">BigQueryTable</code></a>
object. Specify the BigQuery table to scan by including all of
the following:</p>
<ul>
<li><code dir="ltr" translate="no">projectId</code>: The project ID of the project containing the table.</li>
<li><code dir="ltr" translate="no">datasetId</code>: The dataset ID of the table.</li>
<li><code dir="ltr" translate="no">tableId</code>: The name of the table.</li>
</ul></li>
<li><p>A set of one or more
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>
objects, which represent actions to run, in the order given, at the
completion of the job. Each <code dir="ltr" translate="no">Action</code> object can contain one of the
following actions:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#SaveFindings"><code dir="ltr" translate="no">SaveFindings</code></a>
object: Saves the results of the risk analysis scan to a
BigQuery table.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToPubSub"><code dir="ltr" translate="no">PublishToPubSub</code></a>
object:
Publishes a notification to a <a href="/pubsub/docs/publisher">Pub/Sub topic</a>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishSummaryToCscc"><code dir="ltr" translate="no">PublishSummaryToCscc</code></a>
object: Saves a results summary to Security Command Center.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishFindingsToCloudDataCatalog"><code dir="ltr" translate="no">PublishFindingsToCloudDataCatalog</code></a>
object: Saves results to <a href="/dlp/docs/sending-results-to-dc">Data Catalog</a>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#JobNotificationEmails"><code dir="ltr" translate="no">JobNotificationEmails</code></a>
object: Sends you an email with results.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToStackdriver"><code dir="ltr" translate="no">PublishToStackdriver</code></a>
object: Saves results to Google Cloud's operations suite.</li>
</ul></li>
</ul>
<h3 data-text="Code examples" id="code_examples">Code examples</h3>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to compute a <em>k</em>-map value.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-k-map-code-sample">
<section>
<h3 data-text="Java" id="dlp-k-map-java" track-metadata-position="dlp-k-map" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-map" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKMap.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKMap.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-map" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-k-map" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKMap.java" data-region-tag="dlp_k_map" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisKMap.java/HEAD/dlp_k_map" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.Action.PublishToPubSub;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.KMapEstimationResult;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.KMapEstimationResult.KMapEstimationHistogramBucket;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.KMapEstimationResult.KMapEstimationQuasiIdValues;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrivacyMetric;
import com.google.privacy.dlp.v2.PrivacyMetric.KMapEstimationConfig;
import com.google.privacy.dlp.v2.PrivacyMetric.KMapEstimationConfig.TaggedField;
import com.google.privacy.dlp.v2.RiskAnalysisJobConfig;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.ProjectTopicName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;
import java.util.stream.Collectors;

class RiskAnalysisKMap {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String datasetId = "your-bigquery-dataset-id";
    String tableId = "your-bigquery-table-id";
    String topicId = "pub-sub-topic";
    String subscriptionId = "pub-sub-subscription";
    calculateKMap(projectId, datasetId, tableId, topicId, subscriptionId);
  }

  public static void calculateKMap(
      String projectId, String datasetId, String tableId, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {
      // Specify the BigQuery table to analyze
      BigQueryTable bigQueryTable =
          BigQueryTable.newBuilder()
              .setProjectId(projectId)
              .setDatasetId(datasetId)
              .setTableId(tableId)
              .build();

      // These values represent the column names of quasi-identifiers to analyze
      List&lt;String&gt; quasiIds = Arrays.asList("Age", "Gender");

      // These values represent the info types corresponding to the quasi-identifiers above
      List&lt;String&gt; infoTypeNames = Arrays.asList("AGE", "GENDER");

      // Tag each of the quasiId column names with its corresponding infoType
      List&lt;InfoType&gt; infoTypes =
          infoTypeNames.stream()
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());

      if (quasiIds.size() != infoTypes.size()) {
        throw new IllegalArgumentException("The numbers of quasi-IDs and infoTypes must be equal!");
      }

      List&lt;TaggedField&gt; taggedFields = new ArrayList&lt;TaggedField&gt;();
      for (int i = 0; i &lt; quasiIds.size(); i++) {
        TaggedField taggedField =
            TaggedField.newBuilder()
                .setField(FieldId.newBuilder().setName(quasiIds.get(i)).build())
                .setInfoType(infoTypes.get(i))
                .build();
        taggedFields.add(taggedField);
      }

      // The k-map distribution region can be specified by any ISO-3166-1 region code.
      String regionCode = "US";

      // Configure the privacy metric for the job
      KMapEstimationConfig kmapConfig =
          KMapEstimationConfig.newBuilder()
              .addAllQuasiIds(taggedFields)
              .setRegionCode(regionCode)
              .build();
      PrivacyMetric privacyMetric =
          PrivacyMetric.newBuilder().setKMapEstimationConfig(kmapConfig).build();

      // Create action to publish job status notifications over Google Cloud Pub/Sub
      ProjectTopicName topicName = ProjectTopicName.of(projectId, topicId);
      PublishToPubSub publishToPubSub =
          PublishToPubSub.newBuilder().setTopic(topicName.toString()).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the risk analysis job to perform
      RiskAnalysisJobConfig riskAnalysisJobConfig =
          RiskAnalysisJobConfig.newBuilder()
              .setSourceTable(bigQueryTable)
              .setPrivacyMetric(privacyMetric)
              .addActions(action)
              .build();

      // Build the request to be sent by the client
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setRiskJob(riskAnalysisJobConfig)
              .build();

      // Send the request to the API using the client
      DlpJob dlpJob = dlpServiceClient.createDlpJob(createDlpJobRequest);

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Build a request to get the completed job
      GetDlpJobRequest getDlpJobRequest =
          GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();

      // Retrieve completed job status
      DlpJob completedJob = dlpServiceClient.getDlpJob(getDlpJobRequest);
      System.out.println("Job status: " + completedJob.getState());

      // Get the result and parse through and process the information
      KMapEstimationResult kmapResult = completedJob.getRiskDetails().getKMapEstimationResult();

      for (KMapEstimationHistogramBucket result : kmapResult.getKMapEstimationHistogramList()) {
        System.out.printf(
            "\tAnonymity range: [%d, %d]\n", result.getMinAnonymity(), result.getMaxAnonymity());
        System.out.printf("\tSize: %d\n", result.getBucketSize());

        for (KMapEstimationQuasiIdValues valueBucket : result.getBucketValuesList()) {
          List&lt;String&gt; quasiIdValues =
              valueBucket.getQuasiIdsValuesList().stream()
                  .map(
                      value -&gt; {
                        String s = value.toString();
                        return s.substring(s.indexOf(':') + 1).trim();
                      })
                  .collect(Collectors.toList());

          System.out.printf("\tValues: {%s}\n", String.join(", ", quasiIdValues));
          System.out.printf(
              "\tEstimated k-map anonymity: %d\n", valueBucket.getEstimatedAnonymity());
        }
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-k-map-nodejs" track-metadata-position="dlp-k-map" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-map" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/kMapEstimationAnalysis.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/kMapEstimationAnalysis.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-map" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-k-map" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/kMapEstimationAnalysis.js" data-region-tag="dlp_k_map" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/kMapEstimationAnalysis.js/HEAD/dlp_k_map" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the table is stored under
// This may or (for public datasets) may not equal the calling project ID
// const tableProjectId = 'my-project';

// The ID of the dataset to inspect, e.g. 'my_dataset'
// const datasetId = 'my_dataset';

// The ID of the table to inspect, e.g. 'my_table'
// const tableId = 'my_table';

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

// The ISO 3166-1 region code that the data is representative of
// Can be omitted if using a region-specific infoType (such as US_ZIP_5)
// const regionCode = 'USA';

// A set of columns that form a composite key ('quasi-identifiers'), and
// optionally their reidentification distributions
// const quasiIds = [{ field: { name: 'age' }, infoType: { name: 'AGE' }}];
async function kMapEstimationAnalysis() {
  const sourceTable = {
    projectId: tableProjectId,
    datasetId: datasetId,
    tableId: tableId,
  };

  // Construct request for creating a risk analysis job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    riskJob: {
      privacyMetric: {
        kMapEstimationConfig: {
          quasiIds: quasiIds,
          regionCode: regionCode,
        },
      },
      sourceTable: sourceTable,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };
  // Create helper function for unpacking values
  const getValue = obj =&gt; obj[Object.keys(obj)[0]];

  // Run risk analysis job
  const [topicResponse] = await pubsub.topic(topicId).get();
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;

  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  setTimeout(() =&gt; {
    console.log(' Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});

  const histogramBuckets =
    job.riskDetails.kMapEstimationResult.kMapEstimationHistogram;

  histogramBuckets.forEach((histogramBucket, histogramBucketIdx) =&gt; {
    console.log(`Bucket ${histogramBucketIdx}:`);
    console.log(
      `  Anonymity range: [${histogramBucket.minAnonymity}, ${histogramBucket.maxAnonymity}]`
    );
    console.log(`  Size: ${histogramBucket.bucketSize}`);
    histogramBucket.bucketValues.forEach(valueBucket =&gt; {
      const values = valueBucket.quasiIdsValues.map(value =&gt; getValue(value));
      console.log(`    Values: ${values.join(' ')}`);
      console.log(
        `    Estimated k-map anonymity: ${valueBucket.estimatedAnonymity}`
      );
    });
  });
}

kMapEstimationAnalysis();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-k-map-python" track-metadata-position="dlp-k-map" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-map" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-map" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-k-map" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/risk.py" data-region-tag="dlp_k_map" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/risk.py/HEAD/dlp_k_map" translate="no"><code dir="ltr" translate="no">def k_map_estimate_analysis(
    project,
    table_project_id,
    dataset_id,
    table_id,
    topic_id,
    subscription_id,
    quasi_ids,
    info_types,
    region_code="US",
    timeout=300,
):
    """Uses the Data Loss Prevention API to compute the k-map risk estimation
        of a column set in a Google BigQuery table.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        table_project_id: The Google Cloud project id where the BigQuery table
            is stored.
        dataset_id: The id of the dataset to inspect.
        table_id: The id of the table to inspect.
        column_name: The name of the column to compute risk metrics for.
        topic_id: The name of the Pub/Sub topic to notify once the job
            completes.
        subscription_id: The name of the Pub/Sub subscription to use when
            listening for job completion notifications.
        quasi_ids: A set of columns that form a composite key and optionally
            their reidentification distributions.
        info_types: Type of information of the quasi_id in order to provide a
            statistical model of population.
        region_code: The ISO 3166-1 region code that the data is representative
            of. Can be omitted if using a region-specific infoType (such as
            US_ZIP_5)
        timeout: The number of seconds to wait for a response from the API.

    Returns:
        None; the response from the API is printed to the terminal.
    """
    import concurrent.futures

    # Import the client library.
    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Create helper function for unpacking values
    def get_values(obj):
        return int(obj.integer_value)

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into full resource ids.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Location info of the BigQuery table.
    source_table = {
        "project_id": table_project_id,
        "dataset_id": dataset_id,
        "table_id": table_id,
    }

    # Check that numbers of quasi-ids and info types are equal
    if len(quasi_ids) != len(info_types):
        raise ValueError(
            """Number of infoTypes and number of quasi-identifiers
                            must be equal!"""
        )

    # Convert quasi id list to Protobuf type
    def map_fields(quasi_id, info_type):
        return {"field": {"name": quasi_id}, "info_type": {"name": info_type}}

    quasi_ids = map(map_fields, quasi_ids, info_types)

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Configure risk analysis job
    # Give the name of the numeric column to compute risk metrics for
    risk_job = {
        "privacy_metric": {
            "k_map_estimation_config": {
                "quasi_ids": quasi_ids,
                "region_code": region_code,
            }
        },
        "source_table": source_table,
        "actions": actions,
    }

    # Call API to start risk analysis job
    operation = dlp.create_dlp_job(request={"parent": parent, "risk_job": risk_job})

    def callback(message):
        if message.attributes["DlpJobName"] == operation.name:
            # This is the message we're looking for, so acknowledge it.
            message.ack()

            # Now that the job is done, fetch the results and print them.
            job = dlp.get_dlp_job(request={"name": operation.name})
            histogram_buckets = (
                job.risk_details.k_map_estimation_result.k_map_estimation_histogram
            )
            # Print bucket stats
            for i, bucket in enumerate(histogram_buckets):
                print("Bucket {}:".format(i))
                print(
                    "   Anonymity range: [{}, {}]".format(
                        bucket.min_anonymity, bucket.max_anonymity
                    )
                )
                print("   Size: {}".format(bucket.bucket_size))
                for value_bucket in bucket.bucket_values:
                    print(
                        "   Values: {}".format(
                            map(get_values, value_bucket.quasi_ids_values)
                        )
                    )
                    print(
                        "   Estimated k-map anonymity: {}".format(
                            value_bucket.estimated_anonymity
                        )
                    )
            subscription.set_result(None)
        else:
            # This is not the message we're looking for.
            message.drop()

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)
    subscription = subscriber.subscribe(subscription_path, callback)

    try:
        subscription.result(timeout=timeout)
    except concurrent.futures.TimeoutError:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )
        subscription.close()

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-k-map-go" track-metadata-position="dlp-k-map" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-map" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/k_map.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/k_map.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-map" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-k-map" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/k_map.go" data-region-tag="dlp_k_map" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/k_map.go/HEAD/dlp_k_map" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"strings"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	"github.com/golang/protobuf/ptypes/empty"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// riskKMap runs K Map on the given data.
func riskKMap(w io.Writer, projectID, dataProject, pubSubTopic, pubSubSub, datasetID, tableID, region string, columnNames ...string) error {
	// projectID := "my-project-id"
	// dataProject := "bigquery-public-data"
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// datasetID := "san_francisco"
	// tableID := "bikeshare_trips"
	// region := "US"
	// columnNames := "zip_code"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}

	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("Error creating PubSub client: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	s, err := setupPubSub(projectID, pubSubTopic, pubSubSub)
	if err != nil {
		return fmt.Errorf("setupPubSub: %v", err)
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Build the QuasiID slice.
	var q []*dlppb.PrivacyMetric_KMapEstimationConfig_TaggedField
	for _, c := range columnNames {
		q = append(q, &amp;dlppb.PrivacyMetric_KMapEstimationConfig_TaggedField{
			Field: &amp;dlppb.FieldId{
				Name: c,
			},
			Tag: &amp;dlppb.PrivacyMetric_KMapEstimationConfig_TaggedField_Inferred{
				Inferred: &amp;empty.Empty{},
			},
		})
	}

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_RiskJob{
			RiskJob: &amp;dlppb.RiskAnalysisJobConfig{
				// PrivacyMetric configures what to compute.
				PrivacyMetric: &amp;dlppb.PrivacyMetric{
					Type: &amp;dlppb.PrivacyMetric_KMapEstimationConfig_{
						KMapEstimationConfig: &amp;dlppb.PrivacyMetric_KMapEstimationConfig{
							QuasiIds:   q,
							RegionCode: region,
						},
					},
				},
				// SourceTable describes where to find the data.
				SourceTable: &amp;dlppb.BigQueryTable{
					ProjectId: dataProject,
					DatasetId: datasetID,
					TableId:   tableID,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the risk job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the risk job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()
		time.Sleep(500 * time.Millisecond)
		j, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "GetDlpJob: %v", err)
			return
		}
		h := j.GetRiskDetails().GetKMapEstimationResult().GetKMapEstimationHistogram()
		for i, b := range h {
			fmt.Fprintf(w, "Histogram bucket %v\n", i)
			fmt.Fprintf(w, "  Anonymity range: [%v,%v]\n", b.GetMaxAnonymity(), b.GetMaxAnonymity())
			fmt.Fprintf(w, "  %v unique values total\n", b.GetBucketSize())
			for _, v := range b.GetBucketValues() {
				var qvs []string
				for _, qv := range v.GetQuasiIdsValues() {
					qvs = append(qvs, qv.String())
				}
				fmt.Fprintf(w, "    QuasiID values: %s\n", strings.Join(qvs, ", "))
				fmt.Fprintf(w, "    Estimated anonymity: %v\n", v.GetEstimatedAnonymity())
			}
		}
		// Stop listening for more messages.
		cancel()
	})
	if err != nil {
		return fmt.Errorf("Recieve: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-k-map-php" track-metadata-position="dlp-k-map" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-map" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/k_map.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/k_map.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-map" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-k-map" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/k_map.php" data-region-tag="dlp_k_map" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/k_map.php/HEAD/dlp_k_map" translate="no"><code dir="ltr" translate="no">use Exception;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\RiskAnalysisJobConfig;
use Google\Cloud\Dlp\V2\BigQueryTable;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\PrivacyMetric\KMapEstimationConfig;
use Google\Cloud\Dlp\V2\PrivacyMetric\KMapEstimationConfig\TaggedField;
use Google\Cloud\Dlp\V2\PrivacyMetric;
use Google\Cloud\Dlp\V2\FieldId;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Computes the k-map risk estimation of a column set in a Google BigQuery table.
 *
 * @param string   $callingProjectId  The project ID to run the API call under
 * @param string   $dataProjectId     The project ID containing the target Datastore
 * @param string   $topicId           The name of the Pub/Sub topic to notify once the job completes
 * @param string   $subscriptionId    The name of the Pub/Sub subscription to use when listening for job
 * @param string   $datasetId         The ID of the dataset to inspect
 * @param string   $tableId           The ID of the table to inspect
 * @param string   $regionCode        The ISO 3166-1 region code that the data is representative of
 * @param string[] $quasiIdNames      Array columns that form a composite key (quasi-identifiers)
 * @param string[] $infoTypes         Array of infoTypes corresponding to the chosen quasi-identifiers
 */
function k_map(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $datasetId,
    string $tableId,
    string $regionCode,
    array $quasiIdNames,
    array $infoTypes
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $pubsub = new PubSubClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $topic = $pubsub-&gt;topic($topicId);

    // Verify input
    if (count($infoTypes) != count($quasiIdNames)) {
        throw new Exception('Number of infoTypes and number of quasi-identifiers must be equal!');
    }

    // Map infoTypes to quasi-ids
    $quasiIdObjects = array_map(function ($quasiId, $infoType) {
        $quasiIdField = (new FieldId())
            -&gt;setName($quasiId);

        $quasiIdType = (new InfoType())
            -&gt;setName($infoType);

        $quasiIdObject = (new TaggedField())
            -&gt;setInfoType($quasiIdType)
            -&gt;setField($quasiIdField);

        return $quasiIdObject;
    }, $quasiIdNames, $infoTypes);

    // Construct analysis config
    $statsConfig = (new KMapEstimationConfig())
        -&gt;setQuasiIds($quasiIdObjects)
        -&gt;setRegionCode($regionCode);

    $privacyMetric = (new PrivacyMetric())
        -&gt;setKMapEstimationConfig($statsConfig);

    // Construct items to be analyzed
    $bigqueryTable = (new BigQueryTable())
        -&gt;setProjectId($dataProjectId)
        -&gt;setDatasetId($datasetId)
        -&gt;setTableId($tableId);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct risk analysis job config to run
    $riskJob = (new RiskAnalysisJobConfig())
        -&gt;setPrivacyMetric($privacyMetric)
        -&gt;setSourceTable($bigqueryTable)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'riskJob' =&gt; $riskJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $histBuckets = $job-&gt;getRiskDetails()-&gt;getKMapEstimationResult()-&gt;getKMapEstimationHistogram();

            foreach ($histBuckets as $bucketIndex =&gt; $histBucket) {
                // Print bucket stats
                printf('Bucket %s:' . PHP_EOL, $bucketIndex);
                printf(
                    '  Anonymity range: [%s, %s]' . PHP_EOL,
                    $histBucket-&gt;getMinAnonymity(),
                    $histBucket-&gt;getMaxAnonymity()
                );
                printf('  Size: %s' . PHP_EOL, $histBucket-&gt;getBucketSize());

                // Print bucket values
                foreach ($histBucket-&gt;getBucketValues() as $percent =&gt; $valueBucket) {
                    printf(
                        '  Estimated k-map anonymity: %s' . PHP_EOL,
                        $valueBucket-&gt;getEstimatedAnonymity()
                    );

                    // Pretty-print quasi-ID values
                    print('  Values: ' . PHP_EOL);
                    foreach ($valueBucket-&gt;getQuasiIdsValues() as $index =&gt; $value) {
                        print('    ' . $value-&gt;serializeToJsonString() . PHP_EOL);
                    }
                }
            }
            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            print('Unexpected job state. Most likely, the job is either running or has not yet started.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-k-map-csharp" track-metadata-position="dlp-k-map" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-k-map" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateKMap.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateKMap.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-k-map" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-k-map" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateKMap.cs" data-region-tag="dlp_k_map" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateKMap.cs/HEAD/dlp_k_map" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Cloud.PubSub.V1;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using static Google.Cloud.Dlp.V2.Action.Types;
using static Google.Cloud.Dlp.V2.PrivacyMetric.Types;
using static Google.Cloud.Dlp.V2.PrivacyMetric.Types.KMapEstimationConfig.Types;

public class RiskAnalysisCreateKMap
{
    public static object KMap(
        string callingProjectId,
        string tableProjectId,
        string datasetId,
        string tableId,
        string topicId,
        string subscriptionId,
        IEnumerable&lt;FieldId&gt; quasiIds,
        IEnumerable&lt;InfoType&gt; infoTypes,
        string regionCode)
    {
        var dlp = DlpServiceClient.Create();

        // Construct + submit the job
        var kmapEstimationConfig = new KMapEstimationConfig
        {
            QuasiIds =
                {
                    quasiIds.Zip(
                        infoTypes,
                        (Field, InfoType) =&gt; new TaggedField
                        {
                            Field = Field,
                            InfoType = InfoType
                        }
                    )
                },
            RegionCode = regionCode
        };

        var config = new RiskAnalysisJobConfig()
        {
            PrivacyMetric = new PrivacyMetric
            {
                KMapEstimationConfig = kmapEstimationConfig
            },
            SourceTable = new BigQueryTable
            {
                ProjectId = tableProjectId,
                DatasetId = datasetId,
                TableId = tableId
            },
            Actions =
            {
                new Google.Cloud.Dlp.V2.Action
                {
                    PubSub = new PublishToPubSub
                    {
                        Topic = $"projects/{callingProjectId}/topics/{topicId}"
                    }
                }
            }
        };

        var submittedJob = dlp.CreateDlpJob(
            new CreateDlpJobRequest
            {
                ParentAsProjectName = new ProjectName(callingProjectId),
                RiskJob = config
            });

        // Listen to pub/sub for the job
        var subscriptionName = new SubscriptionName(
            callingProjectId,
            subscriptionId);
        var subscriber = SubscriberClient.CreateAsync(
            subscriptionName).Result;

        // SimpleSubscriber runs your message handle function on multiple
        // threads to maximize throughput.
        var done = new ManualResetEventSlim(false);
        subscriber.StartAsync((PubsubMessage message, CancellationToken cancel) =&gt;
        {
            if (message.Attributes["DlpJobName"] == submittedJob.Name)
            {
                Thread.Sleep(500); // Wait for DLP API results to become consistent
                done.Set();
                return Task.FromResult(SubscriberClient.Reply.Ack);
            }
            else
            {
                return Task.FromResult(SubscriberClient.Reply.Nack);
            }
        });

        done.Wait(TimeSpan.FromMinutes(10)); // 10 minute timeout; may not work for large jobs
        subscriber.StopAsync(CancellationToken.None).Wait();

        // Process results
        var resultJob = dlp.GetDlpJob(new GetDlpJobRequest
        {
            DlpJobName = DlpJobName.Parse(submittedJob.Name)
        });

        var result = resultJob.RiskDetails.KMapEstimationResult;

        for (var histogramIdx = 0; histogramIdx &lt; result.KMapEstimationHistogram.Count; histogramIdx++)
        {
            var histogramValue = result.KMapEstimationHistogram[histogramIdx];
            Console.WriteLine($"Bucket {histogramIdx}");
            Console.WriteLine($"  Anonymity range: [{histogramValue.MinAnonymity}, {histogramValue.MaxAnonymity}].");
            Console.WriteLine($"  Size: {histogramValue.BucketSize}");

            foreach (var datapoint in histogramValue.BucketValues)
            {
                // 'UnpackValue(x)' is a prettier version of 'x.toString()'
                Console.WriteLine($"    Values: [{String.Join(',', datapoint.QuasiIdsValues.Select(x =&gt; UnpackValue(x)))}]");
                Console.WriteLine($"    Estimated k-map anonymity: {datapoint.EstimatedAnonymity}");
            }
        }

        return 0;
    }

    public static string UnpackValue(Value protoValue)
    {
        var jsonValue = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, object&gt;&gt;(protoValue.ToString());
        return jsonValue.Values.ElementAt(0).ToString();
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Viewing k-map job results" id="viewing-results">Viewing <em>k</em>-map job results</h2>
<p>To retrieve the results of the <em>k</em>-map risk analysis job using the REST API,
send the following GET request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource. Replace <var translate="no">PROJECT_ID</var> with your project ID and
<var translate="no">JOB_ID</var> with the identifier of the job you want to obtain results for.
The job ID was returned when you started the job, and can also be retrieved by
<a href="#list-jobs">listing all jobs</a>.</p>
<pre dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs/<var translate="no">JOB_ID</var></pre>
<p>The request returns a JSON object containing an instance of the job. The results
of the analysis are inside the <code dir="ltr" translate="no">"riskDetails"</code> key, in an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AnalyzeDataSourceRiskDetails"><code dir="ltr" translate="no">AnalyzeDataSourceRiskDetails</code></a>
object. For more information, see the API reference for the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>
resource.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to calculate the <a href="/dlp/docs/compute-k-anonymity"><em>k</em>-anonymity</a>
value for a dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-l-diversity"><em>l</em>-diversity</a>
value for a dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-d-presence"><em>Î´</em>-presence</a> value
for a dataset.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/compute-d-presence]</H1></p><div class="devsite-article-body clearfix">
<p>Delta-presence (<em>Î´</em>-presence) is a metric that quantifies the probability that
an individual belongs to an analyzed dataset. Like <a href="#compute-k-map"><em>k</em>-map</a>,
you can estimate <em>Î´</em>-presence values using Cloud DLP, which
uses a statistical model to estimate the attack dataset.</p>
<p><em>Î´</em>-presence contrasts with the other risk analysis methods, in which the
attack dataset is explicitly known. Depending on the type of data,
Cloud DLP uses publicly available datasets (for example, from the
US Census) or a custom statistical model (for example, one or more
BigQuery tables that you specify), or it extrapolates from the
distribution of values in your input dataset.</p>
<p>This topic demonstrates how to compute <em>Î´</em>-presence values for a dataset using
Cloud Data Loss Prevention. For more information about <em>Î´</em>-presence or risk analysis in
general, see the <a href="/dlp/docs/concepts-risk-analysis">risk analysis concept topic</a>
before continuing on.</p>
<aside class="note"><strong>Note:</strong><span> At this time, you can only compute <em>Î´</em>-presence values using the
DLP API or Cloud DLP-supported <a href="/dlp/docs/libraries">client
libraries</a>. Cloud DLP in the
Cloud console doesn't support computing <em>Î´</em>-presence values.</span></aside>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<h2 data-text="   Before you begin " id="before-you-begin">
  Before you begin
</h2>
<p>
  Before continuing, be sure you've done the following:
</p>
<ol>
<li><a href="https://accounts.google.com/Login">Sign in</a> to your Google Account.</li>
<li>In the Google Cloud console, on the project selector page, select or create a
     Google Cloud project.</li>
<a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console">Go to the project selector</a>
<li>Make sure that billing is enabled for your Google Cloud project. <a href="/billing/docs/how-to/modify-project">Learn how to confirm billing is enabled for your
        project.</a></li>
<li>Enable Cloud DLP.</li>
<a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console">Enable Cloud DLP</a>
<!--- Must close the ordered list! ---->
<p><li>Select a BigQuery dataset to analyze. Cloud DLP
  estimates the <em>Î´</em>-presence metric by scanning a BigQuery
  table.</li>
<li>Determine the types of datasets you want to use to model the attack
  dataset. For more information, see the reference page for the
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#deltapresenceestimationconfig"><code dir="ltr" translate="no">DeltaPresenceEstimationConfig</code></a>
  object, as well as <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">Risk
  analysis terms and techniques</a>.</li>
</p></ol>
<h2 data-text="Compute Î´-presence metrics" id="compute-d-presence">Compute <em>Î´</em>-presence metrics</h2>
<p>To compute a <em>Î´</em>-presence estimate using Cloud DLP, send a request
to the following URL, where <var translate="no">PROJECT_ID</var> indicates your <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects#identifying_projects">project
identifier</a>:</p>
<pre dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs</pre>
<p>The request contains a
  <a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create#riskanalysisjobconfig"><code dir="ltr" translate="no">RiskAnalysisJobConfig</code></a>
  object, which is composed of the following:</p>
<ul>
<li><p>A
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#privacymetric"><code dir="ltr" translate="no">PrivacyMetric</code></a>
object. This is where you specify that you want to calculate <em>Î´</em>-presence by
specifying a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#deltapresenceestimationconfig"><code dir="ltr" translate="no">DeltaPresenceEstimationConfig</code></a>
object containing the following:</p>
<ul>
<li><p><code dir="ltr" translate="no">quasiIds[]</code>: Required. Fields
(<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#quasiid"><code dir="ltr" translate="no">QuasiId</code></a>
objects) considered to be quasi-identifiers to scan and use to compute
<em>Î´</em>-presence. No two columns can have the same tag. These can be any of the
following:</p>
<ul>
<li>An <a href="/dlp/docs/reference/rest/v2/InfoType">infoType</a>: This
causes Cloud DLP to use the relevant public dataset as
a statistical model of population, including US ZIP codes, region codes,
ages, and genders.</li>
<li>A custom infoType: A custom tag wherein you indicate an auxiliary table
(an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AuxiliaryTable"><code dir="ltr" translate="no">AuxiliaryTable</code></a>
object) that contains statistical information about the possible values of
this column.</li>
<li>The <code dir="ltr" translate="no">inferred</code> tag: If no semantic tag is indicated, specify <code dir="ltr" translate="no">inferred</code>.
Cloud DLP infers the statistical model from the
distribution of values in the input data.</li>
</ul></li>
<li><p><code dir="ltr" translate="no">regionCode</code>: An
<a href="https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">ISO 3166-1 alpha-2 region code</a>
for Cloud DLP to use in statistical modeling. This value
is required if no column is tagged with a region-specific infoType (for
example, a US ZIP code) or a region code.</p></li>
<li><p><code dir="ltr" translate="no">auxiliaryTables[]</code>: Auxiliary tables
(<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#statisticaltable"><code dir="ltr" translate="no">StatisticalTable</code></a>
objects) to use in the analysis. Each custom tag used to tag a
quasi-identifier column (from <code dir="ltr" translate="no">quasiIds[]</code>) must appear in exactly one
column of one auxiliary table.</p></li>
</ul></li>
<li><p>A <a href="/dlp/docs/reference/rest/v2/BigQueryTable"><code dir="ltr" translate="no">BigQueryTable</code></a>
object. Specify the BigQuery table to scan by including all of
the following:</p>
<ul>
<li><code dir="ltr" translate="no">projectId</code>: The project ID of the project containing the table.</li>
<li><code dir="ltr" translate="no">datasetId</code>: The dataset ID of the table.</li>
<li><code dir="ltr" translate="no">tableId</code>: The name of the table.</li>
</ul></li>
<li><p>A set of one or more
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action"><code dir="ltr" translate="no">Action</code></a>
objects, which represent actions to run, in the order given, at the
completion of the job. Each <code dir="ltr" translate="no">Action</code> object can contain one of the
following actions:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#SaveFindings"><code dir="ltr" translate="no">SaveFindings</code></a>
object: Saves the results of the risk analysis scan to a
BigQuery table.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToPubSub"><code dir="ltr" translate="no">PublishToPubSub</code></a>
object:
<a href="/pubsub/docs/publisher">Publishes a notification to a Pub/Sub topic</a>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishSummaryToCscc"><code dir="ltr" translate="no">PublishSummaryToCscc</code></a>
object: Saves a results summary to Security Command Center.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishFindingsToCloudDataCatalog"><code dir="ltr" translate="no">PublishFindingsToCloudDataCatalog</code></a>
object: Saves results to <a href="/dlp/docs/sending-results-to-dc">Data Catalog</a>.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#JobNotificationEmails"><code dir="ltr" translate="no">JobNotificationEmails</code></a>
object: Sends you an email with results.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#PublishToStackdriver"><code dir="ltr" translate="no">PublishToStackdriver</code></a>
object: Saves results to Google Cloud's operations suite.</li>
</ul></li>
</ul>
<h2 data-text="Viewing Î´-presence job results" id="viewing-results">Viewing <em>Î´</em>-presence job results</h2>
<p>To retrieve the results of the <em>Î´</em>-presence risk analysis job using the REST
API, send the following GET request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs</code></a>
resource. Replace <var translate="no">PROJECT_ID</var> with your project ID and
<var translate="no">JOB_ID</var> with the identifier of the job you want to obtain results for.
The job ID was returned when you started the job, and can also be retrieved by
<a href="#list-jobs">listing all jobs</a>.</p>
<pre dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/dlpJobs/<var translate="no">JOB_ID</var></pre>
<p>The request returns a JSON object containing an instance of the job. The results
of the analysis are inside the <code dir="ltr" translate="no">"riskDetails"</code> key, in an
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob.AnalyzeDataSourceRiskDetails"><code dir="ltr" translate="no">AnalyzeDataSourceRiskDetails</code></a>
object. For more information, see the API reference for the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob"><code dir="ltr" translate="no">DlpJob</code></a>
resource.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to calculate the <a href="/dlp/docs/compute-k-anonymity"><em>k</em>-anonymity</a>
value for a dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-l-diversity"><em>l</em>-diversity</a>
value for a dataset.</li>
<li>Learn how to calculate the <a href="/dlp/docs/compute-k-map"><em>k</em>-map</a> value for a
dataset.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/compute-stats]</H1></p><div class="devsite-article-body clearfix">
<p>You can use Cloud Data Loss Prevention to compute numerical and categorical
numerical statistics for individual columns in BigQuery tables.
Cloud DLP can calculate the following:</p>
<ul>
<li>The column's minimum value</li>
<li>The column's maximum value</li>
<li><a class="external" href="https://en.wikipedia.org/wiki/Quantile">Quantile values</a> 
for the column</li>
<li>A histogram of value frequencies in the column</li>
</ul>
<h2 data-text="Compute numerical statistics" id="compute-num-stats">Compute numerical statistics</h2>
<p>You can determine minimum, maximum, and quantile values for an individual
BigQuery column. To calculate these values, you configure a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#resource-dlpjob"><code dir="ltr" translate="no">DlpJob</code></a>,
setting the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#numericalstatsconfig"><code dir="ltr" translate="no">NumericalStatsConfig</code></a>
privacy metric to the name of the column to scan. When you run the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob">job</a>,
Cloud DLP computes statistics for the given column, returning
its results in the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#numericalstatsresult"><code dir="ltr" translate="no">NumericalStatsResult</code></a>
object. Cloud DLP can compute statistics for the following
number types:</p>
<ul>
<li>integer</li>
<li>float</li>
<li>date</li>
<li>datetime</li>
<li>timestamp</li>
<li>time</li>
</ul>
<p>The statistics that a scan run returns include the minimum value, the maximum
value, and 99 <a class="external" href="https://en.wikipedia.org/wiki/Quantile">quantile
values</a> that
partition the set of field values into 100 equal sized buckets.</p>
<h3 data-text="Code examples" id="code_examples">Code examples</h3>
<p>Following is sample code in several languages that demonstrates how to use
Cloud DLP to calculate numerical statistics.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-numerical-stats-code-sample">
<section>
<h3 data-text="Java" id="dlp-numerical-stats-java" track-metadata-position="dlp-numerical-stats" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-numerical-stats" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisNumericalStats.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisNumericalStats.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-numerical-stats" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-numerical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisNumericalStats.java" data-region-tag="dlp_numerical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisNumericalStats.java/HEAD/dlp_numerical_stats" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.Action.PublishToPubSub;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.NumericalStatsResult;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrivacyMetric;
import com.google.privacy.dlp.v2.PrivacyMetric.NumericalStatsConfig;
import com.google.privacy.dlp.v2.RiskAnalysisJobConfig;
import com.google.privacy.dlp.v2.Value;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.ProjectTopicName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

class RiskAnalysisNumericalStats {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String datasetId = "your-bigquery-dataset-id";
    String tableId = "your-bigquery-table-id";
    String topicId = "pub-sub-topic";
    String subscriptionId = "pub-sub-subscription";
    numericalStatsAnalysis(projectId, datasetId, tableId, topicId, subscriptionId);
  }

  public static void numericalStatsAnalysis(
      String projectId, String datasetId, String tableId, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {

    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Specify the BigQuery table to analyze
      BigQueryTable bigQueryTable =
          BigQueryTable.newBuilder()
              .setTableId(tableId)
              .setDatasetId(datasetId)
              .setProjectId(projectId)
              .build();

      // This represents the name of the column to analyze, which must contain numerical data
      String columnName = "Age";

      // Configure the privacy metric for the job
      FieldId fieldId = FieldId.newBuilder().setName(columnName).build();
      NumericalStatsConfig numericalStatsConfig =
          NumericalStatsConfig.newBuilder().setField(fieldId).build();
      PrivacyMetric privacyMetric =
          PrivacyMetric.newBuilder().setNumericalStatsConfig(numericalStatsConfig).build();

      // Create action to publish job status notifications over Google Cloud Pub/Sub
      ProjectTopicName topicName = ProjectTopicName.of(projectId, topicId);
      PublishToPubSub publishToPubSub =
          PublishToPubSub.newBuilder().setTopic(topicName.toString()).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the risk analysis job to perform
      RiskAnalysisJobConfig riskAnalysisJobConfig =
          RiskAnalysisJobConfig.newBuilder()
              .setSourceTable(bigQueryTable)
              .setPrivacyMetric(privacyMetric)
              .addActions(action)
              .build();

      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setRiskJob(riskAnalysisJobConfig)
              .build();

      // Send the request to the API using the client
      DlpJob dlpJob = dlpServiceClient.createDlpJob(createDlpJobRequest);

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Build a request to get the completed job
      GetDlpJobRequest getDlpJobRequest =
          GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();

      // Retrieve completed job status
      DlpJob completedJob = dlpServiceClient.getDlpJob(getDlpJobRequest);
      System.out.println("Job status: " + completedJob.getState());

      // Get the result and parse through and process the information
      NumericalStatsResult result = completedJob.getRiskDetails().getNumericalStatsResult();

      System.out.printf(
          "Value range : [%.3f, %.3f]\n",
          result.getMinValue().getFloatValue(), result.getMaxValue().getFloatValue());

      int percent = 1;
      Double lastValue = null;
      for (Value quantileValue : result.getQuantileValuesList()) {
        Double currentValue = quantileValue.getFloatValue();
        if (lastValue == null || !lastValue.equals(currentValue)) {
          System.out.printf("Value at %s %% quantile : %.3f", percent, currentValue);
        }
        lastValue = currentValue;
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-numerical-stats-nodejs" track-metadata-position="dlp-numerical-stats" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-numerical-stats" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/numericalRiskAnalysis.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/numericalRiskAnalysis.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-numerical-stats" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-numerical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/numericalRiskAnalysis.js" data-region-tag="dlp_numerical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/numericalRiskAnalysis.js/HEAD/dlp_numerical_stats" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the table is stored under
// This may or (for public datasets) may not equal the calling project ID
// const tableProjectId = 'my-project';

// The ID of the dataset to inspect, e.g. 'my_dataset'
// const datasetId = 'my_dataset';

// The ID of the table to inspect, e.g. 'my_table'
// const tableId = 'my_table';

// The name of the column to compute risk metrics for, e.g. 'age'
// Note that this column must be a numeric data type
// const columnName = 'firstName';

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

async function numericalRiskAnalysis() {
  const sourceTable = {
    projectId: tableProjectId,
    datasetId: datasetId,
    tableId: tableId,
  };

  // Construct request for creating a risk analysis job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    riskJob: {
      privacyMetric: {
        numericalStatsConfig: {
          field: {
            name: columnName,
          },
        },
      },
      sourceTable: sourceTable,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };

  // Create helper function for unpacking values
  const getValue = obj =&gt; obj[Object.keys(obj)[0]];

  // Run risk analysis job
  const [topicResponse] = await pubsub.topic(topicId).get();
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  setTimeout(() =&gt; {
    console.log(' Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  const results = job.riskDetails.numericalStatsResult;

  console.log(
    `Value Range: [${getValue(results.minValue)}, ${getValue(
      results.maxValue
    )}]`
  );

  // Print unique quantile values
  let tempValue = null;
  results.quantileValues.forEach((result, percent) =&gt; {
    const value = getValue(result);

    // Only print new values
    if (
      tempValue !== value &amp;&amp;
      !(tempValue &amp;&amp; tempValue.equals &amp;&amp; tempValue.equals(value))
    ) {
      console.log(`Value at ${percent}% quantile: ${value}`);
      tempValue = value;
    }
  });
}

numericalRiskAnalysis();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-numerical-stats-python" track-metadata-position="dlp-numerical-stats" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-numerical-stats" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-numerical-stats" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-numerical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/risk.py" data-region-tag="dlp_numerical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/risk.py/HEAD/dlp_numerical_stats" translate="no"><code dir="ltr" translate="no">def numerical_risk_analysis(
    project,
    table_project_id,
    dataset_id,
    table_id,
    column_name,
    topic_id,
    subscription_id,
    timeout=300,
):
    """Uses the Data Loss Prevention API to compute risk metrics of a column
       of numerical data in a Google BigQuery table.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        table_project_id: The Google Cloud project id where the BigQuery table
            is stored.
        dataset_id: The id of the dataset to inspect.
        table_id: The id of the table to inspect.
        column_name: The name of the column to compute risk metrics for.
        topic_id: The name of the Pub/Sub topic to notify once the job
            completes.
        subscription_id: The name of the Pub/Sub subscription to use when
            listening for job completion notifications.
        timeout: The number of seconds to wait for a response from the API.

    Returns:
        None; the response from the API is printed to the terminal.
    """
    import concurrent.futures

    # Import the client library.
    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into full resource ids.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Location info of the BigQuery table.
    source_table = {
        "project_id": table_project_id,
        "dataset_id": dataset_id,
        "table_id": table_id,
    }

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Configure risk analysis job
    # Give the name of the numeric column to compute risk metrics for
    risk_job = {
        "privacy_metric": {"numerical_stats_config": {"field": {"name": column_name}}},
        "source_table": source_table,
        "actions": actions,
    }

    # Call API to start risk analysis job
    operation = dlp.create_dlp_job(request={"parent": parent, "risk_job": risk_job})

    def callback(message):
        if message.attributes["DlpJobName"] == operation.name:
            # This is the message we're looking for, so acknowledge it.
            message.ack()

            # Now that the job is done, fetch the results and print them.
            job = dlp.get_dlp_job(request={"name": operation.name})
            results = job.risk_details.numerical_stats_result
            print(
                "Value Range: [{}, {}]".format(
                    results.min_value.integer_value,
                    results.max_value.integer_value,
                )
            )
            prev_value = None
            for percent, result in enumerate(results.quantile_values):
                value = result.integer_value
                if prev_value != value:
                    print("Value at {}% quantile: {}".format(percent, value))
                    prev_value = value
            subscription.set_result(None)
        else:
            # This is not the message we're looking for.
            message.drop()

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)
    subscription = subscriber.subscribe(subscription_path, callback)

    try:
        subscription.result(timeout=timeout)
    except concurrent.futures.TimeoutError:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )
        subscription.close()

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-numerical-stats-go" track-metadata-position="dlp-numerical-stats" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-numerical-stats" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/numerical.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/numerical.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-numerical-stats" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-numerical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/numerical.go" data-region-tag="dlp_numerical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/numerical.go/HEAD/dlp_numerical_stats" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// riskNumerical computes the numerical risk of the given column.
func riskNumerical(w io.Writer, projectID, dataProject, pubSubTopic, pubSubSub, datasetID, tableID, columnName string) error {
	// projectID := "my-project-id"
	// dataProject := "bigquery-public-data"
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// datasetID := "nhtsa_traffic_fatalities"
	// tableID := "accident_2015"
	// columnName := "state_number"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("Error creating PubSub client: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	s, err := setupPubSub(projectID, pubSubTopic, pubSubSub)
	if err != nil {
		return fmt.Errorf("setupPubSub: %v", err)
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_RiskJob{
			RiskJob: &amp;dlppb.RiskAnalysisJobConfig{
				// PrivacyMetric configures what to compute.
				PrivacyMetric: &amp;dlppb.PrivacyMetric{
					Type: &amp;dlppb.PrivacyMetric_NumericalStatsConfig_{
						NumericalStatsConfig: &amp;dlppb.PrivacyMetric_NumericalStatsConfig{
							Field: &amp;dlppb.FieldId{
								Name: columnName,
							},
						},
					},
				},
				// SourceTable describes where to find the data.
				SourceTable: &amp;dlppb.BigQueryTable{
					ProjectId: dataProject,
					DatasetId: datasetID,
					TableId:   tableID,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the risk job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the risk job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()
		time.Sleep(500 * time.Millisecond)
		resp, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "GetDlpJob: %v", err)
			return
		}
		n := resp.GetRiskDetails().GetNumericalStatsResult()
		fmt.Fprintf(w, "Value range: [%v, %v]\n", n.GetMinValue(), n.GetMaxValue())
		var tmp string
		for p, v := range n.GetQuantileValues() {
			if v.String() != tmp {
				fmt.Fprintf(w, "Value at %v quantile: %v\n", p, v)
				tmp = v.String()
			}
		}
		// Stop listening for more messages.
		cancel()
	})
	if err != nil {
		return fmt.Errorf("Recieve: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-numerical-stats-php" track-metadata-position="dlp-numerical-stats" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-numerical-stats" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/numerical_stats.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/numerical_stats.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-numerical-stats" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-numerical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/numerical_stats.php" data-region-tag="dlp_numerical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/numerical_stats.php/HEAD/dlp_numerical_stats" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\RiskAnalysisJobConfig;
use Google\Cloud\Dlp\V2\BigQueryTable;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\PubSub\PubSubClient;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\PrivacyMetric\NumericalStatsConfig;
use Google\Cloud\Dlp\V2\PrivacyMetric;
use Google\Cloud\Dlp\V2\FieldId;

/**
 * Computes risk metrics of a column of numbers in a Google BigQuery table.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $dataProjectId     The project ID containing the target Datastore
 * @param string $topicId           The name of the Pub/Sub topic to notify once the job completes
 * @param string $subscriptionId    The name of the Pub/Sub subscription to use when listening for job
 * @param string $datasetId         The ID of the BigQuery dataset to inspect
 * @param string $tableId           The ID of the BigQuery table to inspect
 * @param string $columnName        The name of the column to compute risk metrics for, e.g. "age"
 */
function numerical_stats(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $datasetId,
    string $tableId,
    string $columnName
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient([
        'projectId' =&gt; $callingProjectId
    ]);
    $pubsub = new PubSubClient([
        'projectId' =&gt; $callingProjectId
    ]);
    $topic = $pubsub-&gt;topic($topicId);

    // Construct risk analysis config
    $columnField = (new FieldId())
        -&gt;setName($columnName);

    $statsConfig = (new NumericalStatsConfig())
        -&gt;setField($columnField);

    $privacyMetric = (new PrivacyMetric())
        -&gt;setNumericalStatsConfig($statsConfig);

    // Construct items to be analyzed
    $bigqueryTable = (new BigQueryTable())
        -&gt;setProjectId($dataProjectId)
        -&gt;setDatasetId($datasetId)
        -&gt;setTableId($tableId);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct risk analysis job config to run
    $riskJob = (new RiskAnalysisJobConfig())
        -&gt;setPrivacyMetric($privacyMetric)
        -&gt;setSourceTable($bigqueryTable)
        -&gt;setActions([$action]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'riskJob' =&gt; $riskJob
    ]);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Helper function to convert Protobuf values to strings
    $valueToString = function ($value) {
        $json = json_decode($value-&gt;serializeToJsonString(), true);
        return array_shift($json);
    };

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $results = $job-&gt;getRiskDetails()-&gt;getNumericalStatsResult();
            printf(
                'Value range: [%s, %s]' . PHP_EOL,
                $valueToString($results-&gt;getMinValue()),
                $valueToString($results-&gt;getMaxValue())
            );

            // Only print unique values
            $lastValue = null;
            foreach ($results-&gt;getQuantileValues() as $percent =&gt; $quantileValue) {
                $value = $valueToString($quantileValue);
                if ($value != $lastValue) {
                    printf('Value at %s quantile: %s' . PHP_EOL, $percent, $value);
                    $lastValue = $value;
                }
            }

            break;
        case JobState::FAILED:
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            $errors = $job-&gt;getErrors();
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            print('Unexpected job state. Most likely, the job is either running or has not yet started.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-numerical-stats-csharp" track-metadata-position="dlp-numerical-stats" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-numerical-stats" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateNumericalStats.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateNumericalStats.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-numerical-stats" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-numerical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateNumericalStats.cs" data-region-tag="dlp_numerical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateNumericalStats.cs/HEAD/dlp_numerical_stats" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Cloud.PubSub.V1;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using static Google.Cloud.Dlp.V2.Action.Types;
using static Google.Cloud.Dlp.V2.PrivacyMetric.Types;

public class RiskAnalysisCreateNumericalStats
{
    public static AnalyzeDataSourceRiskDetails.Types.NumericalStatsResult NumericalStats(
        string callingProjectId,
        string tableProjectId,
        string datasetId,
        string tableId,
        string topicId,
        string subscriptionId,
        string columnName)
    {
        var dlp = DlpServiceClient.Create();

        // Construct + submit the job
        var config = new RiskAnalysisJobConfig
        {
            PrivacyMetric = new PrivacyMetric
            {
                NumericalStatsConfig = new NumericalStatsConfig
                {
                    Field = new FieldId { Name = columnName }
                }
            },
            SourceTable = new BigQueryTable
            {
                ProjectId = tableProjectId,
                DatasetId = datasetId,
                TableId = tableId
            },
            Actions =
                {
                    new Google.Cloud.Dlp.V2.Action
                    {
                        PubSub = new PublishToPubSub
                        {
                            Topic = $"projects/{callingProjectId}/topics/{topicId}"
                        }
                    }
                }
        };

        var submittedJob = dlp.CreateDlpJob(
            new CreateDlpJobRequest
            {
                ParentAsProjectName = new ProjectName(callingProjectId),
                RiskJob = config
            });

        // Listen to pub/sub for the job
        var subscriptionName = new SubscriptionName(callingProjectId, subscriptionId);
        var subscriber = SubscriberClient.CreateAsync(
            subscriptionName).Result;

        // SimpleSubscriber runs your message handle function on multiple
        // threads to maximize throughput.
        var done = new ManualResetEventSlim(false);
        subscriber.StartAsync((PubsubMessage message, CancellationToken cancel) =&gt;
        {
            if (message.Attributes["DlpJobName"] == submittedJob.Name)
            {
                Thread.Sleep(500); // Wait for DLP API results to become consistent
                done.Set();
                return Task.FromResult(SubscriberClient.Reply.Ack);
            }
            else
            {
                return Task.FromResult(SubscriberClient.Reply.Nack);
            }
        });

        done.Wait(TimeSpan.FromMinutes(10)); // 10 minute timeout; may not work for large jobs
        subscriber.StopAsync(CancellationToken.None).Wait();

        // Process results
        var resultJob = dlp.GetDlpJob(
            new GetDlpJobRequest
            {
                DlpJobName = DlpJobName.Parse(submittedJob.Name)
            });

        var result = resultJob.RiskDetails.NumericalStatsResult;

        // 'UnpackValue(x)' is a prettier version of 'x.toString()'
        Console.WriteLine($"Value Range: [{UnpackValue(result.MinValue)}, {UnpackValue(result.MaxValue)}]");
        var lastValue = string.Empty;
        for (var quantile = 0; quantile &lt; result.QuantileValues.Count; quantile++)
        {
            var currentValue = UnpackValue(result.QuantileValues[quantile]);
            if (lastValue != currentValue)
            {
                Console.WriteLine($"Value at {quantile + 1}% quantile: {currentValue}");
            }
            lastValue = currentValue;
        }

        return result;
    }

    public static string UnpackValue(Value protoValue)
    {
        var jsonValue = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, object&gt;&gt;(protoValue.ToString());
        return jsonValue.Values.ElementAt(0).ToString();
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Compute categorical numerical statistics" id="compute-cat-num-stats">Compute categorical numerical statistics</h2>
<p>You can compute categorical numerical statistics for the individual histogram
buckets within a BigQuery column, including:</p>
<ul>
<li>Upper bound on value frequency within a given bucket</li>
<li>Lower bound on value frequency within a given bucket</li>
<li>Size of a given bucket</li>
<li>A sample of value frequencies within a given bucket (maximum 20)</li>
</ul>
<p>To calculate these values, you configure a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#resource-dlpjob"><code dir="ltr" translate="no">DlpJob</code></a>,
setting the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#categoricalstatsconfig"><code dir="ltr" translate="no">CategoricalStatsConfig</code></a>
privacy metric to the name of the column to scan. When you run the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#DlpJob">job</a>,
Cloud DLP computes statistics for the given column, returning
its results in the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs#categoricalstatsresult"><code dir="ltr" translate="no">CategoricalStatsResult</code></a>
object.</p>
<aside class="note"><strong>Note:</strong><span> You can apply the <code dir="ltr" translate="no">CategoricalStatsConfig</code> to all column types, except
for arrays and structs. If your column types consist solely of the types
specified in <a href="#compute-num-stats">Compute numerical statistics</a>, it may be more
informative to scan for that metric.</span></aside>
<h3 data-text="Code examples" id="code_examples_2">Code examples</h3>
<p>Following is sample code in several languages that demonstrates how to
use Cloud DLP to calculate categorical statistics.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-categorical-stats-code-sample">
<section>
<h3 data-text="Java" id="dlp-categorical-stats-java" track-metadata-position="dlp-categorical-stats" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-categorical-stats" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisCategoricalStats.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisCategoricalStats.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-categorical-stats" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-categorical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisCategoricalStats.java" data-region-tag="dlp_categorical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/RiskAnalysisCategoricalStats.java/HEAD/dlp_categorical_stats" translate="no"><code dir="ltr" translate="no">
import com.google.api.core.SettableApiFuture;
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.cloud.pubsub.v1.AckReplyConsumer;
import com.google.cloud.pubsub.v1.MessageReceiver;
import com.google.cloud.pubsub.v1.Subscriber;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.Action.PublishToPubSub;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.CategoricalStatsResult;
import com.google.privacy.dlp.v2.AnalyzeDataSourceRiskDetails.CategoricalStatsResult.CategoricalStatsHistogramBucket;
import com.google.privacy.dlp.v2.BigQueryTable;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrivacyMetric;
import com.google.privacy.dlp.v2.PrivacyMetric.CategoricalStatsConfig;
import com.google.privacy.dlp.v2.RiskAnalysisJobConfig;
import com.google.privacy.dlp.v2.ValueFrequency;
import com.google.pubsub.v1.ProjectSubscriptionName;
import com.google.pubsub.v1.ProjectTopicName;
import com.google.pubsub.v1.PubsubMessage;
import java.io.IOException;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.TimeUnit;
import java.util.concurrent.TimeoutException;

class RiskAnalysisCategoricalStats {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String datasetId = "your-bigquery-dataset-id";
    String tableId = "your-bigquery-table-id";
    String topicId = "pub-sub-topic";
    String subscriptionId = "pub-sub-subscription";
    categoricalStatsAnalysis(projectId, datasetId, tableId, topicId, subscriptionId);
  }

  public static void categoricalStatsAnalysis(
      String projectId, String datasetId, String tableId, String topicId, String subscriptionId)
      throws ExecutionException, InterruptedException, IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {
      // Specify the BigQuery table to analyze
      BigQueryTable bigQueryTable =
          BigQueryTable.newBuilder()
              .setProjectId(projectId)
              .setDatasetId(datasetId)
              .setTableId(tableId)
              .build();

      // The name of the column to analyze, which doesn't need to contain numerical data
      String columnName = "Mystery";

      // Configure the privacy metric for the job
      FieldId fieldId = FieldId.newBuilder().setName(columnName).build();
      CategoricalStatsConfig categoricalStatsConfig =
          CategoricalStatsConfig.newBuilder().setField(fieldId).build();
      PrivacyMetric privacyMetric =
          PrivacyMetric.newBuilder().setCategoricalStatsConfig(categoricalStatsConfig).build();

      // Create action to publish job status notifications over Google Cloud Pub/Sub
      ProjectTopicName topicName = ProjectTopicName.of(projectId, topicId);
      PublishToPubSub publishToPubSub =
          PublishToPubSub.newBuilder().setTopic(topicName.toString()).build();
      Action action = Action.newBuilder().setPubSub(publishToPubSub).build();

      // Configure the risk analysis job to perform
      RiskAnalysisJobConfig riskAnalysisJobConfig =
          RiskAnalysisJobConfig.newBuilder()
              .setSourceTable(bigQueryTable)
              .setPrivacyMetric(privacyMetric)
              .addActions(action)
              .build();

      // Build the job creation request to be sent by the client
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setRiskJob(riskAnalysisJobConfig)
              .build();

      // Send the request to the API using the client
      DlpJob dlpJob = dlpServiceClient.createDlpJob(createDlpJobRequest);

      // Set up a Pub/Sub subscriber to listen on the job completion status
      final SettableApiFuture&lt;Boolean&gt; done = SettableApiFuture.create();

      ProjectSubscriptionName subscriptionName =
          ProjectSubscriptionName.of(projectId, subscriptionId);

      MessageReceiver messageHandler =
          (PubsubMessage pubsubMessage, AckReplyConsumer ackReplyConsumer) -&gt; {
            handleMessage(dlpJob, done, pubsubMessage, ackReplyConsumer);
          };
      Subscriber subscriber = Subscriber.newBuilder(subscriptionName, messageHandler).build();
      subscriber.startAsync();

      // Wait for job completion semi-synchronously
      // For long jobs, consider using a truly asynchronous execution model such as Cloud Functions
      try {
        done.get(15, TimeUnit.MINUTES);
      } catch (TimeoutException e) {
        System.out.println("Job was not completed after 15 minutes.");
        return;
      } finally {
        subscriber.stopAsync();
        subscriber.awaitTerminated();
      }

      // Build a request to get the completed job
      GetDlpJobRequest getDlpJobRequest =
          GetDlpJobRequest.newBuilder().setName(dlpJob.getName()).build();

      // Retrieve completed job status
      DlpJob completedJob = dlpServiceClient.getDlpJob(getDlpJobRequest);
      System.out.println("Job status: " + completedJob.getState());

      // Get the result and parse through and process the information
      CategoricalStatsResult result = completedJob.getRiskDetails().getCategoricalStatsResult();
      List&lt;CategoricalStatsHistogramBucket&gt; histogramBucketList =
          result.getValueFrequencyHistogramBucketsList();

      for (CategoricalStatsHistogramBucket bucket : histogramBucketList) {
        long mostCommonFrequency = bucket.getValueFrequencyUpperBound();
        System.out.printf("Most common value occurs %d time(s).\n", mostCommonFrequency);

        long leastCommonFrequency = bucket.getValueFrequencyLowerBound();
        System.out.printf("Least common value occurs %d time(s).\n", leastCommonFrequency);

        for (ValueFrequency valueFrequency : bucket.getBucketValuesList()) {
          System.out.printf(
              "Value %s occurs %d time(s).\n",
              valueFrequency.getValue().toString(), valueFrequency.getCount());
        }
      }
    }
  }

  // handleMessage injects the job and settableFuture into the message reciever interface
  private static void handleMessage(
      DlpJob job,
      SettableApiFuture&lt;Boolean&gt; done,
      PubsubMessage pubsubMessage,
      AckReplyConsumer ackReplyConsumer) {
    String messageAttribute = pubsubMessage.getAttributesMap().get("DlpJobName");
    if (job.getName().equals(messageAttribute)) {
      done.set(true);
      ackReplyConsumer.ack();
    } else {
      ackReplyConsumer.nack();
    }
  }
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-categorical-stats-nodejs" track-metadata-position="dlp-categorical-stats" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-categorical-stats" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/categoricalRiskAnalysis.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/categoricalRiskAnalysis.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-categorical-stats" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-categorical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/categoricalRiskAnalysis.js" data-region-tag="dlp_categorical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/categoricalRiskAnalysis.js/HEAD/dlp_categorical_stats" translate="no"><code dir="ltr" translate="no">// Import the Google Cloud client libraries
const DLP = require('@google-cloud/dlp');
const {PubSub} = require('@google-cloud/pubsub');

// Instantiates clients
const dlp = new DLP.DlpServiceClient();
const pubsub = new PubSub();

// The project ID to run the API call under
// const projectId = 'my-project';

// The project ID the table is stored under
// This may or (for public datasets) may not equal the calling project ID
// const tableProjectId = 'my-project';

// The ID of the dataset to inspect, e.g. 'my_dataset'
// const datasetId = 'my_dataset';

// The ID of the table to inspect, e.g. 'my_table'
// const tableId = 'my_table';

// The name of the Pub/Sub topic to notify once the job completes
// TODO(developer): create a Pub/Sub topic to use for this
// const topicId = 'MY-PUBSUB-TOPIC'

// The name of the Pub/Sub subscription to use when listening for job
// completion notifications
// TODO(developer): create a Pub/Sub subscription to use for this
// const subscriptionId = 'MY-PUBSUB-SUBSCRIPTION'

// The name of the column to compute risk metrics for, e.g. 'firstName'
// const columnName = 'firstName';
async function categoricalRiskAnalysis() {
  const sourceTable = {
    projectId: tableProjectId,
    datasetId: datasetId,
    tableId: tableId,
  };

  // Construct request for creating a risk analysis job
  const request = {
    parent: `projects/${projectId}/locations/global`,
    riskJob: {
      privacyMetric: {
        categoricalStatsConfig: {
          field: {
            name: columnName,
          },
        },
      },
      sourceTable: sourceTable,
      actions: [
        {
          pubSub: {
            topic: `projects/${projectId}/topics/${topicId}`,
          },
        },
      ],
    },
  };

  // Create helper function for unpacking values
  const getValue = obj =&gt; obj[Object.keys(obj)[0]];

  // Run risk analysis job
  const [topicResponse] = await pubsub.topic(topicId).get();
  const subscription = await topicResponse.subscription(subscriptionId);
  const [jobsResponse] = await dlp.createDlpJob(request);
  const jobName = jobsResponse.name;
  // Watch the Pub/Sub topic until the DLP job finishes
  await new Promise((resolve, reject) =&gt; {
    const messageHandler = message =&gt; {
      if (message.attributes &amp;&amp; message.attributes.DlpJobName === jobName) {
        message.ack();
        subscription.removeListener('message', messageHandler);
        subscription.removeListener('error', errorHandler);
        resolve(jobName);
      } else {
        message.nack();
      }
    };

    const errorHandler = err =&gt; {
      subscription.removeListener('message', messageHandler);
      subscription.removeListener('error', errorHandler);
      reject(err);
    };

    subscription.on('message', messageHandler);
    subscription.on('error', errorHandler);
  });
  setTimeout(() =&gt; {
    console.log(' Waiting for DLP job to fully complete');
  }, 500);
  const [job] = await dlp.getDlpJob({name: jobName});
  const histogramBuckets =
    job.riskDetails.categoricalStatsResult.valueFrequencyHistogramBuckets;
  histogramBuckets.forEach((histogramBucket, histogramBucketIdx) =&gt; {
    console.log(`Bucket ${histogramBucketIdx}:`);

    // Print bucket stats
    console.log(
      `  Most common value occurs ${histogramBucket.valueFrequencyUpperBound} time(s)`
    );
    console.log(
      `  Least common value occurs ${histogramBucket.valueFrequencyLowerBound} time(s)`
    );

    // Print bucket values
    console.log(`${histogramBucket.bucketSize} unique values total.`);
    histogramBucket.bucketValues.forEach(valueBucket =&gt; {
      console.log(
        `  Value ${getValue(valueBucket.value)} occurs ${
          valueBucket.count
        } time(s).`
      );
    });
  });
}

categoricalRiskAnalysis();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-categorical-stats-python" track-metadata-position="dlp-categorical-stats" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-categorical-stats" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/risk.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-categorical-stats" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-categorical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/risk.py" data-region-tag="dlp_categorical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/risk.py/HEAD/dlp_categorical_stats" translate="no"><code dir="ltr" translate="no">def categorical_risk_analysis(
    project,
    table_project_id,
    dataset_id,
    table_id,
    column_name,
    topic_id,
    subscription_id,
    timeout=300,
):
    """Uses the Data Loss Prevention API to compute risk metrics of a column
       of categorical data in a Google BigQuery table.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        table_project_id: The Google Cloud project id where the BigQuery table
            is stored.
        dataset_id: The id of the dataset to inspect.
        table_id: The id of the table to inspect.
        column_name: The name of the column to compute risk metrics for.
        topic_id: The name of the Pub/Sub topic to notify once the job
            completes.
        subscription_id: The name of the Pub/Sub subscription to use when
            listening for job completion notifications.
        timeout: The number of seconds to wait for a response from the API.

    Returns:
        None; the response from the API is printed to the terminal.
    """
    import concurrent.futures

    # Import the client library.
    import google.cloud.dlp

    # This sample additionally uses Cloud Pub/Sub to receive results from
    # potentially long-running operations.
    import google.cloud.pubsub

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into full resource ids.
    topic = google.cloud.pubsub.PublisherClient.topic_path(project, topic_id)
    parent = f"projects/{project}/locations/global"

    # Location info of the BigQuery table.
    source_table = {
        "project_id": table_project_id,
        "dataset_id": dataset_id,
        "table_id": table_id,
    }

    # Tell the API where to send a notification when the job is complete.
    actions = [{"pub_sub": {"topic": topic}}]

    # Configure risk analysis job
    # Give the name of the numeric column to compute risk metrics for
    risk_job = {
        "privacy_metric": {
            "categorical_stats_config": {"field": {"name": column_name}}
        },
        "source_table": source_table,
        "actions": actions,
    }

    # Call API to start risk analysis job
    operation = dlp.create_dlp_job(request={"parent": parent, "risk_job": risk_job})

    def callback(message):
        if message.attributes["DlpJobName"] == operation.name:
            # This is the message we're looking for, so acknowledge it.
            message.ack()

            # Now that the job is done, fetch the results and print them.
            job = dlp.get_dlp_job(request={"name": operation.name})
            histogram_buckets = (
                job.risk_details.categorical_stats_result.value_frequency_histogram_buckets  # noqa: E501
            )
            # Print bucket stats
            for i, bucket in enumerate(histogram_buckets):
                print("Bucket {}:".format(i))
                print(
                    "   Most common value occurs {} time(s)".format(
                        bucket.value_frequency_upper_bound
                    )
                )
                print(
                    "   Least common value occurs {} time(s)".format(
                        bucket.value_frequency_lower_bound
                    )
                )
                print("   {} unique values total.".format(bucket.bucket_size))
                for value in bucket.bucket_values:
                    print(
                        "   Value {} occurs {} time(s)".format(
                            value.value.integer_value, value.count
                        )
                    )
            subscription.set_result(None)
        else:
            # This is not the message we're looking for.
            message.drop()

    # Create a Pub/Sub client and find the subscription. The subscription is
    # expected to already be listening to the topic.
    subscriber = google.cloud.pubsub.SubscriberClient()
    subscription_path = subscriber.subscription_path(project, subscription_id)
    subscription = subscriber.subscribe(subscription_path, callback)

    try:
        subscription.result(timeout=timeout)
    except concurrent.futures.TimeoutError:
        print(
            "No event received before the timeout. Please verify that the "
            "subscription provided is subscribed to the topic provided."
        )
        subscription.close()

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-categorical-stats-go" track-metadata-position="dlp-categorical-stats" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-categorical-stats" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/categorical.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/risk/categorical.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-categorical-stats" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-categorical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/categorical.go" data-region-tag="dlp_categorical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/risk/categorical.go/HEAD/dlp_categorical_stats" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"cloud.google.com/go/pubsub"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// riskCategorical computes the categorical risk of the given data.
func riskCategorical(w io.Writer, projectID, dataProject, pubSubTopic, pubSubSub, datasetID, tableID, columnName string) error {
	// projectID := "my-project-id"
	// dataProject := "bigquery-public-data"
	// pubSubTopic := "dlp-risk-sample-topic"
	// pubSubSub := "dlp-risk-sample-sub"
	// datasetID := "nhtsa_traffic_fatalities"
	// tableID := "accident_2015"
	// columnName := "state_number"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	// Create a PubSub Client used to listen for when the inspect job finishes.
	pubsubClient, err := pubsub.NewClient(ctx, projectID)
	if err != nil {
		return fmt.Errorf("Error creating PubSub client: %v", err)
	}
	defer pubsubClient.Close()

	// Create a PubSub subscription we can use to listen for messages.
	s, err := setupPubSub(projectID, pubSubTopic, pubSubSub)
	if err != nil {
		return fmt.Errorf("setupPubSub: %v", err)
	}

	// topic is the PubSub topic string where messages should be sent.
	topic := "projects/" + projectID + "/topics/" + pubSubTopic

	// Create a configured request.
	req := &amp;dlppb.CreateDlpJobRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Job: &amp;dlppb.CreateDlpJobRequest_RiskJob{
			RiskJob: &amp;dlppb.RiskAnalysisJobConfig{
				// PrivacyMetric configures what to compute.
				PrivacyMetric: &amp;dlppb.PrivacyMetric{
					Type: &amp;dlppb.PrivacyMetric_CategoricalStatsConfig_{
						CategoricalStatsConfig: &amp;dlppb.PrivacyMetric_CategoricalStatsConfig{
							Field: &amp;dlppb.FieldId{
								Name: columnName,
							},
						},
					},
				},
				// SourceTable describes where to find the data.
				SourceTable: &amp;dlppb.BigQueryTable{
					ProjectId: dataProject,
					DatasetId: datasetID,
					TableId:   tableID,
				},
				// Send a message to PubSub using Actions.
				Actions: []*dlppb.Action{
					{
						Action: &amp;dlppb.Action_PubSub{
							PubSub: &amp;dlppb.Action_PublishToPubSub{
								Topic: topic,
							},
						},
					},
				},
			},
		},
	}
	// Create the risk job.
	j, err := client.CreateDlpJob(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Created job: %v\n", j.GetName())

	// Wait for the risk job to finish by waiting for a PubSub message.
	// This only waits for 10 minutes. For long jobs, consider using a truly
	// asynchronous execution model such as Cloud Functions.
	ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
	defer cancel()
	err = s.Receive(ctx, func(ctx context.Context, msg *pubsub.Message) {
		// If this is the wrong job, do not process the result.
		if msg.Attributes["DlpJobName"] != j.GetName() {
			msg.Nack()
			return
		}
		msg.Ack()
		time.Sleep(500 * time.Millisecond)
		resp, err := client.GetDlpJob(ctx, &amp;dlppb.GetDlpJobRequest{
			Name: j.GetName(),
		})
		if err != nil {
			fmt.Fprintf(w, "GetDlpJob: %v", err)
			return
		}
		h := resp.GetRiskDetails().GetCategoricalStatsResult().GetValueFrequencyHistogramBuckets()
		for i, b := range h {
			fmt.Fprintf(w, "Histogram bucket %v\n", i)
			fmt.Fprintf(w, "  Most common value occurs %v times\n", b.GetValueFrequencyUpperBound())
			fmt.Fprintf(w, "  Least common value occurs %v times\n", b.GetValueFrequencyLowerBound())
			fmt.Fprintf(w, "  %v unique values total\n", b.GetBucketSize())
			for _, v := range b.GetBucketValues() {
				fmt.Fprintf(w, "    Value %v occurs %v times\n", v.GetValue(), v.GetCount())
			}
		}
		// Stop listening for more messages.
		cancel()
	})
	if err != nil {
		return fmt.Errorf("Receive: %v", err)
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-categorical-stats-php" track-metadata-position="dlp-categorical-stats" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-categorical-stats" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/categorical_stats.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/categorical_stats.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-categorical-stats" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-categorical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/categorical_stats.php" data-region-tag="dlp_categorical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/categorical_stats.php/HEAD/dlp_categorical_stats" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\RiskAnalysisJobConfig;
use Google\Cloud\Dlp\V2\BigQueryTable;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\Action;
use Google\Cloud\Dlp\V2\Action\PublishToPubSub;
use Google\Cloud\Dlp\V2\PrivacyMetric\CategoricalStatsConfig;
use Google\Cloud\Dlp\V2\PrivacyMetric;
use Google\Cloud\Dlp\V2\FieldId;
use Google\Cloud\PubSub\PubSubClient;

/**
 * Computes risk metrics of a column of data in a Google BigQuery table.
 *
 * @param string $callingProjectId The project ID to run the API call under
 * @param string $dataProjectId    The project ID containing the target Datastore
 * @param string $topicId          The name of the Pub/Sub topic to notify once the job completes
 * @param string $subscriptionId   The name of the Pub/Sub subscription to use when listening for job
 * @param string $datasetId        The ID of the dataset to inspect
 * @param string $tableId          The ID of the table to inspect
 * @param string $columnName       The name of the column to compute risk metrics for, e.g. "age"
 */
function categorical_stats(
    string $callingProjectId,
    string $dataProjectId,
    string $topicId,
    string $subscriptionId,
    string $datasetId,
    string $tableId,
    string $columnName
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $pubsub = new PubSubClient([
        'projectId' =&gt; $callingProjectId,
    ]);
    $topic = $pubsub-&gt;topic($topicId);

    // Construct risk analysis config
    $columnField = (new FieldId())
        -&gt;setName($columnName);

    $statsConfig = (new CategoricalStatsConfig())
        -&gt;setField($columnField);

    $privacyMetric = (new PrivacyMetric())
        -&gt;setCategoricalStatsConfig($statsConfig);

    // Construct items to be analyzed
    $bigqueryTable = (new BigQueryTable())
        -&gt;setProjectId($dataProjectId)
        -&gt;setDatasetId($datasetId)
        -&gt;setTableId($tableId);

    // Construct the action to run when job completes
    $pubSubAction = (new PublishToPubSub())
        -&gt;setTopic($topic-&gt;name());

    $action = (new Action())
        -&gt;setPubSub($pubSubAction);

    // Construct risk analysis job config to run
    $riskJob = (new RiskAnalysisJobConfig())
        -&gt;setPrivacyMetric($privacyMetric)
        -&gt;setSourceTable($bigqueryTable)
        -&gt;setActions([$action]);

    // Submit request
    $parent = "projects/$callingProjectId/locations/global";
    $job = $dlp-&gt;createDlpJob($parent, [
        'riskJob' =&gt; $riskJob
    ]);

    // Listen for job notifications via an existing topic/subscription.
    $subscription = $topic-&gt;subscription($subscriptionId);

    // Poll Pub/Sub using exponential backoff until job finishes
    // Consider using an asynchronous execution model such as Cloud Functions
    $attempt = 1;
    $startTime = time();
    do {
        foreach ($subscription-&gt;pull() as $message) {
            if (isset($message-&gt;attributes()['DlpJobName']) &amp;&amp;
                $message-&gt;attributes()['DlpJobName'] === $job-&gt;getName()) {
                $subscription-&gt;acknowledge($message);
                // Get the updated job. Loop to avoid race condition with DLP API.
                do {
                    $job = $dlp-&gt;getDlpJob($job-&gt;getName());
                } while ($job-&gt;getState() == JobState::RUNNING);
                break 2; // break from parent do while
            }
        }
        printf('Waiting for job to complete' . PHP_EOL);
        // Exponential backoff with max delay of 60 seconds
        sleep(min(60, pow(2, ++$attempt)));
    } while (time() - $startTime &lt; 600); // 10 minute timeout

    // Print finding counts
    printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), JobState::name($job-&gt;getState()));
    switch ($job-&gt;getState()) {
        case JobState::DONE:
            $histBuckets = $job-&gt;getRiskDetails()-&gt;getCategoricalStatsResult()-&gt;getValueFrequencyHistogramBuckets();

            foreach ($histBuckets as $bucketIndex =&gt; $histBucket) {
                // Print bucket stats
                printf('Bucket %s:' . PHP_EOL, $bucketIndex);
                printf('  Most common value occurs %s time(s)' . PHP_EOL, $histBucket-&gt;getValueFrequencyUpperBound());
                printf('  Least common value occurs %s time(s)' . PHP_EOL, $histBucket-&gt;getValueFrequencyLowerBound());
                printf('  %s unique value(s) total.', $histBucket-&gt;getBucketSize());

                // Print bucket values
                foreach ($histBucket-&gt;getBucketValues() as $percent =&gt; $quantile) {
                    printf(
                        '  Value %s occurs %s time(s).' . PHP_EOL,
                        $quantile-&gt;getValue()-&gt;serializeToJsonString(),
                        $quantile-&gt;getCount()
                    );
                }
            }

            break;
        case JobState::FAILED:
            $errors = $job-&gt;getErrors();
            printf('Job %s had errors:' . PHP_EOL, $job-&gt;getName());
            foreach ($errors as $error) {
                var_dump($error-&gt;getDetails());
            }
            break;
        case JobState::PENDING:
            printf('Job has not completed. Consider a longer timeout or an asynchronous execution model' . PHP_EOL);
            break;
        default:
            printf('Unexpected job state.');
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-categorical-stats-csharp" track-metadata-position="dlp-categorical-stats" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-categorical-stats" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateCategoricalStats.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/RiskAnalysisCreateCategoricalStats.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-categorical-stats" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-categorical-stats" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateCategoricalStats.cs" data-region-tag="dlp_categorical_stats" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/RiskAnalysisCreateCategoricalStats.cs/HEAD/dlp_categorical_stats" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Cloud.PubSub.V1;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using static Google.Cloud.Dlp.V2.Action.Types;
using static Google.Cloud.Dlp.V2.PrivacyMetric.Types;

public class RiskAnalysisCreateCategoricalStats
{
    public static AnalyzeDataSourceRiskDetails.Types.CategoricalStatsResult CategoricalStats(
        string callingProjectId,
        string tableProjectId,
        string datasetId,
        string tableId,
        string topicId,
        string subscriptionId,
        string columnName)
    {
        var dlp = DlpServiceClient.Create();

        // Construct + submit the job
        var config = new RiskAnalysisJobConfig
        {
            PrivacyMetric = new PrivacyMetric
            {
                CategoricalStatsConfig = new CategoricalStatsConfig()
                {
                    Field = new FieldId { Name = columnName }
                }
            },
            SourceTable = new BigQueryTable
            {
                ProjectId = tableProjectId,
                DatasetId = datasetId,
                TableId = tableId
            },
            Actions =
            {
                new Google.Cloud.Dlp.V2.Action
                {
                    PubSub = new PublishToPubSub
                    {
                        Topic = $"projects/{callingProjectId}/topics/{topicId}"
                    }
                }
            }
        };

        var submittedJob = dlp.CreateDlpJob(new CreateDlpJobRequest
        {
            ParentAsProjectName = new ProjectName(callingProjectId),
            RiskJob = config
        });

        // Listen to pub/sub for the job
        var subscriptionName = new SubscriptionName(callingProjectId, subscriptionId);
        var subscriber = SubscriberClient.CreateAsync(
            subscriptionName).Result;

        // SimpleSubscriber runs your message handle function on multiple
        // threads to maximize throughput.
        var done = new ManualResetEventSlim(false);
        subscriber.StartAsync((PubsubMessage message, CancellationToken cancel) =&gt;
        {
            if (message.Attributes["DlpJobName"] == submittedJob.Name)
            {
                Thread.Sleep(500); // Wait for DLP API results to become consistent
                done.Set();
                return Task.FromResult(SubscriberClient.Reply.Ack);
            }
            else
            {
                return Task.FromResult(SubscriberClient.Reply.Nack);
            }
        });

        done.Wait(TimeSpan.FromMinutes(10)); // 10 minute timeout; may not work for large jobs
        subscriber.StopAsync(CancellationToken.None).Wait();

        // Process results
        var resultJob = dlp.GetDlpJob(new GetDlpJobRequest
        {
            DlpJobName = DlpJobName.Parse(submittedJob.Name)
        });

        var result = resultJob.RiskDetails.CategoricalStatsResult;

        for (var bucketIdx = 0; bucketIdx &lt; result.ValueFrequencyHistogramBuckets.Count; bucketIdx++)
        {
            var bucket = result.ValueFrequencyHistogramBuckets[bucketIdx];
            Console.WriteLine($"Bucket {bucketIdx}");
            Console.WriteLine($"  Most common value occurs {bucket.ValueFrequencyUpperBound} time(s).");
            Console.WriteLine($"  Least common value occurs {bucket.ValueFrequencyLowerBound} time(s).");
            Console.WriteLine($"  {bucket.BucketSize} unique value(s) total.");

            foreach (var bucketValue in bucket.BucketValues)
            {
                // 'UnpackValue(x)' is a prettier version of 'x.toString()'
                Console.WriteLine($"  Value {UnpackValue(bucketValue.Value)} occurs {bucketValue.Count} time(s).");
            }
        }

        return result;
    }

    public static string UnpackValue(Value protoValue)
    {
        var jsonValue = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, object&gt;&gt;(protoValue.ToString());
        return jsonValue.Values.ElementAt(0).ToString();
    }
}
</code></pre>
</div>
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/visualizing_re-id_risk]</H1></p><div class="devsite-article-body clearfix">
<p>This topic shows how to measure
<a href="/dlp/docs/concepts-risk-analysis#about-k-anonymity"><em>k</em>-anonymity</a> of a dataset using
Cloud Data Loss Prevention and visualize it in Google Data Studio. By doing so, you'll
also be able to better understand risk and help evaluate the trade-offs in
utility you might be making if you redact or de-identify data.</p>
<aside class="special"><strong>Important:</strong><span> You can also visualize your re-identification risk analysis results
using Cloud DLP in the Google Cloud console, without needing to use
Data Studio. This built-in feature produces a similar
visual representation to the procedure described in this topic, without having
to configure another product. For more information, see <a href="/dlp/docs/compute-k-anonymity#viewing-results">View <em>k</em>-anonymity job
results</a> or <a href="/dlp/docs/compute-l-diversity#viewing-results">View <em>l</em>-diversity
job results</a>.</span></aside>
<p>Though the focus of this topic is on visualizing the <em>k</em>-anonymity
re-identification risk analysis metric, you can also visualize the
<a href="/dlp/docs/concepts-risk-analysis#about-l-diversity"><em>l</em>-diversity</a> metric using the
same methods.</p>
<p>This topic assumes you're already familiar with the <a href="/dlp/docs/concepts-risk-analysis#about-k-anonymity">concept of
<em>k</em>-anonymity</a> and its utility for
assessing the re-identifiability of records within a dataset. It will also be
helpful to be at least somewhat familiar with how to <a href="/dlp/docs/compute-k-anonymity">compute <em>k</em>-anonymity
using Cloud DLP</a>, and with using
<a href="https://datastudio.google.com/">Data Studio</a>.</p>
<h2 data-text="Introduction" id="introduction">Introduction</h2>
<p>De-identification techniques can be helpful in protecting your subjects' privacy
while you process or use data. But how do you know if a dataset has been
sufficiently de-identified? And how will you know whether your de-identification
has resulted in too much data loss for your use case? That is, how can you
compare re-identification risk with the utility of the data to help make
data-driven decisions?</p>
<p>Calculating the <em>k</em>-anonymity value of a dataset helps answer these questions by
assessing the re-identifiability of the dataset's records.
Cloud DLP contains built-in functionality to calculate a
<em>k</em>-anonymity value on a dataset based on quasi-identifiers that you specify.
This helps enable you to quickly evaluate whether de-identifying a certain
column or combination of columns will result in a dataset that is more or less
likely to be re-identified.</p>
<aside class="note"><strong>Note:</strong><span> <em>Quasi-identifiers</em> are database columns that could potentially be used
in concert with other data to re-identify an individual. For more information,
see <a href="/dlp/docs/concepts-risk-analysis#risk_analysis_terms_and_techniques">Risk analysis terms and
techniques</a>
in the <a href="/dlp/docs/concepts-risk-analysis">Risk analysis</a> conceptual topic.</span></aside>
<h2 data-text="Example dataset" id="example_dataset">Example dataset</h2>
<p>Following are the first few rows of a large example dataset.</p>
<table>
<thead>
<tr>
<th><code dir="ltr" translate="no">user_id</code></th>
<th><code dir="ltr" translate="no">age</code></th>
<th><code dir="ltr" translate="no">title</code></th>
<th><code dir="ltr" translate="no">score</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">602-61-8588</code></td>
<td><code dir="ltr" translate="no">24</code></td>
<td><code dir="ltr" translate="no">Biostatistician III</code></td>
<td><code dir="ltr" translate="no">733</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">771-07-8231</code></td>
<td><code dir="ltr" translate="no">46</code></td>
<td><code dir="ltr" translate="no">Executive Secretary</code></td>
<td><code dir="ltr" translate="no">672</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">618-96-2322</code></td>
<td><code dir="ltr" translate="no">69</code></td>
<td><code dir="ltr" translate="no">Programmer I</code></td>
<td><code dir="ltr" translate="no">514</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">...</code></td>
<td><code dir="ltr" translate="no">...</code></td>
<td><code dir="ltr" translate="no">...</code></td>
<td><code dir="ltr" translate="no">...</code></td>
</tr>
</tbody>
</table>
<p>For the purposes of this tutorial, <code dir="ltr" translate="no">user_id</code> will not be addressed, as the focus
is on quasi-identifiers. In a real-world scenario, you would want to ensure
that <code dir="ltr" translate="no">user_id</code> is redacted or <a href="/dlp/docs/pseudonymization"><em>tokenized</em></a> appropriately. The
<code dir="ltr" translate="no">score</code> column is proprietary to this dataset, and it's unlikely an attacker
would be able to learn it by other means, so you will not include it in the
analysis. Your focus will be on the remaining <code dir="ltr" translate="no">age</code> and <code dir="ltr" translate="no">title</code> columns, with
which an attacker could potentially learn about an individual through other
sources of data. The questions you're trying to answer for the dataset are:</p>
<ul>
<li>What effect will the two quasi-identifiersâ<code dir="ltr" translate="no">age</code> and
<code dir="ltr" translate="no">title</code>âhave on the overall re-identification risk of the de-identified
data?</li>
<li>How will applying a de-identification transformation affect
this risk?</li>
</ul>
<p>You want to be sure that the combination of <code dir="ltr" translate="no">age</code> and <code dir="ltr" translate="no">title</code> won't map to a
small number of users. For example, suppose there is only one user in the
dataset whose title is Programmer I and who is age 69. An attacker might be able
to cross-reference that information with demographics or other available
information, figure out who the person is, and learn the value of their score.
For more information about this phenomenon, see the "<a href="/dlp/docs/concepts-risk-analysis#about-k-anonymity">Entity IDs and computing
<em>k</em>-anonymity</a>" section in the <a href="/dlp/docs/concepts-risk-analysis">Risk
analysis</a> conceptual topic.</p>
<h2 data-text="Step 1: Calculate k-anonymity on the dataset" id="step_1_calculate_k-anonymity_on_the_dataset">Step 1: Calculate k-anonymity on the dataset</h2>
<p>First, use Cloud DLP to calculate <em>k</em>-anonymity on the dataset by
sending the following JSON to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">DlpJob</code></a> resource. Within
this JSON, you set the <a href="/dlp/docs/concepts-risk-analysis#entity-ids">entity ID</a> to the
<code dir="ltr" translate="no">user_id</code> column, and identify the two quasi-identifiers as both the <code dir="ltr" translate="no">age</code> and
<code dir="ltr" translate="no">title</code> columns. You're also instructing Cloud DLP to save the
results to a new BigQuery table.</p>
<aside class="note"><strong>Note:</strong><span> You can also calculate <em>k</em>-anonymity on the dataset using
<a href="https://console.cloud.google.com/security/dlp">Cloud DLP in the Cloud console</a>
or programmatically by using a <a href="/dlp/docs/libraries">client library</a>.</span></aside>
<p><strong>JSON input:</strong></p>
<pre dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/dlp-demo-2/dlpJobs

{
  "riskJob": {
    "sourceTable": {
      "projectId": "dlp-demo-2",
      "datasetId": "dlp_testing",
      "tableId": "dlp_test_data_kanon"
    },
    "privacyMetric": {
      "kAnonymityConfig": {
        "entityId": {
          "field": {
            "name": "id"
          }
        },
        "quasiIds": [
          {
            "name": "age"
          },
          {
            "name": "job_title"
          }
        ]
      }
    },
    "actions": [
      {
        "saveFindings": {
          "outputConfig": {
            "table": {
              "projectId": "dlp-demo-2",
              "datasetId": "dlp_testing",
              "tableId": "test_results"
            }
          }
        }
      }
    ]
  }
}</pre>
<p>Once the <em>k</em>-anonymity job has completed, Cloud DLP sends the job
results to a BigQuery table named
<code dir="ltr" translate="no">dlp-demo-2.dlp_testing.test_results</code>.</p>
<h2 data-text="Step 2: Connect results to Data Studio" id="step_2_connect_results_to">Step 2: Connect results to Data Studio</h2>
<p>Next, you'll connect the BigQuery table you produced in Step 1
to a new report in Google Data Studio.</p>
<ol>
<li><p>Open <a href="https://datastudio.google.com/">Data Studio</a>.</p>
<p><a class="button button-primary" href="https://datastudio.google.com">Open Data Studio</a> </p></li>
<li><p>Click <strong>Create</strong> &gt; <strong>Report</strong>.</p></li>
<li><p>In the <strong>Add data to report</strong> pane under <strong>Connect to data</strong>, click
 <strong>BigQuery</strong>. You may need to authorize
 Data Studio to access your BigQuery tables.</p></li>
<li><p>In the column picker, select <strong>My projects</strong>. Then choose the project,
 dataset, and table. When you're done, click <strong>Add</strong>. If you see a notice
 that you're about to add data to this report, click <strong>Add to report</strong>.</p></li>
</ol>
<p>The <em>k</em>-anonymity scan results have now been added to the new
Data Studio report. In the next step, you'll create the chart.</p>
<h2 data-text="Step 3: Create the chart" id="step_3_create_the_chart">Step 3: Create the chart</h2>
<p>Do the following to insert and configure the chart:</p>
<ol>
<li>In Data Studio, if a table of values appears, select it and
 press Delete to remove it.</li>
<li>On the <strong>Insert</strong> menu, click <strong>Combo chart</strong>.</li>
<li>Click and draw a rectangle on the canvas where you want the chart to
 appear.</li>
</ol>
<p>Next, configure the chart data under the <strong>Data</strong> tab so that the chart shows
the effect of varying the size and value ranges of buckets:</p>
<ol>
<li>Clear the fields under the following headings by pointing to each field
 and clicking the <span aria-hidden="true" class="material-icons" translate="no">cancel</span> X, as shown here:<br/>
<img alt="Detail of timestamp field with delete button
   enabled." class="screenshot" src="/dlp/docs/images/visualizing_re-id_risk2.png" width="201
"/>
<ul>
<li><strong>Date Range Dimension</strong></li>
<li><strong>Dimension</strong></li>
<li><strong>Metric</strong></li>
<li><strong>Sort</strong></li>
</ul></li>
<li>With all fields cleared, drag the <strong>upper_endpoint</strong> field from the
 <strong>Available fields</strong> column to the <strong>Dimension</strong> heading.</li>
<li>Drag the <strong>upper_endpoint</strong> field to the <strong>Sort</strong> heading, and then select
 <strong>Ascending</strong>.</li>
<li>Drag both the <strong>bucket_size</strong> and <strong>bucket_value_count</strong> fields to the
 <strong>Metric</strong> heading.</li>
<li>Point to the icon to the left of the <strong>bucket_size</strong> metric and an <span aria-hidden="true" class="material-icons" translate="no">edit</span>Edit icon appears.
   Click the <span aria-hidden="true" class="material-icons" translate="no">edit</span>Edit
   icon, and then do the following:
<ol>
<li>In the <strong>Name</strong> field, type <code dir="ltr" translate="no">Unique row loss</code>.</li>
<li>Under <strong>Type</strong>, choose <strong>Percent</strong>.</li>
<li>Under <strong>Comparison calculation</strong>, choose <strong>Percent of total</strong>.</li>
<li>Under <strong>Running calculation</strong>, choose <strong>Running sum</strong>.</li>
</ol></li>
<li>Repeat the previous step for the <strong>bucket_value_count</strong> metric, but in the
 <strong>Name</strong> field, type <code dir="ltr" translate="no">Unique quasi-identifier combination loss</code>.</li>
</ol>
<p>Once you're done, the column should appear as shown here:</p>
<p><img alt="Screen shot of fields list." class="screenshot" src="/dlp/docs/images/visualizing_re-id_risk3.png" width="159
"/> </p>
<p>Finally, configure the chart to display a line chart for both metrics:</p>
<ol>
<li>Click the <strong>Style</strong> tab in the pane on the right of the window.</li>
<li>For both Series #1 and Series #2, choose <strong>Line</strong>.</li>
<li>To view the final chart on its own, click the <span aria-hidden="true" class="material-icons" translate="no">visibility</span><strong>View</strong> button in the upper-right
   corner of the window.</li>
</ol>
<p>Following is an example chart after completing the preceding steps.</p>
<p><img alt="Final chart" src="/dlp/docs/images/visualizing_re-id_risk4.png" width="800"/> </p>
<h2 data-text="Interpreting the chart" id="interpreting_the_chart">Interpreting the chart</h2>
<p>The generated chart plots, on the <em>y</em>-axis, the potential percentage of data
loss for both unique rows and unique quasi-identifier combinations to achieve,
on the <em>x</em>-axis, a <em>k</em>-anonymity value.</p>
<p>Higher <em>k</em>-anonymity values indicate less risk of re-identification. To achieve
higher <em>k</em>-anonymity values, however, you would need to remove higher
percentages of the total rows and higher unique quasi-identifier combinations,
which might decrease the utility of the data.</p>
<p>Thankfully, dropping data is not your only option to reduce re-identification
risk. Other de-identification techniques can strike a better balance between
loss and utility. For example, to address the kind of data loss associated with
higher <em>k</em>-anonymity values and this dataset, you could try bucketing ages or
job titles to reduce the uniqueness of age/job title combinations. For example,
you could try bucketing ages in ranges of 20-25, 25-30, 30-35, and so on. For
more information about how to do this, see <a href="/dlp/docs/concepts-bucketing">Generalization and
bucketing</a> and <a href="/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data in text
content</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/creating-job-triggers]</H1></p><div class="devsite-article-body clearfix">
<p>This topic describes in detail how to create a Cloud Data Loss Prevention inspection job,
and how to schedule recurring inspection jobs by creating a job trigger. For a
quick walkthrough of how to create a new job trigger using the
Cloud DLP UI, see <a href="/dlp/docs/quickstart-create-job-trigger">Quickstart: Creating a Cloud DLP
job trigger</a>.</p>
<h2 data-text="About inspection jobs and job triggers" id="about_inspection_jobs_and_job_triggers">About inspection jobs and job triggers</h2>
<p>When Cloud DLP performs an inspection scan to identify sensitive
data, each scan runs as a <em>job</em>. Cloud DLP creates and runs a job
resource whenever you tell it to inspect your Google Cloud storage repositories,
including Cloud Storage buckets, BigQuery tables, and
Datastore kinds.</p>
<p>You schedule Cloud DLP inspection scan jobs by creating <em>job
triggers</em>. A job trigger automates the creation of DLP jobs
on a periodic basis, and can also be run on demand.</p>
<p>To learn more about jobs and job triggers in Cloud DLP, see the
<a href="/dlp/docs/concepts-job-triggers">Jobs and job triggers</a> conceptual page.</p>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<h2 data-text="Create a new inspection job" id="create_a_new_inspection_job">Create a new inspection job</h2>
<p>To create a new Cloud DLP inspection job:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-create-job-code-sample">
<section>
<h3 data-text="Console" id="dlp-create-job-console" track-metadata-position="dlp-create-job" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Job or job trigger</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p>
<p>Alternatively, click the following button:</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/job;source=7" target="console">Create new job</a> </p></li>
</ol>
<p>The Create job page contains the following sections:</p>
<ul>
<li><a href="#choose-job-input-data">Choose input data</a></li>
<li><a href="#job-configure-detection">Configure detection</a></li>
<li><a href="#job-add-actions">Add actions</a></li>
<li><a href="#review-job">Review</a></li>
</ul>
<h3 data-text="Choose input data" id="choose-job-input-data">Choose input data</h3>
<h4 data-text="Name" id="name">Name</h4>
<p>Enter a name for the job. You can use letters, numbers, and hyphens. Naming
your job is optional. If you don't enter a name, Cloud DLP will
give the job a unique number identifier.</p>
<h4 data-text="Location" id="location">Location</h4>
<p>From the <strong>Storage type</strong> menu, choose the kind of repository that stores the
data you want to scan:</p>
<ul>
<li>Cloud Storage: Either enter the URL of the bucket you want to scan,
 or choose <strong>Include/exclude</strong> from the <strong>Location type</strong>
 menu, and then click <strong>Browse</strong> to navigate to the bucket or subfolder
 you want to scan. Select the <strong>Scan folder recursively</strong> checkbox to
 scan the specified directory and all contained directories. Leave it
 unselected to scan only the specified directory and no deeper.</li>
<li>BigQuery: Enter the identifiers for the project, dataset,
 and table that you want to scan.</li>
<li>Datastore: Enter the identifiers for the project,
 namespace (optional), and kind that you want to scan.</li>
</ul>
<h4 data-text="Sampling" id="sampling">Sampling</h4>
<p>Sampling is an optional way to save resources if you have a very large amount of
data.</p>
<p>Under <strong>Sampling</strong>, you can choose whether to scan all the selected data or to
sample the data by scanning a certain percentage. Sampling works differently
depending on the type of storage repository you're scanning:</p>
<ul>
<li>For BigQuery, you can sample a subset of the total selected
rows, corresponding to the percentage of files you specify to include in the
scan.</li>
<li>For Cloud Storage, if any file exceeds the size specified in the <strong>Max
byte size to scan per file</strong>, Cloud DLP scans it up to that
maximum file size and then moves on to the next file.</li>
</ul>
<p>To turn on sampling, choose one of the following options from the first menu:</p>
<ul>
<li><strong>Start sampling from top</strong>: Cloud DLP starts the partial scan
at the beginning of the data. For BigQuery, this starts the
scan at the first row. For Cloud Storage, this starts the scan at the
beginning of each file, and stops scanning once Cloud DLP has
scanned up to any specified maximum file size (see above).</li>
<li><strong>Start sampling from random start</strong>: Cloud DLP starts the
partial scan at a random location within the data. For
BigQuery, this starts the scan at a random row. For
Cloud Storage, this setting only applies to files that exceed any
specified maximum size. Cloud DLP scans files under the maximum
file size in their entirety, and scans files above the maximum file size up
to the maximum.</li>
</ul>
<p>To perform a partial scan, you must also choose what percentage of the data you
want to scan. Use the slider to set the percentage.</p>
<aside class="note"><strong>Note:</strong><span> You can also narrow the files or records to scan by date. To learn how,
see <a href="#schedule-job">Schedule</a>, later in this topic.</span></aside><aside class="note"><strong>Note:</strong><span> Clicking <strong>Create</strong> here creates a job that runs once, immediately. If you
want to create a job trigger that will run on a periodic schedule, click
<strong>Continue</strong>. You must set a <a href="#schedule-job">schedule</a> to create a job trigger.</span></aside>
<h4 data-text="Advanced configuration" id="advanced_configuration">Advanced configuration</h4>
<p>When you create a job for a scan of Cloud Storage buckets or
BigQuery tables, you can narrow your search by specifying an
advanced configuration. Specifically, you can configure:</p>
<ul>
<li><a href="#job-files">Files</a> (Cloud Storage only): The file types to scan for, which
include text, binary, and image files.</li>
<li><a href="#job-identifying-fields">Identifying fields</a> (BigQuery only):
Unique row identifiers within the table.</li>
<li>For Cloud Storage, if any file exceeds the size specified in the <strong>Max
byte size to scan per file</strong>, Cloud DLP scans it up to that
maximum file size and then moves on to the next file.</li>
</ul>
<p>To turn on sampling, choose what percentage of the data you want to scan. Use
the slider to set the percentage. Then, choose one of the following options
from the first menu:</p>
<ul>
<li><strong>Start sampling from top</strong>: Cloud DLP starts the partial scan
at the beginning of the data. For BigQuery, this starts the
scan at the first row. For Cloud Storage, this starts the scan at the
beginning of each file, and stops scanning once Cloud DLP has
scanned up to any specified maximum file size (see above).</li>
<li><strong>Start sampling from random start</strong>: Cloud DLP starts the
partial scan at a random location within the data. For
BigQuery, this starts the scan at a random row. For
Cloud Storage, this setting only applies to files that exceed any
specified maximum size. Cloud DLP scans files under the maximum
file size in their entirety, and scans files above the maximum file size up
to the maximum.</li>
</ul>
<h4 data-text="Files" id="job-files">Files</h4>
<p>For files stored in Cloud Storage, you can specify the types to include in
your scan under <strong>Files</strong>.</p>
<p>You can choose from binary, text, image, Microsoft Word, Microsoft Excel,
Microsoft Powerpoint, PDF, and Apache Avro files. An exhaustive list of file
extensions that Cloud DLP can scan in Cloud Storage buckets is
included on the API reference page for
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#filetype"><code dir="ltr" translate="no">FileType</code></a>.
Be aware that choosing <strong>Binary</strong> causes Cloud DLP to scan files of
types that are unrecognized.</p>
<h5 data-text="Identifying fields" id="job-identifying-fields">Identifying fields</h5>
<p>For tables in BigQuery, under <strong>Identifying fields</strong> you can
direct Cloud DLP to scan only rows that have values in a specific
field or fields.</p>
<p>To add a field, click <strong>Add identifying field</strong>. Enter the field name, using
dot notation to specify nested fields, if necessary.</p>
<p>You can add as many fields as you want. To remove a field, click <strong>Delete item</strong>
(the trashcan icon) next to the field you want to delete.</p>
<h3 data-text="Configure detection" id="job-configure-detection">Configure detection</h3>
<p>The <strong>Configure detection</strong> section is where you specify the types of sensitive
data you want to scan for. Completing this section is optional. If you skip
this section, Cloud DLP will scan your data for a default set of
<a href="/dlp/docs/infotypes-reference">infoTypes</a>.</p>
<h4 data-text="Template" id="template">Template</h4>
<p>You can optionally use a Cloud DLP template to reuse configuration
information you've specified previously.</p>
<p>If you have already created a template that you want to use, click in the
<strong>Template name</strong> field to see a list of existing inspection templates. Choose
or type the name of the template you want to use.</p>
<p>For more information about creating templates, see <a href="/dlp/docs/creating-templates">Creating
Cloud DLP inspection templates</a>.</p>
<h5 data-text="InfoTypes" id="infotypes">InfoTypes</h5>
<p>InfoType detectors find sensitive data of a certain type. For example, the
Cloud DLP <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> built-in infoType detector
finds US Social Security numbers. In addition to the built-in infoType
detectors, you can create your own <a href="/dlp/docs/creating-custom-infotypes">custom infoType
detectors</a>.</p>
<p>Under <strong>InfoTypes</strong>, choose the infoType detector that corresponds to a data
type you want to scan for. You can also leave this field blank to scan for all
default infoTypes. More information about each detector is provided in
<a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</p>
<p>You can also add custom infoType detectors in the <strong>Custom infoTypes</strong> section,
and customize both built-in and custom infoType detectors in the <strong>Inspection
rulesets</strong> section.</p>
<h6 data-text="Custom infoTypes" id="custom_infotypes">Custom infoTypes</h6>
<aside class="note">
<p><strong>Note:</strong> Be aware that any custom infoType detector you create here is
         specific to this workflow and can't be reused elsewhere. The one exception is "Stored
         infoType," which requires that you create the stored custom infoType detector before
         specifying it here. To create a custom infoType detector that you can use in multiple jobs
         or templates, see <a href="/dlp/docs/creating-custom-infotypes">Creating custom infoType
         detectors</a>.</p></aside>
<p>
  To add a custom infoType detector:
</p>
<ol>
<li>Click <strong>Add custom infoType</strong>.</li>
<li>Choose the type of custom infoType detector you want to create:
  <ul>
<li><strong>Words or phrases:</strong> Matches on one or more words or phrases that you enter
      into the field. Use this custom infoType when you have just a few words or phrases to search
      for. Give your custom infoType a name, and then, under <strong>List of words or
      phrases</strong>, type the word or phrase you want Cloud DLP to match on. To
      search on multiple words or phrases, press Enter after each one. For more information, see
      <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
      detector</a>.</li>
<li><strong>Dictionary path:</strong> Searches your content for items in a list of words and
      phrases. The list is stored in a text file in Cloud Storage. Use this custom infoType
      when you have anywhere from a few to several hundred thousand words or phrases to search for.
      This method is also useful if your list contains sensitive elements and you don't want to
      store them inside of a job or template. Give your custom infoType a name, and then, under
      <strong>Dictionary location</strong>, enter or browse to the Cloud Storage path where the
      dictionary file is stored. For more information, see
      <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
      detector</a>.</li>
<li><strong>Regex:</strong> Matches content based on a regular expression. Give your custom
      infoType a name, and then, in the <strong>Regex</strong> field, enter a regex pattern to match
      words and phrases. See the <a href="https://github.com/google/re2/wiki/Syntax">supported regex
      syntax</a>.</li>
<li><strong>Stored infoType:</strong> This option adds a stored custom dictionary detector,
      which is a kind of dictionary detector that is built from either a large text file stored in
      Cloud Storage or a single column of a BigQuery table. Use this kind of
      custom infoType when you have anywhere from several hundred thousand to tens of millions of
      words or phrases to search for. Be aware that this is the only option in this menu for which
      you must have already created the stored infoType to use it. Give your custom infoType a
      name (different from the name you gave the stored infoType), and then, in the <strong>Stored
      infoType</strong> field, enter the name of the stored infoType. For more information about
      creating stored custom dictionaries, see
      <a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary
        detector</a>.</li>
</ul></li>
</ol>
<p>
  Click <strong>Add custom infoType</strong> again to add additional custom infoType detectors.
</p>
<h6 data-text="Inspection rulesets" id="inspection_rulesets">Inspection rulesets</h6>
<p>
  Inspection rulesets allow you to customize both built-in and custom infoType detectors using
  context rules. The two types of inspection rules are:
</p>
<ul>
<li><em><a href="/dlp/docs/creating-custom-infotypes-rules#exclusion-rules">Exclusion
    rules</a></em>, which help exclude false or unwanted findings.</li>
<li><em><a href="/dlp/docs/creating-custom-infotypes-rules#hotword_rules">Hotword rules</a></em>,
    which help detect additional findings.</li>
</ul>
<p>
  To add a new ruleset, first specify one or more built-in or custom infoType detectors in the
  <strong>InfoTypes</strong> section. These are the infoType detectors that your rulesets will be
  modifying. Then, do the following:
</p>
<ol>
<li>Click in the <strong>Choose infoTypes</strong> field. The infoType or infoTypes you specified
    previously appear below the field in a menu, as shown here:</li>
<img alt="Screenshot of the DLP UI's inspection rulesets configuration." class="screenshot" src="https://cloud.google.com/dlp/docs/images/inspection-rulesets-new-ruleset.png" width="532">
<li>Choose an infoType from the menu, and then click <strong>Add rule</strong>. A menu appears
    with the two options <strong>Hotword rule</strong> and <strong>Exclusion rule</strong>.</li>
</img></ol>
<p>
  For hotword rules, choose <strong>Hotword rules</strong>. Then, do the following:
</p>
<ol>
<li>In the <strong>Hotword</strong> field, enter a regular expression that Cloud DLP
    should look for.</li>
<li>From the <strong>Hotword proximity</strong> menu, choose whether the hotword you entered is
    found before or after the chosen infoType.</li>
<li>In <strong>Hotword distance from infoType</strong>, enter the approximate number of characters
    between the hotword and the chosen infoType.</li>
<li>In <strong>Confidence level adjustment</strong>, choose whether to assign matches a fixed
    <a href="/dlp/docs/likelihood">likelihood</a> level, or to increase or decrease the default
    likelihood level by a certain amount.</li>
</ol>
<p>
  For exclusion rules, choose <strong>Exclusion rules</strong>. Then, do the following:
</p>
<ol>
<li>In the <strong>Exclude</strong> field, enter a regular expression (regex) that
    Cloud DLP should look for.</li>
<li>From the <strong>Matching type</strong> menu, choose one of the following:</li>
<ul>
<li><strong>Full match</strong>: The finding must completely match the regex.</li>
<li><strong>Partial match</strong>: A substring of the finding can match the regex.</li>
<li><strong>Inverse match</strong>: The finding doesn't match the regex.</li>
</ul>
</ol>
<p>
  You can add additional hotword or exclusion rules and rulesets to further refine your scan
  results.
</p>
<h5 data-text="Confidence threshold" id="confidence_threshold">Confidence threshold</h5>
<p>Every time Cloud DLP detects a potential match for sensitive data,
it assigns it a <a href="/dlp/docs/likelihood">likelihood</a> value on a scale from "Very unlikely"
to "Very likely." When you set a likelihood value here, you are instructing
Cloud DLP to only match on data that corresponds to that likelihood
value or higher.</p>
<p>The default value of "Possible" is sufficient for most purposes. If you
routinely get matches that are too broad, move the slider up. If you get
too few matches, move the slider down.</p>
<p>When you're done, click <strong>Continue</strong>.</p>
<h3 data-text="Add actions" id="job-add-actions">Add actions</h3>
<p>In the <strong>Add actions</strong> step, you select the action or actions you want
Cloud DLP to take after the job completes.</p>
<p>Your choices are:</p>
<ul>
<li><strong>Save to BigQuery</strong>: This option saves findings to a
BigQuery table. The findings that are stored in
BigQuery contain details about each finding's location and
match likelihood. If you don't store findings, the completed job will only
contain statistics about the number and infoTypes of the findings. If you
don't specify a table ID, BigQuery assigns a default name to
a new table. If you specify an existing table, findings are appended to it.
Choose the <strong>Include quote</strong> checkbox to include contextual text in each
match result.</li>
<li><strong>Publish to Pub/Sub</strong>: This option sends a notification message to a
Pub/Sub when the job completes. Click <strong>New Topic</strong> to specify one
or more topic names to which you want to publish the notification.</li>
<li><strong>Publish to Google Cloud Security Command Center</strong>: This option publishes
a summary of your results to <a href="/security-command-center">Security Command Center</a>.
For more information, see <a href="/dlp/docs/sending-results-to-scc">Sending Cloud DLP scan results to
Security Command Center</a>.</li>
<li><strong>Publish to Data Catalog</strong>: Choose this option to send inspection results
to <a href="/data-catalog">Data Catalog</a>, Google Cloud's metadata management
service.</li>
<li><strong>Publish to Stackdriver</strong>: Choose this option to send inspection results to
Cloud Monitoring, Google Cloud's operations suite.</li>
<li><strong>Notify by email</strong>: This option causes Cloud DLP to send an
email to project owners and editors when the job completes.</li>
</ul>
<p>When you're done selecting actions, click <strong>Continue</strong>.</p>
<h3 data-text="Review" id="review-job">Review</h3>
<p>The <strong>Review</strong> section contains a JSON-formatted summary of the job settings
you just specified.</p>
<p>Click <strong>Create</strong> to create the job (if you didn't specify a schedule) and to
run the job once. The job'sinformation page appears, which contains status and
other information. If the job is currently running, you can click the
<strong>Cancel</strong> button to stop it. You can also delete the job by clicking
<strong>Delete</strong>.</p>
<p>To return to the main Cloud DLP page, click the <strong>Back</strong> arrow in
the Cloud console.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-create-job-protocol" track-metadata-position="dlp-create-job" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>A job is represented in the DLP API by the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">DlpJobs</code></a>
resource. You can create a new job by using the <code dir="ltr" translate="no">DlpJob</code> resource's
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create"><code dir="ltr" translate="no">projects.dlpJobs.create</code></a>
method.</p>
<p>This sample JSON can be sent in a POST request to the specified
Cloud DLP REST endpoint. This example JSON demonstrates how to
create a job in Cloud DLP. The job is a Datastore
inspection scan.</p>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
Keep in mind that a successful request, even one created in API Explorer,
will create a job. For general information about using JSON to send requests to
the DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.dlpJobs.create"></div>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectJob": {
    "storageConfig": {
      "bigQueryOptions": {
        "tableReference": {
          "projectId": "bigquery-public-data",
          "datasetId": "san_francisco_sfpd_incidents",
          "tableId": "sfpd_incidents"
        }
      },
      "timespanConfig": {
        "startTime": "2020-01-01T00:00:01Z",
        "endTime": "2020-01-31T23:59:59Z",
        "timestampField": {
          "name": "timestamp"
        }
      }
    },
    "inspectConfig": {
      "infoTypes": [
        {
          "name": "PERSON_NAME"
        },
        {
          "name": "STREET_ADDRESS"
        }
      ],
      "excludeInfoTypes": false,
      "includeQuote": true,
      "minLikelihood": "LIKELY"
    },
    "actions": [
      {
        "saveFindings": {
          "outputConfig": {
            "table": {
              "projectId": "[PROJECT-ID]",
              "datasetId": "[DATASET-ID]"
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<p>The following output indicates that the job was successfully created.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name": "projects/[PROJECT-ID]/dlpJobs/[JOB-ID]",
  "type": "INSPECT_JOB",
  "state": "PENDING",
  "inspectDetails": {
    "requestedOptions": {
      "snapshotInspectTemplate": {},
      "jobConfig": {
        "storageConfig": {
          "bigQueryOptions": {
            "tableReference": {
              "projectId": "bigquery-public-data",
              "datasetId": "san_francisco_sfpd_incidents",
              "tableId": "sfpd_incidents"
            }
          },
          "timespanConfig": {
            "startTime": "2020-01-01T00:00:01Z",
            "endTime": "2020-01-31T23:59:59Z",
            "timestampField": {
              "name": "timestamp"
            }
          }
        },
        "inspectConfig": {
          "infoTypes": [
            {
              "name": "PERSON_NAME"
            },
            {
              "name": "STREET_ADDRESS"
            }
          ],
          "minLikelihood": "LIKELY",
          "limits": {},
          "includeQuote": true
        },
        "actions": [
          {
            "saveFindings": {
              "outputConfig": {
                "table": {
                  "projectId": "[PROJECT-ID]",
                  "datasetId": "[DATASET-ID]",
                  "tableId": "[TABLE-ID]"
                }
              }
            }
          }
        ]
      }
    },
    "result": {}
  },
  "createTime": "2020-07-10T07:26:33.643Z"
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-create-job-java" track-metadata-position="dlp-create-job" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-job" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsCreate.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsCreate.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-job" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-create-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsCreate.java" data-region-tag="dlp_create_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsCreate.java/HEAD/dlp_create_job" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.Action;
import com.google.privacy.dlp.v2.CloudStorageOptions;
import com.google.privacy.dlp.v2.CreateDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.privacy.dlp.v2.StorageConfig.TimespanConfig;
import java.io.IOException;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class JobsCreate {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String gcsPath = "gs://" + "your-bucket-name" + "path/to/file.txt";
    createJobs(projectId, gcsPath);
  }

  // Creates a DLP Job
  public static void createJobs(String projectId, String gcsPath) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Set autoPopulateTimespan to true to scan only new content
      boolean autoPopulateTimespan = true;
      TimespanConfig timespanConfig =
          TimespanConfig.newBuilder()
              .setEnableAutoPopulationOfTimespanConfig(autoPopulateTimespan)
              .build();

      // Specify the GCS file to be inspected.
      CloudStorageOptions cloudStorageOptions =
          CloudStorageOptions.newBuilder()
              .setFileSet(CloudStorageOptions.FileSet.newBuilder().setUrl(gcsPath))
              .build();
      StorageConfig storageConfig =
          StorageConfig.newBuilder()
              .setCloudStorageOptions(cloudStorageOptions)
              .setTimespanConfig(timespanConfig)
              .build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      List&lt;InfoType&gt; infoTypes =
          Stream.of("EMAIL_ADDRESS", "PERSON_NAME", "LOCATION", "PHONE_NUMBER")
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());
      // The minimum likelihood required before returning a match:
      // See: https://cloud.google.com/dlp/docs/likelihood
      Likelihood minLikelihood = Likelihood.UNLIKELY;

      // The maximum number of findings to report (0 = server maximum)
      InspectConfig.FindingLimits findingLimits =
          InspectConfig.FindingLimits.newBuilder().setMaxFindingsPerItem(100).build();

      InspectConfig inspectConfig =
          InspectConfig.newBuilder()
              .addAllInfoTypes(infoTypes)
              .setIncludeQuote(true)
              .setMinLikelihood(minLikelihood)
              .setLimits(findingLimits)
              .build();

      // Specify the action that is triggered when the job completes.
      Action.PublishSummaryToCscc publishSummaryToCscc =
          Action.PublishSummaryToCscc.getDefaultInstance();
      Action action = Action.newBuilder().setPublishSummaryToCscc(publishSummaryToCscc).build();

      // Configure the inspection job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setInspectConfig(inspectConfig)
              .setStorageConfig(storageConfig)
              .addActions(action)
              .build();

      // Construct the job creation request to be sent by the client.
      CreateDlpJobRequest createDlpJobRequest =
          CreateDlpJobRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setInspectJob(inspectJobConfig)
              .build();

      // Send the job creation request and process the response.
      DlpJob createdDlpJob = dlpServiceClient.createDlpJob(createDlpJobRequest);
      System.out.println("Job created successfully: " + createdDlpJob.getName());
    }
  }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Create a new job trigger" id="create_a_new_job_trigger">Create a new job trigger</h2>
<p>To create a new Cloud DLP job trigger:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-create-triggers-code-sample">
<section>
<h3 data-text="Console" id="dlp-create-triggers-console" track-metadata-position="dlp-create-triggers" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Job or job trigger</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p>
<p>Alternatively, click the following button:</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp/create/job;source=7" target="console">Create new job trigger</a> </p></li>
</ol>
<p>The Create job trigger page contains the following sections:</p>
<ul>
<li><a href="#choose-input-data">Choose input data</a></li>
<li><a href="#configure-detection">Configure detection</a></li>
<li><a href="#add-actions">Add actions</a></li>
<li><a href="#schedule-job">Schedule</a></li>
<li><a href="#review-job-trigger">Review</a></li>
</ul>
<h3 data-text="Choose input data" id="choose-input-data">Choose input data</h3>
<h4 data-text="Name" id="name_2">Name</h4>
<p>Enter a name for the job trigger. You can use letters, numbers, and hyphens.
Naming your job trigger is optional. If you don't enter a name
Cloud DLP will give the job trigger a unique number identifier.</p>
<h4 data-text="Location" id="location_2">Location</h4>
<p>From the <strong>Storage type</strong> menu, choose the kind of repository that stores the
data you want to scan:</p>
<ul>
<li>Cloud Storage: Either enter the URL of the bucket you want to scan,
 or choose <strong>Include/exclude</strong> from the <strong>Location type</strong>
 menu, and then click <strong>Browse</strong> to navigate to the bucket or subfolder
 you want to scan. Select the <strong>Scan folder recursively</strong> checkbox to
 scan the specified directory and all contained directories. Leave it
 unselected to scan only the specified directory and no deeper.</li>
<li>BigQuery: Enter the identifiers for the project, dataset,
 and table that you want to scan.</li>
<li>Datastore: Enter the identifiers for the project,
 namespace (optional), and kind that you want to scan.</li>
</ul>
<h4 data-text="Sampling" id="sampling_2">Sampling</h4>
<p>Sampling is an optional way to save resources if you have a very large amount of
data.</p>
<p>Under <strong>Sampling</strong>, you can choose whether to scan all the selected data or to
sample the data by scanning a certain percentage. Sampling works differently
depending on the type of storage repository you're scanning:</p>
<ul>
<li>For BigQuery, you can sample a subset of the total selected
rows, corresponding to the percentage of files you specify to include in the
scan.</li>
<li>For Cloud Storage, if any file exceeds the size specified in the <strong>Max
byte size to scan per file</strong>, Cloud DLP scans it up to that
maximum file size and then moves on to the next file.</li>
</ul>
<p>To turn on sampling, choose one of the following options from the first menu:</p>
<ul>
<li><strong>Start sampling from top</strong>: Cloud DLP starts the partial scan
at the beginning of the data. For BigQuery, this starts the
scan at the first row. For Cloud Storage, this starts the scan at the
beginning of each file, and stops scanning once Cloud DLP has
scanned up to any specified maximum file size (see above).</li>
<li><strong>Start sampling from random start</strong>: Cloud DLP starts the
partial scan at a random location within the data. For
BigQuery, this starts the scan at a random row. For
Cloud Storage, this setting only applies to files that exceed any
specified maximum size. Cloud DLP scans files under the maximum
file size in their entirety, and scans files above the maximum file size up
to the maximum.</li>
</ul>
<p>To perform a partial scan, you must also choose what percentage of the data you
want to scan. Use the slider to set the percentage.</p>
<aside class="note"><strong>Note:</strong><span> You can also narrow the files or records to scan by date. To learn how,
see <a href="#schedule-job">Schedule</a>, later in this topic.</span></aside><aside class="note"><strong>Note:</strong><span> Clicking <strong>Create</strong> here creates a job that runs once, immediately. If you
want to create a job trigger that will run on a periodic schedule, click
<strong>Continue</strong>. You must set a <a href="#schedule-job">schedule</a> to create a job trigger.</span></aside>
<h4 data-text="Advanced configuration" id="advanced_configuration_2">Advanced configuration</h4>
<p>When you create a job trigger for a scan of Cloud Storage buckets
or BigQuery tables, you can narrow your search by specifying an
advanced configuration. Specifically, you can configure:</p>
<ul>
<li><a href="#files">Files</a> (Cloud Storage only): The file types to scan for, which
include text, binary, and image files.</li>
<li><a href="#identifying-fields">Identifying fields</a> (BigQuery only):
Unique row identifiers within the table.</li>
<li>For Cloud Storage, if any file exceeds the size specified in the <strong>Max
byte size to scan per file</strong>, Cloud DLP scans it up to that
maximum file size and then moves on to the next file.</li>
</ul>
<p>To turn on sampling, choose what percentage of the data you want to scan. Use
the slider to set the percentage. Then, choose one of the following options
from the first menu:</p>
<ul>
<li><strong>Start sampling from top</strong>: Cloud DLP starts the partial scan
at the beginning of the data. For BigQuery, this starts the
scan at the first row. For Cloud Storage, this starts the scan at the
beginning of each file, and stops scanning once Cloud DLP has
scanned up to any specified maximum file size (see above).</li>
<li><strong>Start sampling from random start</strong>: Cloud DLP starts the
partial scan at a random location within the data. For
BigQuery, this starts the scan at a random row. For
Cloud Storage, this setting only applies to files that exceed any
specified maximum size. Cloud DLP scans files under the maximum
file size in their entirety, and scans files above the maximum file size up
to the maximum.</li>
</ul>
<aside class="note"><strong>Note:</strong><span> You can also narrow the files or records to scan by date. To learn how,
see <a href="#schedule-job">Schedule</a>, below.</span></aside>
<h4 data-text="Files" id="files">Files</h4>
<p>For files stored in Cloud Storage, you can specify the types to include in
your scan under <strong>Files</strong>.</p>
<p>You can choose from binary, text, image, Microsoft Word, Microsoft Excel,
Microsoft Powerpoint, PDF, and Apache Avro
files. An exhaustive list of file extensions that Cloud DLP can
scan in Cloud Storage buckets is included on the API reference page for
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#filetype"><code dir="ltr" translate="no">FileType</code></a>.
Be aware that choosing <strong>Binary</strong> causes Cloud DLP to scan files of
types that are unrecognized.</p>
<h5 data-text="Identifying fields" id="identifying-fields">Identifying fields</h5>
<p>For tables in BigQuery, under <strong>Identifying fields</strong> you can
direct Cloud DLP to scan only rows that have values in a specific
field or fields.</p>
<p>To add a field, click <strong>Add identifying field</strong>. Enter the field name, using
dot notation to specify nested fields, if necessary.</p>
<p>You can add as many fields as you want. To remove a field, click <strong>Delete item</strong>
(the trashcan icon) next to the field you want to delete.</p>
<h3 data-text="Configure detection" id="configure-detection">Configure detection</h3>
<p>The <strong>Configure detection</strong> section is where you specify the types of sensitive
data you want to scan for. Completing this section is optional. If you skip
this section, Cloud DLP will scan your data for a default set of
<a href="/dlp/docs/infotypes-reference">infoTypes</a>.</p>
<h4 data-text="Template" id="template_2">Template</h4>
<p>You can optionally use a Cloud DLP template to reuse configuration
information you've specified previously.</p>
<p>If you have already created a template that you want to use, click in the
<strong>Template name</strong> field to see a list of existing inspection templates. Choose
or type the name of the template you want to use.</p>
<p>For more information about creating templates, see <a href="/dlp/docs/creating-templates">Creating
Cloud DLP inspection templates</a>.</p>
<h5 data-text="InfoTypes" id="infotypes_2">InfoTypes</h5>
<p>InfoType detectors find sensitive data of a certain type. For example, the
Cloud DLP <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> built-in infoType detector
finds US Social Security numbers. In addition to the built-in infoType
detectors, you can create your own <a href="/dlp/docs/creating-custom-infotypes">custom infoType
detectors</a>.</p>
<p>Under <strong>InfoTypes</strong>, choose the infoType detector that corresponds to a data
type you want to scan for. You can also leave this field blank to scan for all
default infoTypes. More information about each detector is provided in
<a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</p>
<p>You can also add custom infoType detectors in the <strong>Custom infoTypes</strong> section,
and customize both built-in and custom infoType detectors in the <strong>Inspection
rulesets</strong> section.</p>
<h6 data-text="Custom infoTypes" id="custom_infotypes_2">Custom infoTypes</h6>
<aside class="note">
<p><strong>Note:</strong> Be aware that any custom infoType detector you create here is
         specific to this workflow and can't be reused elsewhere. The one exception is "Stored
         infoType," which requires that you create the stored custom infoType detector before
         specifying it here. To create a custom infoType detector that you can use in multiple jobs
         or templates, see <a href="/dlp/docs/creating-custom-infotypes">Creating custom infoType
         detectors</a>.</p></aside>
<p>
  To add a custom infoType detector:
</p>
<ol>
<li>Click <strong>Add custom infoType</strong>.</li>
<li>Choose the type of custom infoType detector you want to create:
  <ul>
<li><strong>Words or phrases:</strong> Matches on one or more words or phrases that you enter
      into the field. Use this custom infoType when you have just a few words or phrases to search
      for. Give your custom infoType a name, and then, under <strong>List of words or
      phrases</strong>, type the word or phrase you want Cloud DLP to match on. To
      search on multiple words or phrases, press Enter after each one. For more information, see
      <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
      detector</a>.</li>
<li><strong>Dictionary path:</strong> Searches your content for items in a list of words and
      phrases. The list is stored in a text file in Cloud Storage. Use this custom infoType
      when you have anywhere from a few to several hundred thousand words or phrases to search for.
      This method is also useful if your list contains sensitive elements and you don't want to
      store them inside of a job or template. Give your custom infoType a name, and then, under
      <strong>Dictionary location</strong>, enter or browse to the Cloud Storage path where the
      dictionary file is stored. For more information, see
      <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
      detector</a>.</li>
<li><strong>Regex:</strong> Matches content based on a regular expression. Give your custom
      infoType a name, and then, in the <strong>Regex</strong> field, enter a regex pattern to match
      words and phrases. See the <a href="https://github.com/google/re2/wiki/Syntax">supported regex
      syntax</a>.</li>
<li><strong>Stored infoType:</strong> This option adds a stored custom dictionary detector,
      which is a kind of dictionary detector that is built from either a large text file stored in
      Cloud Storage or a single column of a BigQuery table. Use this kind of
      custom infoType when you have anywhere from several hundred thousand to tens of millions of
      words or phrases to search for. Be aware that this is the only option in this menu for which
      you must have already created the stored infoType to use it. Give your custom infoType a
      name (different from the name you gave the stored infoType), and then, in the <strong>Stored
      infoType</strong> field, enter the name of the stored infoType. For more information about
      creating stored custom dictionaries, see
      <a href="/dlp/docs/creating-stored-infotypes">Creating a stored custom dictionary
        detector</a>.</li>
</ul></li>
</ol>
<p>
  Click <strong>Add custom infoType</strong> again to add additional custom infoType detectors.
</p>
<h6 data-text="Inspection rulesets" id="inspection_rulesets_2">Inspection rulesets</h6>
<p>
  Inspection rulesets allow you to customize both built-in and custom infoType detectors using
  context rules. The two types of inspection rules are:
</p>
<ul>
<li><em><a href="/dlp/docs/creating-custom-infotypes-rules#exclusion-rules">Exclusion
    rules</a></em>, which help exclude false or unwanted findings.</li>
<li><em><a href="/dlp/docs/creating-custom-infotypes-rules#hotword_rules">Hotword rules</a></em>,
    which help detect additional findings.</li>
</ul>
<p>
  To add a new ruleset, first specify one or more built-in or custom infoType detectors in the
  <strong>InfoTypes</strong> section. These are the infoType detectors that your rulesets will be
  modifying. Then, do the following:
</p>
<ol>
<li>Click in the <strong>Choose infoTypes</strong> field. The infoType or infoTypes you specified
    previously appear below the field in a menu, as shown here:</li>
<img alt="Screenshot of the DLP UI's inspection rulesets configuration." class="screenshot" src="https://cloud.google.com/dlp/docs/images/inspection-rulesets-new-ruleset.png" width="532">
<li>Choose an infoType from the menu, and then click <strong>Add rule</strong>. A menu appears
    with the two options <strong>Hotword rule</strong> and <strong>Exclusion rule</strong>.</li>
</img></ol>
<p>
  For hotword rules, choose <strong>Hotword rules</strong>. Then, do the following:
</p>
<ol>
<li>In the <strong>Hotword</strong> field, enter a regular expression that Cloud DLP
    should look for.</li>
<li>From the <strong>Hotword proximity</strong> menu, choose whether the hotword you entered is
    found before or after the chosen infoType.</li>
<li>In <strong>Hotword distance from infoType</strong>, enter the approximate number of characters
    between the hotword and the chosen infoType.</li>
<li>In <strong>Confidence level adjustment</strong>, choose whether to assign matches a fixed
    <a href="/dlp/docs/likelihood">likelihood</a> level, or to increase or decrease the default
    likelihood level by a certain amount.</li>
</ol>
<p>
  For exclusion rules, choose <strong>Exclusion rules</strong>. Then, do the following:
</p>
<ol>
<li>In the <strong>Exclude</strong> field, enter a regular expression (regex) that
    Cloud DLP should look for.</li>
<li>From the <strong>Matching type</strong> menu, choose one of the following:</li>
<ul>
<li><strong>Full match</strong>: The finding must completely match the regex.</li>
<li><strong>Partial match</strong>: A substring of the finding can match the regex.</li>
<li><strong>Inverse match</strong>: The finding doesn't match the regex.</li>
</ul>
</ol>
<p>
  You can add additional hotword or exclusion rules and rulesets to further refine your scan
  results.
</p>
<h5 data-text="Confidence threshold" id="confidence_threshold_2">Confidence threshold</h5>
<p>Every time Cloud DLP detects a potential match for sensitive data,
it assigns it a <a href="/dlp/docs/likelihood">likelihood</a> value on a scale from "Very unlikely"
to "Very likely." When you set a likelihood value here, you are instructing
Cloud DLP to only match on data that corresponds to that likelihood
value or higher.</p>
<p>The default value of "Possible" is sufficient for most purposes. If you
routinely get matches that are too broad, move the slider up. If you get
too few matches, move the slider down.</p>
<p>When you're done, click <strong>Continue</strong>.</p>
<h3 data-text="Add actions" id="add-actions">Add actions</h3>
<p>In the <strong>Add actions</strong> step, you select the action or actions you want
Cloud DLP to take after the job completes.</p>
<p>Your choices are:</p>
<ul>
<li><strong>Save to BigQuery</strong>: This option saves findings to a
BigQuery table. The findings that are stored in
BigQuery contain details about each finding's location and
match likelihood. If you don't store findings, the completed job will only
contain statistics about the number and infoTypes of the findings. If you
don't specify a table ID, BigQuery assigns a default name to
a new table. If you specify an existing table, findings are appended to it.
Choose the <strong>Include quote</strong> checkbox to include contextual text in each
match result.</li>
<li><strong>Publish to Pub/Sub</strong>: This option sends a notification message to a
Pub/Sub when the job completes. Click <strong>New Topic</strong> to specify one
or more topic names to which you want to publish the notification.</li>
<li><strong>Publish to Google Cloud Security Command Center</strong>: This option publishes
a summary of your results to <a href="/security-command-center">Security Command Center</a>.
For more information, see <a href="/dlp/docs/sending-results-to-scc">Sending Cloud DLP scan results to
Security Command Center</a>.</li>
<li><strong>Publish to Data Catalog</strong>: Choose this option to send inspection results
to <a href="/data-catalog">Data Catalog</a>, Google Cloud's metadata management
service.</li>
<li><strong>Publish to Stackdriver</strong>: Choose this option to send inspection results to
Cloud Monitoring, Google Cloud's operations suite.</li>
<li><strong>Notify by email</strong>: This option causes Cloud DLP to send an
email to project owners and editors when the job completes.</li>
</ul>
<p>When you're done selecting actions, click <strong>Continue</strong>.</p>
<h3 data-text="Schedule" id="schedule-job">Schedule</h3>
<p>In the <strong>Schedule</strong> section, you can do two things:</p>
<ul>
<li><strong>Specify time span</strong>: This option limits the files or rows to scan by date.
Click <strong>Start time</strong> to specify the earliest file timestamp to include.
Leave this value blank to specify all files. Click <strong>End time</strong> to specify
the latest file timestamp to include. Leave this value blank to specify
no upper timestamp limit.</li>
<li><strong>Create a trigger to run the job on a periodic schedule</strong>: This option
creates the job trigger, and sets it to run the job you've specified on a
periodic schedule. The default value is also the minimum value: 24 hours.
The maximum value is 60 days. If you only want Cloud DLP to
scan new files or rows, select the <strong>Limit scans only to new content</strong>
checkbox.</li>
</ul>
<aside class="special"><strong>Important:</strong><span> Setting the <strong>Create a trigger to run the job on a periodic
schedule</strong> option is what makes a job into a job trigger. If you don't specify
a schedule, you effectively create a single job that starts immediately and
runs once. To create a job trigger that runs regularly, you must set this
option.</span></aside>
<h3 data-text="Review" id="review-job-trigger">Review</h3>
<p>The <strong>Review</strong> section contains a JSON-formatted summary of the job settings
you just specified.</p>
<p>Click <strong>Create</strong> to create the job trigger (if you specified a schedule). The
job trigger's information page appears, which contains status and other
information. If the job is currently running, you can click the <strong>Cancel</strong>
button to stop it. You can also delete the job trigger by clicking <strong>Delete</strong>.</p>
<p>To return to the main Cloud DLP page, click the <strong>Back</strong> arrow in
the Cloud console.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-create-triggers-protocol" track-metadata-position="dlp-create-triggers" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>A job trigger is represented in the DLP API by the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers"><code dir="ltr" translate="no">JobTrigger</code></a>
resource. You can create a new job trigger by using the <code dir="ltr" translate="no">JobTrigger</code> resource's
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/create"><code dir="ltr" translate="no">projects.jobTriggers.create</code></a>
method.</p>
<p>This sample JSON can be sent in a POST request to the specified
Cloud DLP REST endpoint. This example JSON demonstrates how to
create a job trigger in Cloud DLP. The job that this trigger
will kick off is a Datastore inspection scan. The job trigger
that is created runs every 86,400 seconds (or 24 hours).</p>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
Keep in mind that a successful request, even one created in API Explorer,
will create a new scheduled job trigger. For general information about using
JSON to send requests to the DLP API, see the <a href="/dlp/docs/quickstart-json">JSON
quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.jobTriggers.create"></div>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "jobTrigger":{
    "displayName":"JobTrigger1",
    "description":"Starts a DLP scan job of a Datastore kind",
    "triggers":[
      {
        "schedule":{
          "recurrencePeriodDuration":"86400s"
        }
      }
    ],
    "status":"HEALTHY",
    "inspectJob":{
      "storageConfig":{
        "datastoreOptions":{
          "kind":{
            "name":"Example-Kind"
          },
          "partitionId":{
            "projectId":"[PROJECT_ID]",
            "namespaceId":"[NAMESPACE_ID]"
          }
        }
      },
      "inspectConfig":{
        "infoTypes":[
          {
            "name":"PHONE_NUMBER"
          }
        ],
        "excludeInfoTypes":false,
        "includeQuote":true,
        "minLikelihood":"LIKELY"
      },
      "actions":[
        {
          "saveFindings":{
            "outputConfig":{
              "table":{
                "projectId":"[PROJECT_ID]",
                "datasetId":"[BIGQUERY_DATASET_NAME]",
                "tableId":"[BIGQUERY_TABLE_NAME]"
              }
            }
          }
        }
      ]
    }
  }
}
</code></pre>
<p><strong>JSON output:</strong></p>
<p>The following output indicates that the job trigger was successfully created.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT_ID]/jobTriggers/[JOB_TRIGGER_NAME]",
  "displayName":"JobTrigger1",
  "description":"Starts a DLP scan job of a Datastore kind",
  "inspectJob":{
    "storageConfig":{
      "datastoreOptions":{
        "partitionId":{
          "projectId":"[PROJECT_ID]",
          "namespaceId":"[NAMESPACE_ID]"
        },
        "kind":{
          "name":"Example-Kind"
        }
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "minLikelihood":"LIKELY",
      "limits":{

      },
      "includeQuote":true
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT_ID]",
              "datasetId":"[BIGQUERY_DATASET_NAME]",
              "tableId":"[BIGQUERY_TABLE_NAME]"
            }
          }
        }
      }
    ]
  },
  "triggers":[
    {
      "schedule":{
        "recurrencePeriodDuration":"86400s"
      }
    }
  ],
  "createTime":"2018-11-30T01:52:41.171857Z",
  "updateTime":"2018-11-30T01:52:41.171857Z",
  "status":"HEALTHY"
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-create-triggers-java" track-metadata-position="dlp-create-triggers" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-triggers" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TriggersCreate.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TriggersCreate.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-triggers" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-create-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TriggersCreate.java" data-region-tag="dlp_create_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TriggersCreate.java/HEAD/dlp_create_trigger" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.CloudStorageOptions;
import com.google.privacy.dlp.v2.CreateJobTriggerRequest;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectJobConfig;
import com.google.privacy.dlp.v2.JobTrigger;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.Schedule;
import com.google.privacy.dlp.v2.StorageConfig;
import com.google.privacy.dlp.v2.StorageConfig.TimespanConfig;
import com.google.protobuf.Duration;
import java.io.IOException;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class TriggersCreate {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String gcsPath = "gs://" + "your-bucket-name" + "path/to/file.txt";
    createTrigger(projectId, gcsPath);
  }

  public static void createTrigger(String projectId, String gcsPath) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Set autoPopulateTimespan to true to scan only new content
      boolean autoPopulateTimespan = true;
      TimespanConfig timespanConfig =
          TimespanConfig.newBuilder()
              .setEnableAutoPopulationOfTimespanConfig(autoPopulateTimespan)
              .build();

      // Specify the GCS file to be inspected.
      CloudStorageOptions cloudStorageOptions =
          CloudStorageOptions.newBuilder()
              .setFileSet(CloudStorageOptions.FileSet.newBuilder().setUrl(gcsPath))
              .build();
      StorageConfig storageConfig =
          StorageConfig.newBuilder()
              .setCloudStorageOptions(cloudStorageOptions)
              .setTimespanConfig(timespanConfig)
              .build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      List&lt;InfoType&gt; infoTypes =
          Stream.of("PHONE_NUMBER", "EMAIL_ADDRESS", "CREDIT_CARD_NUMBER")
              .map(it -&gt; InfoType.newBuilder().setName(it).build())
              .collect(Collectors.toList());

      InspectConfig inspectConfig = InspectConfig.newBuilder().addAllInfoTypes(infoTypes).build();

      // Configure the inspection job we want the service to perform.
      InspectJobConfig inspectJobConfig =
          InspectJobConfig.newBuilder()
              .setInspectConfig(inspectConfig)
              .setStorageConfig(storageConfig)
              .build();

      // Set scanPeriod to the number of days between scans (minimum: 1 day)
      int scanPeriod = 1;

      // Optionally set a display name of max 100 chars and a description of max 250 chars
      String displayName = "Daily Scan";
      String description = "A daily inspection for personally identifiable information.";

      // Schedule scan of GCS bucket every scanPeriod number of days (minimum = 1 day)
      Duration duration = Duration.newBuilder().setSeconds(scanPeriod * 24 * 3600).build();
      Schedule schedule = Schedule.newBuilder().setRecurrencePeriodDuration(duration).build();
      JobTrigger.Trigger trigger = JobTrigger.Trigger.newBuilder().setSchedule(schedule).build();
      JobTrigger jobTrigger =
          JobTrigger.newBuilder()
              .setInspectJob(inspectJobConfig)
              .setDisplayName(displayName)
              .setDescription(description)
              .setStatus(JobTrigger.Status.HEALTHY)
              .addTriggers(trigger)
              .build();

      // Create scan request to be sent by client
      CreateJobTriggerRequest createJobTriggerRequest =
          CreateJobTriggerRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setJobTrigger(jobTrigger)
              .build();

      // Send the scan request and process the response
      JobTrigger createdJobTrigger = dlpServiceClient.createJobTrigger(createJobTriggerRequest);

      System.out.println("Created Trigger: " + createdJobTrigger.getName());
      System.out.println("Display Name: " + createdJobTrigger.getDisplayName());
      System.out.println("Description: " + createdJobTrigger.getDescription());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-create-triggers-nodejs" track-metadata-position="dlp-create-triggers" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-triggers" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/createTrigger.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/createTrigger.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-triggers" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-create-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/createTrigger.js" data-region-tag="dlp_create_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/createTrigger.js/HEAD/dlp_create_trigger" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// (Optional) The name of the trigger to be created.
// const triggerId = 'my-trigger';

// (Optional) A display name for the trigger to be created
// const displayName = 'My Trigger';

// (Optional) A description for the trigger to be created
// const description = "This is a sample trigger.";

// The name of the bucket to scan.
// const bucketName = 'YOUR-BUCKET';

// Limit scan to new content only.
// const autoPopulateTimespan = true;

// How often to wait between scans, in days (minimum = 1 day)
// const scanPeriod = 1;

// The infoTypes of information to match
// const infoTypes = [{ name: 'PHONE_NUMBER' }, { name: 'EMAIL_ADDRESS' }, { name: 'CREDIT_CARD_NUMBER' }];

// The minimum likelihood required before returning a match
// const minLikelihood = 'LIKELIHOOD_UNSPECIFIED';

// The maximum number of findings to report per request (0 = server maximum)
// const maxFindings = 0;

async function createTrigger() {
  // Get reference to the bucket to be inspected
  const storageItem = {
    cloudStorageOptions: {
      fileSet: {url: `gs://${bucketName}/*`},
    },
    timeSpanConfig: {
      enableAutoPopulationOfTimespanConfig: autoPopulateTimespan,
    },
  };

  // Construct job to be triggered
  const job = {
    inspectConfig: {
      infoTypes: infoTypes,
      minLikelihood: minLikelihood,
      limits: {
        maxFindingsPerRequest: maxFindings,
      },
    },
    storageConfig: storageItem,
  };

  // Construct trigger creation request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    jobTrigger: {
      inspectJob: job,
      displayName: displayName,
      description: description,
      triggers: [
        {
          schedule: {
            recurrencePeriodDuration: {
              seconds: scanPeriod * 60 * 60 * 24, // Trigger the scan daily
            },
          },
        },
      ],
      status: 'HEALTHY',
    },
    triggerId: triggerId,
  };

  // Run trigger creation request
  const [trigger] = await dlp.createJobTrigger(request);
  console.log(`Successfully created trigger ${trigger.name}.`);
}

createTrigger();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-create-triggers-python" track-metadata-position="dlp-create-triggers" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-triggers" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/triggers.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/triggers.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-triggers" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-create-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/triggers.py" data-region-tag="dlp_create_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/triggers.py/HEAD/dlp_create_trigger" translate="no"><code dir="ltr" translate="no">def create_trigger(
    project,
    bucket,
    scan_period_days,
    info_types,
    trigger_id=None,
    display_name=None,
    description=None,
    min_likelihood=None,
    max_findings=None,
    auto_populate_timespan=False,
):
    """Creates a scheduled Data Loss Prevention API inspect_content trigger.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        bucket: The name of the GCS bucket to scan. This sample scans all
            files in the bucket using a wildcard.
        scan_period_days: How often to repeat the scan, in days.
            The minimum is 1 day.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
        trigger_id: The id of the trigger. If omitted, an id will be randomly
            generated.
        display_name: The optional display name of the trigger.
        description: The optional description of the trigger.
        min_likelihood: A string representing the minimum likelihood threshold
            that constitutes a match. One of: 'LIKELIHOOD_UNSPECIFIED',
            'VERY_UNLIKELY', 'UNLIKELY', 'POSSIBLE', 'LIKELY', 'VERY_LIKELY'.
        max_findings: The maximum number of findings to report; 0 = no maximum.
        auto_populate_timespan: Automatically populates time span config start
            and end times in order to scan new content only.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Construct the configuration dictionary. Keys which are None may
    # optionally be omitted entirely.
    inspect_config = {
        "info_types": info_types,
        "min_likelihood": min_likelihood,
        "limits": {"max_findings_per_request": max_findings},
    }

    # Construct a cloud_storage_options dictionary with the bucket's URL.
    url = "gs://{}/*".format(bucket)
    storage_config = {
        "cloud_storage_options": {"file_set": {"url": url}},
        # Time-based configuration for each storage object.
        "timespan_config": {
            # Auto-populate start and end times in order to scan new objects
            # only.
            "enable_auto_population_of_timespan_config": auto_populate_timespan
        },
    }

    # Construct the job definition.
    job = {"inspect_config": inspect_config, "storage_config": storage_config}

    # Construct the schedule definition:
    schedule = {
        "recurrence_period_duration": {"seconds": scan_period_days * 60 * 60 * 24}
    }

    # Construct the trigger definition.
    job_trigger = {
        "inspect_job": job,
        "display_name": display_name,
        "description": description,
        "triggers": [{"schedule": schedule}],
        "status": google.cloud.dlp_v2.JobTrigger.Status.HEALTHY,
    }

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.create_job_trigger(
        request={"parent": parent, "job_trigger": job_trigger, "trigger_id": trigger_id}
    )

    print("Successfully created trigger {}".format(response.name))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-create-triggers-go" track-metadata-position="dlp-create-triggers" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-triggers" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/trigger/create.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/trigger/create.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-triggers" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-create-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/trigger/create.go" data-region-tag="dlp_create_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/trigger/create.go/HEAD/dlp_create_trigger" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	"github.com/golang/protobuf/ptypes/duration"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// createTrigger creates a trigger with the given configuration.
func createTrigger(w io.Writer, projectID string, triggerID, displayName, description, bucketName string, infoTypeNames []string) error {
	// projectID := "my-project-id"
	// triggerID := "my-trigger"
	// displayName := "My Trigger"
	// description := "My trigger description"
	// bucketName := "my-bucket"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}

	// Create a configured request.
	req := &amp;dlppb.CreateJobTriggerRequest{
		Parent:    fmt.Sprintf("projects/%s/locations/global", projectID),
		TriggerId: triggerID,
		JobTrigger: &amp;dlppb.JobTrigger{
			DisplayName: displayName,
			Description: description,
			Status:      dlppb.JobTrigger_HEALTHY,
			// Triggers control when the job will start.
			Triggers: []*dlppb.JobTrigger_Trigger{
				{
					Trigger: &amp;dlppb.JobTrigger_Trigger_Schedule{
						Schedule: &amp;dlppb.Schedule{
							Option: &amp;dlppb.Schedule_RecurrencePeriodDuration{
								RecurrencePeriodDuration: &amp;duration.Duration{
									Seconds: 10 * 60 * 60 * 24, // 10 days in seconds.
								},
							},
						},
					},
				},
			},
			// Job configures the job to run when the trigger runs.
			Job: &amp;dlppb.JobTrigger_InspectJob{
				InspectJob: &amp;dlppb.InspectJobConfig{
					InspectConfig: &amp;dlppb.InspectConfig{
						InfoTypes:     infoTypes,
						MinLikelihood: dlppb.Likelihood_POSSIBLE,
						Limits: &amp;dlppb.InspectConfig_FindingLimits{
							MaxFindingsPerRequest: 10,
						},
					},
					StorageConfig: &amp;dlppb.StorageConfig{
						Type: &amp;dlppb.StorageConfig_CloudStorageOptions{
							CloudStorageOptions: &amp;dlppb.CloudStorageOptions{
								FileSet: &amp;dlppb.CloudStorageOptions_FileSet{
									Url: "gs://" + bucketName + "/*",
								},
							},
						},
						// Time-based configuration for each storage object. See more at
						// https://cloud.google.com/dlp/docs/reference/rest/v2/InspectJobConfig#TimespanConfig
						TimespanConfig: &amp;dlppb.StorageConfig_TimespanConfig{
							// Auto-populate start and end times in order to scan new objects only.
							EnableAutoPopulationOfTimespanConfig: true,
						},
					},
				},
			},
		},
	}

	// Send the request.
	resp, err := client.CreateJobTrigger(ctx, req)
	if err != nil {
		return fmt.Errorf("CreateJobTrigger: %v", err)
	}
	fmt.Fprintf(w, "Successfully created trigger: %v", resp.GetName())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-create-triggers-php" track-metadata-position="dlp-create-triggers" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-triggers" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/create_trigger.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/create_trigger.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-triggers" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-create-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/create_trigger.php" data-region-tag="dlp_create_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/create_trigger.php/HEAD/dlp_create_trigger" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\JobTrigger;
use Google\Cloud\Dlp\V2\JobTrigger\Trigger;
use Google\Cloud\Dlp\V2\JobTrigger\Status;
use Google\Cloud\Dlp\V2\InspectConfig;
use Google\Cloud\Dlp\V2\InspectJobConfig;
use Google\Cloud\Dlp\V2\Schedule;
use Google\Cloud\Dlp\V2\CloudStorageOptions;
use Google\Cloud\Dlp\V2\CloudStorageOptions_FileSet;
use Google\Cloud\Dlp\V2\StorageConfig;
use Google\Cloud\Dlp\V2\StorageConfig_TimespanConfig;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\Likelihood;
use Google\Cloud\Dlp\V2\InspectConfig\FindingLimits;
use Google\Protobuf\Duration;

/**
 * Create a Data Loss Prevention API job trigger.
 *
 * @param string $callingProjectId     The project ID to run the API call under
 * @param string $bucketName           The name of the bucket to scan
 * @param string $triggerId            (Optional) The name of the trigger to be created
 * @param string $displayName          (Optional) The human-readable name to give the trigger
 * @param string $description          (Optional) A description for the trigger to be created
 * @param int    $scanPeriod           (Optional) How often to wait between scans, in days (minimum = 1 day)
 * @param bool   $autoPopulateTimespan (Optional) Automatically limit scan to new content only
 * @param int    $maxFindings          (Optional) The maximum number of findings to report per request (0 = server maximum)
 */
function create_trigger(
    string $callingProjectId,
    string $bucketName,
    string $triggerId = '',
    string $displayName = '',
    string $description = '',
    int $scanPeriod = 0,
    bool $autoPopulateTimespan = false,
    int $maxFindings = 0
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // ----- Construct job config -----
    // The infoTypes of information to match
    $personNameInfoType = (new InfoType())
        -&gt;setName('PERSON_NAME');
    $phoneNumberInfoType = (new InfoType())
        -&gt;setName('PHONE_NUMBER');
    $infoTypes = [$personNameInfoType, $phoneNumberInfoType];

    // The minimum likelihood required before returning a match
    $minLikelihood = likelihood::LIKELIHOOD_UNSPECIFIED;

    // Specify finding limits
    $limits = (new FindingLimits())
        -&gt;setMaxFindingsPerRequest($maxFindings);

    // Create the inspectConfig object
    $inspectConfig = (new InspectConfig())
        -&gt;setMinLikelihood($minLikelihood)
        -&gt;setLimits($limits)
        -&gt;setInfoTypes($infoTypes);

    // Create triggers
    $duration = (new Duration())
        -&gt;setSeconds($scanPeriod * 60 * 60 * 24);

    $schedule = (new Schedule())
        -&gt;setRecurrencePeriodDuration($duration);

    $triggerObject = (new Trigger())
        -&gt;setSchedule($schedule);

    // Create the storageConfig object
    $fileSet = (new CloudStorageOptions_FileSet())
        -&gt;setUrl('gs://' . $bucketName . '/*');

    $storageOptions = (new CloudStorageOptions())
        -&gt;setFileSet($fileSet);

    // Auto-populate start and end times in order to scan new objects only.
    $timespanConfig = (new StorageConfig_TimespanConfig())
        -&gt;setEnableAutoPopulationOfTimespanConfig($autoPopulateTimespan);

    $storageConfig = (new StorageConfig())
        -&gt;setCloudStorageOptions($storageOptions)
        -&gt;setTimespanConfig($timespanConfig);

    // Construct the jobConfig object
    $jobConfig = (new InspectJobConfig())
        -&gt;setInspectConfig($inspectConfig)
        -&gt;setStorageConfig($storageConfig);

    // ----- Construct trigger object -----
    $jobTriggerObject = (new JobTrigger())
        -&gt;setTriggers([$triggerObject])
        -&gt;setInspectJob($jobConfig)
        -&gt;setStatus(Status::HEALTHY)
        -&gt;setDisplayName($displayName)
        -&gt;setDescription($description);

    // Run trigger creation request
    $parent = "projects/$callingProjectId/locations/global";
    $trigger = $dlp-&gt;createJobTrigger($parent, $jobTriggerObject, [
        'triggerId' =&gt; $triggerId
    ]);

    // Print results
    printf('Successfully created trigger %s' . PHP_EOL, $trigger-&gt;getName());
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-create-triggers-csharp" track-metadata-position="dlp-create-triggers" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-create-triggers" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/TriggersCreate.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/TriggersCreate.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-create-triggers" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-create-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/TriggersCreate.cs" data-region-tag="dlp_create_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/TriggersCreate.cs/HEAD/dlp_create_trigger" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using System;
using System.Collections.Generic;
using static Google.Cloud.Dlp.V2.CloudStorageOptions.Types;
using static Google.Cloud.Dlp.V2.InspectConfig.Types;
using static Google.Cloud.Dlp.V2.JobTrigger.Types;
using static Google.Cloud.Dlp.V2.StorageConfig.Types;

public class TriggersCreate
{
    public static JobTrigger Create(
        string projectId,
        string bucketName,
        Likelihood minLikelihood,
        int maxFindings,
        bool autoPopulateTimespan,
        int scanPeriod,
        IEnumerable&lt;InfoType&gt; infoTypes,
        string triggerId,
        string displayName,
        string description)
    {
        var dlp = DlpServiceClient.Create();

        var jobConfig = new InspectJobConfig
        {
            InspectConfig = new InspectConfig
            {
                MinLikelihood = minLikelihood,
                Limits = new FindingLimits
                {
                    MaxFindingsPerRequest = maxFindings
                },
                InfoTypes = { infoTypes }
            },
            StorageConfig = new StorageConfig
            {
                CloudStorageOptions = new CloudStorageOptions
                {
                    FileSet = new FileSet
                    {
                        Url = $"gs://{bucketName}/*"
                    }
                },
                TimespanConfig = new TimespanConfig
                {
                    EnableAutoPopulationOfTimespanConfig = autoPopulateTimespan
                }
            }
        };

        var jobTrigger = new JobTrigger
        {
            Triggers =
            {
                new Trigger
                {
                    Schedule = new Schedule
                    {
                        RecurrencePeriodDuration = new Google.Protobuf.WellKnownTypes.Duration
                        {
                            Seconds = scanPeriod * 60 * 60 * 24
                        }
                    }
                }
            },
            InspectJob = jobConfig,
            Status = Status.Healthy,
            DisplayName = displayName,
            Description = description
        };

        var response = dlp.CreateJobTrigger(
            new CreateJobTriggerRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
                JobTrigger = jobTrigger,
                TriggerId = triggerId
            });

        Console.WriteLine($"Successfully created trigger {response.Name}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="List all jobs" id="list-all-jobs">List all jobs</h2>
<p>To list all jobs for the current project:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-list-jobs-code-sample">
<section>
<h3 data-text="Console" id="dlp-list-jobs-console" track-metadata-position="dlp-list-jobs" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>Under the <strong>Jobs &amp; job triggers</strong> tab, click the <strong>All jobs</strong> tab.</p></li>
</ol>
<p>The console displays a list of all jobs for the current project, including their
job identifiers, state, creation time, and end time. You can get more
information about any jobâincluding a summary of its resultsâ by
clicking its identifier.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-list-jobs-protocol" track-metadata-position="dlp-list-jobs" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The <code dir="ltr" translate="no">DlpJob</code> resource has a
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list"><code dir="ltr" translate="no">projects.dlpJobs.list</code></a>
method, with which you can list all jobs.</p>
<p>To list all jobs currently defined in your project, send a GET request
to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">dlpJobs</code></a> endpoint, as shown
here:</p>
<p><strong>URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs?key={YOUR_API_KEY}
</code></pre>
<p>The following JSON output lists one of the jobs returned. Note that the
structure of the job mirrors that of the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">DlpJob</code></a> resource.</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "jobs":[
    {
      "name":"projects/[PROJECT-ID]/dlpJobs/i-5270277269264714623",
      "type":"INSPECT_JOB",
      "state":"DONE",
      "inspectDetails":{
        "requestedOptions":{
          "snapshotInspectTemplate":{
          },
          "jobConfig":{
            "storageConfig":{
              "cloudStorageOptions":{
                "fileSet":{
                  "url":"[CLOUD-STORAGE-URL]"
                },
                "fileTypes":[
                  "FILE_TYPE_UNSPECIFIED"
                ],
                "filesLimitPercent":100
              },
              "timespanConfig":{
                "startTime":"2019-09-08T22:43:16.623Z",
                "enableAutoPopulationOfTimespanConfig":true
              }
            },
            "inspectConfig":{
              "infoTypes":[
                {
                  "name":"US_SOCIAL_SECURITY_NUMBER"
                },
                {
                  "name":"CANADA_SOCIAL_INSURANCE_NUMBER"
                }
              ],
              "minLikelihood":"LIKELY",
              "limits":{
              },
              "includeQuote":true
            },
            "actions":[
              {
                "saveFindings":{
                  "outputConfig":{
                    "table":{
                      "projectId":"[PROJECT-ID]",
                      "datasetId":"[DATASET-ID]",
                      "tableId":"[TABLE-ID]"
                    }
                  }
                }
              }
            ]
          }
        },
        "result":{
          ...
        }
      },
      "createTime":"2019-09-09T22:43:16.918Z",
      "startTime":"2019-09-09T22:43:16.918Z",
      "endTime":"2019-09-09T22:43:53.091Z",
      "jobTriggerName":"projects/[PROJECT-ID]/jobTriggers/sample-trigger2"
    },
    ...
</code></pre>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.dlpJobs.list"></div>
</section>
<section>
<h3 data-text="Java" id="dlp-list-jobs-java" track-metadata-position="dlp-list-jobs" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-jobs" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-jobs" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-list-jobs" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsList.java" data-region-tag="dlp_list_jobs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsList.java/HEAD/dlp_list_jobs" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.DlpJob;
import com.google.privacy.dlp.v2.DlpJobType;
import com.google.privacy.dlp.v2.ListDlpJobsRequest;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;

public class JobsList {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    listJobs(projectId);
  }

  // Lists DLP jobs
  public static void listJobs(String projectId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Construct the request to be sent by the client.
      // For more info on filters and job types,
      // see https://cloud.google.com/dlp/docs/reference/rest/v2/projects.dlpJobs/list
      ListDlpJobsRequest listDlpJobsRequest =
          ListDlpJobsRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setFilter("state=DONE")
              .setType(DlpJobType.valueOf("INSPECT_JOB"))
              .build();

      // Send the request to list jobs and process the response
      DlpServiceClient.ListDlpJobsPagedResponse response =
          dlpServiceClient.listDlpJobs(listDlpJobsRequest);

      System.out.println("DLP jobs found:");
      for (DlpJob dlpJob : response.getPage().getValues()) {
        System.out.println(dlpJob.getName() + " -- " + dlpJob.getState());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-list-jobs-nodejs" track-metadata-position="dlp-list-jobs" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-jobs" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listJobs.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listJobs.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-jobs" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-list-jobs" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/listJobs.js" data-region-tag="dlp_list_jobs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/listJobs.js/HEAD/dlp_list_jobs" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The filter expression to use
// For more information and filter syntax, see https://cloud.google.com/dlp/docs/reference/rest/v2/projects.dlpJobs/list
// const filter = `state=DONE`;

// The type of job to list (either 'INSPECT_JOB' or 'RISK_ANALYSIS_JOB')
// const jobType = 'INSPECT_JOB';
async function listJobs() {
  // Construct request for listing DLP scan jobs
  const request = {
    parent: `projects/${projectId}/locations/global`,
    filter: filter,
    type: jobType,
  };

  // Run job-listing request
  const [jobs] = await dlp.listDlpJobs(request);
  jobs.forEach(job =&gt; {
    console.log(`Job ${job.name} status: ${job.state}`);
  });
}

listJobs();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-list-jobs-python" track-metadata-position="dlp-list-jobs" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-jobs" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/jobs.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/jobs.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-jobs" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-list-jobs" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/jobs.py" data-region-tag="dlp_list_jobs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/jobs.py/HEAD/dlp_list_jobs" translate="no"><code dir="ltr" translate="no">def list_dlp_jobs(project, filter_string=None, job_type=None):
    """Uses the Data Loss Prevention API to lists DLP jobs that match the
        specified filter in the request.
    Args:
        project: The project id to use as a parent resource.
        filter: (Optional) Allows filtering.
            Supported syntax:
            * Filter expressions are made up of one or more restrictions.
            * Restrictions can be combined by 'AND' or 'OR' logical operators.
            A sequence of restrictions implicitly uses 'AND'.
            * A restriction has the form of '&lt;field&gt; &lt;operator&gt; &lt;value&gt;'.
            * Supported fields/values for inspect jobs:
                - `state` - PENDING|RUNNING|CANCELED|FINISHED|FAILED
                - `inspected_storage` - DATASTORE|CLOUD_STORAGE|BIGQUERY
                - `trigger_name` - The resource name of the trigger that
                                   created job.
            * Supported fields for risk analysis jobs:
                - `state` - RUNNING|CANCELED|FINISHED|FAILED
            * The operator must be '=' or '!='.
            Examples:
            * inspected_storage = cloud_storage AND state = done
            * inspected_storage = cloud_storage OR inspected_storage = bigquery
            * inspected_storage = cloud_storage AND
                                  (state = done OR state = canceled)
        type: (Optional) The type of job. Defaults to 'INSPECT'.
            Choices:
            DLP_JOB_TYPE_UNSPECIFIED
            INSPECT_JOB: The job inspected content for sensitive data.
            RISK_ANALYSIS_JOB: The job executed a Risk Analysis computation.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Job type dictionary
    job_type_to_int = {
        "DLP_JOB_TYPE_UNSPECIFIED": google.cloud.dlp.DlpJobType.DLP_JOB_TYPE_UNSPECIFIED,
        "INSPECT_JOB": google.cloud.dlp.DlpJobType.INSPECT_JOB,
        "RISK_ANALYSIS_JOB": google.cloud.dlp.DlpJobType.RISK_ANALYSIS_JOB,
    }
    # If job type is specified, convert job type to number through enums.
    if job_type:
        job_type = job_type_to_int[job_type]

    # Call the API to get a list of jobs.
    response = dlp.list_dlp_jobs(
        request={"parent": parent, "filter": filter_string, "type_": job_type}
    )

    # Iterate over results.
    for job in response:
        print("Job: %s; status: %s" % (job.name, job.state.name))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-list-jobs-go" track-metadata-position="dlp-list-jobs" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-jobs" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/jobs/list.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/jobs/list.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-jobs" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-list-jobs" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/jobs/list.go" data-region-tag="dlp_list_jobs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/jobs/list.go/HEAD/dlp_list_jobs" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	"google.golang.org/api/iterator"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// listJobs lists jobs matching the given optional filter and optional jobType.
func listJobs(w io.Writer, projectID, filter, jobType string) error {
	// projectID := "my-project-id"
	// filter := "`state` = FINISHED"
	// jobType := "RISK_ANALYSIS_JOB"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Create a configured request.
	req := &amp;dlppb.ListDlpJobsRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		Filter: filter,
		Type:   dlppb.DlpJobType(dlppb.DlpJobType_value[jobType]),
	}
	// Send the request and iterate over the results.
	it := client.ListDlpJobs(ctx, req)
	for {
		j, err := it.Next()
		if err == iterator.Done {
			break
		}
		if err != nil {
			return fmt.Errorf("Next: %v", err)
		}
		fmt.Fprintf(w, "Job %v status: %v\n", j.GetName(), j.GetState())
	}
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-list-jobs-php" track-metadata-position="dlp-list-jobs" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-jobs" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_jobs.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_jobs.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-jobs" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-list-jobs" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/list_jobs.php" data-region-tag="dlp_list_jobs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/list_jobs.php/HEAD/dlp_list_jobs" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\DlpJob\JobState;
use Google\Cloud\Dlp\V2\DlpJobType;

/**
 * List Data Loss Prevention API jobs corresponding to a given filter.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $filter            The filter expression to use
 */
function list_jobs(string $callingProjectId, string $filter): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // The type of job to list (either 'INSPECT_JOB' or 'REDACT_JOB')
    $jobType = DlpJobType::INSPECT_JOB;

    // Run job-listing request
    // For more information and filter syntax,
    // @see https://cloud.google.com/dlp/docs/reference/rest/v2/projects.dlpJobs/list
    $parent = "projects/$callingProjectId/locations/global";
    $response = $dlp-&gt;listDlpJobs($parent, [
    'filter' =&gt; $filter,
    'type' =&gt; $jobType
    ]);

    // Print job list
    $jobs = $response-&gt;iterateAllElements();
    foreach ($jobs as $job) {
        printf('Job %s status: %s' . PHP_EOL, $job-&gt;getName(), $job-&gt;getState());
        $infoTypeStats = $job-&gt;getInspectDetails()-&gt;getResult()-&gt;getInfoTypeStats();

        if ($job-&gt;getState() == JobState::DONE) {
            if (count($infoTypeStats) &gt; 0) {
                foreach ($infoTypeStats as $infoTypeStat) {
                    printf(
                        '  Found %s instance(s) of type %s' . PHP_EOL,
                        $infoTypeStat-&gt;getCount(),
                        $infoTypeStat-&gt;getInfoType()-&gt;getName()
                    );
                }
            } else {
                print('  No findings.' . PHP_EOL);
            }
        }
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-list-jobs-csharp" track-metadata-position="dlp-list-jobs" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-jobs" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/JobsList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/JobsList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-jobs" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-list-jobs" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/JobsList.cs" data-region-tag="dlp_list_jobs" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/JobsList.cs/HEAD/dlp_list_jobs" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class JobsList
{
    public static PagedEnumerable&lt;ListDlpJobsResponse, DlpJob&gt; ListDlpJobs(string projectId, string filter, DlpJobType jobType)
    {
        var dlp = DlpServiceClient.Create();

        var response = dlp.ListDlpJobs(new ListDlpJobsRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            Filter = filter,
            Type = jobType
        });

        // Uncomment to print jobs
        // foreach (var job in response)
        // {
        //     Console.WriteLine($"Job: {job.Name} status: {job.State}");
        // }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="List all job triggers" id="list-all-triggers">List all job triggers</h2>
<p>To list all job triggers for the current project:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-list-triggers-code-sample">
<section>
<h3 data-text="Console" id="dlp-list-triggers-console" track-metadata-position="dlp-list-triggers" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>Under the <strong>Jobs &amp; job triggers</strong> tab, click the <strong>Job triggers</strong> tab.</p></li>
</ol>
<p>The console displays a list of all job triggers for the current project.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-list-triggers-protocol" track-metadata-position="dlp-list-triggers" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The <code dir="ltr" translate="no">JobTrigger</code> resource has a
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/list"><code dir="ltr" translate="no">projects.jobTriggers.list</code></a>
method, with which you can list all job triggers.</p>
<p>To list all job triggers currently defined in your project, send a GET request
to the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers"><code dir="ltr" translate="no">jobTriggers</code></a>
endpoint, as shown here:</p>
<p><strong>URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/jobTriggers?key={YOUR_API_KEY}
</code></pre>
<p>The following JSON output lists the job trigger we created in the previous
section. Note that the structure of the job trigger mirrors that of the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers"><code dir="ltr" translate="no">JobTrigger</code></a>
resource.</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "jobTriggers":[
    {
      "name":"projects/[PROJECT_ID]/jobTriggers/[JOB_TRIGGER_NAME]",
      "displayName":"JobTrigger1",
      "description":"Starts a DLP scan job of a Datastore kind",
      "inspectJob":{
        "storageConfig":{
          "datastoreOptions":{
            "partitionId":{
              "projectId":"[PROJECT_ID]",
              "namespaceId":"[NAMESPACE_ID]"
            },
            "kind":{
              "name":"Example-Kind"
            }
          }
        },
        "inspectConfig":{
          "infoTypes":[
            {
              "name":"PHONE_NUMBER"
            }
          ],
          "minLikelihood":"LIKELY",
          "limits":{

          },
          "includeQuote":true
        },
        "actions":[
          {
            "saveFindings":{
              "outputConfig":{
                "table":{
                  "projectId":"[PROJECT_ID]",
                  "datasetId":"[BIGQUERY_DATASET_NAME]",
                  "tableId":"[BIGQUERY_TABLE_NAME]"
                }
              }
            }
          }
        ]
      },
      "triggers":[
        {
          "schedule":{
            "recurrencePeriodDuration":"86400s"
          }
        }
      ],
      "createTime":"2018-11-30T01:52:41.171857Z",
      "updateTime":"2018-11-30T01:52:41.171857Z",
      "status":"HEALTHY"
    },

    ...

],
  "nextPageToken":"KkwKCQjivJ2UpPreAgo_Kj1wcm9qZWN0cy92ZWx2ZXR5LXN0dWR5LTE5NjEwMS9qb2JUcmlnZ2Vycy8xNTA5NzEyOTczMDI0MDc1NzY0"
}
</code></pre>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.jobTriggers.list"></div>
</section>
<section>
<h3 data-text="Java" id="dlp-list-triggers-java" track-metadata-position="dlp-list-triggers" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-triggers" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TriggersList.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TriggersList.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-triggers" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-list-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TriggersList.java" data-region-tag="dlp_list_triggers" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TriggersList.java/HEAD/dlp_list_triggers" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.JobTrigger;
import com.google.privacy.dlp.v2.ListJobTriggersRequest;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;

class TriggersList {
  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    listTriggers(projectId);
  }

  public static void listTriggers(String projectId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {
      // Build the request to be sent by the client
      ListJobTriggersRequest listJobTriggersRequest =
          ListJobTriggersRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .build();

      // Use the client to send the API request.
      DlpServiceClient.ListJobTriggersPagedResponse response =
          dlpServiceClient.listJobTriggers(listJobTriggersRequest);

      // Parse the response and process the results
      System.out.println("DLP triggers found:");
      for (JobTrigger trigger : response.getPage().getValues()) {
        System.out.println("Trigger: " + trigger.getName());
        System.out.println("\tCreated: " + trigger.getCreateTime());
        System.out.println("\tUpdated: " + trigger.getUpdateTime());
        if (trigger.getDisplayName() != null) {
          System.out.println("\tDisplay name: " + trigger.getDisplayName());
        }
        if (trigger.getDescription() != null) {
          System.out.println("\tDescription: " + trigger.getDescription());
        }
        System.out.println("\tStatus: " + trigger.getStatus());
        System.out.println("\tError count: " + trigger.getErrorsCount());
      }
      ;
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-list-triggers-nodejs" track-metadata-position="dlp-list-triggers" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-triggers" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listTriggers.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/listTriggers.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-triggers" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-list-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/listTriggers.js" data-region-tag="dlp_list_triggers" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/listTriggers.js/HEAD/dlp_list_triggers" translate="no"><code dir="ltr" translate="no">  // Imports the Google Cloud Data Loss Prevention library
  const DLP = require('@google-cloud/dlp');

  // Instantiates a client
  const dlp = new DLP.DlpServiceClient();

  // The project ID to run the API call under
  // const projectId = 'my-project'

  async function listTriggers() {
    // Construct trigger listing request
    const request = {
      parent: `projects/${projectId}/locations/global`,
    };

    // Helper function to pretty-print dates
    const formatDate = date =&gt; {
      const msSinceEpoch = parseInt(date.seconds, 10) * 1000;
      return new Date(msSinceEpoch).toLocaleString('en-US');
    };

    // Run trigger listing request
    const [triggers] = await dlp.listJobTriggers(request);
    triggers.forEach(trigger =&gt; {
      // Log trigger details
      console.log(`Trigger ${trigger.name}:`);
      console.log(`  Created: ${formatDate(trigger.createTime)}`);
      console.log(`  Updated: ${formatDate(trigger.updateTime)}`);
      if (trigger.displayName) {
        console.log(`  Display Name: ${trigger.displayName}`);
      }
      if (trigger.description) {
        console.log(`  Description: ${trigger.description}`);
      }
      console.log(`  Status: ${trigger.status}`);
      console.log(`  Error count: ${trigger.errors.length}`);
    });
  }

  listTriggers();
}

main(...process.argv.slice(2));
process.on('unhandledRejection', err =&gt; {
  console.error(err.message);
  process.exitCode = 1;
});
</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-list-triggers-python" track-metadata-position="dlp-list-triggers" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-triggers" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/triggers.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/triggers.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-triggers" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-list-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/triggers.py" data-region-tag="dlp_list_triggers" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/triggers.py/HEAD/dlp_list_triggers" translate="no"><code dir="ltr" translate="no">def list_triggers(project):
    """Lists all Data Loss Prevention API triggers.
    Args:
        project: The Google Cloud project id to use as a parent resource.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.list_job_triggers(request={"parent": parent})

    for trigger in response:
        print("Trigger {}:".format(trigger.name))
        print("  Created: {}".format(trigger.create_time))
        print("  Updated: {}".format(trigger.update_time))
        if trigger.display_name:
            print("  Display Name: {}".format(trigger.display_name))
        if trigger.description:
            print("  Description: {}".format(trigger.discription))
        print("  Status: {}".format(trigger.status))
        print("  Error count: {}".format(len(trigger.errors)))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-list-triggers-go" track-metadata-position="dlp-list-triggers" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-triggers" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/trigger/list.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/trigger/list.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-triggers" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-list-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/trigger/list.go" data-region-tag="dlp_list_triggers" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/trigger/list.go/HEAD/dlp_list_triggers" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"time"

	dlp "cloud.google.com/go/dlp/apiv2"
	"github.com/golang/protobuf/ptypes"
	"google.golang.org/api/iterator"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// listTriggers lists the triggers for the given project.
func listTriggers(w io.Writer, projectID string) error {
	// projectID := "my-project-id"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	// Create a configured request.
	req := &amp;dlppb.ListJobTriggersRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
	}
	// Send the request and iterate over the results.
	it := client.ListJobTriggers(ctx, req)
	for {
		t, err := it.Next()
		if err == iterator.Done {
			break
		}
		if err != nil {
			return fmt.Errorf("Next: %v", err)
		}
		fmt.Fprintf(w, "Trigger %v\n", t.GetName())
		c, err := ptypes.Timestamp(t.GetCreateTime())
		if err != nil {
			return fmt.Errorf("CreateTime Timestamp: %v", err)
		}
		fmt.Fprintf(w, "  Created: %v\n", c.Format(time.RFC1123))
		u, err := ptypes.Timestamp(t.GetUpdateTime())
		if err != nil {
			return fmt.Errorf("UpdateTime Timestamp: %v", err)
		}
		fmt.Fprintf(w, "  Updated: %v\n", u.Format(time.RFC1123))
		fmt.Fprintf(w, "  Display Name: %q\n", t.GetDisplayName())
		fmt.Fprintf(w, "  Description: %q\n", t.GetDescription())
		fmt.Fprintf(w, "  Status: %v\n", t.GetStatus())
		fmt.Fprintf(w, "  Error Count: %v\n", len(t.GetErrors()))
	}

	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-list-triggers-php" track-metadata-position="dlp-list-triggers" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-triggers" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_triggers.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/list_triggers.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-triggers" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-list-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/list_triggers.php" data-region-tag="dlp_list_triggers" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/list_triggers.php/HEAD/dlp_list_triggers" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * List Data Loss Prevention API job triggers.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 */
function list_triggers(string $callingProjectId): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;listJobTriggers($parent);

    // Print results
    $triggers = $response-&gt;iterateAllElements();
    foreach ($triggers as $trigger) {
        printf('Trigger %s' . PHP_EOL, $trigger-&gt;getName());
        printf('  Created: %s' . PHP_EOL, $trigger-&gt;getCreateTime()-&gt;getSeconds());
        printf('  Updated: %s' . PHP_EOL, $trigger-&gt;getUpdateTime()-&gt;getSeconds());
        printf('  Display Name: %s' . PHP_EOL, $trigger-&gt;getDisplayName());
        printf('  Description: %s' . PHP_EOL, $trigger-&gt;getDescription());
        printf('  Status: %s' . PHP_EOL, $trigger-&gt;getStatus());
        printf('  Error count: %s' . PHP_EOL, count($trigger-&gt;getErrors()));
        $timespanConfig = $trigger-&gt;getInspectJob()-&gt;getStorageConfig()-&gt;getTimespanConfig();
        printf('  Auto-populates timespan config: %s' . PHP_EOL,
            ($timespanConfig &amp;&amp; $timespanConfig-&gt;getEnableAutoPopulationOfTimespanConfig() ? 'yes' : 'no'));
    }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-list-triggers-csharp" track-metadata-position="dlp-list-triggers" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-list-triggers" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/TriggersList.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/TriggersList.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-list-triggers" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-list-triggers" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/TriggersList.cs" data-region-tag="dlp_list_triggers" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/TriggersList.cs/HEAD/dlp_list_triggers" translate="no"><code dir="ltr" translate="no">
using Google.Api.Gax;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using System;

public class TriggersList
{
    public static PagedEnumerable&lt;ListJobTriggersResponse, JobTrigger&gt; List(string projectId)
    {
        var dlp = DlpServiceClient.Create();

        var response = dlp.ListJobTriggers(
            new ListJobTriggersRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
            });

        foreach (var trigger in response)
        {
            Console.WriteLine($"Name: {trigger.Name}");
            Console.WriteLine($"  Created: {trigger.CreateTime}");
            Console.WriteLine($"  Updated: {trigger.UpdateTime}");
            Console.WriteLine($"  Display Name: {trigger.DisplayName}");
            Console.WriteLine($"  Description: {trigger.Description}");
            Console.WriteLine($"  Status: {trigger.Status}");
            Console.WriteLine($"  Error count: {trigger.Errors.Count}");
        }

        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Delete a job" id="delete-job">Delete a job</h2>
<p>To delete a job from your project, which includes its results, do the following.
Any results saved externally (such as to BigQuery) are untouched by
this operation.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-delete-job-code-sample">
<section>
<h3 data-text="Console" id="dlp-delete-job-console" track-metadata-position="dlp-delete-job" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>Under the <strong>Jobs &amp; job triggers</strong> tab, click the <strong>All jobs</strong> tab. The
 Google Cloud console displays a list of all jobs for the current project.</p></li>
<li><p>In the <strong>Actions</strong> column for the job trigger you want to delete, click the
 <b>more actions</b> menu (displayed as three dots arranged vertically)
 <img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then click <strong>Delete</strong>.
s
 <img alt="" class="screenshot" src="/dlp/docs/images/creating-job-triggers-joblist-actionmenu.png" width="800"/></p></li>
</ol>
<p>Alternatively, from the list of jobs, click the identifier of the job you want
to delete. On the job's detail page, click <strong>Delete</strong>.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-delete-job-protocol" track-metadata-position="dlp-delete-job" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>To delete a job from the current project, send a
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/delete">DELETE</a>
request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">dlpJobs</code></a>
endpoint, as shown here. Replace the <code dir="ltr" translate="no">[JOB-IDENTIFIER]</code> field with the
identifier of the job, which starts with <code dir="ltr" translate="no">i-</code>.</p>
<p><strong>URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">DELETE https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs/[JOB-IDENTIFIER]?key={YOUR_API_KEY}
</code></pre>
<p>If the request was successful, the DLP API will return a
success response. To verify the job was successfully deleted, <a href="#list-all-jobs">list
all jobs</a>.</p>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.dlpJobs.delete"></div>
</section>
<section>
<h3 data-text="Java" id="dlp-delete-job-java" track-metadata-position="dlp-delete-job" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-job" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsDelete.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsDelete.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-job" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-delete-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsDelete.java" data-region-tag="dlp_delete_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsDelete.java/HEAD/dlp_delete_job" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.DeleteDlpJobRequest;
import com.google.privacy.dlp.v2.DlpJobName;
import java.io.IOException;

public class JobsDelete {
  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String jobId = "your-job-id";
    deleteJobs(projectId, jobId);
  }

  // Deletes a DLP Job with the given jobId
  public static void deleteJobs(String projectId, String jobId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Construct the complete job name from the projectId and jobId
      DlpJobName jobName = DlpJobName.of(projectId, jobId);

      // Construct the job deletion request to be sent by the client.
      DeleteDlpJobRequest deleteDlpJobRequest =
          DeleteDlpJobRequest.newBuilder().setName(jobName.toString()).build();

      // Send the job deletion request
      dlpServiceClient.deleteDlpJob(deleteDlpJobRequest);
      System.out.println("Job deleted successfully.");
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-delete-job-nodejs" track-metadata-position="dlp-delete-job" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-job" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteJob.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteJob.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-job" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-delete-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deleteJob.js" data-region-tag="dlp_delete_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deleteJob.js/HEAD/dlp_delete_job" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The name of the job whose results should be deleted
// Parent project ID is automatically extracted from this parameter
// const jobName = 'projects/my-project/dlpJobs/X-#####'

function deleteJob() {
  // Construct job deletion request
  const request = {
    name: jobName,
  };

  // Run job deletion request
  dlp
    .deleteDlpJob(request)
    .then(() =&gt; {
      console.log(`Successfully deleted job ${jobName}.`);
    })
    .catch(err =&gt; {
      console.log(`Error in deleteJob: ${err.message || err}`);
    });
}

deleteJob();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-delete-job-python" track-metadata-position="dlp-delete-job" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-job" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/jobs.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/jobs.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-job" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-delete-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/jobs.py" data-region-tag="dlp_delete_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/jobs.py/HEAD/dlp_delete_job" translate="no"><code dir="ltr" translate="no">def delete_dlp_job(project, job_name):
    """Uses the Data Loss Prevention API to delete a long-running DLP job.
    Args:
        project: The project id to use as a parent resource.
        job_name: The name of the DlpJob resource to be deleted.

    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id and job name into a full resource id.
    name = f"projects/{project}/dlpJobs/{job_name}"

    # Call the API to delete job.
    dlp.delete_dlp_job(request={"name": name})

    print("Successfully deleted %s" % job_name)

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-delete-job-go" track-metadata-position="dlp-delete-job" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-job" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/jobs/delete.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/jobs/delete.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-job" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-delete-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/jobs/delete.go" data-region-tag="dlp_delete_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/jobs/delete.go/HEAD/dlp_delete_job" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deleteJob deletes the job with the given name.
func deleteJob(w io.Writer, jobName string) error {
	// jobName := "job-example"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	req := &amp;dlppb.DeleteDlpJobRequest{
		Name: jobName,
	}
	if err = client.DeleteDlpJob(ctx, req); err != nil {
		return fmt.Errorf("DeleteDlpJob: %v", err)
	}
	fmt.Fprintf(w, "Successfully deleted job")
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-delete-job-php" track-metadata-position="dlp-delete-job" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-job" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_job.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_job.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-job" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-delete-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_job.php" data-region-tag="dlp_delete_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_job.php/HEAD/dlp_delete_job" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * Delete results of a Data Loss Prevention API job
 *
 * @param string $jobId The name of the job whose results should be deleted
 */
function delete_job(string $jobId): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Run job-deletion request
    // The Parent project ID is automatically extracted from this parameter
    $dlp-&gt;deleteDlpJob($jobId);

    // Print status
    printf('Successfully deleted job %s' . PHP_EOL, $jobId);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-delete-job-csharp" track-metadata-position="dlp-delete-job" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-job" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/JobsDelete.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/JobsDelete.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-job" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-delete-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/JobsDelete.cs" data-region-tag="dlp_delete_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/JobsDelete.cs/HEAD/dlp_delete_job" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Cloud.Dlp.V2;

public class JobsDelete
{
    public static void DeleteJob(string jobName)
    {
        var dlp = DlpServiceClient.Create();

        dlp.DeleteDlpJob(new DeleteDlpJobRequest
        {
            Name = jobName
        });

        Console.WriteLine($"Successfully deleted job {jobName}.");
    }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Delete a job trigger" id="delete_a_job_trigger">Delete a job trigger</h2>
<p>To delete an existing job trigger:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-delete-trigger-code-sample">
<section>
<h3 data-text="Console" id="dlp-delete-trigger-console" track-metadata-position="dlp-delete-trigger" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>Under the <strong>Jobs &amp; job triggers</strong> tab, click the <strong>Job triggers</strong> tab. The
 console displays a list of all job triggers for the current project.</p></li>
<li><p>In the <strong>Actions</strong> column for the job trigger you want to delete, click the
 <b>more actions</b> menu (displayed as three dots arranged vertically)
 <img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then click <strong>Delete</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/creating-job-triggers-triggerlist-actionmenu.png" width="800"/></p></li>
</ol>
<p>Alternatively, from the list of job triggers, click the name of the job trigger
you want to delete. On the job trigger's detail page, click <strong>Delete</strong>.</p>
</section>
<section>
<h3 data-text="Protocol" id="dlp-delete-trigger-protocol" track-metadata-position="dlp-delete-trigger" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>To delete a job trigger from the current project, send a
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/delete">DELETE</a>
request to the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers"><code dir="ltr" translate="no">jobTriggers</code></a>
endpoint, as shown here. Replace the <code dir="ltr" translate="no">[JOB-TRIGGER-NAME]</code> field with the name
of the job trigger.</p>
<p><strong>URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">DELETE https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/jobTriggers/[JOB-TRIGGER-NAME]?key={YOUR_API_KEY}
</code></pre>
<p>If the request was successful, the DLP API will return a
success response. To verify the job trigger was successfully deleted, <a href="#list-all-triggers">list
all job triggers</a>.</p>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.jobTriggers.delete"></div>
</section>
<section>
<h3 data-text="Java" id="dlp-delete-trigger-java" track-metadata-position="dlp-delete-trigger" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-trigger" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TriggersDelete.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/TriggersDelete.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-trigger" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-delete-trigger" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TriggersDelete.java" data-region-tag="dlp_delete_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/TriggersDelete.java/HEAD/dlp_delete_trigger" translate="no"><code dir="ltr" translate="no">import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.DeleteJobTriggerRequest;
import com.google.privacy.dlp.v2.ProjectJobTriggerName;
import java.io.IOException;

class TriggersDelete {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String triggerId = "your-trigger-id";
    deleteTrigger(projectId, triggerId);
  }

  public static void deleteTrigger(String projectId, String triggerId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Get the full trigger name from the given triggerId and ProjectId
      ProjectJobTriggerName triggerName = ProjectJobTriggerName.of(projectId, triggerId);

      // Construct the trigger deletion request to be sent by the client
      DeleteJobTriggerRequest deleteJobTriggerRequest =
          DeleteJobTriggerRequest.newBuilder().setName(triggerName.toString()).build();

      // Send the trigger deletion request
      dlpServiceClient.deleteJobTrigger(deleteJobTriggerRequest);
      System.out.println("Trigger deleted: " + triggerName.toString());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-delete-trigger-nodejs" track-metadata-position="dlp-delete-trigger" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-trigger" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteTrigger.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deleteTrigger.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-trigger" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-delete-trigger" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deleteTrigger.js" data-region-tag="dlp_delete_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deleteTrigger.js/HEAD/dlp_delete_trigger" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project'

// The name of the trigger to be deleted
// Parent project ID is automatically extracted from this parameter
// const triggerId = 'projects/my-project/triggers/my-trigger';

async function deleteTrigger() {
  // Construct trigger deletion request
  const request = {
    name: triggerId,
  };

  // Run trigger deletion request
  await dlp.deleteJobTrigger(request);
  console.log(`Successfully deleted trigger ${triggerId}.`);
}

deleteTrigger();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-delete-trigger-python" track-metadata-position="dlp-delete-trigger" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-trigger" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/triggers.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/triggers.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-trigger" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-delete-trigger" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/triggers.py" data-region-tag="dlp_delete_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/triggers.py/HEAD/dlp_delete_trigger" translate="no"><code dir="ltr" translate="no">def delete_trigger(project, trigger_id):
    """Deletes a Data Loss Prevention API trigger.
    Args:
        project: The id of the Google Cloud project which owns the trigger.
        trigger_id: The id of the trigger to delete.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Combine the trigger id with the parent id.
    trigger_resource = "{}/jobTriggers/{}".format(parent, trigger_id)

    # Call the API.
    dlp.delete_job_trigger(request={"name": trigger_resource})

    print("Trigger {} successfully deleted.".format(trigger_resource))




if __name__ == "__main__":
    default_project = os.environ.get("GOOGLE_CLOUD_PROJECT")

    parser = argparse.ArgumentParser(description=__doc__)
    subparsers = parser.add_subparsers(
        dest="action", help="Select which action to perform."
    )
    subparsers.required = True

    parser_create = subparsers.add_parser("create", help="Create a trigger.")
    parser_create.add_argument(
        "bucket", help="The name of the GCS bucket containing the file."
    )
    parser_create.add_argument(
        "scan_period_days",
        type=int,
        help="How often to repeat the scan, in days. The minimum is 1 day.",
    )
    parser_create.add_argument(
        "--trigger_id",
        help="The id of the trigger. If omitted, an id will be randomly " "generated",
    )
    parser_create.add_argument(
        "--display_name", help="The optional display name of the trigger."
    )
    parser_create.add_argument(
        "--description", help="The optional description of the trigger."
    )
    parser_create.add_argument(
        "--project",
        help="The Google Cloud project id to use as a parent resource.",
        default=default_project,
    )
    parser_create.add_argument(
        "--info_types",
        nargs="+",
        help="Strings representing info types to look for. A full list of "
        "info categories and types is available from the API. Examples "
        'include "FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS". '
        "If unspecified, the three above examples will be used.",
        default=["FIRST_NAME", "LAST_NAME", "EMAIL_ADDRESS"],
    )
    parser_create.add_argument(
        "--min_likelihood",
        choices=[
            "LIKELIHOOD_UNSPECIFIED",
            "VERY_UNLIKELY",
            "UNLIKELY",
            "POSSIBLE",
            "LIKELY",
            "VERY_LIKELY",
        ],
        help="A string representing the minimum likelihood threshold that "
        "constitutes a match.",
    )
    parser_create.add_argument(
        "--max_findings",
        type=int,
        help="The maximum number of findings to report; 0 = no maximum.",
    )
    parser_create.add_argument(
        "--auto_populate_timespan",
        type=bool,
        help="Limit scan to new content only.",
    )

    parser_list = subparsers.add_parser("list", help="List all triggers.")
    parser_list.add_argument(
        "--project",
        help="The Google Cloud project id to use as a parent resource.",
        default=default_project,
    )

    parser_delete = subparsers.add_parser("delete", help="Delete a trigger.")
    parser_delete.add_argument("trigger_id", help="The id of the trigger to delete.")
    parser_delete.add_argument(
        "--project",
        help="The Google Cloud project id to use as a parent resource.",
        default=default_project,
    )

    args = parser.parse_args()

    if args.action == "create":
        create_trigger(
            args.project,
            args.bucket,
            args.scan_period_days,
            args.info_types,
            trigger_id=args.trigger_id,
            display_name=args.display_name,
            description=args.description,
            min_likelihood=args.min_likelihood,
            max_findings=args.max_findings,
            auto_populate_timespan=args.auto_populate_timespan,
        )
    elif args.action == "list":
        list_triggers(args.project)
    elif args.action == "delete":
        delete_trigger(args.project, args.trigger_id)
</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-delete-trigger-go" track-metadata-position="dlp-delete-trigger" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-trigger" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/trigger/delete.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/trigger/delete.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-trigger" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-delete-trigger" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/trigger/delete.go" data-region-tag="dlp_delete_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/trigger/delete.go/HEAD/dlp_delete_trigger" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deleteTrigger deletes the given trigger.
func deleteTrigger(w io.Writer, triggerID string) error {
	// projectID := "my-project-id"
	// triggerID := "my-trigger"

	ctx := context.Background()

	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()

	req := &amp;dlppb.DeleteJobTriggerRequest{
		Name: triggerID,
	}

	if err := client.DeleteJobTrigger(ctx, req); err != nil {
		return fmt.Errorf("DeleteJobTrigger: %v", err)
	}
	fmt.Fprintf(w, "Successfully deleted trigger %v", triggerID)
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-delete-trigger-php" track-metadata-position="dlp-delete-trigger" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-trigger" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_trigger.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/delete_trigger.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-trigger" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-delete-trigger" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_trigger.php" data-region-tag="dlp_delete_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/delete_trigger.php/HEAD/dlp_delete_trigger" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\DlpServiceClient;

/**
 * Delete a Data Loss Prevention API job trigger.
 *
 * @param string $callingProjectId  The project ID to run the API call under
 * @param string $triggerId         The name of the trigger to be deleted.
 */
function delete_trigger(string $callingProjectId, string $triggerId): void
{
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Run request
    // The Parent project ID is automatically extracted from this parameter
    $triggerName = "projects/$callingProjectId/locations/global/jobTriggers/$triggerId";
    $response = $dlp-&gt;deleteJobTrigger($triggerName);

    // Print the results
    printf('Successfully deleted trigger %s' . PHP_EOL, $triggerName);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-delete-trigger-csharp" track-metadata-position="dlp-delete-trigger" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-delete-trigger" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/TriggersDelete.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/TriggersDelete.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-delete-trigger" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-delete-trigger" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/TriggersDelete.cs" data-region-tag="dlp_delete_trigger" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/TriggersDelete.cs/HEAD/dlp_delete_trigger" translate="no"><code dir="ltr" translate="no">
using Google.Cloud.Dlp.V2;
using System;

public class TriggersDelete
{

    public static void Delete(string triggerName)
    {
        var dlp = DlpServiceClient.Create();

        dlp.DeleteJobTrigger(
            new DeleteJobTriggerRequest
            {
                Name = triggerName
            });

        Console.WriteLine($"Successfully deleted trigger {triggerName}.");
    }
}
</code></pre>
</div>
</section>
</div>
<h2 data-text="Get a job" id="get-job">Get a job</h2>
<p>To get a job from your project, which includes its results, do the following.
Any results saved externally (such as to BigQuery) are untouched by
this operation.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-get-job-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-get-job-protocol" track-metadata-position="dlp-get-job" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>To get a job from the current project, send a
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/get">GET</a>
request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">dlpJobs</code></a>
endpoint, as shown here. Replace the <code dir="ltr" translate="no">[JOB-IDENTIFIER]</code> field with the
identifier of the job, which starts with <code dir="ltr" translate="no">i-</code>.</p>
<p><strong>URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/dlpJobs/[JOB-IDENTIFIER]?key={YOUR_API_KEY}
</code></pre>
<p>If the request was successful, the DLP API will return a
success response.</p>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.dlpJobs.get"></div>
</section>
<section>
<h3 data-text="Java" id="dlp-get-job-java" track-metadata-position="dlp-get-job" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-get-job" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsGet.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/JobsGet.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-get-job" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-get-job" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsGet.java" data-region-tag="dlp_get_job" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/JobsGet.java/HEAD/dlp_get_job" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.DlpJobName;
import com.google.privacy.dlp.v2.GetDlpJobRequest;
import java.io.IOException;

public class JobsGet {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String jobId = "your-job-id";
    getJobs(projectId, jobId);
  }

  // Gets a DLP Job with the given jobId
  public static void getJobs(String projectId, String jobId) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlpServiceClient = DlpServiceClient.create()) {

      // Construct the complete job name from the projectId and jobId
      DlpJobName jobName = DlpJobName.of(projectId, jobId);

      // Construct the get job request to be sent by the client.
      GetDlpJobRequest getDlpJobRequest =
          GetDlpJobRequest.newBuilder().setName(jobName.toString()).build();

      // Send the get job request
      dlpServiceClient.getDlpJob(getDlpJobRequest);
      System.out.println("Job got successfully.");
    }
  }
}</code></pre>
</div>
</section>
</div>
<h2 data-text="Update an existing job trigger" id="update_an_existing_job_trigger">Update an existing job trigger</h2>
<p>In addition to creating, listing, and deleting job triggers, you can also
update an existing job trigger. To change the configuration for an existing job
trigger:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-patch-trigger-code-sample">
<section>
<h3 data-text="Console" id="dlp-patch-trigger-console" track-metadata-position="dlp-patch-trigger" track-name="console" track-type="sampleTabNav">Console</h3>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP
 UI</a> </p></li>
<li><p>Click the <strong>Job triggers</strong> tab. The console displays a list of all job
 triggers for the current project.</p></li>
<li><p>In the <strong>Actions</strong> column for the job trigger you want to delete, click
 <b>More</b> <i aria-hidden="true" class="material-icons" translate="no">more_vert</i>,
 then click <strong>View details</strong>.</p>
<p><img alt="" class="screenshot" src="/dlp/docs/images/creating-job-triggers-triggerlist-actionmenu.png" width="800"/></p></li>
<li><p>On the job trigger detail page, click <strong>Edit</strong>.</p></li>
<li><p>On the Edit trigger page, you can change the location of the input data;
 detection details such as templates, infoTypes, or likelihood; any
 post-scan actions, and the job trigger's schedule. When you're done making
 changes, click <strong>Save</strong>.</p></li>
</ol>
</section>
<section>
<h3 data-text="Protocol" id="dlp-patch-trigger-protocol" track-metadata-position="dlp-patch-trigger" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>Use the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/patch"><code dir="ltr" translate="no">projects.jobTriggers.patch</code></a>
method to send new <code dir="ltr" translate="no">JobTrigger</code> values to the DLP API
to update those values within a specified job trigger.</p>
<aside class="note"><strong>Note:</strong><span> Patching a job trigger with a specific value replaces the value that was
there before. It does not append the value. For instance, consider a job
trigger that scans using the <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> infoType detector. If
you patch the job trigger and specify the
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code> infoType detector, the patched
job trigger will only contain the <code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code>
detector. To keep the original infoType detector in the job trigger, specify
both in the patch request.</span></aside>
<p>For example, consider the following simple job trigger. This JSON represents
the job trigger, and was returned after sending a GET request to the current
project's job trigger endpoint.</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT_ID]/jobTriggers/[JOB_TRIGGER_NAME]",
  "inspectJob":{
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://dlptesting/*"
        },
        "fileTypes":[
          "FILE_TYPE_UNSPECIFIED"
        ],
        "filesLimitPercent":100
      },
      "timespanConfig":{
        "enableAutoPopulationOfTimespanConfig":true
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"US_SOCIAL_SECURITY_NUMBER"
        }
      ],
      "minLikelihood":"POSSIBLE",
      "limits":{

      }
    },
    "actions":[
      {
        "jobNotificationEmails":{

        }
      }
    ]
  },
  "triggers":[
    {
      "schedule":{
        "recurrencePeriodDuration":"86400s"
      }
    }
  ],
  "createTime":"2019-03-06T21:19:45.774841Z",
  "updateTime":"2019-03-06T21:19:45.774841Z",
  "status":"HEALTHY"
}
</code></pre>
<p>The following JSON, when sent with a PATCH request to the specified endpoint,
updates the given job trigger with a new infoType to scan for, as well as a new
minimum likelihood. Note that you must also specify the <code dir="ltr" translate="no">updateMask</code> attribute,
and that its value is in
<a href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#google.protobuf.FieldMask"><code dir="ltr" translate="no">FieldMask</code></a>
format.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">PATCH https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/jobTriggers/[JOB_TRIGGER_NAME]?key={YOUR_API_KEY}

{
  "jobTrigger":{
    "inspectJob":{
      "inspectConfig":{
        "infoTypes":[
          {
            "name":"US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER"
          }
        ],
        "minLikelihood":"LIKELY"
      }
    }
  },
  "updateMask":"inspectJob(inspectConfig(infoTypes,minLikelihood))"
}
</code></pre>
<p>After you send this JSON to the specified URL, it returns the following, which
represents the updated job trigger. Note that the original infoType and
likelihood values have been replaced by the new values.</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT_ID]/jobTriggers/[JOB_TRIGGER_NAME]",
  "inspectJob":{
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://dlptesting/*"
        },
        "fileTypes":[
          "FILE_TYPE_UNSPECIFIED"
        ],
        "filesLimitPercent":100
      },
      "timespanConfig":{
        "enableAutoPopulationOfTimespanConfig":true
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER"
        }
      ],
      "minLikelihood":"LIKELY",
      "limits":{

      }
    },
    "actions":[
      {
        "jobNotificationEmails":{

        }
      }
    ]
  },
  "triggers":[
    {
      "schedule":{
        "recurrencePeriodDuration":"86400s"
      }
    }
  ],
  "createTime":"2019-03-06T21:19:45.774841Z",
  "updateTime":"2019-03-06T21:27:01.650183Z",
  "lastRunTime":"1970-01-01T00:00:00Z",
  "status":"HEALTHY"
}
</code></pre>
<p>To quickly try this out, you can use the API Explorer that's embedded below.
For general information about using JSON to send requests to the
DLP API, see the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="projects.jobTriggers.patch"></div>
</section>
</div>
<h2 data-text="Use a job trigger" id="use_a_job_trigger">Use a job trigger</h2>
<p>This section describes how to use job triggers to only scan new content, and
how to trigger jobs every time a file is uploaded to Cloud Storage using
Cloud Functions.</p>
<h3 data-text="Limit scans to only new content" id="limit_scans_to_only_new_content">Limit scans to only new content</h3>
<p>You can also set an option to automatically set the timespan date for files
stored in either <a href="/storage">Cloud Storage</a> or
<a href="/bigquery">BigQuery</a>. Once you've set the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#timespanconfig"><code dir="ltr" translate="no">TimespanConfig</code></a>
object to auto-populate, Cloud DLP will only scan data that
has been added or modified since the last trigger ran:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
  timespan_config {
        enable_auto_population_of_timespan_config: true
      }
...
</code></pre>
<h3 data-text="Trigger jobs at file upload" id="trigger_jobs_at_file_upload">Trigger jobs at file upload</h3>
<p>In addition to the support for job triggers that is built into
Cloud DLP, the Google Cloud also has a variety of other
components that can be used to integrate or trigger DLP
jobs. For example, you can use <a href="/functions">Cloud Functions</a> to
trigger a DLP scan every time a file is uploaded to
Cloud Storage.</p>
<p>For step-by-step instructions about how to do this, see <a href="/solutions/automating-classification-of-data-uploaded-to-cloud-storage">Automating the
classification of data uploaded to
Cloud Storage</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/sending-results-to-dc]</H1></p><div class="devsite-article-body clearfix">
<p>This guide walks you through using Cloud Data Loss Prevention to scan specific
Google Cloud resources and send results to Data Catalog.</p>
<p><a href="/data-catalog">Data Catalog</a> is a scalable metadata management
service that empowers you to quickly discover, manage, and understand all your
data in Google Cloud.</p>
<p>Cloud DLP integrates natively with Data Catalog.
When you use a Cloud DLP <a href="/dlp/docs/concepts-actions">action</a> to
scan your BigQuery tables for sensitive data, it can send results
directly to Data Catalog in the form of a tag template.</p>
<p>By completing the steps in this guide, you'll do the following:</p>
<ul>
<li>Enable Data Catalog and Cloud DLP.</li>
<li>Set up Cloud DLP to scan a BigQuery table.</li>
<li>Configure a Cloud DLP scan to send scan results to
Data Catalog.</li>
</ul>
<p>For more information about Data Catalog, see the
<a href="/data-catalog/docs">Data Catalog documentation</a>.</p>
<h2 data-text="Costs" id="costs">Costs</h2>
<p>
  

  This tutorial uses the following billable components of Google Cloud:
  
    </p>
<ul>
<li>Cloud DLP</li>
<li>BigQuery</li>
</ul>
<p>
  

  
  To generate a cost estimate based on your projected usage,
      use the <a href="/products/calculator" track-name="pricingCalculator" track-type="commonIncludes">pricing calculator</a>.
  <cloudx-free-trial-eligible-content>
<slot slot="eligible">
      New Google Cloud users might be eligible for a <a href="/free-trial" target="_blank" track-metadata-end-goal="signUp" track-metadata-position="prerequisites" track-name="consoleLink" track-type="freeTrial">free trial</a>.
    </slot>
<slot slot="ineligible">
</slot>
</cloudx-free-trial-eligible-content>
</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Before you can send Cloud DLP scan results to
Data Catalog, do the following:</p>
<ul>
<li>Step 1: Set up billing.</li>
<li>Step 2: Create a new project and populate a new BigQuery
table. (Optional.)</li>
<li>Step 3: Enable Data Catalog.</li>
<li>Step 4: Enable Cloud DLP.</li>
</ul>
<p>The following subsections cover each step in detail.</p>
<h3 data-text="Step 1: Set up billing" id="step_1_set_up_billing">Step 1: Set up billing</h3>
<p>You must first set up a billing account if you don't already have one.
     <p><a class="button button-primary" href="/billing/docs/how-to/modify-project" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">Learn how to enable billing</a></p></p>
<h3 data-text="Step 2: Create a new project and populate a new BigQuery table (Optional)" id="step2">Step 2: Create a new project and populate a new BigQuery table (Optional)</h3>
<p>If you are setting up this feature for production work or already have a
BigQuery table that you want to scan, open the
Google Cloud project that contains the table and skip to Step 3.</p>
<p>If you are trying out this feature and want to scan a "dummy" or test set of
data, create a new project. To complete this step, you must have the
IAM <strong>Project Creator</strong> role. Learn more about
<a href="/iam/docs/understanding-roles">IAM roles</a>.</p>
<ol>
<li>Go to the <a href="https://console.cloud.google.com/projectcreate">New Project</a> page in the
 Google Cloud console.
 <p>
<a class="button button-primary" href="https://console.cloud.google.com/projectcreate" target="console" track-name="consoleLink" track-type="quickstart">New Project</a></p></li>
<li>On the <strong>Billing account</strong> drop-down list, select the billing account that
 the project should be billed to.</li>
<li>On the <strong>Organization</strong> drop-down list, select the organization that you
 want to create the project in.</li>
<li>On the <strong>Location</strong> drop-down list, select the organization or folder that
 you want to create the project in.</li>
<li>Click <strong>Create</strong> to create the project.</li>
</ol>
<p>Next, download and store the sample data:</p>
<ol>
<li>Go to the <a class="external" href="https://github.com/GoogleCloudPlatform/dlp-cloud-functions-tutorials/tree/master/sample_data">Cloud Functions tutorials repository on GitHub</a>.</li>
<li>Select one of the CSV files that has example data, and then download the
 file.</li>
<li>Next, go to <a href="https://console.cloud.google.com/bigquery/">BigQuery</a> in the
 Cloud console.</li>
<li>Select your project.</li>
<li>Click <strong>Create Dataset</strong>.</li>
<li>Click <strong>Create Table</strong>.</li>
<li>Click <strong>Upload</strong>, and then select the file you want to upload.</li>
<li>Give the table a name, and then click <strong>Create Table</strong>.</li>
</ol>
<h3 data-text="Step 3: Enable Data Catalog" id="dc">Step 3: Enable Data Catalog</h3>
<p>Next, enable Data Catalog for the project that contains the
BigQuery table you want to scan using Cloud DLP.</p>
<p>To enable Data Catalog using the Cloud console:</p>
<ol>
<li><a href="https://console.cloud.google.com/flows/enableapi?apiid=datacatalog.googleapis.com">Register your application for Data Catalog</a>.
 <p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=datacatalog.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Register your application for
      Data Catalog</a></p></li>
<li>On the registration page, from the <strong>Create a project</strong> drop-down list,
 select the project you want to use with Data Catalog.</li>
<li>After you've selected the project, click <strong>Continue</strong>.</li>
</ol>
<p>Data Catalog is now enabled for your project.</p>
<h3 data-text="Step 4: Enable Cloud DLP" id="dlp">Step 4: Enable Cloud DLP</h3>
<p>Enable Cloud DLP for the same project you enabled
Data Catalog for.</p>
<p>To enable Cloud DLP using the Cloud console:</p>
<ol>
<li><a href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com">Register your application for Cloud DLP</a>.
 <p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Register your application for
      Cloud DLP</a></p></li>
<li>On the registration page, from the <strong>Create a project</strong> drop-down list,
 select the same project you chose in the previous step.</li>
<li>After you've selected the project, click <strong>Continue</strong>.</li>
</ol>
<p>Cloud DLP is now enabled for your project.</p>
<h2 data-text="Configure and run a Cloud DLP inspection scan" id="run-dlp-scan">Configure and run a Cloud DLP inspection scan</h2>
<p>You can configure and run a Cloud DLP inspection scan using either
the Cloud console or the DLP API.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console"> Cloud console </h3><p>To set up a scan job of a BigQuery table using
Cloud DLP:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>From the <strong>Create</strong> menu, choose <strong>Job or job trigger</strong>.</p>
<p><img alt="Screenshot of Create new job or job trigger menu choice." class="screenshot" src="/dlp/docs/images/inspecting-storage-create-new.png" width="800"/></p></li>
<li><p>Enter the Cloud DLP job information and click <strong>Continue</strong>
 to complete each step:</p>
<ul>
<li><p>For <strong>Step 1: Choose input data</strong>, name the job by entering a value
in the <strong>Name</strong> field. In <strong>Location</strong>, choose
<strong>BigQuery</strong> from the <strong>Storage type</strong> menu, and then
enter the information for the table to scan. The <strong>Sampling</strong> section
is pre-configured to run a sample scan against your data. You can
adjust the <strong>Limit rows by</strong> and <strong>Maximum number of rows</strong> fields to
save resources if you have a large amount of data. For more details,
see <a href="/dlp/docs/creating-job-triggers#choose-input-data">Choose input data</a>.</p></li>
<li><p>(Optional) In <strong>Step 2: Configure detection</strong>, you configure what
types of data to look for, called "<a href="/dlp/docs/concepts-infotypes">infoTypes</a>."
For the purposes of this walkthrough, keep the default infoTypes
selected. For more details, see <a href="/dlp/docs/creating-job-triggers#configure-detection">Configure
detection</a>.</p></li>
<li><p>For <strong>Step 3: Add actions</strong>, enable <strong>Save to
Data Catalog</strong>.</p></li>
<li><p>(Optional) For <strong>Step 4: Schedule</strong>, for the purposes of this
walkthrough, leave the menu set to <strong>None</strong> so that the scan runs
just once. To learn more about scheduling repeating scans, see
<a href="/dlp/docs/creating-job-triggers#schedule-job">Schedule</a>.</p></li>
</ul></li>
<li><p>Click <strong>Create</strong>. The job runs immediately.</p></li>
</ol></section>
<section><h3 data-text="DLP API" id="dlp-api">DLP API</h3><p>In this section, you configure and run a Cloud DLP scan job.</p>
<aside class="note"><strong>Note:</strong><span> These instructions use <a href="https://developers.google.com/apis-explorer">APIs
Explorer</a> to send requests that
contain JSON to Cloud DLP. This is for learning, demonstration,
and experimentation purposes only, and you should never use APIs Explorer for
production work. You can use <code dir="ltr" translate="no">gcloud</code>, <code dir="ltr" translate="no">curl</code>, or <code dir="ltr" translate="no">httplib2</code> to send these
requests instead. You can also use one of the available Cloud DLP
<a href="/dlp/docs/libraries">client libraries</a> to access the API using Java, Python,
Go, and more.</span></aside>
<p>The <em>inspection job</em> that you configure here instructs Cloud DLP
to scan either the sample BigQuery data described in <a href="#step2">Step
2</a> above or your own BigQuery data. The job
configuration that you specify is also where you instruct
Cloud DLP to save its scan results to
Data Catalog.</p>
<p><strong>Step 1: Note your project identifier</strong></p>
<ol>
<li><p>Go to the <a href="https://console.cloud.google.com/projectselector2/home/dashboard/">Cloud console</a>.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard/" target="console" track-name="consoleLink" track-type="tutorial">Go to the Cloud console</a> </p></li>
<li><p>Click <strong>Select</strong>.</p></li>
<li><p>On the <strong>Select from</strong> drop-down list, select the organization for which
you enabled Data Catalog.</p></li>
<li><p>Under <strong>ID</strong>, copy the project ID for the project that contains the data
you want to scan. This is the project described in the
<a href="#gcp-storage-repos">set storage repositories</a> step earlier on this page.</p></li>
<li><p>Under <strong>Name</strong>, click the project to select it.</p></li>
</ol>
<p><strong>Step 2: Open APIs Explorer and configure the job</strong></p>
<ol>
<li><p>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.create</code>
method. To keep these instructions available, right-click the following
link and open it in a new tab or window:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create?apix=true">Open APIs Explorer</a> </p></li>
<li><p>In the <strong>parent</strong> box, enter the following, where <var translate="no">project-id</var>
is the project ID you noted earlier in the previous step:
<pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">project-id</var></pre></p>
<p>Next, copy the following JSON. Select the contents of the <strong>Request
body</strong> field in APIs Explorer, and then paste the JSON to replace the
contents. Be sure to replace the <code dir="ltr" translate="no"><var translate="no">project-id</var></code>,
<code dir="ltr" translate="no"><var translate="no">bigquery-dataset-name</var></code>, and
<code dir="ltr" translate="no"><var translate="no">bigquery-table-name</var></code> placeholders with the actual
project ID and BigQuery dataset and table names,
repectively.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectJob":
  {
    "storageConfig":
    {
      "bigQueryOptions":
      {
        "tableReference":
        {
          "projectId": "<var translate="no">project-id</var>",
          "datasetId": "<var translate="no">bigquery-dataset-name</var>",
          "tableId": "<var translate="no">bigquery-table-name</var>"
        }
      }
    },
    "inspectConfig":
    {
      "infoTypes":
      [
        {
          "name": "EMAIL_ADDRESS"
        },
        {
          "name": "PERSON_NAME"
        },
        {
          "name": "US_SOCIAL_SECURITY_NUMBER"
        },
        {
          "name": "PHONE_NUMBER"
        }
      ],
      "includeQuote": true,
      "minLikelihood": "UNLIKELY",
      "limits":
      {
        "maxFindingsPerRequest": 100
      }
    },
    "actions":
    [
      {
        "publishFindingsToCloudDataCatalog": {}
      }
    ]
  }
}
</code></pre></li>
</ol>
<p>To learn more about the available scan options, see <a href="/dlp/docs/inspecting-storage">Inspecting storage and
databases for sensitive data</a>. For a full list
of information types that Cloud DLP can scan for and detect, see
<a href="/dlp/docs/infotypes-reference">InfoTypes reference</a>.</p>
<p><strong>Step 3: Execute the request to start the scan job</strong></p>
<p>After you configure the job by following the preceding steps, click
<strong>Execute</strong> to send the request. If the request is successful, a response
appears with a success code and a JSON object that indicates the status of the
Cloud DLP job you just created.</p>
<aside class="special"><strong>Important:</strong><span> Keep the page open or copy the response JSON so that you have it
for the remainder of the tasks in this topic.</span></aside>
<p>The response to your scan request includes the job ID of your inspection scan
job as the <code dir="ltr" translate="no">"name"</code> key, and the current state of the inspection scan job as
the <code dir="ltr" translate="no">"state"</code> key. Because you just submitted the request, the job's state at
that moment is <code dir="ltr" translate="no">"PENDING"</code>.</p></section>
</div>
<h2 data-text="Check the status of the Cloud DLP inspection scan" id="check-status">Check the status of the Cloud DLP inspection scan</h2>
<p>After you submit the scan request, the scan of your content begins immediately.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_1"> Cloud console </h3><p>To check the status of the inspection scan job:</p>
<ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>Click the <strong>Jobs &amp; job triggers</strong> tab, and then click <strong>All jobs</strong>.</p></li>
</ol>
<p>The job you just ran will likely be at the top of the list. Check the <strong>State</strong>
column to be sure its status is <strong>Done</strong>.</p>
<p>You can click on the <strong>Job ID</strong> of the job to see its results. Each infoType
detector listed on the Job details page is followed by the number of
matches that were found in the content.</p></section>
<section><h3 data-text="DLP API" id="dlp-api_1">DLP API</h3><p>To check the status of the inspection scan job:</p>
<ol>
<li><p>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.get</code> method
by clicking the following button:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get?apix=true">Open APIs Explorer</a> </p></li>
<li><p>In the <strong>name</strong> box, type the name of the job from the JSON response to
the scan request in the following form:
<pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">project-id</var>/dlpJobs/<var translate="no">job-id</var></pre>
The job ID is in the form of <code dir="ltr" translate="no">i-1234567890123456789</code>.</p></li>
<li><p>To submit the request, click <strong>Execute</strong>.</p></li>
</ol>
<p>If the response JSON object's <code dir="ltr" translate="no">"state"</code> key indicates that the job is <code dir="ltr" translate="no">"DONE"</code>,
then the scan job has finished.</p>
<aside class="note"><strong>Note:</strong><span> You can instruct Cloud DLP to send you a notification when a
job is done, but that's beyond the scope of this topic. To learn more, see the
<a href="/dlp/docs/concepts-actions">Actions</a> conceptual page.</span></aside>
<p>To view the rest of the response JSON, scroll down the page. Under <code dir="ltr" translate="no">"result"</code> &gt;
<code dir="ltr" translate="no">"infoTypeStats"</code>, each information type listed should have a corresponding
<code dir="ltr" translate="no">"count"</code>. If not, make sure that you entered the JSON accurately, and that the
path or location to your data is correct.</p>
<p>After the scan job is done, you can continue to the next section of this guide
to view scan results in Security Command Center.</p></section>
</div>
<h2 data-text="View Cloud DLP scan results in Data Catalog" id="view_dlp_results_in_dc">View Cloud DLP scan results in Data Catalog</h2>
<p>Because you instructed Cloud DLP to send its inspection scan job
results to Data Catalog, you can now view the automatically
created tags and tag template in the Data Catalog UI:</p>
<ol>
<li>Go to the Data Catalog page in the Cloud console.<p>
<a class="button button-primary" href="https://console.cloud.google.com/datacatalog/" name="consoleLink" target="console" track-="" track-type="tutorial">Go to Data Catalog</a></p></li>
<li>Search for the table that you inspected.</li>
<li>Click on the results that match your table to view the table's metadata.</li>
</ol>
<p>The following screen shot shows the Data Catalog metadata view of an
example table:</p>
<p><figure style="text-align: center">
<img alt="DLP detail in Data Catalog." class="screenshot" src="/dlp/docs/images/sending-results-to-dc-findings.png">.
  </img></figure></p>
<h3 data-text="Cloud DLP Data Discovery" id="cloud-dlp-data-discover">Cloud DLP Data Discovery</h3>
<p>Findings from Cloud DLP are included in summary form for the
table that you scanned. This summary includes total infoType counts, as well
as summary data about the inspection job that includes dates and job resource
ID.</p>
<p>Any <code dir="ltr" translate="no">infoTypes</code> that were inspected for are listed. Those with findings show a
count greater than zero.</p>
<h2 data-text="Cleaning up" id="cleaning_up">Cleaning up</h2>
<p>To avoid incurring charges to your Google Cloud account for the resources
used in this topic, do one of the following, depending on whether you used
sample data or your own data:</p>
<ul>
<li>Sample data: <a href="#delete-project">Delete the project you created.</a></li>
<li>Your own data: <a href="#delete-job">Delete the Cloud DLP job you
created.</a></li>
</ul>
<h3 data-text="Deleting the project" id="delete-project">Deleting the project</h3>
<p>The easiest way to eliminate billing is to delete the project you created
while following the instructions provided in this topic.</p>
<p>To delete the project:</p>
<p><ol></ol></p>
<aside class="warning">
<strong>Warning:</strong> Deleting a project has the following
  consequences:
  <ul>
<li>
      If you used an existing project, you'll also delete
      any other work you've done in the project.
    </li>
<li>
      You can't reuse the project ID of a deleted project.
      If you created a custom project ID that you plan to use in
      the future, delete the resources inside the project instead.
      This step ensures that URLs that use the project IDâfor example,
      <code dir="ltr" translate="no"><var translate="no">project-id</var>.<var translate="no">region-id</var>.r.appspot.com</code>â
      remain available.
    </li>
</ul>
<p>
    If you are exploring multiple how-to, tutorial, and quickstart topics,
    reusing projects instead of deleting them may prevent you from exceeding
    project quota limits.
  </p>
</aside>
<p><li>
  In the Cloud console, go to the Projects page.
  <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to the Projects page</a></p>
</li></p>
<p><li>
  In the project list, select the project you
  want to delete and click <strong>Delete project</strong>.
  <img alt="After selecting the checkbox next to the project name, click
    Delete project" class="screenshot" src="/docs/images/delete-project-screenshot.png"/>
</li>
<li>
  In the dialog, type the project ID, and then click
  <strong>Shut down</strong> to delete the project.
</li>
</p>
<p>When you delete your project using this method, the Cloud DLP job
and Cloud Storage bucket you created are also deleted, and you're done.
It's not necessary to follow the instructions in the following sections.</p>
<h3 data-text="Deleting the Cloud DLP job or job trigger" id="delete-job">Deleting the Cloud DLP job or job trigger</h3>
<p>If you scanned your own data, delete the inspect scan job or job trigger you
just created.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_2"> Cloud console </h3><ol>
<li><p>In the Cloud console, open Cloud DLP.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dlp;source=7" target="console">Go to Cloud DLP</a> </p></li>
<li><p>Click the <strong>Jobs &amp; job triggers</strong> tab, and then click the <strong>Job
triggers</strong> tab.</p></li>
<li><p>In the <strong>Actions</strong> column for the job trigger you want to delete, click
the <b>more actions</b> menu (displayed as three dots arranged vertically)
<img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then click <strong>Delete</strong>.</p></li>
</ol>
<p>Optionally, you can also delete the job details for the job that you ran.
Click the <strong>All jobs</strong> tab, and then in the <strong>Actions</strong> column for the job you
want to delete, click the <b>more actions</b> menu (displayed as three dots arranged vertically)
<img src="/images/overflow_menu_icon.png" style="vertical-align: top;"/>, and then <strong>Delete</strong>.</p></section>
<section><h3 data-text="DLP API" id="dlp-api_2">DLP API</h3><ol>
<li><p>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.delete</code> method
by clicking the following button:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/delete?apix=true">Open APIs Explorer</a> </p></li>
<li><p>In the <strong>name</strong> box, type the name of the job from the JSON response to
the scan request, which has the following form:
<pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">project-id</var>/dlpJobs/<var translate="no">job-id</var></pre>
The job ID is in the form of <code dir="ltr" translate="no">i-1234567890123456789</code>.</p></li>
</ol>
<p>If you created additional scan jobs or if you want to make sure you've deleted
the job successfully, you can list all of the existing jobs:</p>
<ol>
<li><p>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.list</code> method
by clicking the following button:</p>
<p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list?apix=true">Open APIs Explorer</a> </p></li>
<li><p>In the <strong>parent</strong> box, type the project identifier in the following form,
where <var translate="no">project-id</var> is your project identifier:
<pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">project-id</var></pre></p></li>
<li><p>Click <strong>Execute</strong>.</p></li>
</ol>
<p>If there are no jobs listed in the response, you've deleted all of the jobs.
If jobs are listed in the response, repeat the deletion procedure above for
those jobs.</p></section>
</div>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about the <a href="/dlp/docs/reference/rpc/google.privacy.dlp.v2#google.privacy.dlp.v2.Action.PublishFindingsToCloudDataCatalog"><code dir="ltr" translate="no">publishFindingsToCloudDataCatalog</code>
action</a>
in Cloud DLP.</li>
<li>Learn more about <a class="external" href="/community/tutorials/dlp-to-datacatalog-tags">creating custom tags or column-level tags in
Data Catalog based on Cloud DLP results</a>.</li>
<li>Learn more about <a href="/dlp/docs/inspecting-storage">scanning storage repositories for sensitive
data</a> using Cloud DLP.</li>
<li>Learn how to use <a href="/data-catalog/docs">Data Catalog</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/sending-results-to-scc]</H1></p><div class="devsite-article-body clearfix">
<p>This guide walks you through using Cloud Data Loss Prevention to scan specific
Google Cloud resources and send data to Security Command Center.</p>
<p>Security Command Center enables you to gather data about, identify, and act on
security threats before they can cause business damage or loss. With
Security Command Center, you can perform several security-related actions from a
single centralized dashboard.</p>
<p>Cloud DLP integrates natively with Security Command Center. When you use
a Cloud DLP <a href="/dlp/docs/concepts-actions">action</a> to scan your
Google Cloud storage repositories for sensitive data, it can send results
directly to the Security Command Center dashboard. They display next to other
security metrics.</p>
<p>The following video shows you how to set up Cloud DLP to send scan
results to Security Command Center. The setup steps are also described in more detail
later in this guide.</p>
<div class="video-wrapper-full-width">
<iframe allowfullscreen="" class="devsite-embedded-youtube-video" data-autohide="1" data-showinfo="0" data-video-id="k7ZEfAocMq4" frameborder="0">
</iframe>
</div>
<p>By completing the steps in this guide, you do the following:</p>
<ul>
<li>Enable Security Command Center and Cloud DLP.</li>
<li>Set up Cloud DLP to scan a Google Cloud storage
repositoryâeither a Cloud Storage bucket, BigQuery table, or
Datastore kind.</li>
<li>Configure a Cloud DLP scan to send scan results to
Security Command Center.</li>
</ul>
<p>For more information about Security Command Center, see the
<a href="/security-command-center/docs">Security Command Center documentation</a>.</p>
<h2 data-text="Costs" id="costs">Costs</h2>
<p>
  

  This tutorial uses the following billable components of Google Cloud:
  
    </p>
<ul>
<li>Cloud DLP</li>
<li>Cloud Storage</li>
<li>BigQuery</li>
<li>Datastore</li>
</ul>
<p>
  

  
  To generate a cost estimate based on your projected usage,
      use the <a href="/products/calculator" track-name="pricingCalculator" track-type="commonIncludes">pricing calculator</a>.
  <cloudx-free-trial-eligible-content>
<slot slot="eligible">
      New Google Cloud users might be eligible for a <a href="/free-trial" target="_blank" track-metadata-end-goal="signUp" track-metadata-position="prerequisites" track-name="consoleLink" track-type="freeTrial">free trial</a>.
    </slot>
<slot slot="ineligible">
</slot>
</cloudx-free-trial-eligible-content>
</p>
<h2 data-text="Before you begin" id="before_you_begin">Before you begin</h2>
<p>Before you can send Cloud DLP scan results to Security Command Center,
you must do each of the following:</p>
<ul>
<li>Step 1: Set Google Cloud storage repositories.</li>
<li>Step 2: Set Identity and Access Management (IAM) roles.</li>
<li>Step 3: Enable Security Command Center.</li>
<li>Step 4: Enable Cloud DLP.</li>
<li>Step 5: Enable Cloud DLP as a security source for
Security Command Center.</li>
</ul>
<p>The steps to set up these components are described in the following sections.</p>
<h3 data-text="Step 1: Set Google Cloud storage repositories" id="gcp-storage-repos">Step 1: Set Google Cloud storage repositories</h3>
<p>Choose whether you want to scan your own Google Cloud storage
repository or an example one. This topic provides instructions for both
scenarios.</p>
<h4 data-text="Scan your own data" id="scan_your_own_data">Scan your own data</h4>
<p>If you want to scan your own existing Cloud Storage bucket,
BigQuery table, or Datastore kind, first open the
project that the repository is in. In subsequent steps, you'll enable both
Security Command Center and Cloud DLP for this project and its
organization.</p>
<p>After you open the project you want to use, proceed to <a href="#iam-roles">Step 2 to set up some
IAM roles</a>.</p>
<h4 data-text="Scan sample data" id="scan_sample_data">Scan sample data</h4>
<p>If you want to scan a test set of data, first make sure that you have
a billing account set up, and then create a new project. To complete this step,
you must have the IAM <strong>Project Creator</strong> role. Learn more about
<a href="/iam/docs/understanding-roles">IAM roles</a>.</p>
<ol>
<li>If you don't already have billing configured, set up a billing account.
 <p><a class="button button-primary" href="/billing/docs/how-to/modify-project" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">Learn how to enable billing</a></p></li>
<li>Go to the <strong>New Project</strong> page in the
 Cloud console.
 <p><a class="button button-primary" href="https://console.cloud.google.com/projectcreate" target="console" track-name="consoleLink" track-type="quickstart">Go to New Project</a></p></li>
<li>On the <strong>Billing account</strong> drop-down list, select the billing account that
 the project should be billed to.</li>
<li>On the <strong>Organization</strong> drop-down list, select the organization that you
 want to create the project in.</li>
<li>On the <strong>Location</strong> drop-down list, select the organization or folder that
 you want to create the project in.</li>
</ol>
<p>Next, download and store the sample data:</p>
<ol>
<li>Go to the <a class="external" href="https://github.com/GoogleCloudPlatform/dlp-cloud-functions-tutorials/">Cloud Functions tutorials repository on GitHub</a>.</li>
<li>Click <strong>Clone or download</strong>, and then click <strong>Download ZIP</strong>.</li>
<li>Extract the zip file that you downloaded.</li>
<li>Go to the <a href="https://console.cloud.google.com/storage/browser/">Storage Browser</a> page in the
 Cloud console.
 <p><a class="button button-primary" href="https://console.cloud.google.com/storage/browser/" target="_blank" track-metadata-end-goal="createBucket" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to Cloud Storage</a></p></li>
<li>Click <strong>Create bucket</strong>.</li>
<li>On the <strong>Create a bucket</strong> page, give the bucket a unique name, and then
 click <strong>Create</strong>.</li>
<li>On the <strong>Bucket details</strong> page, click <strong>Upload folder</strong>.
 <p><figure style="text-align: center">
<img alt="" class="screenshot" src="/dlp/docs/images/sending-results-to-scc-bucket.png">
</img></figure></p></li>
<li>Go to the <strong><code dir="ltr" translate="no">dlp-cloud-functions-tutorials-master</code></strong> folder that you
 extracted, open it, and then select the <strong><code dir="ltr" translate="no">sample_data</code></strong> folder.
 Click <strong>Upload</strong> to upload the folder's contents to Cloud Storage.</li>
</ol>
<p>Note the name that you gave the Cloud Storage bucket for later. After the
file upload completes, you're ready to continue.</p>
<h3 data-text="Step 2: Set IAM roles" id="iam-roles">Step 2: Set IAM roles</h3>
<p>To use Cloud DLP to send scan results to Security Command Center, you
need the <strong>Security Center Admin</strong> and <strong>DLP Jobs Editor</strong>
IAM roles. This section describes how to add the roles. To
complete this section, you must have the <strong>Organization Administrator</strong>
IAM role.</p>
<ol>
<li><p>Go to the IAM page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/iam" target="_blank" track-metadata-end-goal="addRoles" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to IAM</a></p></li>
<li>Under <strong>Principals</strong>, click <i aria-hidden="true" class="material-icons" translate="no">edit</i><strong>Edit</strong> next to
 your username.
 <aside class="note">
<p><strong>Note:</strong> If you can't find your username, make sure
     that you're looking at an organization and not a project. To select
     the correct organization, use the project selector drop-down list.</p>
<p>If an alert message displays that "You do not have sufficient
     permissions to view this page," make sure that you have the
     <strong>Organization Administrator</strong> IAM role. For more
     information, see <a href="/iam/docs/overview">IAM
     documentation</a>.</p></aside></li>
<li>On the <strong>Edit permissions panel</strong>, click <strong>Add another role</strong>.</li>
<li>On the <strong>Select a role</strong> drop-down list, select <strong>Security Command Center</strong> &gt;
 <strong>Security Center Admin</strong>.</li>
<li>Next, from the same drop-down list, select <strong>Cloud DLP</strong> &gt;
 <strong>DLP Jobs Editor</strong>, and then click <strong>Save</strong>.</li>
</ol>
<p>You now have DLP Jobs Editor and Security Center Admin roles
for your organization. These roles let you complete the tasks in the
remainder of this topic.</p>
<h3 data-text="Step 3: Enable Security Command Center" id="enable-scc">Step 3: Enable Security Command Center</h3>
<ol>
<li><p>Go to the <a href="https://console.cloud.google.com/security/command-center/welcome">Security Command Center</a>
 page in the Cloud console.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/security/command-center/welcome" target="console" track-name="consoleLink" track-type="tutorial">Go to Security Command Center</a> </p></li>
<li><p>On the <strong>Organization</strong> drop-down list, select the organization for which you
 want to enable Cloud DLP, and then click <strong>Select</strong>.</p></li>
<li><p>On the <strong>Enable asset discovery</strong> page that appears, select <strong>All current and
 future projects</strong>, and then click <strong>Enable</strong>. A message should display that
 Cloud DLP is beginning asset discovery.</p></li>
</ol>
<p>After asset discovery is complete, Cloud DLP will display your
supported Google Cloud assets. Asset discovery might take a few minutes,
and you might need to refresh the page to display the assets.</p>
<p>For more information about enabling Security Command Center, see the
<a href="/security-command-center/docs">Security Command Center documentation</a>.</p>
<h3 data-text="Step 4: Enable Cloud DLP" id="dlp">Step 4: Enable Cloud DLP</h3>
<p>Enable Cloud DLP for the project you want to scan. The project
must be within the same organization for which you've enabled
Security Command Center. To enable Cloud DLP using the
Cloud console:</p>
<ol>
<li>Go to the Cloud console page to
register your application for Cloud DLP.
 <p><a class="button button-primary" href="https://console.cloud.google.com/flows/enableapi?apiid=dlp.googleapis.com" target="console" track-metadata-end-goal="enableAPI" track-name="consoleLink" track-type="commonIncludes">Go to the Register your application for Cloud DLP page</a></p></li>
<li>On the <strong>Create a project</strong> drop-down list, select the project from Step 1
 of this guide. The project must contain the Cloud Storage bucket,
 BigQuery table, or Datastore kind you want to
 scan.</li>
<li>After you select the project you want to use, click <strong>Continue</strong>.</li>
</ol>
<p>Cloud DLP is now enabled for your project.</p>
<h3 data-text="Step 5: Enable Cloud DLP as a security source for Security Command Center" id="security-source">Step 5: Enable Cloud DLP as a security source for Security Command Center</h3>
<p>To view Cloud DLP scan findings in the Security Command Center
dashboard, enable Cloud DLP as a security source:</p>
<ol>
<li>Go to the Security Command Center <strong>Security Sources</strong> page in
the Cloud console.
<p><a class="button button-primary" href="https://console.cloud.google.com/security/command-center/settings/source-management" target="console" track-name="consoleLink" track-type="tutorial">Go to Security Sources</a></p></li>
<li>Select the organization for which you want to enable Cloud DLP
as a security source.</li>
<li>Under <strong>Enabled</strong>, click the <img alt="" aria-hidden="true" class="inline-icon" src="/dlp/docs/images/toggle-on.png"/>horizontal slider to enable
<strong>Cloud DLP Data Discovery</strong>.</li>
</ol>
<p>Findings for Cloud DLP are displayed on the Findings page in the
Security Command Center dashboard. For more information about how to manage
Security Command Center security sources, see the <a href="/security-command-center/docs/how-to-security-sources">Security Command Center documentation</a>.</p>
<h2 data-text="Configure and run a Cloud DLP inspection scan" id="run-dlp-scan">Configure and run a Cloud DLP inspection scan</h2>
<p>In this section, you configure and run a Cloud DLP scan job.</p>
<aside class="note"><strong>Note:</strong><span> These instructions use <a href="https://developers.google.com/apis-explorer">APIs
Explorer</a> to send requests that
contain JSON to Cloud DLP. This tool is for learning, demonstration,
and experimentation purposes only, and you should never use APIs Explorer for
production work. You can use <code dir="ltr" translate="no">gcloud</code>, <code dir="ltr" translate="no">curl</code>, or <code dir="ltr" translate="no">httplib2</code> to send these
requests instead. You can also use one of the available Cloud DLP
<a href="/dlp/docs/libraries">client libraries</a> to access the API using Java, Python,
Go, and more.</span></aside>
<p>The <em>inspection job</em> that you configure here instructs Cloud DLP to
scan either the <a href="#gcp-storage-repos">sample data stored in Cloud Storage</a>
or your own data stored in Cloud Storage, Datastore, or
BigQuery. The job configuration that you specify is also where
you instruct Cloud DLP to save its scan results to
Security Command Center.</p>
<h3 data-text="Step 1: Note your project identifier" id="note_your_project_identifier">Step 1: Note your project identifier</h3>
<ol>
<li>Go to the Cloud console.
 <p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard/" target="console" track-name="consoleLink" track-type="tutorial">Go to the Cloud console</a></p></li>
<li>Click <strong>Select</strong>.</li>
<li>On the <strong>Select from</strong> drop-down list, select the organization for which
 you enabled Security Command Center.</li>
<li>Under <strong>ID</strong>, copy the project ID for the <a href="#gcp-storage-repos">project that contains the data
 you want to scan</a>.</li>
<li>Under <strong>Name</strong>, click the project to select it.</li>
</ol>
<h3 data-text="Step 2: Open APIs Explorer and configure the job" id="open_apis_explorer_and_configure_the_job">Step 2: Open APIs Explorer and configure the job</h3>
<ol>
<li>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.create</code> method
 by clicking the following button:
 <p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create?apix=true">Open APIs Explorer</a></p></li>
<li>In the <strong>parent</strong> box, enter the following, where <var translate="no">PROJECT_ID</var> is
 the project ID you noted in Step 1:
 <pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var></pre></li>
</ol>
<p>Replace the contents of the <strong>Request body</strong> field with the following JSON for
the kind of data you want to use: sample data in a Cloud Storage bucket, or
your own data stored in Cloud Storage, Datastore, or
BigQuery.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Sample data" id="sample-data">Sample data</h3><p>If you created a Cloud Storage bucket to <a href="#gcp-storage-repos">store sample data</a>,
copy the following JSON and then paste it into the <strong>Request
body</strong> field. Replace <code dir="ltr" translate="no"><var translate="no">BUCKET_NAME</var></code> with the name
that you gave your Cloud Storage bucket:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectJob":{
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://<var translate="no">BUCKET_NAME</var>/**"
        }
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"EMAIL_ADDRESS"
        },
        {
          "name":"PERSON_NAME"
        },
        {
          "name": "LOCATION"
        },
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "includeQuote":true,
      "minLikelihood":"UNLIKELY",
      "limits":{
        "maxFindingsPerRequest":100
      }
    },
    "actions":[
      {
        "publishSummaryToCscc":{

        }
      }
    ]
  }
}
</code></pre></section>
<section><h3 data-text="Cloud Storage data" id="cloud-storage-data">Cloud Storage data</h3><p>To scan your own Cloud Storage bucket, copy the following JSON and
paste it into the <strong>Request body</strong> field.</p>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PATH_NAME</var></code> with the path to the location
that you want to scan. To scan recursively, end the path with two asterisks,
for example, <code dir="ltr" translate="no">gs://path_to_files/**</code>. To scan a specific directory and
no deeper, end the path with one asterisk, for example,
<code dir="ltr" translate="no">gs://path_to_files/*</code>.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectJob":{
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://<var translate="no">PATH_NAME</var>"
        }
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"EMAIL_ADDRESS"
        },
        {
          "name":"PERSON_NAME"
        },
        {
          "name": "LOCATION"
        },
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "includeQuote":true,
      "minLikelihood":"UNLIKELY",
      "limits":{
        "maxFindingsPerRequest":100
      }
    },
    "actions":[
      {
        "publishSummaryToCscc":{

        }
      }
    ]
  }
}
</code></pre>
<p>To learn more about the available scan options, see <a href="/dlp/docs/inspecting-storage">Inspecting storage
and databases for sensitive data</a>.</p></section>
<section><h3 data-text="Datastore data" id="datastore-data">Datastore data</h3><p>To scan your own data kept in Datastore, copy the following
JSON and paste it into the <strong>Request body</strong> field.</p>
<p>Replace <code dir="ltr" translate="no"><var translate="no">DATASTORE_KIND</var></code> with the name of the
Datastore kind. You can also replace
<code dir="ltr" translate="no"><var translate="no">NAMESPACE_ID</var></code> and
<code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the namespace and project
identifiers, repectively, or you can remove the <code dir="ltr" translate="no">"partitionID"</code> completely
if you want.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectJob":{
    "storageConfig":{
      "datastoreOptions":{
        "kind":{
          "name":"<var translate="no">DATASTORE_KIND</var>"
        },
        "partitionId":{
          "namespaceId":"<var translate="no">NAMESPACE_ID</var>",
          "projectId":"<var translate="no">PROJECT_ID</var>"
        }
      }
    },
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"EMAIL_ADDRESS"
        },
        {
          "name":"PERSON_NAME"
        },
        {
          "name": "LOCATION"
        },
        {
          "name":"PHONE_NUMBER"
        }
      ],
      "includeQuote":true,
      "minLikelihood":"UNLIKELY",
      "limits":{
        "maxFindingsPerRequest":100
      }
    },
    "actions":[
      {
        "publishSummaryToCscc":{

        }
      }
    ]
  }
}
</code></pre>
<p>To learn more about the available scan options, see <a href="/dlp/docs/inspecting-storage">Inspecting storage
and databases for sensitive data</a>.</p></section>
<section><h3 data-text="BigQuery data" id="bigquery-data">BigQuery data</h3><p>To scan your own BigQuery table, copy the following
JSON and paste it into the <strong>Request body</strong> field.</p>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code>,
<code dir="ltr" translate="no"><var translate="no">BIGQUERY_DATASET_NAME</var></code>, and
<code dir="ltr" translate="no"><var translate="no">BIGQUERY_TABLE_NAME</var></code> with the project ID and
BigQuery dataset and table names, repectively.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectJob":
  {
    "storageConfig":
    {
      "bigQueryOptions":
      {
        "tableReference":
        {
          "projectId": "<var translate="no">PROJECT_ID</var>",
          "datasetId": "<var translate="no">BIGQUERY_DATASET_NAME</var>",
          "tableId": "<var translate="no">BIGQUERY_TABLE_NAME</var>"
        }
      }
    },
    "inspectConfig":
    {
      "infoTypes":
      [
        {
          "name": "EMAIL_ADDRESS"
        },
        {
          "name": "PERSON_NAME"
        },
        {
          "name": "LOCATION"
        },
        {
          "name": "PHONE_NUMBER"
        }
      ],
      "includeQuote": true,
      "minLikelihood": "UNLIKELY",
      "limits":
      {
        "maxFindingsPerRequest": 100
      }
    },
    "actions":
    [
      {
        "publishSummaryToCscc":
        {
        }
      }
    ]
  }
}
</code></pre>
<p>To learn more about the available scan options, see <a href="/dlp/docs/inspecting-storage">Inspecting storage
and databases for sensitive data</a>.</p></section>
</div><aside class="note"><strong>Note:</strong><span> For a full list of information types that Cloud DLP can scan
for and detect, see <a href="/dlp/docs/infotypes-reference">InfoTypes reference</a>.</span></aside>
<h3 data-text="Step 3: Execute the request to start the scan job" id="execute_the_request_to_start_the_scan_job">Step 3: Execute the request to start the scan job</h3>
<p>After you configure the job by following the preceding steps, click <strong>Execute</strong>
to send the request. If the request is successful, a response appears below
the request with a success code and a JSON object that indicates the status of
the Cloud DLP job that you created.</p>
<aside class="special"><strong>Important:</strong><span> Keep the page open or copy the response JSON so that you have it for
the remainder of the tasks in this topic.</span></aside>
<h2 data-text="Check the status of the Cloud DLP inspection scan" id="check-status">Check the status of the Cloud DLP inspection scan</h2>
<p>The response to your scan request includes the job ID of your inspection scan
job as the <code dir="ltr" translate="no">"name"</code> key, and the current state of the inspection scan job as the
<code dir="ltr" translate="no">"state"</code> key. Immediately after you submit the request, the job's state
is <code dir="ltr" translate="no">"PENDING"</code>.</p>
<p>After you submit the scan request, the scan of your content begins immediately.</p>
<p>To check the status of the inspection scan job:</p>
<ol>
<li>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.get</code> method
 by clicking the following button:
 <p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get?apix=true">Open APIs Explorer</a></p></li>
<li>In the <strong>name</strong> box, type the name of the job from the JSON response to
 the scan request in the following form:
 <pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/dlpJobs/<var translate="no">JOB_ID</var></pre>
 The job ID is in the form of <code dir="ltr" translate="no">i-1234567890123456789</code>.</li>
<li>To submit the request, click <strong>Execute</strong>.</li>
</ol>
<p>If the response JSON object's <code dir="ltr" translate="no">"state"</code> key indicates that the job is <code dir="ltr" translate="no">"DONE"</code>,
then the scan job has finished.</p>
<aside class="note"><strong>Note:</strong><span> You can instruct Cloud DLP to send you a notification when a
job is done. To learn more, see the
<a href="/dlp/docs/concepts-actions">Actions</a> conceptual page.</span></aside>
<p>To view the rest of the response JSON, scroll down the page. Under <code dir="ltr" translate="no">"result"</code> &gt;
<code dir="ltr" translate="no">"infoTypeStats"</code>, each information type listed should have a corresponding
<code dir="ltr" translate="no">"count"</code>. If not, make sure that you entered the JSON accurately, and that the
path or location to your data is correct.</p>
<p>After the scan job is done, you can continue to the next section of this guide
to view scan results in Security Command Center.</p>
<h2 data-text="View Cloud DLP scan results in Security Command Center" id="view_dlp_results_in_scc">View Cloud DLP scan results in Security Command Center</h2>
<p>Because you instructed Cloud DLP to send its inspection scan job
results to Security Command Center, you can now view a summary of the scan in the
Security Command Center dashboard:</p>
<ol>
<li>Go to the Security Command Center page in the Cloud console.
<p><a class="button button-primary" href="https://console.cloud.google.com/security/dashboard" target="console" track-name="consoleLink" track-type="tutorial">Go to Security Command Center</a></p></li>
<li>Select the organization for which you enabled Security Command Center.</li>
</ol>
<p>The following screenshot of the Security Command Center main dashboard shows the two
cards in which Cloud DLP data appearsâ<strong>Findings Summary</strong>
and <strong>Cloud DLP Data Discovery</strong>.</p>
<p><figure style="text-align: center">
<img alt="" class="screenshot" src="/dlp/docs/images/sending-results-to-scc-findings.png" width="434">
</img></figure></p>
<p>The <code dir="ltr" translate="no">LOCATION</code> infoType isn't listed because there were no
matches in Cloud DLP on the <code dir="ltr" translate="no">LOCATION</code> infoType.
Cloud DLP findings are totaled and displayed alongside other
figures in the <strong>Findings Summary</strong>. Security Command Center lists the findings
by information
type under <strong>Cloud DLP Data Discovery</strong>.</p>
<h3 data-text="Findings Summary" id="findings_summary">Findings Summary</h3>
<p>If any findings were sent Cloud DLP, a row displays with the source
<strong>Cloud DLP Data Discovery</strong>. If that row doesn't appear in
<strong>Findings Summary</strong>, then Cloud DLP didn't send any findings to
Security Command Center.</p>
<h3 data-text="Cloud DLP Data Discovery" id="data_discovery">Cloud DLP Data Discovery</h3>
<p>Any <code dir="ltr" translate="no">infoTypes</code> that successfully matched to scanned data are listed in the
<strong>Finding</strong> column. The number in the <strong>Count</strong> column corresponds to the number
of scans that found data that matched that <code dir="ltr" translate="no">infoType</code>. If a job is scanning
multiple sources, the count might include each source that was scanned.</p>
<p>To see individual findings for a specific category, click a rowâfor
example, <code dir="ltr" translate="no">EMAIL_ADDRESS</code>. A list of each scan in which at least one
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> was found displays under the <strong>Findings</strong> tab, as shown
in the following screenshot:</p>
<p><figure style="text-align: center">
<img alt="A list of EMAIL_ADDRESS findings with columns for resourceName,
            eventTime, firstDiscovered, and parent." class="screenshot" src="/dlp/docs/images/sending-results-to-scc-findings2.png">
</img></figure></p>
<p>To display detail about a specific finding, click one of the <code dir="ltr" translate="no">EMAIL_ADDRESS</code>
rows to see the detail page, as shown in the following screenshot:</p>
<p><figure style="text-align: center">
<img alt="The Finding Details with a list of associated attributes and a count of source properties." class="screenshot" src="/dlp/docs/images/sending-results-to-scc-findings3.png">
</img></figure></p>
<aside class="key-point"><strong>Key Point:</strong><span> The instructions provided in this guide only turn on some of
Cloud DLP's built-in detectors.
<ul>
<li>For more information about what else Cloud DLP can
    detect, see the <a href="/dlp/docs/infotypes-reference">
    InfoTypes reference</a>.
  </li>
<li>For information about configuring your own custom infoType detectors, see
    <a href="/dlp/docs/creating-custom-infotypes">
    Creating custom infoType detectors</a>.
  </li>
</ul></span></aside>
<h2 data-text="Clean up" id="clean_up">Clean up</h2>
<p>To avoid incurring charges to your Google Cloud account for the resources
used in this topic:</p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<p>The easiest way to eliminate billing is to delete the project you created
while following the instructions provided in this topic.</p>
<ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
<p>
    If you plan to explore multiple tutorials and quickstarts, reusing projects can help you avoid
    exceeding project quota limits.
  </p>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
<p>If you delete your project using this method, the Cloud DLP job
and Cloud Storage bucket you created were also deleted. It's not
necessary to follow the instructions in the following sections.</p>
<h3 data-text="Delete the Cloud DLP job" id="delete_the_job">Delete the Cloud DLP job</h3>
<p>If you scanned your own data, you only need to delete the inspect scan job
that you created:</p>
<ol>
<li>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.delete</code> method
 by clicking the following button:
 <p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/delete?apix=true">Open APIs Explorer</a></p></li>
<li>In the <strong>name</strong> box, type the name of the job from the JSON response to
 the scan request, which has the following form:
 <pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var>/dlpJobs/<var translate="no">JOB_ID</var></pre>
 The job ID is in the form of <code dir="ltr" translate="no">i-1234567890123456789</code>.</li>
</ol>
<p>If you created additional scan jobs or if you want to make sure you've deleted
the job successfully, you can list all existing jobs:</p>
<ol>
<li>Go to APIs Explorer on the reference page for the <code dir="ltr" translate="no">dlpJobs.list</code> method
 by clicking the following button:
 <p><a class="button button-primary" href="/dlp/docs/reference/rest/v2/projects.dlpJobs/list?apix=true">Open APIs Explorer</a></p></li>
<li>In the <strong>parent</strong> box, type the project identifier in the following form:
 <pre class="devsite-click-to-copy" dir="ltr" translate="no">projects/<var translate="no">PROJECT_ID</var></pre></li>
<li>Click <strong>Execute</strong>.</li>
</ol>
<p>If there are no jobs listed in the response, you've deleted all jobs. If
jobs are listed in the response, repeat the deletion procedure for those
jobs.</p>
<h3 data-text="Delete the Cloud Storage bucket" id="delete_the_bucket">Delete the Cloud Storage bucket</h3>
<p>If you created a new Cloud Storage bucket to hold sample data, delete the
bucket:</p>
<ol>
<li>Open the <a href="https://console.cloud.google.com/storage/browser">Cloud Storage browser</a>.
 <p><a class="button button-primary" href="https://console.cloud.google.com/storage/browser" target="_blank" track-metadata-end-goal="viewDlpResults" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Open Cloud Storage</a></p></li>
<li>In the Cloud Storage browser, select the checkbox next to the name of
  the bucket you created, and then click <strong>Delete</strong>.</li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about the <a href="/dlp/docs/reference/rest/v2/InspectJobConfig#publishsummarytocscc"><code dir="ltr" translate="no">publishSummaryToCscc</code>
action</a>
in Cloud DLP.</li>
<li>Learn more about <a href="/dlp/docs/inspecting-storage">scanning storage repositories for sensitive
data</a> using Cloud DLP.</li>
<li>Learn how to use <a href="/security-command-center/docs">Security Command Center</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/analyzing-and-reporting]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention helps you find, understand, and manage the sensitive
data that exists within your infrastructure. Once you've scanned your content
for sensitive data using Cloud DLP, you have several options
for what to do with that data intelligence. This topic shows you how to
leverage the power of other Google Cloud features such as BigQuery,
Cloud SQL, and Google Data Studio to:</p>
<ul>
<li>Store Cloud DLP scan results directly in
BigQuery.</li>
<li>Generate reports on where sensitive data resides in your infrastructure.</li>
<li>Run rich SQL analytics to understand where sensitive data is stored and
what kind it is.</li>
<li>Automate alerts, or actions to trigger based on a single set or a
combination of findings.</li>
</ul>
<p>This topic also contains a complete example of how to use
Cloud DLP along with other Google Cloud features to
accomplish all of these things.</p>
<aside class="note"><strong>Note:</strong><span> This example demonstrates how to interact with
DLP API using the REST API and JSON objects. The
DLP API client libraries provide wrappers over the REST API,
and are available in several supported programming languages. For more
information, see
<a href="/dlp/docs/libraries">DLP API Client Libraries</a>.</span></aside>
<h2 data-text="Scan a storage bucket" id="scan_a_storage_bucket">Scan a storage bucket</h2>
<p>First, run a scan on your data. Following is basic information about how to scan
storage repositories using Cloud DLP. For full instructions on
scanning storage repositories, including the use of client libraries, see
<a href="https://cloud.google.com/dlp/docs/inspecting-storage">Inspecting Storage and Databases for Sensitive
Data</a>.</p>
<p>To run a scan operation on a
Google Cloud storage repository, assemble a JSON object that includes
the following configuration objects:</p>
<ul>
<li><p><a href="/dlp/docs/reference/rest/v2/InspectJobConfig"><code dir="ltr" translate="no">InspectJobConfig</code></a>:
Configures the DLP scan job, and consists of:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#StorageConfig"><code dir="ltr" translate="no">StorageConfig</code></a>:
The storage repository to scan.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>:
How and what to scan for. You can also use an inspection template to
define the inspection configuration.</li>
<li><a href="/dlp/docs/reference/rest/v2/InspectJobConfig#outputstorageconfig"><code dir="ltr" translate="no">Action</code></a>:
Task(s) to execute on the completion of the job. This can include
saving findings to a BigQuery table or publishing a
notification to Pub/Sub.</li>
</ul></li>
</ul>
<p>In this example, you're scanning a Cloud Storage bucket for person names,
phone numbers, US Social Security numbers, and email addresses. Then you send
the findings to a BigQuery table dedicated to storing
DLP output. The following JSON can be saved to a file or
sent directly to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create"><code dir="ltr" translate="no">create</code></a>
method of the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">DlpJob</code></a>
Cloud DLP resource.</p>
<aside class="note"><strong>Note:</strong><span> The examples on this page require an
<a href="/dlp/docs/auth#using_a_service_account">OAuth 2.0 access token</a>.</span></aside>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/dlpJobs

{
  "inspectJob":{
    "inspectConfig":{
      "infoTypes":[
        {
          "name":"PERSON_NAME"
        },
        {
          "name":"PHONE_NUMBER"
        },
        {
          "name":"US_SOCIAL_SECURITY_NUMBER"
        },
        {
          "name":"EMAIL_ADDRESS"
        }
      ],
      "includeQuote":true
    },
    "storageConfig":{
      "cloudStorageOptions":{
        "fileSet":{
          "url":"gs://[BUCKET_NAME]/**"
        }
      }
    },
    "actions":[
      {
        "saveFindings":{
          "outputConfig":{
            "table":{
              "projectId":"[PROJECT_ID]",
              "datasetId":"[DATASET_ID]",
              "tableId":"[TABLE_ID]"
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<p>By specifying two asterisks (<code dir="ltr" translate="no">**</code>) after the Cloud Storage bucket
address (<code dir="ltr" translate="no">gs://[BUCKET_NAME]/**</code>), you're instructing the
scan job to scan recursively. Placing a single asterisk (<code dir="ltr" translate="no">*</code>) would instruct
the job to scan only the specified directory level and no deeper.</p>
<p>The output will be saved to the specified table within the given dataset and
project. Subsequent jobs that specify the given table ID append findings
to the same table. You could also leave out a
<a href="/dlp/docs/reference/rest/v2/BigQueryTable"><code dir="ltr" translate="no">"tableId"</code></a>
key if you want to instruct Cloud DLP to create a new
table every time the scan is run.</p>
<p>After you send this JSON in a request to the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/create"><code dir="ltr" translate="no">projects.dlpJobs.create</code></a>
method via the specified URL, you get the following response:</p>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT_ID]/dlpJobs/[JOB_ID]",
  "type":"INSPECT_JOB",
  "state":"PENDING",
  "inspectDetails":{
    "requestedOptions":{
      "snapshotInspectTemplate":{

      },
      "jobConfig":{
        "storageConfig":{
          "cloudStorageOptions":{
            "fileSet":{
              "url":"gs://[BUCKET_NAME]/**"
            }
          }
        },
        "inspectConfig":{
          "infoTypes":[
            {
              "name":"PERSON_NAME"
            },
            {
              "name":"PHONE_NUMBER"
            },
            {
              "name":"US_SOCIAL_SECURITY_NUMBER"
            },
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "minLikelihood":"POSSIBLE",
          "limits":{

          },
          "includeQuote":true
        },
        "actions":[
          {
            "saveFindings":{
              "outputConfig":{
                "table":{
                  "projectId":"[PROJECT_ID]",
                  "datasetId":"[DATASET_ID]",
                  "tableId":"[TABLE_ID]"
                }
              }
            }
          }
        ]
      }
    }
  },
  "createTime":"2018-11-19T21:09:07.926Z"
}
</code></pre>
<p>Once the job has completed, it saves its findings to the given
BigQuery table.</p>
<p>To get the status of the job, call the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs.get</code></a>
method, or send a GET request to the following URL, replacing <code dir="ltr" translate="no">[PROJECT_ID]</code>
with your project ID and <code dir="ltr" translate="no">[JOB_ID]</code> with the job identifier given in the
Cloud Data Loss Prevention API's response to the job creation request (the job identifier will
be preceded by a "i-"):</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/dlpJobs/[JOB_ID]
</code></pre>
<p>For the job you just created, this request returns the following JSON. Notice
that a summary of the results of the scan are returned after the inspection
details. If the scan hadn't yet completed, its <code dir="ltr" translate="no">"state"</code> key would specify
<code dir="ltr" translate="no">"RUNNING"</code>.</p>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "name":"projects/[PROJECT_ID]/dlpJobs/[JOB_ID]",
  "type":"INSPECT_JOB",
  "state":"DONE",
  "inspectDetails":{
    "requestedOptions":{
      "snapshotInspectTemplate":{

      },
      "jobConfig":{
        "storageConfig":{
          "cloudStorageOptions":{
            "fileSet":{
              "url":"gs://[BUCKET_NAME]/**"
            }
          }
        },
        "inspectConfig":{
          "infoTypes":[
            {
              "name":"PERSON_NAME"
            },
            {
              "name":"PHONE_NUMBER"
            },
            {
              "name":"US_SOCIAL_SECURITY_NUMBER"
            },
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "minLikelihood":"POSSIBLE",
          "limits":{

          },
          "includeQuote":true
        },
        "actions":[
          {
            "saveFindings":{
              "outputConfig":{
                "table":{
                  "projectId":"[PROJECT_ID]",
                  "datasetId":"[DATASET_ID]",
                  "tableId":"[TABLE_ID]"
                }
              }
            }
          }
        ]
      }
    },
    "result":{
      "processedBytes":"536734051",
      "totalEstimatedBytes":"536734051",
      "infoTypeStats":[
        {
          "infoType":{
            "name":"PERSON_NAME"
          },
          "count":"269679"
        },
        {
          "infoType":{
            "name":"EMAIL_ADDRESS"
          },
          "count":"256"
        },
        {
          "infoType":{
            "name":"PHONE_NUMBER"
          },
          "count":"7"
        }
      ]
    }
  },
  "createTime":"2018-11-19T21:09:07.926Z",
  "startTime":"2018-11-19T21:10:20.660Z",
  "endTime":"2018-11-19T22:07:39.725Z"
}
</code></pre>
<h2 data-text="Run analytics in BigQuery" id="run-analytics-in-bigquery">Run analytics in BigQuery</h2>
<p>Now that you've created a new BigQuery table with the results
of your Cloud DLP scan, the next step is to run analytics on the
table.</p>
<p>On the left side of the Google Cloud console under Big Data, click <strong>BigQuery</strong>.
Open your project and your dataset, and then locate the new table that was
created.</p>
<p>You can run SQL queries on this table to find out more about what the
Cloud DLP found within your data bucket. For example, run the
following to count all the scan results by infoType, replacing the
placeholders with the appropriate real values:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">SELECT
  info_type.name,
  COUNT(*) AS iCount
FROM
  `[PROJECT_ID].[DATASET_ID].[TABLE_ID]`
GROUP BY
  info_type.name
</code></pre>
<p>This query results in a summary of findings for that bucket that might look
something like the following:</p>
<p><img alt="Example summary of Cloud DLP findings." src="/dlp/docs/images/analyzing-and-reporting.png"/></p>
<h2 data-text="Create a report in Data Studio" id="create_a_report_in">Create a report in Data Studio</h2>
<p>Data Studio enables you to create custom reports that can be
based on BigQuery tables. In this section, you create a simple
table report in Data Studio that is based on
Cloud DLP findings stored in BigQuery.</p>
<ol>
<li>Open <a href="https://datastudio.google.com">Data Studio</a> and
  start a new report.</li>
<li>Click <strong>Create New Data Source</strong>.</li>
<li>From the list of Connectors, click <strong>BigQuery</strong>. If necessary, authorize
  Data Studio to connect to your BigQuery
  projects by clicking <strong>Authorize</strong>.</li>
<li>Now, choose which table to search, and then click <strong>My Projects</strong> or
  <strong>Shared Projects</strong>, depending on where your project resides. Find your
  project, dataset, and table in the lists on the page.</li>
<li>Click <strong>Connect</strong> to run the report.</li>
<li>Click <strong>Add to Report</strong>.</li>
</ol>
<p>Now you'll create a
<a href="https://support.google.com/datastudio/answer/7189044">table</a> that displays
the frequency of each infoType. Select the field <code dir="ltr" translate="no">info_type.name</code> as the
<strong>Dimension</strong>. The resulting table will look similar to the following:</p>
<p><img alt="An example table in Data Studio." src="/dlp/docs/images/analyzing-and-reporting2.png"/></p>
<h2 data-text="Next steps" id="next_steps">Next steps</h2>
<p>This is just the start of what you can visualize using
Data Studio and the output from Cloud DLP.
You can add in other charting elements and drill-down filters to create
dashboards and reports.  For more information about what is available in
Data Studio, see the <a href="https://datastudio.google.com/overview">Data Studio Product
Overview</a>.</p>
<section id="try-it">
<div class="devsite-apix">
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="dlp.projects.dlpJobs.create"></div>
</div>
</section>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/querying-findings]</H1></p><div class="devsite-article-body clearfix">
<p>When your findings are transferred to BigQuery, the data is
written to either a new or existing table. For more information about actions,
see the <a href="/dlp/docs/concepts-actions">Actions</a> conceptual topic.</p>
<h2 data-text="Sample queries" id="sample_queries">Sample queries</h2>
<p>You can use the following sample queries to analyze your findings. You can
also use the queries in a visualization tool such as
<a href="https://www.google.com/analytics/data-studio/">Google Data Studio</a>. These
queries are provided to help you get started querying your findings data.</p>
<p>In each of the following queries, replace <code dir="ltr" translate="no">[DATASET]</code> with the
BigQuery dataset name, <code dir="ltr" translate="no">[TABLE_ID]</code> with the table ID, and
<code dir="ltr" translate="no">[PROJECT_ID]</code> with the project identifier.</p>
<h3 data-text="Select the count of each infoType" id="select_the_count_of_each_infotype">Select the count of each infoType</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT info_type.name,
COUNT(info_type.name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
GROUP BY info_type.name
ORDER BY count DESC;
</pre></section>
<section><h3 data-text=" Command-line " id="command-line"> Command-line </h3><pre class="lang-sh prettyprint" dir="ltr" translate="no">
bq query --use_legacy_sql=false ' SELECT info_type.name,
COUNT(info_type.name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
GROUP BY info_type.name ORDER BY count DESC;'
</pre></section>
</div>
<h3 data-text="Select the count of each infoType by day" id="select_the_count_of_each_infotype_by_day">Select the count of each infoType by day</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_1"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT info_type.name, cast(TIMESTAMP_SECONDS(create_time.seconds) as date) as day,
COUNT(locations.container_name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY info_type.name, day
ORDER BY count DESC;
</pre></section>
<section><h3 data-text=" Command-line " id="command-line_1"> Command-line </h3><pre class="lang-sh prettyprint" dir="ltr" translate="no">
bq query --use_legacy_sql=false ' SELECT info_type.name,
cast(TIMESTAMP_SECONDS(create_time.seconds) as date) as day,
COUNT(locations.container_name) AS count FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY info_type.name, day ORDER BY count DESC;'
</pre></section>
</div>
<h3 data-text="Selects the count of each infoType in each container" id="selects_the_count_of_each_infotype_in_each_container">Selects the count of each infoType in each container</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_2"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT info_type.name, locations.container_name,
COUNT(locations.container_name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY locations.container_name, info_type.name
ORDER BY count DESC;
</pre></section>
<section><h3 data-text=" Command-line " id="command-line_2"> Command-line </h3><pre class="lang-sh prettyprint" dir="ltr" translate="no">
bq query --use_legacy_sql=false ' SELECT info_type.name, locations.container_name,
COUNT(locations.container_name) AS count FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY locations.container_name,info_type.name ORDER BY count DESC;'
</pre></section>
</div>
<h3 data-text="Selects the finding types found for each column of a table" id="selects_the_finding_types_found_for_each_column_of_a_table">Selects the finding types found for each column of a table</h3>
<p>This query will group all the findings by column name and is intended to work
on findings from a BigQuery inspection job, useful if you are trying to identify
the likely types for a given column. You can adjust settings by modifying
the WHERE and HAVING clauses. For example, if multiple table results are
included in your findings table, you can limit these to just one job run or one table name.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_3"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT
  table_counts.field_name,
  STRING_AGG( CONCAT(" ",table_counts.name," [count: ",CAST(table_counts.count_total AS String),"]")
  ORDER BY
    table_counts.count_total DESC) AS infoTypes
FROM (
  SELECT
    locations.record_location.field_id.name AS field_name,
    info_type.name,
    COUNT(*) AS count_total
  FROM
    [PROJECT_ID].[DATASET].[TABLE_ID],
    UNNEST(location.content_locations) AS locations
  WHERE
    (likelihood = 'LIKELY'
      OR likelihood = 'VERY_LIKELY'
      OR likelihood = 'POSSIBLE')
  GROUP BY
    locations.record_location.field_id.name,
    info_type.name
  HAVING
    count_total&gt;200 ) AS table_counts
GROUP BY
  table_counts.field_name
ORDER BY
  table_counts.field_name
</pre></section>
</div>
<p>The above query might produce a result like this for a sample table, where
  the infoTypes column tells us how many instances of each infoType was found
  for that given column.</p>
<table>
<tr>
<th>field_name</th>
<th>infoTypes</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">field1</code></td>
<td><code dir="ltr" translate="no">CUSTOM_USER_US [count: 7004]</code>,  <code dir="ltr" translate="no">CUSTOM_USER_EU [count: 2996]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field2</code></td>
<td><code dir="ltr" translate="no">US_VEHICLE_IDENTIFICATION_NUMBER [count: 9597]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field3</code></td>
<td><code dir="ltr" translate="no">EMAIL_ADDRESS [count: 10000]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field4</code></td>
<td><code dir="ltr" translate="no">IP_ADDRESS [count: 10000]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field5</code></td>
<td><code dir="ltr" translate="no">PHONE_NUMBER [count: 7815]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field6</code></td>
<td><code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER [count: 10000]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field7</code></td>
<td><code dir="ltr" translate="no">CREDIT_CARD_NUMBER [count: 10000]</code></td>
</tr>
</table>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/securing-dlp]</H1></p><div class="devsite-article-body clearfix">
<p>Using VPC Service Controls, you can control how Cloud Data Loss Prevention accesses your
data. VPC Service Controls enables you to define a security perimeter around
your projects and resources, including Cloud DLP resources. This
lets you control communication to Cloud DLP and between
Cloud DLP and other Google Cloud services.</p>
<p>VPC Service Controls provides additional security for your
Google Cloud resources to help mitigate the risk of data exfiltration.
Using VPC Service Controls, you can add projects to service perimeters that
protect resources and services from requests that originate outside the
perimeter.</p>
<p>To learn more about service perimeters, see the <a href="/vpc-service-controls/docs/service-perimeters">Service perimeter
configuration page</a> in the
<a href="/vpc-service-controls/docs/overview">VPC Service Controls documentation</a>.</p>
<h2 data-text="Set up a service perimeter around Cloud DLP" id="set_up_a_service_perimeter_around">Set up a service perimeter around Cloud DLP</h2>
<p>To learn how to set up a new service perimeter to prohibit external access to
Cloud DLP resources, follow the instructions in <a href="/vpc-service-controls/docs/create-service-perimeters">Creating a service
perimeter</a>. Be aware of
the following Cloud DLP-specific options:</p>
<ul>
<li>When you're asked to add the projects that you want to secure, select
the project (or projects) that contains the Cloud DLP resources
that you want to protect.</li>
<li>When you're asked to specify the services that you want to secure within the
perimeter, type <code dir="ltr" translate="no">dlp</code> into the <strong>Filter services</strong> field, and then choose
<strong>Cloud Data Loss Prevention</strong> from the list.</li>
</ul>
<aside class="note"><strong>Note:</strong><span> When you secure Cloud DLP inside a service perimeter, be
aware that any services that Cloud DLP interacts with will need to
be secured within the same perimeter.</span></aside>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="terms">
<ul class="card-showcase">
<li>
<a class="no-logo" href="/dlp/docs/concepts-actions">
<h3 class="hide-from-toc no-link" data-text="Actions" id="actions">Actions</h3>
<p>
    An action is something that occurs after a DLP job
    completes successfully.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/classification-redaction">
<h3 class="hide-from-toc no-link" data-text="Classification, redaction, and de-identification" id="classification,-redaction,-and-de-identification">Classification, redaction, and de-identification</h3>
<p>
    Cloud DLP can redact and de-identify sensitive information in
    your text strings, images, and structured content.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-date-shifting">
<h3 class="hide-from-toc no-link" data-text="Date shifting" id="date-shifting">Date shifting</h3>
<p>
    Date shifting techniques randomly shift a set of dates to obscure the
    actual month and day but preserve the sequence and duration.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-bucketing">
<h3 class="hide-from-toc no-link" data-text="Generalization and bucketing" id="generalization-and-bucketing">Generalization and bucketing</h3>
<p>
    Generalization and bucketing take a highly distinguishing value and
    transforms it into a more general or less distinguishing value.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-hybrid-jobs">
<h3 class="hide-from-toc no-link" data-text="Hybrid jobs and job triggers" id="hybrid-jobs-and-job-triggers">Hybrid jobs and job triggers</h3>
<p>
    Hybrid jobs enable you to stream data from virtually any source, inspect it,
    and then save the results of the inspection scan as part of a hybrid job
    resource.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/pseudonymization">
<h3 class="hide-from-toc no-link" data-text="Pseudonymization" id="pseudonymization">Pseudonymization</h3>
<p>
    Cloud DLP provides pseudonymization capabilities.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-text-redaction">
<h3 class="hide-from-toc no-link" data-text="Text classification and redaction" id="text-classification-and-redaction">Text classification and redaction</h3>
<p>
    Cloud DLP can inspect for and redact sensitive content
    that exists within text strings.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/transformations-reference">
<h3 class="hide-from-toc no-link" data-text="Transformation reference" id="transformation-reference">Transformation reference</h3>
<p>Consult this table of de-identification transformations for use with Cloud DLP.</p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-image-redaction">
<h3 class="hide-from-toc no-link" data-text="Image inspection and redaction" id="image-inspection-and-redaction">Image inspection and redaction</h3>
<p>
    Cloud DLP can inspect for and redact sensitive content that
    exists within images.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/infotypes-reference">
<h3 class="hide-from-toc no-link" data-text="InfoTypes and infoType detectors" id="infotypes-and-infotype-detectors">InfoTypes and infoType detectors</h3>
<p>
    Learn about the different types of sensitive data that
    Cloud DLP searches for.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-job-triggers">
<h3 class="hide-from-toc no-link" data-text="Job triggers" id="job-triggers">Job triggers</h3>
<p>
    A job trigger is an event that automates the creation of
    DLP jobs to scan Google Cloud storage repositories.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/likelihood">
<h3 class="hide-from-toc no-link" data-text="Match likelihood" id="match-likelihood">Match likelihood</h3>
<p>
    Cloud DLP measures how likely it is that a text string is
    a piece of sensitive information.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-method-types">
<h3 class="hide-from-toc no-link" data-text="Method types" id="method-types">Method types</h3>
<p>
    Cloud DLP includes different types of methods that you can use
    to inspect or transform your data.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/quote">
<h3 class="hide-from-toc no-link" data-text="Quote" id="quote">Quote</h3>
<p>
    A quote is a copy of the content that matches an infoType detector.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-risk-analysis">
<h3 class="hide-from-toc no-link" data-text="Risk analysis" id="risk-analysis">Risk analysis</h3>
<p>
    Risk analysis is the process of analyzing sensitive data to find properties
    that might increase the risk of subjects being identified.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/specifying-location">
<h3 class="hide-from-toc no-link" data-text="Specifying processing locations" id="specifying-processing-locations">Specifying processing locations</h3>
<p>Control where your potentially sensitive data is
    processed by specifying a region in which to perform your Cloud Data Loss Prevention
    operations.</p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/supported-file-types">
<h3 class="hide-from-toc no-link" data-text="Supported file types" id="supported-file-types">Supported file types</h3>
<p>Types of files that may be inspected or transformed.</p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/concepts-templates">
<h3 class="hide-from-toc no-link" data-text="Templates" id="templates">Templates</h3>
<p>
    You can use templates to create and persist configuration information to
    use with Cloud DLP.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-actions]</H1></p><div class="devsite-article-body clearfix">
<p>A Cloud Data Loss Prevention <em>action</em> is something that occurs after a
DLP job completes successfully or, in the case of emails,
on error. For example, you can save findings to a BigQuery table,
publish a notification to a Pub/Sub topic, or send an email when a job
either finishes successfully or stops on error.</p>
<h2 data-text="Available actions" id="available_actions">Available actions</h2>
<p>When you run a Cloud Data Loss Prevention job, a summary of its findings are saved by
default within Cloud DLP. You can see this summary using
<a href="https://console.cloud.google.com/security/dlp">Cloud DLP in the
Google Cloud console</a> or retrieve summary information in
the DLP API using the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs/get"><code dir="ltr" translate="no">projects.dlpJobs.get</code></a>
method.</p>
<p>Cloud DLP supports different types of actions depending on the type
of job being run (inspection or risk analysis scan jobs). Following are the
currently supported actions:</p>
<ul>
<li><strong>Save findings to BigQuery</strong> (inspection and risk jobs): Save the
DLP job results to a <a href="/bigquery">BigQuery</a>
table. Before viewing or analyzing the results, you'll want to first ensure
that the job has completed.</li>
<li><strong>Publish to Pub/Sub</strong> (inspection and risk jobs): Publish a
notification that contains the name of the DLP job as an
attribute to a
<a href="https://console.cloud.google.com/cloudpubsub">Pub/Sub</a> channel. You
can specify a topic to send the notification message to, as
long as it has granted publishing access to Cloud DLP
service account running the DLP scan job.</li>
<li><strong>Publish to Security Command Center</strong> (risk jobs): Publishes a summary of the job
results to Security Command Center. For more information, see <a href="/dlp/docs/sending-results-to-scc">Sending
Cloud DLP scan results to
Security Command Center</a>.</li>
<li><strong>Publish to Data Catalog</strong> (risk jobs): Sends job results to
Data Catalog, Google Cloud's metadata management service.</li>
<li><strong>Publish to Google Cloud's operations suite</strong> (risk jobs): Send inspection results to
Cloud Monitoring in <a href="/products/operations">Google Cloud's operations suite</a>.</li>
<li><strong>Notify by email</strong> (inspection and risk jobs): Sends an email to project
owners and editors when the job completes.</li>
</ul>
<h2 data-text="Specify actions" id="specify_actions">Specify actions</h2>
<p>You can specify one or more actions when you configure a Cloud DLP:</p>
<ul>
<li>When you create a new inspection or risk analysis job using
Cloud DLP in the Cloud console, specify actions in
the <strong>Add actions</strong> section of the job creation workflow.</li>
<li>When you configure a new job request to send to the DLP API,
specify actions in the
<a href="/dlp/docs/reference/rest/v2/Action"><code dir="ltr" translate="no">Action</code></a> object.</li>
</ul>
<p>For more information and sample code in several languages, see:</p>
<ul>
<li><a href="/dlp/docs/creating-job-triggers">Creating and scheduling inspection jobs</a></li>
<li><a href="/dlp/docs/compute-k-anonymity">Computing k-anonymity for a dataset</a></li>
<li><a href="/dlp/docs/compute-l-diversity">Computing l-diversity for a dataset</a></li>
</ul>
<h2 data-text="Example action scenario" id="example_action_scenario">Example action scenario</h2>
<p>You can use Cloud DLP actions to automate processes based on
Cloud DLP scan results. Suppose you have a BigQuery
table shared with an external partner. You want to ensure both that this table
does not contain any sensitive identifiers like US Social Security numbers
(the
<a href="/dlp/docs/infotypes-reference#united_states">infoType <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code></a>),
and that, if you find any, access is revoked from the partner. Here is a rough
outline of a workflow that would use actions:</p>
<ol>
<li><a href="/dlp/docs/creating-job-triggers">Create a Cloud DLP job
  trigger</a> to run an inspection scan of the
  BigQuery table every 24 hours.</li>
<li>Set the
  <a href="/dlp/docs/reference/rest/v2/InspectJobConfig#Action">action</a>
  of these jobs to publish a Pub/Sub notification to the
  topic "projects/foo/scan_notifications."</li>
<li>Create a <a href="/functions">Cloud Function</a> that listens for incoming
  messages on "projects/foo/scan_notifications." This Cloud Function will
  receive the name of the DLP job every 24 hours, call
  Cloud DLP to get summary results from this job, and,
  if it finds any Social Security numbers, it can change settings in
  BigQuery or <a href="/iam">Identity and Access Management (IAM)</a> to restrict access
  to the table.</li>
</ol>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn about <a href="/dlp/docs/creating-job-triggers#job-add-actions">the actions available with inspection
jobs</a>.</li>
<li>Learn about <a href="/dlp/docs/compute-k-anonymity#compute-k">the actions available with risk analysis
jobs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/data-profiles]</H1></p><div class="devsite-article-body clearfix">
<p>This page describes the data profiler and how to use it to determine
where sensitive and high-risk data reside in your organization.</p>
<aside class="special"><strong>Disclaimer:</strong><span>
  Cloud DLP does its best to accurately assess the customer data but cannot commit to
  100% accuracy across all scenarios. Each customer is responsible for independently evaluating
  their own particular use of the services as appropriate to support their legal and compliance
  obligations.</span></aside>
<h2 data-text="Overview" id="overview">Overview</h2>
<p>The data profiler lets you protect data across your
organization by identifying where sensitive and high-risk data reside.
When you turn on data profiling, Cloud DLP automatically scans
all BigQuery tables and columns across the entire organization,
individual folders, and projects. It then creates data profiles at the table,
column, and project levels.</p>
<p>A <em>data profile</em> is a set of metrics that Cloud DLP gathers from
scanning a particular resource.
These metrics include the predicted <a href="/dlp/docs/infotypes-reference">infoTypes</a>,
the assessed <a href="/dlp/docs/sensitivity-risk-calculation">data risk and sensitivity levels</a>, and metadata about your tables. Use
these insights to make informed decisions about how you protect, share, and use
your data.</p>
<p>As long as the data profiler configuration is active,
Cloud DLP <a href="/dlp/docs/data-profiles#scan-frequency">automatically scans</a>
tables that you add and modify, and generates new and updated data profiles for
those tables.</p>
<p><figure style="text-align: center">
<a href="/dlp/docs/images/column-data-profiles_2x.png">
<img alt="Screenshot of column data profiles" src="/dlp/docs/images/column-data-profiles.png">
</img></a></figure></p>
<p>For a list of metrics included in each data profile, see
<a href="/dlp/docs/metrics-reference">Metrics reference</a>.</p>
<aside class="note"><strong>Note:</strong><span> For more information on Google Cloud's resource hierarchy, see
<a href="/resource-manager/docs/cloud-platform-resource-hierarchy">Resource hierarchy</a>.</span></aside>
<h2 data-text="Data profile creation" id="data_profile_creation">Data profile creation</h2>
<p>To start generating data profiles, you create a <a href="/dlp/docs/data-profiles#scan-configuration">scan configuration</a> (also called a <em>data profile
configuration</em>). This scan configuration is where you set the
resource (organization, folder, or project) that you want to scan. All
BigQuery datasets and tables in that resource are in scope for
data profiling.</p>
<p>When creating a scan configuration, you also set the <a href="/dlp/docs/data-profiles#inspection-template">inspection template</a> to use. The inspection template is
where you specify the types of sensitive data that Cloud DLP must
scan for.</p>
<p>When Cloud DLP creates data profiles, it analyzes your
BigQuery tables and columns based on your scan configuration and
inspection template. A data profile is a snapshot of the
analysis and metrics gathered at a point in time.</p>
<h2 data-text="Work with data profiles" id="work_with_data_profiles">Work with data profiles</h2>
<p>The workflow for using data profiles is as follows:</p>
<ol>
<li><a href="/dlp/docs/data-profiles#user-roles">Confirm that you have the required user roles</a></li>
<li><a href="/dlp/docs/profile-project">Profile a single project</a></li>
<li><a href="/dlp/docs/profile-org-folder">Profile an organization or folder</a></li>
<li><a href="/dlp/docs/grant-data-profiling-access">Organization or folder scans only: grant profiling access to the service agent</a></li>
<li><a href="/dlp/docs/view-data-profiles">View the data profiles</a></li>
<li><a href="/dlp/docs/analyze-data-profiles">Analyze the data profiles</a></li>
<li><a href="/dlp/docs/data-profiles-remediation">Remediate the findings</a></li>
</ol>
<h2 data-text="Roles required to configure and view data profiles" id="user-roles">Roles required to configure and view data profiles</h2>
<p>The following sections list the required user roles, categorized according to
their purpose. Depending on how your organization is set up, you might decide to
have different people perform different tasks. For example, the person who
configures data profiles might be different from the person who regularly monitors
them.</p>
<h3 data-text="Roles required to work with data profiles at the organization or folder level" id="roles_required_to_work_with_data_profiles_at_the_organization_or_folder_level">Roles required to work with data profiles at the organization or folder level</h3>
<p>These roles let you configure and view data profiles at the organization or
folder level.</p>
<p>Make sure these roles are granted to the proper people at the organization
level. Alternatively, your Google Cloud administrator can
<a href="/iam/docs/creating-custom-roles">create custom roles</a> that only have the
relevant permissions.</p>
<table>
<thead>
<tr>
<th>Purpose</th>
<th>Predefined role</th>
<th>Relevant permissions</th>
</tr>
</thead>
<tbody>
<tr>
<td id="permissions-to-configure-org" rowspan="2">Configure and view data profiles</td>
<td>DLP Administrator (<code dir="ltr" translate="no">roles/dlp.admin</code>)
</td>
<td><ul><li>dlp.inspectTemplates.create</li>
<li>dlp.jobs.create</li>
<li>dlp.jobTriggers.create</li>
<li>dlp.columnDataProfiles.list</li>
<li>dlp.jobs.list</li>
<li>dlp.jobTriggers.list</li>
<li>dlp.projectDataProfiles.list</li>
<li>dlp.tableDataProfiles.list</li>
</ul>
</td>
</tr>
<tr>
<td>Project Creator (<code dir="ltr" translate="no">roles/resourcemanager.projectCreator</code>)</td>
<td><ul><li>resourcemanager.organizations.get</li>
<li>resourcemanager.projects.create</li>
</ul>
</td>
</tr>
<tr>
<td id="permissions-to-grant-profiling-access">Grant data profiling access</td>
<td>One of the following:
<ul>
<li>Organization Administrator
(<code dir="ltr" translate="no">roles/resourcemanager.organizationAdmin</code>)</li>
<li>Security Admin (<code dir="ltr" translate="no">roles/iam.securityAdmin</code>)</li>
</ul>
</td>
<td><ul><li>resourcemanager.organizations.getIamPolicy</li>
<li>resourcemanager.organizations.setIamPolicy</li>
</ul>
</td>
</tr>
<tr>
<td id="permissions-to-view-configs-profiles-org" rowspan="2">View data profiles (read-only)</td>
<td>DLP Data Profiles Reader (<code dir="ltr" translate="no">roles/dlp.dataProfilesReader</code>)</td>
<td><ul><li>dlp.columnDataProfiles.list</li>
<li>dlp.projectDataProfiles.list</li>
<li>dlp.tableDataProfiles.list</li>
</ul>
</td>
</tr>
<tr>
<td>DLP Reader (<code dir="ltr" translate="no">roles/dlp.reader</code>)</td>
<td><ul><li>dlp.jobs.list</li>
<li>dlp.jobTriggers.list</li>
</ul>
</td>
</tr>
</tbody>
</table>
<h3 data-text="Roles required to work with data profiles at the project level" id="roles_required_to_work_with_data_profiles_at_the_project_level">Roles required to work with data profiles at the project level</h3>
<p>These roles let you configure and view data profiles at the project level.</p>
<p>Make sure these roles are granted to the proper people at the project
level. Alternatively, your Google Cloud administrator can
<a href="/iam/docs/creating-custom-roles">create custom roles</a> that only have the
relevant permissions.</p>
<table>
<thead>
<tr>
<th>Purpose</th>
<th>Predefined role</th>
<th>Relevant permissions</th>
</tr>
</thead>
<tbody>
<tr>
<td id="permissions-to-configure-project">Configure and view data profiles</td>
<td>DLP Administrator (<code dir="ltr" translate="no">roles/dlp.admin</code>)
</td>
<td><ul><li>dlp.inspectTemplates.create</li>
<li>dlp.jobs.create</li>
<li>dlp.jobTriggers.create</li>
<li>dlp.columnDataProfiles.list</li>
<li>dlp.jobs.list</li>
<li>dlp.jobTriggers.list</li>
<li>dlp.projectDataProfiles.list</li>
<li>dlp.tableDataProfiles.list</li>
</ul>
</td>
</tr>
<tr>
<td id="permissions-to-view-configs-profiles-project" rowspan="2">View data profiles (read-only)</td>
<td>DLP Data Profiles Reader (<code dir="ltr" translate="no">roles/dlp.dataProfilesReader</code>)</td>
<td><ul><li>dlp.columnDataProfiles.list</li>
<li>dlp.projectDataProfiles.list</li>
<li>dlp.tableDataProfiles.list</li>
</ul>
</td>
</tr>
<tr>
<td>DLP Reader (<code dir="ltr" translate="no">roles/dlp.reader</code>)</td>
<td><ul><li>dlp.jobs.list</li>
<li>dlp.jobTriggers.list</li>
</ul>
</td>
</tr>
</tbody>
</table>
<h2 data-text="Scan configuration" id="scan-configuration">Scan configuration</h2>
<p>A <em>scan configuration</em> or <em>data profile configuration</em> specifies which
<a href="/resource-manager/docs/cloud-platform-resource-hierarchy">resource</a> (an
organization, folder, or project)
to scan, which inspection template to use, and what to do with the results.
It also contains administrative details like which service agent container
to associate the scan to and which billing account to use.</p>
<p>You can create a scan configuration for your organization and another one for a
particular folder. If two or more
active scan configurations have the same project in their scope,
Cloud DLP <a href="/dlp/docs/data-profiles#overriding-scan-configs">determines</a> which scan configuration
can generate profiles for that project.</p>
<p>You can also create a scan configuration at the project level. This type of
scan configuration can always profile the target project and does not compete
with other configurations at the level of the parent folder or organization.</p>
<p>The first time you create a scan configuration, you specify where you want
Cloud DLP to store it. All subsequent scan
configurations that you create are stored in that same region.</p>
<p>For example, if you create a scan configuration for Folder A and store it in the
<code dir="ltr" translate="no">us-west1</code> region, then any scan configuration that you later create for any
other resource is also stored in that region.</p>
<aside class="note"><strong>Note:</strong><span> Regardless of where you choose to store your scan configurations, your
BigQuery tables are not moved or copied to that location. For
more information, see <a href="/dlp/docs/data-profiles#data-residency">Data residency considerations</a>.</span></aside>
<h2 data-text="Inspection template" id="inspection-template">Inspection template</h2>
<p>An <em>inspection template</em> specifies what information
types (or <em>infoTypes</em>) Cloud DLP looks for while scanning
your data. Here, you provide a combination of <a href="/dlp/docs/infotypes-reference">built-in infoTypes</a>
and optional <a href="/dlp/docs/creating-custom-infotypes">custom infoTypes</a>.</p>
<p>You can also provide a <a href="/dlp/docs/likelihood">likelihood</a> level to
narrow down what Cloud DLP considers to be a match. You can
add rule sets to exclude unwanted findings or include additional findings.</p>
<p>If you change an inspection template that your scan configuration
uses, the changes are applied only to future scans. Any existing data profiles
are not overwritten. For example, if you edit your template to add an infoType,
the change only affects tables that have yet to be scanned. Your action doesn't
cause a rescan of all existing tables.</p>
<p><aside class="special"><strong>Note:</strong>
We regularly improve our detection algorithm. If we find that
your organization would benefit from a new improvement that we implement, we might
automatically regenerate your data profiles. We perform this operation at no charge.
</aside>
</p>
<p>The inspection template must be in the same region as the data that to be profiled.
If you have data in multiple regions, use an inspection template that is stored
in the <code dir="ltr" translate="no">global</code> region. For more information, see <a href="/dlp/docs/data-profiles#data-residency">Data residency considerations</a>.</p>
<p>Inspection templates are a core component of the Cloud DLP platform.
Data profiles use the same inspection templates that you can use across all
Cloud DLP services. For more information on inspection templates,
see <a href="/dlp/docs/concepts-templates">Templates</a>.</p>
<h2 data-text="Service agent container and service agent" id="service-agent-container">Service agent container and service agent</h2>
<p>When you create a scan configuration for your organization or for a folder,
Cloud DLP
requires you to provide a service agent container. A <em>service agent container</em>
is a Google Cloud project that Cloud DLP uses to track
billed charges related to organization- and folder-level profiling operations.</p>
<p>The service agent container contains a <em>service agent</em>, which is a
<a href="/iam/docs/service-accounts#google-managed">Google-managed service account</a>
that Cloud DLP uses to profile data on your behalf.
You need a service agent to authenticate to Cloud DLP and other APIs.
Your service agent must have all the required permissions to access and profile
your data. The service agent's ID is in the following format:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">service-<var translate="no">PROJECT_NUMBER</var>@dlp-api.iam.gserviceaccount.com
</code></pre>
<p>Here, the <var translate="no">PROJECT_NUMBER</var> is the numerical identifier of the service
agent container.</p>
<p>When setting the service agent container, you can choose an existing project.
If the project you select contains a service agent, Cloud DLP
grants the required IAM permissions
to that service agent. If the project doesn't have a service agent,
Cloud DLP creates one and automatically grants data profiling
permissions to it.</p>
<p>Alternatively, you can choose to have Cloud DLP
automatically create the service agent container and service agent.
Cloud DLP automatically grants data profiling permissions to the
service agent.</p>
<p>In both cases, if Cloud DLP fails to grant data profiling
access to your service agent, it shows an
<a href="/dlp/docs/troubleshoot-data-profiles#data-profiling-access">error</a>
when you <a href="/dlp/docs/manage-scan-configurations#view-config">view the scan configuration details</a>.</p>
<p>For project-level scan configurations, you don't need a service agent
container. The project you're profiling serves the service agent
container's purpose. To run profiling operations, Cloud DLP uses
that project's own service agent.</p>
<h2 data-text="Data profiling access at the organization or folder level" id="grant-roles">Data profiling access at the organization or folder level</h2>
<p>When you <a href="/dlp/docs/profile-org-folder">configure profiling</a>
at the organization or folder level, Cloud DLP attempts to automatically
grant data profiling access to your service agent. However, if you don't
have the <a href="/dlp/docs/data-profiles#permissions-to-grant-profiling-access">permissions to grant IAM roles</a>, Cloud DLP
can't do this action on your behalf. Someone with those permissions in your
organization, such as a Google Cloud admin, must <a href="/dlp/docs/grant-data-profiling-access">grant data profiling access
to your service agent</a>.</p>
<h2 data-text="Default frequency of data profile generation" id="scan-frequency">Default frequency of data profile generation</h2>
<p>By default, Cloud DLP profiles your data as follows:</p>
<ol>
<li><p>After you create a scan configuration for a particular resource,
Cloud DLP performs an initial scan, profiling all tables in that
resource. After the initial scan, it continuously monitors your
BigQuery tables for any additions or changes you introduce.</p></li>
<li><p>Cloud DLP profiles new tables you add shortly after you add
them.</p></li>
<li><p>Every 30 days, Cloud DLP reprofiles existing tables that
underwent schema changes within the last 30 days.</p></li>
</ol>
<p>However, in your scan configuration, you can customize the profiling frequency
by creating one or more schedules for different subsets of your data. You can
also specify subsets of data that you never want to be profiled. For more
information, see
<a href="/dlp/docs/profile-org-folder#manage-schedules">Manage schedules</a> in the
instructions for configuring profiling.</p>
<p>By default, Cloud DLP doesn't reprofile tables that have no schema
changes. If you want Cloud DLP to reprofile
existing tables, you can <a href="/dlp/docs/data-profiles#getting-support">send a request</a>.</p>
<p>For example scenarios, see <a href="https://cloud.google.com/dlp/pricing#dp-pricing-examples">Data profiling pricing examples</a>.</p>
<p><aside class="special"><strong>Note:</strong>
We regularly improve our detection algorithm. If we find that
your organization would benefit from a new improvement that we implement, we might
automatically regenerate your data profiles. We perform this operation at no charge.
</aside>
</p>
<h2 data-text="Profiling performance" id="performance">Profiling performance</h2>
<p>The time it takes to profile your data varies depending on several factors,
including, but not limited to, the following:</p>
<ul>
<li>Number of tables being profiled</li>
<li>Sizes of the tables</li>
<li>Number of columns in the tables</li>
<li>Data types in the columns</li>
</ul>
<p>Therefore,
Cloud DLP's performance in a past inspection or profiling task
isn't indicative of how it will perform in future profiling tasks.</p>
<h2 data-text="Retention of data profiles" id="retention">Retention of data profiles</h2>
<p>Cloud DLP retains the latest version of a data profile for
13 months. When Cloud DLP reprofiles an updated table, it replaces
that table's existing data profiles with new ones.</p>
<p>Consider the following scenarios:</p>
<ul>
<li><p>On January 1, Cloud DLP profiles Table A. Table A does not
change in over a year, and so it's not profiled again. In this case,
Cloud DLP retains the data profiles for Table A for 13 months
before deleting them.</p></li>
<li><p>On January 1, Cloud DLP profiles Table A. Within the month,
someone in your organization updates the schema of that table. Because of this change, the
following month, Cloud DLP automatically reprofiles Table A.
The newly generated data profiles overwrite the ones that were created in
January.</p></li>
</ul>
<p>For information on how Cloud DLP charges for profiling new and
modified tables, see <a href="https://cloud.google.com/dlp/pricing#data_profiling">Data profiling pricing</a>.</p>
<p>If you want to retain data profiles indefinitely or keep a record of the
changes they undergo, consider saving the data profiles to
BigQuery when you
<a href="/dlp/docs/profile-org-folder">configure profiling</a>. You choose which
BigQuery dataset to save the profiles to, and you control the
table expiration policy for that dataset.</p>
<h2 data-text="Overriding scan configurations" id="overriding-scan-configs">Overriding scan configurations</h2>
<p>You can create a maximum of one scan configuration for each organization,
folder, and project.</p>
<p>If two or more active scan configurations have the same project in their scope,
the following rules apply:</p>
<ul>
<li>Among organization- and folder-level scan configurations, the one that is
closest to the project will be able to generate data profiles for that project.
This rule applies even if a project-level scan configuration for that
project also exists.</li>
<li>Cloud DLP treats project-level scan configurations independently
of organization- and folder-level configurations. A scan configuration that
you create at the project level can't override one that you create for a
parent folder or organization.</li>
</ul>
<p>Consider the following example, where there are three active scan configurations:</p>
<p><figure style="text-align: center">
<a href="/dlp/docs/images/resource-hierarchy-with-config_2x.png">
<img alt="Diagram of a resource hierarchy with a scan configuration applied
              to an organization, a folder, and a project" src="/dlp/docs/images/resource-hierarchy-with-config_1x.png">
</img></a></figure></p>
<p>Here, <strong>Scan configuration 1</strong> applies to the entire organization,
<strong>Scan configuration 2</strong> applies to the <strong>Team B</strong> folder, and <strong>Scan
configuration 3</strong> applies to the <strong>Production</strong> project. In this example:</p>
<ul>
<li>Cloud DLP profiles all tables in projects that aren't in
the <strong>Team B</strong> folder according to <strong>Scan configuration 1</strong>.</li>
<li>Cloud DLP profiles all tables in projects in the <strong>Team B</strong>
folderâincluding tables in the <strong>Production</strong> projectâaccording
to <strong>Scan configuration 2</strong>.</li>
<li>Cloud DLP profiles all tables in the <strong>Production</strong> project
according to <strong>Scan configuration 3</strong>.</li>
</ul>
<p>In this example, Cloud DLP effectively generates two sets of
profiles for the <strong>Production</strong> projectâone set for each of the following scan
configurations:</p>
<ul>
<li>Scan configuration 2</li>
<li>Scan configuration 3</li>
</ul>
<p>However, even though there are two sets of profiles for the same project, you
don't see them all together in your dashboard. You only see the profiles that
were generated in the purview and region that you're currently viewing.</p>
<p>For more information on Google Cloud's resource hierarchy, see
<a href="/resource-manager/docs/cloud-platform-resource-hierarchy">Resource hierarchy</a>.</p>
<h2 data-text="Data profile snapshots" id="data-profile-snapshots">Data profile snapshots</h2>
<p>Each data profile includes a snapshot of the scan configuration and the
inspection template that were used to generate it. You can use this snapshot to
check the settings that you used to generate a particular data profile.</p>
<h2 data-text="Data residency considerations" id="data-residency">Data residency considerations</h2>
<p>Cloud DLP is designed to support <a href="/assured-workloads/docs/concept-data-residency">data residency</a>. If you must comply
with data residency requirements, consider the following points:</p>
<h3 data-text="Inspection regions" id="inspection_regions">Inspection regions</h3>
<p>Cloud DLP inspects your data
in the same region where that data is stored. That is, your
BigQuery data doesn't leave its current region.</p>
<p>Furthermore, an inspection template can only be used to profile data that
resides in the same region as that template. For example, if you configure the
data profiler to use an inspection template that is stored in the <code dir="ltr" translate="no">us-west1</code>
region, Cloud DLP can only profile data in that region.</p>
<p>You can
<a href="/dlp/docs/profile-org-folder#select-inspection-template">set a dedicated inspection template</a>
for each region where you have data.
If you provide an inspection template that's stored in the <code dir="ltr" translate="no">global</code> region,
Cloud DLP uses that template for data in regions with no
dedicated inspection template.</p>
<aside class="note"><strong>Note:</strong><span> If you don't include an inspection template that's stored in the
<code dir="ltr" translate="no">global</code> region, Cloud DLP can't profile tables in regions that
don't have a dedicated inspection template. For those tables,
profiling fails with an error.</span></aside>
<p>The following table provides example scenarios:</p>
<table>
<thead>
<tr>
<th>Scenario</th>
<th>Support</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scan data in the <code dir="ltr" translate="no">us</code> region using an inspection template from
  the <code dir="ltr" translate="no">us</code> region.</td>
<td>Supported</td>
</tr>
<tr>
<td>Scan data in the <code dir="ltr" translate="no">global</code> region using an inspection template
  from the <code dir="ltr" translate="no">us</code> region.</td>
<td>Not supported</td>
</tr>
<tr>
<td>Scan data in the <code dir="ltr" translate="no">us</code> region using an inspection template from
  the <code dir="ltr" translate="no">global</code> region.</td>
<td>Supported</td>
</tr>
<tr>
<td>Scan data in the <code dir="ltr" translate="no">us</code> region using an inspection template from
    the <code dir="ltr" translate="no">us-east1</code> region.</td>
<td>Not supported</td>
</tr>
<tr>
<td>Scan data in the <code dir="ltr" translate="no">us-east1</code> region using an inspection template
  from the <code dir="ltr" translate="no">us</code> region.</td>
<td>Not supported</td>
</tr>
<tr>
<td>Scan data in the <code dir="ltr" translate="no">us</code> region using an inspection template from
  the <code dir="ltr" translate="no">asia</code> region.</td>
<td>Not supported</td>
</tr>
</tbody>
</table>
<h3 data-text="Data profile configuration" id="data_profile_configuration">Data profile configuration</h3>
<p>When Cloud DLP creates data profiles, it takes a snapshot of
your scan configuration and
inspection template and stores them in each <a href="/dlp/docs/metrics-reference#table-data-profile">table data profile</a>. If you configure
the data profiler to use an inspection template from the
<code dir="ltr" translate="no">global</code> region, then Cloud DLP copies that template to any
region that has data to be profiled. Similarly, it copies the scan configuration
to those regions.</p>
<p>Consider this example: Project A contains Table 1. Table 1 is
in the <code dir="ltr" translate="no">us-west1</code> region; the scan configuration is in the <code dir="ltr" translate="no">us-west2</code> region;
and the inspection template is in the <code dir="ltr" translate="no">global</code> region.</p>
<p>When Cloud DLP scans Project A, it creates data profiles for
Table 1 and stores them in the <code dir="ltr" translate="no">us-west1</code> region. Table 1's table data profile
contains copies of the scan configuration and the inspection template used in
the profiling operation.</p>
<p>If you don't want your inspection template to be copied to other regions,
don't configure Cloud DLP to scan data in those regions.</p>
<h3 data-text="Regional storage of data profiles" id="regional_storage_of_data_profiles">Regional storage of data profiles</h3>
<p>After inspecting your data, Cloud DLP
generates data profiles. It stores each data profile in the same region where
its target data is stored, which is also where inspection is processed.
To <a href="/dlp/docs/view-data-profiles">view data profiles</a> in your dashboard, you must
first select the region where they reside. If you have data in multiple
regions, then you must switch regions to view each set of profiles.</p>
<aside class="note"><strong>Note:</strong><span> If you want a centralized view of all your data profiles, then
turn on the <strong>Save data profile copies to BigQuery</strong> option in
your <a href="/dlp/docs/profile-org-folder">scan configuration</a>.
There, you specify a single BigQuery
dataset to store your profiles. You can then query them all together. In this
case, the data profiles from various regions are stored together in one
BigQuery dataset, in the region where that dataset resides.</span></aside>
<h3 data-text="Unsupported regions" id="unsupported_regions">Unsupported regions</h3>
<p>If you have tables in a <a href="/dlp/docs/locations">region</a> that Cloud DLP
doesn't support, then it skips those tables and shows an error when you
<a href="/dlp/docs/view-data-profiles">view the data profiles</a>.</p>
<h3 data-text="Multi-regions" id="multi-regions">Multi-regions</h3>
<p>Cloud DLP treats a <a href="/dlp/docs/locations#multi-regions">multi-region</a> as one
region, and not a collection of regions. For example, the <code dir="ltr" translate="no">us</code> multi-region
and the <code dir="ltr" translate="no">us-west1</code> region are treated as two separate regions as far as data
residency is concerned.</p>
<h2 data-text="Compliance" id="compliance">Compliance</h2>
<p>For information on how Cloud DLP handles your data and helps you
meet compliance requirements, see <a href="/dlp/docs/support/data-security">Data security</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn how to profile data at the <a href="/dlp/docs/profile-org-folder">organization</a>,
<a href="/dlp/docs/profile-org-folder">folder</a>, or <a href="/dlp/docs/profile-project">project</a>
level.</li>
<li><p>Learn about how Cloud DLP <a href="/dlp/docs/sensitivity-risk-calculation">calculates the data risk and
sensitivity levels of your tables and columns</a>.</p></li>
<li><p>Learn how to <a href="/dlp/docs/data-profiles-remediation">remediate the data profiler's findings</a>.</p></li>
<li><p>Learn how to <a href="/dlp/docs/troubleshoot-data-profiles">troubleshoot issues with the data profiler</a>.</p></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/metrics-reference]</H1></p><div class="devsite-article-body clearfix">
<p>This page lists and describes all metrics that are gathered in data profiles.</p>
<p>There are three types of data profilesâ<a href="/dlp/docs/metrics-reference#project-data-profile">project data profiles</a>, <a href="/dlp/docs/metrics-reference#table-data-profile">table data profiles</a>, and
<a href="/dlp/docs/metrics-reference#column-data-profile">column data profiles</a>.</p>
<h3 data-text="Project data profiles" id="project-data-profile">Project data profiles</h3>
<p>Each project data profile has the following fields. The values for these
fields are aggregated based on the resources profiled within the project.</p>
<dl>
<dt>Data risk</dt>
<dd>Level of risk associated with the data at its current state. For more
information, see <a href="/dlp/docs/sensitivity-risk-calculation">Sensitivity and data risk levels</a>.</dd>
<dt>Last profile generated</dt>
<dd>Date and time the profile was last generated.</dd>
<dt>Project ID</dt>
<dd>ID of the project that was profiled.</dd>
<dt>Resource name</dt>
<dd>Fully qualified name of the data profile.</dd>
<dt>Sensitivity</dt>
<dd>Score indicating the sensitivity level for this project. For more information,
see <a href="/dlp/docs/sensitivity-risk-calculation">Sensitivity and data risk levels</a>.</dd>
<dt>Status</dt>
<dd>Icon that indicates the status of the profiling operation.</dd>
</dl>
<h3 data-text="Table data profiles" id="table-data-profile">Table data profiles</h3>
<p>Each table data profile has the following fields:</p>
<dl>
<dt>Data risk</dt>
<dd>Level of risk associated with the data at its current state. For more
information, see <a href="/dlp/docs/sensitivity-risk-calculation">Sensitivity and data risk levels</a>.</dd>
<dt>Dataset ID</dt>
<dd>ID of the dataset that contains this table.</dd>
<dt>Encryption</dt>
<dd>Whether encryption for this table is managed by Google or by your
organization.</dd>
<dt>Expiration time</dt>
<dd>Optional. The time when this table expires.</dd>
<dt>Failed column count</dt>
<dd>The number of columns skipped in this table because of an error.</dd>
<dt>Group user</dt>
<dd>Number of groups with Identity and Access Management (IAM) permissions to access this table.</dd>
<dt>Individual user</dt>
<dd>Number of users with IAM permissions to access
this table.</dd>
<dt>Inspect config snapshot</dt>
<dd>Snapshot of the <a href="/dlp/docs/data-profiles#inspection-template">inspection template</a>
that was used when the profile was generated. For more information, see
<a href="/dlp/docs/data-profiles#data-profile-snapshots">Data profile snapshots</a>.</dd>
<dt>Last profile generated</dt>
<dd>Date and time the profile was last generated.</dd>
<dt>Latest update in BigQuery</dt>
<dd>Date and time this table was last modified.</dd>
<dt>Project ID</dt>
<dd>ID of the project that contains this table.</dd>
<dt>Public</dt>
<dd>Whether this table is available to all users or restricted to certain users.</dd>
<dt>Resource labels</dt>
<dd><a href="/bigquery/docs/labels-intro">Labels</a> that the table had at the time the
profile was generated.</dd>
<dt>Resource name</dt>
<dd>Fully qualified name of the data profile.</dd>
<dt>Row count</dt>
<dd>Number of rows in this table when the profile was generated.</dd>
<dt>Scanned column count</dt>
<dd>The number of columns profiled in this table.</dd>
<dt>Sensitivity</dt>
<dd>Score indicating the sensitivity level for this table.
For more information, see <a href="/dlp/docs/sensitivity-risk-calculation">Sensitivity and data risk levels</a>.</dd>
<dt>Service account</dt>
<dd>Number of service accounts with IAM permissions to access this
table.</dd>
<dt>Status</dt>
<dd>Icon that indicates the status of the profiling operation.</dd>
<dt>Table ID</dt>
<dd>ID of this table.</dd>
<dt>Table creation time</dt>
<dd>Date and time the table was created.</dd>
<dt>Table size</dt>
<dd>The size of this table when the profile was generated.</dd>
</dl>
<h3 data-text="Column data profiles" id="column-data-profile">Column data profiles</h3>
<p>Each column data profile has the following fields:</p>
<dl>
<dt>Data risk</dt>
<dd>Level of risk associated with the data at its current state. For more
information, see <a href="/dlp/docs/sensitivity-risk-calculation">Sensitivity and data risk levels</a>.</dd>
<dt>Data type</dt>
<dd>The data type of the contents of this column.</dd>
<dt>Dataset ID</dt>
<dd>ID of the dataset that contains this table column.</dd>
<dt>Field ID</dt>
<dd>Name of the column.</dd>
<dt id="free-text-score">Free text score</dt>
<dd><p>The probability that this column contains freeform text. A value close to 1
indicates the column is likely to contain freeform or natural-language text.
Possible values range from 0 through 1.</p>
<p>A high free text score can increase a column's <a href="/dlp/docs/sensitivity-risk-calculation">data risk and sensitivity
levels</a>.</p></dd>
<dt>Last profile generated</dt>
<dd><p>Date and time the profile was last generated.</p></dd>
<dt>Other infoTypes</dt>
<dd><p>The infoTypes that Cloud DLP detected in the column. See also
<em>Predicted infoType</em>.</p></dd>
<dt>Policy tags</dt>
<dd><p>Indicates if a policy tag is applied to the column. For information on
best practices for using policy tags, see <a href="/bigquery/docs/best-practices-policy-tags">Using policy tags in
BigQuery</a>.</p></dd>
<dt>Predicted infoType</dt>
<dd><p>If Cloud DLP determines that a single <a href="/dlp/docs/infotypes-reference">built-in</a> or <a href="/dlp/docs/concepts-infotypes#custom">custom</a>
infoType clearly predominates over others in this column, then it sets this
field to that infoType. Otherwise, Cloud DLP shows <strong>Mixed</strong>. To
view a list of all infoTypes detected in the column, refer to the
<strong>Other infoTypes</strong> field.</p>
<p>Only the infoTypes that you specified in your <a href="/dlp/docs/data-profiles#inspection-template">inspection template</a> can appear here. For
example, if the column has email addresses, but you didn't include the
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoType detector in your inspection template, then
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> doesn't appear here.</p></dd>
<dt>Project ID</dt>
<dd><p>ID of the project that contains this table column.</p></dd>
<dt>Resource name</dt>
<dd><p>Fully qualified name of the data profile.</p></dd>
<dt>Sensitivity</dt>
<dd><p>Score indicating the sensitivity level for this column. For more information,
see <a href="/dlp/docs/sensitivity-risk-calculation">Sensitivity and data risk levels</a>.</p></dd>
<dt>Status</dt>
<dd><p>Icon that indicates the status of the profiling operation.</p></dd>
<dt>Table ID</dt>
<dd><p>ID of the table that contains this column.</p></dd>
</dl>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/sensitivity-risk-calculation]</H1></p><div class="devsite-article-body clearfix">
<p>This page describes the data risk and sensitivity levels that Cloud Data Loss Prevention
assigns to <a href="/dlp/docs/data-profiles">data profiles</a>. To understand the data risk levels,
it's important to understand the sensitivity levels first.</p>
<aside class="note"><strong>Note:</strong><span> When generating data profiles, Cloud Data Loss Prevention scans for only the infoTypes
that you specify in your <a href="/dlp/docs/data-profiles#inspection-template">inspection template</a>. For example, suppose credit card
numbers are present in a column. If the <code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code> infoType isn't
listed in your inspection template, then the resulting sensitivity and data risk
levels for that column don't reflect the presence of credit card numbers.</span></aside>
<h2 data-text="Sensitivity level" id="sensitivity-level">Sensitivity level</h2>
<p><em>Sensitivity level</em> is an indication of how sensitive the data in a project,
table, or column is. Data is sensitive if it contains detected elements,
such as personally identifiable information (PII), financial
data, and credentials.</p>
<p>A data profile can have any of the following sensitivity levels:</p>
<dl>
<dt id="high-sensitivity">High</dt>
<dd><a href="/dlp/docs/high-sensitivity-infotypes-reference">Highly sensitive personal information</a>
might be present, including credit card numbers
and certain national identifiers.</dd>
<dt id="moderate-sensitivity">Moderate</dt>
<dd>Sensitive information that is not classified as highly sensitive might be
present. Examples are email addresses, phone numbers, and <a href="/dlp/docs/concepts-infotypes#custom">custom infoTypes</a>, which can be considered personally
identifiable. The data might also include freeform text or unstructured data,
such as comments.</dd>
<dt>Low</dt>
<dd>Sensitive information was not detected.</dd>
</dl>
<h2 data-text="Data risk level" id="data-risk">Data risk level</h2>
<p><em>Data risk level</em> is the risk associated with the data in its current state. It
considers the sensitivity level of the data in the resource and the presence of
access controls to protect that data.</p>
<dl>
<dt>High</dt>
<dd><a href="/dlp/docs/sensitivity-risk-calculation#high-sensitivity">High-sensitivity data</a>
might be present, and there are no column-level access controls to restrict data
exposure. Alternatively, moderate or high-sensitivity data is accessible to a
wide number of people.</dd>
<dt>Moderate</dt>
<dd><a href="/dlp/docs/sensitivity-risk-calculation#moderate-sensitivity">Moderate-sensitivity data</a>
might be present, and there are no column-level access controls to restrict data
exposure.</dd>
<dt>Low</dt>
<dd>The sensitivity level of the data is low. Alternatively, access to the data
has been further restricted, for example, through column-level access controls.</dd>
</dl>
<h2 data-text="Sensitivity calculation" id="sensitivity_calculation">Sensitivity calculation</h2>
<p>To calculate sensitivity, Cloud DLP considers the following:</p>
<ul>
<li>The  <a href="/dlp/docs/likelihood">likelihood</a> that
<a href="/dlp/docs/high-sensitivity-infotypes-reference">highly sensitive infoTypes</a>
are present.</li>
<li>Whether the data has an unstructured format and contains mostly freeform
text, like comments.</li>
</ul>
<h2 data-text="Data risk calculation" id="data_risk_calculation">Data risk calculation</h2>
<p>To calculate data risk, Cloud DLP considers the following:</p>
<ul>
<li>The calculated sensitivity level of the data.</li>
<li>The presence of access controls that limit access to the data.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/high-sensitivity-infotypes-reference]</H1></p><div class="devsite-article-body clearfix">
<p>This page lists built-in infoType detectors for highly sensitive data.
This list is a subset of the
<a href="/dlp/docs/infotypes-reference">built-in infoTypes reference</a>.</p>
<ul>
<li>ARGENTINA_DNI_NUMBER</li>
<li>AUSTRALIA_MEDICARE_NUMBER</li>
<li>AUSTRALIA_PASSPORT</li>
<li>AUSTRALIA_TAX_FILE_NUMBER</li>
<li>AUTH_TOKEN</li>
<li>AWS_CREDENTIALS</li>
<li>AZURE_AUTH_TOKEN</li>
<li>BELGIUM_NATIONAL_ID_CARD_NUMBER</li>
<li>BRAZIL_CPF_NUMBER</li>
<li>CANADA_BANK_ACCOUNT</li>
<li>CANADA_BC_PHN</li>
<li>CANADA_DRIVERS_LICENSE_NUMBER</li>
<li>CANADA_OHIP</li>
<li>CANADA_PASSPORT</li>
<li>CANADA_QUEBEC_HIN</li>
<li>CANADA_SOCIAL_INSURANCE_NUMBER</li>
<li>CHILE_CDI_NUMBER</li>
<li>CHINA_PASSPORT</li>
<li>CHINA_RESIDENT_ID_NUMBER</li>
<li>COLOMBIA_CDC_NUMBER</li>
<li>CREDIT_CARD_NUMBER</li>
<li>CREDIT_CARD_TRACK_NUMBER</li>
<li>DENMARK_CPR_NUMBER</li>
<li>ENCRYPTION_KEY</li>
<li>FINLAND_NATIONAL_ID_NUMBER</li>
<li>FRANCE_CNI</li>
<li>FRANCE_NIR</li>
<li>FRANCE_PASSPORT</li>
<li>FRANCE_TAX_IDENTIFICATION_NUMBER</li>
<li>GCP_API_KEY</li>
<li>GCP_CREDENTIALS</li>
<li>GERMANY_DRIVERS_LICENSE_NUMBER</li>
<li>GERMANY_IDENTITY_CARD_NUMBER</li>
<li>GERMANY_PASSPORT</li>
<li>GERMANY_SCHUFA_ID</li>
<li>GERMANY_TAXPAYER_IDENTIFICATION_NUMBER</li>
<li>HONG_KONG_ID_NUMBER</li>
<li>IMEI_HARDWARE_ID</li>
<li>INDIA_AADHAAR_INDIVIDUAL</li>
<li>INDIA_GST_INDIVIDUAL</li>
<li>INDIA_PAN_INDIVIDUAL</li>
<li>INDONESIA_NIK_NUMBER</li>
<li>IRELAND_DRIVING_LICENSE_NUMBER</li>
<li>IRELAND_EIRCODE</li>
<li>IRELAND_PASSPORT</li>
<li>IRELAND_PPSN</li>
<li>ISRAEL_IDENTITY_CARD_NUMBER</li>
<li>ITALY_FISCAL_CODE</li>
<li>JAPAN_BANK_ACCOUNT</li>
<li>JAPAN_DRIVERS_LICENSE_NUMBER</li>
<li>JAPAN_INDIVIDUAL_NUMBER</li>
<li>JAPAN_PASSPORT</li>
<li>KOREA_PASSPORT</li>
<li>KOREA_RRN</li>
<li>MEXICO_CURP_NUMBER</li>
<li>MEXICO_PASSPORT</li>
<li>NETHERLANDS_BSN_NUMBER</li>
<li>NETHERLANDS_PASSPORT</li>
<li>NORWAY_NI_NUMBER</li>
<li>PARAGUAY_CIC_NUMBER</li>
<li>PASSPORT</li>
<li>PERU_DNI_NUMBER</li>
<li>POLAND_NATIONAL_ID_NUMBER</li>
<li>POLAND_PASSPORT</li>
<li>POLAND_PESEL_NUMBER</li>
<li>PORTUGAL_CDC_NUMBER</li>
<li>SCOTLAND_COMMUNITY_HEALTH_INDEX_NUMBER</li>
<li>SINGAPORE_NATIONAL_REGISTRATION_ID_NUMBER</li>
<li>SINGAPORE_PASSPORT</li>
<li>SPAIN_CIF_NUMBER</li>
<li>SPAIN_DNI_NUMBER</li>
<li>SPAIN_DRIVERS_LICENSE_NUMBER</li>
<li>SPAIN_NIE_NUMBER</li>
<li>SPAIN_NIF_NUMBER</li>
<li>SPAIN_PASSPORT</li>
<li>SPAIN_SOCIAL_SECURITY_NUMBER</li>
<li>SWEDEN_NATIONAL_ID_NUMBER</li>
<li>SWEDEN_PASSPORT</li>
<li>TAIWAN_PASSPORT</li>
<li>THAILAND_NATIONAL_ID_NUMBER</li>
<li>TURKEY_ID_NUMBER</li>
<li>UK_DRIVERS_LICENSE_NUMBER</li>
<li>UK_NATIONAL_HEALTH_SERVICE_NUMBER</li>
<li>UK_NATIONAL_INSURANCE_NUMBER</li>
<li>UK_PASSPORT</li>
<li>UK_TAXPAYER_REFERENCE</li>
<li>URUGUAY_CDI_NUMBER</li>
<li>US_ADOPTION_TAXPAYER_IDENTIFICATION_NUMBER</li>
<li>US_DEA_NUMBER</li>
<li>US_DRIVERS_LICENSE_NUMBER</li>
<li>US_EMPLOYER_IDENTIFICATION_NUMBER</li>
<li>US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</li>
<li>US_PASSPORT</li>
<li>US_PREPARER_TAXPAYER_IDENTIFICATION_NUMBER</li>
<li>US_SOCIAL_SECURITY_NUMBER</li>
<li>VENEZUELA_CDI_NUMBER</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/classification-redaction]</H1></p><div class="devsite-article-body clearfix">
<p>The Cloud Data Loss Prevention helps you understand, manage, and protect sensitive data.
With the Cloud DLP, you can easily classify and redact sensitive
data contained in text-based content and images, including content stored in
Google Cloud storage repositories.</p>
<h2 data-text="Text classification" id="text_classification">Text classification</h2>
<p>Given the following text input:</p>
<pre dir="ltr" translate="no">Please update my records with the following information:
Email address: foo@example.com

National Provider Identifier: 1245319599

Driver's license: AC333991</pre>
<p>The output is a list of findings, organized into the following categories:</p>
<ul>
<li><a href="/dlp/docs/infotypes-reference" title="InfoTypes Reference"><code dir="ltr" translate="no">InfoType</code></a></li>
<li><a href="/dlp/docs/likelihood" title="Likelihood Concept Page"><code dir="ltr" translate="no">Likelihood</code></a></li>
<li><code dir="ltr" translate="no">Offset</code> (Where in the string the potential <code dir="ltr" translate="no">InfoType</code> was found)</li>
</ul>
<p>Example output is shown in the table below.</p>
<table>
<thead>
<tr>
<th><code dir="ltr" translate="no">InfoType</code></th>
<th><code dir="ltr" translate="no">Likelihood</code></th>
<th><code dir="ltr" translate="no">Offset</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">US_HEALTHCARE_NPI</code></td>
<td><code dir="ltr" translate="no">VERY_LIKELY</code></td>
<td><code dir="ltr" translate="no">122</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">EMAIL_ADDRESS</code></td>
<td><code dir="ltr" translate="no">LIKELY</code></td>
<td><code dir="ltr" translate="no">72</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_DRIVERS_LICENSE_NUMBER</code></td>
<td><code dir="ltr" translate="no">LIKELY</code></td>
<td><code dir="ltr" translate="no">155</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_BC_PHN</code></td>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td><code dir="ltr" translate="no">122</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UK_TAXPAYER_REFERENCE</code></td>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td><code dir="ltr" translate="no">122</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_PASSPORT</code></td>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td><code dir="ltr" translate="no">155</code></td>
</tr>
</tbody>
</table>
<h2 data-text="Automatic text redaction" id="automatic_text_redaction">Automatic text redaction</h2>
<p>Automatic redaction produces an output with sensitive data matches removed
instead of giving you a list of findings.</p>
<p>Example automation redaction input:</p>
<pre dir="ltr" translate="no">Please update my records with the following information:
Email address: foo@example.com

National Provider Identifier: 1245319599

Driver's license: AC333991</pre>
<p>Example output using a placeholder of "***":</p>
<pre dir="ltr" translate="no">Please update my records with the following information:
Email address: ***

National Provider Identifier: ***

Driver's license: ***</pre>
<h2 data-text="Image classification" id="image_classification">Image classification</h2>
<p>Cloud DLP uses Optical Character Recognition (OCR)
technology to recognize text prior to classification. Similar to text
classification, it returns findings, but it also adds a bounding box
where the text was found.</p>
<h2 data-text="Storage classification" id="storage_classification">Storage classification</h2>
<p>Storage classification scans data stored in Cloud Storage, Datastore,
and BigQuery. Instead of streaming data into Cloud DLP, you
specify in your request the storage location for the Cloud Storage
bucket, Datastore kind, or BigQuery table you
want Cloud DLP to scan.</p>
<p>When scanning files in Cloud Storage locations, Cloud DLP
supports scanning of binary, text, image, Microsoft Word, Microsoft Excel,
Microsoft Powerpoint, PDF, and Apache Avro
files. A list of file extensions for the file types within Cloud Storage
that Cloud DLP can scan is available on the API reference page for
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#filetype"><code dir="ltr" translate="no">FileType</code></a>.
Files of types that are unrecognized are scanned as binary files.</p>
<p>The results of the scan can be either saved to a new BigQuery
table or published to a Pub/Sub topic. From there, you can use
built-in BigQuery tools to run rich SQL analytics or tools
such as Google Data Studio to generate reports.</p>
<p>For more information about scanning storage repositories for sensitive data
using Cloud DLP, see <a href="/dlp/docs/inspecting-storage">Inspecting storage and databases for
sensitive data</a>.</p>
<p>For more information about visualizing scan results using other Google Cloud
tools, see <a href="/dlp/docs/analyzing-and-reporting">Analyzing and reporting on Cloud DLP
findings</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-date-shifting]</H1></p><div class="devsite-article-body clearfix">
<p>Dates are a very common type of data. In cases where dates can be considered
sensitive data or personally identifiable information (PII), you may need to
generalize, obfuscate, or redact them.</p>
<p>One method for doing this is <a href="/dlp/docs/concepts-bucketing">generalization, or bucketing</a>.
Depending on the use case and configuration, though, bucketing can remove the
utility in the dates. For example, if you generalize all dates to just a year,
then you could lose the order in which events happen within that year. An
alternate method for obfuscating dates that addresses this problem is
<em>date shifting</em>.</p>
<p>Date shifting techniques randomly shift a set of dates but preserve the sequence
and duration of a period of time. Shifting dates is usually done in context to
an individual or an entity. That is, each individual's dates are shifted by
an amount of time that is unique to that individual.</p>
<h2 data-text="Date shifting example" id="date_shifting_example">Date shifting example</h2>
<p>Consider the following data:</p>
<table>
<thead>
<tr>
<th>user_id</th>
<th>date</th>
<th>action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2009-06-09</td>
<td>run</td>
</tr>
<tr>
<td>1</td>
<td>2009-06-03</td>
<td>walk</td>
</tr>
<tr>
<td>1</td>
<td>2009-05-23</td>
<td>crawl</td>
</tr>
<tr>
<td>2</td>
<td>2010-11-03</td>
<td>crawl</td>
</tr>
<tr>
<td>2</td>
<td>2010-11-22</td>
<td>walk</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>If you generalize these dates to year, then you get:</p>
<table>
<thead>
<tr>
<th>user_id</th>
<th>date_year</th>
<th>action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2009</td>
<td>run</td>
</tr>
<tr>
<td>1</td>
<td>2009</td>
<td>walk</td>
</tr>
<tr>
<td>1</td>
<td>2009</td>
<td>crawl</td>
</tr>
<tr>
<td>2</td>
<td>2010</td>
<td>crawl</td>
</tr>
<tr>
<td>2</td>
<td>2010</td>
<td>walk</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>But now you've lost any sense of the sequence per user.</p>
<p>Instead try date shifting:</p>
<table>
<thead>
<tr>
<th>user_id</th>
<th>date</th>
<th>action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2009-07-17</td>
<td>run</td>
</tr>
<tr>
<td>1</td>
<td>2009-07-11</td>
<td>walk</td>
</tr>
<tr>
<td>1</td>
<td>2009-06-30</td>
<td>crawl</td>
</tr>
<tr>
<td>2</td>
<td>2011-01-26</td>
<td>crawl</td>
</tr>
<tr>
<td>2</td>
<td>2011-02-14</td>
<td>walk</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Note how the dates are different but the sequence and duration are preserved.
The magnitude that the dates were shifted was different between <code dir="ltr" translate="no">user_id</code>s 1 and
2.</p>
<h2 data-text="Date shifting in Cloud DLP" id="date_shifting_in">Date shifting in Cloud DLP</h2>
<p>A JSON object to configure this for Cloud DLP's
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content.deidentify</code></a>
method follows:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">deidentify_config {
  record_transformations {
    field_transformations {
      fields {
        name: "date"
      }
      primitive_transformation {
        date_shift_config {
          upper_bound_days: 100
          lower_bound_days: -100
          entity_field_id {
            name: "user_id"
          }
          crypto_key {
            unwrapped {
              key: "123456789012345678901234567890ab"
            }
          }
        }
      }
    }
  }
}
</code></pre>
<p>The upper and lower bounds of the shift are specified by the <code dir="ltr" translate="no">upper_bound_days</code>
and <code dir="ltr" translate="no">lower_bound_days</code> values, respectively. The context or scope that that
shift will apply to is based on the <code dir="ltr" translate="no">entity_id_field</code> value, which in this case
is <code dir="ltr" translate="no">"user_id"</code>.</p>
<p>Note the use of a <code dir="ltr" translate="no">crypto_key</code> as well. This is similar to how it's
used in <a href="/dlp/docs/pseudonymization">pseudonymization</a>. The key will allow you
to keep integrity of these date shifts across multiple requests or data runs.</p>
<aside class="warning"><strong>Warning:</strong><span> For better security in production environments, use a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#kmswrappedcryptokey"><code dir="ltr" translate="no">KmsWrappedCryptoKey</code></a>
instead of an unwrapped key as illustrated in this example.</span></aside>
<h2 data-text="Resources" id="resources">Resources</h2>
<p>For more information about how to de-identify data using date shifting and
other methods in Cloud DLP, see:</p>
<ul>
<li><a href="/dlp/docs/deidentify-sensitive-data#infotype_transformations">De-identifying sensitive data in text content</a></li>
</ul>
<p>For API reference information about primitive transformations in
Cloud DLP, see:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>
object: The object in which you configure de-identification options.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#primitivetransformation"><code dir="ltr" translate="no">PrimitiveTransformations</code></a>
object: Date shifting is a "primitive transformation" in
Cloud DLP.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#dateshiftconfig"><code dir="ltr" translate="no">DateShiftConfig</code></a>
object: Object with which to configure the
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#primitivetransformation"><code dir="ltr" translate="no">PrimitiveTransformations</code></a>
object. By specifying the <code dir="ltr" translate="no">DateShiftConfig</code> object, you can shift dates
by a random number of days.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-bucketing]</H1></p><div class="devsite-article-body clearfix">
<p><em>Generalization</em> is the process of taking a distinguishing value and
abstracting it into a more general, less distinguishing value. Generalization
attempts to preserve data utility while also reducing the identifiability of
the data.</p>
<p>There can be many levels of generalization depending on the data type. How much
generalization is needed is something that you can measure across a dataset or a
real world population using techniques like those included in
<a href="/dlp/docs/compute-risk-analysis">Cloud Data Loss Prevention's risk analysis</a>.</p>
<p>One common generalization technique that Cloud DLP supports
is <em>bucketing</em>. With bucketing, you group records into smaller buckets in an
attempt to minimize the risk of an attacker associating sensitive information
with identifying information. Doing so can retain meaning and utility, but it
will also obscure the individual values that have too few participants.</p>
<h2 data-text="Bucketing scenario 1" id="bucketing_scenario_1">Bucketing scenario 1</h2>
<p>Consider this numerical bucketing scenario: A database stores users'
satisfaction scores, which range from 0 to 100. The database looks something
like the following:</p>
<table>
<thead>
<tr>
<th>user_id</th>
<th>score</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>100</td>
</tr>
<tr>
<td>2</td>
<td>100</td>
</tr>
<tr>
<td>3</td>
<td>92</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Scanning over the data, you realize that some values are rarely used by users.
In fact, there are a few scores that map to only one user. For example, the
majority of users pick either 0, 25, 50, 75, or 100. However, five users picked
95, and just one user picked 92. Instead of keeping the raw data, you could
generalize these values into groups and eliminate having any groups with too few
participants. Depending on how the data is used, generalizing data in this way
could help prevent re-identification.</p>
<p>You could choose to remove these rows of outlier data, or you could attempt to
preserve their utility by using bucketing. For this example, let's bucket all
values according to the following:</p>
<ul>
<li>0 to 25: "Low"</li>
<li>26-75: "Medium"</li>
<li>76-100: "High"</li>
</ul>
<p>Bucketing in Cloud DLP is one of many primitive
transformations available for de-identification. The following JSON
configuration illustrates how to implement this bucketing scenario in the
DLP API. This JSON could be included in a request to the
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content.deidentify</code></a>
method:</p>
<pre dir="ltr" translate="no">
...
{
  "primitiveTransformation":
  {
    "bucketingConfig":
    {
      "buckets":
      [
        {
          "min":
          {
            "integerValue": "0"
          },
          "max":
          {
            "integerValue": "25"
          },
          "replacementValue":
          {
            "stringValue": "Low"
          }
        },
        {
          "min":
          {
            "integerValue": "26"
          },
          "max":
          {
            "integerValue": "75"
          },
          "replacementValue":
          {
            "stringValue": "Medium"
          }
        },
        {
          "min":
          {
            "integerValue": "76"
          },
          "max":
          {
            "integerValue": "100"
          },
          "replacementValue":
          {
            "stringValue": "High"
          }
        }
      ]
    }
  }
}
...
</pre>
<h2 data-text="Bucketing scenario 2" id="bucketing_scenario_2">Bucketing scenario 2</h2>
<p>Bucketing can also be used on strings or enumerated values. Suppose you wanted
to share salary data and include job titles. However, some job titles, such as
CEO or distinguished engineer, can be linked to one person or a small group of
people. Such job titles are easily matched to the employees who hold them.</p>
<p>Bucketing can help here as well. Instead of including exact job titles,
generalize and bucket them. For example, "Senior Engineer," "Junior Engineer,"
and "Distinguished Engineer" become generalized and bucketed into simply
"Engineer." The following table illustrates bucketing specific job titles into
job title families.</p>
<p><img alt="Diagram illustrating bucketing of job titles" src="/dlp/docs/images/bucketing.png"/></p>
<h2 data-text="Other scenarios" id="other_scenarios">Other scenarios</h2>
<p>In these examples, we've applied the transformation to structured data. Bucketing
can also be used on unstructured examples, as long as the value can be
classified with a predefined or custom infoType. Below are some example
scenarios:</p>
<ul>
<li>Classify dates and bucket them into year ranges</li>
<li>Classify names and bucket them into groups based on the first letter
  (A-M, N-Z)</li>
</ul>
<h2 data-text="Resources" id="resources">Resources</h2>
<p>To learn more about generalization and bucketing, see
<a href="/dlp/docs/deidentify-sensitive-data#bucketingconfig">De-identifying Sensitive Data in Text Content</a>.</p>
<p>For API documentation, see:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">projects.content.deidentify</code> method</a></li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.BucketingConfig"><code dir="ltr" translate="no">BucketingConfig</code></a>
  transformation: Buckets values based on custom ranges.</li>
<li><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.BucketingConfig"><code dir="ltr" translate="no">FixedSizeBucketingConfig</code></a>
  transformation: Buckets values based on fixed size ranges.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/pseudonymization]</H1></p><div class="devsite-article-body clearfix">
<div class="video-wrapper">
<iframe allowfullscreen="" class="devsite-embedded-youtube-video" data-autohide="1" data-showinfo="0" data-video-id="h0BnA7R8vg4" frameborder="0">
</iframe>
</div>
<p><em>Pseudonymization</em> is a de-identification technique that replaces sensitive data
values with cryptographically generated <em>tokens</em>. Pseudonymization is widely
used in industries like finance and healthcare to help reduce the risk of data
in use, narrow compliance scope, and minimize the exposure of sensitive data
to systems while preserving data utility and accuracy.</p>
<p>Cloud DLP supports three pseudonymization techniques of
de-identification, and generates tokens by applying <a href="#supported-methods">one of three cryptographic
transformation methods</a> to original sensitive data values.
Each original sensitive value is then replaced with its corresponding token.
Pseudonymization is sometimes referred to as <em>tokenization</em> or <em>surrogate
replacement</em>.</p>
<p>Pseudonymization techniques enable either <em>one-way</em> or <em>two-way</em> tokens. A
one-way token has been transformed irreversibly, while a two-way token can be
reversed. Because the token is created using symmetric encryption, the same
cryptographic key that can generate new tokens can also reverse tokens. For
situations in which you don't need reversibility, you can use one-way tokens
that use secure hashing mechanisms.</p>
<p>It's helpful to understand how pseudonymization can help protect sensitive data
while allowing your business operations and analytical workflows easy access to
and use of the data they need. This topic explores the concept of
pseudonymization and the three cryptographic methods to transform data that
Cloud DLP supports.</p>
<p>For instructions on how to implement these pseudonymization methods and for more
examples of using Cloud DLP, see <a href="/dlp/docs/deidentify-sensitive-data">De-identifying sensitive
data</a>.</p>
<h2 data-text="Supported cryptographic methods in Cloud DLP" id="supported-methods">Supported cryptographic methods in Cloud DLP</h2>
<p>Cloud DLP supports three pseudonymization techniques, all of which
use cryptographic keys. Following are the available methods:</p>
<ul>
<li><strong>Deterministic encryption using AES-SIV:</strong> An input value is replaced with a
value that has been encrypted using the
<a class="external" href="https://tools.ietf.org/html/rfc5297">AES-SIV</a> encryption
algorithm with a cryptographic key, encoded using base64, and then prepended
with a surrogate annotation, if specified. This method produces a hashed
value, so it does not preserve the character set or the length of the input
value. Encrypted, hashed values can be re-identified using the original
cryptographic key and the entire output value, including surrogate annotation.
Learn more about <a href="#aes-siv">the format of values tokenized using AES-SIV
encryption</a>.</li>
<li><strong>Format preserving encryption:</strong> An input value is replaced with a value
that has been encrypted using the
<a class="external" href="https://en.wikipedia.org/wiki/Format-preserving_encryption">FPE-FFX</a> 
encryption algorithm with a cryptographic key, and then prepended with a
surrogate annotation, if specified. By design, both the character set and the
length of the input value are preserved in the output value. Encrypted values
can be re-identified using the original cryptographic key and the entire
output value, including surrogate annotation. (For some important
considerations around using this encryption method, see <a href="#fpe-ffx">Format preserving
encryption</a> later in this topic.)</li>
<li><strong>Cryptographic hashing:</strong> An input value is replaced with a value that has
been encrypted and hashed using <a class="external" href="https://tools.ietf.org/html/rfc4634">Hash-based Message Authentication Code
(HMAC)-Secure Hash Algorithm
(SHA)-256</a> on the
input value with a cryptographic key. The hashed output of the transformation
is always the same length and can't be re-identified. Learn more about <a href="#cryptographic-hashing">the
format of values tokenized using cryptographic
hashing</a>.</li>
</ul>
<p>These pseudonymization methods are summarized in the following table. Table
rows are explained following the table.</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>Deterministic encryption using AES-SIV</strong></th>
<th><strong>Format preserving encryption</strong></th>
<th><strong>Cryptographic hashing</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Encryption type</strong></td>
<td><a class="external" href="https://tools.ietf.org/html/rfc5297">AES-SIV</a></td>
<td><a class="external" href="https://en.wikipedia.org/wiki/Format-preserving_encryption">FPE-FFX</a></td>
<td><a class="external" href="https://tools.ietf.org/html/rfc4634">HMAC-SHA-256</a></td>
</tr>
<tr>
<td><strong>Supported input values</strong></td>
<td>At least 1 char long; no character set limitations.</td>
<td>At least 2 chars long; must be encoded as ASCII.</td>
<td>Must be a string or an integer value.</td>
</tr>
<tr>
<td><strong>Surrogate annotation</strong></td>
<td>Optional.</td>
<td>Optional.</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>Context tweak</strong></td>
<td>Optional.</td>
<td>Optional.</td>
<td>N/A</td>
</tr>
<tr>
<td><strong>Character set and length preserved</strong></td>
<td><span class="notranslate">â<span></span></span></td>
<td><span class="notranslate">â<span></span></span></td>
<td><span class="notranslate">â<span></span></span></td>
</tr>
<tr>
<td><strong>Reversible</strong></td>
<td><span class="notranslate">â<span></span></span></td>
<td><span class="notranslate">â<span></span></span></td>
<td><span class="notranslate">â<span></span></span></td>
</tr>
<tr>
<td><strong>Referential integrity</strong></td>
<td><span class="notranslate">â<span></span></span></td>
<td><span class="notranslate">â<span></span></span></td>
<td><span class="notranslate">â<span></span></span></td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Encryption type:</strong> The kind of encryption used in the de-identification
transformation.</li>
<li><strong>Supported input values:</strong> Minimum requirements for input values.</li>
<li><strong>Surrogate annotation:</strong> A user-specified annotation that is prepended to
encrypted values to provide context to users and to provide information for
Cloud DLP to use in the re-identification of a de-identified
value. A surrogate annotation is required for re-identification of
unstructured data. It is optional when transforming a column of structured, or
tabular, data with a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#recordtransformations"><code dir="ltr" translate="no">RecordTransformation</code></a>.</li>
<li><strong>Context tweak:</strong> A reference to a data field that "tweaks" the input value
so that identical input values can be de-identified to different output
values. The context tweak is optional when transforming a column of
structured, or tabular data, with a <code dir="ltr" translate="no">RecordTransformation</code>. To learn more,
see <a href="#context-tweaks">Using context tweaks</a>.</li>
<li><strong>Character set and length preserved:</strong> Whether a de-identified value is made
up of the same set of characters as the original value, and whether the length
of the de-identified value matches that of its original value.</li>
<li><strong>Reversible:</strong> Can be re-identified using the cryptographic key, surrogate
annotation, and any context tweak.</li>
<li><strong>Referential integrity:</strong> <a class="external" href="https://en.wikipedia.org/wiki/Referential_integrity">Referential
integrity</a> 
allows for records to maintain their relationship to one another even after
having their data individually de-identified. Given the same <a href="#using-crypto-keys">crypto
key</a> and <a href="#context-tweaks">context tweak</a>, a table of data
will be replaced with the same obfuscated form each time it is transformed,
which ensures that connections between values (and, with structured data,
records) are preserved, even across tables.</li>
</ul>
<h2 data-text="How tokenization works in Cloud DLP" id="how-tokenization-works">How tokenization works in Cloud DLP</h2>
<p>The basic process of tokenization is the same for all three methods that
Cloud DLP supports.</p>
<p><strong>Step 1: Cloud DLP selects data to tokenize.</strong> The most common way
to do this is to use a built-in or custom <a href="/dlp/docs/concepts-infotypes">infoType
detector</a> to match on the desired sensitive data
values. If you are scanning <a href="/dlp/docs/inspecting-structured-text">structured
data</a> (such as a BigQuery table),
you can also perform tokenization on entire columns of data using <a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.RecordTransformations">record
transformations</a>.</p>
<p>For more information about the two categories of transformationsâinfoType
and record transformationsâsee <a href="/dlp/docs/deidentify-sensitive-data#de-identification_transformations">De-identification
transformations</a>.</p>
<p><strong>Step 2: Using a cryptographic key, Cloud DLP encrypts each input
value.</strong> You can provide this key in one of three ways:</p>
<ul>
<li>By wrapping it using Cloud Key Management Service (Cloud KMS). (For maximum security,
Cloud KMS is the preferred method.)</li>
<li>By using a transient key, which Cloud DLP generates at the time
of de-identification and then discards. A transient key only keeps integrity
per API request. If you need integrity or plan to re-identify this data, do
not use this key type.</li>
<li>Directly in raw text form. (Not recommended.)</li>
</ul>
<p>For more details, see the <a href="#using-crypto-keys">Using cryptographic keys</a>
section, later in this topic.</p>
<p><strong>Step 3 (Cryptographic hashing and deterministic encryption with AES-SIV only):
Cloud DLP encodes the encrypted value using base64.</strong> With
cryptographic hashing, this encoded, encrypted value is the token, and the
process continues with Step 6. With deterministic encryption using AES-SIV, this
encoded, encrypted value is the surrogate value, which is just one component of
the token. The process continues with Step 4.</p>
<p><strong>Step 4 (Format preserving and deterministic encryption with AES-SIV only):
Cloud DLP adds an optional surrogate annotation to the encrypted
value.</strong> The surrogate annotation helps identify encrypted surrogate values by
prepending them with a descriptive string that you define. For example, without
an annotation you might not be able to tell apart a de-identified phone number
and a de-identified Social Security or other identification number. In addition,
to re-identify values in unstructured data that have been de-identified using
either format preserving encryption or deterministic encryption, you must
specify a surrogate annotation. (Surrogate annotations are not required when
transforming a column of structured, or tabular, data with a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#recordtransformations"><code dir="ltr" translate="no">RecordTransformation</code></a>.)</p>
<p><strong>Step 5 (Format preserving and deterministic encryption with AES-SIV of
structured data only): Cloud DLP can use optional context from
another field to "tweak" the token generated.</strong> This enables you to change the
scope of the token. For example, suppose you have a database of marketing
campaign data that includes email addresses and you want to generate unique
tokens for the same email address "tweaked" by the campaign ID. This would allow
someone to join data for the same user within the same campaign but not across
different campaigns. If a context tweak is used to create the token, then this
context tweak is also required for the de-identification transformations to be
reversed. Format preserving and deterministic encryption using AES-SIV support
contexts. Learn more about <a href="#using-context-tweaks">using context tweaks</a>.</p>
<aside class="note"><strong>Note:</strong><span> For more information about the format of tokenized values, including
surrogate annotations and contexts, see the next section, "Tokenized value
comparison."</span></aside>
<p><strong>Step 6: Cloud DLP replaces the original value with the
de-identified value.</strong></p>
<h2 data-text="Tokenized value comparison" id="tokenized_value_comparison">Tokenized value comparison</h2>
<p>This section demonstrates how typical tokens look after being de-identified
using each of the three methods discussed in this topic. The example sensitive
data value is a North American telephone number (<code dir="ltr" translate="no">1-206-555-0123</code>).</p>
<h3 data-text="Deterministic encryption using AES-SIV" id="aes-siv">Deterministic encryption using AES-SIV</h3>
<p>With de-identification using deterministic encryption and AES-SIV, an input
value (and, optionally, any specified context tweak) is encrypted using AES-SIV
with a cryptographic key, encoded using base64, and then optionally prepended
with a surrogate annotation, if specified. This method does not preserve the
character set (or "alphabet") of the input value. In order to generate printable
output, the resulting value is encoded in base64.</p>
<p>The resulting token, assuming a surrogate infoType has been specified, is in
the form:</p>
<pre class="devsite-disable-click-to-copy" dir="ltr" translate="no"><var translate="no">SURROGATE_INFOTYPE</var>(<var translate="no">SURROGATE_VALUE_LENGTH</var>):<var translate="no">SURROGATE_VALUE</var></pre>
<p>The following annotated diagram shows an example tokenâthe output of a
de-identification operation using deterministic encryption with AES-SIV on the
value <code dir="ltr" translate="no">1-206-555-0123</code>. The optional surrogate infoType has been set to
<code dir="ltr" translate="no">NAM_PHONE_NUMB</code>:</p>
<p><img alt="Annotated diagram of a value tokenized using the deterministic
         encryption using AES-SIV transformation method." src="/dlp/docs/images/pseudonymization-deterministic_example.png" width="805"/></p>
<ol>
<li>Surrogate annotation</li>
<li>Surrogate infoType (defined by user)</li>
<li>Character length of transformed value</li>
<li>Surrogate (transformed) value</li>
</ol>
<p>If you do not specify a surrogate annotation, the resulting token is equal to
the transformed value, or #4 in the annotated diagram. To re-identify
unstructured data, this entire token is required, including the surrogate
annotation. When transforming structured data such as a table, the surrogate
annotation is optional; Cloud DLP can perform both
de-identification and re-identification on an entire column using a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#recordtransformations"><code dir="ltr" translate="no">RecordTransformation</code></a>
without a surrogate annotation.</p>
<h3 data-text="Format preserving encryption" id="fpe-ffx">Format preserving encryption</h3>
<p>With de-identification using format preserving encryption, an input value (and,
optionally, any specified context tweak) is encrypted using the FFX mode of
format preserving encryption ("FPE-FFX") with a cryptographic key, and then
optionally prepended with a surrogate annotation, if specified.</p>
<p>Unlike the other methods of tokenization described in this topic, the output
surrogate value is the same length as the input value, and it is not encoded
using base64. You define the character setâor "alphabet"âthat
the encrypted value is comprised of. There are three ways to specify the
alphabet for Cloud DLP to use in the output value:</p>
<ul>
<li>Use one of four enumerated values that represent the four most common
character sets/alphabets.</li>
<li>Use a radix value, which specifies the size of the alphabet. Specifying the
minimum radix value of <code dir="ltr" translate="no">2</code> results in an alphabet that consists of just <code dir="ltr" translate="no">0</code>
and <code dir="ltr" translate="no">1</code>. Specifying the maximum radix value of <code dir="ltr" translate="no">95</code> results in an alphabet
that includes all numeric characters, upper-case alpha characters,
lower-case alpha characters, and symbol characters.</li>
<li>Build an alphabet by listing the exact characters to use. For example,
specifying <code dir="ltr" translate="no">1234567890-*</code> would result in a surrogate value that is made up
of only numbers, hyphens, and asterisks.</li>
</ul>
<aside class="important"><p>
<strong>Important: </strong> When choosing to use the format preserving
    encryption (FPE) method of de-identification, ensure that both the original
    values you're transforming and the size of the alphabet you've specified for
    transformed values to use (the radix) are of sufficient length to prevent
    reverse engineering of the secure output. In situations where the number of
    possible character strings is small, either increase the radix of the
    alphabet or use a <a href="#context-tweaks">context tweak</a>.</p>
<p>In addition, although the length of the transformed value is preserved
    thanks to the lack of authentication and initialization vector, FPE provides
    fewer security guarantees compared to other deterministic encryption
    methods such as AES-SIV.</p>
<p>For these reasons, Google strongly recommends using <a href="#aes-siv">deterministic encryption with AES-SIV</a> instead of FPE
    for all security sensitive use cases.</p>
</aside>
<p>The following table lists four common character sets by each one's enumerated
value
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#ffxcommonnativealphabet"><code dir="ltr" translate="no">FfxCommonNativeAlphabet</code></a>),
radix value, and list of the set's characters. The final row lists the full
character set, which corresponds to the maximum radix value.</p>
<table>
<thead>
<tr>
<th>Alphabet/character set name</th>
<th>Radix</th>
<th>Character list</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">NUMERIC</code></td>
<td><code dir="ltr" translate="no">10</code></td>
<td><code dir="ltr" translate="no">0123456789</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">HEXADECIMAL</code></td>
<td><code dir="ltr" translate="no">16</code></td>
<td><code dir="ltr" translate="no">0123456789ABCDEF</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UPPER_CASE_ALPHA_NUMERIC</code></td>
<td><code dir="ltr" translate="no">36</code></td>
<td><code dir="ltr" translate="no">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">ALPHA_NUMERIC</code></td>
<td><code dir="ltr" translate="no">62</code></td>
<td><code dir="ltr" translate="no">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz</code></td>
</tr>
<tr>
<td>-</td>
<td><code dir="ltr" translate="no">95</code></td>
<td><code dir="ltr" translate="no">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~`!@#$%^&amp;*()_-+={[}]|\:;"'&lt;,&gt;.?/</code></td>
</tr>
</tbody>
</table>
<p>The resulting token, assuming a surrogate infoType has been specified, is in the
form:</p>
<pre class="devsite-disable-click-to-copy" dir="ltr" translate="no"><var translate="no">SURROGATE_INFOTYPE</var>(<var translate="no">SURROGATE_VALUE_LENGTH</var>):<var translate="no">SURROGATE_VALUE</var></pre>
<p>The following annotated diagram is the output of a Cloud DLP
de-identification operation using format preserving encryption on the value
<code dir="ltr" translate="no">1-206-555-0123</code> using a radix of <code dir="ltr" translate="no">95</code>. The optional surrogate infoType has
been set to <code dir="ltr" translate="no">NAM_PHONE_NUMB</code>:</p>
<p><img alt="Annotated diagram of a value tokenized using the format preserving
         encryption transformation method." src="/dlp/docs/images/pseudonymization-fpeffx_example.png" width="445"/></p>
<ol>
<li>Surrogate annotation</li>
<li>Surrogate infoType (defined by user)</li>
<li>Character length of transformed value</li>
<li>Surrogate (transformed) valueâsame length as input value</li>
</ol>
<p>If you do not specify a surrogate annotation, the resulting token is equal to
the transformed value, or #4 in the annotated diagram. To re-identify
unstructured data, this entire token is required, including the surrogate
annotation. When transforming structured data such as a table, the surrogate
annotation is optional; Cloud DLP can perform both
de-identification and re-identification on an entire column using a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#recordtransformations"><code dir="ltr" translate="no">RecordTransformation</code></a>
without a surrogate.</p>
<aside class="note"><strong>Note:</strong><span> By design, FPE-FFX preserves the length and character set of the input
text. This means that it lacks authentication and an initialization vector,
which would cause a length expansion in the output token. Other methods like
deterministic encryption using AES-SIV provide these stronger security
guarantees and are recommended for tokenization use cases unless length and
character set preservation are strict requirementsâfor example, for
backward compatibility with a legacy data system.</span></aside>
<h3 data-text="Cryptographic hashing" id="cryptographic-hashing">Cryptographic hashing</h3>
<p>With de-identification using cryptographic hashing, an input value is hashed
using HMAC-SHA-256 with a cryptographic key, and then encoded using base64. The
de-identified value is always a uniform length, depending on the size of the key.</p>
<p>Unlike the other tokenization methods discussed in this topic, cryptographic
hashing creates a one-way token. That is, de-identification using cryptographic
hashing can't be reversed.</p>
<p>Following is the output of a de-identification operation using cryptographic
hashing on the value <code dir="ltr" translate="no">1-206-555-0123</code>. This output is a base64-encoded
representation of the hashed value:</p>
<pre class="devsite-disable-click-to-copy" dir="ltr" translate="no">XlTCv8h0GwrCZK+sS0T3Z8txByqnLLkkF4+TviXfeZY=</pre>
<h2 data-text="Using cryptographic keys" id="using-crypto-keys">Using cryptographic keys</h2>
<p>There are three options for cryptographic keys that you can use with the
cryptographic de-identification methods in Cloud DLP:</p>
<ul>
<li><p><strong>Cloud KMS wrapped cryptographic key</strong>: This is the most secure
type of cryptographic key available to use with the Cloud DLP
de-identification methods. A Cloud KMS wrapped key consists of a
128-, 192-, or 256-bit cryptographic key that has been encrypted using
another key. You provide the first cryptographic key, which is then wrapped
using a Cloud Key Management Service-stored cryptographic key. These kinds of keys are
stored in Cloud KMS for later re-identification. For more
information on creating and wrapping a key for the purpose of
de-identification and re-identification, see
<a href="/dlp/docs/inspect-sensitive-text-de-identify">Quickstart: De-identifying and re-identifying sensitive text</a>.</p>
<p><aside class="special"><strong>Note:</strong> When you use
  Cloud KMS for cryptographic operations,
  <a href="https://cloud.google.com/kms/pricing">charges apply</a>.</aside></p></li>
<li><p><strong>Transient cryptographic key</strong>: A transient cryptographic key is generated
by Cloud DLP at the time of de-identification, and then
discarded. For this reason, do not use a transient cryptographic key with
any cryptographic de-identification method that you want to reverse.
Transient cryptographic keys only keep integrity per API request. If you
need integrity across more than one API request or plan to re-identify your
data, do not use this key type.</p></li>
<li><p><strong>Unwrapped cryptographic key</strong>: An unwrapped key is a raw base64-encoded
128-, 192-, or 256-bit cryptographic key that you provide inside the
de-identification request to the DLP API. You are responsible
for keeping these kinds of cryptographic keys safe for later
re-identification. Because of the risk of accidentally leaking the key,
these types of keys are not recommended. These keys can be useful for
testing, but for production workloads a Cloud KMS wrapped
cryptographic key is recommended instead.</p></li>
</ul>
<p>To learn more about the available options when using cryptographic keys, see
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>
in DLP API reference.</p>
<h2 data-text="Using context tweaks" id="context-tweaks">Using context tweaks</h2>
<p>By default, all the cryptographic transformation methods of de-identification
have referential integrity, whether output tokens are one-way or two-way. That
is, given the same cryptographic key, an input value is always transformed to
the same encrypted value. In situations where repetitive data or data patterns
might occur, the risk of re-identification increases. To instead make it so that
the same input value is always transformed to a different encrypted value, you
can specify a unique <em>context tweak</em>.</p>
<p>You specify a context tweak (named simply a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">context</code></a>
in the DLP API) when transforming tabular data, since the tweak is
effectively a pointer to a data column, such as an identifier.
Cloud DLP uses the value in the field specified by the context
tweak when encrypting the input value. To ensure that the encrypted value is
always a unique value, specify a column for the tweak that contains unique
identifiers.</p>
<p>Consider this simple example. The following table shows several medical records,
some of which include duplicate patient IDs.</p>
<aside class="note"><strong>Note:</strong><span> This example is used to illustrate how context tweaks work and should
not otherwise be considered a best practice for how to use
Cloud DLP.</span></aside>
<table>
<thead>
<tr>
<th>record_id</th>
<th>patient_id</th>
<th>icd10_code</th>
</tr>
</thead>
<tbody>
<tr>
<td>5437</td>
<td>43789</td>
<td>E11.9</td>
</tr>
<tr>
<td>5438</td>
<td>43671</td>
<td>M25.531</td>
</tr>
<tr>
<td>5439</td>
<td>43789</td>
<td>N39.0, I25.710</td>
</tr>
<tr>
<td>5440</td>
<td>43766</td>
<td>I10</td>
</tr>
<tr>
<td>5441</td>
<td>43766</td>
<td>I10</td>
</tr>
<tr>
<td>5442</td>
<td>42989</td>
<td>R07.81</td>
</tr>
<tr>
<td>5443</td>
<td>43098</td>
<td>I50.1, R55</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>If you instruct Cloud DLP to de-identify the patient IDs in the
table, it de-identifies repeat patient IDs to the same values by default, as
shown in the following table. For instance, both instances of the patient ID
"43789" are de-identified to "47222." (The <code dir="ltr" translate="no">patient_id</code> column shows the
token values after pseudonymization using FPE-FFX and does not include
surrogate annotations. See <a href="#fpe-ffx">Format preserving encryption</a> for more
information.)</p>
<table>
<thead>
<tr>
<th>record_id</th>
<th>patient_id</th>
<th>icd10_codes</th>
</tr>
</thead>
<tbody>
<tr>
<td>5437</td>
<td>47222</td>
<td>E11.9</td>
</tr>
<tr>
<td>5438</td>
<td>82160</td>
<td>M25.531</td>
</tr>
<tr>
<td>5439</td>
<td>47222</td>
<td>N39.0, I25.710</td>
</tr>
<tr>
<td>5440</td>
<td>04452</td>
<td>I10</td>
</tr>
<tr>
<td>5441</td>
<td>04452</td>
<td>I10</td>
</tr>
<tr>
<td>5442</td>
<td>47826</td>
<td>R07.81</td>
</tr>
<tr>
<td>5443</td>
<td>52428</td>
<td>I50.1, R55</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>This means that the scope of the referential integrity is across the entire
dataset.</p>
<p>To narrow the scope so that you avoid this behavior, specify a context tweak.
You can specify any column as a context tweak, but to guarantee that each
de-identified value is unique, specify a column for which every value is unique.</p>
<p>Suppose you want to see whether the same patient shows up per <code dir="ltr" translate="no">icd10_codes</code>
value but not if the same patient shows up in different <code dir="ltr" translate="no">icd10_codes</code> values. To
do this, you'd specify the <code dir="ltr" translate="no">icd10_codes</code> column as the context tweak.</p>
<p>This is the table after de-identifying the <code dir="ltr" translate="no">patient_id</code> column using the
<code dir="ltr" translate="no">icd10_codes</code> column as a context tweak:</p>
<table>
<thead>
<tr>
<th>record_id</th>
<th>patient_id</th>
<th>icd10_codes</th>
</tr>
</thead>
<tbody>
<tr>
<td>5437</td>
<td>18954</td>
<td>E11.9</td>
</tr>
<tr>
<td>5438</td>
<td>33068</td>
<td>M25.531</td>
</tr>
<tr>
<td>5439</td>
<td>76368</td>
<td>N39.0, I25.710</td>
</tr>
<tr>
<td>5440</td>
<td>29460</td>
<td>I10</td>
</tr>
<tr>
<td>5441</td>
<td>29460</td>
<td>I10</td>
</tr>
<tr>
<td>5442</td>
<td>23877</td>
<td>R07.81</td>
</tr>
<tr>
<td>5443</td>
<td>96129</td>
<td>I50.1, R55</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Note that the fourth and fifth de-identified <code dir="ltr" translate="no">patient_id</code> values (29460) are the
same because not only were the original <code dir="ltr" translate="no">patient_id</code> values identical, both
rows' <code dir="ltr" translate="no">icd10_codes</code> values were identical as well. Since you needed to run
analysis with consistent patient IDs within the scope of the <code dir="ltr" translate="no">icd10_codes</code>
value, this behavior is what you're looking for.</p>
<p>To completely sever referential integrity between <code dir="ltr" translate="no">patient_id</code> values and
<code dir="ltr" translate="no">icd10_codes</code> values, you can instead use the <code dir="ltr" translate="no">record_id</code> column as a context
tweak:</p>
<table>
<thead>
<tr>
<th>record_id</th>
<th>patient_id</th>
<th>icd10_code</th>
</tr>
</thead>
<tbody>
<tr>
<td>5437</td>
<td>15826</td>
<td>E11.9</td>
</tr>
<tr>
<td>5438</td>
<td>61722</td>
<td>M25.531</td>
</tr>
<tr>
<td>5439</td>
<td>34424</td>
<td>N39.0, I25.710</td>
</tr>
<tr>
<td>5440</td>
<td>02875</td>
<td>I10</td>
</tr>
<tr>
<td>5441</td>
<td>52549</td>
<td>I10</td>
</tr>
<tr>
<td>5442</td>
<td>17945</td>
<td>R07.81</td>
</tr>
<tr>
<td>5443</td>
<td>19030</td>
<td>I50.1, R55</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Note that each de-identified <code dir="ltr" translate="no">patient_id</code> value in the table is now unique.</p>
<p>To learn how to use context tweaks in the DLP API, note the usage
of <code dir="ltr" translate="no">context</code> in the following transformation method reference topics:</p>
<ul>
<li>Format preserving encryption:
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a></li>
<li>Deterministic encryption using AES-SIV:
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptodeterministicconfig"><code dir="ltr" translate="no">CryptoDeterministicConfig</code></a></li>
<li>Date shifting:
<a href="https://cloud.google.com/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#dateshiftconfig"><code dir="ltr" translate="no">DateShiftConfig</code></a></li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><p>Work through <a href="/dlp/docs/inspect-sensitive-text-de-identify">an end-to-end example that demonstrates how to create a wrapped key,
tokenize content, and re-identify tokenized content</a>.</p></li>
<li><p>Look through <a href="/dlp/docs/transformations-reference#crypto">code samples that demonstrate how to tokenize sensitive data</a>.</p></li>
<li><p>Learn how to <a href="/dlp/docs/deidentify-sensitive-data">de-identify data using the
DLP API</a>.</p></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-text-redaction]</H1></p><div class="devsite-article-body clearfix">
<h2 data-text="Text classification" id="text_classification">Text classification</h2>
<p>Given the following text input:</p>
<pre dir="ltr" translate="no">Please update my records with the following information:
Email address: foo@example.com

National Provider Identifier: 1245319599

Driver's license: AC333991</pre>
<p>The output is a list of findings, organized into the following categories:</p>
<ul>
<li><a href="/dlp/docs/infotypes-reference" title="InfoTypes Reference"><code dir="ltr" translate="no">InfoType</code></a></li>
<li><a href="/dlp/docs/likelihood" title="Likelihood Concept Page"><code dir="ltr" translate="no">Likelihood</code></a></li>
<li><code dir="ltr" translate="no">Offset</code> (Where in the string the potential <code dir="ltr" translate="no">InfoType</code> was found)</li>
</ul>
<p>Example output is shown in the table below.</p>
<table>
<thead>
<tr>
<th><code dir="ltr" translate="no">InfoType</code></th>
<th><code dir="ltr" translate="no">Likelihood</code></th>
<th><code dir="ltr" translate="no">Offset</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">US_HEALTHCARE_NPI</code></td>
<td><code dir="ltr" translate="no">VERY_LIKELY</code></td>
<td><code dir="ltr" translate="no">122</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">EMAIL_ADDRESS</code></td>
<td><code dir="ltr" translate="no">LIKELY</code></td>
<td><code dir="ltr" translate="no">72</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_DRIVERS_LICENSE_NUMBER</code></td>
<td><code dir="ltr" translate="no">LIKELY</code></td>
<td><code dir="ltr" translate="no">155</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_BC_PHN</code></td>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td><code dir="ltr" translate="no">122</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UK_TAXPAYER_REFERENCE</code></td>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td><code dir="ltr" translate="no">122</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_PASSPORT</code></td>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td><code dir="ltr" translate="no">155</code></td>
</tr>
</tbody>
</table>
<h2 data-text="Automatic text redaction" id="automatic_text_redaction">Automatic text redaction</h2>
<p>Automatic redaction produces an output with sensitive data matches removed
instead of giving you a list of findings.</p>
<p>Example automation redaction input:</p>
<pre dir="ltr" translate="no">Please update my records with the following information:
Email address: foo@example.com

National Provider Identifier: 1245319599

Driver's license: AC333991</pre>
<p>Example output using a placeholder of "***":</p>
<pre dir="ltr" translate="no">Please update my records with the following information:
Email address: ***

National Provider Identifier: ***

Driver's license: ***</pre>
<h2 data-text="Resources" id="resources">Resources</h2>
<ul>
<li>For more information about using Cloud DLP to redact text,
see
<a href="/dlp/docs/redacting-sensitive-data">Redacting Sensitive Data From Text Content</a>.</li>
<li>For more information about using Cloud DLP to de-identify
sensitive data in text contentâwhich includes "masking" sensitive
data, replacing sensitive data with a "token" string, and encrypting and
replacing sensitive data using a randomly generated or pre-determined
keyâsee
<a href="/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data in text content</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-image-redaction]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention can inspect for and redact sensitive text from an image
according to criteria that you specify.</p>
<p>Using <a href="/dlp/docs/infotypes-reference">infoType detectors</a> and optical character
recognition (OCR), Cloud DLP inspects a
<a href="/vision/docs/base64">base64</a>-encoded image for text and detects sensitive data
within the text. It can then return information about the location of sensitive
data within the image, or redact the sensitive data by masking it with an opaque
rectangle.</p>
<p>Inspection and redaction are two distinct actions:</p>
<ul>
<li><em>Inspection</em>: Cloud DLP inspects the submitted
base64-encoded image for the specified intoTypes. It returns the detected
InfoTypes, along with one or more set of pixel coordinates and dimensions.
Each set of pixel coordinate and dimension values indicate the bottom-left
corner and the dimensions of bounding boxes, respectively. Each bounding
box corresponds to all or part of a Cloud DLP finding.</li>
<li><em>Redaction</em>: Cloud DLP inspects the submitted
base64-encoded image for the specified infoTypes. Cloud DLP
redacts any sensitive data findings by masking them with opaque rectangles.
It returns the redacted base64-encoded image in the same image format as the
original image. You can also configure the color of the redaction boxes in
the request.</li>
</ul>
<h2 data-text="About inspection" id="about_inspection">About inspection</h2>
<p>Cloud DLP's image inspection takes a base64-encoded image,
recognizes any text in the image, and then searches the text for any data that
matches its inspection criteria. Finally, Cloud DLP returns the
locations of any sensitive data that it's detected.</p>
<p>Consider the following image. This image is an example of a typical image file
generated from a scan of a paper document.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/redacting-sensitive-data-images-dlpbefore.jpg">
<img alt="Original unredacted image (click to enlarge)" class="screenshot" src="/dlp/docs/images/redacting-sensitive-data-images-dlpbefore.jpg" title="Original unredacted image (click to enlarge)" width="500">
</img></a>
</figure>
<p>If you instruct Cloud DLP to inspect this image for US Social
Security numbers, it goes through the process illustrated in the following
diagram.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/concepts-image-redaction-inspection-process.png">
<img alt="Image inspection process (click to enlarge)" src="/dlp/docs/images/concepts-image-redaction-inspection-process.png" title="Image inspection process (click to enlarge)">
</img></a>
</figure>
<ol>
<li>The base64-encoded image is streamed to Cloud DLP
 using the <code dir="ltr" translate="no">content.inspect</code> method.</li>
<li>Using optical character recognition (OCR), Cloud DLP
 recognizes text in the document.</li>
<li>Cloud DLP scans the recognized text using the
 sensitive data detection configuration you set previously and identifies
 any matches.</li>
<li>Cloud DLP returns the coordinates and dimensions of the
 regions within the image where it found sensitive data according to your
 detection criteria.</li>
</ol>
<p>The returned coordinates indicate where to find the sensitive data. Be aware
that Cloud DLP often uses multiple boxes to indicate where a single
instance of sensitive data is in the image. This is especially true when the
text is written by hand, as in this example.</p>
<p>If Cloud DLP doesn't find any data in the image that corresponds
to your detection criteria, it returns an empty, successful HTTP 200 response.</p>
<h2 data-text="About redaction" id="about_redaction">About redaction</h2>
<p>Image redaction is identical to image inspection, with one additional step. Once
Cloud DLP has identified the location(s) of sensitive data within
the image, instead of returning the coordinates of the areas that contain the
data, it fills those areas on the image, returning a redacted, base64-encoded
image.</p>
<p>Again consider the original image from the previous section. If you instruct
Cloud DLP to redact all US Social Security numbers from the image,
it goes through the process illustrated in the following diagram.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/concepts-image-redaction-redaction-process.png">
<img alt="Image redaction process (click to enlarge)" src="/dlp/docs/images/concepts-image-redaction-redaction-process.png" title="Image redaction process (click to enlarge)">
</img></a>
</figure>
<ol>
<li>The base64-encoded image is streamed to Cloud DLP
 using the <code dir="ltr" translate="no">image.redact</code> method.</li>
<li>Using optical character recognition (OCR), Cloud DLP
 recognizes text in the document.</li>
<li>Cloud DLP scans the recognized text using the
 sensitive data detection configuration you set previously and identifies
 any matches.</li>
<li>Cloud DLP redacts all detected sensitive data by
 covering it with an opaque rectangle. It then encodes the image in base64
 and returns it in the request response.</li>
</ol>
<p>If Cloud DLP doesn't find any data in the image that corresponds
to your detection criteria, it returns the base64-encoded image unchanged.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>To learn how to inspect images for sensitive data using
Cloud DLP, see <a href="/dlp/docs/inspecting-images">Inspecting images for sensitive
data</a>.</li>
<li>To learn how to redact sensitive data from images using,
Cloud DLP, see <a href="/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from
images</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/transformations-reference]</H1></p><div class="devsite-article-body clearfix">
<p>This topic covers the available de-identification techniques, or
transformations, in Cloud DLP.</p>
<h2 data-text="Types of de-identification techniques" id="types_of_de-identification_techniques">Types of de-identification techniques</h2>
<p>Choosing the de-identification transformation you want to use depends on the
kind of data you want to de-identify and for what purpose you're de-identifying
the data. The de-identification techniques that Cloud DLP supports
fall into the following general categories:</p>
<ul>
<li><a href="#redaction">Redaction</a>: Deletes all or part of a detected sensitive value.</li>
<li><a href="#replacement">Replacement</a>: Replaces a detected sensitive value with a
specified surrogate value.</li>
<li><a href="#masking">Masking</a>: Replaces a number of characters of a sensitive value
with a specified surrogate character, such as a hash (#) or asterisk (*).</li>
<li><a href="#crypto">Crypto-based tokenization</a>: Encrypts the original sensitive data
value using a cryptographic key. Cloud DLP supports several
types of tokenization, including transformations that can be reversed, or
"re-identified."</li>
<li><a href="#bucketing">Bucketing</a>: "Generalizes" a sensitive value by replacing it
with a range of values. (For example, replacing a specific age with an age
range, or temperatures with ranges corresponding to "Hot," "Medium," and
"Cold.")</li>
<li><a href="#date_shift">Date shifting</a>: Shifts sensitive date values by a random
amount of time.</li>
<li><a href="#time-extract">Time extraction</a>: Extracts or preserves specified
portions of date and time values.</li>
</ul>
<p>The remainder of this topic covers each different type of de-identification
transformation and provides examples of their use.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<h2 data-text="Transformation methods" id="transformation_methods">Transformation methods</h2>
<p>The following table lists the transformations that Cloud DLP
provides to de-identify sensitive data:</p>
<table>
<tr>
<th>Transformation</th>
<th>Object</th>
<th>Description</th>
<th>Can Reverse<sub><a href="#footnote1">1</a></sub></th>
<th>Referential Integrity<sub><a href="#footnote2">2</a></sub></th>
<th>Input Type</th>
</tr>
<tr>
<td>Redaction</td>
<td><a href="#redaction"><code dir="ltr" translate="no">RedactConfig</code></a></td>
<td>Redacts a value by removing it.</td>
<td></td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>Replacement</td>
<td><a href="#basic_replacement"><code dir="ltr" translate="no">ReplaceValueConfig</code></a></td>
<td>Replaces each input value with a given value.</td>
<td></td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>Replace with infoType</td>
<td><a href="#infotype-replacement"><code dir="ltr" translate="no">ReplaceWithInfoTypeConfig</code></a></td>
<td>Replaces an input value with the name of its infoType.</td>
<td></td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>Mask with character</td>
<td><a href="#masking"><code dir="ltr" translate="no">CharacterMaskConfig</code></a></td>
<td>Masks a string either fully or partially by replacing a given number
      of characters with a specified fixed character.</td>
<td></td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>Pseudonymization by replacing input value with cryptographic
      hash</td>
<td><a href="#crypto-hashing"><code dir="ltr" translate="no">CryptoHashConfig</code></a></td>
<td>Replaces input values with a 32-byte hexadecimal string generated
      using a given data encryption key. See
      <a href="/dlp/docs/pseudonymization">pseudonymization conceptual
        documentation</a> to learn more.</td>
<td></td>
<td>â</td>
<td>Strings or integers</td>
</tr>
<tr>
<td>Pseudonymization by replacing with cryptographic format preserving
      token</td>
<td><a href="#fpe"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a></td>
<td>Replaces an input value with a token, or surrogate value, of the
      same length using format-preserving encryption (FPE) with the FFX mode
      of operation. This allows the output to be used in systems that have
      format validation on length. This is useful for legacy systems where
      string length must be maintained.
      Important: For input that varies in length or has
      length greater than 32 bytes, use <code dir="ltr" translate="no">CryptoDeterministicConfig</code>.
      To remain secure the following limits are recommended by the
      <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-38G.pdf">
        National Institute of Standards and Technology</a>:
      <ul>
<li>radix^max_size &lt;= 2^128.</li>
<li>radix^min_len &gt;= 100</li>
</ul>

      We recommend using CryptoDeterministicConfig for all use cases which
      do not require preserving the input alphabet space and size, plus warrant
      referential integrity.
      See <a href="/dlp/docs/pseudonymization">pseudonymization conceptual
      documentation</a> to learn more.</td>
<td>â</td>
<td>â</td>
<td>Strings or integers with a limited number of characters and of uniform
      length. The alphabet must be made up of at least 2 characters and contain
      no more than 95.
    </td>
</tr>
<tr>
<td>Pseudonymization by replacing with cryptographic token</td>
<td><a href="#de"><code dir="ltr" translate="no">CryptoDeterministicConfig</code></a></td>
<td>Replaces an input value with a token, or surrogate value, of the
      same length using <a class="external" href="https://tools.ietf.org/html/rfc5297" target="_blank">AES in Synthetic Initialization Vector
      mode (AES-SIV)</a>. This transformation method, unlike format-preserving
      tokenization, has no limitation on supported string character sets,
      generates identical tokens for each instance of an identical input value,
      and uses
      <a href="/dlp/docs/reference/rest/v2/InspectConfig#surrogatetype">surrogates</a>
      to enable re-identification given the original encryption key.</td>
<td>â</td>
<td>â</td>
<td>Any</td>
</tr>
<tr>
<td>Bucket values based on fixed size ranges</td>
<td><a href="#fixed-bucket"><code dir="ltr" translate="no">FixedSizeBucketingConfig</code></a></td>
<td>Masks input values by replacing them with buckets, or ranges within
      which the input value falls.</td>
<td></td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>Bucket values based on custom size ranges</td>
<td><a href="#custom-bucket"><code dir="ltr" translate="no">BucketingConfig</code></a></td>
<td>Buckets input values based on user-configurable ranges and
      replacement values.</td>
<td></td>
<td></td>
<td>Any</td>
</tr>
<tr>
<td>Date Shifting</td>
<td><a href="#date-shift"><code dir="ltr" translate="no">DateShiftConfig</code></a></td>
<td>Shifts dates by a random number of days, with the option to be
      consistent for the same context.</td>
<td></td>
<td>â <br/>Preserves sequence and duration</td>
<td>Dates/Times</td>
</tr>
<tr>
<td>Extract time data</td>
<td><a href="#time-extract"><code dir="ltr" translate="no">TimePartConfig</code></a></td>
<td>Extracts or preserves a portion of <code dir="ltr" translate="no">Date</code>,
      <code dir="ltr" translate="no">Timestamp</code>, and <code dir="ltr" translate="no">TimeOfDay</code> values.</td>
<td></td>
<td></td>
<td>Dates/Times</td>
</tr>
</table>
<h4 data-text="Footnotes" id="footnotes">Footnotes</h4>
<div class="footnote">
<div id="footnote1">
<sup>1</sup>
<span>
      Reversible transformations can be reversed to re-identify the sensitive
      data using the
      <a href="/dlp/docs/reference/rest/v2/projects.content/reidentify"><code dir="ltr" translate="no">content.reidentify</code></a> method.
    </span>
</div>
<div id="footnote2">
<sup>2</sup>
<span>
      Referential integrity allows for records to maintain their relationship
      to one another while still de-identifying the data. For example, given
      the same crypto key and context, the data will be replaced with the same
      obfuscuted form each time it is transformed allowing for connections
      between records to be preserved.
    </span>
</div>
</div>
<h3 data-text="Redaction" id="redaction">Redaction</h3>
<p>If you want to simply remove sensitive data from your input content,
Cloud DLP supports a redaction transformation
(<a href="/dlp/docs/deidentify-sensitive-data#redactconfig"><code dir="ltr" translate="no">RedactConfig</code></a> in the
DLP API).</p>
<p>For example, suppose you want to perform a simple redaction of all
<code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoTypes, and the following string is sent to
Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string will be the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is .</pre>
<p>The following JSON example and code in several languages shows how to form the 
API request and what the DLP API returns:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-redact-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-redact-protocol" track-metadata-position="dlp-redact" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation":{
            "redactConfig":{

            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is ."
  },
  "overview":{
    "transformedBytes":"22",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "redactConfig":{

          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"22"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-redact-java" track-metadata-position="dlp-redact" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-redact" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java" data-region-tag="dlp_deidentify_redact" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithRedaction.java/HEAD/dlp_deidentify_redact" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RedactConfig;

public class DeIdentifyWithRedaction {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect =
        "My name is Alicia Abernathy, and my email address is aabernathy@example.com.";
    deIdentifyWithRedaction(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void deIdentifyWithRedaction(String projectId, String textToRedact) {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToRedact).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("EMAIL_ADDRESS").build();
      InspectConfig inspectConfig = InspectConfig.newBuilder().addInfoTypes(infoType).build();
      // Define type of deidentification.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setRedactConfig(RedactConfig.getDefaultInstance())
              .build();
      // Associate deidentification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      // Construct the configuration for the Redact request and list all desired transformations.
      DeidentifyConfig redactConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Construct the Redact request to be sent by the client.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(redactConfig)
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Parse the response and process results
      System.out.println("Text after redaction: " + response.getItem().getValue());
    } catch (Exception e) {
      System.out.println("Error during inspectString: \n" + e.toString());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-redact-python" track-metadata-position="dlp-redact" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-redact" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-redact" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-redact" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_redact" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_redact" translate="no"><code dir="ltr" translate="no">def deidentify_with_redact(
    project,
    input_str,
    info_types,
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by redacting matched input values.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        info_types: A list of strings representing info types to look for.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [{"primitive_transformation": {"redact_config": {}}}]
        }
    }

    # Construct item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
</div>
<h3 data-text="Replacement" id="replacement">Replacement</h3>
<p>The replacement transformations replace each input value with either a given
token value or with the name of its infoType.</p>
<h4 data-text="Basic replacement" id="basic_replacement">Basic replacement</h4>
<p>The basic replacement transformation
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#replacevalueconfig"><code dir="ltr" translate="no">ReplaceValueConfig</code></a>
in the DLP API) replaces detected sensitive data values with a value
that you specify. For example, suppose you've told Cloud DLP to use
"[fake@example.com]" to replace all detected <code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoTypes, and
the following string is sent to Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string is the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is [fake@example.com].</pre>
<p>The following JSON example and code in several languages shows how to form the
API request and what the DLP API returns:</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp_deidentify_replace-code-sample">
<section>
<h3 data-text="Protocol" id="dlp_deidentify_replace-protocol" track-metadata-position="dlp_deidentify_replace" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>See the <a href="/dlp/docs/inspect-sensitive-text-api">JSON quickstart</a> for more information about
using the DLP API with JSON.</p>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation":{
            "replaceConfig":{
              "newValue":{
                "stringValue":"[email-address]"
              }
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is [email-address]."
  },
  "overview":{
    "transformedBytes":"22",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "replaceConfig":{
            "newValue":{
              "stringValue":"[email-address]"
            }
          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"22"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp_deidentify_replace-java" track-metadata-position="dlp_deidentify_replace" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_replace" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_replace" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp_deidentify_replace" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java" data-region-tag="dlp_deidentify_replace" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithReplacement.java/HEAD/dlp_deidentify_replace" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceValueConfig;
import com.google.privacy.dlp.v2.Value;

public class DeIdentifyWithReplacement {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect =
        "My name is Alicia Abernathy, and my email address is aabernathy@example.com.";
    deIdentifyWithReplacement(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void deIdentifyWithReplacement(String projectId, String textToRedact) {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToRedact).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("EMAIL_ADDRESS").build();
      InspectConfig inspectConfig = InspectConfig.newBuilder().addInfoTypes(infoType).build();
      // Specify replacement string to be used for the finding.
      ReplaceValueConfig replaceValueConfig =
          ReplaceValueConfig.newBuilder()
              .setNewValue(Value.newBuilder().setStringValue("[email-address]").build())
              .build();
      // Define type of deidentification as replacement.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder().setReplaceConfig(replaceValueConfig).build();
      // Associate deidentification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      // Construct the configuration for the Redact request and list all desired transformations.
      DeidentifyConfig redactConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Construct the Redact request to be sent by the client.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(redactConfig)
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Parse the response and process results
      System.out.println("Text after redaction: " + response.getItem().getValue());
    } catch (Exception e) {
      System.out.println("Error during inspectString: \n" + e.toString());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp_deidentify_replace-nodejs" track-metadata-position="dlp_deidentify_replace" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_replace" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithReplacement.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithReplacement.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_replace" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp_deidentify_replace" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithReplacement.js" data-region-tag="dlp_deidentify_replace" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithReplacement.js/HEAD/dlp_deidentify_replace" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The string to deidentify
// const string = 'My SSN is 372819127';

// The string to replace sensitive information with
// const replacement = "[REDACTED]"

async function deidentifyWithReplacement() {
  // Construct deidentification request
  const item = {value: string};
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      infoTypeTransformations: {
        transformations: [
          {
            primitiveTransformation: {
              replaceConfig: {
                newValue: {
                  stringValue: replacement,
                },
              },
            },
          },
        ],
      },
    },
    item: item,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const deidentifiedItem = response.item;
  console.log(deidentifiedItem.value);
}

deidentifyWithReplacement();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp_deidentify_replace-python" track-metadata-position="dlp_deidentify_replace" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp_deidentify_replace" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp_deidentify_replace" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp_deidentify_replace" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_replace" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_replace" translate="no"><code dir="ltr" translate="no">def deidentify_with_replace(
    project,
    input_str,
    info_types,
    replacement_str="REPLACEMENT_STR",
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by replacing matched input values with a value you specify.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        info_types: A list of strings representing info types to look for.
        replacement_str: The string to replace all values that match given
            info types.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {
                    "primitive_transformation": {
                        "replace_config": {
                            "new_value": {"string_value": replacement_str}
                        }
                    }
                }
            ]
        }
    }

    # Construct item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
</div>
<h4 data-text="InfoType replacement" id="infotype-replacement">InfoType replacement</h4>
<p>You can also specify an infoType replacement
(<a href="/dlp/docs/deidentify-sensitive-data#replacewithinfotypeconfig"><code dir="ltr" translate="no">ReplaceWithInfoTypeConfig</code></a>
in the DLP API). This transformation does the same thing as the basic
replacement transformation, but it replaces each detected sensitive data value
with the infoType of the detected value.</p>
<p>For example, suppose you've told Cloud DLP to detect both email
addresses and last names, and to replace each detected value with the value's
infoType. You send the following string to Cloud DLP:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>The returned string is the following:</p>
<pre dir="ltr" translate="no">My name is Alicia LAST_NAME, and my email address is EMAIL_ADDRESS.</pre>
<h3 data-text="Masking" id="masking">Masking</h3>
<p>You can configure Cloud DLP to completely or partially mask a
detected sensitive value
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#charactermaskconfig"><code dir="ltr" translate="no">CharacterMaskConfig</code></a>
in the DLP API) by replacing each character with a fixed single masking
character such as an asterisk (*) or hash (#). Masking can start from the
beginning or end of the string. This transformation also works with number types
such as long integers.</p>
<p>Cloud DLP's masking transformation has the following options you can specify:</p>
<ul>
<li>Masking character (The <code dir="ltr" translate="no">maskingCharacter</code> argument in the DLP API): The
character to use to mask each character of a sensitive value. For example,
you could specify an asterisk (*) or dollar sign ($) to mask a series of
numbers such as those in a credit card number.</li>
<li>The number of characters to mask (<code dir="ltr" translate="no">numberToMask</code>): If you don't specify this
value, all characters will be masked.</li>
<li>Whether to reverse the order (<code dir="ltr" translate="no">reverseOrder</code>): Whether to mask characters in
reverse order. Reversing the order causes characters in matched values to be
masked from the end toward the beginning of the value.</li>
<li>Characters to ignore (<code dir="ltr" translate="no">charactersToIgnore</code>): One or more characters to skip
when masking values. For example, you can tell Cloud DLP to leave
hyphens in place when masking a telephone number. You can also specify a
group of common characters
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.CharsToIgnore"><code dir="ltr" translate="no">CharsToIgnore</code></a>)
to ignore when masking.</li>
</ul>
<p>Suppose you send the following string to Cloud DLP and instruct it
to use the character masking transformation on email addresses:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is aabernathy@example.com.</pre>
<p>With the masking character sent to '#,' the characters to ignore set to the
common character set, and otherwise default settings, Cloud DLP
returns the following:</p>
<pre dir="ltr" translate="no">My name is Alicia Abernathy, and my email address is ##########@#######.###.</pre>
<p>The following JSON and code examples demonstrate how the masking transformation
works.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-masking-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-deidentify-masking-protocol" track-metadata-position="dlp-deidentify-masking" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON Input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify?key={YOUR_API_KEY}

{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is aabernathy@example.com."
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            }
          ],
          "primitiveTransformation":{
            "characterMaskConfig":{
              "maskingCharacter":"#",
              "reverseOrder":false,
              "charactersToIgnore":[
                {
                  "charactersToSkip":".@"
                }
              ]
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      }
    ]
  }
}
</code></pre>
<p><strong>JSON Output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My name is Alicia Abernathy, and my email address is ##########@#######.###."
  },
  "overview":{
    "transformedBytes":"22",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "characterMaskConfig":{
            "maskingCharacter":"#",
            "charactersToIgnore":[
              {
                "charactersToSkip":".@"
              }
            ]
          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"22"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-deidentify-masking-java" track-metadata-position="dlp-deidentify-masking" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithMasking.java/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.CharacterMaskConfig;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import java.io.IOException;
import java.util.Arrays;

public class DeIdentifyWithMasking {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToDeIdentify = "My SSN is 372819127";
    deIdentifyWithMasking(projectId, textToDeIdentify);
  }

  public static void deIdentifyWithMasking(String projectId, String textToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {

      // Specify what content you want the service to DeIdentify
      ContentItem contentItem = ContentItem.newBuilder().setValue(textToDeIdentify).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("US_SOCIAL_SECURITY_NUMBER").build();
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(Arrays.asList(infoType)).build();

      // Specify how the info from the inspection should be masked.
      CharacterMaskConfig characterMaskConfig =
          CharacterMaskConfig.newBuilder()
              .setMaskingCharacter("X") // Character to replace the found info with
              .setNumberToMask(5) // How many characters should be masked
              .build();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(ReplaceWithInfoTypeConfig.getDefaultInstance())
              .build();
      InfoTypeTransformation infoTypeTransformation =
          InfoTypeTransformation.newBuilder()
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      InfoTypeTransformations transformations =
          InfoTypeTransformations.newBuilder().addTransformations(infoTypeTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setInfoTypeTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setInspectConfig(inspectConfig)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results
      System.out.println("Text after masking: " + response.getItem().getValue());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-deidentify-masking-nodejs" track-metadata-position="dlp-deidentify-masking" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithMask.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithMask.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithMask.js" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithMask.js/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project-id';

// The string to deidentify
// const string = 'My SSN is 372819127';

// (Optional) The maximum number of sensitive characters to mask in a match
// If omitted from the request or set to 0, the API will mask any matching characters
// const numberToMask = 5;

// (Optional) The character to mask matching sensitive data with
// const maskingCharacter = 'x';

// Construct deidentification request
const item = {value: string};

async function deidentifyWithMask() {
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      infoTypeTransformations: {
        transformations: [
          {
            primitiveTransformation: {
              characterMaskConfig: {
                maskingCharacter: maskingCharacter,
                numberToMask: numberToMask,
              },
            },
          },
        ],
      },
    },
    item: item,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const deidentifiedItem = response.item;
  console.log(deidentifiedItem.value);
}

deidentifyWithMask();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-masking-python" track-metadata-position="dlp-deidentify-masking" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">def deidentify_with_mask(
    project, input_str, info_types, masking_character=None, number_to_mask=0
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by masking it with a character.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        masking_character: The character to mask matching sensitive data with.
        number_to_mask: The maximum number of sensitive characters to mask in
            a match. If omitted or set to zero, the API will default to no
            maximum.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {
                    "primitive_transformation": {
                        "character_mask_config": {
                            "masking_character": masking_character,
                            "number_to_mask": number_to_mask,
                        }
                    }
                }
            ]
        }
    }

    # Construct item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-deidentify-masking-go" track-metadata-position="dlp-deidentify-masking" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/mask.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/mask.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/mask.go" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/mask.go/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// mask deidentifies the input by masking all provided info types with maskingCharacter
// and prints the result to w.
func mask(w io.Writer, projectID, input string, infoTypeNames []string, maskingCharacter string, numberToMask int32) error {
	// projectID := "my-project-id"
	// input := "My SSN is 111222333"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// maskingCharacter := "+"
	// numberToMask := 6
	// Will print "My SSN is ++++++333"

	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Create a configured request.
	req := &amp;dlppb.DeidentifyContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: infoTypes,
		},
		DeidentifyConfig: &amp;dlppb.DeidentifyConfig{
			Transformation: &amp;dlppb.DeidentifyConfig_InfoTypeTransformations{
				InfoTypeTransformations: &amp;dlppb.InfoTypeTransformations{
					Transformations: []*dlppb.InfoTypeTransformations_InfoTypeTransformation{
						{
							InfoTypes: []*dlppb.InfoType{}, // Match all info types.
							PrimitiveTransformation: &amp;dlppb.PrimitiveTransformation{
								Transformation: &amp;dlppb.PrimitiveTransformation_CharacterMaskConfig{
									CharacterMaskConfig: &amp;dlppb.CharacterMaskConfig{
										MaskingCharacter: maskingCharacter,
										NumberToMask:     numberToMask,
									},
								},
							},
						},
					},
				},
			},
		},
		// The item to analyze.
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: input,
			},
		},
	}
	// Send the request.
	r, err := client.DeidentifyContent(ctx, req)
	if err != nil {
		return fmt.Errorf("DeidentifyContent: %v", err)
	}
	// Print the result.
	fmt.Fprint(w, r.GetItem().GetValue())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-masking-php" track-metadata-position="dlp-deidentify-masking" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_mask.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_mask.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_mask.php" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_mask.php/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\CharacterMaskConfig;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\PrimitiveTransformation;
use Google\Cloud\Dlp\V2\DeidentifyConfig;
use Google\Cloud\Dlp\V2\InfoTypeTransformations\InfoTypeTransformation;
use Google\Cloud\Dlp\V2\InfoTypeTransformations;
use Google\Cloud\Dlp\V2\ContentItem;

/**
 * Deidentify sensitive data in a string by masking it with a character.
 *
 * @param string $callingProjectId The GCP Project ID to run the API call under
 * @param string $string           The string to deidentify
 * @param int    $numberToMask     (Optional) The maximum number of sensitive characters to mask in a match
 * @param string $maskingCharacter (Optional) The character to mask matching sensitive data with (defaults to "x")
 */
function deidentify_mask(
    string $callingProjectId,
    string $string,
    int $numberToMask = 0,
    string $maskingCharacter = 'x'
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // The infoTypes of information to mask
    $ssnInfoType = (new InfoType())
        -&gt;setName('US_SOCIAL_SECURITY_NUMBER');
    $infoTypes = [$ssnInfoType];

    // Create the masking configuration object
    $maskConfig = (new CharacterMaskConfig())
        -&gt;setMaskingCharacter($maskingCharacter)
        -&gt;setNumberToMask($numberToMask);

    // Create the information transform configuration objects
    $primitiveTransformation = (new PrimitiveTransformation())
        -&gt;setCharacterMaskConfig($maskConfig);

    $infoTypeTransformation = (new InfoTypeTransformation())
        -&gt;setPrimitiveTransformation($primitiveTransformation)
        -&gt;setInfoTypes($infoTypes);

    $infoTypeTransformations = (new InfoTypeTransformations())
        -&gt;setTransformations([$infoTypeTransformation]);

    // Create the deidentification configuration object
    $deidentifyConfig = (new DeidentifyConfig())
        -&gt;setInfoTypeTransformations($infoTypeTransformations);

    $item = (new ContentItem())
        -&gt;setValue($string);

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;deidentifyContent([
        'parent' =&gt; $parent,
        'deidentifyConfig' =&gt; $deidentifyConfig,
        'item' =&gt; $item
    ]);

    // Print the results
    $deidentifiedValue = $response-&gt;getItem()-&gt;getValue();
    print($deidentifiedValue);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-masking-csharp" track-metadata-position="dlp-deidentify-masking" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-masking" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithMasking.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithMasking.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-masking" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithMasking.cs" data-region-tag="dlp_deidentify_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithMasking.cs/HEAD/dlp_deidentify_masking" translate="no"><code dir="ltr" translate="no">
using System;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;

public class DeidentifyWithMasking
{
    public static DeidentifyContentResponse Deidentify(string projectId, string text)
    {
        // Instantiate a client.
        var dlp = DlpServiceClient.Create();

        // Construct a request.
        var transformation = new InfoTypeTransformations.Types.InfoTypeTransformation
        {
            PrimitiveTransformation = new PrimitiveTransformation
            {
                CharacterMaskConfig = new CharacterMaskConfig
                {
                    MaskingCharacter = "*",
                    NumberToMask = 5,
                    ReverseOrder = false,
                }
            }
        };
        var request = new DeidentifyContentRequest
        {
            Parent = new LocationName(projectId, "global").ToString(),
            InspectConfig = new InspectConfig
            {
                InfoTypes =
                {
                    new InfoType { Name = "US_SOCIAL_SECURITY_NUMBER" }
                }
            },
            DeidentifyConfig = new DeidentifyConfig
            {
                InfoTypeTransformations = new InfoTypeTransformations
                {
                    Transformations = { transformation }
                }
            },
            Item = new ContentItem { Value = text }
        };

        // Call the API.
        var response = dlp.DeidentifyContent(request);

        // Inspect the results.
        Console.WriteLine($"Deidentified content: {response.Item.Value}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h3 data-text="Crypto-based tokenization transformations" id="crypto">Crypto-based tokenization transformations</h3>
<p>Crypto-based tokenization (also referred to as "pseudonymization")
transformations are de-identification methods that replace the original
sensitive data values with encrypted values. Cloud DLP supports the
following types of tokenization, including transformations that can be reversed
and allow for re-identification:</p>
<ul>
<li><a href="#crypto-hashing">Cryptographic hashing</a>: Given a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>,
Cloud DLP uses a SHA-256-based message authentication code
(<a class="external" href="https://tools.ietf.org/html/rfc4634" target="_blank">HMAC-SHA-256</a>)
on the input value, and then replaces the input value with the hashed value
encoded in base64.</li>
<li><a href="#fpe">Format preserving encryption</a>: Replaces an input value with a token
that has been generated using <a class="external" href="https://en.wikipedia.org/wiki/Format-preserving_encryption" target="_blank">format-preserving encryption
(FPE)</a> 
with the FFX mode of operation. This transformation method produces a token
that is limited to the same alphabet as the input value and is the same
length as the input value. FPE also supports re-identification given the
original encryption key.</li>
<li><a href="#de">Deterministic encryption</a>: Replaces an input value with a token that
has been generated using <a class="external" href="https://tools.ietf.org/html/rfc5297" target="_blank">AES in Synthetic Initialization Vector mode
(AES-SIV)</a>.
This transformation method has no limitation on supported string character
sets, generates identical tokens for each instance of an identical input
value, and uses surrogates to enable re-identification given the original
encryption key.</li>
</ul>
<p><aside class="special"><strong>Note:</strong> When you use
  Cloud KMS for cryptographic operations,
  <a href="https://cloud.google.com/kms/pricing">charges apply</a>.</aside></p>
<h4 data-text="Cryptographic hashing" id="crypto-hashing">Cryptographic hashing</h4>
<p>The cryptographic hashing transformation
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptohashconfig"><code dir="ltr" translate="no">CryptoHashConfig</code></a>
in the DLP API) takes an input value (a piece of sensitive data that
Cloud DLP has detected) and replaces it with a hashed value. The
hash value is generated by using a SHA-256-based message authentication code
(<a class="external" href="https://tools.ietf.org/html/rfc4634" target="_blank">HMAC-SHA-256</a>)
) on the input value with a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>.</p>
<p>Cloud DLP outputs a base64-encoded representation of the hashed
input value in the place of the original value.</p>
<p>Before using the cryptographic hashing transformation, keep in mind the following:</p>
<ul>
<li>The input value is not encrypted but hashed.</li>
<li>This transformation can't be reversed. That is, given the hashed output
value of the transformation and the original cryptographic key, there is no
way to restore the original value.</li>
<li>Currently, only string and integer values can be hashed.</li>
<li>The hashed output of the transformation is always the same length,
depending on the size of the cryptographic key. For example, if you use
the cryptographic hashing transformation on 10-digit phone numbers,
each phone number will be replaced by a fixed-length base64-encoded
hash value.</li>
</ul>
<h4 data-text="Format-preserving encryption" id="fpe">Format-preserving encryption</h4>
<p>The format-preserving encryption (FPE) transformation method
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a>
in the DLP API) takes an input value (a piece of sensitive data
that Cloud DLP has detected), encrypts it using format-preserving
encryption in FFX mode and a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>,
and then replaces the original value with the encrypted value, or token.</p>
<p>The input value:</p>
<ul>
<li>Must be at least two characters long (or the empty string).</li>
<li>Must be encoded as ASCII.</li>
<li>Comprised of the characters specified by an "alphabet," which is the set
of between 2 and 95 allowed characters in the input value. For
more information, see the alphabet field in
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptoreplaceffxfpeconfig"><code dir="ltr" translate="no">CryptoReplaceFfxFpeConfig</code></a>.</li>
</ul>
<p>The generated token:</p>
<ul>
<li>Is the encrypted input value.</li>
<li>Preserves the character set ("alphabet") and length of the input value
post-encryption.</li>
<li>Is computed using format-preserving encryption in FFX mode keyed on the
specified cryptographic key.</li>
<li>Isn't necessarily unique, as each instance of the same input value
de-identifies to the same token. This enables referential integrity, and
therefore enables more efficient searching of de-identified data.
You can change this behavior by using context "tweaks," as
described in <a href="/dlp/docs/pseudonymization#contexts">Contexts</a>.</li>
</ul>
<p>If there are multiple instances of an input value in the source content, each
one will be de-identified to the same token. FPE preserves both length and
alphabet space (the character set), which is limited to 95 characters. You can
change this behavior by using context "tweaks," which can improve security. The
addition of a context tweak to the transformation enables Cloud DLP
to de-identify multiple instances of the same input value to different tokens.
If you don't need to preserve the length and alphabet space of the original
values, use <a href="#de">deterministic encryption</a>, described below.</p>
<p>Cloud DLP computes the replacement token using a cryptographic key.
You provide this key in one of three ways:</p>
<ul>
<li>By embedding it unencrypted in the API request. This is not recommended.</li>
<li>By requesting that Cloud DLP generate it.</li>
<li>By embedding it encrypted in the API request.</li>
</ul>
<p id="decode-wrapped-key">If you choose to embed the key in the API request, you need to
create a key and wrap (encrypt) it using a
Cloud Key Management Service (Cloud KMS) key. For more information, see <a href="/dlp/docs/create-wrapped-key">Create a
wrapped key</a>. The value returned is a
base64-encoded string by default. To set this value in
Cloud DLP, you must decode it into a byte string. The following
code snippets highlight how to do this in several languages.
End-to-end examples are provided following these snippets.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="decoding-key">
<section>
<h3 data-text="Java" id="dlp-deidentify-masking-java" track-metadata-position="dlp-deidentify-masking" track-name="java" track-type="sampleTabNav">Java</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">KmsWrappedCryptoKey.newBuilder()
    .setWrappedKey(ByteString.copyFrom(BaseEncoding.base64().decode(wrappedKey)))
</code></pre>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-masking-python" track-metadata-position="dlp-deidentify-masking" track-name="python" track-type="sampleTabNav">Python</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no"># The wrapped key is base64-encoded, but the library expects a binary
# string, so decode it here.
import base64
wrapped_key = base64.b64decode(wrapped_key)
</code></pre>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-masking-php" track-metadata-position="dlp-deidentify-masking" track-name="php" track-type="sampleTabNav">PHP</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">// Create the wrapped crypto key configuration object
$kmsWrappedCryptoKey = (new KmsWrappedCryptoKey())
    -&gt;setWrappedKey(base64_decode($wrappedKey))
    -&gt;setCryptoKeyName($keyName);
</code></pre>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-masking-csharp" track-metadata-position="dlp-deidentify-masking" track-name="csharp" track-type="sampleTabNav">C#</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">WrappedKey = ByteString.FromBase64(wrappedKey)
</code></pre>
</section>
</div>
<p>For more information about encrypting and decrypting data using
Cloud KMS, see <a href="/kms/docs/encrypt-decrypt">Encrypting and Decrypting
Data</a>.</p>
<p>Following is sample code in several languages that demonstrates how to use
Cloud DLP to de-identify sensitive data by replacing an input
value with a token.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-fpe-code-sample">
<section>
<h3 data-text="Java" id="dlp-deidentify-fpe-java" track-metadata-position="dlp-deidentify-fpe" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithFpe.java/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.common.io.BaseEncoding;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CryptoKey;
import com.google.privacy.dlp.v2.CryptoReplaceFfxFpeConfig;
import com.google.privacy.dlp.v2.CryptoReplaceFfxFpeConfig.FfxCommonNativeAlphabet;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.KmsWrappedCryptoKey;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.protobuf.ByteString;
import java.io.IOException;
import java.util.Arrays;

public class DeIdentifyWithFpe {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToDeIdentify = "I'm Gary and my email is gary@example.com";
    String kmsKeyName =
        "projects/YOUR_PROJECT/"
            + "locations/YOUR_KEYRING_REGION/"
            + "keyRings/YOUR_KEYRING_NAME/"
            + "cryptoKeys/YOUR_KEY_NAME";
    String wrappedAesKey = "YOUR_ENCRYPTED_AES_256_KEY";
    deIdentifyWithFpe(projectId, textToDeIdentify, kmsKeyName, wrappedAesKey);
  }

  public static void deIdentifyWithFpe(
      String projectId, String textToDeIdentify, String kmsKeyName, String wrappedAesKey)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to DeIdentify
      ContentItem contentItem = ContentItem.newBuilder().setValue(textToDeIdentify).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("US_SOCIAL_SECURITY_NUMBER").build();
      InspectConfig inspectConfig =
          InspectConfig.newBuilder().addAllInfoTypes(Arrays.asList(infoType)).build();

      // Specify an encrypted AES-256 key and the name of the Cloud KMS key that encrypted it
      KmsWrappedCryptoKey kmsWrappedCryptoKey =
          KmsWrappedCryptoKey.newBuilder()
              .setWrappedKey(ByteString.copyFrom(BaseEncoding.base64().decode(wrappedAesKey)))
              .setCryptoKeyName(kmsKeyName)
              .build();
      CryptoKey cryptoKey = CryptoKey.newBuilder().setKmsWrapped(kmsWrappedCryptoKey).build();

      // Specify how the info from the inspection should be encrypted.
      InfoType surrogateInfoType = InfoType.newBuilder().setName("SSN_TOKEN").build();
      CryptoReplaceFfxFpeConfig cryptoReplaceFfxFpeConfig =
          CryptoReplaceFfxFpeConfig.newBuilder()
              .setCryptoKey(cryptoKey)
              // Set of characters in the input text. For more info, see
              // https://cloud.google.com/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.FfxCommonNativeAlphabet
              .setCommonAlphabet(FfxCommonNativeAlphabet.NUMERIC)
              .setSurrogateInfoType(surrogateInfoType)
              .build();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setCryptoReplaceFfxFpeConfig(cryptoReplaceFfxFpeConfig)
              .build();
      InfoTypeTransformation infoTypeTransformation =
          InfoTypeTransformation.newBuilder()
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      InfoTypeTransformations transformations =
          InfoTypeTransformations.newBuilder().addTransformations(infoTypeTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setInfoTypeTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setInspectConfig(inspectConfig)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results
      System.out.println(
          "Text after format-preserving encryption: " + response.getItem().getValue());
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-deidentify-fpe-nodejs" track-metadata-position="dlp-deidentify-fpe" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithFpe.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithFpe.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithFpe.js" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithFpe.js/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// The project ID to run the API call under
// const projectId = 'my-project';

// The string to deidentify
// const string = 'My SSN is 372819127';

// The set of characters to replace sensitive ones with
// For more information, see https://cloud.google.com/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#ffxcommonnativealphabet
// const alphabet = 'ALPHA_NUMERIC';

// The name of the Cloud KMS key used to encrypt ('wrap') the AES-256 key
// const keyName = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME';

// The encrypted ('wrapped') AES-256 key to use
// This key should be encrypted using the Cloud KMS key specified above
// const wrappedKey = 'YOUR_ENCRYPTED_AES_256_KEY'

// (Optional) The name of the surrogate custom info type to use
// Only necessary if you want to reverse the deidentification process
// Can be essentially any arbitrary string, as long as it doesn't appear
// in your dataset otherwise.
// const surrogateType = 'SOME_INFO_TYPE_DEID';

async function deidentifyWithFpe() {
  // Construct FPE config
  const cryptoReplaceFfxFpeConfig = {
    cryptoKey: {
      kmsWrapped: {
        wrappedKey: wrappedKey,
        cryptoKeyName: keyName,
      },
    },
    commonAlphabet: alphabet,
  };
  if (surrogateType) {
    cryptoReplaceFfxFpeConfig.surrogateInfoType = {
      name: surrogateType,
    };
  }

  // Construct deidentification request
  const item = {value: string};
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      infoTypeTransformations: {
        transformations: [
          {
            primitiveTransformation: {
              cryptoReplaceFfxFpeConfig: cryptoReplaceFfxFpeConfig,
            },
          },
        ],
      },
    },
    item: item,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const deidentifiedItem = response.item;
  console.log(deidentifiedItem.value);
}
deidentifyWithFpe();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-fpe-python" track-metadata-position="dlp-deidentify-fpe" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">

def deidentify_with_fpe(
    project,
    input_str,
    info_types,
    alphabet=None,
    surrogate_type=None,
    key_name=None,
    wrapped_key=None,
):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string using Format Preserving Encryption (FPE).
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_str: The string to deidentify (will be treated as text).
        alphabet: The set of characters to replace sensitive ones with. For
            more information, see https://cloud.google.com/dlp/docs/reference/
            rest/v2beta2/organizations.deidentifyTemplates#ffxcommonnativealphabet
        surrogate_type: The name of the surrogate custom info type to use. Only
            necessary if you want to reverse the deidentification process. Can
            be essentially any arbitrary string, as long as it doesn't appear
            in your dataset otherwise.
        key_name: The name of the Cloud KMS key used to encrypt ('wrap') the
            AES-256 key. Example:
            key_name = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/
            keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME'
        wrapped_key: The encrypted ('wrapped') AES-256 key to use. This key
            should be encrypted using the Cloud KMS key specified by key_name.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # The wrapped key is base64-encoded, but the library expects a binary
    # string, so decode it here.
    import base64

    wrapped_key = base64.b64decode(wrapped_key)

    # Construct FPE configuration dictionary
    crypto_replace_ffx_fpe_config = {
        "crypto_key": {
            "kms_wrapped": {"wrapped_key": wrapped_key, "crypto_key_name": key_name}
        },
        "common_alphabet": alphabet,
    }

    # Add surrogate type
    if surrogate_type:
        crypto_replace_ffx_fpe_config["surrogate_info_type"] = {"name": surrogate_type}

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {
                    "primitive_transformation": {
                        "crypto_replace_ffx_fpe_config": crypto_replace_ffx_fpe_config
                    }
                }
            ]
        }
    }

    # Convert string to item
    item = {"value": input_str}

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": item,
        }
    )

    # Print results
    print(response.item.value)

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-deidentify-fpe-go" track-metadata-position="dlp-deidentify-fpe" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/deid_fpe.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/deid_fpe.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/deid_fpe.go" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/deid_fpe.go/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"
	"io/ioutil"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deidentifyFPE deidentifies the input with FPE (Format Preserving Encryption).
// keyFileName is the file name with the KMS wrapped key and cryptoKeyName is the
// full KMS key resource name used to wrap the key. surrogateInfoType is an
// optional identifier needed for reidentification. surrogateInfoType can be any
// value not found in your input.
// Info types can be found with the infoTypes.list method or on https://cloud.google.com/dlp/docs/infotypes-reference
func deidentifyFPE(w io.Writer, projectID, input string, infoTypeNames []string, keyFileName, cryptoKeyName, surrogateInfoType string) error {
	// projectID := "my-project-id"
	// input := "My SSN is 123456789"
	// infoTypeNames := []string{"US_SOCIAL_SECURITY_NUMBER"}
	// keyFileName := "projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME"
	// cryptoKeyName := "YOUR_ENCRYPTED_AES_256_KEY"
	// surrogateInfoType := "AGE"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	// Convert the info type strings to a list of InfoTypes.
	var infoTypes []*dlppb.InfoType
	for _, it := range infoTypeNames {
		infoTypes = append(infoTypes, &amp;dlppb.InfoType{Name: it})
	}
	// Read the key file.
	keyBytes, err := ioutil.ReadFile(keyFileName)
	if err != nil {
		return fmt.Errorf("ReadFile: %v", err)
	}
	// Create a configured request.
	req := &amp;dlppb.DeidentifyContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: infoTypes,
		},
		DeidentifyConfig: &amp;dlppb.DeidentifyConfig{
			Transformation: &amp;dlppb.DeidentifyConfig_InfoTypeTransformations{
				InfoTypeTransformations: &amp;dlppb.InfoTypeTransformations{
					Transformations: []*dlppb.InfoTypeTransformations_InfoTypeTransformation{
						{
							InfoTypes: []*dlppb.InfoType{}, // Match all info types.
							PrimitiveTransformation: &amp;dlppb.PrimitiveTransformation{
								Transformation: &amp;dlppb.PrimitiveTransformation_CryptoReplaceFfxFpeConfig{
									CryptoReplaceFfxFpeConfig: &amp;dlppb.CryptoReplaceFfxFpeConfig{
										CryptoKey: &amp;dlppb.CryptoKey{
											Source: &amp;dlppb.CryptoKey_KmsWrapped{
												KmsWrapped: &amp;dlppb.KmsWrappedCryptoKey{
													WrappedKey:    keyBytes,
													CryptoKeyName: cryptoKeyName,
												},
											},
										},
										// Set the alphabet used for the output.
										Alphabet: &amp;dlppb.CryptoReplaceFfxFpeConfig_CommonAlphabet{
											CommonAlphabet: dlppb.CryptoReplaceFfxFpeConfig_ALPHA_NUMERIC,
										},
										// Set the surrogate info type, used for reidentification.
										SurrogateInfoType: &amp;dlppb.InfoType{
											Name: surrogateInfoType,
										},
									},
								},
							},
						},
					},
				},
			},
		},
		// The item to analyze.
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: input,
			},
		},
	}
	// Send the request.
	r, err := client.DeidentifyContent(ctx, req)
	if err != nil {
		return fmt.Errorf("DeidentifyContent: %v", err)
	}
	// Print the result.
	fmt.Fprint(w, r.GetItem().GetValue())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-fpe-php" track-metadata-position="dlp-deidentify-fpe" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_fpe.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_fpe.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_fpe.php" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_fpe.php/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">use Google\Cloud\Dlp\V2\CryptoReplaceFfxFpeConfig;
use Google\Cloud\Dlp\V2\CryptoReplaceFfxFpeConfig\FfxCommonNativeAlphabet;
use Google\Cloud\Dlp\V2\CryptoKey;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\PrimitiveTransformation;
use Google\Cloud\Dlp\V2\KmsWrappedCryptoKey;
use Google\Cloud\Dlp\V2\InfoType;
use Google\Cloud\Dlp\V2\DeidentifyConfig;
use Google\Cloud\Dlp\V2\InfoTypeTransformations\InfoTypeTransformation;
use Google\Cloud\Dlp\V2\InfoTypeTransformations;
use Google\Cloud\Dlp\V2\ContentItem;

/**
 * Deidentify a string using Format-Preserving Encryption (FPE).
 *
 * @param string $callingProjectId  The GCP Project ID to run the API call under
 * @param string $string            The string to deidentify
 * @param string $keyName           The name of the Cloud KMS key used to encrypt (wrap) the AES-256 key
 * @param string $wrappedKey        The name of the Cloud KMS key use, encrypted with the KMS key in $keyName
 * @param string $surrogateTypeName (Optional) surrogate custom info type to enable reidentification
 */
function deidentify_fpe(
    string $callingProjectId,
    string $string,
    string $keyName,
    string $wrappedKey,
    string $surrogateTypeName = ''
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // The infoTypes of information to mask
    $ssnInfoType = (new InfoType())
        -&gt;setName('US_SOCIAL_SECURITY_NUMBER');
    $infoTypes = [$ssnInfoType];

    // Create the wrapped crypto key configuration object
    $kmsWrappedCryptoKey = (new KmsWrappedCryptoKey())
        -&gt;setWrappedKey(base64_decode($wrappedKey))
        -&gt;setCryptoKeyName($keyName);

    // The set of characters to replace sensitive ones with
    // For more information, see https://cloud.google.com/dlp/docs/reference/rest/V2/organizations.deidentifyTemplates#ffxcommonnativealphabet
    $commonAlphabet = FfxCommonNativeAlphabet::NUMERIC;

    // Create the crypto key configuration object
    $cryptoKey = (new CryptoKey())
        -&gt;setKmsWrapped($kmsWrappedCryptoKey);

    // Create the crypto FFX FPE configuration object
    $cryptoReplaceFfxFpeConfig = (new CryptoReplaceFfxFpeConfig())
        -&gt;setCryptoKey($cryptoKey)
        -&gt;setCommonAlphabet($commonAlphabet);

    if ($surrogateTypeName) {
        $surrogateType = (new InfoType())
            -&gt;setName($surrogateTypeName);
        $cryptoReplaceFfxFpeConfig-&gt;setSurrogateInfoType($surrogateType);
    }

    // Create the information transform configuration objects
    $primitiveTransformation = (new PrimitiveTransformation())
        -&gt;setCryptoReplaceFfxFpeConfig($cryptoReplaceFfxFpeConfig);

    $infoTypeTransformation = (new InfoTypeTransformation())
        -&gt;setPrimitiveTransformation($primitiveTransformation)
        -&gt;setInfoTypes($infoTypes);

    $infoTypeTransformations = (new InfoTypeTransformations())
        -&gt;setTransformations([$infoTypeTransformation]);

    // Create the deidentification configuration object
    $deidentifyConfig = (new DeidentifyConfig())
        -&gt;setInfoTypeTransformations($infoTypeTransformations);

    $content = (new ContentItem())
        -&gt;setValue($string);

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;deidentifyContent([
        'parent' =&gt; $parent,
        'deidentifyConfig' =&gt; $deidentifyConfig,
        'item' =&gt; $content
    ]);

    // Print the results
    $deidentifiedValue = $response-&gt;getItem()-&gt;getValue();
    print($deidentifiedValue);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-fpe-csharp" track-metadata-position="dlp-deidentify-fpe" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-fpe" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithFpe.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithFpe.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-fpe" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-fpe" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithFpe.cs" data-region-tag="dlp_deidentify_fpe" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithFpe.cs/HEAD/dlp_deidentify_fpe" translate="no"><code dir="ltr" translate="no">
using System;
using System.Collections.Generic;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;
using static Google.Cloud.Dlp.V2.CryptoReplaceFfxFpeConfig.Types;

public class DeidentifyWithFpe
{
    public static DeidentifyContentResponse Deidentify(
        string projectId,
        string dataValue,
        IEnumerable&lt;InfoType&gt; infoTypes,
        string keyName,
        string wrappedKey,
        FfxCommonNativeAlphabet alphabet)
    {
        var deidentifyConfig = new DeidentifyConfig
        {
            InfoTypeTransformations = new InfoTypeTransformations
            {
                Transformations =
                {
                    new InfoTypeTransformations.Types.InfoTypeTransformation
                    {
                        PrimitiveTransformation = new PrimitiveTransformation
                        {
                            CryptoReplaceFfxFpeConfig = new CryptoReplaceFfxFpeConfig
                            {
                                CommonAlphabet = alphabet,
                                CryptoKey = new CryptoKey
                                {
                                    KmsWrapped = new KmsWrappedCryptoKey
                                    {
                                        CryptoKeyName = keyName,
                                        WrappedKey = ByteString.FromBase64 (wrappedKey)
                                    }
                                },
                                SurrogateInfoType = new InfoType
                                {
                                    Name = "TOKEN"
                                }
                            }
                        }
                    }
                }
            }
        };

        var dlp = DlpServiceClient.Create();
        var response = dlp.DeidentifyContent(
            new DeidentifyContentRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
                InspectConfig = new InspectConfig
                {
                    InfoTypes = { infoTypes }
                },
                DeidentifyConfig = deidentifyConfig,
                Item = new ContentItem { Value = dataValue }
            });

        Console.WriteLine($"Deidentified content: {response.Item.Value}");
        return response;
    }
}
</code></pre>
</div>
</section>
</div>
<h4 data-text="Deterministic encryption" id="de">Deterministic encryption</h4>
<p>The deterministic encryption transformation method
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptodeterministicconfig"><code dir="ltr" translate="no">CryptoDeterministicConfig</code></a>
in the DLP API takes an input value (a piece of sensitive data that
Cloud DLP has detected), encrypts it using
<a class="external" href="https://tools.ietf.org/html/rfc5297" target="_blank">AES-SIV</a> 
with a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>,
and then replaces the original value with a base64-encoded representation of
the encrypted value.</p>
<p>Using the deterministic encryption transformation enables more efficient
searching of encrypted data.</p>
<p>The input value:</p>
<ul>
<li>Must be at least 1 character long.</li>
<li>Has no character set limitations.</li>
</ul>
<p>The generated token:</p>
<ul>
<li>Is a base64-encoded representation of the encrypted value.</li>
<li>Does not preserve the character set ("alphabet") or length of the input
value post-encryption.</li>
<li>Is computed using AES encryption in SIV mode (AES-SIV) with a
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>.</li>
<li>Isn't necessarily unique, as each instance of the same input value
de-identifies to the same token. This enables more efficient searching of
encrypted data. You can change this behavior by using context
"tweaks," as described in <a href="/dlp/docs/pseudonymization#contexts">Contexts</a>.</li>
<li>Is generated with a prefix added, in the form <code dir="ltr" translate="no">[SURROGATE_TYPE]([LENGTH]):</code>,
where <code dir="ltr" translate="no">[SURROGATE_TYPE]</code> represents a <a href="/dlp/docs/reference/rest/v2/InspectConfig#surrogatetype">surrogate
infoType</a>
describing the input value, and <code dir="ltr" translate="no">[LENGTH]</code> indicates its character length.
The surrogate enables the token to be re-identified using the original
encryption key used for de-identification.</li>
</ul>
<aside class="note"><strong>Note:</strong><span> For more information about surrogate types, see <a href="/dlp/docs/pseudonymization#surrogate_annotations">Surrogate
annotations</a>.</span></aside>
<p>Following is an example JSON configuration for de-identification using
deterministic encryption. Note that we've chosen to use "PHONE_SURROGATE" as
our descriptive surrogate type since we're de-identifying telephone numbers.
<code dir="ltr" translate="no">[CRYPTO_KEY]</code> represents an unwrapped cryptographic key obtained from
Cloud KMS.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"PHONE_NUMBER"
            }
          ],
          "primitiveTransformation":{
            "cryptoDeterministicConfig":{
              "cryptoKey":{
                "unwrapped":{
                  "key":"[CRYPTO_KEY]"
                }
              },
              "surrogateInfoType":{
                "name":"PHONE_SURROGATE"
              }
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"PHONE_NUMBER"
      }
    ]
  },
  "item":{
    "value":"My phone number is 206-555-0574, call me"
  }
}
</code></pre>
<p>De-identifying the string "My phone number is 206-555-0574" using this
transformation results in a de-identified string such as the following:</p>
<pre dir="ltr" translate="no">My phone number is PHONE_SURROGATE(36):ATZBu5OCCSwo+e94xSYnKYljk1OQpkW7qhzx, call me</pre>
<p>To re-identify this string, you can use a JSON request like the following,
where [CRYPTO_KEY] is the same cryptographic key used to de-identify the
content.</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "reidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"PHONE_SURROGATE"
            }
          ],
          "primitiveTransformation":{
            "cryptoDeterministicConfig":{
              "cryptoKey":{
                "unwrapped":{
                  "key":"[CRYPTO_KEY]"
                }
              },
              "surrogateInfoType":{
                "name":"PHONE_SURROGATE"
              }
            }
          }
        }
      ]
    }
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"PHONE_SURROGATE"
        },
        "surrogateType":{

        }
      }
    ]
  },
  "item":{
    "value":"My phone number is [PHONE_SURROGATE](36):ATZBu5OCCSwo+e94xSYnKYljk1OQpkW7qhzx, call me"
  }
}
</code></pre>
<p>Re-identifying this string results in the original string:</p>
<pre dir="ltr" translate="no">My phone number is 206-555-0574, call me</pre>
<p>If you want to use a wrapped (encrypted) <code dir="ltr" translate="no">CryptoKey</code> instead for better
security, see <a href="/dlp/docs/inspect-sensitive-text-de-identify">Quickstart: De-identifying and re-identifying
sensitive text</a> for an example. When you're
ready to use a client library to de-identify content, remember to decode the
wrapped key (which is a base64-encoded string by default), as demonstrated in
<a href="/dlp/docs/transformations-reference#decode-wrapped-key">Format-preserving encryption</a>
on this page.</p>
<h3 data-text="Bucketing" id="bucketing">Bucketing</h3>
<p>The bucketing transformations serve to de-identify numerical data by "bucketing"
it into ranges. The resulting number range is a hyphenated string consisting of
a lower bound, a hyphen, and an upper bound.</p>
<h4 data-text="Fixed-size bucketing" id="fixed-bucket">Fixed-size bucketing</h4>
<p>Cloud DLP can bucket numerical input values based on fixed size ranges
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#fixedsizebucketingconfig"><code dir="ltr" translate="no">FixedSizeBucketingConfig</code></a>
in the DLP API). You specify the following to configure fixed-size bucketing:</p>
<ul>
<li>The lower bound value of all of the buckets. Any values less than the lower
bound are grouped together in a single bucket.</li>
<li>The upper bound value of all of the buckets. Any values greater than the
upper bound are grouped together in a single bucket.</li>
<li>The size of each bucket other than the minimum and maximum buckets.</li>
</ul>
<p>For example, if the lower bound is set to 10, the upper bound is set to 89, and
 the bucket size is set to 10, then the following buckets would be used: -10,
 10-20, 20-30, 30-40, 40-50, 50-60, 60-70, 70-80, 80-89, 89+.</p>
<p>For more information about the concept of bucketing, see <a href="/dlp/docs/concepts-bucketing">Generalization and
Bucketing</a>.</p>
<h4 data-text="Customizable bucketing" id="custom-bucket">Customizable bucketing</h4>
<p>Customizable bucketing
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#fixedsizebucketingconfig"><code dir="ltr" translate="no">BucketingConfig</code></a>
in the DLP API) offers more flexibility than fixed size bucketing.
Instead of specifying upper and lower bounds and an interval value with which to
create equal-sized buckets, you specify the maximum and minimum values for each
bucket you want created. Each maximum and minimum value pair must have the same
type.</p>
<p>You set up customizable bucketing by specifying individual buckets. Each bucket
has the following properties:</p>
<ul>
<li>The lower bound of the bucket's range. Omit this value to create a bucket
that has no lower bound.</li>
<li>The upper bound of the bucket's range. Omit this value to create a bucket
that has no upper bound.</li>
<li>The replacement value for this bucket range. This is the value with which
to replace all detected values that fall within the lower and upper bounds.
If you don't provide a replacement value, a hyphenated min-max range will be
generated instead.</li>
</ul>
<p>For example, consider the following JSON configuration for this bucketing
transformation:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"bucketingConfig":{
  "buckets":[
    {
      "min":{
        "integerValue":"1"
      },
      "max":{
        "integerValue":"30"
      },
      "replacementValue":{
        "stringValue":"LOW"
      }
    },
    {
      "min":{
        "integerValue":"31"
      },
      "max":{
        "integerValue":"65"
      },
      "replacementValue":{
        "stringValue":"MEDIUM"
      }
    },
    {
      "min":{
        "integerValue":"66"
      },
      "max":{
        "integerValue":"100"
      },
      "replacementValue":{
        "stringValue":"HIGH"
      }
    }
  ]
}
</code></pre>
<p>This defines the following behavior:</p>
<ul>
<li>Integer values falling between 1 and 30 are masked by being replaced with
<code dir="ltr" translate="no">LOW</code>.</li>
<li>Integer values falling between 31-65 are masked by being replaced with
<code dir="ltr" translate="no">MEDIUM</code>.</li>
<li>Integer values falling between 66-100 are masked by being replaced with
<code dir="ltr" translate="no">HIGH</code>.</li>
</ul>
<p>For more information about the concept of bucketing, see <a href="/dlp/docs/concepts-bucketing">Generalization and
Bucketing</a>.</p>
<h3 data-text="Date shifting" id="date-shift">Date shifting</h3>
<p>When you use the date shifting transformation
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#dateshiftconfig"><code dir="ltr" translate="no">DateShiftConfig</code></a>
in the DLP API on a date input value, Cloud DLP shifts the
dates by a random number of days.</p>
<p>Date shifting techniques randomly shift a set of dates but preserve the
sequence and duration of a period of time. Shifting dates is usually done in
context to an individual or an entity. That is, you want to shift all of the
dates for a specific individual using the same shift differential but use a
separate shift differential for each other individual.</p>
<p>For more information about date shifting, see <a href="/dlp/docs/concepts-date-shifting">Date
shifting</a>.</p>
<p>Following is sample code in several languages that demonstrates how to use the
Cloud DLP API to de-identify dates using date shifting.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deidentify-date-shift-code-sample">
<section>
<h3 data-text="Java" id="dlp-deidentify-date-shift-java" track-metadata-position="dlp-deidentify-date-shift" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithDateShift.java/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.common.base.Splitter;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DateShiftConfig;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.FieldTransformation;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Value;
import com.google.type.Date;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

public class DeIdentifyWithDateShift {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Path inputCsvFile = Paths.get("path/to/your/input/file.csv");
    Path outputCsvFile = Paths.get("path/to/your/output/file.csv");
    deIdentifyWithDateShift(projectId, inputCsvFile, outputCsvFile);
  }

  public static void deIdentifyWithDateShift(
      String projectId, Path inputCsvFile, Path outputCsvFile) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Read the contents of the CSV file into a Table
      List&lt;FieldId&gt; headers;
      List&lt;Table.Row&gt; rows;
      try (BufferedReader input = Files.newBufferedReader(inputCsvFile)) {
        // Parse and convert the first line into header names
        headers =
            Arrays.stream(input.readLine().split(","))
                .map(header -&gt; FieldId.newBuilder().setName(header).build())
                .collect(Collectors.toList());
        // Parse the remainder of the file as Table.Rows
        rows =
            input.lines().map(DeIdentifyWithDateShift::parseLineAsRow).collect(Collectors.toList());
      }
      Table table = Table.newBuilder().addAllHeaders(headers).addAllRows(rows).build();
      ContentItem item = ContentItem.newBuilder().setTable(table).build();

      // Set the maximum days to shift dates backwards (lower bound) or forward (upper bound)
      DateShiftConfig dateShiftConfig =
          DateShiftConfig.newBuilder().setLowerBoundDays(5).setUpperBoundDays(5).build();
      PrimitiveTransformation transformation =
          PrimitiveTransformation.newBuilder().setDateShiftConfig(dateShiftConfig).build();
      // Specify which fields the DateShift should apply too
      List&lt;FieldId&gt; dateFields = Arrays.asList(headers.get(1), headers.get(3));
      FieldTransformation fieldTransformation =
          FieldTransformation.newBuilder()
              .addAllFields(dateFields)
              .setPrimitiveTransformation(transformation)
              .build();
      RecordTransformations recordTransformations =
          RecordTransformations.newBuilder().addFieldTransformations(fieldTransformation).build();
      // Specify the config for the de-identify request
      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(recordTransformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Write the results to the target CSV file
      try (BufferedWriter writer = Files.newBufferedWriter(outputCsvFile)) {
        Table outTable = response.getItem().getTable();
        String headerOut =
            outTable.getHeadersList().stream()
                .map(FieldId::getName)
                .collect(Collectors.joining(","));
        writer.write(headerOut + "\n");

        List&lt;String&gt; rowOutput =
            outTable.getRowsList().stream()
                .map(row -&gt; joinRow(row.getValuesList()))
                .collect(Collectors.toList());
        for (String line : rowOutput) {
          writer.write(line + "\n");
        }
        System.out.println("Content written to file: " + outputCsvFile.toString());
      }
    }
  }

  // Convert the string from the csv file into com.google.type.Date
  public static Date parseAsDate(String s) {
    LocalDate date = LocalDate.parse(s, DateTimeFormatter.ofPattern("MM/dd/yyyy"));
    return Date.newBuilder()
        .setDay(date.getDayOfMonth())
        .setMonth(date.getMonthValue())
        .setYear(date.getYear())
        .build();
  }

  // Each row is in the format: Name,BirthDate,CreditCardNumber,RegisterDate
  public static Table.Row parseLineAsRow(String line) {
    List&lt;String&gt; values = Splitter.on(",").splitToList(line);
    Value name = Value.newBuilder().setStringValue(values.get(0)).build();
    Value birthDate = Value.newBuilder().setDateValue(parseAsDate(values.get(1))).build();
    Value creditCardNumber = Value.newBuilder().setStringValue(values.get(2)).build();
    Value registerDate = Value.newBuilder().setDateValue(parseAsDate(values.get(3))).build();
    return Table.Row.newBuilder()
        .addValues(name)
        .addValues(birthDate)
        .addValues(creditCardNumber)
        .addValues(registerDate)
        .build();
  }

  public static String formatDate(Date d) {
    return String.format("%s/%s/%s", d.getMonth(), d.getDay(), d.getYear());
  }

  public static String joinRow(List&lt;Value&gt; values) {
    String name = values.get(0).getStringValue();
    String birthDate = formatDate(values.get(1).getDateValue());
    String creditCardNumber = values.get(2).getStringValue();
    String registerDate = formatDate(values.get(3).getDateValue());
    return String.join(",", name, birthDate, creditCardNumber, registerDate);
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Node.js" id="dlp-deidentify-date-shift-nodejs" track-metadata-position="dlp-deidentify-date-shift" track-name="nodejs" track-type="sampleTabNav">Node.js</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="nodejs" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithDateShift.js" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/nodejs-dlp/blob/HEAD/samples/deidentifyWithDateShift.js" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="nodejs" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-js" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/nodejs-dlp/samples/deidentifyWithDateShift.js" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/nodejs-dlp/samples/deidentifyWithDateShift.js/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">// Imports the Google Cloud Data Loss Prevention library
const DLP = require('@google-cloud/dlp');

// Instantiates a client
const dlp = new DLP.DlpServiceClient();

// Import other required libraries
const fs = require('fs');

// The project ID to run the API call under
// const projectId = 'my-project';

// The path to the CSV file to deidentify
// The first row of the file must specify column names, and all other rows
// must contain valid values
// const inputCsvFile = '/path/to/input/file.csv';

// The path to save the date-shifted CSV file to
// const outputCsvFile = '/path/to/output/file.csv';

// The list of (date) fields in the CSV file to date shift
// const dateFields = [{ name: 'birth_date'}, { name: 'register_date' }];

// The maximum number of days to shift a date backward
// const lowerBoundDays = 1;

// The maximum number of days to shift a date forward
// const upperBoundDays = 1;

// (Optional) The column to determine date shift amount based on
// If this is not specified, a random shift amount will be used for every row
// If this is specified, then 'wrappedKey' and 'keyName' must also be set
// const contextFieldId = [{ name: 'user_id' }];

// (Optional) The name of the Cloud KMS key used to encrypt ('wrap') the AES-256 key
// If this is specified, then 'wrappedKey' and 'contextFieldId' must also be set
// const keyName = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME';

// (Optional) The encrypted ('wrapped') AES-256 key to use when shifting dates
// This key should be encrypted using the Cloud KMS key specified above
// If this is specified, then 'keyName' and 'contextFieldId' must also be set
// const wrappedKey = 'YOUR_ENCRYPTED_AES_256_KEY'

// Helper function for converting CSV rows to Protobuf types
const rowToProto = row =&gt; {
  const values = row.split(',');
  const convertedValues = values.map(value =&gt; {
    if (Date.parse(value)) {
      const date = new Date(value);
      return {
        dateValue: {
          year: date.getFullYear(),
          month: date.getMonth() + 1,
          day: date.getDate(),
        },
      };
    } else {
      // Convert all non-date values to strings
      return {stringValue: value.toString()};
    }
  });
  return {values: convertedValues};
};

async function deidentifyWithDateShift() {
  // Read and parse a CSV file
  const csvLines = fs
    .readFileSync(inputCsvFile)
    .toString()
    .split('\n')
    .filter(line =&gt; line.includes(','));
  const csvHeaders = csvLines[0].split(',');
  const csvRows = csvLines.slice(1);

  // Construct the table object
  const tableItem = {
    table: {
      headers: csvHeaders.map(header =&gt; {
        return {name: header};
      }),
      rows: csvRows.map(row =&gt; rowToProto(row)),
    },
  };

  // Construct DateShiftConfig
  const dateShiftConfig = {
    lowerBoundDays: lowerBoundDays,
    upperBoundDays: upperBoundDays,
  };

  if (contextFieldId &amp;&amp; keyName &amp;&amp; wrappedKey) {
    dateShiftConfig.context = {name: contextFieldId};
    dateShiftConfig.cryptoKey = {
      kmsWrapped: {
        wrappedKey: wrappedKey,
        cryptoKeyName: keyName,
      },
    };
  } else if (contextFieldId || keyName || wrappedKey) {
    throw new Error(
      'You must set either ALL or NONE of {contextFieldId, keyName, wrappedKey}!'
    );
  }

  // Construct deidentification request
  const request = {
    parent: `projects/${projectId}/locations/global`,
    deidentifyConfig: {
      recordTransformations: {
        fieldTransformations: [
          {
            fields: dateFields,
            primitiveTransformation: {
              dateShiftConfig: dateShiftConfig,
            },
          },
        ],
      },
    },
    item: tableItem,
  };

  // Run deidentification request
  const [response] = await dlp.deidentifyContent(request);
  const tableRows = response.item.table.rows;

  // Write results to a CSV file
  tableRows.forEach((row, rowIndex) =&gt; {
    const rowValues = row.values.map(
      value =&gt;
        value.stringValue ||
        `${value.dateValue.month}/${value.dateValue.day}/${value.dateValue.year}`
    );
    csvLines[rowIndex + 1] = rowValues.join(',');
  });
  csvLines.push('');
  fs.writeFileSync(outputCsvFile, csvLines.join('\n'));

  // Print status
  console.log(`Successfully saved date-shift output to ${outputCsvFile}`);
}

deidentifyWithDateShift();</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-deidentify-date-shift-python" track-metadata-position="dlp-deidentify-date-shift" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">def deidentify_with_date_shift(
    project,
    input_csv_file=None,
    output_csv_file=None,
    date_fields=None,
    lower_bound_days=None,
    upper_bound_days=None,
    context_field_id=None,
    wrapped_key=None,
    key_name=None,
):
    """Uses the Data Loss Prevention API to deidentify dates in a CSV file by
        pseudorandomly shifting them.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        input_csv_file: The path to the CSV file to deidentify. The first row
            of the file must specify column names, and all other rows must
            contain valid values.
        output_csv_file: The path to save the date-shifted CSV file.
        date_fields: The list of (date) fields in the CSV file to date shift.
            Example: ['birth_date', 'register_date']
        lower_bound_days: The maximum number of days to shift a date backward
        upper_bound_days: The maximum number of days to shift a date forward
        context_field_id: (Optional) The column to determine date shift amount
            based on. If this is not specified, a random shift amount will be
            used for every row. If this is specified, then 'wrappedKey' and
            'keyName' must also be set. Example:
            contextFieldId = [{ 'name': 'user_id' }]
        key_name: (Optional) The name of the Cloud KMS key used to encrypt
            ('wrap') the AES-256 key. Example:
            key_name = 'projects/YOUR_GCLOUD_PROJECT/locations/YOUR_LOCATION/
            keyRings/YOUR_KEYRING_NAME/cryptoKeys/YOUR_KEY_NAME'
        wrapped_key: (Optional) The encrypted ('wrapped') AES-256 key to use.
            This key should be encrypted using the Cloud KMS key specified by
            key_name.
    Returns:
        None; the response from the API is printed to the terminal.
    """
    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Convert date field list to Protobuf type
    def map_fields(field):
        return {"name": field}

    if date_fields:
        date_fields = map(map_fields, date_fields)
    else:
        date_fields = []

    # Read and parse the CSV file
    import csv
    from datetime import datetime

    f = []
    with open(input_csv_file, "r") as csvfile:
        reader = csv.reader(csvfile)
        for row in reader:
            f.append(row)

    #  Helper function for converting CSV rows to Protobuf types
    def map_headers(header):
        return {"name": header}

    def map_data(value):
        try:
            date = datetime.strptime(value, "%m/%d/%Y")
            return {
                "date_value": {"year": date.year, "month": date.month, "day": date.day}
            }
        except ValueError:
            return {"string_value": value}

    def map_rows(row):
        return {"values": map(map_data, row)}

    # Using the helper functions, convert CSV rows to protobuf-compatible
    # dictionaries.
    csv_headers = map(map_headers, f[0])
    csv_rows = map(map_rows, f[1:])

    # Construct the table dict
    table_item = {"table": {"headers": csv_headers, "rows": csv_rows}}

    # Construct date shift config
    date_shift_config = {
        "lower_bound_days": lower_bound_days,
        "upper_bound_days": upper_bound_days,
    }

    # If using a Cloud KMS key, add it to the date_shift_config.
    # The wrapped key is base64-encoded, but the library expects a binary
    # string, so decode it here.
    if context_field_id and key_name and wrapped_key:
        import base64

        date_shift_config["context"] = {"name": context_field_id}
        date_shift_config["crypto_key"] = {
            "kms_wrapped": {
                "wrapped_key": base64.b64decode(wrapped_key),
                "crypto_key_name": key_name,
            }
        }
    elif context_field_id or key_name or wrapped_key:
        raise ValueError(
            """You must set either ALL or NONE of
        [context_field_id, key_name, wrapped_key]!"""
        )

    # Construct Deidentify Config
    deidentify_config = {
        "record_transformations": {
            "field_transformations": [
                {
                    "fields": date_fields,
                    "primitive_transformation": {
                        "date_shift_config": date_shift_config
                    },
                }
            ]
        }
    }

    # Write to CSV helper methods
    def write_header(header):
        return header.name

    def write_data(data):
        return data.string_value or "%s/%s/%s" % (
            data.date_value.month,
            data.date_value.day,
            data.date_value.year,
        )

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "item": table_item,
        }
    )

    # Write results to CSV file
    with open(output_csv_file, "w") as csvfile:
        write_file = csv.writer(csvfile, delimiter=",")
        write_file.writerow(map(write_header, response.item.table.headers))
        for row in response.item.table.rows:
            write_file.writerow(map(write_data, row.values))
    # Print status
    print("Successfully saved date-shift output to {}".format(output_csv_file))

</code></pre>
</div>
</section>
<section>
<h3 data-text="Go" id="dlp-deidentify-date-shift-go" track-metadata-position="dlp-deidentify-date-shift" track-name="go" track-type="sampleTabNav">Go</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="go" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/date_shift.go" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/dlp/snippets/deid/date_shift.go" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="go" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-golang" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/date_shift.go" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/golang-samples/dlp/snippets/deid/date_shift.go/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">import (
	"context"
	"fmt"
	"io"

	dlp "cloud.google.com/go/dlp/apiv2"
	dlppb "google.golang.org/genproto/googleapis/privacy/dlp/v2"
)

// deidentifyDateShift shifts dates found in the input between lowerBoundDays and
// upperBoundDays.
func deidentifyDateShift(w io.Writer, projectID string, lowerBoundDays, upperBoundDays int32, input string) error {
	// projectID := "my-project-id"
	// lowerBoundDays := -1
	// upperBound := -1
	// input := "2016-01-10"
	// Will print "2016-01-09"
	ctx := context.Background()
	client, err := dlp.NewClient(ctx)
	if err != nil {
		return fmt.Errorf("dlp.NewClient: %v", err)
	}
	defer client.Close()
	// Create a configured request.
	req := &amp;dlppb.DeidentifyContentRequest{
		Parent: fmt.Sprintf("projects/%s/locations/global", projectID),
		DeidentifyConfig: &amp;dlppb.DeidentifyConfig{
			Transformation: &amp;dlppb.DeidentifyConfig_InfoTypeTransformations{
				InfoTypeTransformations: &amp;dlppb.InfoTypeTransformations{
					Transformations: []*dlppb.InfoTypeTransformations_InfoTypeTransformation{
						{
							InfoTypes: []*dlppb.InfoType{}, // Match all info types.
							PrimitiveTransformation: &amp;dlppb.PrimitiveTransformation{
								Transformation: &amp;dlppb.PrimitiveTransformation_DateShiftConfig{
									DateShiftConfig: &amp;dlppb.DateShiftConfig{
										LowerBoundDays: lowerBoundDays,
										UpperBoundDays: upperBoundDays,
									},
								},
							},
						},
					},
				},
			},
		},
		// The InspectConfig is used to identify the DATE fields.
		InspectConfig: &amp;dlppb.InspectConfig{
			InfoTypes: []*dlppb.InfoType{
				{
					Name: "DATE",
				},
			},
		},
		// The item to analyze.
		Item: &amp;dlppb.ContentItem{
			DataItem: &amp;dlppb.ContentItem_Value{
				Value: input,
			},
		},
	}
	// Send the request.
	r, err := client.DeidentifyContent(ctx, req)
	if err != nil {
		return fmt.Errorf("DeidentifyContent: %v", err)
	}
	// Print the result.
	fmt.Fprint(w, r.GetItem().GetValue())
	return nil
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="PHP" id="dlp-deidentify-date-shift-php" track-metadata-position="dlp-deidentify-date-shift" track-name="php" track-type="sampleTabNav">PHP</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="php" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_dates.php" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/php-docs-samples/blob/HEAD/dlp/src/deidentify_dates.php" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="php" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-php" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_dates.php" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/php-docs-samples/dlp/src/deidentify_dates.php/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">use DateTime;
use Exception;
use Google\Cloud\Dlp\V2\ContentItem;
use Google\Cloud\Dlp\V2\CryptoKey;
use Google\Cloud\Dlp\V2\DateShiftConfig;
use Google\Cloud\Dlp\V2\DeidentifyConfig;
use Google\Cloud\Dlp\V2\DlpServiceClient;
use Google\Cloud\Dlp\V2\FieldId;
use Google\Cloud\Dlp\V2\FieldTransformation;
use Google\Cloud\Dlp\V2\KmsWrappedCryptoKey;
use Google\Cloud\Dlp\V2\PrimitiveTransformation;
use Google\Cloud\Dlp\V2\RecordTransformations;
use Google\Cloud\Dlp\V2\Table;
use Google\Cloud\Dlp\V2\Table\Row;
use Google\Cloud\Dlp\V2\Value;
use Google\Type\Date;

/**
 * Deidentify dates in a CSV file by pseudorandomly shifting them.
 * If contextFieldName is not specified, a random shift amount will be used for every row.
 * If contextFieldName is specified, then 'wrappedKey' and 'keyName' must also be set.
 *
 * @param string $callingProjectId  The GCP Project ID to run the API call under
 * @param string $inputCsvFile      The path to the CSV file to deidentify
 * @param string $outputCsvFile     The path to save the date-shifted CSV file to
 * @param string $dateFieldNames    The comma-separated list of (date) fields in the CSV file to date shift
 * @param string $lowerBoundDays    The maximum number of days to shift a date backward
 * @param string $upperBoundDays    The maximum number of days to shift a date forward
 * @param string $contextFieldName  (Optional) The column to determine date shift amount based on
 * @param string $keyName           (Optional) The encrypted ('wrapped') AES-256 key to use when shifting dates
 * @param string $wrappedKey        (Optional) The name of the Cloud KMS key used to encrypt (wrap) the AES-256 key
 */
function deidentify_dates(
    string $callingProjectId,
    string $inputCsvFile,
    string $outputCsvFile,
    string $dateFieldNames,
    string $lowerBoundDays,
    string $upperBoundDays,
    string $contextFieldName = '',
    string $keyName = '',
    string $wrappedKey = ''
): void {
    // Instantiate a client.
    $dlp = new DlpServiceClient();

    // Read a CSV file
    $csvLines = file($inputCsvFile, FILE_IGNORE_NEW_LINES);
    $csvHeaders = explode(',', $csvLines[0]);
    $csvRows = array_slice($csvLines, 1);

    // Convert CSV file into protobuf objects
    $tableHeaders = array_map(function ($csvHeader) {
        return (new FieldId)-&gt;setName($csvHeader);
    }, $csvHeaders);

    $tableRows = array_map(function ($csvRow) {
        $rowValues = array_map(function ($csvValue) {
            if ($csvDate = DateTime::createFromFormat('m/d/Y', $csvValue)) {
                $date = (new Date())
                    -&gt;setYear((int) $csvDate-&gt;format('Y'))
                    -&gt;setMonth((int) $csvDate-&gt;format('m'))
                    -&gt;setDay((int) $csvDate-&gt;format('d'));
                return (new Value())
                    -&gt;setDateValue($date);
            } else {
                return (new Value())
                    -&gt;setStringValue($csvValue);
            }
        }, explode(',', $csvRow));

        return (new Row())
            -&gt;setValues($rowValues);
    }, $csvRows);

    // Convert date fields into protobuf objects
    $dateFields = array_map(function ($dateFieldName) {
        return (new FieldId())-&gt;setName($dateFieldName);
    }, explode(',', $dateFieldNames));

    // Construct the table object
    $table = (new Table())
        -&gt;setHeaders($tableHeaders)
        -&gt;setRows($tableRows);

    $item = (new ContentItem())
        -&gt;setTable($table);

    // Construct dateShiftConfig
    $dateShiftConfig = (new DateShiftConfig())
        -&gt;setLowerBoundDays($lowerBoundDays)
        -&gt;setUpperBoundDays($upperBoundDays);

    if ($contextFieldName &amp;&amp; $keyName &amp;&amp; $wrappedKey) {
        $contextField = (new FieldId())
            -&gt;setName($contextFieldName);

        // Create the wrapped crypto key configuration object
        $kmsWrappedCryptoKey = (new KmsWrappedCryptoKey())
            -&gt;setWrappedKey(base64_decode($wrappedKey))
            -&gt;setCryptoKeyName($keyName);

        $cryptoKey = (new CryptoKey())
            -&gt;setKmsWrapped($kmsWrappedCryptoKey);

        $dateShiftConfig
            -&gt;setContext($contextField)
            -&gt;setCryptoKey($cryptoKey);
    } elseif ($contextFieldName || $keyName || $wrappedKey) {
        throw new Exception('You must set either ALL or NONE of {$contextFieldName, $keyName, $wrappedKey}!');
    }

    // Create the information transform configuration objects
    $primitiveTransformation = (new PrimitiveTransformation())
        -&gt;setDateShiftConfig($dateShiftConfig);

    $fieldTransformation = (new FieldTransformation())
        -&gt;setPrimitiveTransformation($primitiveTransformation)
        -&gt;setFields($dateFields);

    $recordTransformations = (new RecordTransformations())
        -&gt;setFieldTransformations([$fieldTransformation]);

    // Create the deidentification configuration object
    $deidentifyConfig = (new DeidentifyConfig())
        -&gt;setRecordTransformations($recordTransformations);

    $parent = "projects/$callingProjectId/locations/global";

    // Run request
    $response = $dlp-&gt;deidentifyContent([
        'parent' =&gt; $parent,
        'deidentifyConfig' =&gt; $deidentifyConfig,
        'item' =&gt; $item
    ]);

    // Check for errors
    foreach ($response-&gt;getOverview()-&gt;getTransformationSummaries() as $summary) {
        foreach ($summary-&gt;getResults() as $result) {
            if ($details = $result-&gt;getDetails()) {
                printf('Error: %s' . PHP_EOL, $details);
                return;
            }
        }
    }

    // Save the results to a file
    $csvRef = fopen($outputCsvFile, 'w');
    fputcsv($csvRef, $csvHeaders);
    foreach ($response-&gt;getItem()-&gt;getTable()-&gt;getRows() as $tableRow) {
        $values = array_map(function ($tableValue) {
            if ($tableValue-&gt;getStringValue()) {
                return $tableValue-&gt;getStringValue();
            }
            $protoDate = $tableValue-&gt;getDateValue();
            $date = mktime(0, 0, 0, $protoDate-&gt;getMonth(), $protoDate-&gt;getDay(), $protoDate-&gt;getYear());
            return strftime('%D', $date);
        }, iterator_to_array($tableRow-&gt;getValues()));
        fputcsv($csvRef, $values);
    };
    fclose($csvRef);
    printf('Deidentified dates written to %s' . PHP_EOL, $outputCsvFile);
}</code></pre>
</div>
</section>
<section>
<h3 data-text="C#" id="dlp-deidentify-date-shift-csharp" track-metadata-position="dlp-deidentify-date-shift" track-name="csharp" track-type="sampleTabNav">C#</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deidentify-date-shift" track-name="csharp" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithDateShift.cs" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/dlp/api/Snippets/DeidentifyWithDateShift.cs" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deidentify-date-shift" data-p="1634365" href="#" track-metadata-lang="csharp" track-metadata-position="dlp-deidentify-date-shift" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithDateShift.cs" data-region-tag="dlp_deidentify_date_shift" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dotnet-docs-samples/dlp/api/Snippets/DeidentifyWithDateShift.cs/HEAD/dlp_deidentify_date_shift" translate="no"><code dir="ltr" translate="no">
using System;
using System.IO;
using System.Linq;
using Google.Api.Gax.ResourceNames;
using Google.Cloud.Dlp.V2;
using Google.Protobuf;

public class DeidentifyWithDateShift
{
    public static DeidentifyContentResponse Deidentify(
        string projectId,
        string inputCsvFilePath,
        int lowerBoundDays,
        int upperBoundDays,
        string dateFields,
        string contextField,
        string keyName,
        string wrappedKey)
    {
        var hasKeyName = !string.IsNullOrEmpty(keyName);
        var hasWrappedKey = !string.IsNullOrEmpty(wrappedKey);
        var hasContext = !string.IsNullOrEmpty(contextField);
        bool allFieldsSet = hasKeyName &amp;&amp; hasWrappedKey &amp;&amp; hasContext;
        bool noFieldsSet = !hasKeyName &amp;&amp; !hasWrappedKey &amp;&amp; !hasContext;
        if (!(allFieldsSet || noFieldsSet))
        {
            throw new ArgumentException("Must specify ALL or NONE of: {contextFieldId, keyName, wrappedKey}!");
        }

        var dlp = DlpServiceClient.Create();

        // Read file
        var csvLines = File.ReadAllLines(inputCsvFilePath);
        var csvHeaders = csvLines[0].Split(',');
        var csvRows = csvLines.Skip(1).ToArray();

        // Convert dates to protobuf format, and everything else to a string
        var protoHeaders = csvHeaders.Select(header =&gt; new FieldId { Name = header });
        var protoRows = csvRows.Select(csvRow =&gt;
        {
            var rowValues = csvRow.Split(',');
            var protoValues = rowValues.Select(rowValue =&gt;
               System.DateTime.TryParse(rowValue, out var parsedDate)
               ? new Value { DateValue = Google.Type.Date.FromDateTime(parsedDate) }
               : new Value { StringValue = rowValue });

            var rowObject = new Table.Types.Row();
            rowObject.Values.Add(protoValues);
            return rowObject;
        });

        var dateFieldList = dateFields
            .Split(',')
            .Select(field =&gt; new FieldId { Name = field });

        // Construct + execute the request
        var dateShiftConfig = new DateShiftConfig
        {
            LowerBoundDays = lowerBoundDays,
            UpperBoundDays = upperBoundDays
        };

        dateShiftConfig.Context = new FieldId { Name = contextField };
        dateShiftConfig.CryptoKey = new CryptoKey
        {
            KmsWrapped = new KmsWrappedCryptoKey
            {
                WrappedKey = ByteString.FromBase64(wrappedKey),
                CryptoKeyName = keyName
            }
        };

        var deidConfig = new DeidentifyConfig
        {
            RecordTransformations = new RecordTransformations
            {
                FieldTransformations =
                {
                    new FieldTransformation
                    {
                        PrimitiveTransformation = new PrimitiveTransformation
                        {
                            DateShiftConfig = dateShiftConfig
                        },
                        Fields = { dateFieldList }
                    }
                }
            }
        };

        var response = dlp.DeidentifyContent(
            new DeidentifyContentRequest
            {
                Parent = new LocationName(projectId, "global").ToString(),
                DeidentifyConfig = deidConfig,
                Item = new ContentItem
                {
                    Table = new Table
                    {
                        Headers = { protoHeaders },
                        Rows = { protoRows }
                    }
                }
            });

        return response;
    }
}</code></pre>
</div>
</section>
</div>
<h3 data-text="Time extraction" id="time-extract">Time extraction</h3>
<p>Performing time extraction
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#timepartconfig"><code dir="ltr" translate="no">TimePartConfig</code></a>
in the DLP API) object preserves a portion of a matched value that on
a date, a time, or a timestamp preserves a portion of a matched value. You
specify to Cloud DLP what kind of time value you want to extract, including year, month, day of the month, and so on (enumerated in the
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#timepart"><code dir="ltr" translate="no">TimePart</code></a>
object).</p>
<p>For example, suppose you've configured a <code dir="ltr" translate="no">timePartConfig</code> transformation by
setting the time part to extract to <code dir="ltr" translate="no">YEAR</code>. After sending the data in the first
column below to Cloud DLP, you'd end up with the transformed values
in the second column:</p>
<table>
<tr>
<th>Original values</th>
<th>Transformed values</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">9/21/1976</code></td>
<td><code dir="ltr" translate="no">1976</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">6/7/1945</code></td>
<td><code dir="ltr" translate="no">1945</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">1/20/2009</code></td>
<td><code dir="ltr" translate="no">2009</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">7/4/1776</code></td>
<td><code dir="ltr" translate="no">1776</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">8/1/1984</code></td>
<td><code dir="ltr" translate="no">1984</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">4/21/1982</code></td>
<td><code dir="ltr" translate="no">1982</code></td>
</tr>
</table>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-hybrid-jobs]</H1></p><div class="devsite-article-body clearfix">
<p><em>Hybrid jobs and job triggers</em> encompass a set of asynchronous API methods that
allow you to scan payloads of data sent from virtually any source for sensitive
information, and then store the findings in Google Cloud. Hybrid jobs enable you
to write your own data crawlers that behave and serve data similarly to the
Cloud Data Loss Prevention storage inspection methods.</p>
<p>Using hybrid jobs, you can stream data from any source to
Cloud DLP. Cloud DLP inspects the data for sensitive
information or PII, and then saves the inspection scan results to a
Cloud DLP job resource. You can examine the scan results in the
Cloud DLP Console UI or API, or you can specify post-scan actions
to run, such as saving inspection results data to a BigQuery
table or emitting a Pub/Sub notification.</p>
<p>The hybrid jobs workflow is summarized in the following diagram:</p>
<p><img alt="Diagram of hybrid jobs dataflow, showing your application sending data from
an external source to Cloud DLP, Cloud DLP inspecting
the data, and then either saving or publishing
findings." src="/dlp/docs/images/concepts-method-types-hybrid.png" width="791"/> </p>
<p>This conceptual topic describes hybrid jobs and job triggers and how they work.
To learn how to implement hybrid jobs and job triggers, see <a href="/dlp/docs/how-to-hybrid-jobs">Inspecting external
data using hybrid jobs</a>.</p>
<h2 data-text="About hybrid environments" id="about_hybrid_environments">About hybrid environments</h2>
<p>"Hybrid" environments are common in organizations. Many organizations store and
process sensitive data using some combination of the following:</p>
<ul>
<li>Other cloud providers</li>
<li>On-premises servers or other data repositories</li>
<li>Non-native storage systems, such as systems running inside a virtual machine</li>
<li>Web and mobile apps</li>
<li>Google Cloud-based solutions</li>
</ul>
<p>Using hybrid jobs, Cloud DLP can inspect data sent to it from any
of these sources. Listed here are some example scenarios:</p>
<ul>
<li>Inspect data stored in Amazon Relational Database Service (RDS), MySQL
running inside a virtual machine, or an on-premises database.</li>
<li>Inspect and tokenize data as you migrate from on-premises to the cloud, or
between production, development, and analytics.</li>
<li>Inspect and redact transactions from a web or mobile application before
storing the data at rest.</li>
</ul>
<h2 data-text="Inspection options" id="inspection_options">Inspection options</h2>
<p>As described in more detail in <a href="/dlp/docs/concepts-method-types">Method types</a>,
when you want to inspect content for sensitive data, Cloud DLP
provides three default options:</p>
<ul>
<li>Content methods inspection: Using content inspection, you stream small
payloads of data to Cloud DLP along with instructions about
what to inspect for. Cloud DLP then inspects the data for
sensitive content and PII, and then returns the results of its scan back to
you.</li>
<li>Storage methods inspection: Using storage inspection, Cloud DLP
inspects a Google Cloud-based storage repository such as a
BigQuery database, Cloud Storage bucket, or
Datastore kind. You tell Cloud DLP what to inspect and
what to inspect for, and then Cloud DLP runs a job that scans
the repository. After the scan is complete, Cloud DLP saves a
summary of the results of the scan back to the job. You can additionally
specify that the results are sent to another Google Cloud product
for analysis, such as a separate BigQuery table.</li>
<li>Hybrid jobs inspection: Hybrid jobs provide the benefits of both of the
previous two methods. They enable you to stream data as you would with the
content methods, while gaining the storage, visualization, and actions of
storage inspection jobs. All inspection configuration is managed within
Cloud DLP, with no extra configuration required on the client
side. Hybrid jobs can be useful for scanning non-native storage systems
such as a database running in a virtual machine (VM), on-premises, or on
another cloud. Hybrid methods can also be useful for inspecting processing
systems such as migration workloads, or even to proxy service-to-service
communication. While content methods can also do this, hybrid methods
provide you the findings storage backend that can aggregate your data
across multiple API calls so that you don't have to.</li>
</ul>
<h2 data-text="About hybrid jobs and job triggers" id="about_hybrid_jobs_and_job_triggers">About hybrid jobs and job triggers</h2>
<p>A hybrid job is effectively a hybrid of <a href="/dlp/docs/concepts-method-types">content methods and storage
methods</a>. The basic workflow for using hybrid
jobs and job triggers is as follows:</p>
<ol>
<li>You write a script or create a workflow that sends data to
 Cloud DLP for inspection along with some metadata.</li>
<li>You configure and create a hybrid job resource or trigger and enable it to
 activate when it receives data.</li>
<li>Your script or workflow runs on the client side and sends data to
 Cloud DLP. The data includes an activation message and the job
 trigger's identifier, which triggers the inspection.</li>
<li>Cloud DLP inspects the data according to the criteria you set
 in the hybrid job or trigger.</li>
<li>Cloud DLP saves the results of the scan to the hybrid job
 resource, along with metadata that you provide. You can examine the
 results using the Cloud DLP UI in Cloud console.</li>
<li>Optionally, Cloud DLP can run post-scan actions, such as
 saving inspection results data to a BigQuery table or
 notifying you by email or Pub/Sub.</li>
</ol>
<p>A hybrid job trigger enables you to create, activate, and stop jobs so that you
can trigger actions whenever you need. By ensuring that your script or code
sends data that includes the hybrid job trigger's identifier, you don't need
to update your script or code whenever a new job is started.</p>
<h2 data-text="Typical hybrid job scenarios" id="typical_hybrid_job_scenarios">Typical hybrid job scenarios</h2>
<p>Following are some typical scenarios that hybrid jobs are well-suited for:</p>
<ul>
<li>You want to execute a one-off scan of a database outside of Google Cloud as
part of a quarterly spot check of databases.</li>
<li>You want to monitor all new content added on a daily basis to a database
that Cloud DLP does not natively support.</li>
<li>You want to monitor traffic in a network using <a href="/dlp/docs/solutions#filter_for_envoy">Cloud DLP
Filter for Envoy</a> (a WebAssembly HTTP
filter for Envoy sidecar proxies) to identify problematic sensitive data
movement.</li>
</ul>
<h2 data-text="Hybrid job-supported actions" id="hybrid_job-supported_actions">Hybrid job-supported actions</h2>
<p>Like other Cloud DLP jobs, hybrid jobs support
<a href="/dlp/docs/concepts-actions">actions</a>. Not all actions apply to hybrid jobs.
Following are the currently supported actions along with information about how
they work. Be aware that with the Pub/Sub, email, and
Cloud Monitoring actions, findings are made available when the job ends.</p>
<ul>
<li><strong>Save findings to DLP</strong> and <strong>Save findings to
BigQuery</strong>: Findings are saved to a Cloud DLP
resource or BigQuery table, respectively. These actions work
with hybrid jobs similarly to how they work with other job types, with one
important difference: With hybrid jobs, findings are made available while
the job is running; with other job types, findings are made available when
the job ends.</li>
<li><strong>Send Pub/Sub</strong>: When a job is done, a Pub/Sub
message will be emitted.</li>
<li><strong>Send Email</strong>: When a job is done, an email message will be sent.</li>
<li><strong>Publish to Cloud Monitoring</strong>: When a job is done, its findings will
be published to Monitoring.</li>
</ul>
<h2 data-text="Summary" id="summary">Summary</h2>
<p>Following are some key features and benefits of using hybrid jobs and job
triggers:</p>
<ul>
<li>Hybrid jobs enable you to stream data to Cloud DLP from
virtually any source, on- or off-cloud.</li>
<li>Hybrid job triggers activate when Cloud DLP receives a data
stream that includes an activation message and the job trigger's identifier.</li>
<li>You can wait until the inspection scan has completed, or you can stop the
job manually. Inspection results are saved to a Cloud DLP or to
BigQuery whether you allow the job to finish or stop the job
early.</li>
<li>Cloud DLP inspection scan results from a hybrid job trigger are
saved to a hybrid job resource within Cloud DLP.</li>
<li>You can examine the inspection scan results by viewing the job trigger
resource within Cloud DLP.</li>
<li>You can also instruct Cloud DLP to, using an action, send
hybrid job results to a BigQuery database and notify you by
email or Pub/Sub notification.</li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>To learn how to use hybrid jobs and job triggers to receive data for
inspection, see <a href="/dlp/docs/how-to-hybrid-jobs">Sending external data to Cloud DLP using
hybrid jobs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-infotypes]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention uses <em>information types</em>âor <em>infoTypes</em>âto
define what it scans for. An infoType is a type of sensitive data, such as a
name, email address, telephone number, identification number, credit card
number, and so on. An <em>infoType detector</em> is the corresponding detection
mechanism that matches on an infoType's matching criteria.</p>
<aside class="note"><strong>Note:</strong><span> If you're looking for an up-to-date list of all built-in infoType
detectors, see <a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</span></aside>
<h2 data-text="How to use infoTypes" id="how_to_use_infotypes">How to use infoTypes</h2>
<p>Cloud DLP uses infoType detectors in the configuration for its
scans to determine what to inspect for and how to transform findings. InfoType
names are also used when displaying or reporting scan results.</p>
<p>For example, if you wanted to look for email addresses in a block of text, you
would specify the <code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoType detector in the inspection
configuration.  If you wanted to redact email addresses from the text block,
you would specify <code dir="ltr" translate="no">EMAIL_ADDRESS</code> in both the inspection configuration and the
de-identification configuration to indicate how to redact or transform that
type.</p>
<p>Further, you could use a combination of built-in and custom infoType detectors
to exclude a subset of email addresses from scan findings. First, create a
custom infoType called <code dir="ltr" translate="no">INTERNAL_EMAIL_ADDRESS</code> and configure it to exclude
internal test email addresses. Then, you can set up your scan to include
findings for <code dir="ltr" translate="no">EMAIL_ADDRESS</code>, but include an exclusion rule that excludes any
findings that match <code dir="ltr" translate="no">INTERNAL_EMAIL_ADDRESS</code>. For more information about
exclusion rules and other features of custom infoType detectors, see <a href="/dlp/docs/creating-custom-infotypes">Creating
custom infoType detectors</a>.</p>
<p>Cloud DLP provides a set of built-in infoType detectors that you
specify by name, each of which is listed in <a href="/dlp/docs/infotypes-reference">InfoType detector
reference</a>. These detectors use a variety of
techniques to discover and classify each type. For example, some types will
require a pattern match, some may have mathematical checksums, some have special
digit restrictions, and others may have specific prefixes or context around the
findings.</p>
<h3 data-text="Examples" id="examples">Examples</h3>
<p>When you set up Cloud DLP to scan your content, you include the
infoType detectors to use in the scan configuration.</p>
<p>For example, the following JSON and code samples demonstrate a simple scan
request to the DLP API. Notice that the <code dir="ltr" translate="no">PHONE_NUMBER</code>
detector is specified in
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">inspectConfig</code></a>,
which instructs Cloud DLP to scan the given string for a
phone number.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-phone-number-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-phone-number-protocol" track-metadata-position="dlp-inspect-phone-number" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/content:inspect?key={YOUR_API_KEY}

{
  "item":{
    "value":"My phone number is (415) 555-0890"
  },
  "inspectConfig":{
    "includeQuote":true,
    "minLikelihood":"POSSIBLE",
    "infoTypes":{
      "name":"PHONE_NUMBER"
    }
  }
}
</code></pre>
<p>When you send the preceding request the specified endpoint,
Cloud DLP returns the following:</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "result":{
    "findings":[
      {
        "quote":"(415) 555-0890",
        "infoType":{
          "name":"PHONE_NUMBER"
        },
        "likelihood":"VERY_LIKELY",
        "location":{
          "byteRange":{
            "start":"19",
            "end":"33"
          },
          "codepointRange":{
            "start":"19",
            "end":"33"
          }
        },
        "createTime":"2018-10-29T23:46:34.535Z"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-phone-number-java" track-metadata-position="dlp-inspect-phone-number" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-phone-number" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-phone-number" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-phone-number" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java" data-region-tag="dlp_inspect_phone_number" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java/HEAD/dlp_inspect_phone_number" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;

public class InspectPhoneNumber {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "My name is Gary and my email is gary@example.com";
    inspectString(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void inspectString(String projectId, String textToInspect) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToInspect).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("PHONE_NUMBER").build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder()
              .setIncludeQuote(true)
              .setMinLikelihood(Likelihood.POSSIBLE)
              .addInfoTypes(infoType)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-phone-number-python" track-metadata-position="dlp-inspect-phone-number" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-phone-number" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-phone-number" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-phone-number" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_string_basic" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_string_basic" translate="no"><code dir="ltr" translate="no">def inspect_string_basic(
    project,
    content_string,
    info_types=["PHONE_NUMBER"],
):
    """Uses the Data Loss Prevention API to analyze strings for protected data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Construct the configuration dictionary.
    inspect_config = {
        "info_types": info_types,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print("Quote: {}".format(finding.quote))
            print("Info type: {}".format(finding.info_type.name))
            print("Likelihood: {}".format(finding.likelihood))
    else:
        print("No findings.")

</code></pre>
</div>
</section>
</div>
<p>If you need precise control and predictability as to what detectors are run, you
should specify particular <a href="/dlp/docs/infotypes-reference">infoTypes listed in the
reference</a>, otherwise Cloud DLP uses
a default list, which may change over time. Depending on the amount of content
to scan, scanning for default infoTypes can be prohibitively time-consuming or
expensive.</p>
<p>For more information on how to use infoType detectors to scan your content,
see one of the <a href="/dlp/docs/how-to">how-to topics</a> about inspecting, redacting,
or de-identifying.</p>
<h2 data-text="Certainty and testing" id="certainty">Certainty and testing</h2>
<p>Findings are reported with a certainty score called
<a href="/dlp/docs/likelihood">likelihood</a>. The likelihood score indicates how likely a
finding matches the corresponding type. For example, a type may return a lower
likelihood if it only matches the pattern and return a higher likelihood if it
matches the pattern and has positive context around it. For this reason, you may
notice that a single finding could match several types at lower likelihood.
Also, a finding may not appear or might have lower certainty if it doesn't match
properly, or if it has negative context around it. For example, a finding might
not reported if it matches the structure for the specified infoType but fails
the infoType's checksum. Or a finding could match more than one infoType but
have context that boosts one of them, and thus only get reported for that type.</p>
<aside class="note"><strong>Note:</strong><span> <em>Positive context</em> is when the inclusion of certain characters, words, or
phrases in proximity to a potentially matched pattern indicates to
Cloud DLP that a match to the pattern is more likely. Similarly,
<em>negative context</em> is when the inclusion of certain characters, words, or
phrases in proximity to a pattern indicates that a match is less likely.</span></aside>
<p>If you are testing various detectors, you may notice that fake or sample data
does not get reported because that fake or sample data is not passing enough
checks to report.</p>
<h2 data-text="Kinds of infoType detectors" id="kinds">Kinds of infoType detectors</h2>
<p>Cloud DLP includes several kinds of infoType detectors, all
of which are summarized here:</p>
<ul>
<li><a href="#built-in"><em>Built-in infoType detectors</em></a> are built into
Cloud DLP. They include detectors for country- or
region-specific sensitive data types as well as globally applicable data
types.</li>
<li><a href="#custom"><em>Custom infoType detectors</em></a> are detectors that you create
yourself. There are three kinds of custom infoType detectors:
<ul>
<li><em>Small custom dictionary detectors</em> are simple word lists that
Cloud DLP matches on. Use small custom dictionary
detectors when you have a list of up to several tens of thousands of
words or phrases. Small custom dictionary detectors are preferred if
you don't anticipate your word list changing significantly.</li>
<li><em>Large custom dictionary detectors</em> are generated by
Cloud DLP using large lists of words or phrases stored
in either Cloud Storage or BigQuery. Use large custom dictionary
detectors when you have a large list of words or phrasesâup to tens
of millions.</li>
<li><em>Regular expressions (regex) detectors</em> enable
Cloud DLP to detect matches based on a regular expression
pattern.</li>
</ul></li>
</ul>
<p>In addition, Cloud DLP includes the concept of
<a href="#inspection-rules"><em>inspection rules</em></a>, which enable you to fine-tune scan
results using the following:</p>
<ul>
<li><em>Exclusion rules</em> enable you to decrease the number of findings returned
by adding rules to a built-in or custom infoType detector.</li>
<li><em>Hotword rules</em> enable you to increase the quantity or change the
<a href="/dlp/docs/likelihood">likelihood value</a> of findings returned by adding
rules to a built-in or custom infoType detector.</li>
</ul>
<h2 data-text="Built-in infoType detectors" id="built-in">Built-in infoType detectors</h2>
<p>Built-in infoType detectors are built into Cloud DLP, and
include detectors for country- or region-specific sensitive data types such as
the French <em>NumÃ©ro d'Inscription au RÃ©pertoire (NIR)</em> (<code dir="ltr" translate="no">FRANCE_NIR</code>), UK
driver's license number (<code dir="ltr" translate="no">UK_DRIVERS_LICENSE_NUMBER</code>), and US Social Security
number (<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code>). They also include globally applicable data
types such as a person name (<code dir="ltr" translate="no">PERSON_NAME</code>), telephone numbers (<code dir="ltr" translate="no">PHONE_NUMBER</code>),
email addresses (<code dir="ltr" translate="no">EMAIL_ADDRESS</code>), and credit card numbers
(<code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code>). To detect content that corresponds to infoTypes,
Cloud DLP leverages various techniques including pattern
matching, checksums, machine-learning, context analysis, and others.</p>
<p>The list of built-in infoType detectors is always being updated. For a complete
list of currently supported built-in infoType detectors, see
<a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</p>
<p>You can also view a complete list of all built-in infoType detectors by
calling Cloud DLP's
<a href="/dlp/docs/reference/rest/v2/infoTypes/list"><code dir="ltr" translate="no">infoTypes.list</code></a>
method.</p>
<p>Built-in infoType detectors are not a 100% accurate detection method. For
example, they can't guarantee compliance with regulatory requirements. You must
decide what data is sensitive and how to best protect it. Google recommends that
you test your settings to make sure your configuration meets your
requirements.</p>
<h3 data-text="Language support" id="language-support">Language support</h3>
<p>Country-specific infoTypes support the English language and the respective
country's languages. Most global infoTypes work with multiple languages.
Test Cloud DLP with your data to verify that it meets your
requirements.</p>
<h2 data-text="Custom infoType detectors" id="custom">Custom infoType detectors</h2>
<p>There are three kinds of custom infoType detectors:</p>
<ul>
<li><a href="#small">Small custom dictionary detectors</a></li>
<li><a href="#large">Large custom dictionary detectors</a></li>
<li><a href="#regex">Regular expressions (regex)</a></li>
</ul>
<p>In addition, Cloud DLP includes inspection rules, which
enable you to fine-tune scan results by adding the following to existing
detectors:</p>
<ul>
<li><a href="#exclusion">Exclusion rules</a></li>
<li><a href="#hotword">Hotword rules</a></li>
</ul>
<h3 data-text="Small custom dictionary detectors" id="small">Small custom dictionary detectors</h3>
<p>Use <a href="/dlp/docs/creating-custom-infotypes-dictionary">small custom dictionary
detectors</a> (also referred to as
"regular custom dictionary detectors") to match a short (up to several tens of
thousands) list of words or phrases. A small custom dictionary can act as its
own unique detector.</p>
<p>Custom dictionary detectors are useful when you want to scan for a list of
words or phrases that are not easily matched by a regular expression or a
built-in detector. For example, suppose you want to scan for conference rooms
that are commonly referred to by their assigned room names rather than their
room numbers, such as state or region names, landmarks, fictional characters,
and so on. You can make a small custom dictionary detector that contains a
list of these room names. Cloud DLP can scan your content
for each of the room names and return a match when it encounters one of them in
context. Learn more about how Cloud DLP matches dictionary
words and phrases in the "<a href="/dlp/docs/creating-custom-infotypes-dictionary#specifics">Dictionary matching
specifics</a>" section of
<a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
detector</a>.</p>
<p>For more details about how small dictionary custom infoType detectors work,
as well as examples in action, see <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
detector</a>.</p>
<h3 data-text="Large custom dictionary detectors" id="large">Large custom dictionary detectors</h3>
<p>Use <a href="/dlp/docs/creating-stored-infotypes">large custom dictionary detectors</a>
(also referred to as "stored custom dictionary detectors") when you have more
than a few words or phrases to scan for, or if your list of words or phrases
changes frequently. Large custom dictionary detectors can match on up to tens of
millions of words or phrases.</p>
<p>Large custom dictionary detectors are created differently from both regular
expression custom detectors and small custom dictionary detectors. Each large
custom dictionary has two components:</p>
<ul>
<li>A list of phrases that you create and define. The list is stored as either
a text file within Cloud Storage or a column in a
BigQuery table.</li>
<li>The generated dictionary files, which are built by Cloud DLP
based on your phrase list. The dictionary files are stored in
Cloud Storage, and are comprised of a copy of the source phrase data
plus bloom filters, which aid in searching and matching. You can't edit
these files directly.</li>
</ul>
<p>Once you've created a word list and then used Cloud DLP to
generate a custom dictionary, you initiate or schedule a scan using a large
custom dictionary detector in a similar way as other infoType detectors.</p>
<p>For more details about how large custom dictionary detectors work, as well as
examples in action, see <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a stored custom dictionary
detector</a>.</p>
<h3 data-text="Regular expressions" id="regex">Regular expressions</h3>
<p>A regular expression (regex) custom infoType detector allows you to create your
own infoType detectors that enable Cloud DLP to detect matches
based on a regex pattern. For example, suppose that you had medical record
numbers in the formÂ <code dir="ltr" translate="no">###-#-#####</code>. You could define a regex pattern such as the
following:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">[1-9]{3}-[1-9]{1}-[1-9]{5}
</code></pre>
<p>The Cloud DLP would then match items like this:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">123-4-56789
</code></pre>
<p>You can also specify a <a href="/dlp/docs/likelihood">likelihood</a> to assign to each
custom infoType match. That is, when Cloud DLP matches the sequence
you specify, it will assign the likelihood that you have indicated. This is
useful because if your custom regex defines a sequence that is common enough it
could easily match some other random sequence, you would not want
Cloud DLP to label every match asÂ <code dir="ltr" translate="no">VERY_LIKELY</code>. Doing so would
erode confidence in scan results and potentially cause the wrong information to
be matched or de-identified.</p>
<p>For more information about regular expression custom infoType detectors, and to
see them in action, see <a href="/dlp/docs/creating-custom-infotypes-regex">Creating a custom regex
detector</a>.</p>
<h2 data-text="Inspection rules" id="inspection-rules">Inspection rules</h2>
<p>You use inspection rules to refine the results returned by existing infoType
detectorsâeither built-in or custom. Inspection rules can be useful for
times when the results that Cloud DLP returns need to be augmented
in some way, either by adding to and excluding from the existing infoType
detector.</p>
<p>The two types of inspection rules are:</p>
<ul>
<li>Exclusion rules</li>
<li>Hotword rules</li>
</ul>
<p>For more information about inspection rules, see <a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors
to refine scan results</a>.</p>
<h3 data-text="Exclusion rules" id="exclusion">Exclusion rules</h3>
<p>Exclusion rules enable you to decrease the quantity or precision of findings
returned by adding rules to a built-in or custom infoType detector. Exclusion
rules can help you reduce noise or other unwanted findings from being returned
by an infoType detector.</p>
<p>For example, if you scan a database for email addresses, you can add an
exclusion rule in the form of a custom regex that instructs
Cloud DLP to exclude any findings ending in "@example.com."</p>
<p>For more information about exclusion rules, see <a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors
to refine scan results</a>.</p>
<h3 data-text="Hotword rules" id="hotword">Hotword rules</h3>
<p>Hotword rules enable you to increase the quantity or accuracy of findings
returned by adding rules to a built-in or custom infoType detector. Hotword
rules can effectively help you loosen an existing infoType detector's rules.</p>
<p>For example, suppose you want to scan a medical database for patient names. You
can use Cloud DLP's built-in <code dir="ltr" translate="no">PERSON_NAME</code> infoType
detector, but that will cause Cloud DLP to match on all
names of people, not just names of patients. To fix this, you can include a
hotword rule in the form of a regex custom infoType that looks for the word
"patient" within a certain character proximity from the first character of
potential matches. You can then assign findings matching this pattern a
<a href="/dlp/docs/likelihood">likelihood</a> of "very likely," since they correspond to
your special criteria.</p>
<p>For more information about hotword rules, see <a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to
refine scan results</a>.</p>
<h2 data-text="Examples" id="examples_2">Examples</h2>
<p>To get a better idea of how infoTypes match on findings, look at the following
examples of matching on a series of digits to determine whether they constitute
a US Social Security number or a US Individual Taxpayer Identification Number.
Keep in mind that these examples are for built-in infoType detectors. When you
create a custom infoType detector, you specify the criteria that determine the
likelihood of a scan match.</p>
<h3 data-text="Example 1" id="example_1">Example 1</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"SSN 222-22-2222"
</code></pre>
<p>Reports a high likelihood score of <code dir="ltr" translate="no">VERY_LIKELY</code> for a
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> because:</p>
<ul>
<li>It is in the standard Social Security number format, which raises the
certainty.</li>
<li>It has context nearby ("SSN") that boosts towards
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code>.</li>
</ul>
<h3 data-text="Example 2" id="example_2">Example 2</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"999-99-9999"
</code></pre>
<p>Reports a low likelihood score of <code dir="ltr" translate="no">VERY_UNLIKELY</code> for a
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> because:</p>
<ul>
<li>It is in the standard format, which raises the certainty.</li>
<li>It starts with a 9, which is not allowed in Social Security numbers, thus
lowers the certainty.</li>
<li>It lacks context, which lowers the certainty.</li>
</ul>
<h3 data-text="Example 3" id="example_3">Example 3</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"999-98-9999"
</code></pre>
<p>Reports a likelihood score of <code dir="ltr" translate="no">POSSIBLE</code> for a
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code> and <code dir="ltr" translate="no">VERY_UNLIKELY</code> for
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> because:</p>
<ul>
<li>It has the standard format for both <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> and
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code>.</li>
<li>It starts with a 9 and has another digit check, which boosts certainty for
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code>.</li>
<li>It lacks any context, which lowers the certainty for both.</li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<p>The Cloud DLP team releases new infoType detectors and groups
periodically. To learn how to get the latest list of built-in infoTypes, see
<a href="/dlp/docs/listing-infotypes">Listing built-in infoType detectors</a>.</p>
<aside class="special"><strong>Important:</strong><span> Built-in infoType detectors are not a 100% accurate detection method.
For example, they can't guarantee compliance with regulatory requirements. You
must decide what data is sensitive and how to best protect it. Google recommends
that you test your settings to make sure your configuration meets your
requirements.</span></aside>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/infotypes-reference]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention uses <em>information types</em>âor <em>infoTypes</em>âto define
what it scans for. An infoType is a type of sensitive data, such as a name,
email address, telephone number, identification number, or credit card number.</p>
<p>Every infoType defined in Cloud DLP has a corresponding <em>detector</em>.
Cloud DLP uses infoType detectors in the configuration for its
scans to determine what to inspect for and how to transform findings. InfoType
names are also used when displaying or reporting scan results.</p>
<p>For more in-depth information about infoType detectors, see <a href="/dlp/docs/concepts-infotypes">InfoTypes and
infoType detectors</a>.</p>
<p>The Cloud DLP team releases new infoType detectors and groups
periodically. To get the latest list of built-in infoTypes, call the
<a href="/dlp/docs/reference/rest/v2/infoTypes/list"><code dir="ltr" translate="no">infoTypes.list</code></a>
method of Cloud DLP.</p>
<aside class="special"><strong>Important:</strong><span> Built-in infoType detectors are not a 100% accurate detection method.
For example, they can't guarantee compliance with regulatory requirements. You
must decide what data is sensitive and how to best protect it. Google recommends
that you test your settings to make sure your configuration meets your
requirements.</span></aside>
<h2 data-text="Global" id="global">Global</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">ADVERTISING_ID</code></td>
<td><p>Identifiers used by developers to track users for <em>advertising
      purposes</em>. These include Google Play Advertising IDs, Amazon
      Advertising IDs, Apple's identifierForAdvertising (IDFA), and Apple's
      identifierForVendor (IDFV).</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">AGE</code></td>
<td><p>An <em>age</em> measured in months or years.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code></td>
<td><p>A <em>credit card number</em> is 12 to 19 digits long. They are used
      for payment transactions globally.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CREDIT_CARD_TRACK_NUMBER</code></td>
<td><p>A <em>credit card track number</em> is a variable length alphanumeric
      string. It is used to store key cardholder information.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DATE</code></td>
<td><p>A <em>date</em>. This infoType includes most date formats, including
      the names of common world holidays.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DATE_OF_BIRTH</code></td>
<td><p>A <em>date</em> that is identified by context as a date of birth.
      Note: Not recommended for use during latency sensitive operations.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOMAIN_NAME</code></td>
<td><p>A <em>domain name</em> as defined by the DNS standard.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">EMAIL_ADDRESS</code></td>
<td><p>An <em>email address</em> identifies the mailbox that emails are sent
      to or from. The maximum length of the domain name is 255 characters, and
      the maximum length of the local-part is 64 characters.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">ETHNIC_GROUP</code></td>
<td><p>A personâs <em>ethnic group</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">FEMALE_NAME</code></td>
<td><p>A common <em>female name</em>.
      Note: Not recommended for use during latency sensitive operations.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">FIRST_NAME</code></td>
<td><p>A <em>first name</em> is defined as the first part of a
      <code dir="ltr" translate="no">PERSON_NAME</code>.
      Note: Not recommended for use during latency sensitive operations.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GENDER</code></td>
<td><p>A personâs <em>gender identity</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GENERIC_ID</code></td>
<td><p><em>Alphanumeric and special character strings</em> that may be
      personally identifying but do not belong to a well-defined category, such
      as user IDs or medical record numbers.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IBAN_CODE</code></td>
<td><p>An <em>International Bank Account Number (IBAN)</em> is an
      internationally agreed-upon method for identifying bank accounts defined
      by the International Standard of Organization (ISO) 13616:2007 standard.
      The European Committee for Banking Standards (ECBS) created ISO
      13616:2007. An IBAN consists of up to 34 alphanumeric characters,
      including elements such as a country code or account number.</p> </td>
</tr>
<tr>
<td><code dir="ltr" translate="no">HTTP_COOKIE</code></td>
<td><p>An <em>HTTP cookie</em> is a standard way of storing data on a per
      website basis. This detector will find headers containing these
      cookies.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">ICCID_NUMBER</code></td>
<td><p>An <em>Integrated Circuit Card Identifier (ICCID)</em> is used to
      uniquely identify each SIM card. It includes information, such as the
      country the card is active in and the mobile network code.</p></td></tr>
<tr>
<td><code dir="ltr" translate="no">ICD9_CODE</code></td>
<td><p>The <em>International Classification of Diseases, Ninth Revision,
      Clinical Modification (ICD-9-CM) lexicon</em> is used to assign
      diagnostic and procedure codes associated with inpatient, outpatient,
      and physician office use in the United States. The US National Center for
      Health Statistics (NCHS) created the ICD-9-CM lexicon. It is based on
      the ICD-9 lexicon, but provides for more morbidity detail. The ICD-9-CM
      lexicon is updated annually on October 1.</p></td></tr>
<tr>
<td><code dir="ltr" translate="no">ICD10_CODE</code></td>
<td><p>Like ICD-9-CM codes, the <em>International Classification of
      Diseases, Tenth Revision, Clinical Modification (ICD-10-CM) lexicon</em>
      is a series of diagnostic codes. The World Health Organization (WHO)
      publishes the ICD-10-CM lexicon to describe causes of morbidity and
      mortality.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IMEI_HARDWARE_ID</code></td>
<td><p>An <em>International Mobile Equipment Identity (IMEI) hardware
      identifier</em>, used to identify mobile phones.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IMSI_ID</code></td>
<td><p>An <em>International Mobile Subscriber Identity (IMEI)
      identifier</em>, used to identify users on a mobile network.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IP_ADDRESS</code></td>
<td><p>An <em>Internet Protocol (IP) address</em> (either IPv4 or IPv6).</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">LAST_NAME</code></td>
<td><p>A <em>last name</em> is defined as the last part of a
      <code dir="ltr" translate="no">PERSON_NAME</code>.</p>
    Note: Not recommended for use during latency sensitive operations.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">LOCATION</code></td>
<td><p>A <em>physical address or location</em>.
      Note: Not recommended for use during latency sensitive operations.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">MAC_ADDRESS</code></td>
<td>A <em>media access control address (MAC address)</em>, which is an
      identifier for a network adapter.
    </td>
</tr>
<tr>
<td><code dir="ltr" translate="no">MAC_ADDRESS_LOCAL</code></td>
<td>A local <em>media access control address (MAC address)</em>, which is an
      identifier for a network adapter.
    </td>
</tr>
<tr>
<td><code dir="ltr" translate="no">MALE_NAME</code></td>
<td><p>A common <em>male name</em>.</p>
    Note: Not recommended for use during latency sensitive operations.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">MEDICAL_TERM</code></td>
<td><p>Terms that commonly refer to a person's <em>medical condition or
      health</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">ORGANIZATION_NAME</code></td>
<td><p>A name of a <em>chain store, business or organization</em>.</p>
    Note: Not recommended for use during latency sensitive operations.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">PASSPORT</code></td>
<td><p>A <em>passport number</em> that matches passport numbers for the
      following countries: Australia, Canada, China, France, Germany, Japan,
      Korea, Mexico, The Netherlands, Poland, Singapore, Spain, Sweden, Taiwan,
      United Kingdom, and the United States.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">PERSON_NAME</code></td>
<td><p>A full <em>person name</em>, which can include first names, middle
      names or initials, and last names.
      Note: Not recommended for use during latency sensitive operations.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">PHONE_NUMBER</code></td>
<td><p>A <em>telephone number</em>.
    </p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">STREET_ADDRESS</code></td>
<td><p>A <em>street address</em>.
      Note: Not recommended for use during latency sensitive operations.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SWIFT_CODE</code></td>
<td><p>A <em>SWIFT code</em> is the same as a Bank Identifier Code (BIC).
      It's a unique identification code for a particular bank. These codes are
      used when transferring money between banks, particularly for international
      wire transfers. Banks also use the codes for exchanging other
      messages.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">STORAGE_SIGNED_POLICY_DOCUMENT</code></td>
<td><p>A <em>storage signed policy document</em> is an HTML form used to 
      upload objects. These uploads can overwrite existing objects and may
      contain many form fields (some of which may be optional) for further
      customization. All forms will use the *.googleapis.com and will be used for
      individual file uploads within a POST request form. The form must be UTF-8
      encoded.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">STORAGE_SIGNED_URL</code></td>
<td><p>A <em>storage signed URL</em> is a URL that provides time-limited
      resource access to anyone in possession of the URL, regardless of whether 
      they have a Google account. Signed URLs contain authentication information
      in their query string, allowing users without credentials to perform
      specific actions on a resource.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">TIME</code></td>
<td><p>A <em>timestamp</em> of a specific time of day.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">URL</code></td>
<td><p>A <em>Uniform Resource Locator (URL)</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">VEHICLE_IDENTIFICATION_NUMBER</code></td>
<td><p>A <em>vehicle identification number (VIN)</em> is a unique 17-digit
      code assigned to every on-road motor vehicle.</p>
</td>
</tr>
</table>
<h2 data-text="Credentials and secrets" id="credentials_and_secrets">Credentials and secrets</h2>
<p>The infoType detectors in this section detect credentials and other secret
data.</p>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">AUTH_TOKEN</code></td>
<td><p>An <em>authentication token</em> is a machine-readable way of
      determining whether a particular request has been authorized for a user.
      This detector currently identifies tokens that comply with OAuth or Bearer
      authentication.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">AWS_CREDENTIALS</code></td>
<td><p>Amazon Web Services account access keys.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">AZURE_AUTH_TOKEN</code></td>
<td><p>Microsoft Azure certificate credentials for application authentication.
      </p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">BASIC_AUTH_HEADER</code></td>
<td><p>A <em>basic authentication header</em> is an HTTP header used to
      identify a user to a server. It is part of the HTTP specification in RFC
      1945, section 11.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">ENCRYPTION_KEY</code></td>
<td><p>An <em>encryption key</em> within configuration, code, or log
      text.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GCP_API_KEY</code></td>
<td><p><em>Google Cloud API key</em>.
    An encrypted string that is used when calling Google Cloud APIs
    that don't need to access private user data.
    </p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GCP_CREDENTIALS</code></td>
<td><p><em>Google Cloud service account credentials</em>.
    Credentials that can be used to authenticate with Google API client
    libraries and service accounts.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">JSON_WEB_TOKEN</code></td>
<td><p><em>JSON Web Token</em>.
    JSON Web Token in compact form. Represents a set of claims as a JSON object
    that is digitally signed using JSON Web Signature.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">HTTP_COOKIE</code></td>
<td><p>An <em>HTTP cookie</em> is a standard way of storing data on a per
      website basis. This detector will find headers containing these
      cookies.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">PASSWORD</code></td>
<td><p>Clear text <em>passwords</em> in configs, code, and other
      text.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">WEAK_PASSWORD_HASH</code></td>
<td><p>A <em>weakly hashed password</em> is a method of storing a password
      that is easy to reverse engineer. The presence of such hashes often
      indicate that a system's security can be improved.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">XSRF_TOKEN</code></td>
<td><p>An <em>XSRF token</em> is an HTTP header that is commonly used to
      prevent cross-site scripting attacks. Cross-site scripting is a type of
      security vulnerability that can be exploited by malicious sites.</p></td>
</tr>
</table>
<h2 data-text="Argentina" id="argentina">Argentina</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">ARGENTINA_DNI_NUMBER</code></td>
<td><p>An <em>Argentine Documento Nacional de Identidad (DNI)</em>, or
      national identity card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Australia" id="australia">Australia</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">AUSTRALIA_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>An <em>Australian driver's license number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">AUSTRALIA_MEDICARE_NUMBER</code></td>
<td><p>A 9-digit <em>Australian Medicare account number</em> is issued to
      permanent residents of Australia (except for Norfolk island). The primary
      purpose of this number is to prove Medicare eligibility to receive
      subsidized care in Australia.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">AUSTRALIA_PASSPORT</code></td>
<td><p>An <em>Australian passport number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">AUSTRALIA_TAX_FILE_NUMBER</code></td>
<td><p>An <em>Australian tax file number (TFN)</em> is a number issued by
      the Australian Tax Office for taxpayer identification. Every taxpaying
      entity, such as an individual or an organization, is assigned a unique
      number.</p>
</td>
</tr>
</table>
<h2 data-text="Belgium" id="belgium">Belgium</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">BELGIUM_NATIONAL_ID_CARD_NUMBER</code></td>
<td><p>A 12-digit <em>Belgian national identity card number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="Brazil" id="brazil">Brazil</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">BRAZIL_CPF_NUMBER</code></td>
<td><p>The <em>Brazilian Cadastro de Pessoas FÃ­sicas (CPF) number</em>, or
      Natural Persons Register number, is an 11-digit number used in Brazil for
      taxpayer identification.</p>
</td>
</tr>
</table>
<h2 data-text="Canada" id="canada">Canada</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_BANK_ACCOUNT</code></td>
<td><p>A <em>Canadian bank account number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_BC_PHN</code></td>
<td><p>The <em>British Columbia Personal Health Number (PHN) </em>is issued
      to citizens, permanent residents, temporary workers, students, and other
      individuals who are entitled to health care coverage in the Province of
      British Columbia.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>A <em>driver's license number</em> for each of the ten provinces in
      Canada (the three territories are currently not covered).</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_OHIP</code></td>
<td><p>The <em>Ontario Health Insurance Plan (OHIP) number</em> is issued to
      citizens, permanent residents, temporary workers, students, and other
      individuals who are entitled to health care coverage in the Province of
      Ontario.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_PASSPORT</code></td>
<td><p>A <em>Canadian passport number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_QUEBEC_HIN</code></td>
<td><p>The <em>QuÃ©bec Health Insurance Number</em> (also known as the RAMQ
      number) is issued to citizens, permanent residents, temporary workers,
      students, and other individuals who are entitled to health care coverage
      in the Province of QuÃ©bec.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CANADA_SOCIAL_INSURANCE_NUMBER</code></td>
<td><p>The <em>Canadian Social Insurance Number (SIN)</em> is the main
      identifier used in Canada for citizens, permanent residents, and people on
      work or study visas. With a Canadian SIN and mailing address, one can
      apply for health care coverage, driver's licenses, and other important
      services.</p>
</td>
</tr>
</table>
<h2 data-text="Chile" id="chile">Chile</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">CHILE_CDI_NUMBER</code></td>
<td><p>A <em>Chilean CÃ©dula de Identidad (CDI)</em>, or
      identity card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="China" id="china">China</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">CHINA_RESIDENT_ID_NUMBER</code></td>
<td><p>A <em>Chinese resident identification number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">CHINA_PASSPORT</code></td>
<td><p>A <em>Chinese passport number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="Colombia" id="colombia">Colombia</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">COLOMBIA_CDC_NUMBER</code></td>
<td><p>A <em>Colombian CÃ©dula de CiudadanÃ­a (CDC)</em>, or
      citizenship card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Denmark" id="denmark">Denmark</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">DENMARK_CPR_NUMBER</code></td>
<td><p>A <em>Personal Identification Number (CPR, Det Centrale
      Personregister)</em> is a national ID number in Denmark. It is used with
      public agencies such as health care and tax authorities.
      Banks and insurance companies also use it as a customer number. The CPR
      number is required for people who reside in Denmark, pay tax or own
      property there.</p>
</td>
</tr>
</table>
<h2 data-text="France" id="france">France</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">FRANCE_CNI</code></td>
<td><p>The <em>French Carte Nationale d'IdentitÃ© SÃ©curisÃ©e (CNI or
      CNIS)</em> is the French national identity card. It's an official identity
      document consisting of a 12-digit identification number. This number is
      commonly used when opening bank accounts and when paying by check. It can
      sometimes be used instead of a passport or visa within the European Union
      (EU) and in some other countries.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">FRANCE_NIR</code></td>
<td><p>The <em>French NumÃ©ro d'Inscription au RÃ©pertoire (NIR)</em> is a
      permanent personal identification number that's also known as the French
      social security number for services including healthcare and pensions.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">FRANCE_PASSPORT</code></td>
<td><p>A <em>French passport number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">FRANCE_TAX_IDENTIFICATION_NUMBER</code></td>
<td><p>The <em>French tax identification number</em> is a government-issued
      ID for all individuals paying taxes in France.</p>
</td>
</tr>
</table>
<h2 data-text="Finland" id="finland">Finland</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">FINLAND_NATIONAL_ID_NUMBER</code></td>
<td><p>A <em>Finnish personal identity code</em>, a
      national government identification number for Finnish citizens used on
      identity cards, driver's licenses and passports.</p>
</td>
</tr>
</table>
<h2 data-text="Germany" id="germany">Germany</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">GERMANY_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>A <em>German driver's license number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GERMANY_IDENTITY_CARD_NUMBER</code></td>
<td><p>The <em>German Personalausweis</em>, or identity card, is used as the
      main identity document for citizens of Germany.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GERMANY_PASSPORT</code></td>
<td><p>A <em>German passport number</em>. The format of a German
      passport number is 10 alphanumeric characters, chosen from numerals 0â9
      and letters C, F, G, H, J, K, L, M, N, P, R, T, V, W, X, Y, Z.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GERMANY_TAXPAYER_IDENTIFICATION_NUMBER</code></td>
<td><p>An 11-digit <em>German taxpayer identification number</em> assigned
      to both natural-born and other legal residents of Germany for the
      purposes of recording tax payments.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">GERMANY_SCHUFA_ID</code></td>
<td><p>A <em>German Schufa identification number</em>. Schufa Holding AG is
      a German credit bureau whose aim is to protect clients from credit risk.
    </p>
</td>
</tr>
</table>
<h2 data-text="Hong Kong" id="hong_kong">Hong Kong</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">HONG_KONG_ID_NUMBER</code></td>
<td><p>The é¦æ¸¯èº«ä»½è­, or <em>Hong Kong identity card (HKIC)</em>, is used as
      the main identity document for citizens of Hong Kong.</p>
</td>
</tr>
</table>
<h2 data-text="India" id="india">India</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">INDIA_AADHAAR_INDIVIDUAL</code></td>
<td><p>The <em>Indian Aadhaar number</em> is a 12-digit unique identity
      number obtained by residents of
      India, based on their biometric and demographic data.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">INDIA_GST_INDIVIDUAL</code></td>
<td><p>The <em>Indian GST identification number (GSTIN)</em> is a unique
      identifier required of every business in India for taxation.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">INDIA_PAN_INDIVIDUAL</code></td>
<td><p>The <em>Indian Personal Permanent Account Number (PAN) </em>is a
      unique 10-digit alphanumeric identifier used for identification of
      individualsâparticularly people who pay income tax. It's issued by
      the Indian Income Tax Department. The PAN is valid for the lifetime of the
      holder.</p>
</td>
</tr>
</table>
<h2 data-text="Indonesia" id="indonesia">Indonesia</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">INDONESIA_NIK_NUMBER</code></td>
<td><p>An <em>Indonesian Single Identity Number</em> (Nomor Induk
    Kependudukan, or NIK) is the national identification number of Indonesia.
    The NIK is used as the basis for issuing Indonesian resident identity cards
    (Kartu Tanda Penduduk, or KTP), passports, driver's licenses and other
    identity documents.</p>
</td>
</tr>
</table>
<h2 data-text="Ireland" id="ireland">Ireland</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">IRELAND_DRIVING_LICENSE_NUMBER</code></td>
<td><p>An <em>Irish driving license number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IRELAND_EIRCODE</code></td>
<td><p><em>Eircode</em> is an Irish postal code that uniquely identifies
      an address.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IRELAND_PASSPORT</code></td>
<td><p>An <em>Irish (IE) passport number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">IRELAND_PPSN</code></td>
<td><p>The <em>Irish Personal Public Service Number (PPS number, or PPSN)
      </em> is a unique number for accessing social welfare benefits, public
      services, and information in Ireland.</p>
</td>
</tr>
</table>
<h2 data-text="Israel" id="israel">Israel</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">ISRAEL_IDENTITY_CARD_NUMBER</code></td>
<td><p>The <em>Israel identity card number</em> is issued to all Israeli
      citizens at birth by the Ministry of the Interior. Temporary residents
      are assigned a number when they receive temporary resident status.</p>
</td>
</tr>
</table>
<h2 data-text="Italy" id="italy">Italy</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">ITALY_FISCAL_CODE</code></td>
<td><p>An <em>Italy fiscal code</em> number is a unique 16-digit code
      assigned to Italian citizens as a form of identification.</p>
</td>
</tr>
</table>
<h2 data-text="Japan" id="japan">Japan</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">JAPAN_BANK_ACCOUNT</code></td>
<td><p>A <em>Japanese bank account number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">JAPAN_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>A <em>Japanese driver's license number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">JAPAN_INDIVIDUAL_NUMBER</code></td>
<td><p>The <em>Japanese national identification number</em>âsometimes
      referred to as "My Number"âis a new national ID number as of
      January 2016.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">JAPAN_PASSPORT</code></td>
<td><p>A <em>Japanese passport number</em>. The passport number
      consists of two alphabetic characters followed by seven digits.</p>
</td>
</tr>
</table>
<h2 data-text="Korea" id="korea">Korea</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">KOREA_PASSPORT</code></td>
<td><p>A <em>Korean passport number</em>.
    </p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">KOREA_RRN</code></td>
<td><p>A <em>South Korean Social Security number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="Mexico" id="mexico">Mexico</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">MEXICO_CURP_NUMBER</code></td>
<td><p>The <em>Mexico Clave Ãnica de Registro de PoblaciÃ³n (CURP)
      number</em>, or Unique Population Registry Code or Personal Identification
      Code number. The CURP number is an 18-character state-issued
      identification number assigned by the Mexican government to citizens or
      residents of Mexico and used for taxpayer identification.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">MEXICO_PASSPORT</code></td>
<td><p>A <em>Mexican passport number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="The Netherlands" id="the_netherlands">The Netherlands</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">NETHERLANDS_BSN_NUMBER</code></td>
<td><p>A <em>Dutch Burgerservicenummer (BSN)</em>, or Citizen's
      Service Number, is a state-issued identification number that's
      on driver's licenses, passports, and international ID cards.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">NETHERLANDS_PASSPORT</code></td>
<td><p>A <em>Dutch passport number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="Norway" id="norway">Norway</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">NORWAY_NI_NUMBER</code></td>
<td><p><em>Norwayâs FÃ¸dselsnummer</em>, National Identification
      Number, or Birth Number is assigned at birth, or on migration into the
      country. It is registered with the Norwegian Tax Office.</p>
</td>
</tr>
</table>
<h2 data-text="Paraguay" id="paraguay">Paraguay</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">PARAGUAY_CIC_NUMBER</code></td>
<td><p>A <em>Paraguayan CÃ©dula de Identidad Civil (CIC)</em>, or
      civil identity card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Peru" id="peru">Peru</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">PERU_DNI_NUMBER</code></td>
<td><p>A <em>Peruvian Documento Nacional de Identidad (DNI)</em>, or
      national identity card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Poland" id="poland">Poland</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">POLAND_PESEL_NUMBER</code></td>
<td><p>The <em>PESEL number</em> is the national identification number used
      in Poland. It is mandatory for all permanent residents of Poland, and for
      temporary residents staying there longer than 2 months. It is assigned to
      just one person and cannot be changed.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">POLAND_NATIONAL_ID_NUMBER</code></td>
<td><p>The <em>Polish identity card number.</em> is a government
      identification number for Polish citizens. Every citizen older than 18
      years must have an identity card. The local Office of Civic Affairs issues
      the card, and each card has its own unique number.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">POLAND_PASSPORT</code></td>
<td><p>A <em>Polish passport number</em>.
      Polish passport is an international travel document for Polish citizens.
      It can also be used as a proof of Polish citizenship.</p>
</td>
</tr>
</table>
<h2 data-text="Portugal" id="portugal">Portugal</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">PORTUGAL_CDC_NUMBER</code></td>
<td><p>A <em>Portuguese CartÃ£o de cidadÃ£o (CDC)</em>, or
      Citizen Card, is used as the main identity, Social Security, health
      services, taxpayer, and voter document for citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Singapore" id="singapore">Singapore</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">SINGAPORE_NATIONAL_REGISTRATION_ID_NUMBER</code></td>
<td><p>A unique set of nine alpha-numeric characters on the <em>Singapore National Registration Identity Card</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SINGAPORE_PASSPORT</code></td>
<td><p>A <em>Singaporean passport number</em>.</p></td>
</tr>
</table>
<h2 data-text="South Africa" id="south_africa">South Africa</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">SOUTH_AFRICA_ID_NUMBER</code></td>
<td><p>A <em>South Africa ID number</em>.</p></td>
</tr>
</table>
<h2 data-text="Spain" id="spain">Spain</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_CIF_NUMBER</code></td>
<td><p>The <em>Spanish CÃ³digo de IdentificaciÃ³n Fiscal (CIF)</em> was the
      tax identification system used in Spain for legal entities until 2008.
      It was then replaced by the NÃºmero de IdentificaciÃ³n Fiscal (NIF) for
      natural and juridical persons.</p>
</td></tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_DNI_NUMBER</code></td>
<td><p>A <em>Spain national identity number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>A <em>Spanish driver's license number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_NIE_NUMBER</code></td>
<td><p>The <em>Spanish NÃºmero de IdentificaciÃ³n de Extranjeros (NIE)</em> is
      an identification number for foreigners living or doing business in Spain.
      An NIE number is needed for key transactions such as opening a bank
      account, buying a car, or setting up a mobile phone contract.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_NIF_NUMBER</code></td>
<td><p>The <em>Spanish NÃºmero de IdentificaciÃ³n Fiscal (NIF)</em> is a
      government identification number for Spanish citizens. An NIF number is
      needed for key transactions such as opening a bank account, buying a car,
      or setting up a mobile phone contract.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_PASSPORT</code></td>
<td><p>A <em>Spanish Ordinary Passport (Pasaporte Ordinario) number</em>.
      There are 4 different types of passports in Spain. This detector is for
      the Ordinary Passport (Pasaporte Ordinario) type, which is issued for
      ordinary travel, such as vacations and business trips.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SPAIN_SOCIAL_SECURITY_NUMBER</code></td>
<td><p>The <em>Spanish Social Security number (NÃºmero de AfiliaciÃ³n a la
      Seguridad Social)</em> is a 10-digit sequence that identifies a person in
      Spain for all interactions with the country's Social Security system.</p>
</td>
</tr>
</table>
<h2 data-text="Sweden" id="sweden">Sweden</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">SWEDEN_NATIONAL_ID_NUMBER</code></td>
<td><p>A <em>Swedish Personal Identity Number (personnummer)</em>, a
      national government identification number for Swedish citizens.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">SWEDEN_PASSPORT</code></td>
<td><p>A <em>Swedish passport number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="Taiwan" id="taiwan">Taiwan</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">TAIWAN_PASSPORT</code></td>
<td><p>A <em>Taiwanese passport number</em>.</p>
</td>
</tr>
</table>
<h2 data-text="Thailand" id="thailand">Thailand</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">THAILAND_NATIONAL_ID_NUMBER</code></td>
<td><p>The <em>Thai à¸à¸±à¸à¸£à¸à¸£à¸°à¸à¸³à¸à¸±à¸§à¸à¸£à¸°à¸à¸²à¸à¸à¹à¸à¸¢, or identity card</em>, is used as the
      main identity document for Thai nationals.</p>
</td>
</tr>
</table>
<h2 data-text="Turkey" id="turkey">Turkey</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">TURKEY_ID_NUMBER</code></td>
<td><p>A unique <em>Turkish personal identification number</em>, assigned
      to every citizen of Turkey.</p>
</td>
</tr>
</table>
<h2 data-text="United Kingdom" id="united_kingdom">United Kingdom</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">SCOTLAND_COMMUNITY_HEALTH_INDEX_NUMBER</code></td>
<td><p>The <em>Scotland Community Health Index Number (CHI number)</em> is
      a 10-digit sequence used to uniquely identify a patient within National
      Health Service Scotland (NHS Scotland).</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UK_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>A <em>driver's license number</em> for the United Kingdom of Great
      Britain and  Northern Ireland (UK).</p>
</td></tr>
<tr>
<td><code dir="ltr" translate="no">UK_NATIONAL_HEALTH_SERVICE_NUMBER</code></td>
<td><p>A <em>National Health Service (NHS) number</em> is the unique number
      allocated to a registered user of the three public health services in
      England, Wales, and the Isle of Man.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UK_NATIONAL_INSURANCE_NUMBER</code></td>
<td><p>The <em>National Insurance number (NINO)</em> is a number used in
      the United Kingdom (UK) in the administration of the National Insurance
      or social security system. It identifies people, and is also used for
      some purposes in the UK tax system. The number is sometimes referred to
      as NI No or NINO.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UK_PASSPORT</code></td>
<td><p>A <em>United Kingdom (UK) passport number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UK_TAXPAYER_REFERENCE</code></td>
<td><p>A <em>United Kingdom (UK) Unique Taxpayer Reference (UTR)
      number</em>. This number, comprised of a string of 10 decimal digits, is
      an identifier used by the UK government to manage the taxation system.
      Unlike other identifiers, such as the passport number or social insurance
      number, the UTR is not listed on official identity cards.</p>
</td>
</tr>
</table>
<h2 data-text="United States" id="united_states">United States</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">AMERICAN_BANKERS_CUSIP_ID</code></td>
<td><p>An <em>American Bankers' Committee on Uniform Security Identification
      Procedures (CUSIP) number</em> is a 9-character alphanumeric code that
      identifies a North American financial security.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">FDA_CODE</code></td>
<td><p>Drug product name or active ingredient registered by the United
      States Food and Drug Administration (FDA).</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_ADOPTION_TAXPAYER_IDENTIFICATION_NUMBER</code></td>
<td><p>A <em>United States Adoption Taxpayer Identification Number
      (ATIN)</em> is a type of United States Tax Identification Number (TIN). An
      ATIN is issued by the Internal Revenue Service (IRS) to individuals who
      are in the process of legally adopting a US citizen or resident child.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_BANK_ROUTING_MICR</code></td>
<td><p>The <em>American Bankers Association (ABA) Routing Number</em> (also
      called the <em>transit number</em>) is a nine-digit code. It's used to
      identify the financial institution that's responsible to credit or
      entitled to receive credit for a check or electronic transaction.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_DEA_NUMBER</code></td>
<td><p>A <em>US Drug Enforcement Administration (DEA) number</em> is
      assigned to a health care provider by the US DEA. It allows the health
      care provider to write prescriptions for controlled substances. The DEA
      number is often used as a general "prescriber number" that is a unique
      identifier for anyone who can prescribe medication.</p>
</td></tr>
<tr>
<td><code dir="ltr" translate="no">US_DRIVERS_LICENSE_NUMBER</code></td>
<td><p>A <em>driver's license number</em> for the United States. Format
      can vary depending on the issuing state.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_EMPLOYER_IDENTIFICATION_NUMBER</code></td>
<td><p>A <em>United States Employer Identification Number (EIN)</em>
      is also known as a Federal Tax Identification Number, and is used to
      identify a business entity.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_HEALTHCARE_NPI</code></td>
<td><p>The <em>US National Provider Identifier (NPI)</em> is a unique
      10-digit identification number issued to health care providers in the
      United States by the Centers for Medicare and Medicaid Services (CMS). The
      NPI has replaced the unique provider identification number (UPIN) as the
      required identifier for Medicare services. It's also used by other
      payers, including commercial healthcare insurers.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code></td>
<td><p>A <em>United States Individual Taxpayer Identification Number
      (ITIN)</em> is a type of Tax Identification Number (TIN), issued by the
      Internal Revenue Service (IRS). An ITIN is a tax processing
      number only available for certain nonresident and resident aliens, their
      spouses, and dependents who cannot get a Social Security Number (SSN).</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_PASSPORT</code></td>
<td><p>A <em>United States passport number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_PREPARER_TAXPAYER_IDENTIFICATION_NUMBER</code></td>
<td><p>A <em>United States Preparer Taxpayer Identification Number
      (PTIN)</em> is an identification number that all paid tax return preparers
      must use on US federal tax returns or claims for refund submitted to the
      US Internal Revenue Service (IRS).</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code></td>
<td><p>A <em>United States Social Security number (SSN)</em> is a 9-digit
      number issued to US citizens, permanent residents, and temporary
      residents. This detector will not match against numbers with all zeroes in
      any digit group (that is, 000-##-####, ###-00-####, or ###-##-0000),
      against numbers with 666 in the first digit group, or against numbers
      whose first digit is 9.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_STATE</code></td>
<td><p>A <em>United States state name</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_TOLLFREE_PHONE_NUMBER</code></td>
<td><p>A <em>US toll-free telephone number</em>.</p>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">US_VEHICLE_IDENTIFICATION_NUMBER</code></td>
<td><p>A <em>vehicle identification number (VIN)</em> is a unique 17-digit
      code assigned to every on-road motor vehicle in North America.</p>
</td>
</tr>
</table>
<h2 data-text="Uruguay" id="uruguay">Uruguay</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">URUGUAY_CDI_NUMBER</code></td>
<td><p>A <em>Uruguayan CÃ©dula de Identidad (CDI)</em>, or
      identity card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Venezuela" id="venezuela">Venezuela</h2>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">VENEZUELA_CDI_NUMBER</code></td>
<td><p>A <em>Venezuelan CÃ©dula de Identidad (CDI)</em>, or
      national identity card, is used as the main identity document for
      citizens. </p>
</td>
</tr>
</table>
<h2 data-text="Documents" id="documents">Documents</h2>
<p>In addition to its ability to scan and classify information contained within
documents, Cloud DLP can classify documents into multiple
enterprise-specific categories. When combined with personally identifiable
information (PII) inspection scan results, this classification can be useful
for document risk assessment, policy enforcement, and similar use cases.</p>
<table>
<tr>
<th>InfoType</th>
<th>Description</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/FINANCE/REGULATORY</code></td>
<td><p>Finance <em>regulatory documents</em> include financial regulations,
      tax laws, rules, and guidelines. They are typically issued by tax or
      regulatory authorities.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/FINANCE/SEC_FILING</code></td>
<td><p>An <em>SEC filing</em> is a formal document submitted to the US
      Securities and Exchange Commission. The most commonly filed SEC forms
      are 10-K and 10-Q.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/HR/RESUME</code></td>
<td><p>A <em>rÃ©sumÃ©</em> or a <em>curriculum vitae (CV)</em>
      document.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/LEGAL/BLANK_FORM</code></td>
<td><p>A <em>blank legal form</em> or <em>template</em>. This document type
      typically has multiple areas or boxes left empty to be filled in by an
      individual, who then submits the form to a legal institution.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/LEGAL/BRIEF</code></td>
<td><p>A <em>legal brief</em> is a document that advocates a particular
      outcome of a case, presenting supporting points, law interpretations, and
      recommendations.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/LEGAL/COURT_ORDER</code></td>
<td><p>A <em>court order, ruling, or decision</em> is a document produced by
      the court requesting a specific action from the involved parties.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/LEGAL/LAW</code></td>
<td><p>A <em>law document</em> is a document that contains the text of a
      law or a regulation.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/LEGAL/PLEADING</code></td>
<td><p>A <em>pleading</em> is a formal written statement of a party's claims
      or defenses to another party's claims. Examples include a complaint, a
      demurrer, or an answer.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/R&amp;D/PATENT</code></td>
<td><p>A <em>patent</em> or a <em>patent application document</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/R&amp;D/SOURCE_CODE</code></td>
<td><p>A <em>source code file</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/R&amp;D/SYSTEM_LOG</code></td>
<td><p>A <em>system or application software log</em>.</p></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">DOCUMENT_TYPE/R&amp;D/DATABASE_BACKUP</code></td>
<td><p>A <em>database backup</em> file.</p></td>
</tr>
</table>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-job-triggers]</H1></p><div class="devsite-article-body clearfix">
<p>A <em>job</em> is an action that Cloud Data Loss Prevention runs to either scan content for
sensitive data or calculate the risk of re-identification.
Cloud DLP creates and runs a job resource whenever you tell it to
inspect your data.</p>
<p>There are currently two types of Cloud DLP jobs:</p>
<ul>
<li><em>Inspection jobs</em> inspect your content for sensitive data according to your
criteria and generate summary reports of where and what type of sensitive
data exists.</li>
<li><em>Risk analysis jobs</em> analyze de-identified data and return metrics about the
likelihood that the data can be re-identified.</li>
</ul>
<p>You can schedule when Cloud DLP runs jobs by creating <em>job
triggers</em>. A job trigger is an event that automates the creation of
DLP jobs to scan Google Cloud storage repositories,
including Cloud Storage buckets, BigQuery tables, and
Datastore kinds.</p>
<p>Job triggers enable you to schedule scan jobs by setting intervals at which
each trigger goes off. They can be configured to look for new findings since
the last scan run to help monitor changes or additions to content, or to
generate up-to-date findings reports. Scheduled triggers run on an interval
that you set, from 1 day to 60 days.</p>
<p><aside class="special"><strong>Note:</strong> Prematurely
  canceling an operation midway through a job still incurs costs for the portion of
  the job that was completed. For more information about billing, see <a href="https://cloud.google.com/dlp/pricing">Cloud DLP pricing</a>.</aside>
</p>
<h2 data-text="Next steps" id="next_steps">Next steps</h2>
<p>More information about how to create, edit, and run jobs and job triggers in
the following topics:</p>
<ul>
<li><a href="/dlp/docs/creating-job-triggers">Creating Cloud DLP inspection jobs and job
triggers</a></li>
<li><a href="/dlp/docs/compute-risk-analysis">Measuring re-identification and disclosure risk</a>
(Covers risk analysis jobs.)</li>
</ul>
<p>In addition, the following quickstart is available:</p>
<ul>
<li><a href="/dlp/docs/quickstart-create-job-trigger">Quickstart creating a Cloud DLP job
trigger</a></li>
</ul>
<h2 data-text="The JobTrigger object" id="the_jobtrigger_object">The <code dir="ltr" translate="no">JobTrigger</code> object</h2>
<p>A job trigger is represented in the DLP API by the
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers"><code dir="ltr" translate="no">JobTrigger</code></a>
object.</p>
<h3 data-text="Job trigger configuration fields" id="job_trigger_configuration_fields">Job trigger configuration fields</h3>
<p>Each <code dir="ltr" translate="no">JobTrigger</code> contains several configuration fields, including:</p>
<ul>
<li>The trigger's name and display name, and a description.</li>
<li>A collection of
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers#trigger"><code dir="ltr" translate="no">Trigger</code></a>
objects, each of which contains a
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers#schedule"><code dir="ltr" translate="no">Schedule</code></a>
object, which defines the scan recurrence in seconds.</li>
<li>An
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig"><code dir="ltr" translate="no">InspectJobConfig</code></a>
object, which contains the configuration information for the triggered job.</li>
<li>A
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers#status"><code dir="ltr" translate="no">Status</code></a>
enumeration, which indicates whether the trigger is currently active.</li>
<li>Timestamp fields representing creation, update, and last run times.</li>
<li>A collection of
<a href="/dlp/docs/reference/rest/v2/Error"><code dir="ltr" translate="no">Error</code></a> objects, if any
were encountered when the trigger was activated.</li>
</ul>
<h3 data-text="Job trigger methods" id="job_trigger_methods">Job trigger methods</h3>
<p>Each <code dir="ltr" translate="no">JobTrigger</code> object also includes several built-in methods. Using these
methods you can:</p>
<ul>
<li>Create a new job trigger:
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/create"><code dir="ltr" translate="no">projects.jobTriggers.create</code></a></li>
<li>Update an existing job trigger:
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/patch"><code dir="ltr" translate="no">projects.jobTriggers.patch</code></a></li>
<li>Delete an existing job trigger:
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/delete"><code dir="ltr" translate="no">projects.jobTriggers.delete</code></a></li>
<li>Retrieve an existing job trigger, including its configuration and status:
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/get"><code dir="ltr" translate="no">projects.jobTriggers.get</code></a></li>
<li>List all existing job triggers:
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers/list"><code dir="ltr" translate="no">projects.jobTriggers.list</code></a></li>
</ul>
<h2 data-text="Using Job triggers" id="using_job_triggers">Using Job triggers</h2>
<p>This section describes how to use job triggers to only scan new content, and
how to trigger jobs every time a file is uploaded to Cloud Storage using
Cloud Functions.</p>
<h3 data-text="Limit scans to only new content" id="limit_scans_to_only_new_content">Limit scans to only new content</h3>
<p>You can also set an option to automatically set the timespan date for files
stored in either <a href="/storage">Cloud Storage</a> or
<a href="/bigquery">BigQuery</a>. Once you've set the
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#timespanconfig"><code dir="ltr" translate="no">TimespanConfig</code></a>
object to auto-populate, Cloud DLP will only scan data that
has been added or modified since the last trigger ran:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">...
  timespan_config {
        enable_auto_population_of_timespan_config: true
      }
...
</code></pre>
<h3 data-text="Trigger jobs at file upload" id="trigger_jobs_at_file_upload">Trigger jobs at file upload</h3>
<p>In addition to the support for job triggers that is built into
Cloud DLP, the Google Cloud also has a variety of other
components that can be used to integrate or trigger DLP
jobs. For example, you can use <a href="/functions">Cloud Functions</a> to
trigger a DLP scan every time a file is uploaded to
Cloud Storage.</p>
<p>For step-by-step instructions about how to do this, see
<a href="/solutions/automating-classification-of-data-uploaded-to-cloud-storage">Automating the Classification of Data Uploaded to
Cloud Storage</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/likelihood]</H1></p><div class="devsite-article-body clearfix">
<p>Scan results are categorized based on how likely they are to represent a match.
Cloud Data Loss Prevention uses a bucketized
representation of likelihood, which is intended to indicate how likely it is
that a piece of data matches a given <a href="/dlp/docs/infotypes-reference" title="InfoTypes reference">infoType</a>.</p>
<p>In your request, set the minimum level of likelihood for scan results that you
want to retrieve. The following table lists the possible values for likelihood,
arranged in order from lowest to highest probability of a match:</p>
<table>
<thead>
<tr>
<th><code dir="ltr" translate="no">ENUM</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">LIKELIHOOD_UNSPECIFIED</code></td>
<td>Default value; same as POSSIBLE.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">VERY_UNLIKELY</code></td>
<td>It is very unlikely that the data matches the given <code dir="ltr" translate="no">InfoType</code>.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">UNLIKELY</code></td>
<td>It is unlikely that the data matches the given <code dir="ltr" translate="no">InfoType</code>.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">POSSIBLE</code></td>
<td>It is possible that the data matches the given <code dir="ltr" translate="no">InfoType</code>.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">LIKELY</code></td>
<td>It is likely that the data matches the given <code dir="ltr" translate="no">InfoType</code>.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">VERY_LIKELY</code></td>
<td>It is very likely that the data matches the given <code dir="ltr" translate="no">InfoType</code>.</td>
</tr>
</tbody>
</table>
<p>The likelihood you set affects the number of matching elements that are returned
in the response. For example, a request with likelihood set to <code dir="ltr" translate="no">POSSIBLE</code> yields
results that match <code dir="ltr" translate="no">POSSIBLE</code>, <code dir="ltr" translate="no">LIKELY</code>, and <code dir="ltr" translate="no">VERY_LIKELY</code>. A request with
likelihood set to <code dir="ltr" translate="no">VERY_LIKELY</code> yields the least number of results. Its response
contains only the findings that are very likely to match the <code dir="ltr" translate="no">InfoType</code> your
request is scanning for.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-method-types]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention includes different types of methods that you can use to inspect
or transform your data. Using these different methods, you can inspect data both
on and off Google Cloud and optimize Cloud DLP behavior for
different types of workloads.</p>
<p>Cloud DLP provides the following method types:</p>
<ul>
<li><a href="#content-methods">Content methods</a></li>
<li><a href="#storage-methods">Storage methods</a></li>
<li><a href="#hybrid-methods">Hybrid methods</a></li>
</ul>
<h2 data-text="Content methods" id="content-methods">Content methods</h2>
<p><em>Content methods</em> are synchronous, stateless methods. The data to be inspected
or transformed is sent directly in the request to the DLP API.
Cloud DLP inspection findings or transformed data is returned in
the API response. Request data is encrypted in transit and is not persisted.</p>
<p><img alt="Diagram of content methods dataflow, showing a client sending data via an
API request to Cloud DLP, which can inspect and classify or
de-identify and transform the data, sending a synchronous API response to the
client." src="/dlp/docs/images/concepts-method-types-contentmethods.png" width="798"/> </p>
<p>To learn more, explore the REST API reference for content methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">content.inspect</code></a></li>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">content.deidentify</code></a></li>
<li><a href="/dlp/docs/reference/rest/v2/projects.content/reidentify"><code dir="ltr" translate="no">content.reidentify</code></a></li>
<li><a href="/dlp/docs/reference/rest/v2/projects.image/redact"><code dir="ltr" translate="no">image.redact</code></a></li>
</ul>
<h2 data-text="Storage methods" id="storage-methods">Storage methods</h2>
<p><em>Storage methods</em> are designed to inspect data stored on Google Cloud in systems
like <a href="/storage">Cloud Storage</a>, <a href="/bigquery">BigQuery</a>, and
<a href="/datastore">Datastore</a>. To enable storage inspection, you create a
Cloud DLP job using the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">dlpJobs</code></a>
resource. Each job runs as a managed service to inspect data and then perform
<a href="/dlp/docs/concepts-actions">DLP actions</a> such as save or publish findings. In
addition to these optional actions, Cloud DLP creates and persists
details about the job including job status, bytes scanned, and summary findings
per infoType. You can manage jobs using the DLP API or
Cloud DLP in the <a href="https://console.cloud.google.com/security/dlp">Google Cloud console</a>.</p>
<p><img alt="Diagram of storage methods dataflow, showing Cloud DLP inspecting
data on a Google Cloud storage repository, and then either saving or publishing
findings." src="/dlp/docs/images/concepts-method-types-storagemethods.png" width="811"/> </p>
<p>To learn more, explore the REST API reference for storage methods:</p>
<ul>
<li><a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">projects.dlpJobs</code> resource</a></li>
</ul>
<h2 data-text="Hybrid methods" id="hybrid-methods">Hybrid methods</h2>
<p><em>Hybrid methods</em> are a set of asynchronous API methods that allow you to scan
payloads of data sent from virtually any source for sensitive information and
store the findings in Google Cloud. Hybrid methods are similar to
<a href="#content-methods">content methods</a> in that the data you want to inspect is
included in one or more inspection requests; however, unlike
<a href="#content-methods">content methods</a>, <em>hybrid methods</em> do not return inspection
results in the API response. Instead, inspection results are processed
server-side asynchronously and results are tabulated and stored in a
manner similar to <a href="#storage-methods">storage methods</a>.</p>
<p>To enable hybrid inspection, you create a Cloud DLP job using the
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs"><code dir="ltr" translate="no">dlpJobs</code></a>
resource. Each <em>hybrid</em> job runs as a managed service to listen for inspection
requests and performs <a href="/dlp/docs/concepts-actions">DLP actions</a> such as
save or publish findings. In addition to these optional actions,
Cloud DLP creates and persists details about the job including job
status, bytes scanned, and summary findings per infoType. You can manage jobs
using the DLP API or Cloud DLP in the
<a href="https://console.cloud.google.com/security/dlp">Google Cloud console</a>.</p>
<p><img alt="Diagram of hybrid jobs dataflow, showing your application sending data from
an external source to Cloud DLP, Cloud DLP inspecting
the data, and then either saving or publishing
findings." src="/dlp/docs/images/concepts-method-types-hybrid.png" width="791"/> </p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Read the how-to guides to get started with inspecting text and images for
sensitive data, as well as redacting sensitive data from text and images:
<ul>
<li><a href="/dlp/docs/inspecting-text">Inspecting text for sensitive data</a></li>
<li><a href="/dlp/docs/inspecting-structured-text">Inspecting structured text for sensitive
data</a></li>
<li><a href="/dlp/docs/inspecting-images">Inspecting images for sensitive data</a></li>
<li><a href="/dlp/docs/redacting-sensitive-data-images">Redacting sensitive data from
images</a></li>
<li><a href="/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data</a></li>
</ul></li>
<li>For more information about inspecting storage and how to use actions, see
<a href="/dlp/docs/inspecting-storage">Inspecting storage and databases for sensitive
data</a>.</li>
<li>Review pricing for <a href="/dlp/pricing#content-pricing">content inspection and de-identification
methods</a> and <a href="/dlp/pricing#storage-pricing">storage inspection
jobs</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/quote]</H1></p><div class="devsite-article-body clearfix">
<p>Inspection findings can optionally return a quote, which is the string that
matches an infoType detector.</p>
<p>Quotes are potentially sensitive, so by default Cloud DLP
does not include them in responses. Instead, it provides location
details about where to find the quote. To have a quote returned, requests must
enable <code dir="ltr" translate="no">include_quote</code> within
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a>
.</p>
<p>Quotes will be copied to BigQuery when <code dir="ltr" translate="no">include_quote</code> is true
and BigQuery storage has been turned on for findings.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-risk-analysis]</H1></p><div class="devsite-article-body clearfix">
<p><em>Re-identification risk analysis</em> (or just <em>risk analysis</em>) is the process of
analyzing sensitive data to find properties that might increase the risk of
subjects being identified, or of sensitive information about individuals being
revealed. You can use risk analysis methods before de-identification to help
determine an effective de-identification strategy, or after de-identification to
monitor for any changes or outliers.</p>
<p>De-identification is the process of removing identifying information from data.
Cloud Data Loss Prevention can
<a href="/dlp/docs/deidentify-sensitive-data">detect and de-identify sensitive data</a>
for you according to how you've configured it to conform to your organization's
requirements.</p>
<p>Conversely,
<a class="external" href="https://en.wikipedia.org/wiki/Data_Re-Identification">re-identification</a> 
is the process of matching up de-identified data with other available data to
determine the person to whom the data belongs. Re-identification is most often
talked about in the context of sensitive personal information, such as medical
or financial data.</p>
<p>For more information about using Cloud DLP to measure
various types of risk, see
<a href="/dlp/docs/compute-risk-analysis">Measuring re-identification and disclosure
risk</a>.</p>
<h2 data-text="Risk analysis terms and techniques" id="risk_analysis_terms_and_techniques">Risk analysis terms and techniques</h2>
<p>If you don't correctly or adequately de-identify sensitive data, you risk an
attacker re-identifying the data or learning sensitive information about
individuals, which can have serious privacy implications.
Cloud DLP can help compute this risk, according to
several metrics.</p>
<p>Before diving into the metrics, we'll first define a few common terms:</p>
<ul>
<li><em>Identifiers</em>: Identifiers can be used to uniquely identify an
individual. For example, someone's full name or government ID number are
considered identifiers.</li>
<li><em>Quasi-identifiers</em>: Quasi-identifiers don't uniquely identify an
individual, but, when combined and cross-referenced with individual
records, they can substantially increase the likelihood that an attacker
will be able to re-identify an individual. For example, ZIP codes and ages
are considered quasi-identifiers.</li>
<li><em>Sensitive data</em>: Sensitive data is data that is protected against
unauthorized exposure. Attributes like health conditions, salary, criminal
offenses, and geographic location are typically considered sensitive data.
Note that there can be overlap between identifiers and sensitive data.</li>
<li><em>Equivalence classes</em>: An equivalence class is a group of rows with
identical quasi-identifiers.</li>
</ul>
<p>There are four techniques that Cloud DLP can use to quantify
the level of risk associated with a dataset:</p>
<ul>
<li><a href="/dlp/docs/concepts-risk-analysis#about-k-anonymity"><em>k-anonymity</em></a>:
A property of a dataset that indicates the re-identifiability of its
records. A dataset is <em>k</em>-anonymous if quasi-identifiers for each person in
the dataset are identical to at least <em>k</em> â 1 other people also in the
dataset.</li>
<li><a href="/dlp/docs/concepts-risk-analysis#about-l-diversity"><em>l-diversity</em></a>:
An extension of <em>k</em>-anonymity that additionally measures the diversity of
sensitive values for each column in which they occur. A dataset has
<em>l</em>-diversity if, for every set of rows with identical quasi-identifiers,
there are at least <em>l</em> distinct values for each sensitive attribute.</li>
<li><a href="/dlp/docs/concepts-risk-analysis#about-k-map"><em>k-map</em></a>:
Computes re-identifiability risk by comparing a given de-identified dataset
of subjects with a larger re-identificationâor "attack"âdataset.
Cloud DLP doesn't know the attack dataset, but it
statistically models it by using publicly available data like the US Census,
by using a custom statistical model (indicated as one or more
BigQuery tables), or by extrapolating from the distribution of
values in the input dataset. Each datasetâthe sample dataset and the
re-identification datasetâshares one or more quasi-identifier columns.</li>
<li>Delta-presence
(<a href="/dlp/docs/concepts-risk-analysis#about-delta-presence"><em>Î´</em>-presence</a>):
Estimates the probability that a given user in a larger population is
present in the dataset. This is used when membership in the dataset is
itself sensitive information. Similarly to <em>k</em>-map,
Cloud DLP doesn't know the attack dataset, but statistically
models it using publicly available data, user-specified distributions, or
extrapolation from the input dataset.</li>
</ul>
<h2 data-text="About k-anonymity" id="about-k-anonymity">About <em>k</em>-anonymity</h2>
<p>When collecting data for research purposes, de-identification can be essential
for helping maintain participants' privacy. At the same time, de-identification
may result in a dataset losing its practical usefulness. <em>k</em>-anonymity was
created from a need both to quantify the re-identifiability of a dataset and to
balance the usefulness of de-identified people data and the privacy of the
people whose data is being used. It is a property of a dataset that can be used
to assess the re-identifiability of records within the dataset.</p>
<p>As an example, consider a set of patient data:</p>
<table>
<thead>
<tr>
<th>Patient ID</th>
<th>Full Name</th>
<th>ZIP Code</th>
<th>Age</th>
<th>Condition</th>
<th>...</th>
</tr>
</thead>
<tbody>
<tr>
<td>746572</td>
<td>John J. Jacobsen</td>
<td>98122</td>
<td>29</td>
<td>Heart disease</td>
<td></td>
</tr>
<tr>
<td>652978</td>
<td>Debra D. Dreb</td>
<td>98115</td>
<td>29</td>
<td>Diabetes, Type II</td>
<td></td>
</tr>
<tr>
<td>075321</td>
<td>Abraham A. Abernathy</td>
<td>98122</td>
<td>54</td>
<td>Cancer, Liver</td>
<td></td>
</tr>
<tr>
<td>339012</td>
<td>Karen K. Krakow</td>
<td>98115</td>
<td>88</td>
<td>Heart disease</td>
<td></td>
</tr>
<tr>
<td>995212</td>
<td>William W. Wertheimer</td>
<td>98115</td>
<td>54</td>
<td>Asthma</td>
<td></td>
</tr>
<tr>
<td>...</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>This dataset contains all three types of data we described previously:
identifiers, quasi-identifiers, and sensitive data.</p>
<p>If sensitive data like health conditions aren't masked or redacted, an attacker
could potentially use the quasi-identifiers to which each one is attached,
potentially cross-referencing with another dataset that contains similar
quasi-identifiers, and re-identify the people to whom that sensitive data
applies.</p>
<p>A dataset is said to be <em>k</em>-anonymous if every combination of values for
demographic columns in the dataset appears for at least <em>k</em> different records.
Recall that a group of rows with identical quasi-identifiers is called an
"equivalence class." For example, if you've de-identified the quasi-identifiers
enough that there is a minimum of four rows whose quasi-identifier values are
identical, the dataset's <em>k</em>-anonymity value is 4.</p>
<h3 data-text="Entity IDs and computing k-anonymity" id="entity-ids">Entity IDs and computing <em>k</em>-anonymity</h3>
<p>An important option that Cloud DLP includes when calculating
<em>k</em>-anonymity is the optional <em>entity identifier (ID)</em>. An entity ID
enables you to more accurately determine <em>k</em>-anonymity in the common scenario
wherein several rows of your dataset correspond to the same user. Otherwise, if
every row, regardless of user, is counted separately, the total
user count used for calculating the dataset's <em>k</em>-anonymity value is made
artificially high. This makes computed <em>k</em>-anonymity values inaccurate.</p>
<p>Consider the following simple set of data:</p>
<table>
<thead>
<tr>
<th>User ID</th>
<th>ZIP code</th>
</tr>
</thead>
<tbody>
<tr>
<td>01</td>
<td>42000</td>
</tr>
<tr>
<td>02</td>
<td>17000</td>
</tr>
<tr>
<td>02</td>
<td>42000</td>
</tr>
<tr>
<td>03</td>
<td>17000</td>
</tr>
<tr>
<td>03</td>
<td>42000</td>
</tr>
<tr>
<td>03</td>
<td>42000</td>
</tr>
<tr>
<td>04</td>
<td>42000</td>
</tr>
<tr>
<td>04</td>
<td>17000</td>
</tr>
</tbody>
</table>
<p>Without using an entity ID to note when different rows belong to the same user,
the total user count that is used when calculating <em>k</em>-anonymity is 8,
even though the actual number of users is 4. In this dataset, using traditional
<em>k</em>-anonymity calculation methods (without an entity ID), 3 people have a
<em>k</em>-anonymity value of 3, and 5 people have a <em>k</em>-anonymity value of 5, even
though there are just 4 actual people in the database.</p>
<p>Using an entity ID causes Cloud DLP to consider the multiset
of ZIP codes that a user is associated with as a quasi-identifier when
calculating <em>k</em>-anonymity. In the case of our example, there are actually three
"composite" quasi-identifier values because there are three distinct
combinations of quasi-identifier that are assigned to users: 42000, the
multiset of 17000 and 42000, and the multiset of 17000, 42000, and 42000. They
correspond to users as follows:</p>
<ul>
<li>[42000] is associated with 1 unique user (01).</li>
<li>[17000, 42000] is associated with 2 unique users (02 and 04).</li>
<li>[17000, 42000, 42000] is associated with 1 unique user (03).</li>
</ul>
<p>As you can see, this method takes into account that users may occur more than
once in our ZIP code database, and it treats them accordingly when calculating
<em>k</em>-anonymity.</p>
<h3 data-text="k-anonymity resources" id="k-anonymity_resources"><em>k</em>-anonymity resources</h3>
<p>For more information about <em>k</em>-anonymity, see
<a class="external" href="http://scholar.google.com/scholar?q=Protecting+Privacy+when+Disclosing+Information:+k-Anonymity+and+Its+Enforcement+through+Generalization+and+Suppression">Protecting Privacy when
Disclosing Information: <em>k</em>-Anonymity and Its Enforcement through Generalization
and
Suppression</a>,
by Pierangela Samarati and Latanya Sweeney of the Harvard University Data
Privacy Lab.</p>
<p>To learn how to compute <em>k</em>-anonymity with Cloud DLP, with or
without entity IDs, see <a href="/dlp/docs/compute-k-anonymity">Computing <em>k</em>-anonymity for a
dataset</a>.</p>
<h2 data-text="About l-diversity" id="about-l-diversity">About <em>l</em>-diversity</h2>
<p><em>l</em>-diversity is closely related to <em>k</em>-anonymity, and was created to help
address a de-identified dataset's susceptibility to attacks such as:</p>
<ul>
<li>Homogeneity attacks, in which attackers predict sensitive values for a
set of <em>k</em>-anonymized data by taking advantage of the homogeneity of values
within a set of <em>k</em> records.</li>
<li>Background knowledge attacks, in which attackers take advantage of
associations between quasi-identifier values that have a certain sensitive
attribute to narrow down the attribute's possible values.</li>
</ul>
<p><em>l</em>-diversity attempts to measure how much an attacker can learn about people
in terms of <em>k</em>-anonymity and equivalence classes (sets of rows with identical
quasi-identifier values). A dataset has <em>l</em>-diversity if, for every equivalence
class, there are at least <em>l</em> unique values for each sensitive attribute. For
each equivalence class, how many sensitive attributes are there in the dataset?
For example, if <em>l</em>-diversity = 1, that means everyone has the same sensitive
attribute, if <em>l</em>-diversity = 2, that means everyone has one of two sensitive
attributes, and so on.</p>
<h3 data-text="l-diversity resources" id="l-diversity_resources"><em>l</em>-diversity resources</h3>
<p>For more information about <em>l</em>-diversity, see <a class="external" href="https://scholar.google.com/scholar?q=l-Diversity:+Privacy+Beyond+k-Anonymity"><em>l</em>-Diversity: Privacy Beyond
<em>k</em>-Anonymity</a>,
by Ashwin Machanavajjhala, Johannes Gerke, and Daniel Kifer of the Cornell
University Department of Computer Science.</p>
<p>To learn how to compute <em>l</em>-diversity with Cloud DLP, see
<a href="/dlp/docs/compute-l-diversity">Computing <em>l</em>-diversity for a dataset</a>.</p>
<h2 data-text="About k-map" id="about-k-map">About <em>k</em>-map</h2>
<p><em>k</em>-map is very similar to <em>k</em>-anonymity, except that it assumes that the
attacker most likely doesn't know who is in the dataset. Use <em>k</em>-map if your
dataset is relatively small, or if the level of effort involved in
generalizing attributes would be too high.</p>
<p>Just like <em>k</em>-anonymity, <em>k</em>-map requires you to determine which columns of
your database are quasi-identifiers. In doing this, you are stating what data
an attacker will most likely use to re-identify subjects. In addition,
computing a <em>k</em>-map value requires a re-identification dataset: a larger
table with which to compare rows in the original dataset.</p>
<p>Consider the following small example dataset. This sample data is part of a
larger hypothetical database, gathered from a survey whose answers included
sensitive information.</p>
<table>
<thead>
<tr>
<th>ZIP code</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>85535</td>
<td>79</td>
</tr>
<tr>
<td>60629</td>
<td>42</td>
</tr>
</tbody>
</table>
<p>Taken on its own, this appears to be the same amount of information for both
individuals. In fact, considering k-anonymity for the larger dataset might lead
to the assertion that the subject corresponding to the second row is highly
identifiable. However, if you back up and consider the data, you'll realize
it's not. In particular, consider the United States ZIP code 85535, in which
about 20 people currently live. There is probably only one person of exactly
79 years of age living in the 85535 ZIP code. Compare this to ZIP code 60629,
which is part of the Chicago metropolitan area and houses over 100,000 people.
There are approximately 1,000 people of exactly 42 years of age in that ZIP code.</p>
<p>The first row in our small dataset was easily re-identified, but not the second.
According to <em>k</em>-anonymity, however, both rows might be completely unique in the
larger dataset.</p>
<p><em>k</em>-map, like <em>k</em>-anonymity, requires you to determine which columns of your
database are quasi-identifiers. Cloud DLP's risk analysis APIs
simulate a re-identification dataset to approximate the steps an attacker might
go through to compare the original dataset in order to re-identify the data. For
our previous example, since it deals in US locations (ZIP codes) and personal
data (ages), and since we assume that the attacker doesn't know who participated
in the survey, the re-identification dataset could be everyone living in the US.</p>
<p>Now that you have quasi-identifiers and a re-identification dataset, you can
compute the <em>k</em>-map value: Your data satisfies <em>k</em>-map with value <em>k</em> if every
combination of values for the quasi-identifiers appears at least <em>k</em> times in
the re-identification dataset.</p>
<p>Given this definition, and that the first row in our database likely only
corresponds to one person in the US, the example dataset doesn't satisfy a
<em>k</em>-map value requirement of 2 or more. To get a larger <em>k</em>-map value, we
could remove age values like we've done here:</p>
<table>
<thead>
<tr>
<th>ZIP code</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>85535</td>
<td>**</td>
</tr>
<tr>
<td>60629</td>
<td>**</td>
</tr>
</tbody>
</table>
<p>As previously mentioned, the 85535 ZIP code has about 20 people and 60629 has
over 100,000. Therefore, we can estimate that this new, generalized dataset has
a <em>k</em>-map value of around 20.</p>
<h3 data-text="k-map resources" id="k-map_resources"><em>k</em>-map resources</h3>
<p>For more information about <em>k</em>-map and its relationship to <em>k</em>-anonymity, see
<a class="external" href="https://scholar.google.com/scholar?q=Protecting+Privacy+Using+k-Anonymity">Protecting Privacy Using
k-Anonymity</a>,
by Khaled El Emam and Fida Kamal Dankar, in the <em>Journal of the American Medical
Informatics Association</em>.</p>
<p>To learn how to compute <em>k</em>-map estimates with Cloud DLP, see
<a href="/dlp/docs/compute-k-map">Computing <em>k</em>-map for a dataset</a>.</p>
<h2 data-text="About Î´-presence" id="about-delta-presence">About <em>Î´</em>-presence</h2>
<p>Delta-presence (<em>Î´</em>-presence) estimates the risk associated with an attacker who
wants to find out whether their target is in the dataset. This is slightly
different than re-identification risk in that the goal is not to find which
exact record corresponds which individual, only to know whether an individual is
part of the dataset. Using this metric is particularly appropriate if all
individuals in the dataset share a common sensitive attribute; for example, they
all have the same medical diagnosis.</p>
<p>Like the other risk metrics, <em>Î´</em>-presence requires you to determine which
columns of your database are quasi-identifiers. In doing this, you are stating
what data an attacker will most likely use to find out which individuals are in
the dataset. Like <em>k</em>-map, computing <em>Î´</em>-presence requires an attack dataset: a
larger table with which to compare rows in the original dataset.</p>
<p>Consider the following small example dataset. This sample data is part of a
larger hypothetical database of people with a certain genetic disease.</p>
<table>
<thead>
<tr>
<th>ZIP code</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>85942</td>
<td>72</td>
</tr>
<tr>
<td>85942</td>
<td>72</td>
</tr>
<tr>
<td>62083</td>
<td>53</td>
</tr>
</tbody>
</table>
<p>In the United States ZIP code 85942, there are approximately 2 people aged
72, and in ZIP code 62083, there are approximately 5 people aged 53. The first
two records are not exactly re-identifiable because both have the same
quasi-identifiers. But since only two individuals share these quasi-identifiers
in the larger population, an attacker can deduce that both of them suffer from
the genetic disease. <em>Î´</em>-presence quantifies this particular risk by computing
the ratio of people with certain quasi-identifiers that are in the dataset.</p>
<p><em>Î´</em>-presence, like the other risk metrics, requires you to determine which
columns of your database are quasi-identifiers. And like for <em>k</em>-map estimation,
Cloud DLP's risk analysis APIs simulate a population dataset to
approximate the dataset that an attacker might use to find out who is in the
dataset. For our previous example, since it deals in US locations (ZIP codes)
and personal data (ages), and since we assume that the attacker doesn't know who
has the genetic disease, this population dataset could be everyone living in the
US.</p>
<p>Now that you have quasi-identifiers and a re-identification dataset, you can
compute the <em>Î´</em>-presence value: your data satisfies the <em>Î´</em>-presence with value
<em>Î´</em> if every combination of values for the quasi-identifiers appears at most
<em>Î´</em> * <em>k</em> times in your dataset, where <em>k</em> is the total number of people with
these quasi-identifier values in the population dataset. Unlike <em>k</em> in
<em>k</em>-anonymity or <em>k</em>-map, the <em>Î´</em> in <em>Î´</em>-presence is a real number between 0 and
1.</p>
<p>Given this definition, and that both people of age 72 in ZIP code 85942 in the
general population are also in our database, this dataset doesn't
satisfy <em>Î´</em>-presence for any <em>Î´</em> strictly smaller than 1. To get a lower
<em>Î´</em>-presence value, we could remove the age value of the first two rows:</p>
<table>
<thead>
<tr>
<th>ZIP code</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>85942</td>
<td>**</td>
</tr>
<tr>
<td>85942</td>
<td>**</td>
</tr>
<tr>
<td>62083</td>
<td>53</td>
</tr>
</tbody>
</table>
<p>Now, since 80 people live in ZIP code 85942, the <em>Î´</em> value for the first two
records is approximately 2 / 80 = 2.5%; and the <em>Î´</em> value for the third record
is approximately 1 / 5 = 20%. Therefore, we can estimate that this new,
generalized dataset has a <em>Î´</em>-presence value of around 20%.</p>
<h3 data-text="Î´-presence resources" id="Î´-presence_resources"><em>Î´</em>-presence resources</h3>
<p>For more information about <em>Î´</em>-presence estimation based on statistical data,
see <a class="external" href="https://www.semanticscholar.org/paper/S-Presence-Without-Complete-World-Knlowedge-Nergiz-Clifton/9844b86be108d54193fc149d4901fac815a08845">Î´-Presence Without Complete World
Knowledge</a>,
by Mehmet Ercan Nergiz and Chris Clifton from the Purdue University <em>Department
of Computer Science Technical Reports</em>.</p>
<p>To learn how to compute <em>Î´</em>-presence estimates with Cloud DLP,
see <a href="/dlp/docs/compute-d-presence">Computing <em>Î´</em>-presence for a dataset</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/specifying-location]</H1></p><div class="devsite-article-body clearfix">
<p>With the ability to specify a region in which to perform your Cloud Data Loss Prevention
operations, you can control where your potentially sensitive data is processed.
This topic explains the concept of Cloud DLP processing location
and shows you how to specify a region.</p>
<aside class="note"><strong>Note:</strong><span> To see a list of supported regions and multi-regions, see
<a href="/dlp/docs/locations">Cloud DLP locations</a>.</span></aside>
<h2 data-text="About regions and multi-regions" id="about_regions_and_multi-regions">About regions and multi-regions</h2>
<p>A <em>region</em> is a specific geographic place, such as the western United States or
northeast Asia. A <em>multi-region location</em> (or just <em>multi-region</em>) is a large
geographic area, such as the European Union, that contains two or more
geographic regions.</p>
<h2 data-text="Location considerations" id="location_considerations">Location considerations</h2>
<p>A good location balances latency, availability, and bandwidth costs.</p>
<ul>
<li><p>Use a region to help optimize latency and network bandwidth.</p></li>
<li><p>Use a multi-region when you want to process data from outside of the Google
network and distributed across large geographic areas, or when you want the
higher availability that comes with being geo-redundant.</p></li>
<li><p>Generally, you should process your data in a location that is convenient or
contains the majority of the users of your data.</p></li>
</ul>
<h2 data-text="Specify a region" id="specify_a_region">Specify a region</h2>
<p>To specify a region in which Cloud DLP will process your request:</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><p>Choose a region when setting up your Cloud DLP operation.</p>
<p>For example, when <a href="/dlp/docs/creating-job-triggers">creating a job trigger</a>,
choose a location from the <strong>Resource location</strong> menu, as shown here:</p>
<figure id="resource-location">
<img alt="" class="screenshot" src="/dlp/docs/images/specifying-location-trigger.png" width="600"/>
</figure>
<p>If data residency is not a concern, use the <strong>Global</strong> region and Google chooses
the location where processing should take place. <strong>Global</strong> is the default
region choice.</p></section>
<section><h3 data-text="Protocol" id="protocol">Protocol</h3><p>Insert region information into the request endpoint URL. If data residency is
not a concern, use the <code dir="ltr" translate="no">global</code> region and Google chooses the location where
processing should take place. Note that any resources created by a request that
specifies the <code dir="ltr" translate="no">global</code> region are stored under the <code dir="ltr" translate="no">global</code> region.</p>
<p>Following are some example requests, sent first to the <code dir="ltr" translate="no">global</code> region, and then
to a region for the west coast of the United States.</p>
<p><strong>Global region request:</strong></p>
<p>The following two requests have the same effect. Not including a region is the
same as specifying <code dir="ltr" translate="no">locations/global/</code>.</p>
<pre dir="ltr" translate="no">POST https://www.googleapis.com/dlp/v2/projects/<var translate="no">PROJECT_ID</var>/locations/global/content:inspect</pre>
<pre dir="ltr" translate="no">POST https://www.googleapis.com/dlp/v2/projects/<var translate="no">PROJECT_ID</var>/content:inspect</pre>
<p><strong>Region-specific request:</strong></p>
<p>To specify a region for processing, within the resource URL, insert
<code dir="ltr" translate="no">locations/</code> and then the <a href="/dlp/docs/locations">region name</a>.</p>
<pre dir="ltr" translate="no">POST https://www.googleapis.com/dlp/v2/projects/<var translate="no">PROJECT_ID</var>/locations/us-west2/content:inspect</pre></section>
</div>
<h2 data-text="Co-location considerations" id="co-location_considerations">Co-location considerations</h2>
<p>When you scan a storage repository such as Cloud Storage or
BigQuery, you should specify the same location in your
Cloud DLP request as the location of the repository you're
scanning. For example, if the BigQuery dataset is in the European
Union multi-region location, specify the European Union multi-region (<code dir="ltr" translate="no">europe</code>)
when configuring the Cloud DLP job.</p>
<p>If you do not co-locate your Cloud DLP request with the storage
repository you're scanning, processing of your request may be split between the
location of the data and the location specified in the request.</p>
<aside class="note"><strong>Note:</strong><span> Cloud DLP templates, stored infoTypes, and Cloud KMS
keys can only be used by Cloud DLP jobs, job triggers, and the
<a href="/dlp/docs/concepts-method-types"><code dir="ltr" translate="no">content</code> methods</a> in the same region.</span></aside>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li>Learn more about <a href="/docs/geography-and-regions">geography and zones</a>.</li>
<li>See a list of <a href="/dlp/docs/locations">supported regions and multi-regions</a>.</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/supported-file-types]</H1></p><div class="devsite-article-body clearfix">
<h2 data-text="File types" id="file_types">File types</h2>
<table>
<tr>
<th>File type</th>
<th>File extensions</th>
<th>Limits</th>
<th>Scanning mode</th>
<th>Transformation support</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">Apache Avro</code></td>
<td><p>avro</p></td>
<td><a href="/dlp/limits#avro-limits">Avro limits</a></td>
<td>Structured Parsing</td>
<td></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Comma- or tab-separated values</code></td>
<td><p>csv, tsv</p></td>
<td></td>
<td>Structured Parsing</td>
<td>
<a href="/dlp/docs/examples-deid-tables">
        De-identify content</a>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">PDF</code></td>
<td><p>pdf</p></td>
<td><a href="/dlp/limits#pdf-word-limits">PDF limits</a></td>
<td>Intelligent Document Parsing</td>
<td></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Text</code></td>
<td><p>asc, brf, c, cc, cpp, cxx, c++, cs, css, dart, eml, go, h, hh,
     hpp, hxx, h++, hs, html, htm, shtml, shtm, xhtml, lhs, ini, java, js, json,
     ocaml, md, mkd, markdown, m, ml, mli, pl, pm, php, phtml, pht, py, pyw,
     rb, rbw, rs, rc, scala, sh, sql, tex, txt, text, vcard, vcs, wml,
     xml, xsl, xsd, yml, yaml.</p></td>
<td></td>
<td>Plain Text</td>
<td>
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify">
        De-identify content</a>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Microsoft Word</code></td>
<td><p>docx, dotx, docm, dotm</p></td>
<td><a href="/dlp/limits#pdf-word-limits">Word limits</a></td>
<td>Intelligent Document Parsing</td>
<td></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Microsoft Excel</code></td>
<td><p>xlsx, xlsm, xltx, xltm</p></td>
<td><a href="/dlp/limits#pdf-word-limits">Excel limits</a></td>
<td>Intelligent Document Parsing</td>
<td></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Microsoft Powerpoint</code></td>
<td><p>pptx, pptm, potx, potm</p></td>
<td><a href="/dlp/limits#pdf-word-limits">Powerpoint limits</a></td>
<td>Intelligent Document Parsing</td>
<td></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Image</code></td>
<td><p>bmp, gif, jpg, jpeg, jpe, png</p></td>
<td></td>
<td>OCR</td>
<td>
<a href="/dlp/docs/reference/rest/v2/projects.image/redact">
        Redaction</a>
</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">Binary</code></td>
<td><p><a href="/dlp/docs/supported-file-types#unsupported-file-types">
      Unsupported file types</a> and images that can't be scanned using optical
      character recognition (OCR).
      </p>
</td>
<td></td>
<td>Binary</td>
<td></td>
</tr>
</table>
<h2 data-text="Unsupported file types in Cloud Storage" id="unsupported-file-types">Unsupported file types in Cloud Storage</h2>
<p>If a file is not recognized during a
<a href="/dlp/docs/inspecting-storage">storage scan</a>, the system will, by default, scan
it as a binary file. It attempts to convert the content to UTF_8, and then scans
it as plain text.</p>
<p>If you have a collection of files you want to skip because Cloud DLP
doesn't support them, you can specify an exclusion list using
<a href="/dlp/docs/reference/rest/v2/InspectJobConfig#CloudStorageRegexFileSet"><code dir="ltr" translate="no">CloudStorageOptions.file_set.regex_file_set.exclude_regex</code></a>.</p>
<h2 data-text="Scanning modes" id="scanning_modes">Scanning modes</h2>
<p>Each scanning mode provides additional
<a href="https://cloud.google.com/dlp/docs/reference/rest/v2/InspectResult#Location">location details</a>
in <a href="https://cloud.google.com/dlp/docs/reference/rest/v2/InspectResult#Finding">inspection findings</a>.
<table>
<tr>
<th>Scanning mode</th>
<th>Notes</th>
<th>Additional location details to be provided</th>
</tr>
<tr>
<td>Binary</td>
<td><p>If a file fails to be parsed as any other type, it will be converted
      to UTF_8 and scanned as text. Binary scanning affects detection quality.
      </p></td>
<td></td>
</tr>
<tr>
<td>Intelligent document parsing</td>
<td><p>Documents are parsed with text extracted from formatting.
      Embedded images are scanned using OCR in
      <a href="/dlp/docs/locations#image-limitations">regions that support it
      </a>. Outside these regions, images are scanned as binary files.</p></td>
<td>
<a href="/dlp/docs/reference/rest/v2/InspectResult#DocumentLocation">
<code dir="ltr" translate="no">DocumentLocation</code></a></td>
</tr>
<tr>
<td>Metadata extraction</td>
<td><p>All files scanned from Cloud Storage will have
      <a href="/storage/docs/metadata"><code dir="ltr" translate="no">metadata</code></a> scanned in
      addition to the contents of the file.</p></td>
<td>
<a href="/dlp/docs/reference/rest/v2/InspectResult#MetadataLocation">
<code dir="ltr" translate="no">MetadataLocation</code></a></td>
</tr>
<tr>
<td>Optical character recognition (OCR)</td>
<td><p>Images are scanned using OCR in
      <a href="/dlp/docs/locations#image-limitations">regions that support it
      </a>. Outside these regions, images are scanned as binary files.</p></td>
<td>
<a href="/dlp/docs/reference/rest/v2/InspectResult#ImageLocation">
<code dir="ltr" translate="no">ImageLocation</code></a></td>
</tr>
<tr>
<td>Plain text</td>
<td><p></p></td>
<td>No additional details</td>
</tr>
<tr>
<td>Structured Parsing</td>
<td><p>
      Structural information is used to influence findings.
      Examples of structural information are the row the data was found in and
      the column name associated with a field. Findings, at this
      time, don't cross a table's cell boundaries.
    </p></td>
<td>
<a href="/dlp/docs/reference/rest/v2/InspectResult#RecordLocation">
<code dir="ltr" translate="no">RecordLocation</code></a></td>
</tr>
</table></p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-templates]</H1></p><div class="devsite-article-body clearfix">
<p>You can use <em>templates</em> to create and persist configuration information to use
with Cloud Data Loss Prevention. Templates are useful for decoupling configuration
information such as what you inspect for and how you de-identify it from the
implementation of your requests. Templates provide a robust
way to manage large scale rollouts of Cloud DLP capabilities.</p>
<p>Cloud DLP supports two types of templates:</p>
<ul>
<li><a href="/dlp/docs/creating-templates"><em>Inspection templates</em></a>: Templates for saving
configuration information for inspection scan jobs, including what
predefined or custom detectors to use.</li>
<li><a href="/dlp/docs/creating-templates-deid"><em>De-identification templates</em></a>: Templates for
saving configuration information for de-identification jobs, including both
infoType and structured dataset transformations.</li>
</ul>
<h2 data-text="Advantages of templates" id="advantages_of_templates">Advantages of templates</h2>
<p>Templates enable you to use a single source for your job configuration
information. Consider a typical inspection scan request to
Cloud DLP. Whether you're inspecting text, an image, or
structured data in a Google Cloud storage repository, your inspection request
will include two basic pieces of information:</p>
<ul>
<li>The data to scan: Either the data itself or information about the
location of the data.</li>
<li>What to scan for: The predefined or custom infoTypes to turn on, likelihood
limits, and so on.</li>
</ul>
<p>Say you scheduled several storage inspection jobs to run, all of which scanned a
Google Cloud storage repository for phone numbers and then created a
report of the findings. The following are conceptual summary descriptions of
these jobs. Note that <code dir="ltr" translate="no">"inspectJob"</code> represents the data to scan, and
<code dir="ltr" translate="no">"inspectConfig"</code> represents what to scan for.</p>
<blockquote>
<p>
<strong>Inspection job #1:</strong>
<ul>
<li><code dir="ltr" translate="no">"inspectJob"</code>: <em>Q2 2017 marketing database.</em></li>
<li><code dir="ltr" translate="no">"inspectConfig"</code>: <em>PHONE_NUMBER infoType.</em></li>
</ul>
</p>
<p>
<strong>Inspection job #2:</strong>
<ul>
<li><code dir="ltr" translate="no">"inspectJob"</code>: <em>Customer alert contact
      database.</em></li>
<li><code dir="ltr" translate="no">"inspectConfig"</code>: <em>PHONE_NUMBER infoType.</em></li>
</ul>
</p>
<p>
<strong>Inspection job #3:</strong>
<ul>
<li><code dir="ltr" translate="no">"inspectJob"</code>: <em>Top secret VIP partner strategy
      database.</em></li>
<li><code dir="ltr" translate="no">"inspectConfig"</code>: <em>PHONE_NUMBER infoType.</em></li>
</ul>
</p>
<p>
<strong>Inspection job #4:</strong>
<ul>
<li><code dir="ltr" translate="no">"inspectJob"</code>: <em>Government contract database.</em></li>
<li><code dir="ltr" translate="no">"inspectConfig"</code>: <em>PHONE_NUMBER infoType.</em></li>
</ul>
</p>
</blockquote>
<p>Each job's data source is different, but its instructions for what to scan for
is identical. Now suppose that we want to also scan for email addresses. In this
case, you would have to edit each job's configuration and add email addresses to
<code dir="ltr" translate="no">"inspectConfig"</code>. If instead you had used a template to configure what to scan
for, you would only have to edit one configurationâthat of the template. The
next time any of these jobs ran, it would know to scan for both phone numbers
and email addresses, because the <code dir="ltr" translate="no">"inspectConfig"</code> had been set to a template.</p>
<h2 data-text="The InspectTemplate and DeidentifyTemplate objects" id="the_inspecttemplate_and_deidentifytemplate_objects">The InspectTemplate and DeidentifyTemplate objects</h2>
<p>Templates are represented in Cloud DLP by the
<a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates"><code dir="ltr" translate="no">InspectTemplate</code></a>
and
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates"><code dir="ltr" translate="no">DeidentifyTemplate</code></a>
objects. Both template objects contain a configurationâa set of infoType
detectorsâto be used anywhere you otherwise would normally specify the <a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a> or
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>
objects.</p>
<h3 data-text="Template configuration fields" id="template_configuration_fields">Template configuration fields</h3>
<p>Each template object contains the configuration object that the template
implements, plus several additional configuration fields:</p>
<ul>
<li>The template's name and display name, and a description.</li>
<li>The
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">InspectConfig</code></a> or
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>
object: The configuration information for the inspection or
de-identification job.</li>
<li>Read-only timestamps for creation time (<code dir="ltr" translate="no">"createTime"</code>) and a last
updated time (<code dir="ltr" translate="no">"updateTime"</code>).</li>
</ul>
<h3 data-text="Template methods" id="template_methods">Template methods</h3>
<p>Each template object also includes several built-in management methods.
These enable you to maintain the template without having to update every request
or integration. Each management method is linked in the following table,
and is organized by whether the template applies organization-wide
or project-wide, and whether the template is a de-identification template or an
inspection template:</p>
<p><table>
<colgroup>
<col width="*"/>
<col width="*"/>
<col width="*"/>
<col width="*"/>
<col width="*"/>
</colgroup>
<tr>
<td rowspan="2"><br/>
</td>
<th colspan="2"><code dir="ltr" translate="no">organization.</code></th>
<th colspan="2"><code dir="ltr" translate="no">project.</code></th>
</tr>
<tr>
<th><code dir="ltr" translate="no">deidentify<br/>Templates.</code></th>
<th><code dir="ltr" translate="no">inspect<br/>Templates.</code></th>
<th><code dir="ltr" translate="no">deidentify<br/>Templates.</code></th>
<th><code dir="ltr" translate="no">inspect<br/>Templates.</code></th>
</tr>
<tr>
<td>Create a new template</td>
<td><code dir="ltr" translate="no"><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates/create">create</a></code></td>
<td><code dir="ltr" translate="no"><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/create">create</a></code></td>
<td><code dir="ltr" translate="no"><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/create">create</a></code></td>
<td><code dir="ltr" translate="no"><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/create">create</a></code></td>
</tr>
<tr>
<td>Update an existing template</td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates/patch"><code dir="ltr" translate="no">patch</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/patch"><code dir="ltr" translate="no">patch</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/patch"><code dir="ltr" translate="no">patch</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/patch"><code dir="ltr" translate="no">patch</code></a></td>
</tr>
<tr>
<td>Delete an existing template</td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates/delete"><code dir="ltr" translate="no">delete</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/delete"><code dir="ltr" translate="no">delete</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/delete"><code dir="ltr" translate="no">delete</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/delete"><code dir="ltr" translate="no">delete</code></a></td>
</tr>
<tr>
<td>Retrieve an existing template, including its configuration and status</td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates/get"><code dir="ltr" translate="no">get</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/get"><code dir="ltr" translate="no">get</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/get"><code dir="ltr" translate="no">get</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/get"><code dir="ltr" translate="no">get</code></a></td>
</tr>
<tr>
<td>List all existing job templates</td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates/list"><code dir="ltr" translate="no">list</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/organizations.inspectTemplates/list"><code dir="ltr" translate="no">list</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.deidentifyTemplates/list"><code dir="ltr" translate="no">list</code></a></td>
<td><a href="/dlp/docs/reference/rest/v2/projects.inspectTemplates/list"><code dir="ltr" translate="no">list</code></a></td>
</tr>
</table></p>
<h2 data-text="Using templates" id="using_templates">Using templates</h2>
<p>Templates are available for both inspection and de-identification configuration
information, and can be used in both content API calls (text and images)
Cloud DLP jobs (storage repositories).</p>
<p>Templates have powerful Identity and Access Management (IAM) controls so you can
restrict management of them to only approved users. For more information, see:</p>
<ul>
<li><a href="/dlp/docs/iam-roles">DLP IAM roles</a></li>
<li><a href="/dlp/docs/iam-permissions">DLP IAM permissions</a></li>
</ul>
<h2 data-text="Resources" id="resources">Resources</h2>
<p>To learn how to create and use templates with Cloud DLP, see:</p>
<ul>
<li><a href="/dlp/docs/creating-templates">Creating Cloud DLP inspection
templates</a></li>
<li><a href="/dlp/docs/creating-templates-deid">Creating Cloud DLP de-identification
templates</a></li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//architecture/de-identification-re-identification-pii-using-cloud-dlp]</H1></p><div class="devsite-article-body clearfix">
<p>This document discusses how to use Cloud Data Loss Prevention (Cloud DLP) to create
an automated data transformation pipeline to de-identify sensitive data like
personally identifiable information (PII). De-identification techniques like
tokenization (pseudonymization) let you preserve the utility of your data for
joining or analytics while reducing the risk of handling the data by obfuscating
the raw sensitive identifiers. To minimize the risk of handling large volumes of
sensitive data, you can use an automated data transformation pipeline to create
de-identified replicas.
<a href="/dlp/docs" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud DLP </a> 
enables transformations such as redaction, masking, tokenization, bucketing,
and other methods of
<a href="/dlp/docs/transformations-reference" track-metadata-position="body" track-name="internalLink" track-type="solution">de-identification</a>.
When a dataset hasn't been characterized,
Cloud DLP can also inspect the data for sensitive information by using
<a href="/dlp/docs/infotypes-reference" track-metadata-position="body" track-name="internalLink" track-type="solution">more than 100 built-in classifiers</a>.</p>
<p>This document is intended for a technical audience whose responsibilities
include data security, data processing, or data analytics. This guide assumes
that you're familiar with data processing and data privacy, without the need to
be an expert.</p>
<p>This document is part of a series:</p>
<ul>
<li>De-identification and re-identification of PII in large-scale datasets
using Cloud DLP (this document)</li>
<li><a href="/solutions/creating-cloud-dlp-de-identification-transformation-templates-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Creating DLP de-identification transformation templates for PII datasets</a> </li>
<li><a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Running an automated Dataflow pipeline to de-identify a PII dataset</a> </li>
<li><a href="/solutions/validating-de-identified-data-bigquery-re-identifying-pii-data" track-metadata-position="body" track-name="internalLink" track-type="solution">Validating de-identified data in BigQuery and re-identifying PII data</a> </li>
</ul>
<h2 data-text="Reference architecture" id="reference_architecture">Reference architecture</h2>
<p>The following diagram shows a reference architecture for using
Google Cloud products to add a layer of security to sensitive datasets by using
de-identification techniques.</p>
<p><img alt="Architecture of de-identification pipeline, configuration management, and re-identification pipeline." src="/architecture/images/de-identification-re-identification-pii-using-cloud-dlp-1-architecture.svg"/></p>
<p>The architecture consists of the following:</p>
<ul>
<li><p><strong>Data de-identification streaming pipeline</strong>: De-identifies sensitive
data in text using Dataflow. You can reuse the
pipeline for multiple transformations and use cases.</p></li>
<li><p><strong>Configuration (DLP template and key) management</strong>: A managed
de-identification configuration that is accessible by only a small group of
peopleâfor example, security adminsâto avoid exposing de-identification
methods and encryption keys.</p></li>
<li><p><strong>Data validation and re-identification pipeline</strong>: Validates copies of
the de-identified data and uses a Dataflow pipeline to
re-identify data at a large scale.</p></li>
</ul>
<h2 data-text="Helping to secure sensitive data" id="helping_to_secure_sensitive_data">Helping to secure sensitive data</h2>
<p>One of the key tasks of any enterprise is to help ensure the security of their
users' and employees' data. Google Cloud provides built-in security
measures to facilitate data security, including encryption of stored data and
encryption of data in transit.</p>
<h3 data-text="Encryption at rest: Cloud Storage" id="encryption_at_rest_cloud_storage">Encryption at rest: Cloud Storage</h3>
<p>Maintaining data security is critical for most organizations. Unauthorized
access to even moderately sensitive data can damage the trust, relationships,
and reputation that you have with your customers. Google
<a href="/security/encryption/default-encryption" track-metadata-position="body" track-name="internalLink" track-type="solution">encrypts data stored at rest</a> 
by default. By default, any object uploaded to a
<a href="/storage/docs" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud Storage</a> 
bucket is encrypted using a
<a href="/storage/docs/encryption/default-keys" track-metadata-position="body" track-name="internalLink" track-type="solution">Google-managed encryption key</a>.
If your dataset uses a pre-existing encryption method and requires a non-default
option before uploading, there are other encryption options provided by
Cloud Storage. For more information, see
<a href="/storage/docs/encryption" track-metadata-position="body" track-name="internalLink" track-type="solution">Data encryption options</a>.</p>
<h3 data-text="Encryption in transit: Dataflow" id="encryption_in_transit_cloud_dataflow">Encryption in transit: Dataflow</h3>
<p>When your data is in transit, the <em>at-rest</em> encryption isn't in place.
In-transit data is protected by secure network protocols referred to as
<a href="/security/encryption-in-transit/resources/encryption-in-transit-whitepaper.pdf" track-metadata-position="body" track-name="internalLink" track-type="solution"><em>encryption in transit</em></a>.
By default, Dataflow uses Google-managed encryption keys. The
tutorials associated with this document use an automated pipeline that uses the
default Google-managed encryption keys.</p>
<h2 data-text="Cloud DLP data transformations" id="cloud_dlp_data_transformations">Cloud DLP data transformations</h2>
<p>There are two main types of transformations performed by Cloud DLP:</p>
<ul>
<li><a href="/dlp/docs/deidentify-sensitive-data#record_transformations" track-metadata-position="body" track-name="internalLink" track-type="solution"><code dir="ltr" translate="no">recordTransformations</code></a> </li>
<li><a href="/dlp/docs/deidentify-sensitive-data#infotype_transformations" track-metadata-position="body" track-name="internalLink" track-type="solution"><code dir="ltr" translate="no">infoTypeTransformations</code></a> </li>
</ul>
<p>Both <code dir="ltr" translate="no">recordTransformations</code> and <code dir="ltr" translate="no">infoTypeTransformations</code> methods can
de-identify and encrypt sensitive information in your data. For example, you can
transform the values in the <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> column to be
unidentifiable or use tokenization to obscure it while keeping referential
integrity.</p>
<p>The <code dir="ltr" translate="no">infoTypeTransformations</code> method enables you to inspect for sensitive data
and transform the finding. For example, if you have unstructured or free-text
data, the <code dir="ltr" translate="no">infoTypeTransformations</code> method can help you identify a SSN inside of
a sentence and encrypt the SSN value while leaving the rest of the text intact.
You can also define custom <code dir="ltr" translate="no">infoTypes</code> methods.</p>
<p>The <code dir="ltr" translate="no">recordTransformations</code> method enables you to apply a transformation
configuration per field when using structured or tabular data. With the <code dir="ltr" translate="no">recordTransformations</code> method, you
can apply the same transformation across every value in that field such as
hashing or tokenizing every value in a column with <code dir="ltr" translate="no">SSN</code> column as the field or
header name.</p>
<p>With the <code dir="ltr" translate="no">recordTransformations</code> method , you can also mix in the
<code dir="ltr" translate="no">infoTypeTransformations</code> method that only apply to the values in the specified
fields. For example, you can use an <code dir="ltr" translate="no">infoTypeTransformations</code> method inside of a <code dir="ltr" translate="no">recordTransformations</code> method for the field named
<code dir="ltr" translate="no">comments</code> to redact any findings for <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> that are found
inside the text in the field.</p>
<p>In increasing order of complexity, the de-identification
processes are as follows:</p>
<ul>
<li><strong>Redaction</strong>: Remove the sensitive content with no replacement of content.</li>
<li><strong>Masking</strong>: Replace the sensitive content with fixed characters.</li>
<li><strong>Encryption</strong>: Replace sensitive content with encrypted strings, possibly
reversibly.</li>
</ul>
<h3 data-text="Working with delimited data" id="working_with_delimited_data">Working with delimited data</h3>
<p>Often, data consists of records delimited by a selected character, with fixed
types in each column, like a CSV file. For this class of data, you can apply
de-identification transformations (<code dir="ltr" translate="no">recordTransformations</code>) directly, without
inspecting the data. For example, you can expect a column labeled <code dir="ltr" translate="no">SSN</code> to
contain only SSN data. You don't need to inspect the data to know that the
<code dir="ltr" translate="no">infoType</code> detector is <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code>. However, free-form
columns labeled <code dir="ltr" translate="no">Additional Details</code> can contain sensitive information, but the
<code dir="ltr" translate="no">infoType</code> class is unknown beforehand. For a free-form column, you need to
inspect the <code dir="ltr" translate="no">infoTypes</code> detector (<code dir="ltr" translate="no">infoTypeTransformations</code>) before applying
de-identification transformations. Cloud DLP allows both of these
transformation types to co-exist in a single de-identification template.
Cloud DLP includes
<a href="/dlp/docs/infotypes-reference" track-metadata-position="body" track-name="internalLink" track-type="solution">more than 100 built-in <code dir="ltr" translate="no">infoTypes</code> detectors</a>.
You can also create custom types or modify built-in <code dir="ltr" translate="no">infoTypes</code> detectors to
find sensitive data that is unique to your organization.</p>
<h3 data-text="Determining transformation type" id="determining_transformation_type">Determining transformation type</h3>
<p>Determining when to use the <code dir="ltr" translate="no">recordTransformations</code> or <code dir="ltr" translate="no">infoTypeTransformations</code>
method depends on your use case. Because using the <code dir="ltr" translate="no">infoTypeTransformations</code>
method requires more resources and is therefore more costly,  we recommend using
this method only for situations where the data type is unknown. You can evaluate
the costs of running Cloud DLP using the
<a href="/products/calculator" track-metadata-position="body" track-name="pricingCalculator" track-type="solution">Google Cloud pricing calculator</a>.</p>
<p>To provide examples of transformation, this document has several associated
tutorials that use a dataset. The dataset contains CSV files with fixed columns,
as demonstrated in the following table.</p>
<table>
<thead>
<tr>
<th>
Column name
</th>
<th>Inspection <code dir="ltr" translate="no">infoType</code> (custom or built-in)</th>
<th>DLP transformation type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">
Card Number
</code>
</td>
<td>Not applicable</td>
<td>Deterministic encryption (DE)</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Card Holder's Name
</code>
</td>
<td>Not applicable</td>
<td>Deterministic encryption (DE)</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Card PIN
</code>
</td>
<td>Not applicable</td>
<td>Crypto hashing</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
SSN (Social Security Number)
</code>
</td>
<td>Not applicable</td>
<td>Masking</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Age
</code>
</td>
<td>Not applicable</td>
<td>Bucketing</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Job Title
</code>
</td>
<td>Not applicable</td>
<td>Bucketing</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Additional Details
</code>
</td>
<td>Built-in:<br/>
<code dir="ltr" translate="no">IBAN_CODE</code>, <code dir="ltr" translate="no">EMAIL_ADDRESS</code>,
<code dir="ltr" translate="no">PHONE_NUMBER
</code>
<br/>
Custom:<br/>
<code dir="ltr" translate="no">
ONLINE_USER_ID
</code>
</td>
<td>Replacement</td>
</tr>
</tbody>
</table>
<p>This table lists the column names and describes which type of transformation is
needed for each column. For example, the <code dir="ltr" translate="no">Card Number</code> column contains credit
card numbers that need to be encrypted; however, they don't need to be
inspected, because the data type (<code dir="ltr" translate="no">infoType</code>) is known.</p>
<p>The only column where an inspection transformation is recommended is the
<code dir="ltr" translate="no">Additional Details</code> column. This column is free-form and might contain PII,
which, for the purposes of this series, should be detected and de-identified.</p>
<p>The examples in this table present five different de-identification
transformations:</p>
<ul>
<li><p>Two-way tokenization: Replaces the original data with a token that is
deterministic, preserving referential integrity.  You can use the token to
join data or use the token in aggregate analysis. You can reverse or
de-tokenize the data using the same key that you used to create the token.
There are two methods for two-way tokenizations:</p>
<ul>
<li><a href="/dlp/docs/transformations-reference#fpe" track-metadata-position="body" track-name="internalLink" track-type="solution"><strong>Deterministic encryption (DE)</strong></a>:
Replaces the original data with a base64-encoded encrypted value and
doesn't preserve the original character set or length.</li>
<li><a href="/dlp/docs/transformations-reference#fpe" track-metadata-position="body" track-name="internalLink" track-type="solution"><strong>Format-preserving encryption with FFX (FPE-FFX)</strong></a>:
Replaces the original data with a token generated by using
format-preserving encryption in FFX mode. By design, FPE-FFX preserves
the length and character set of the input text. It lacks authentication
and an initialization vector, which can cause a length expansion in the
output token. Other methods, like
DE, provide stronger security guarantees and are
recommended for tokenization use cases unless length and character-set
preservation are strict requirements, such as backward compatibility
with legacy data systems.</li>
</ul></li>
<li><p>One-way tokenization, using
<a href="/dlp/docs/transformations-reference#crypto-hashing" track-metadata-position="body" track-name="internalLink" track-type="solution"><strong>cryptographic hashing</strong></a>:
Replaces the original value with a hashed value, preserving referential
integrity.  However, unlike two-way tokenization, a one-way method isn't
reversible. The hash value is
generated by using an SHA-256-based message authentication code
(<a class="external" href="https://tools.ietf.org/html/rfc4634" target="external" track-metadata-position="body" track-name="externalLink" track-type="solution">HMAC-SHA-256</a>)
on the input value.</p></li>
<li><p><a href="/dlp/docs/transformations-reference#masking" track-metadata-position="body" track-name="internalLink" track-type="solution"><strong>Masking</strong></a>:
Replaces the original data with a specified character, either partially
or completely.</p></li>
<li><p><a href="/dlp/docs/transformations-reference#bucketing" track-metadata-position="body" track-name="internalLink" track-type="solution"><strong>Bucketing</strong></a>:
Replaces a more identifiable value with a less distinguishing value.</p></li>
<li><p><a href="/dlp/docs/transformations-reference#replacement" track-metadata-position="body" track-name="internalLink" track-type="solution"><strong>Replacement</strong></a>:
Replaces original data with a token or the name of the <code dir="ltr" translate="no">infoType</code> if
detected.</p></li>
</ul>
<h3 data-text="Method selection" id="method_selection">Method selection</h3>
<p>Choosing the best de-identification method can vary based on your use case. For
example, if a legacy app is processing the de-identified records, then format
preservation might be important.  If you're dealing with strictly formatted
10-digit numbers, FPE preserves the length (10 digits) and character set
(numeric) of an input for legacy system support.</p>
<p>However, if strict formatting isn't required for legacy compatibility, as is
the case for values in the <code dir="ltr" translate="no">Card Holder's Name</code> column, then DE is the
preferred choice because it
has a stronger authentication method. Both FPE and DE enable the tokens to be
reversed or de-tokenized. If you don't need de-tokenization, then cryptographic
hashing provides integrity but the tokens can't be reversed.</p>
<p>Other methodsâlike masking,
<a href="/dlp/docs/concepts-bucketing" track-metadata-position="body" track-name="internalLink" track-type="solution">bucketing</a>,
<a href="/dlp/docs/concepts-date-shifting" track-metadata-position="body" track-name="internalLink" track-type="solution">date-shifting</a>,
and replacementâare good for values that don't need to retain full integrity.
For example, bucketing an age value (for example, 27) to an age range (20-30)
can still be analyzed while reducing the uniqueness that might lead to the
identification of an individual.</p>
<h2 data-text="Token encryption keys" id="token_encryption_keys">Token encryption keys</h2>
<p>For cryptographic de-identification transformations, a cryptographic key,
also known as <em>token encryption key</em>, is required. The token encryption key
that is used for de-identification encryption is also used to re-identify the
original value. The secure creation and management of token encryption keys are
beyond the scope of this document. However, there are some important principles
to consider that are used later in the associated tutorials:</p>
<ul>
<li>Avoid using plaintext keys in the template. Instead, use
Cloud KMS to create a <a href="/kms/docs/key-wrapping" track-metadata-position="body" track-name="internalLink" track-type="solution">wrapped key</a>.</li>
<li>Use separate token encryption keys for each data element to reduce the
risk of compromising keys.</li>
<li><a href="/kms/docs/key-rotation" track-metadata-position="body" track-name="internalLink" track-type="solution">Rotate</a> 
token encryption keys. Although you can rotate the wrapped key, rotating the
token encryption key breaks the integrity of the tokenization. When the key
is rotated, you need to re-tokenize  the entire dataset.</li>
</ul>
<h3 data-text="Cloud DLP templates" id="cloud_dlp_templates">Cloud DLP templates</h3>
<p>For large-scale deployments,  use
<a href="/dlp/docs/concepts-templates#advantages_of_templates" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud DLP templates</a> 
to accomplish the following:</p>
<ul>
<li>Enable security control with
<a href="/dlp/docs/iam-permissions" track-metadata-position="body" track-name="internalLink" track-type="solution">Identity and Access Management (IAM)</a>.</li>
<li>Decouple configuration information, and how you de-identify that
information, from the implementation of your requests.</li>
<li>Reuse a set of transformations. You can use the de-identify and
re-identify templates over multiple datasets.</li>
</ul>
<p>The associated tutorials take you through the process to create and manage
Cloud DLP templates.</p>
<h2 data-text="BigQuery" id="bigquery">BigQuery</h2>
<p>The final component of the reference architecture is viewing and working with
the de-identified data in
<a href="/bigquery/docs" track-metadata-position="body" track-name="internalLink" track-type="solution">BigQuery</a>.
 BigQuery is Google's data warehouse tool that includes
serverless infrastructure, BigQuery ML, and the ability to run
Cloud DLP as a native tool. In the following tutorials,
BigQuery serves as a data warehouse for the de-identified data
and as a backend to an automated re-identification data pipeline that can share
data through
<a href="/pubsub/docs" track-metadata-position="body" track-name="internalLink" track-type="solution">Pub/Sub</a>.</p>
<p>To learn more about advanced applications of BigQuery ML and
sensitive data, see
<a href="/solutions/sensitive-data-and-ml-datasets" track-metadata-position="body" track-name="internalLink" track-type="solution">Considerations for sensitive data within machine learning datasets</a>.</p>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<ul>
<li><a href="/solutions/creating-cloud-dlp-de-identification-transformation-templates-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Creating Cloud DLP de-identification transformation templates for PII datasets</a>.</li>
<li><a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Running an automated Dataflow pipeline to de-identify a PII dataset</a>.</li>
<li><a href="/solutions/validating-de-identified-data-bigquery-re-identifying-pii-data" track-metadata-position="body" track-name="internalLink" track-type="solution">Validating de-identified data in BigQuery and re-identifying PII data</a>.</li>
<li>Review the sample code in the <a class="external" href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification" track-metadata-end-goal="seeExample" track-metadata-position="body" track-name="gitHubLink" track-type="tutorial">Migrate Sensitive Data in BigQuery Using Dataflow &amp; Cloud DLP</a> 
repo on GitHub.</li>
<li>Learn about other <a href="/solutions/smart-analytics/reference-patterns/overview#pattern_recognition">pattern recognition solutions</a>.</li>
<li>

Explore reference architectures, diagrams, tutorials, and best practices about Google Cloud.
Take a look at our
<a href="/architecture" track-metadata-position="nextSteps" track-name="textLink" track-type="tutorial">Cloud Architecture Center</a>.

</li>
</ul>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//solutions/creating-cloud-dlp-de-identification-transformation-templates-pii-dataset]</H1></p><div class="devsite-article-body clearfix">
<div class="tutorial tutorial-lesson">
<section id="overview">
<p>This tutorial shows you how to create and manage
<a href="/dlp/docs/creating-templates-deid" track-metadata-position="body" track-name="internalLink" track-type="solution">de-identification transformations</a> 
for large-scale
<a class="external" href="https://wikipedia.org/wiki/Personal_data" target="external" track-metadata-position="body" track-name="externalLink" track-type="solution"><em>personally identifiable information (PII)</em></a> 
datasets using Cloud Data Loss Prevention (Cloud DLP) templates. This tutorial also
offers guidance on how to select the appropriate transformations for your use
case.</p>
<p>This document is part of a series:</p>
<ul>
<li><a href="/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-position="body" track-name="internalLink" track-type="solution">De-identification and re-identification of PII in large-scale datasets using Cloud DLP</a> </li>
<li>Creating DLP de-identification transformation templates for PII datasets
(this document)</li>
<li><a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Running an automated Dataflow pipeline to de-identify a PII dataset</a> </li>
<li><a href="/solutions/validating-de-identified-data-bigquery-re-identifying-pii-data" track-metadata-position="body" track-name="internalLink" track-type="solution">Validating de-identified data in BigQuery and re-identifying PII data</a> </li>
</ul>
<p>This tutorial assumes that you have basic shell scripting knowledge and is
intended for enterprise security admins.</p>
<h2 data-text="Reference architecture" id="reference_architecture">Reference architecture</h2>
<p>This tutorial demonstrates the configuration (DLP template and key) management
section that is illustrated in the following diagram.</p>
<p><img alt="Architecture of de-identification configuration." src="/architecture/images/creating-cloud-dlp-de-identification-transformation-templates-pii-dataset-1-create-templates.svg"/></p>
<p>This architecture consists of a managed de-identification
configuration that is accessible by only a small group of peopleâfor example,
security adminsâto avoid exposing de-identification methods and encryption
keys.</p>
</section>
<section id="objectives">
<h2 data-text="Objectives" id="objectives">Objectives</h2>
<ul>
<li>Design a Cloud DLP transformation for a sample dataset.</li>
<li>Create Cloud DLP templates to store the transformation
configuration.</li>
</ul>
</section>
<section id="costs">
<h2 data-text="Costs" id="costs">Costs</h2>
<p>
  

  This tutorial uses the following billable components of Google Cloud:
  
    </p>
<ul>
<li><a href="/bigquery/pricing" track-metadata-position="body" track-name="internalLink" track-type="solution">BigQuery</a></li>
<li><a href="/storage/pricing" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud Storage</a></li>
<li><a href="/dataflow/pricing" rack-type="solution" track-metadata-position="body" track-name="internalLink">Dataflow</a></li>
<li><a href="/dlp/pricing" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud DLP</a></li>
<li><a href="/kms/pricing" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud Key Management Service</a></li>
<li><a href="/build/pricing" track-metadata-position="body" track-name="internalLink" track-type="solution">Cloud Build</a></li>
<li><a href="/pubsub/pricing" track-metadata-position="body" track-name="internalLink" track-type="solution">Pub/Sub</a></li>
</ul>
<p>
  

  
  To generate a cost estimate based on your projected usage,
      use the <a href="/products/calculator" track-name="pricingCalculator" track-type="commonIncludes">pricing calculator</a>.
  <cloudx-free-trial-eligible-content>
<slot slot="eligible">
      New Google Cloud users might be eligible for a <a href="/free-trial" target="_blank" track-metadata-end-goal="signUp" track-metadata-position="prerequisites" track-name="consoleLink" track-type="freeTrial">free trial</a>.
    </slot>
<slot slot="ineligible">
</slot>
</cloudx-free-trial-eligible-content>
</p>
<p>When you finish this tutorial, you can avoid continued billing by deleting the resources you
  created. For more information, see
<a href="#clean-up" track-metadata-position="body" track-name="internalLink" track-type="tutorial">Clean up</a>.</p>
</section>
<section id="prerequisites">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
<li>
<p>In the Cloud console, activate Cloud Shell.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/?cloudshell=true" target="console" track-metadata-end-goal="launchCloudShell" track-name="consoleLink" track-type="commonIncludes">Activate Cloud Shell</a></p>
<p>
      At the bottom of the Cloud console, a
      <a href="/shell/docs/features">Cloud Shell</a>
      session starts and displays a command-line prompt. Cloud Shell is a shell environment
      with the Google Cloud CLI
      already installed and with values already set for
      your current project. It can take a few seconds for the session to initialize.
    </p>
</li>
    
  


  

You run all commands in this tutorial from Cloud Shell.

<li>In Cloud Shell, enable the Cloud DLP, Cloud Key Management Service,
  BigQuery, Cloud Storage,
  Dataflow, and Cloud Build APIs.

<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud services enable dlp.googleapis.com
gcloud services enable cloudkms.googleapis.com
gcloud services enable bigquery.googleapis.com
gcloud services enable storage-component.googleapis.com
gcloud services enable dataflow.googleapis.com
gcloud services enable cloudbuild.googleapis.com
</pre>
</li>
</ol>
</section>
<div id="tutorial-content">
<section class="tutorial-content">
<h2 data-text="Creating Cloud Storage buckets" id="creating_cloud_storage_buckets">Creating Cloud Storage buckets</h2>
<p>In this series, you need two Cloud Storage buckets. The first bucket
stores the sample dataset and the second bucket stores temporary data for the
automated pipeline used in the next part in this series
(<a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Running an automated Dataflow pipeline to de-identify a PII dataset</a>).</p>
<ol>
<li><p>In Cloud Shell, create two Cloud Storage buckets
(Replace <code dir="ltr" translate="no"><var translate="no">REGION</var></code> with the <a href="/dataflow/docs/concepts/regional-endpoints" track-metadata-position="body" track-name="internalLink" track-type="solution">Dataflow region</a>)
of your choosing, for example <code dir="ltr" translate="no">us-central1</code>):</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
export REGION=<var translate="no">REGION</var>
export PROJECT_ID=$(gcloud config get-value project)
export DATA_STORAGE_BUCKET=${PROJECT_ID}-<var translate="no">data-storage-bucket</var>
export DATAFLOW_TEMP_BUCKET=${PROJECT_ID}-<var translate="no">dataflow-temp-bucket</var>
gsutil mb -c standard -l ${REGION} gs://${DATA_STORAGE_BUCKET}
gsutil mb -c standard -l ${REGION} gs://${DATAFLOW_TEMP_BUCKET}
</pre></li>
</ol>
<h2 data-text="Downloading the sample files" id="downloading_the_sample_files">Downloading the sample files</h2>
<p>You download the sample files to identify the columns that are required for
de-identification transformations.</p>
<ol>
<li><p>In Cloud Shell, download the sample dataset and scripts used
in this tutorial to your local machine:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
curl -X GET \
    -o "sample_data_scripts.tar.gz" \
    "http://storage.googleapis.com/dataflow-dlp-solution-sample-data/sample_data_scripts.tar.gz"
</pre></li>
<li><p>Decompress and unpack the contents of the file:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
tar -zxvf sample_data_scripts.tar.gz
</pre></li>
<li><p>To validate the transfer, confirm that the output matches the list
of the following files downloaded:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
wc -l solution-test/CCRecords_1564602825.csv
</pre>
<p>The output is the following:</p>
<pre class="console" dir="ltr" translate="no">
100001 solution-test/CCRecords_1564602825.csv
</pre></li>
<li><p>To identify which columns might require DLP de-identification, examine
the header record in the CSV file:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
head -1 solution-test/CCRecords_1564602825.csv
</pre>
<p>The output is:</p>
<pre class="console" dir="ltr" translate="no">
ID,Card Type Code,Card Type Full Name,Issuing Bank,Card Number,Card Holder's Name,Issue Date,Expiry Date,Billing Date,Card PIN,Credit Limit,Age,SSN,JobTitle,Additional Details
</pre>
<p>The first line of each CSV file defines the data schema and column names.
The extracted dataset contains direct identifiers (<code dir="ltr" translate="no">SSN</code> and
<code dir="ltr" translate="no">Card Holder's Name</code>) and <a href="/blog/products/identity-security/taking-charge-of-your-data-understanding-re-identification-risk-and-quasi-identifiers-with-cloud-dlp" track-metadata-position="body" track-name="internalLink" track-type="solution">quasi-identifiers</a> 
(<code dir="ltr" translate="no">Age</code> and <code dir="ltr" translate="no">JobTitle</code>).</p></li>
</ol>
<p>The process to determine the transformations required varies based on your
use case. For the sample dataset used in this tutorial, a list of
transformations is summarized in the following table.</p>
<table>
<thead>
<tr>
<th>Column name</th>
<th><code dir="ltr" translate="no">InfoType</code> (custom or built-In)</th>
<th>Type of Cloud DLP transformation</th>
<th>Description of transformation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">
Card PIN
</code>
</td>
<td>
N/A
</td>
<td>Encrypting using <a href="/dlp/docs/transformations-reference#crypto-hashing">cryptographic
hashing</a></td>
<td>Cryptograpic hashing encryption replaces the original data with a base64-encoded
value that can't be reversed.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Card Number
</code>
</td>
<td>
N/A

</td>
<td>Encrypting using <a href="/dlp/docs/transformations-reference#de">deterministic
encryption (DE)</a></td>
<td>DE replaces the original data with a base64-encoded encrypted value and
doesn't preserve the original character set or length.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Card Holder's Name
</code>
</td>
<td>
N/A

</td>
<td>Encrypting using <a href="/dlp/docs/transformations-reference#de">deterministic
encryption (DE)</a></td>
<td>DE replaces the original data with a base64-encoded encrypted value and
doesn't preserve the original character set or length.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
SSN (Social Security Number)
</code>
</td>
<td>
N/A

</td>
<td><a href="/dlp/docs/transformations-reference#masking">Masking
character</a></td>
<td>Masking is a non-cryptographic technique that you can use to mask
partial or complete original data with a character specified.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Age
</code>
</td>
<td>
N/A

</td>
<td><a href="/dlp/docs/transformations-reference#bucketing">Bucketing</a>
with a general value</td>
<td>Bucketing transformation helps to replace an identifiable value with a
general value.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Job Title
</code>
</td>
<td>
N/A

</td>
<td><a href="/dlp/docs/transformations-reference#bucketing">Bucketing</a>
with a general value</td>
<td>Bucketing transformation helps to replace an identifiable value with a
general value.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">
Additional Details
</code>
</td>
<td>
Built In: <code dir="ltr" translate="no">IBAN_CODE, EMAIL_ADDRESS, PHONE_NUMBER</code><br/>
Custom: <code dir="ltr" translate="no">ONLINE_USER_ID</code>
</td>
<td><a href="/dlp/docs/transformations-reference#replacement">Replacement
</a>with a token</td>
<td>Replacement transformation replaces original data with an arbitrary value.</td>
</tr>
</tbody>
</table>
<h2 data-text="Creating a BigQuery dataset" id="creating_a_bigquery_dataset">Creating a BigQuery dataset</h2>
<ol>
<li><p>Create a dataset in
<a href="/bigquery/docs" track-metadata-position="body" track-name="internalLink" track-type="solution">BigQuery</a> 
where the Cloud DLP pipeline can store the de-identified data
(Replace <code dir="ltr" translate="no"><var translate="no">LOCATION</var></code> with your preferred <a href="/bigquery/docs/locations" track-metadata-position="body" track-name="internalLink" track-type="solution">BigQuery location</a>,
for example <code dir="ltr" translate="no">US</code>):</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
bq mk --location=<var translate="no">LOCATION</var> \
    --description="De-Identified PII Dataset" \
    deid_dataset
</pre></li>
</ol>
<p>The steps in this tutorial assume that sensitive data is stored in
Cloud Storage in column-delimited format, typically CSV. The pipeline
used in this tutorial automatically creates a BigQuery table
based on the content of the CSV header record found in your data files. If this
header record is removed from your CSV files, you risk exposing PII data in
BigQuery.</p>
<h2 data-text="Creating a key encryption key (KEK)" id="creating_a_key_encryption_key_kek">Creating a key encryption key (KEK)</h2>
<p>A token encryption key (TEK) is protected
(<a href="/kms/docs/key-wrapping" track-metadata-position="body" track-name="internalLink" track-type="solution">wrapped</a>)
with another key (key encryption key) from Cloud Key Management Service (Cloud KMS):</p>
<ol>
<li><p>In Cloud Shell, create a TEK locally. For this tutorial, you
generate a random 32-character base-64 encryption key:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
export TEK=$(openssl rand -base64 32); echo ${TEK}
</pre>
<p>The output is a random key generated in the following format:</p>
<pre class="console" dir="ltr" translate="no">
MpyFxEQKYKscEJVOiKMuEPdwqdffk4vTF+qwGwrp7Ps=
</pre>
<p>The effective key size in base-2 is (64)^32 =(2^6)^32=2^192, or an
<a href="https://wikipedia.org/wiki/Initialization_vector" target="external" track-metadata-position="body" track-name="externalLink" track-type="solution">AES initialization vector (IV)</a> 
of size 192-bit. This key is used later in a script.</p></li>
<li><p>Export the key, key ring, and KEK file as variables:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
export KEY_RING_NAME=my-kms-key-ring
export KEY_NAME=my-kms-key
export KEK_FILE_NAME=kek.json
</pre></li>
<li><p>Enable the Cloud KMS admin and key encrypter roles for the
Cloud Build service account:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
export PROJECT_NUMBER=$(gcloud projects list \
    --filter=${PROJECT_ID} --format="value(PROJECT_NUMBER)")
gcloud projects add-iam-policy-binding ${PROJECT_ID} \
    --member serviceAccount:$PROJECT_NUMBER@cloudbuild.gserviceaccount.com \
    --role roles/cloudkms.cryptoKeyEncrypter
gcloud projects add-iam-policy-binding ${PROJECT_ID} \
    --member serviceAccount:$PROJECT_NUMBER@cloudbuild.gserviceaccount.com \
    --role roles/cloudkms.admin
</pre></li>
<li><p>Clone the following GitHub repository and go to the project root folder:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
git clone https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification.git
cd dlp-dataflow-deidentification
</pre></li>
<li><p>Create a KEK:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud builds submit . \
    --config dlp-demo-part-1-crypto-key.yaml \
    --substitutions \
    _GCS_BUCKET_NAME=gs://${DATA_STORAGE_BUCKET},_KEY_RING_NAME=${KEY_RING_NAME},_KEY_NAME=${KEY_NAME},_TEK=${TEK},_KEK=${KEK_FILE_NAME},_API_KEY=$(gcloud auth print-access-token)
</pre></li>
<li><p>Validate that the KEK was successfully created:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gsutil cat gs://${DATA_STORAGE_BUCKET}/${KEK_FILE_NAME}
</pre>
<p>The output looks like the following:</p>
<pre class="console" dir="ltr" translate="no">
{
  "name": "<var translate="no">kms-key-resource-path</var>",
  "ciphertext": "<var translate="no">kms-wrapped-key</var>",
  "ciphertextCrc32c": "<var translate="no">checksum</var>"
}
</pre>
<p>Notes about the output:</p>
<ul>
<li><p><code dir="ltr" translate="no"><var translate="no">kms-key-resource-path</var></code>: The resource path of the
KEK in the format:
<code dir="ltr" translate="no">projects/${PROJECT_ID}/locations/global/keyRings/${KEY_RING_NAME}/cryptoKeys/${KEY_NAME}/cryptoKeyVersions/1</code>.</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">kms-wrapped-key</var></code>: Base64-encoded value of the
Cloud KMS-wrapped TEK.</p></li>
<li><p><code dir="ltr" translate="no"><var translate="no">checksum</var></code>: A CRC32C checksum of the ciphertext.</p></li>
</ul></li>
</ol>
<h2 data-text="Creating the Cloud DLP templates" id="creating_the_cloud_dlp_templates">Creating the Cloud DLP templates</h2>
<p>At this point, you have investigated the sample dataset and determined which
Cloud DLP transformations are required. For the columns requiring
cryptographic transformations, you have also created a key encryption key
(KEK). The next step is to execute a Cloud Build script to create
Cloud DLP templates based on the required transformation and the KEK.</p>
<h3 data-text="Creating a service account for Cloud DLP" id="creating_a_cloud_dlp_service_account">Creating a service account for Cloud DLP</h3>
<ol>
<li><p>In Cloud Shell, create a service account:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
export SERVICE_ACCOUNT_NAME=my-service-account
gcloud iam service-accounts create ${SERVICE_ACCOUNT_NAME} \
    --display-name "DLP Demo Service Account"
</pre></li>
<li><p>Create a JSON API key file called <code dir="ltr" translate="no">service-account-key.json</code> for the service
account:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud iam service-accounts keys create \
    --iam-account ${SERVICE_ACCOUNT_NAME}@${PROJECT_ID}.iam.gserviceaccount.com \
    service-account-key.json
</pre></li>
<li><p>Assign the <code dir="ltr" translate="no">project editor</code> and <code dir="ltr" translate="no">storage admin</code> role to the service
account:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud projects add-iam-policy-binding ${PROJECT_ID} \
    --member serviceAccount:${SERVICE_ACCOUNT_NAME}@${PROJECT_ID}.iam.gserviceaccount.com \
    --role roles/editor
gcloud projects add-iam-policy-binding ${PROJECT_ID} \
    --member serviceAccount:${SERVICE_ACCOUNT_NAME}@${PROJECT_ID}.iam.gserviceaccount.com \
    --role roles/storage.admin
</pre></li>
<li><p>Activate the service account:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud auth activate-service-account --key-file service-account-key.json
</pre></li>
</ol>
<h3 data-text="Creating the templates" id="creating_the_templates">Creating the templates</h3>
<ol>
<li><p>In Cloud Shell, execute the Cloud Build script to
create the templates:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud builds submit . \
    --config dlp-demo-part-2-dlp-template.yaml \
    --substitutions \
    _KEK_CONFIG_FILE=gs://${DATA_STORAGE_BUCKET}/${KEK_FILE_NAME},_GCS_BUCKET_NAME=gs://${DATA_STORAGE_BUCKET},_API_KEY=$(gcloud auth print-access-token)
</pre></li>
<li><p>Validate that the de-identification template was successfully created:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gsutil cp gs://${DATA_STORAGE_BUCKET}/deid-template.json .
cat deid-template.json
</pre>
<p>The output looks like the following:</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div class="github-docwidget-header" style="float: left; padding-top: 3px; margin-left: 5px;">
<a href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/deid-template.json" style="color: white;" target="_blank">
      src/main/resources/deid-template.json
    </a>
</div>
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/deid-template.json" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/deid-template.json" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-json" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dlp-dataflow-deidentification/src/main/resources/deid-template.json" data-region-tag="deid_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dlp-dataflow-deidentification/src/main/resources/deid-template.json/HEAD/deid_template" translate="no"><code dir="ltr" translate="no">{
  "name": "projects/&lt;project_id&gt;/deidentifyTemplates/&lt;template_id&gt;",
  "displayName": "Config to DeIdentify Sample Dataset",
  "description": "De-identifies Card Number, Card PIN, Card Holder's Name, SSN, Age, Job Title, Additional Details and Online UserId Fields",
  "createTime": "2019-12-01T19:21:07.306279Z",
  "updateTime": "2019-12-01T19:21:07.306279Z",
  "deidentifyConfig": {
    "recordTransformations": {
      "fieldTransformations": [
        {
          "fields": [
            {
              "name": "Card PIN"
            }
          ],
          "primitiveTransformation": {
            "cryptoHashConfig": {
              "cryptoKey": {
                "kmsWrapped": {
                  "wrappedKey": "&lt;var&gt;kms-wrapped-key&lt;/var&gt;",
                  "cryptoKeyName": "&lt;var&gt;kms-key-resource-name&lt;/var&gt;"
                }
              }
            }
          }
        },
        {
          "fields": [
            {
              "name": "SSN"
            }
          ],
          "primitiveTransformation": {
            "characterMaskConfig": {
              "maskingCharacter": "*",
              "numberToMask": 5,
              "charactersToIgnore": [
                {
                  "charactersToSkip": "-"
                }
              ]
            }
          }
        },
        {
          "fields": [
            {
              "name": "Age"
            }
          ],
          "primitiveTransformation": {
            "bucketingConfig": {
              "buckets": [
                {
                  "min": {
                    "integerValue": "18"
                  },
                  "max": {
                    "integerValue": "30"
                  },
                  "replacementValue": {
                    "stringValue": "20"
                  }
                },
                {
                  "min": {
                    "integerValue": "30"
                  },
                  "max": {
                    "integerValue": "40"
                  },
                  "replacementValue": {
                    "stringValue": "30"
                  }
                },
                {
                  "min": {
                    "integerValue": "40"
                  },
                  "max": {
                    "integerValue": "50"
                  },
                  "replacementValue": {
                    "stringValue": "40"
                  }
                },
                {
                  "min": {
                    "integerValue": "50"
                  },
                  "max": {
                    "integerValue": "60"
                  },
                  "replacementValue": {
                    "stringValue": "50"
                  }
                },
                {
                  "min": {
                    "integerValue": "60"
                  },
                  "max": {
                    "integerValue": "99"
                  },
                  "replacementValue": {
                    "stringValue": "60"
                  }
                }
              ]
            }
          }
        },
        {
          "fields": [
            {
              "name": "JobTitle"
            }
          ],
          "primitiveTransformation": {
            "bucketingConfig": {
              "buckets": [
                {
                  "min": {
                    "stringValue": "CIO"
                  },
                  "max": {
                    "stringValue": "CIOz"
                  },
                  "replacementValue": {
                    "stringValue": "Executive"
                  }
                },
                {
                  "min": {
                    "stringValue": "CEO"
                  },
                  "max": {
                    "stringValue": "CEOz"
                  },
                  "replacementValue": {
                    "stringValue": "Executive"
                  }
                },
                {
                  "min": {
                    "stringValue": "Vice President"
                  },
                  "max": {
                    "stringValue": "Vice Presidentz"
                  },
                  "replacementValue": {
                    "stringValue": "Executive"
                  }
                },
                {
                  "min": {
                    "stringValue": "Software Engineer"
                  },
                  "max": {
                    "stringValue": "Software Engineerz"
                  },
                  "replacementValue": {
                    "stringValue": "Engineer"
                  }
                },
                {
                  "min": {
                    "stringValue": "Product Manager"
                  },
                  "max": {
                    "stringValue": "Product Managerz"
                  },
                  "replacementValue": {
                    "stringValue": "Manager"
                  }
                }
              ]
            }
          }
        },
        {
          "fields": [
            {
              "name": "Additional Details"
            }
          ],
          "infoTypeTransformations": {
            "transformations": [
              {
                "infoTypes": [
                  {
                    "name": "EMAIL_ADDRESS"
                  },
                  {
                    "name": "PHONE_NUMBER"
                  },
                  {
                    "name": "IBAN_CODE"
                  },
                  {
                    "name": "ONLINE_USER_ID"
                  }
                ],
                "primitiveTransformation": {
                  "replaceWithInfoTypeConfig": {}
                }
              }
            ]
          }
        },
        {
          "fields": [
            {
              "name": "Card Holder's Name"
            },
            {
              "name": "Card Number"
            }
          ],
          "primitiveTransformation": {
            "cryptoDeterministicConfig": {
              "cryptoKey": {
                "kmsWrapped": {
                  "wrappedKey": "&lt;var&gt;kms-wrapped-key&lt;/var&gt;",
                  "cryptoKeyName": "&lt;var&gt;kms-key-resource-name&lt;/var&gt;"
                }
              }
            }
          }
        }
      ]
    }
  }
}</code></pre>
</div>
</li>
<li><p>Validate that the inspect template was successfully created:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gsutil cp gs://${DATA_STORAGE_BUCKET}/inspect-template.json .
cat inspect-template.json
</pre>
<p>The output looks like the following:</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div class="github-docwidget-header" style="float: left; padding-top: 3px; margin-left: 5px;">
<a href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/inspect-template.json" style="color: white;" target="_blank">
      src/main/resources/inspect-template.json
    </a>
</div>
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/inspect-template.json" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/inspect-template.json" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-json" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dlp-dataflow-deidentification/src/main/resources/inspect-template.json" data-region-tag="inspect_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dlp-dataflow-deidentification/src/main/resources/inspect-template.json/HEAD/inspect_template" translate="no"><code dir="ltr" translate="no">{
  "name": "projects/&lt;project_id&gt;/inspectTemplates/&lt;template_id&gt;",
  "displayName": "Config to Inspect Additional Details Column",
  "description": "Inspect template for built in info types EMAIL_ADDRESS, PHONE_NUMBER, IBAN_CODE and custom Info type ONLINE_USER_ID",
  "createTime": "2019-12-01T19:21:08.063415Z",
  "updateTime": "2019-12-01T19:21:08.063415Z",
  "inspectConfig": {
    "infoTypes": [
      {
        "name": "IBAN_CODE"
      },
      {
        "name": "EMAIL_ADDRESS"
      },
      {
        "name": "PHONE_NUMBER"
      }
    ],
    "minLikelihood": "LIKELY",
    "limits": {},
    "customInfoTypes": [
      {
        "infoType": {
          "name": "ONLINE_USER_ID"
        },
        "regex": {
          "pattern": "\\b:\\d{16}"
        }
      }
    ]
  }
}</code></pre>
</div>
</li>
<li><p>Validate that the re-identification template was successfully created:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gsutil cp gs://${DATA_STORAGE_BUCKET}/reid-template.json .
cat reid-template.json
</pre>
<p>The output looks like the following:</p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div class="github-docwidget-header" style="float: left; padding-top: 3px; margin-left: 5px;">
<a href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/reid-template.json" style="color: white;" target="_blank">
      src/main/resources/reid-template.json
    </a>
</div>
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/reid-template.json" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification/blob/HEAD/src/main/resources/reid-template.json" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-json" data-code-snippet="true" data-git-revision="HEAD" data-github-path="GoogleCloudPlatform/dlp-dataflow-deidentification/src/main/resources/reid-template.json" data-region-tag="reid_template" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="GoogleCloudPlatform/dlp-dataflow-deidentification/src/main/resources/reid-template.json/HEAD/reid_template" translate="no"><code dir="ltr" translate="no">{
  "name": "projects/&lt;project_id&gt;/deidentifyTemplates/&lt;template_id&gt;",
  "displayName": "Config to ReIdentify Sample Dataset",
  "description": "Used to re-identify Card Number and Card Holder's Name",
  "createTime": "2019-12-01T19:21:07.306279Z",
  "updateTime": "2019-12-01T19:21:07.306279Z",
  "deidentifyConfig": {
    "recordTransformations": {
      "fieldTransformations": [
        {
          "fields": [
            {
              "name": "Card_Holders_Name"
            },
            {
              "name": "Card_Number"
            }
          ],
          "primitiveTransformation": {
            "cryptoDeterministicConfig": {
              "cryptoKey": {
                "kmsWrapped": {
                  "wrappedKey": "&lt;var&gt;kms-wrapped-key&lt;/var&gt;",
                  "cryptoKeyName": "&lt;var&gt;kms-key-resource-name&lt;/var&gt;"
                }
              }
            }
          }
        }
      ]
    }
  }
}</code></pre>
</div>
<p>The re-identification template is similar to the de-identification template,
except it only contains transformations that are reversible, in this case
the ones for the <code dir="ltr" translate="no">Card Holder's Name</code> and <code dir="ltr" translate="no">Card Number</code> fields.</p></li>
<li><p>Export the Cloud DLP templates names:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
export DEID_TEMPLATE_NAME=$(jq -r '.name' deid-template.json)
export INSPECT_TEMPLATE_NAME=$(jq -r '.name' inspect-template.json)
export REID_TEMPLATE_NAME=$(jq -r '.name' reid-template.json)
</pre></li>
<li><p>Validate that the following variables exist:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
echo ${DATA_STORAGE_BUCKET}
echo ${DATAFLOW_TEMP_BUCKET}
echo ${DEID_TEMPLATE_NAME}
echo ${INSPECT_TEMPLATE_NAME}
echo ${REID_TEMPLATE_NAME}
</pre></li>
</ol>
<p>You have successfully completed this tutorial. In the next tutorial, you
<a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">trigger an automated Dataflow pipeline</a> 
to inspect and de-identify the sample dataset and store this dataset in
BigQuery.</p>
</section>
</div>
<section id="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
      
      
If you don't intend to continue with the tutorials in the series, the easiest
way to eliminate billing is to delete the Cloud project you
created for the tutorial. Alternatively, you can delete the individual
resources.
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</section>
<section id="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li><a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="internalLink" track-type="solution">Running an automated Dataflow pipeline to de-identify a PII dataset</a>.</li>
<li><a href="/solutions/validating-de-identified-data-bigquery-re-identifying-pii-data" track-metadata-position="body" track-name="internalLink" track-type="solution">Validating de-identified data in BigQuery and re-identifying PII data</a>.</li>
<li><a href="/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-position="body" track-name="internalLink" track-type="solution">De-identification and re-identification of PII in large-scale datasets using Cloud DLP</a>.</li>
<li>Review the sample code in the <a class="external" href="https://github.com/GoogleCloudPlatform/dlp-dataflow-deidentification" track-metadata-end-goal="seeExample" track-metadata-position="body" track-name="gitHubLink" track-type="tutorial">Migrate Sensitive Data in BigQuery Using Dataflow &amp; Cloud DLP</a> 
repo on GitHub.</li>
<li>Learn about other <a href="/solutions/smart-analytics/reference-patterns/overview#pattern_recognition">pattern recognition solutions</a>.</li>
<li>

Explore reference architectures, diagrams, tutorials, and best practices about Google Cloud.
Take a look at our
<a href="/architecture" track-metadata-position="nextSteps" track-name="textLink" track-type="tutorial">Cloud Architecture Center</a>.



    </li></ul></section>
<section id="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//architecture/building-anomaly-detection-dataflow-bigqueryml-dlp]</H1></p><div class="devsite-article-body clearfix">
<div class="tutorial tutorial-lesson">
<section id="overview">
<p>This tutorial shows you how to build a secure ML-based network anomaly
detection solution for telecommunication networks. This type of solution is used
to help identify cybersecurity threats.</p>
<p>This tutorial is intended for data engineers and scientists and assumes that you
have basic knowledge of the following:</p>
<ul>
<li><a href="/dataflow" track-metadata-position="body" track-name="internalLink" track-type="tutorial">Dataflow</a> 
pipelines built using the Apache Beam Java SDK</li>
<li>Standard SQL</li>
<li>Basic shell scripting</li>
<li><a class="external" href="https://wikipedia.org/wiki/K-means_clustering" track-metadata-position="body" track-name="externalLink" track-type="tutorial">K-means clustering</a> </li>
</ul>
<h2 data-text="Reference architecture" id="reference_architecture">Reference architecture</h2>
<p>The following diagram shows the components used to build an ML-based network
anomaly detection system. Pub/Sub and Cloud Storage serve as
data sources. Dataflow aggregates and extracts features from this data
tokenized with DLP API. BigQuery ML creates a
k-means clustering model from these features and Dataflow
identifies the outliers.</p>
<p><img alt="Anomaly detection reference architecture using
Dataflow and BigQuery ML." src="/architecture/images/anomaly-detection-ref.svg"/></p>
</section>
<section id="objectives">
<h2 data-text="Objectives" id="objectives">Objectives</h2>
<ul>
<li>Create a Pub/Sub topic and a subscription to generate
synthetic <a href="https://wikipedia.org/wiki/NetFlow">NetFlow</a> log data.</li>
<li>Aggregate and extract features from NetFlow log data using
Dataflow.</li>
<li>Create a BigQuery ML k-means clustering model.</li>
<li>Tokenize sensitive data with the DLP API.</li>
<li>Create a Dataflow pipeline for real-time outlier detection,
using normalized and trained data.</li>
</ul>
</section>
<section id="costs">
<h2 data-text="Costs" id="costs">Costs</h2>
<p>
<p>
  

  This tutorial uses the following billable components of Google Cloud:
  
    </p>
<ul>
<li><a href="/bigquery-ml/pricing">BigQuery ML</a></li>
<li><a href="/storage/pricing">Cloud Storage</a></li>
<li><a href="/dataflow/pricing">Dataflow</a></li>
<li><a href="/dlp/pricing">Cloud Data Loss Prevention API</a></li>
<li><a href="/pubsub/pricing">Pub/Sub</a></li>
<li><a href="/build/pricing">Cloud Build</a></li>
</ul>
<p>
  

  
  To generate a cost estimate based on your projected usage,
      use the <a href="/products/calculator" track-name="pricingCalculator" track-type="commonIncludes">pricing calculator</a>.
  <cloudx-free-trial-eligible-content>
<slot slot="eligible">
      New Google Cloud users might be eligible for a <a href="/free-trial" target="_blank" track-metadata-end-goal="signUp" track-metadata-position="prerequisites" track-name="consoleLink" track-type="freeTrial">free trial</a>.
    </slot>
<slot slot="ineligible">
</slot>
</cloudx-free-trial-eligible-content>
</p>
</p></section>
<section id="prerequisites">
<h2 data-text="Before you begin" id="before-you-begin">Before you begin</h2>
<ol>
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<li>
    
      
        
        Sign in to your Google Cloud account. If you're new to
        Google Cloud, <a href="https://console.cloud.google.com/freetrial" target="console" track-metadata-eventdetail="https://console.cloud.google.com/freetrial" track-metadata-link-destination="https://console.cloud.google.com/freetrial" track-metadata-position="prereqs" track-name="createAnAccount" track-type="commonIncludes">
        create an account</a> to evaluate how our products perform in
        real-world scenarios. New customers also get $300 in free credits to
        run, test, and deploy workloads.
      
    
    </li>
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
<slot slot="ineligible">
<li>
<p>In the Google Cloud console, on the project selector page,
        select or <a href="/resource-manager/docs/creating-managing-projects">create a Google Cloud project</a>.</p>
<aside class="note"><b>Note</b>: If you don't plan to keep the
    resources that you create in this procedure, create a project instead of
    selecting an existing project. After you finish these steps, you can
    delete the project, removing all resources associated with the project.</aside>
<p><a class="button button-primary" href="https://console.cloud.google.com/projectselector2/home/dashboard" target="console" track-metadata-end-goal="createProject" track-name="consoleLink" track-type="commonIncludes">Go to project selector</a></p>
</li>
<li>
<p>
      Make sure that billing is enabled for your Cloud project. Learn how to
      <a href="/billing/docs/how-to/verify-billing-enabled" target="_blank" track-metadata-end-goal="enableBilling" track-name="supportLink" track-type="commonIncludes">check if billing is enabled on a project</a>.
    </p>
</li>
</slot>
</cloudx-free-trial-eligible-content>
<li>
<p>In the Cloud console, activate Cloud Shell.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/?cloudshell=true" target="console" track-metadata-end-goal="launchCloudShell" track-name="consoleLink" track-type="commonIncludes">Activate Cloud Shell</a></p>
<p>
      At the bottom of the Cloud console, a
      <a href="/shell/docs/features">Cloud Shell</a>
      session starts and displays a command-line prompt. Cloud Shell is a shell environment
      with the Google Cloud CLI
      already installed and with values already set for
      your current project. It can take a few seconds for the session to initialize.
    </p>
</li>
    
  


  
    You run all commands in this tutorial from the Cloud Shell.
<li>In Cloud Shell, enable the BigQuery,
    Dataflow, Cloud Storage, and
  DLP APIs.
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud services enable dlp.googleapis.com bigquery.googleapis.com \
  dataflow.googleapis.com storage-component.googleapis.com \
  pubsub.googleapis.com cloudbuild.googleapis.com
</code></pre>
<p></p></li></ol>
</section>
<div id="tutorial-content">
<section class="tutorial-content">
<h2 data-text="Generating synthetic data using Dataflow and Pub/Sub" id="generating_synthetic_data_using_dataflow_and_pub_sub">Generating synthetic data using Dataflow and Pub/Sub</h2>
<p>In this section, you create a Pub/Sub topic and a subscription to
generate synthetic NetFlow log data by triggering an automated
Dataflow pipeline.</p>
<h3 data-text="Create a Pub/Sub topic and a subscription" id="create_a_pub_sub_topic_and_a_subscription">Create a Pub/Sub topic and a subscription</h3>
<ul>In Cloud Shell, create a Pub/Sub topic and a
    subscription:

<pre class="prettyprint lang-sh" dir="ltr" translate="no">
export PROJECT_ID=$(gcloud config get-value project)
export TOPIC_ID=<var translate="no">TOPIC_ID</var>
export SUBSCRIPTION_ID=<var translate="no">SUBSCRIPTION_ID</var>
gcloud pubsub topics create $TOPIC_ID
gcloud pubsub subscriptions create $SUBSCRIPTION_ID --topic=$TOPIC_ID </pre>

Replace the following:

<ul>
<li><var translate="no">TOPIC_ID</var>: the name of the Pub/Sub topic</li>
<li><var translate="no">SUBSCRIPTION_ID</var>: the name of the Pub/Sub
  subscription</li>
</ul></ul>
<h3 data-text="Trigger the synthetic data generation pipeline" id="trigger_the_synthetic_data_generation_pipeline">Trigger the synthetic data generation pipeline</h3>
<ol>
<li><p>In Cloud Shell, clone the GitHub repository:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">git clone https://github.com/GoogleCloudPlatform/df-ml-anomaly-detection.git
cd df-ml-anomaly-detection
</code></pre></li>
<li><p>To enable submitting a job automatically, grant Dataflow
permissions to your Cloud Build service account:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export PROJECT_NUMBER=$(gcloud projects list --filter=${PROJECT_ID} \
  --format="value(PROJECT_NUMBER)")

gcloud projects add-iam-policy-binding ${PROJECT_ID} \
  --member serviceAccount:${PROJECT_NUMBER}@cloudbuild.gserviceaccount.com \
  --role roles/dataflow.admin

gcloud projects add-iam-policy-binding ${PROJECT_ID} \
  --member serviceAccount:${PROJECT_NUMBER}@cloudbuild.gserviceaccount.com \
  --role roles/compute.instanceAdmin.v1

gcloud projects add-iam-policy-binding ${PROJECT_ID} \
  --member serviceAccount:${PROJECT_NUMBER}@cloudbuild.gserviceaccount.com \
  --role roles/iam.serviceAccountUser

</code></pre></li>
<li><p>Start the synthetic data generation pipeline:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud builds submit . --machine-type=n1-highcpu-8 \
  --config scripts/cloud-build-data-generator.yaml \
  --substitutions _TOPIC_ID=${TOPIC_ID}
</code></pre>
<p>Because of the large code package, you must use a high memory machine type.
For this tutorial, use <code dir="ltr" translate="no">machine-type=n1-highcpu-8</code>.</p></li>
<li><p>Validate that the log data is published in the subscription:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud pubsub subscriptions pull ${SUBSCRIPTION_ID} --auto-ack --limit 1 &gt;&gt; raw_log.txt
cat raw_log.txt
</code></pre>
<p>The output contains a subset of NetFlow log schema fields populated with
random values, similar to the following:</p>
<pre class="prettyprint devsite-disable-click-to-copy lang-json" dir="ltr" translate="no">
{
 \"subscriberId\": \"mharper\",
 \"srcIP\": \"12.0.9.4",
 \"dstIP\": \"12.0.1.2\",
 \"srcPort\": 5000,
 \"dstPort\": 3000,
 \"txBytes\": 15,
 \"rxBytes\": 40,
 \"startTime\": 1570276550,
 \"endTime\": 1570276559,
 \"tcpFlag\": 0,
 \"protocolName\": \"tcp\",
 \"protocolNumber\": 0
}
</pre></li>
</ol>
<h2 data-text="Extracting features and finding outlier data" id="extracting_features_and_finding_outlier_data">Extracting features and finding outlier data</h2>
<p>In this section, you create BigQuery tables to store feature and
outlier data processed by the anomaly detection pipeline.</p>
<h3 data-text="Create BigQuery tables for storing feature and outlier data" id="create_bigquery_tables_for_storing_feature_and_outlier_data">Create BigQuery tables for storing feature and outlier data</h3>
<ol>
<li><p>In Cloud Shell, create a BigQuery dataset:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export DATASET_NAME=<var translate="no">DATASET_NAME</var>
bq --location=US mk -d \
  --description "Network Logs Dataset" \
  ${DATASET_NAME}
</code></pre></li>
<li><p>Create BigQuery tables:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">bq mk -t --schema src/main/resources/aggr_log_table_schema.json \
  --time_partitioning_type=DAY \
  --clustering_fields="dst_subnet,subscriber_id" \
  --description "Network Log Feature Table" \
  ${PROJECT_ID}:${DATASET_NAME}.cluster_model_data

bq mk -t --schema src/main/resources/outlier_table_schema.json \
  --description "Network Log Outlier Table" \
  ${PROJECT_ID}:${DATASET_NAME}.outlier_data

bq mk -t --schema src/main/resources/normalized_centroid_data_schema.json \
  --description "Sample Normalized Data" \
  ${PROJECT_ID}:${DATASET_NAME}.normalized_centroid_data
</code></pre>
<p>The following tables are generated:</p>
<ul>
<li><code dir="ltr" translate="no">cluster_model_data</code>: a clustered partition table that stores
feature values for model creation.</li>
<li><code dir="ltr" translate="no">outlier_data</code>: an outlier table that stores anomalies.</li>
<li><code dir="ltr" translate="no">normalized_centroid_data</code>: a table pre-populated with normalized data
created from a sample model.</li>
</ul></li>
<li><p>Load the centroid data into the tables:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">bq load \
  --source_format=NEWLINE_DELIMITED_JSON \
  ${PROJECT_ID}:${DATASET_NAME}.normalized_centroid_data \
  gs://df-ml-anomaly-detection-mock-data/sample_model/normalized_centroid_data.json src/main/resources/normalized_centroid_data_schema.json
</code></pre></li>
</ol>
<h3 data-text="Create and trigger a Dataflow Flex Template" id="create_and_trigger_a_dataflow_flex_template">Create and trigger a Dataflow Flex Template</h3>
<p>In this section, you create a
<a href="/dataflow/docs/guides/templates/overview#flex-templated-dataflow-jobs" track-metadata-position="body" track-name="internalLink" track-type="tutorial">Dataflow Flex Template</a> 
to trigger the anomaly detection pipeline.</p>
<ol>
<li><p>In Cloud Shell, create a Docker image in your project:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud auth configure-docker
gradle jib --image=gcr.io/${PROJECT_ID}/df-ml-anomaly-detection:latest -DmainClass=com.google.solutions.df.log.aggregations.SecureLogAggregationPipeline
</code></pre></li>
<li><p>Upload the Flex Template configuration file to a Cloud Storage
bucket:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export DF_TEMPLATE_CONFIG_BUCKET=${PROJECT_ID}-<var translate="no">DF_TEMPLATE_CONFIG</var>
gsutil mb -c standard -l <var translate="no">REGION</var> gs://${DF_TEMPLATE_CONFIG_BUCKET}
cat &lt;&lt; EOF | gsutil cp - gs://${DF_TEMPLATE_CONFIG_BUCKET}/dynamic_template_secure_log_aggr_template.json
{"image": "gcr.io/${PROJECT_ID}/df-ml-anomaly-detection",
"sdk_info": {"language": "JAVA"}
}
EOF
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">PROJECT_ID</var>: your Cloud project ID</li>
<li><var translate="no">DF_TEMPLATE_CONFIG</var>: the name of the Cloud Storage
bucket for your Dataflow Flex Template configuration file</li>
<li><var translate="no">REGION</var>: the
<a href="/storage/docs/locations" track-metadata-position="body" track-name="internalLink" track-type="tutorial">region</a> 
where you want to create the Cloud Storage bucket</li>
</ul></li>
<li><p>Create a SQL file to pass the normalized model data as a pipeline
parameter:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">echo "SELECT * FROM \`${PROJECT_ID}.${DATASET_NAME}.normalized_centroid_data\`" &gt; normalized_cluster_data.sql
gsutil cp normalized_cluster_data.sql gs://${DF_TEMPLATE_CONFIG_BUCKET}/
</code></pre></li>
<li><p>Run the anomaly detection pipeline:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud beta dataflow flex-template run "anomaly-detection" \
--project=${PROJECT_ID} \
--region=us-central1 \
--template-file-gcs-location=gs://${DF_TEMPLATE_CONFIG_BUCKET}/dynamic_template_secure_log_aggr_template.json \
--parameters=autoscalingAlgorithm="NONE",\
numWorkers=5,\
maxNumWorkers=5,\
workerMachineType=n1-highmem-4,\
subscriberId=projects/${PROJECT_ID}/subscriptions/${SUBSCRIPTION_ID},\
tableSpec=${PROJECT_ID}:${DATASET_NAME}.cluster_model_data,\
batchFrequency=2,\
customGcsTempLocation=gs://${DF_TEMPLATE_CONFIG_BUCKET}/temp,\
tempLocation=gs://${DF_TEMPLATE_CONFIG_BUCKET}/temp,\
clusterQuery=gs://${DF_TEMPLATE_CONFIG_BUCKET}/normalized_cluster_data.sql,\
outlierTableSpec=${PROJECT_ID}:${DATASET_NAME}.outlier_data,\
inputFilePattern=gs://df-ml-anomaly-detection-mock-data/flow_log*.json,\
workerDiskType=compute.googleapis.com/projects/${PROJECT_ID}/zones/us-central1-b/diskTypes/pd-ssd,\
diskSizeGb=5,\
windowInterval=10,\
writeMethod=FILE_LOADS,\
streaming=true
</code></pre></li>
<li><p>In the Cloud console, go to the <strong>Dataflow</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/dataflow" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to the Dataflow page</a> </p></li>
<li><p>Click the <strong>netflow-anomaly-detection-date +%Y%m%d-%H%M%S-%N`</strong> job. A
representation of the Dataflow pipeline that's similar to the
following appears:</p></li>
</ol>
<p><img alt="Anomaly detection pipeline job view in the Dataflow
monitoring user interface." src="/architecture/images/anomaly-detection-pipeline.png" width="600"/> </p>
<h3 data-text="Publish an outlier message for testing" id="publish_an_outlier_message_for_testing">Publish an outlier message for testing</h3>
<p>You can publish a  message to validate that the outlier message is correctly
detected from the pipeline.</p>
<ol>
<li><p>In Cloud Shell, publish the following message:</p>
<pre class="prettyprint devsite-disable-click-to-copy lang-json" dir="ltr" translate="no">
gcloud pubsub topics publish ${TOPIC_ID} --message \
"{\"subscriberId\": \"00000000000000000\",  \
\"srcIP\": \"12.0.9.4\", \
\"dstIP\": \"12.0.1.3\", \
\"srcPort\": 5000, \
\"dstPort\": 3000, \
\"txBytes\": 150000, \
\"rxBytes\": 40000, \
\"startTime\": 1570276550, \
\"endTime\": 1570276550, \
\"tcpFlag\": 0, \
\"protocolName\": \"tcp\", \
\"protocolNumber\": 0}"
</pre>
<p>Notice the unusually high number of transmission (<code dir="ltr" translate="no">txBytes</code>) and receiving
bytes (<code dir="ltr" translate="no">rxBytes</code>) compared to the range (100 to 500 bytes) set up for
synthetic data. This message might indicate a security risk to validate.</p></li>
<li><p>After a minute or so, validate that the anomaly is identified and
stored in the BigQuery table:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export OUTLIER_TABLE_QUERY='SELECT subscriber_id,dst_subnet,transaction_time
FROM `'${PROJECT_ID}.${DATASET_NAME}'.outlier_data`
WHERE subscriber_id like "0%" limit 1'
bq query --nouse_legacy_sql $OUTLIER_TABLE_QUERY &gt;&gt; outlier_orig.txt
cat outlier_orig.txt
</code></pre>
<p>The output is similar to the following:</p>
<pre class="prettyprint devsite-disable-click-to-copy lang-sh" dir="ltr" translate="no">
+---------------+--------------+----------------------------+
| subscriber_id |  dst_subnet  |   transaction_time |
+---------------+--------------+----------------------------+
| 00000000000| 12.0.1.3/22 | 2020-07-09 21:29:36.571000 |
+---------------+--------------+----------------------------+
</pre></li>
</ol>
<h2 data-text="Creating a k-means clustering model using BigQuery ML" id="creating_a_k-means_clustering_model_using_bigquery_ml">Creating a k-means clustering model using BigQuery ML</h2>
<ol>
<li><p>In the Cloud console, go to the <strong>BigQuery
Query editor</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/bigquery" target="console" track-metadata-position="body" track-name="consoleLink" track-type="tutorial">Go to Query editor</a> </p></li>
<li><p>Select training data from the feature table and create a k-means
clustering model using BigQuery ML:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">--&gt; temp table for training data
#standardSQL
CREATE OR REPLACE TABLE <var translate="no">DATASET_NAME</var>.train_data as
(SELECT * FROM <var translate="no">DATASET_NAME</var>.cluster_model_data
WHERE _PARTITIONDATE BETWEEN <var translate="no">START_DATE</var> AND <var translate="no">END_DATE</var>
AND NOT IS_NAN(avg_tx_bytes)
AND NOT IS_NAN(avg_rx_bytes)
AND NOT IS_NAN(avg_duration))
limit 100000;

--&gt; create a model using BigQuery ML
#standardSQL
CREATE OR REPLACE MODEL <var translate="no">DATASET_NAME</var>.log_cluster options(model_type='kmeans', standardize_features = true) AS
SELECT * EXCEPT (transaction_time,subscriber_id,number_of_unique_ips, number_of_unique_ports, dst_subnet)
FROM <var translate="no">DATASET_NAME</var>.train_data;
</code></pre>
<p>Replace the following:</p>
<ul>
<li><var translate="no">START_DATE</var> and <var translate="no">END_DATE</var>: the current date</li>
<li><var translate="no">DATASET_NAME</var>: the dataset that you created earlier</li>
</ul></li>
<li><p>Normalize the data for each cluster:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">--&gt; create normalize table for each centroid
#standardSQL
CREATE OR REPLACE TABLE <var translate="no">DATASET_NAME</var>.normalized_centroid_data as(
with centroid_details AS (
SELECT centroid_id,array_agg(struct(feature as name, round(numerical_value,1) as value)
order by centroid_id) AS cluster
from ML.CENTROIDS(model <var translate="no">DATASET_NAME</var>.log_cluster)
group by centroid_id
),
cluster as (select centroid_details.centroid_id as centroid_id,
(select value from unnest(cluster) where name = 'number_of_records') AS number_of_records,
(select value from unnest(cluster) where name = 'max_tx_bytes') AS max_tx_bytes,
(select value from unnest(cluster) where name = 'min_tx_bytes') AS min_tx_bytes,
(select value from unnest(cluster) where name = 'avg_tx_bytes') AS avg_tx_bytes,
(select value from unnest(cluster) where name = 'max_rx_bytes') AS max_rx_bytes,
(select value from unnest(cluster) where name = 'min_rx_bytes') AS min_rx_bytes,
(select value from unnest(cluster) where name = 'avg_rx_bytes') AS avg_rx_bytes,
(select value from unnest(cluster) where name = 'max_duration') AS max_duration,
(select value from unnest(cluster) where name = 'min_duration') AS min_duration,
(select value from unnest(cluster) where name = 'avg_duration') AS avg_duration
FROM centroid_details order by centroid_id asc),
predict as
(select * from ML.PREDICT(model <var translate="no">DATASET_NAME</var>.log_cluster,
(select * from <var translate="no">DATASET_NAME</var>.train_data)))
select c.centroid_id as centroid_id,
(stddev((p.number_of_records-c.number_of_records)+(p.max_tx_bytes-c.max_tx_bytes)+(p.min_tx_bytes-c.min_tx_bytes)+(p.avg_tx_bytes-c.min_tx_bytes)+(p.max_rx_bytes-c.max_rx_bytes)+(p.min_rx_bytes-c.min_rx_bytes)+      (p.avg_rx_bytes-c.min_rx_bytes)
+(p.max_duration-c.max_duration)+(p.min_duration-c.min_duration)+(p.avg_duration-c.avg_duration)))
as normalized_dest, any_value(c.number_of_records) as number_of_records,any_value(c.max_tx_bytes) as max_tx_bytes,  any_value(c.min_tx_bytes) as min_tx_bytes , any_value(c.avg_tx_bytes) as   avg_tx_bytes,any_value(c.max_rx_bytes) as max_rx_bytes,   any_value(c.min_tx_bytes) as min_rx_bytes ,any_value(c.avg_rx_bytes) as avg_rx_bytes,  any_value(c.avg_duration) as avg_duration,any_value(c.max_duration)
as max_duration , any_value(c.min_duration) as min_duration
from predict as p
inner join cluster as c on c.centroid_id = p.centroid_id
group by c.centroid_id);
</code></pre>
<p>This query calculates a normalized distance for each cluster by using the
standard  deviation function between the input and centroid vectors. In
other words, it implements the following formula:</p>
<p><code dir="ltr" translate="no">stddev(input_value_x-centroid_value_x)+(input_value_y-centroid_value_y)+(..))</code></p></li>
<li><p>Validate the <code dir="ltr" translate="no">normalized_centroid_data</code> table:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">#standardSQL
SELECT * from <var translate="no">DATASET_NAME</var>.normalized_centroid_data
</code></pre>
<p>The result from this statement is a table of calculated normalized distances
for each centroid ID:</p>
<p><img alt="Normalized data for each k-means cluster." src="/architecture/images/centroid-distances.png"/></p></li>
</ol>
<h2 data-text="De-identifying data using Cloud DLP" id="de-identifying_data_using_cloud_dlp">De-identifying data using Cloud DLP</h2>
<p>In this section, you reuse the pipeline by passing an additional parameter to
de-identify the <a href="https://wikipedia.org/wiki/International_mobile_subscriber_identity">international mobile subscriber identity
(IMSI)</a>
number in the <code dir="ltr" translate="no">subscriber_id</code> column.</p>
<ol>
<li><p>In Cloud Shell, create a crypto key:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export TEK=$(openssl rand -base64 32); echo ${TEK}
a3ecrQAQJJ8oxVO8TZ/odlfjcujhWXjU/Xg5lEFiw5M=
</code></pre></li>
<li><p>To launch the code editor, on the toolbar of the Cloud Shell
window, click <strong>Open Editor</strong>
<i aria-hidden="true" class="material-icons" translate="no">edit</i>.</p></li>
<li><p>Click <strong>File</strong> &gt; <strong>New File</strong> and create a file named
<code dir="ltr" translate="no">deid_template.json</code>.</p></li>
<li><p>Copy the following JSON block into the new file:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "deidentifyTemplate": {
    "displayName": "Config to de-identify IMEI Number",
    "description": "IMEI Number masking transformation",
    "deidentifyConfig": {
      "recordTransformations": {
        "fieldTransformations": [
          {
            "fields": [
              {
                "name": "subscriber_id"
              }
            ],
            "primitiveTransformation": {
              "cryptoDeterministicConfig": {
                "cryptoKey": {
                  "unwrapped": {
                    "key": "<var translate="no">CRYPTO_KEY</var>"
                  }
                },
                "surrogateInfoType": {
                  "name": "IMSI_TOKEN"
                }
              }
            }
          }
        ]
      }
    }
  },
  "templateId": "dlp-deid-subid"
}
</code></pre>
<p>Replace <var translate="no">CRYPTO_KEY</var> with the crypto key that you previously
created. It's a best practice to use a <a href="/kms/docs/key-wrapping#key_wrapping_algorithms" track-metadata-position="body" track-name="internalLink" track-type="tutorial">Cloud KMS wrapped
key</a> for
production workloads. Save the file.</p></li>
<li><p>In the Cloud Shell toolbar, click <strong>Open Terminal</strong>.</p></li>
<li><p>In the Cloud Shell terminal, create a Cloud DLP
de-identify template:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export DLP_API_ROOT_URL="https://dlp.googleapis.com"
export DEID_TEMPLATE_API="${DLP_API_ROOT_URL}/v2/projects/${PROJECT_ID}/deidentifyTemplates"
export DEID_CONFIG="@deid_template.json"

export ACCESS_TOKEN=$(gcloud auth print-access-token)
curl -X POST -H "Content-Type: application/json" \
   -H "Authorization: Bearer ${ACCESS_TOKEN}" \
   "${DEID_TEMPLATE_API}" \
   -d "${DEID_CONFIG}"
</code></pre>
<p>This creates a template with the following name in your
Cloud project:</p>
<p><code dir="ltr" translate="no">"name": "projects/${PROJECT_ID}/deidentifyTemplates/dlp-deid-sub-id"</code></p></li>
<li><p>Stop the pipeline that you triggered in an earlier step:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud dataflow jobs list --filter="name=anomaly-detection" --state=active
</code></pre></li>
<li><p>Trigger the anomaly detection pipeline using the Cloud DLP de-identify
the template name:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">gcloud beta dataflow flex-template run "anomaly-detection-with-dlp" \
--project=${PROJECT_ID} \
--region=us-central1 \
--template-file-gcs-location=gs://${DF_TEMPLATE_CONFIG_BUCKET}/dynamic_template_secure_log_aggr_template.json \
--parameters=autoscalingAlgorithm="NONE",\
numWorkers=5,\
maxNumWorkers=5,\
workerMachineType=n1-highmem-4,\
subscriberId=projects/${PROJECT_ID}/subscriptions/${SUBSCRIPTION_ID},\
tableSpec=${PROJECT_ID}:${DATASET_NAME}.cluster_model_data,\
batchFrequency=2,\
customGcsTempLocation=gs://${DF_TEMPLATE_CONFIG_BUCKET}/temp,\
tempLocation=gs://${DF_TEMPLATE_CONFIG_BUCKET}/temp,\
clusterQuery=gs://${DF_TEMPLATE_CONFIG_BUCKET}/normalized_cluster_data.sql,\
outlierTableSpec=${PROJECT_ID}:${DATASET_NAME}.outlier_data,\
inputFilePattern=gs://df-ml-anomaly-detection-mock-data/flow_log*.json,\
workerDiskType=compute.googleapis.com/projects/${PROJECT_ID}/zones/us-central1-b/diskTypes/pd-ssd,\
diskSizeGb=5,\
windowInterval=10,\
writeMethod=FILE_LOADS,\
streaming=true,\
deidTemplateName=projects/${PROJECT_ID}/deidentifyTemplates/dlp-deid-subid
</code></pre></li>
<li><p>Query the outlier table to validate that the subscriber ID is
successfully de-identified:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">export DLP_OUTLIER_TABLE_QUERY='SELECT subscriber_id,dst_subnet,transaction_time
FROM `'${PROJECT_ID}.${DATASET_NAME}'.outlier_data`
ORDER BY transaction_time DESC'

bq query --nouse_legacy_sql $DLP_OUTLIER_TABLE_QUERY &gt;&gt; outlier_deid.txt

cat outlier_deid.txt
</code></pre>
<p>The output is similar to the following:</p>
<pre class="prettyprint devsite-disable-click-to-copy lang-sh" dir="ltr" translate="no">
+---------------+--------------+----------------------------+
| subscriber_id |  dst_subnet  |      transaction_time      |
+---------------+--------------+----------------------------+
| IMSI_TOKEN(64):AcZD2U2v//QiKkGzbFCm29pv5cqVi3Db09Z6CNt5cQSevBKRQvgdDfacPQIRY1dc| 12.0.1.3/22 | 2020-07-09 21:29:36.571000 |
+---------------+--------------+----------------------------+
</pre>
<p>If the subscriber ID was de-identified, the <code dir="ltr" translate="no">subscriber_id</code> column is no
longer the original subscriber ID, which was <code dir="ltr" translate="no">00000000000</code>.</p></li>
</ol>
</section>
</div>
<section id="cleanup">
<h2 data-text="Clean up" id="clean-up">Clean up</h2>
<p>If you don't intend to continue with the tutorials in the series, the easiest
way to eliminate billing is to delete the Cloud project you
created for the tutorial. Alternatively, you can delete the individual
resources.</p>
<h3 data-text="Delete the project" id="delete_the_project">Delete the project</h3>
<ol>
<aside class="caution">
<strong>Caution</strong>: Deleting a project has the following effects:
  <ul>
<li>
<strong>Everything in the project is deleted.</strong> If you used an existing project for
      this tutorial, when you delete it, you also delete any other work you've done in the project.
    </li>
<li>
<strong>Custom project IDs are lost.</strong>
      When you created this project, you might have created a custom project ID that you want to use in
      the future. To preserve the URLs that use the project ID, such as an <code dir="ltr" translate="no">appspot.com</code>
      URL, delete selected resources inside the project instead of deleting the whole project.
    </li>
</ul>
</aside>
<li>
    In the Cloud console, go to the <b>Manage resources</b> page.
    <p><a class="button button-primary" href="https://console.cloud.google.com/iam-admin/projects" target="console" track-metadata-end-goal="deleteProject" track-name="consoleLink" track-type="commonIncludes">Go to Manage resources</a></p>
</li>
<li>
    In the project list, select the project that you
    want to delete, and then click <b>Delete</b>.
  </li>
<li>
    In the dialog, type the project ID, and then click
    <b>Shut down</b> to delete the project.
  </li>
</ol>
</section>
<section id="whatsnext">
<h2 data-text="What's next" id="whats-next">What's next</h2>
<ul>
<li>Review the sample code in the <a class="external" href="https://github.com/GoogleCloudPlatform/df-ml-anomaly-detection#anomaly-detection-in-netflow-log" track-metadata-end-goal="seeExample" track-metadata-position="body" track-name="gitHubLink" track-type="tutorial">Anomaly Detection in Netflow logs</a> 
repo on GitHub.</li>
<li>Learn about other <a href="/solutions/smart-analytics/reference-patterns/overview#anomaly_detection">anomaly detection solutions</a>.</li>
<li>

Explore reference architectures, diagrams, tutorials, and best practices about Google Cloud.
Take a look at our
<a href="/architecture" track-metadata-position="nextSteps" track-name="textLink" track-type="tutorial">Cloud Architecture Center</a>.

</li>
</ul>
</section>
<section id="freetrial">
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com/https://github.com/GoogleCloudPlatform/dlp-pdf-redaction]</H1></p>None<hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/dlp-bigquery]</H1></p><div class="devsite-article-body clearfix">
<meta content="Look through pages that provide information
about how to use Cloud Data Loss Prevention with BigQuery." name="description"/>
<p>This page contains references to pages that provide information on how
to use Cloud Data Loss Prevention with <a href="/bigquery">BigQuery</a>.</p>
<h2 data-text="Quickstart guides" id="quickstart_guides">Quickstart guides</h2>
<dl>
<dt><a href="/dlp/docs/schedule-inspection-scan" track-metadata-position="body" track-name="quickStart" track-type="listOfReferences">Quickstart: Scheduling a Cloud DLP inspection scan</a> </dt>
<dd>Schedule periodic inspection of a
Cloud Storage bucket, a BigQuery table, or a
Datastore kind. For detailed instructions, see
<a href="/dlp/docs/creating-job-triggers" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Creating and scheduling Cloud DLP inspection jobs</a>.</dd>
</dl>
<h2 data-text="How-to guides" id="how-to_guides">How-to guides</h2>
<p>This section provides a categorized list of task-based guides that demonstrate
how to use Cloud DLP with BigQuery.</p>
<h3 data-text="Inspection" id="inspection">Inspection</h3>
<dl>
<dt><a href="/dlp/docs/inspecting-storage" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Inspecting storage and databases for sensitive data</a> </dt>
<dd>Create a one-time job that searches for sensitive data in a Cloud Storage
bucket, a BigQuery table, or a Datastore kind.</dd>
<dt><a href="/dlp/docs/creating-job-triggers" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Creating and scheduling Cloud DLP inspection jobs</a> </dt>
<dd>Create and schedule a job trigger that searches for sensitive data in a
Cloud Storage bucket, a BigQuery table, or a
Datastore kind. A job trigger automates the creation of
Cloud DLP jobs on a periodic basis.</dd>
</dl>
<h3 data-text="Working with scan results" id="working_with_scan_results">Working with scan results</h3>
<dl>
<dt><a href="/dlp/docs/sending-results-to-dc" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Sending Cloud DLP scan results to Data Catalog</a> </dt>
<dd>Scan a BigQuery table, and then send the findings to
Data Catalog to automatically create tags based on
Cloud DLP findings.</dd>
<dt><a href="/dlp/docs/sending-results-to-scc" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Sending Cloud DLP scan results to Security Command Center</a> </dt>
<dd>Scan a Cloud Storage bucket, a BigQuery table, or a
Datastore kind, and then send the findings to Security Command Center.</dd>
<dt><a href="/dlp/docs/analyzing-and-reporting">Analyzing and reporting on DLP findings</a></dt>
<dd>Use BigQuery to run analytics on Cloud DLP
findings.</dd>
<dt><a href="/dlp/docs/querying-findings" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Querying Cloud DLP findings in BigQuery</a> </dt>
<dd>Look through sample queries that you can use in BigQuery to
analyze findings that Cloud DLP identified.</dd>
</dl>
<h3 data-text="Re-identification risk analysis" id="re-identification_risk_analysis">Re-identification risk analysis</h3>
<dl>
<dt><a href="/dlp/docs/compute-risk-analysis" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Measuring re-identification and disclosure risk</a> </dt>
<dd><p>Analyze structured data stored in a BigQuery table and compute
the following re-identification risk metrics:</p>
<ul>
<li><a href="/dlp/docs/compute-k-anonymity"><em>k</em>-anonymity</a></li>
<li><a href="/dlp/docs/compute-l-diversity"><em>l</em>-diversity</a></li>
<li><a href="/dlp/docs/compute-k-map"><em>k</em>-map</a></li>
<li><a href="/dlp/docs/compute-d-presence"><em>Î´</em>-presence</a></li>
</ul></dd>
<dt><a href="/dlp/docs/compute-stats" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Computing numerical and categorical statistics</a> </dt>
<dd><p>Determine minimum, maximum, and quantile values for an individual
BigQuery column.</p></dd>
<dt><a href="/dlp/docs/visualizing_re-id_risk" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Visualizing re-identification risk using Data Studio</a> </dt>
<dd><p>Measure the <em>k</em>-anonymity of a dataset, and then visualize it in
Google Data Studio.</p></dd>
</dl>
<h2 data-text="Tutorials" id="tutorials">Tutorials</h2>
<dl>
<dt>De-identification and re-identification of PII using Cloud DLP</dt>
<dd><p>Create an automated data transformation pipeline to de-identify sensitive data
like personally identifiable information (PII). This is a four-part series
containing the following topics:</p>
<ul>
<li><a href="/architecture/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">De-identification and re-identification of PII in large-scale datasets using Cloud DLP</a> </li>
<li><a href="/solutions/creating-cloud-dlp-de-identification-transformation-templates-pii-dataset" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Creating DLP de-identification transformation templates for PII datasets</a> </li>
<li><a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Running an automated Dataflow pipeline to de-identify a PII dataset</a> </li>
<li><a href="/solutions/validating-de-identified-data-bigquery-re-identifying-pii-data" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Validating de-identified data in BigQuery and re-identifying PII data</a> </li>
</ul></dd>
<dt><a href="/architecture/building-anomaly-detection-dataflow-bigqueryml-dlp" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Building a secure anomaly detection solution using Dataflow, BigQuery ML, and Cloud Data Loss Prevention</a> </dt>
<dd><p>Build a secure network anomaly detection solution for telecommunication networks.</p></dd>
<dt><a href="/architecture/deploying-sensitive-data-migration-solution" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Deploying a solution for migrating sensitive data</a> </dt>
<dd><p>Implement an end-to-end data tokenization solution designed to migrate sensitive data in BigQuery.</p></dd>
</dl>
<h2 data-text="Best practices" id="best_practices">Best practices</h2>
<dl>
<dt><a href="/architecture/confidential-data-warehouse-blueprint" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Secure a BigQuery data warehouse that stores confidential data</a> </dt>
<dd>Architectural overview and best practices for data governance when creating,
deploying, and operating a data warehouse in Google Cloud, including data
de-identification, differential handling of confidential data, and
column-level access controls.</dd>
</dl>
<h2 data-text="Community contributions" id="community_contributions">Community contributions</h2>
<p>The following are owned and managed by community members, and not by the
Cloud DLP team. For questions on these items, contact their
respective owners.</p>
<dl>
<dt><a class="external" href="/community/tutorials/dlp-to-datacatalog-tags">Create Data Catalog tags by inspecting BigQuery data with Cloud Data Loss Prevention</a> </dt>
<dd>Inspect BigQuery data using the Cloud Data Loss Prevention API, and then use the
Data Catalog API to create column-level tags according to the sensitive
elements that Cloud DLP found.</dd>
<dt><a class="external" href="/community/tutorials/event-driven-serverless-scheduling-framework-dlp">Event-driven serverless scheduling architecture with Cloud DLP</a> </dt>
<dd>Set up an event-driven, serverless scheduling application that uses the
Cloud Data Loss Prevention API to inspect BigQuery data.</dd>
<dt><a class="external" href="https://github.com/GoogleCloudPlatform/df-ml-anomaly-detection">Real-time anomaly detection using Google Cloud stream analytics and AI services</a> </dt>
<dd>Walk through a real-time artificial intelligence (AI) pattern for detecting
anomalies in log files. This proof-of-concept uses Pub/Sub,
Dataflow, BigQuery ML, and Cloud DLP.</dd>
<dt><a class="external" href="https://github.com/GoogleCloudPlatform/dlp-rdb-bq-import">Relational database import to BigQuery with Dataflow and Cloud DLP</a> </dt>
<dd>Use Dataflow and Cloud DLP to securely tokenize and import
data from a relational database to BigQuery. This example
describes how to tokenize PII data before it's made persistent.</dd>
</dl>
<h2 data-text="Pricing" id="pricing">Pricing</h2>
<p>When you inspect a BigQuery table, you incur
Cloud DLP costs, according to the <a href="/dlp/pricing#storage-pricing" track-metadata-position="body" track-name="pricingInfo" track-type="listOfReferences">storage inspection job pricing</a>.</p>
<p>In addition, when you save inspection findings to a BigQuery
table, <a href="/bigquery/pricing#data_ingestion_pricing" track-metadata-position="body" track-name="pricingInfo" track-type="listOfReferences">BigQuery charges</a> 
apply.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/dlp-gcs]</H1></p><div class="devsite-article-body clearfix">
<meta content="Look through pages that provide information
about how to use Cloud Data Loss Prevention with Cloud Storage." name="description"/>
<p>This page contains references to pages that provide information on how
to use Cloud Data Loss Prevention with <a href="/storage">Cloud Storage</a>.</p>
<h2 data-text="Quickstart guides" id="quickstart_guides">Quickstart guides</h2>
<dl>
<dt><a href="/dlp/docs/schedule-inspection-scan" track-metadata-position="body" track-name="quickStart" track-type="listOfReferences">Quickstart: Scheduling a Cloud DLP inspection scan</a> </dt>
<dd>Schedule periodic inspection of a
Cloud Storage bucket, a BigQuery table, or a
Datastore kind. For detailed instructions, see
<a href="/dlp/docs/creating-job-triggers" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Creating and scheduling Cloud DLP inspection jobs</a>.</dd>
</dl>
<h2 data-text="How-to guides" id="how-to_guides">How-to guides</h2>
<p>This section provides a categorized list of task-based guides that demonstrate
how to use Cloud DLP with Cloud Storage.</p>
<h3 data-text="Inspection" id="inspection">Inspection</h3>
<dl>
<dt><a href="/dlp/docs/inspecting-storage" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Inspecting storage and databases for sensitive data</a> </dt>
<dd>Create a one-time job that searches for sensitive data in a Cloud Storage
bucket, a BigQuery table, or a Datastore kind.</dd>
<dt><a href="/dlp/docs/creating-job-triggers" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Creating and scheduling Cloud DLP inspection jobs</a> </dt>
<dd>Create and schedule a job trigger that searches for sensitive data in a
Cloud Storage bucket, a BigQuery table, or a
Datastore kind. A job trigger automates the creation of
Cloud DLP jobs on a periodic basis.</dd>
</dl>
<h3 data-text="Working with scan results" id="working_with_scan_results">Working with scan results</h3>
<dl>
<dt><a href="/dlp/docs/sending-results-to-scc" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Sending Cloud DLP scan results to Security Command Center</a> </dt>
<dd>Scan a Cloud Storage bucket, a BigQuery table, or a
Datastore kind, and then send the findings to Security Command Center.</dd>
<dt><a href="/dlp/docs/analyzing-and-reporting" track-metadata-position="body" track-name="taskLink" track-type="listOfReferences">Analyzing and reporting on DLP findings</a> </dt>
<dd>Use Cloud Storage to run analytics on Cloud DLP
findings.</dd>
</dl>
<h2 data-text="Tutorials" id="tutorials">Tutorials</h2>
<dl>
<dt>De-identification and re-identification of PII using Cloud DLP</dt>
<dd><p>Create an automated data transformation pipeline to de-identify sensitive data
like personally identifiable information (PII). This is a four-part series
containing the following topics:</p>
<ul>
<li><a href="/architecture/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">De-identification and re-identification of PII in large-scale datasets using Cloud DLP</a> </li>
<li><a href="/solutions/creating-cloud-dlp-de-identification-transformation-templates-pii-dataset" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Creating DLP de-identification transformation templates for PII datasets</a> </li>
<li><a href="/solutions/running-automated-dataflow-pipeline-de-identify-pii-dataset" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Running an automated Dataflow pipeline to de-identify a PII dataset</a> </li>
<li><a href="/solutions/validating-de-identified-data-bigquery-re-identifying-pii-data" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Validating de-identified data in BigQuery and re-identifying PII data</a> </li>
</ul></dd>
<dt><a href="/architecture/building-anomaly-detection-dataflow-bigqueryml-dlp" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Building a secure anomaly detection solution using Dataflow, BigQuery ML, and Cloud Data Loss Prevention</a> </dt>
<dd><p>Build a secure network anomaly detection solution for telecommunication networks.</p></dd>
<dt><a href="/architecture/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-position="body" track-name="solutionLink" track-type="listOfReferences">Automating the classification of data uploaded to Cloud Storage</a> </dt>
<dd><p>Implement an automated data quarantine and classification system using Cloud DLP, Cloud Storage, and Cloud Functions.</p></dd>
</dl>
<h2 data-text="Community contributions" id="community_contributions">Community contributions</h2>
<p>The following are owned and managed by community members, and not by the
Cloud DLP team. For questions on these items, contact their
respective owners.</p>
<dl>
<dt><a class="external" href="https://github.com/GoogleCloudPlatform/dataflow-speech-redaction">GitHub: Speech Redaction Framework</a> </dt>
<dd>Redact sensitive information from audio files in Cloud Storage.</dd>
<dt><a class="external" href="https://github.com/GoogleCloudPlatform/dataflow-contact-center-speech-analysis">GitHub: Speech Analysis Framework</a> </dt>
<dd>Transcribe audio, create a data pipeline for analytics of transcribed audio
files, and redact sensitive information from audio transcripts.</dd>
<dt><a class="external" href="https://github.com/GoogleCloudPlatform/df-ml-anomaly-detection">GitHub: Real-time anomaly detection using Google Cloud stream analytics and AI services</a> </dt>
<dd>Walk through a real-time artificial intelligence (AI) pattern for detecting
anomalies in log files.</dd>
</dl>
<h2 data-text="Pricing" id="pricing">Pricing</h2>
<p>When you inspect a Cloud Storage bucket, you incur
Cloud DLP costs, according to the <a href="/dlp/pricing#storage-pricing" track-metadata-position="body" track-name="pricingInfo" track-type="listOfReferences">storage inspection job pricing</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/examples]</H1></p><div class="devsite-article-body clearfix">
<article class="grid-fluid l-fixed-width" id="cloud-site">
<section class="l-relative">
<div class="grid-fluid">
<div class="c12">
<div class="card" id="examples">
<ul class="card-showcase">
<li>
<a class="no-logo" href="/dlp/demo">
<h3 class="hide-from-toc no-link" data-text="Cloud DLP web-based demo" id="cloud-dlp-web-based-demo">Cloud DLP web-based demo</h3>
<p>
    See Cloud DLP in action by performing your first text
    inspection using the demo application.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/examples-custom-infotypes">
<h3 class="hide-from-toc no-link" data-text="Examples of custom infoType detectors" id="examples-of-custom-infotype-detectors">Examples of custom infoType detectors</h3>
<p>
    Get examples of Cloud DLP custom infoType detectors that you
    can use during inspection and de-identification.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/redacting-sensitive-data">
<h3 class="hide-from-toc no-link" data-text="Redacting sensitive data from text content" id="redacting-sensitive-data-from-text-content">Redacting sensitive data from text content</h3>
<p>
    Redact sensitive information from text strings.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/examples-deid-tables">
<h3 class="hide-from-toc no-link" data-text="Examples of de-identifying tabular data" id="examples-of-de-identifying-tabular-data">Examples of de-identifying tabular data</h3>
<p>
    Get examples of how to transform tables.
    </p>
</a>
</li>
<li>
<a class="no-logo" href="/dlp/docs/querying-findings">
<h3 class="hide-from-toc no-link" data-text="Querying Cloud DLP findings in BigQuery" id="querying-cloud-dlp-findings-in-bigquery">Querying Cloud DLP findings in BigQuery</h3>
<p>
    Learn different ways to query your Cloud DLP findings that
    have been saved to BigQuery.
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</section>
</article>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/demo]</H1></p>None<hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/examples-custom-infotypes]</H1></p><div class="devsite-article-body clearfix">
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-custom-infotypes-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-custom-infotypes-protocol" track-metadata-position="dlp-inspect-custom-infotypes" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p>The sample JSON objects on this page are a few examples of
Cloud DLP <a href="/dlp/docs/concepts-infotypes">custom infoType detectors</a> that you
can use during inspection and de-identification.</p>
<p>For more information about the different kinds of custom infoType detectors and
how to create them, see <a href="/dlp/docs/creating-custom-infotypes">Creating custom infoType
detectors</a>.</p>
<h2 data-text="Example customInfoTypes contents" id="example_custominfotypes_contents">Example <code dir="ltr" translate="no">customInfoTypes</code> contents</h2>
<p>The JSON given in the following table can be inserted into any
<a href="/dlp/docs/creating-job-triggers">inspection</a> or
<a href="/dlp/docs/deidentify-sensitive-data">de-identification</a> job definition, inside the
<a href="/dlp/docs/reference/rest/v2/InspectConfig#CustomInfoType"><code dir="ltr" translate="no">"customInfoTypes"</code></a>
attribute. The following complete JSON request, which
sends a short string to Cloud DLP, includes a custom infoType
detector definition that defines a medical record number format.</p>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:inspect?key={YOUR_API_KEY}

{
  "item":{
    "value":"Patients MRN 444-5-22222"
  },
  "inspectConfig":{
    "customInfoTypes":[
      {
        "infoType":{
          "name":"C_MRN"
        },
        "regex":{
          "pattern":"[1-9]{3}-[1-9]{1}-[1-9]{5}"
        },
        "likelihood":"POSSIBLE"
      }
    ]
  }
}
</code></pre>
<table>
<tr>
<th>Example description</th>
<th>Custom infoType detector</th>
</tr>
<tr>
<td>Generic alpha-numeric identifier
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_ID2"
  },
  "regex":{
    "pattern":"\\b(([0-9]|([a-zA-Z()]{1,2}[0-9]{1}))[0-9-\\[\\]:(), ._]+)[0-9]{1}"
  },
  "likelihood":"POSSIBLE"
}</pre></td>
</tr>
<tr>
<td>
      Generic currency
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_CURRENCY"
  },
  "regex":{
    "pattern":"((\\p{Sc}{1})( ){0,1}[0-9,()]+)(.){0,1}[0-9]{0,}"
  },
  "likelihood":"VERY_LIKELY"
}</pre></td>
</tr>
<tr>
<td>
      Generic percentage
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_PERCENT"
  },
  "regex":{
    "pattern":"\\b([0-9,.()]+)( ){0,1}(%){1}"
  },
  "likelihood":"VERY_LIKELY"
}</pre></td>
</tr>
<tr>
<td>
      Generic unit of measurement
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_MEASURE"
  },
  "regex":{
    "pattern":"(?i)([0-9])([0-9,.]+)( ){0,1}(?i)(Â°C|Â°F|K|Â°RÃ©|Â°N|Â°Ra|mÂ³|dmÂ³|cmÂ³|l|dl|cl|ml|fl oz|inÂ³|ftÂ³|ydÂ³|gal|bbl|pt|km|m|dm|cm|mm|mi|in|ft|yd|nautical mile|kg|hg|g|dg|cg|mg|Âµg|mcg|carat|grain|oz|lb|cwt|ton|kmÂ²|mÂ²|dmÂ²|cmÂ²|mmÂ²|ha|ca|mileÂ²|inÂ²|ydÂ²|ftÂ²|acre|nautical mileÂ²|kmph|mps|mph|knot|km/h|m/s|mi/h|Hz|KHz|MHz|GHz|atm|bar|mbar|Pa|hPa|Psi|Torr|J|KJ|cal|kcal|Wh|kWh|BTU|thm|ft-lb|degrees|Celsius|Fahrenheit|Kelvin|Reaumur|Newton|Rankine|cubic |liter|deciliter|centiliter|milliliter|fluid ounce|gallon|petroleum barrel|pint|kilometer|meter|decimeter|centimeter|millimeter|mile|inch|foot|yard|nautical mile|tonne|kilogram|hectogram|gram|decigram|centigram|milligram|microgram|carat|grain|ounce|pound|square|hectare|centiare|square mile|square inch|square yard|square foot|acre|square nautical mile|kilometer|meter|mile per hour|knot|Hertz|Kilohertz|Megahertz|Gigahertz|AtmosphÃ¨re|Bar|Millibar|Pascal|Hectopascal|Torr|Joule|Kilojoule|Calorie|Kilocalorie|Watt-hour|Kilowatt-hour|Foot-Pound|mpg){1}(s){0,1}\\b"
  },
  "likelihood":"VERY_LIKELY"
}</pre></td>
</tr>
<tr>
<td>
      Generic Requests for Comments (RFC) identifier
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_RFC"
  },
  "regex":{
    "pattern":"\\b(?i)(rfc)( ){0,1}(20|768|783|791|792|793|826|854|855|862|863|864|868|903|937|951|959|1034|1035|1036|1055|1058|1059|1087|1119|1149|1157|1176|1305|1321|1350|1436|1441|1459|1730|1777|1855|1918|1939|1945|1948|1950|1951|1952|1964|2080|2119|2131|2177|2195|2228|2230|2246|2251|2252|2253|2254|2255|2256|2326|2327|2328|2351|2362|2397|2407|2408|2409|2427|2453|2460|2549|2555|2570|2595|2606|2740|2743|2744|2810|2811|2812|2813|2853|2865|2866|2974|3022|3031|3053|3056|3080|3162|3207|3261|3284|3286|3315|3339|3376|3401|3402|3403|3404|3405|3492|3501|3530|3550|3711|3720|3730|3783|3801|3830|3977|4122|4213|4217|4271|4287|4251|4291|4353|4408|4422|4541|4575|4579|4634|4646|4655|4787|4880|4960|5023|5321|5322|5533|5545|5849|5880|5881|5905|5969|6238|6265|6409|6455|6508|6726|6749|6797|6805|7230|7231|7232|7233|7234|7235|7301|7348|7469|7540|7541|7567|7725|7871|8391){0,1}"
  },
  "likelihood":"LIKELY"
}</pre></td>
</tr>
<tr>
<td>
      Generic RJ45 network connector identifier
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_RJ_NETWORK"
  },
  "regex":{
    "pattern":"\\b(?i)(rj)(-){0,1}(?i)(A1X|A2X|A3X|2MB|11|12|13|14|15C|18|21X|25|26X|27X|31X|32X|33X|34X|35X|38X|41S|45S|45|48C|48S|48X|49C|61X|71C)"
  },
  "likelihood":"VERY_LIKELY"
}</pre></td>
</tr>
<tr>
<td>
      Generic data size
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_DATA_SIZE"
  },
  "regex":{
    "pattern":"\\b([0-9,. ]+)(?i)(byte|Kilobyte|KiB|Kilobit|kbit|bit|Megabyte|MiB|Megabit|Mbit|meg|Gigabyte|GiB|Gigabit|Gbit|gig|Terabyte|TiB|Terabit|Tbit|Petabyte|PiB|Petabit|Pbit|Exabyte|EiB|Exabit|Ebit|Zettabyte|ZiB|Zettabit|Zbit|Yottabyte|YiB|Yottabit|Ybit|KB|MB|GB|TB|PB|EB|ZB|YB)(p){0,1}(s){0,1}"
  },
  "likelihood":"VERY_LIKELY"
}</pre></td>
</tr>
<tr>
<td>
      Numerical identifier
    </td>
<td><pre dir="ltr" translate="no">{
  "infoType":{
    "name":"GENERIC_ID1"
  },
  "regex":{
    "pattern":"\\w*[0-9][0-9-()\\[\\].:/]+[0-9]\\w*"
  },
  "likelihood":"POSSIBLE"
}</pre></td>
</tr>
</table>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-custom-infotypes-java" track-metadata-position="dlp-inspect-custom-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-custom-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-custom-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-custom-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java" data-region-tag="dlp_inspect_custom_regex" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectWithCustomRegex.java/HEAD/dlp_inspect_custom_regex" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ByteContentItem;
import com.google.privacy.dlp.v2.ByteContentItem.BytesType;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.CustomInfoType;
import com.google.privacy.dlp.v2.CustomInfoType.Regex;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import com.google.protobuf.ByteString;
import java.io.IOException;

public class InspectWithCustomRegex {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "Patients MRN 444-5-22222";
    String customRegexPattern = "[1-9]{3}-[1-9]{1}-[1-9]{5}";
    inspectWithCustomRegex(projectId, textToInspect, customRegexPattern);
  }

  // Inspects a BigQuery Table
  public static void inspectWithCustomRegex(
      String projectId, String textToInspect, String customRegexPattern) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ByteContentItem byteItem =
          ByteContentItem.newBuilder()
              .setType(BytesType.TEXT_UTF8)
              .setData(ByteString.copyFromUtf8(textToInspect))
              .build();
      ContentItem item = ContentItem.newBuilder().setByteItem(byteItem).build();

      // Specify the regex pattern the inspection will look for.
      Regex regex = Regex.newBuilder().setPattern(customRegexPattern).build();

      // Construct the custom regex detector.
      InfoType infoType = InfoType.newBuilder().setName("C_MRN").build();
      CustomInfoType customInfoType =
          CustomInfoType.newBuilder().setInfoType(infoType).setRegex(regex).build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder()
              .addCustomInfoTypes(customInfoType)
              .setIncludeQuote(true)
              .setMinLikelihood(Likelihood.POSSIBLE)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
</div>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/redacting-sensitive-data]</H1></p><div class="devsite-article-body clearfix">
<div class="video-wrapper">
<iframe allowfullscreen="" class="devsite-embedded-youtube-video" data-autohide="1" data-showinfo="0" data-video-id="nJKNLl9W-2E" frameborder="0">
</iframe>
</div>
<p>Cloud Data Loss Prevention can redact or obfuscate sensitive data from a
string of text. You can feed textual information to the API using JSON over
HTTP, or use one of the <a href="/dlp/docs/libraries">client libraries</a> to do so using
several popular programming languages.</p>
<p>The <a href="/dlp/docs/reference/rest/v2/projects.content/deidentify"><code dir="ltr" translate="no">projects.content.deidentify</code></a>
API takes the following as arguments:</p>
<ul>
<li>A string of text.</li>
<li>Placeholder text that will replace any sensitive data detected. In this
example, the data is replaced with its corresponding infoType.</li>
<li>A list of one or more
<a href="/dlp/docs/infotypes-reference" title="InfoTypes Reference">infoTypes</a> that you want to
redact.</li>
</ul>
<p>Cloud DLP returns the string with any sensitive data replaced by
your chosen placeholder.</p>
<aside class="note"><strong>Note:</strong><span> If you want to specify the processing location for a de-identify request,
call the <a href="/dlp/docs/reference/rest/v2/projects.locations.content/deidentify"><code dir="ltr" translate="no">projects.locations.content.deidentify</code></a> API instead. This API
lets you pass the name of the region where you want
Cloud DLP to process the request. For more information, see
<a href="/dlp/docs/specifying-location">Specifying processing locations</a>.</span></aside>
<h2 data-text="Example text redaction" id="example_text_redaction">Example text redaction</h2>
<p>For more information about using JSON with the DLP API, see
the <a href="/dlp/docs/quickstart-json">JSON quickstart</a>.</p>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-replace-infotype-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-replace-infotype-protocol" track-metadata-position="dlp-replace-infotype" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item": {
     "value":"My email is test@example.com",
   },
   "deidentifyConfig": {
     "infoTypeTransformations":{
          "transformations": [
            {
              "primitiveTransformation": {
                "replaceWithInfoTypeConfig": {}
              }
            }
          ]
        }
    },
    "inspectConfig": {
      "infoTypes": {
        "name": "EMAIL_ADDRESS"
      }
    }
}
</code></pre>
<p><strong>URL:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">https://dlp.googleapis.com/v2/projects/[PROJECT_ID]/content:deidentify
</code></pre>
<p>Cloud DLP returns the following after receiving the request:</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "item":{
    "value":"My email is [EMAIL_ADDRESS]"
  },
  "overview":{
    "transformedBytes":"16",
    "transformationSummaries":[
      {
        "infoType":{
          "name":"EMAIL_ADDRESS"
        },
        "transformation":{
          "replaceWithInfoTypeConfig":{

          }
        },
        "results":[
          {
            "count":"1",
            "code":"SUCCESS"
          }
        ],
        "transformedBytes":"16"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-replace-infotype-java" track-metadata-position="dlp-replace-infotype" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-replace-infotype" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithInfoType.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithInfoType.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-replace-infotype" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-replace-infotype" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithInfoType.java" data-region-tag="dlp_deidentify_infotype" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyWithInfoType.java/HEAD/dlp_deidentify_infotype" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import java.io.IOException;

public class DeIdentifyWithInfoType {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "My email is test@example.com";
    deIdentifyWithInfoType(projectId, textToInspect);
  }

  public static void deIdentifyWithInfoType(String projectId, String textToRedact)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToRedact).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("EMAIL_ADDRESS").build();
      InspectConfig inspectConfig = InspectConfig.newBuilder().addInfoTypes(infoType).build();
      // Specify replacement string to be used for the finding.
      ReplaceWithInfoTypeConfig replaceWithInfoTypeConfig =
          ReplaceWithInfoTypeConfig.newBuilder().build();
      // Define type of deidentification as replacement with info type.
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(replaceWithInfoTypeConfig)
              .build();
      // Associate deidentification type with info type.
      InfoTypeTransformation transformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      // Construct the configuration for the Redact request and list all desired transformations.
      DeidentifyConfig redactConfig =
          DeidentifyConfig.newBuilder()
              .setInfoTypeTransformations(
                  InfoTypeTransformations.newBuilder().addTransformations(transformation))
              .build();

      // Construct the Redact request to be sent by the client.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setDeidentifyConfig(redactConfig)
              .setInspectConfig(inspectConfig)
              .build();

      // Use the client to send the API request.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Parse the response and process results
      System.out.println("Text after redaction: " + response.getItem().getValue());
    }
  }
}
</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-replace-infotype-python" track-metadata-position="dlp-replace-infotype" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-replace-infotype" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/deid.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-replace-infotype" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-replace-infotype" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/deid.py" data-region-tag="dlp_deidentify_replace_infotype" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/deid.py/HEAD/dlp_deidentify_replace_infotype" translate="no"><code dir="ltr" translate="no">def deidentify_with_replace_infotype(project, item, info_types):
    """Uses the Data Loss Prevention API to deidentify sensitive data in a
    string by replacing it with the info type.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        item: The string to deidentify (will be treated as text).
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library
    import google.cloud.dlp

    # Instantiate a client
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Construct inspect configuration dictionary
    inspect_config = {"info_types": [{"name": info_type} for info_type in info_types]}

    # Construct deidentify configuration dictionary
    deidentify_config = {
        "info_type_transformations": {
            "transformations": [
                {"primitive_transformation": {"replace_with_info_type_config": {}}}
            ]
        }
    }

    # Call the API
    response = dlp.deidentify_content(
        request={
            "parent": parent,
            "deidentify_config": deidentify_config,
            "inspect_config": inspect_config,
            "item": {"value": item},
        }
    )

    # Print out the results.
    print(response.item.value)

</code></pre>
</div>
</section>
</div>
<p>You can try this out yourself using the API Explorer embedded here.</p>
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="dlp.projects.content.deidentify"></div>
<h2 data-text="Next steps" id="next_steps">Next steps</h2>
<p>Redaction is one form of <em>de-identification</em>. To learn more about how to
de-identify content, see <a href="/dlp/docs/deidentify-sensitive-data">De-identifying sensitive data in text
content</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/examples-deid-tables]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention can detect, classify, and
<a href="/dlp/docs/classification-redaction">de-identify</a> sensitive data within structured data.
When de-identifying content as a table, the structure and columns provide
Cloud DLP with additional clues that may enable it to provide
better results for some use cases. For example, you can scan a single column for
a certain data type instead of the entire table structure.</p>
<p>This topic provides examples of how to configure de-identification of sensitive
data within structured text. De-identification is enabled through <a href="/dlp/docs/deidentify-sensitive-data#record_transformations">record
transformations</a>. These
transformations are applied to values within tabular text data that are
identified as a specific infoType, or to an entire column of tabular data.</p>
<p>This topic also provides examples of tabular data transformations using the
cryptographic hash method. The cryptographic transformation methods are unique
because of their requirement of a cryptographic key.</p>
<p>The JSON given in the following examples can be inserted into any
<a href="/dlp/docs/deidentify-sensitive-data">de-identification</a> request inside the
<code dir="ltr" translate="no">"deidentifyConfig"</code>
(<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.DeidentifyConfig"><code dir="ltr" translate="no">DeidentifyConfig</code></a>)
attribute. Click the "APIs Explorer example" link to try out the example JSON in
<a href="/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true">APIs
Explorer</a>.</p>
<h2 data-text="Transform a column without inspection" id="transform_a_column_without_inspection">Transform a column without inspection</h2>
<p>To transform a specific column in which the content is already known, you
can skip inspection and specify a transformation directly. The example
following the table <a href="/dlp/docs/concepts-bucketing">buckets</a> the "HAPPINESS SCORE" column
into increments of 10.</p>
<table>
<tr>
<th>Input</th>
<th>Transformed table </th>
</tr>
<tr>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>95</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
</tr>
</table>
</td>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>90:100</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>20:30</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>70:80</td>
</tr>
</table>
</td>
</tr>
</table>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deid-table-bucketing-code-sample">
<section>
<h3 data-text="Java" id="dlp-deid-table-bucketing-java" track-metadata-position="dlp-deid-table-bucketing" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deid-table-bucketing" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableBucketing.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableBucketing.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deid-table-bucketing" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deid-table-bucketing" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableBucketing.java" data-region-tag="dlp_deidentify_table_bucketing" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableBucketing.java/HEAD/dlp_deidentify_table_bucketing" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.FieldTransformation;
import com.google.privacy.dlp.v2.FixedSizeBucketingConfig;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Table.Row;
import com.google.privacy.dlp.v2.Value;
import java.io.IOException;

public class DeIdentifyTableBucketing {

  public static void deIdentifyTableBucketing() throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Table tableToDeIdentify =
        Table.newBuilder()
            .addHeaders(FieldId.newBuilder().setName("AGE").build())
            .addHeaders(FieldId.newBuilder().setName("PATIENT").build())
            .addHeaders(FieldId.newBuilder().setName("HAPPINESS SCORE").build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("101").build())
                    .addValues(Value.newBuilder().setStringValue("Charles Dickens").build())
                    .addValues(Value.newBuilder().setStringValue("95").build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("22").build())
                    .addValues(Value.newBuilder().setStringValue("Jane Austen").build())
                    .addValues(Value.newBuilder().setStringValue("21").build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("55").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain").build())
                    .addValues(Value.newBuilder().setStringValue("75").build())
                    .build())
            .build();

    deIdentifyTableBucketing(projectId, tableToDeIdentify);
  }

  public static Table deIdentifyTableBucketing(String projectId, Table tableToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to de-identify.
      ContentItem contentItem = ContentItem.newBuilder().setTable(tableToDeIdentify).build();

      // Specify how the content should be de-identified.
      FixedSizeBucketingConfig fixedSizeBucketingConfig =
          FixedSizeBucketingConfig.newBuilder()
              .setBucketSize(10)
              .setLowerBound(Value.newBuilder().setIntegerValue(0).build())
              .setUpperBound(Value.newBuilder().setIntegerValue(100).build())
              .build();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setFixedSizeBucketingConfig(fixedSizeBucketingConfig)
              .build();

      // Specify field to be encrypted.
      FieldId fieldId = FieldId.newBuilder().setName("HAPPINESS SCORE").build();

      // Associate the encryption with the specified field.
      FieldTransformation fieldTransformation =
          FieldTransformation.newBuilder()
              .setPrimitiveTransformation(primitiveTransformation)
              .addFields(fieldId)
              .build();
      RecordTransformations transformations =
          RecordTransformations.newBuilder().addFieldTransformations(fieldTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results.
      System.out.println("Table after de-identification: " + response.getItem().getTable());

      return response.getItem().getTable();
    }
  }
}</code></pre>
</div>
</section>
</div>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2Ftestff%22%2C%22resource%22%3A%7B%22deidentifyConfig%22%3A%7B%22recordTransformations%22%3A%7B%22fieldTransformations%22%3A%5B%7B%22fields%22%3A%5B%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22fixedSizeBucketingConfig%22%3A%7B%22bucketSize%22%3A10%2C%22lowerBound%22%3A%7B%22integerValue%22%3A%220%22%7D%2C%22upperBound%22%3A%7B%22integerValue%22%3A%22100%22%7D%7D%7D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22AGE%22%7D%2C%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22integerValue%22%3A%22101%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%22%7D%2C%7B%22integerValue%22%3A%2295%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2225%22%7D%2C%7B%22stringValue%22%3A%22Jane%20Austen%22%7D%2C%7B%22integerValue%22%3A%2221%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2255%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%22%7D%2C%7B%22integerValue%22%3A%2275%22%7D%5D%7D%5D%7D%7D%7D%7D">
  API Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"deidentifyConfig":{
  "recordTransformations":{
    "fieldTransformations":[
      {
        "fields":[
          {
            "name":"HAPPINESS SCORE"
          }
        ],
        "primitiveTransformation":{
          "fixedSizeBucketingConfig":{
            "bucketSize":10,
            "lowerBound":{
              "integerValue":"0"
            },
            "upperBound":{
              "integerValue":"100"
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<h2 data-text="Transform a column based on the value of another column" id="transform_a_column_based_on_the_value_of_another_column">Transform a column based on the value of another column</h2>
<p>You can transform a column based on the value of another. This example redacts
"HAPPINESS SCORE" for all patients over 89.</p>
<table>
<tr>
<th>Input</th>
<th>Transformed table </th>
</tr>
<tr>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>95</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
</tr>
</table>
</td>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>**</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
</tr>
</table>
</td>
</tr>
</table>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deid-table-condition-masking-code-sample">
<section>
<h3 data-text="Java" id="dlp-deid-table-condition-masking-java" track-metadata-position="dlp-deid-table-condition-masking" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deid-table-condition-masking" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionMasking.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionMasking.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deid-table-condition-masking" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deid-table-condition-masking" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionMasking.java" data-region-tag="dlp_deidentify_table_condition_masking" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionMasking.java/HEAD/dlp_deidentify_table_condition_masking" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.CharacterMaskConfig;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.FieldTransformation;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RecordCondition;
import com.google.privacy.dlp.v2.RecordCondition.Condition;
import com.google.privacy.dlp.v2.RecordCondition.Conditions;
import com.google.privacy.dlp.v2.RecordCondition.Expressions;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.RelationalOperator;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Table.Row;
import com.google.privacy.dlp.v2.Value;
import java.io.IOException;

public class DeIdentifyTableConditionMasking {

  public static void deIdentifyTableConditionMasking() throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Table tableToDeIdentify =
        Table.newBuilder()
            .addHeaders(FieldId.newBuilder().setName("AGE").build())
            .addHeaders(FieldId.newBuilder().setName("PATIENT").build())
            .addHeaders(FieldId.newBuilder().setName("HAPPINESS SCORE").build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("101").build())
                    .addValues(Value.newBuilder().setStringValue("Charles Dickens").build())
                    .addValues(Value.newBuilder().setStringValue("95").build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("22").build())
                    .addValues(Value.newBuilder().setStringValue("Jane Austen").build())
                    .addValues(Value.newBuilder().setStringValue("21").build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("55").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain").build())
                    .addValues(Value.newBuilder().setStringValue("75").build())
                    .build())
            .build();

    deIdentifyTableConditionMasking(projectId, tableToDeIdentify);
  }

  public static Table deIdentifyTableConditionMasking(String projectId, Table tableToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to de-identify.
      ContentItem contentItem = ContentItem.newBuilder().setTable(tableToDeIdentify).build();

      // Specify how the content should be de-identified.
      CharacterMaskConfig characterMaskConfig =
          CharacterMaskConfig.newBuilder().setMaskingCharacter("*").build();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder().setCharacterMaskConfig(characterMaskConfig).build();

      // Specify field to be de-identified.
      FieldId fieldId = FieldId.newBuilder().setName("HAPPINESS SCORE").build();

      // Specify when the above field should be de-identified.
      Condition condition =
          Condition.newBuilder()
              .setField(FieldId.newBuilder().setName("AGE").build())
              .setOperator(RelationalOperator.GREATER_THAN)
              .setValue(Value.newBuilder().setIntegerValue(89).build())
              .build();
      // Apply the condition to records
      RecordCondition recordCondition =
          RecordCondition.newBuilder()
              .setExpressions(
                  Expressions.newBuilder()
                      .setConditions(Conditions.newBuilder().addConditions(condition).build())
                      .build())
              .build();

      // Associate the de-identification and conditions with the specified field.
      FieldTransformation fieldTransformation =
          FieldTransformation.newBuilder()
              .setPrimitiveTransformation(primitiveTransformation)
              .addFields(fieldId)
              .setCondition(recordCondition)
              .build();
      RecordTransformations transformations =
          RecordTransformations.newBuilder().addFieldTransformations(fieldTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results.
      System.out.println("Table after de-identification: " + response.getItem().getTable());

      return response.getItem().getTable();
    }
  }
}</code></pre>
</div>
</section>
</div>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2Ftestff%22%2C%22resource%22%3A%7B%22deidentifyConfig%22%3A%7B%22recordTransformations%22%3A%7B%22fieldTransformations%22%3A%5B%7B%22fields%22%3A%5B%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22characterMaskConfig%22%3A%7B%22maskingCharacter%22%3A%22*%22%7D%7D%2C%22condition%22%3A%7B%22expressions%22%3A%7B%22conditions%22%3A%7B%22conditions%22%3A%5B%7B%22field%22%3A%7B%22name%22%3A%22AGE%22%7D%2C%22operator%22%3A%22GREATER_THAN%22%2C%22value%22%3A%7B%22integerValue%22%3A%2289%22%7D%7D%5D%7D%7D%7D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22AGE%22%7D%2C%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22integerValue%22%3A%22101%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%22%7D%2C%7B%22integerValue%22%3A%2295%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2225%22%7D%2C%7B%22stringValue%22%3A%22Jane%20Austen%22%7D%2C%7B%22integerValue%22%3A%2221%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2255%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%22%7D%2C%7B%22integerValue%22%3A%2275%22%7D%5D%7D%5D%7D%7D%7D%7D">
  API Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"deidentifyConfig":{
  "recordTransformations":{
    "fieldTransformations":[
      {
        "fields":[
          {
            "name":"HAPPINESS SCORE"
          }
        ],
        "primitiveTransformation":{
          "characterMaskConfig":{
            "maskingCharacter":"*"
          }
        },
        "condition":{
          "expressions":{
            "conditions":{
              "conditions":[
                {
                  "field":{
                    "name":"AGE"
                  },
                  "operator":"GREATER_THAN",
                  "value":{
                    "integerValue":"89"
                  }
                }
              ]
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<h2 data-text="Transform findings found in columns" id="transform_findings_found_in_columns">Transform findings found in columns</h2>
<p>You can transform findings that make up either only part of a cell's
content or all of it. In this example, all instances of <code dir="ltr" translate="no">PERSON_NAME</code> are
anonymized.</p>
<table>
<tr>
<th>Input</th>
<th>Transformed table </th>
</tr>
<tr>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
<th>FACTOID</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>95</td>
<td>Charles Dickens name was a curse, possibly invented by Shakespeare.</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
<td>There are 14 kisses in Jane Austen's novels.</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
<td>Mark Twain loved cats.</td>
</tr>
</table>
</td>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
<th>FACTOID</th>
</tr>
<tr>
<td>101</td>
<td>[PERSON_NAME]</td>
<td>95</td>
<td>[PERSON_NAME] name was a curse, possibly invented by Shakespeare.</td>
</tr>
<tr>
<td>22</td>
<td>[PERSON_NAME]</td>
<td>21</td>
<td>There are 14 kisses in [PERSON_NAME] novels.</td>
</tr>
<tr>
<td>55</td>
<td>[PERSON_NAME]</td>
<td>75</td>
<td>[PERSON_NAME] loved cats.</td>
</tr>
</table>
</td>
</tr>
</table>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deid-table-infotypes-code-sample">
<section>
<h3 data-text="Java" id="dlp-deid-table-infotypes-java" track-metadata-position="dlp-deid-table-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deid-table-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deid-table-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deid-table-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableInfoTypes.java" data-region-tag="dlp_deidentify_table_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableInfoTypes.java/HEAD/dlp_deidentify_table_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.FieldTransformation;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Table.Row;
import com.google.privacy.dlp.v2.Value;
import java.io.IOException;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class DeIdentifyTableInfoTypes {

  public static void deIdentifyTableInfoTypes() throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Table tableToDeIdentify =
        Table.newBuilder()
            .addHeaders(FieldId.newBuilder().setName("AGE").build())
            .addHeaders(FieldId.newBuilder().setName("PATIENT").build())
            .addHeaders(FieldId.newBuilder().setName("HAPPINESS SCORE").build())
            .addHeaders(FieldId.newBuilder().setName("FACTOID").build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("101").build())
                    .addValues(Value.newBuilder().setStringValue("Charles Dickens").build())
                    .addValues(Value.newBuilder().setStringValue("95").build())
                    .addValues(
                        Value.newBuilder()
                            .setStringValue(
                                "Charles Dickens name was a curse invented by Shakespeare.")
                            .build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("22").build())
                    .addValues(Value.newBuilder().setStringValue("Jane Austen").build())
                    .addValues(Value.newBuilder().setStringValue("21").build())
                    .addValues(
                        Value.newBuilder()
                            .setStringValue("There are 14 kisses in Jane Austen's novels.")
                            .build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("55").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain").build())
                    .addValues(Value.newBuilder().setStringValue("75").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain loved cats.").build())
                    .build())
            .build();

    deIdentifyTableInfoTypes(projectId, tableToDeIdentify);
  }

  public static Table deIdentifyTableInfoTypes(String projectId, Table tableToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to de-identify.
      ContentItem contentItem = ContentItem.newBuilder().setTable(tableToDeIdentify).build();

      // Specify how the content should be de-identified.
      // Select type of info to be replaced.
      InfoType infoType = InfoType.newBuilder().setName("PERSON_NAME").build();
      // Specify that findings should be replaced with corresponding info type name.
      ReplaceWithInfoTypeConfig replaceWithInfoTypeConfig =
          ReplaceWithInfoTypeConfig.getDefaultInstance();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(replaceWithInfoTypeConfig)
              .build();
      // Associate info type with the replacement strategy
      InfoTypeTransformation infoTypeTransformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      InfoTypeTransformations infoTypeTransformations =
          InfoTypeTransformations.newBuilder().addTransformations(infoTypeTransformation).build();

      // Specify fields to be de-identified.
      List&lt;FieldId&gt; fieldIds =
          Stream.of("PATIENT", "FACTOID")
              .map(id -&gt; FieldId.newBuilder().setName(id).build())
              .collect(Collectors.toList());

      // Associate the de-identification and conditions with the specified field.
      FieldTransformation fieldTransformation =
          FieldTransformation.newBuilder()
              .setInfoTypeTransformations(infoTypeTransformations)
              .addAllFields(fieldIds)
              .build();
      RecordTransformations transformations =
          RecordTransformations.newBuilder().addFieldTransformations(fieldTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results.
      System.out.println("Table after de-identification: " + response.getItem().getTable());

      return response.getItem().getTable();
    }
  }
}</code></pre>
</div>
</section>
</div>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2Ftestff%22%2C%22resource%22%3A%7B%22deidentifyConfig%22%3A%7B%22recordTransformations%22%3A%7B%22fieldTransformations%22%3A%5B%7B%22infoTypeTransformations%22%3A%7B%22transformations%22%3A%5B%7B%22infoTypes%22%3A%5B%7B%22name%22%3A%22PERSON_NAME%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22replaceWithInfoTypeConfig%22%3A%7B%7D%7D%7D%5D%7D%2C%22fields%22%3A%5B%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22FACTOID%22%7D%5D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22AGE%22%7D%2C%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%2C%7B%22name%22%3A%22FACTOID%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22integerValue%22%3A%22101%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%22%7D%2C%7B%22integerValue%22%3A%2295%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%20name%20was%20a%20curse%2C%20possibly%20invented%20by%20Shakespeare.%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2225%22%7D%2C%7B%22stringValue%22%3A%22Jane%20Austen%22%7D%2C%7B%22integerValue%22%3A%2221%22%7D%2C%7B%22stringValue%22%3A%22There%20are%2014%20kisses%20in%20Jane%20Austen%27s%20novels.%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2255%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%22%7D%2C%7B%22integerValue%22%3A%2275%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%20loved%20cats.%22%7D%5D%7D%5D%7D%7D%7D%7D">APIs Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"deidentifyConfig":{
  "recordTransformations":{
    "fieldTransformations":[
      {
        "infoTypeTransformations":{
          "transformations":[
            {
              "infoTypes":[
                {
                  "name":"PERSON_NAME"
                }
              ],
              "primitiveTransformation":{
                "replaceWithInfoTypeConfig":{

                }
              }
            }
          ]
        },
        "fields":[
          {
            "name":"PATIENT"
          },
          {
            "name":"FACTOID"
          }
        ]
      }
    ]
  }
}
</code></pre>
<h2 data-text="Suppress a row based on the content of a column" id="suppress_a_row_based_on_the_content_of_a_column">Suppress a row based on the content of a column</h2>
<p>You can remove a row entirely based on the content that appears in any column.
This example suppresses the record for "Charles Dickens," as this patient is
over 89 years old.</p>
<table>
<tr>
<th>Input</th>
<th>Transformed table </th>
</tr>
<tr>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>95</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
</tr>
</table>
</td>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
</tr>
</table>
</td>
</tr>
</table>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deid-table-row-suppress-code-sample">
<section>
<h3 data-text="Java" id="dlp-deid-table-row-suppress-java" track-metadata-position="dlp-deid-table-row-suppress" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deid-table-row-suppress" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableRowSuppress.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableRowSuppress.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deid-table-row-suppress" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deid-table-row-suppress" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableRowSuppress.java" data-region-tag="dlp_deidentify_table_row_suppress" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableRowSuppress.java/HEAD/dlp_deidentify_table_row_suppress" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.RecordCondition;
import com.google.privacy.dlp.v2.RecordCondition.Condition;
import com.google.privacy.dlp.v2.RecordCondition.Conditions;
import com.google.privacy.dlp.v2.RecordCondition.Expressions;
import com.google.privacy.dlp.v2.RecordSuppression;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.RelationalOperator;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Table.Row;
import com.google.privacy.dlp.v2.Value;
import java.io.IOException;

public class DeIdentifyTableRowSuppress {

  public static void deIdentifyTableRowSuppress() throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Table tableToDeIdentify =
        Table.newBuilder()
            .addHeaders(FieldId.newBuilder().setName("AGE").build())
            .addHeaders(FieldId.newBuilder().setName("PATIENT").build())
            .addHeaders(FieldId.newBuilder().setName("HAPPINESS SCORE").build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("101").build())
                    .addValues(Value.newBuilder().setStringValue("Charles Dickens").build())
                    .addValues(Value.newBuilder().setStringValue("95").build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("22").build())
                    .addValues(Value.newBuilder().setStringValue("Jane Austen").build())
                    .addValues(Value.newBuilder().setStringValue("21").build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("55").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain").build())
                    .addValues(Value.newBuilder().setStringValue("75").build())
                    .build())
            .build();

    deIdentifyTableRowSuppress(projectId, tableToDeIdentify);
  }

  public static Table deIdentifyTableRowSuppress(String projectId, Table tableToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to de-identify.
      ContentItem contentItem = ContentItem.newBuilder().setTable(tableToDeIdentify).build();

      // Specify when the content should be de-identified.
      Condition condition =
          Condition.newBuilder()
              .setField(FieldId.newBuilder().setName("AGE").build())
              .setOperator(RelationalOperator.GREATER_THAN)
              .setValue(Value.newBuilder().setIntegerValue(89).build())
              .build();
      // Apply the condition to record suppression.
      RecordSuppression recordSuppressions =
          RecordSuppression.newBuilder()
              .setCondition(
                  RecordCondition.newBuilder()
                      .setExpressions(
                          Expressions.newBuilder()
                              .setConditions(
                                  Conditions.newBuilder().addConditions(condition).build())
                              .build())
                      .build())
              .build();
      // Use record suppression as the only transformation
      RecordTransformations transformations =
          RecordTransformations.newBuilder().addRecordSuppressions(recordSuppressions).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results.
      System.out.println("Table after de-identification: " + response.getItem().getTable());

      return response.getItem().getTable();
    }
  }
}</code></pre>
</div>
</section>
</div>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2Ftestff%22%2C%22resource%22%3A%7B%22deidentifyConfig%22%3A%7B%22recordTransformations%22%3A%7B%22recordSuppressions%22%3A%5B%7B%22condition%22%3A%7B%22expressions%22%3A%7B%22conditions%22%3A%7B%22conditions%22%3A%5B%7B%22field%22%3A%7B%22name%22%3A%22AGE%22%7D%2C%22operator%22%3A%22GREATER_THAN%22%2C%22value%22%3A%7B%22integerValue%22%3A%2289%22%7D%7D%5D%7D%7D%7D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22AGE%22%7D%2C%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22integerValue%22%3A%22101%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%22%7D%2C%7B%22integerValue%22%3A%2295%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2225%22%7D%2C%7B%22stringValue%22%3A%22Jane%20Austen%22%7D%2C%7B%22integerValue%22%3A%2221%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2255%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%22%7D%2C%7B%22integerValue%22%3A%2275%22%7D%5D%7D%5D%7D%7D%7D%7D">APIs Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"deidentifyConfig":{
  "recordTransformations":{
    "recordSuppressions":[
      {
        "condition":{
          "expressions":{
            "conditions":{
              "conditions":[
                {
                  "field":{
                    "name":"AGE"
                  },
                  "operator":"GREATER_THAN",
                  "value":{
                    "integerValue":"89"
                  }
                }
              ]
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<h2 data-text="Transform findings only when specific conditions are met on another field" id="transform_findings_only_when_specific_conditions_are_met_on_another_field">Transform findings only when specific conditions are met on another field</h2>
<p>In this example, the <code dir="ltr" translate="no">PERSON_NAME</code> findings are only redacted if the "AGE"
column indicates the patient is over the age of 89.</p>
<table>
<tr>
<th>Input</th>
<th>Transformed table </th>
</tr>
<tr>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
<th>FACTOID</th>
</tr>
<tr>
<td>101</td>
<td>Charles Dickens</td>
<td>95</td>
<td>Charles Dickens name was a curse, possibly invented by Shakespeare.</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
<td>There are 14 kisses in Jane Austen's novels.</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
<td>Mark Twain loved cats.</td>
</tr>
</table>
</td>
<td>
<table>
<tr>
<th>AGE</th>
<th>PATIENT</th>
<th>HAPPINESS SCORE</th>
<th>FACTOID</th>
</tr>
<tr>
<td>101</td>
<td>[PERSON_NAME]</td>
<td>95</td>
<td>[PERSON_NAME] name was a curse, possibly invented by [PERSON_NAME].</td>
</tr>
<tr>
<td>22</td>
<td>Jane Austen</td>
<td>21</td>
<td>There are 14 kisses in Jane Austen's novels.</td>
</tr>
<tr>
<td>55</td>
<td>Mark Twain</td>
<td>75</td>
<td>Mark Twain loved cats.</td>
</tr>
</table>
</td>
</tr>
</table>
<p><aside class="special"><strong>Important:</strong><span>
  The code on this page requires that you first set up a Cloud DLP client. For more
  information about installing and creating a Cloud DLP client, see
  <a href="/dlp/docs/reference/libraries">Cloud DLP client libraries</a>. (Sending JSON
  to Cloud DLP REST endpoints does not require a client
  library.)</span></aside></p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-deid-table-condition-infotypes-code-sample">
<section>
<h3 data-text="Java" id="dlp-deid-table-condition-infotypes-java" track-metadata-position="dlp-deid-table-condition-infotypes" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-deid-table-condition-infotypes" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionInfoTypes.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionInfoTypes.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-deid-table-condition-infotypes" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-deid-table-condition-infotypes" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionInfoTypes.java" data-region-tag="dlp_deidentify_table_condition_infotypes" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/DeIdentifyTableConditionInfoTypes.java/HEAD/dlp_deidentify_table_condition_infotypes" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.DeidentifyConfig;
import com.google.privacy.dlp.v2.DeidentifyContentRequest;
import com.google.privacy.dlp.v2.DeidentifyContentResponse;
import com.google.privacy.dlp.v2.FieldId;
import com.google.privacy.dlp.v2.FieldTransformation;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InfoTypeTransformations;
import com.google.privacy.dlp.v2.InfoTypeTransformations.InfoTypeTransformation;
import com.google.privacy.dlp.v2.LocationName;
import com.google.privacy.dlp.v2.PrimitiveTransformation;
import com.google.privacy.dlp.v2.RecordCondition;
import com.google.privacy.dlp.v2.RecordCondition.Condition;
import com.google.privacy.dlp.v2.RecordCondition.Conditions;
import com.google.privacy.dlp.v2.RecordCondition.Expressions;
import com.google.privacy.dlp.v2.RecordTransformations;
import com.google.privacy.dlp.v2.RelationalOperator;
import com.google.privacy.dlp.v2.ReplaceWithInfoTypeConfig;
import com.google.privacy.dlp.v2.Table;
import com.google.privacy.dlp.v2.Table.Row;
import com.google.privacy.dlp.v2.Value;
import java.io.IOException;
import java.util.List;
import java.util.stream.Collectors;
import java.util.stream.Stream;

public class DeIdentifyTableConditionInfoTypes {

  public static void deIdentifyTableConditionInfoTypes() throws IOException {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    Table tableToDeIdentify =
        Table.newBuilder()
            .addHeaders(FieldId.newBuilder().setName("AGE").build())
            .addHeaders(FieldId.newBuilder().setName("PATIENT").build())
            .addHeaders(FieldId.newBuilder().setName("HAPPINESS SCORE").build())
            .addHeaders(FieldId.newBuilder().setName("FACTOID").build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("101").build())
                    .addValues(Value.newBuilder().setStringValue("Charles Dickens").build())
                    .addValues(Value.newBuilder().setStringValue("95").build())
                    .addValues(
                        Value.newBuilder()
                            .setStringValue(
                                "Charles Dickens name was a curse invented by Shakespeare.")
                            .build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("22").build())
                    .addValues(Value.newBuilder().setStringValue("Jane Austen").build())
                    .addValues(Value.newBuilder().setStringValue("21").build())
                    .addValues(
                        Value.newBuilder()
                            .setStringValue("There are 14 kisses in Jane Austen's novels.")
                            .build())
                    .build())
            .addRows(
                Row.newBuilder()
                    .addValues(Value.newBuilder().setStringValue("55").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain").build())
                    .addValues(Value.newBuilder().setStringValue("75").build())
                    .addValues(Value.newBuilder().setStringValue("Mark Twain loved cats.").build())
                    .build())
            .build();

    deIdentifyTableConditionInfoTypes(projectId, tableToDeIdentify);
  }

  public static Table deIdentifyTableConditionInfoTypes(String projectId, Table tableToDeIdentify)
      throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify what content you want the service to de-identify.
      ContentItem contentItem = ContentItem.newBuilder().setTable(tableToDeIdentify).build();

      // Specify how the content should be de-identified.
      // Select type of info to be replaced.
      InfoType infoType = InfoType.newBuilder().setName("PERSON_NAME").build();
      // Specify that findings should be replaced with corresponding info type name.
      ReplaceWithInfoTypeConfig replaceWithInfoTypeConfig =
          ReplaceWithInfoTypeConfig.getDefaultInstance();
      PrimitiveTransformation primitiveTransformation =
          PrimitiveTransformation.newBuilder()
              .setReplaceWithInfoTypeConfig(replaceWithInfoTypeConfig)
              .build();
      // Associate info type with the replacement strategy
      InfoTypeTransformation infoTypeTransformation =
          InfoTypeTransformation.newBuilder()
              .addInfoTypes(infoType)
              .setPrimitiveTransformation(primitiveTransformation)
              .build();
      InfoTypeTransformations infoTypeTransformations =
          InfoTypeTransformations.newBuilder().addTransformations(infoTypeTransformation).build();

      // Specify fields to be de-identified.
      List&lt;FieldId&gt; fieldIds =
          Stream.of("PATIENT", "FACTOID")
              .map(id -&gt; FieldId.newBuilder().setName(id).build())
              .collect(Collectors.toList());

      // Specify when the above fields should be de-identified.
      Condition condition =
          Condition.newBuilder()
              .setField(FieldId.newBuilder().setName("AGE").build())
              .setOperator(RelationalOperator.GREATER_THAN)
              .setValue(Value.newBuilder().setIntegerValue(89).build())
              .build();
      // Apply the condition to records
      RecordCondition recordCondition =
          RecordCondition.newBuilder()
              .setExpressions(
                  Expressions.newBuilder()
                      .setConditions(Conditions.newBuilder().addConditions(condition).build())
                      .build())
              .build();

      // Associate the de-identification and conditions with the specified fields.
      FieldTransformation fieldTransformation =
          FieldTransformation.newBuilder()
              .setInfoTypeTransformations(infoTypeTransformations)
              .addAllFields(fieldIds)
              .setCondition(recordCondition)
              .build();
      RecordTransformations transformations =
          RecordTransformations.newBuilder().addFieldTransformations(fieldTransformation).build();

      DeidentifyConfig deidentifyConfig =
          DeidentifyConfig.newBuilder().setRecordTransformations(transformations).build();

      // Combine configurations into a request for the service.
      DeidentifyContentRequest request =
          DeidentifyContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(contentItem)
              .setDeidentifyConfig(deidentifyConfig)
              .build();

      // Send the request and receive response from the service.
      DeidentifyContentResponse response = dlp.deidentifyContent(request);

      // Print the results.
      System.out.println("Table after de-identification: " + response.getItem().getTable());

      return response.getItem().getTable();
    }
  }
}</code></pre>
</div>
</section>
</div>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2Ftestff%22%2C%22resource%22%3A%7B%22deidentifyConfig%22%3A%7B%22recordTransformations%22%3A%7B%22fieldTransformations%22%3A%5B%7B%22infoTypeTransformations%22%3A%7B%22transformations%22%3A%5B%7B%22infoTypes%22%3A%5B%7B%22name%22%3A%22PERSON_NAME%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22replaceWithInfoTypeConfig%22%3A%7B%7D%7D%7D%5D%7D%2C%22fields%22%3A%5B%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22FACTOID%22%7D%5D%2C%22condition%22%3A%7B%22expressions%22%3A%7B%22conditions%22%3A%7B%22conditions%22%3A%5B%7B%22field%22%3A%7B%22name%22%3A%22AGE%22%7D%2C%22operator%22%3A%22GREATER_THAN%22%2C%22value%22%3A%7B%22integerValue%22%3A%2289%22%7D%7D%5D%7D%7D%7D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22AGE%22%7D%2C%7B%22name%22%3A%22PATIENT%22%7D%2C%7B%22name%22%3A%22HAPPINESS%20SCORE%22%7D%2C%7B%22name%22%3A%22FACTOID%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22integerValue%22%3A%22101%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%22%7D%2C%7B%22integerValue%22%3A%2295%22%7D%2C%7B%22stringValue%22%3A%22Charles%20Dickens%20name%20was%20a%20curse%2C%20possibly%20invented%20by%20Shakespeare.%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2225%22%7D%2C%7B%22stringValue%22%3A%22Jane%20Austen%22%7D%2C%7B%22integerValue%22%3A%2221%22%7D%2C%7B%22stringValue%22%3A%22There%20are%2014%20kisses%20in%20Jane%20Austen%27s%20novels.%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22integerValue%22%3A%2255%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%22%7D%2C%7B%22integerValue%22%3A%2275%22%7D%2C%7B%22stringValue%22%3A%22Mark%20Twain%20loved%20cats.%22%7D%5D%7D%5D%7D%7D%7D%7D">APIs Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"deidentifyConfig":{
  "recordTransformations":{
    "fieldTransformations":[
      {
        "infoTypeTransformations":{
          "transformations":[
            {
              "infoTypes":[
                {
                  "name":"PERSON_NAME"
                }
              ],
              "primitiveTransformation":{
                "replaceWithInfoTypeConfig":{

                }
              }
            }
          ]
        },
        "fields":[
          {
            "name":"PATIENT"
          },
          {
            "name":"FACTOID"
          }
        ],
        "condition":{
          "expressions":{
            "conditions":{
              "conditions":[
                {
                  "field":{
                    "name":"AGE"
                  },
                  "operator":"GREATER_THAN",
                  "value":{
                    "integerValue":"89"
                  }
                }
              ]
            }
          }
        }
      }
    ]
  }
}
</code></pre>
<h2 data-text="Transform findings using a cryptographic hash transformation" id="transform_findings_using_a_cryptographic_hash_transformation">Transform findings using a cryptographic hash transformation</h2>
<p>The following JSON examples use <a href="/dlp/docs/deidentify-sensitive-data#infotype_transformations">infoType
transformations</a>
to instruct the DLP API to inspect the entire table structure
for specific <a href="/dlp/docs/concepts-infotypes">infoTypes</a>, and then to encrypt the matching
values using a <a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#DeidentifyTemplate.TransientCryptoKey">transient
<code dir="ltr" translate="no">CryptoKey</code></a>.</p>
<aside class="note"><strong>Note:</strong><span> For simplicity, this example uses a transient key, which is generated
for the transformation and then discarded. The scope of this key is a single
API call. To keep integrity of hashes or other tokenization methods across
API calls, you could also use other kinds of
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#cryptokey"><code dir="ltr" translate="no">CryptoKey</code></a>s,
though using a raw
<a href="/dlp/docs/reference/rest/v2/organizations.deidentifyTemplates#unwrappedcryptokey"><code dir="ltr" translate="no">UnwrappedCryptoKey</code></a>
is less secure and not recommended.</span></aside>
<p>The following example demonstrates de-identifying two infoTypes using a
cryptographic hash transformation.</p>
<p><strong>Input:</strong></p>
<table>
<tr>
<th>userid</th>
<th>comments</th>
</tr>
<tr>
<td>user1@example.org</td>
<td>my email is user1@example.org and phone is 858-555-0222</td>
</tr>
<tr>
<td>user2@example.org</td>
<td>my email is user2@example.org and phone is 858-555-0223</td>
</tr>
<tr>
<td>user3@example.org</td>
<td>my email is user3@example.org and phone is 858-555-0224</td>
</tr>
</table>
<p><strong>Transformed table:</strong></p>
<table>
<tr>
<th>userid</th>
<th>comments</th>
</tr>
<tr>
<td>1kSfj3Op64MH1BiznupEpX0BdQrHMm62X6abgsPH5zM=</td>
<td>my email is 1kSfj3Op64MH1BiznupEpX0BdQrHMm62X6abgsPH5zM= and phone is hYXPcsJNBCe1rr51sHiVw2KhtoyMe4HEFKNHWFcDVm0=</td>
</tr>
<tr>
<td>4ESy7+rEN8NVaUJ6J7kwvcgW8wcm0cm5gbBAcu6SfdM=</td>
<td>my email is 4ESy7+rEN8NVaUJ6J7kwvcgW8wcm0cm5gbBAcu6SfdM= and phone is KKqW1tQwgvGiC6iWJHhLiz2enNSEFRzhmLOf9fSTxRw=</td>
</tr>
<tr>
<td>bu1blyd/mbjLmpF2Rdi6zpgsLatSwpJLVki2fMeudM0=</td>
<td>my email is bu1blyd/mbjLmpF2Rdi6zpgsLatSwpJLVki2fMeudM0= and phone is eNt7qtZVLmxRb8z8NBR/+z00In07CI3hEMStbwofWoc=</td>
</tr>
</table>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2F%5BPROJECT-ID%5D%22%2C%22resource%22%3A%7B%22inspectConfig%22%3A%7B%22infoTypes%22%3A%5B%7B%22name%22%3A%22EMAIL_ADDRESS%22%7D%2C%7B%22name%22%3A%22PHONE_NUMBER%22%7D%5D%7D%2C%22deidentifyConfig%22%3A%7B%22infoTypeTransformations%22%3A%7B%22transformations%22%3A%5B%7B%22infoTypes%22%3A%5B%7B%22name%22%3A%22EMAIL_ADDRESS%22%7D%2C%7B%22name%22%3A%22PHONE_NUMBER%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22cryptoHashConfig%22%3A%7B%22cryptoKey%22%3A%7B%22transient%22%3A%7B%22name%22%3A%22%5BTRANSIENT-CRYPTO-KEY%5D%22%7D%7D%7D%7D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22userid%22%7D%2C%7B%22name%22%3A%22comments%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22stringValue%22%3A%22abby_abernathy%40example.org%22%7D%2C%7B%22stringValue%22%3A%22my%20email%20is%20abby_abernathy%40example.org%20and%20phone%20is%20858-555-0222%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22stringValue%22%3A%22bert_beauregard%40example.org%22%7D%2C%7B%22stringValue%22%3A%22my%20email%20is%20bert_beauregard%40example.org%20and%20phone%20is%20858-555-0223%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22stringValue%22%3A%22cathy_crenshaw%40example.org%22%7D%2C%7B%22stringValue%22%3A%22my%20email%20is%20cathy_crenshaw%40example.org%20and%20phone%20is%20858-555-0224%22%7D%5D%7D%5D%7D%7D%7D%7D">APIs Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      },
      {
        "name":"PHONE_NUMBER"
      }
    ]
  },
  "deidentifyConfig":{
    "infoTypeTransformations":{
      "transformations":[
        {
          "infoTypes":[
            {
              "name":"EMAIL_ADDRESS"
            },
            {
              "name":"PHONE_NUMBER"
            }
          ],
          "primitiveTransformation":{
            "cryptoHashConfig":{
              "cryptoKey":{
                "transient":{
                  "name":"[TRANSIENT-CRYPTO-KEY]"
                }
              }
            }
          }
        }
      ]
    }
  },
  "item":{
    "table":{
      "headers":[
        {
          "name":"userid"
        },
        {
          "name":"comments"
        }
      ],
      "rows":[
        {
          "values":[
            {
              "stringValue":"abby_abernathy@example.org"
            },
            {
              "stringValue":"my email is abby_abernathy@example.org and phone is 858-555-0222"
            }
          ]
        },
        {
          "values":[
            {
              "stringValue":"bert_beauregard@example.org"
            },
            {
              "stringValue":"my email is bert_beauregard@example.org and phone is 858-555-0223"
            }
          ]
        },
        {
          "values":[
            {
              "stringValue":"cathy_crenshaw@example.org"
            },
            {
              "stringValue":"my email is cathy_crenshaw@example.org and phone is 858-555-0224"
            }
          ]
        }
      ]
    }
  }
}
</code></pre>
<h2 data-text="Transform findings using two separate cryptographic hash transformations" id="transform_findings_using_two_separate_cryptographic_hash_transformations">Transform findings using two separate cryptographic hash transformations</h2>
<p>This example demonstrates how you can use different cryptographic keys in
different transformations within a single de-identification configuration.
First, a field transformation on the "userid" field is declared. That
transformation does not include any infoType transformations, so the "userid"
field in each row is transformed, regardless of its data type. Then, another
field transformation is declared, this one on the "comments" field.</p>
<p><strong>Input:</strong></p>
<table>
<tr>
<th>userid</th>
<th>comments</th>
</tr>
<tr>
<td>user1@example.org</td>
<td>my email is user1@example.org and phone is 858-555-0222</td>
</tr>
<tr>
<td>abbyabernathy1</td>
<td>my userid is abbyabernathy1 and my email is aabernathy@example.com</td>
</tr>
</table>
<p><strong>Transformed table:</strong></p>
<table>
<tr>
<th>userid</th>
<th>comments</th>
</tr>
<tr>
<td>5WvS4+aJtCCwWWG79cmRNamDgyvJ+CkuwNpA2gaR1VQ=</td>
<td>my email is vjqGLaA6+NUUnZAWXpI72lU1GfwQdOKu7XqWaJPcvQQ= and phone is BY+mSXXTu6mOoX5pr0Xbse60uelsSHmwRCq6HcscKtk=</td>
</tr>
<tr>
<td>t0dOmHvkT0VsM++SVmESVKHenLkmhBmFezH3hSDldDg=</td>
<td>my userid is abbyabernathy1 and my email is TQ3ancdUn9zgwO5qe6ahkmVrBuNhvlMknxjPjIt0N2w=</td>
</tr>
</table>
<p><a class="button button-primary" href="https://cloud.google.com/dlp/docs/reference/rest/v2/projects.content/deidentify?apix=true&amp;apix_params=%7B%22parent%22%3A%22projects%2F%5BPROJECT-ID%5D%22%2C%22resource%22%3A%7B%22inspectConfig%22%3A%7B%22infoTypes%22%3A%5B%7B%22name%22%3A%22EMAIL_ADDRESS%22%7D%2C%7B%22name%22%3A%22PHONE_NUMBER%22%7D%5D%7D%2C%22deidentifyConfig%22%3A%7B%22recordTransformations%22%3A%7B%22fieldTransformations%22%3A%5B%7B%22fields%22%3A%5B%7B%22name%22%3A%22userid%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22cryptoHashConfig%22%3A%7B%22cryptoKey%22%3A%7B%22transient%22%3A%7B%22name%22%3A%22%5BTRANSIENT-CRYPTO-KEY-1%5D%22%7D%7D%7D%7D%7D%2C%7B%22fields%22%3A%5B%7B%22name%22%3A%22comments%22%7D%5D%2C%22infoTypeTransformations%22%3A%7B%22transformations%22%3A%5B%7B%22infoTypes%22%3A%5B%7B%22name%22%3A%22PHONE_NUMBER%22%7D%2C%7B%22name%22%3A%22EMAIL_ADDRESS%22%7D%5D%2C%22primitiveTransformation%22%3A%7B%22cryptoHashConfig%22%3A%7B%22cryptoKey%22%3A%7B%22transient%22%3A%7B%22name%22%3A%22%5BTRANSIENT-CRYPTO-KEY-2%5D%22%7D%7D%7D%7D%7D%5D%7D%7D%5D%7D%7D%2C%22item%22%3A%7B%22table%22%3A%7B%22headers%22%3A%5B%7B%22name%22%3A%22userid%22%7D%2C%7B%22name%22%3A%22comments%22%7D%5D%2C%22rows%22%3A%5B%7B%22values%22%3A%5B%7B%22stringValue%22%3A%22user1%40example.org%22%7D%2C%7B%22stringValue%22%3A%22my%20email%20is%20user1%40example.org%20and%20phone%20is%20858-333-2222%22%7D%5D%7D%2C%7B%22values%22%3A%5B%7B%22stringValue%22%3A%22abbyabernathy1%22%7D%2C%7B%22stringValue%22%3A%22my%20userid%20is%20abbyabernathy1%20and%20my%20email%20is%20aabernathy%40example.com%22%7D%5D%7D%5D%7D%7D%7D%7D">APIs Explorer example</a></p>
<aside class="note"><strong>Tip:</strong> To run the example in APIs Explorer,
  uncheck <strong>Google OAuth 2.0</strong>.</aside>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "inspectConfig":{
    "infoTypes":[
      {
        "name":"EMAIL_ADDRESS"
      },
      {
        "name":"PHONE_NUMBER"
      }
    ]
  },
  "deidentifyConfig":{
    "recordTransformations":{
      "fieldTransformations":[
        {
          "fields":[
            {
              "name":"userid"
            }
          ],
          "primitiveTransformation":{
            "cryptoHashConfig":{
              "cryptoKey":{
                "transient":{
                  "name":"[TRANSIENT-CRYPTO-KEY-1]"
                }
              }
            }
          }
        },
        {
          "fields":[
            {
              "name":"comments"
            }
          ],
          "infoTypeTransformations":{
            "transformations":[
              {
                "infoTypes":[
                  {
                    "name":"PHONE_NUMBER"
                  },
                  {
                    "name":"EMAIL_ADDRESS"
                  }
                ],
                "primitiveTransformation":{
                  "cryptoHashConfig":{
                    "cryptoKey":{
                      "transient":{
                        "name":"[TRANSIENT-CRYPTO-KEY-2]"
                      }
                    }
                  }
                }
              }
            ]
          }
        }
      ]
    }
  },
  "item":{
    "table":{
      "headers":[
        {
          "name":"userid"
        },
        {
          "name":"comments"
        }
      ],
      "rows":[
        {
          "values":[
            {
              "stringValue":"user1@example.org"
            },
            {
              "stringValue":"my email is user1@example.org and phone is 858-333-2222"
            }
          ]
        },
        {
          "values":[
            {
              "stringValue":"abbyabernathy1"
            },
            {
              "stringValue":"my userid is abbyabernathy1 and my email is aabernathy@example.com"
            }
          ]
        }
      ]
    }
  }
}
</code></pre>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/querying-findings]</H1></p><div class="devsite-article-body clearfix">
<p>When your findings are transferred to BigQuery, the data is
written to either a new or existing table. For more information about actions,
see the <a href="/dlp/docs/concepts-actions">Actions</a> conceptual topic.</p>
<h2 data-text="Sample queries" id="sample_queries">Sample queries</h2>
<p>You can use the following sample queries to analyze your findings. You can
also use the queries in a visualization tool such as
<a href="https://www.google.com/analytics/data-studio/">Google Data Studio</a>. These
queries are provided to help you get started querying your findings data.</p>
<p>In each of the following queries, replace <code dir="ltr" translate="no">[DATASET]</code> with the
BigQuery dataset name, <code dir="ltr" translate="no">[TABLE_ID]</code> with the table ID, and
<code dir="ltr" translate="no">[PROJECT_ID]</code> with the project identifier.</p>
<h3 data-text="Select the count of each infoType" id="select_the_count_of_each_infotype">Select the count of each infoType</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT info_type.name,
COUNT(info_type.name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
GROUP BY info_type.name
ORDER BY count DESC;
</pre></section>
<section><h3 data-text=" Command-line " id="command-line"> Command-line </h3><pre class="lang-sh prettyprint" dir="ltr" translate="no">
bq query --use_legacy_sql=false ' SELECT info_type.name,
COUNT(info_type.name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
GROUP BY info_type.name ORDER BY count DESC;'
</pre></section>
</div>
<h3 data-text="Select the count of each infoType by day" id="select_the_count_of_each_infotype_by_day">Select the count of each infoType by day</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_1"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT info_type.name, cast(TIMESTAMP_SECONDS(create_time.seconds) as date) as day,
COUNT(locations.container_name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY info_type.name, day
ORDER BY count DESC;
</pre></section>
<section><h3 data-text=" Command-line " id="command-line_1"> Command-line </h3><pre class="lang-sh prettyprint" dir="ltr" translate="no">
bq query --use_legacy_sql=false ' SELECT info_type.name,
cast(TIMESTAMP_SECONDS(create_time.seconds) as date) as day,
COUNT(locations.container_name) AS count FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY info_type.name, day ORDER BY count DESC;'
</pre></section>
</div>
<h3 data-text="Selects the count of each infoType in each container" id="selects_the_count_of_each_infotype_in_each_container">Selects the count of each infoType in each container</h3>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_2"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT info_type.name, locations.container_name,
COUNT(locations.container_name) AS count
FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY locations.container_name, info_type.name
ORDER BY count DESC;
</pre></section>
<section><h3 data-text=" Command-line " id="command-line_2"> Command-line </h3><pre class="lang-sh prettyprint" dir="ltr" translate="no">
bq query --use_legacy_sql=false ' SELECT info_type.name, locations.container_name,
COUNT(locations.container_name) AS count FROM [PROJECT_ID].[DATASET].[TABLE_ID],
UNNEST(location.content_locations) AS locations
GROUP BY locations.container_name,info_type.name ORDER BY count DESC;'
</pre></section>
</div>
<h3 data-text="Selects the finding types found for each column of a table" id="selects_the_finding_types_found_for_each_column_of_a_table">Selects the finding types found for each column of a table</h3>
<p>This query will group all the findings by column name and is intended to work
on findings from a BigQuery inspection job, useful if you are trying to identify
the likely types for a given column. You can adjust settings by modifying
the WHERE and HAVING clauses. For example, if multiple table results are
included in your findings table, you can limit these to just one job run or one table name.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text=" Cloud console " id="cloud-console_3"> Cloud console </h3><pre class="lang-sql prettyprint" dir="ltr" translate="no">
SELECT
  table_counts.field_name,
  STRING_AGG( CONCAT(" ",table_counts.name," [count: ",CAST(table_counts.count_total AS String),"]")
  ORDER BY
    table_counts.count_total DESC) AS infoTypes
FROM (
  SELECT
    locations.record_location.field_id.name AS field_name,
    info_type.name,
    COUNT(*) AS count_total
  FROM
    [PROJECT_ID].[DATASET].[TABLE_ID],
    UNNEST(location.content_locations) AS locations
  WHERE
    (likelihood = 'LIKELY'
      OR likelihood = 'VERY_LIKELY'
      OR likelihood = 'POSSIBLE')
  GROUP BY
    locations.record_location.field_id.name,
    info_type.name
  HAVING
    count_total&gt;200 ) AS table_counts
GROUP BY
  table_counts.field_name
ORDER BY
  table_counts.field_name
</pre></section>
</div>
<p>The above query might produce a result like this for a sample table, where
  the infoTypes column tells us how many instances of each infoType was found
  for that given column.</p>
<table>
<tr>
<th>field_name</th>
<th>infoTypes</th>
</tr>
<tr>
<td><code dir="ltr" translate="no">field1</code></td>
<td><code dir="ltr" translate="no">CUSTOM_USER_US [count: 7004]</code>,  <code dir="ltr" translate="no">CUSTOM_USER_EU [count: 2996]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field2</code></td>
<td><code dir="ltr" translate="no">US_VEHICLE_IDENTIFICATION_NUMBER [count: 9597]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field3</code></td>
<td><code dir="ltr" translate="no">EMAIL_ADDRESS [count: 10000]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field4</code></td>
<td><code dir="ltr" translate="no">IP_ADDRESS [count: 10000]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field5</code></td>
<td><code dir="ltr" translate="no">PHONE_NUMBER [count: 7815]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field6</code></td>
<td><code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER [count: 10000]</code></td>
</tr>
<tr>
<td><code dir="ltr" translate="no">field7</code></td>
<td><code dir="ltr" translate="no">CREDIT_CARD_NUMBER [count: 10000]</code></td>
</tr>
</table>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/iam-roles]</H1></p><div class="devsite-article-body clearfix">
<meta name="project_path" value="/dlp/docs/_project.yaml">
<meta name="book_path" value="/dlp/_book.yaml">
<p>This topic describes the Identity and Access Management (IAM) roles required to
configure Cloud Data Loss Prevention. Roles limit an authenticated identity's ability to
access resources. Only grant an identity the permissions it needs in order to
interact with applicable Google Cloud APIs, features, or resources.</p>
<h2 data-text="Standard roles" id="standard-roles">Standard roles</h2>
<p>The following table describes Identity and Access Management roles that are associated with
Cloud DLP, and lists permissions that are contained in each role.</p>
<div id="dlp">
<table>
<thead>
<tr>
<th width="60%">Role</th>
<th>Permissions</th>
</tr>
</thead>
<tbody>
<tr id="dlp.admin">
<td>
<p><strong class="role-title">DLP Administrator</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.admin</code>)</p>
<span class="role-description">
<p>
Administer DLP including jobs and templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">serviceusage.services.use</li>
</ul>
</td>
</tr>
<tr id="dlp.analyzeRiskTemplatesEditor">
<td>
<p><strong class="role-title">DLP Analyze Risk Templates Editor</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.analyzeRiskTemplatesEditor</code>)</p>
<span class="role-description">
<p>
Edit DLP analyze risk templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.analyzeRiskTemplates.*</li>
</ul>
</td>
</tr>
<tr id="dlp.analyzeRiskTemplatesReader">
<td>
<p><strong class="role-title">DLP Analyze Risk Templates Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.analyzeRiskTemplatesReader</code>)</p>
<span class="role-description">
<p>
Read DLP analyze risk templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.analyzeRiskTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.analyzeRiskTemplates.list</li>
</ul>
</td>
</tr>
<tr id="dlp.columnDataProfilesReader">
<td>
<p><strong class="role-title">DLP Column Data Profiles Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.columnDataProfilesReader</code>)</p>
<span class="role-description">
<p>
Read DLP column profiles.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.columnDataProfiles.*</li>
</ul>
</td>
</tr>
<tr id="dlp.dataProfilesReader">
<td>
<p><strong class="role-title">DLP Data Profiles Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.dataProfilesReader</code>)</p>
<span class="role-description">
<p>
Read DLP profiles.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.columnDataProfiles.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.projectDataProfiles.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.tableDataProfiles.*</li>
</ul>
</td>
</tr>
<tr id="dlp.deidentifyTemplatesEditor">
<td>
<p><strong class="role-title">DLP De-identify Templates Editor</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.deidentifyTemplatesEditor</code>)</p>
<span class="role-description">
<p>
Edit DLP de-identify templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.deidentifyTemplates.*</li>
</ul>
</td>
</tr>
<tr id="dlp.deidentifyTemplatesReader">
<td>
<p><strong class="role-title">DLP De-identify Templates Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.deidentifyTemplatesReader</code>)</p>
<span class="role-description">
<p>
Read DLP de-identify templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.deidentifyTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.deidentifyTemplates.list</li>
</ul>
</td>
</tr>
<tr id="dlp.estimatesAdmin">
<td>
<p><strong class="role-title">DLP Cost Estimation</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.estimatesAdmin</code>)</p>
<span class="role-description">
<p>
Manage DLP Cost Estimates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.estimates.*</li>
</ul>
</td>
</tr>
<tr id="dlp.inspectFindingsReader">
<td>
<p><strong class="role-title">DLP Inspect Findings Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.inspectFindingsReader</code>)</p>
<span class="role-description">
<p>
Read DLP stored findings.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectFindings.*</li>
</ul>
</td>
</tr>
<tr id="dlp.inspectTemplatesEditor">
<td>
<p><strong class="role-title">DLP Inspect Templates Editor</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.inspectTemplatesEditor</code>)</p>
<span class="role-description">
<p>
Edit DLP inspect templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectTemplates.*</li>
</ul>
</td>
</tr>
<tr id="dlp.inspectTemplatesReader">
<td>
<p><strong class="role-title">DLP Inspect Templates Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.inspectTemplatesReader</code>)</p>
<span class="role-description">
<p>
Read DLP inspect templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectTemplates.list</li>
</ul>
</td>
</tr>
<tr id="dlp.jobTriggersEditor">
<td>
<p><strong class="role-title">DLP Job Triggers Editor</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.jobTriggersEditor</code>)</p>
<span class="role-description">
<p>
Edit job triggers configurations.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobTriggers.*</li>
</ul>
</td>
</tr>
<tr id="dlp.jobTriggersReader">
<td>
<p><strong class="role-title">DLP Job Triggers Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.jobTriggersReader</code>)</p>
<span class="role-description">
<p>
Read job triggers.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobTriggers.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobTriggers.list</li>
</ul>
</td>
</tr>
<tr id="dlp.jobsEditor">
<td>
<p><strong class="role-title">DLP Jobs Editor</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.jobsEditor</code>)</p>
<span class="role-description">
<p>
Edit and create jobs
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobs.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.kms.*</li>
</ul>
</td>
</tr>
<tr id="dlp.jobsReader">
<td>
<p><strong class="role-title">DLP Jobs Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.jobsReader</code>)</p>
<span class="role-description">
<p>
Read jobs
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobs.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobs.list</li>
</ul>
</td>
</tr>
<tr id="dlp.orgdriver">
<td>
<p><strong class="role-title">DLP Organization Data Profiles Driver</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.orgdriver</code>)</p>
<span class="role-description">
<p>
Permissions needed by the DLP service account to generate data profiles within an organization or folder.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.bireservations.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.capacityCommitments.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.capacityCommitments.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.config.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.connections.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.getIamPolicy</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.listAll</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.listExecutionMetadata</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.models.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.readsessions.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservationAssignments.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservationAssignments.search</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservations.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservations.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.routines.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.savedqueries.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.savedqueries.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.createIndex</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.createSnapshot</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.delete</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.deleteIndex</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.export</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.getData</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.getIamPolicy</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.restoreSnapshot</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.update</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.updateData</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.transfers.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquerymigration.translation.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">cloudasset.assets.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.categories.fineGrainedGet</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.entries.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.getTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.use</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">pubsub.topics.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">recommender.cloudAssetInsights.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">recommender.cloudAssetInsights.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">recommender.locations.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">resourcemanager.projects.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">resourcemanager.projects.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">serviceusage.services.use</li>
</ul>
</td>
</tr>
<tr id="dlp.projectDataProfilesReader">
<td>
<p><strong class="role-title">DLP Project Data Profiles Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.projectDataProfilesReader</code>)</p>
<span class="role-description">
<p>
Read DLP project profiles.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.projectDataProfiles.*</li>
</ul>
</td>
</tr>
<tr id="dlp.projectdriver">
<td>
<p><strong class="role-title">DLP Project Data Profiles Driver</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.projectdriver</code>)</p>
<span class="role-description">
<p>
Permissions needed by the DLP service account to generate data profiles within a project.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.bireservations.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.capacityCommitments.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.capacityCommitments.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.config.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.connections.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.getIamPolicy</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.datasets.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.listAll</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.jobs.listExecutionMetadata</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.models.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.readsessions.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservationAssignments.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservationAssignments.search</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservations.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.reservations.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.routines.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.savedqueries.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.savedqueries.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.createIndex</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.createSnapshot</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.delete</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.deleteIndex</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.export</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.getData</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.getIamPolicy</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.restoreSnapshot</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.update</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.updateData</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.tables.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquery.transfers.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">bigquerymigration.translation.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">cloudasset.assets.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.categories.fineGrainedGet</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.entries.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.create</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.getTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">datacatalog.tagTemplates.use</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">pubsub.topics.updateTag</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">recommender.cloudAssetInsights.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">recommender.cloudAssetInsights.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">recommender.locations.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">resourcemanager.projects.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">resourcemanager.projects.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">serviceusage.services.use</li>
</ul>
</td>
</tr>
<tr id="dlp.reader">
<td>
<p><strong class="role-title">DLP Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.reader</code>)</p>
<span class="role-description">
<p>
Read DLP entities, such as jobs and templates.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.analyzeRiskTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.analyzeRiskTemplates.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.deidentifyTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.deidentifyTemplates.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectFindings.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectTemplates.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.inspectTemplates.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobTriggers.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobTriggers.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobs.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.jobs.list</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.locations.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.storedInfoTypes.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.storedInfoTypes.list</li>
</ul>
</td>
</tr>
<tr id="dlp.storedInfoTypesEditor">
<td>
<p><strong class="role-title">DLP Stored InfoTypes Editor</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.storedInfoTypesEditor</code>)</p>
<span class="role-description">
<p>
Edit DLP stored info types.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.storedInfoTypes.*</li>
</ul>
</td>
</tr>
<tr id="dlp.storedInfoTypesReader">
<td>
<p><strong class="role-title">DLP Stored InfoTypes Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.storedInfoTypesReader</code>)</p>
<span class="role-description">
<p>
Read DLP stored info types.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.storedInfoTypes.get</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.storedInfoTypes.list</li>
</ul>
</td>
</tr>
<tr id="dlp.tableDataProfilesReader">
<td>
<p><strong class="role-title">DLP Table Data Profiles Reader</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.tableDataProfilesReader</code>)</p>
<span class="role-description">
<p>
Read DLP table profiles.
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.tableDataProfiles.*</li>
</ul>
</td>
</tr>
<tr id="dlp.user">
<td>
<p><strong class="role-title">DLP User</strong>
<br/>
(<code class="role-name" dir="ltr" translate="no">roles/<wbr/>dlp.user</code>)</p>
<span class="role-description">
<p>
Inspect, Redact, and De-identify Content
</p>
</span>
</td>
<td class="role-permissions">
<ul style="list-style:none;padding:0;">
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.kms.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">dlp.locations.*</li>
<li style="margin:0;padding-left:1em;text-indent:-1em;">serviceusage.services.use</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<h2 data-text="Custom roles" id="custom-roles">Custom roles</h2>
<p>If you want to define your own roles to contain bundles of permissions that
you specify, use <a href="/iam/docs/creating-custom-roles">custom roles</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</meta></meta></div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/iam-permissions]</H1></p><div class="devsite-article-body clearfix">
<meta name="project_path" value="/dlp/docs/_project.yaml">
<meta name="book_path" value="/dlp/_book.yaml">
<title>IAM permissions</title>
<h2 data-text="Common permissions" id="common-permissions">Common permissions</h2>
<p>Some methods do not have Cloud DLP-specific permissions. Instead,
they use common ones, as the methods can cause billable events, but do not
access any protected cloud resources.</p>
<p>All actions that trigger billable events such as the
<a href="/dlp/docs/reference/rest/v2/projects.content"><code dir="ltr" translate="no">projects.content</code></a>
methods require the <code dir="ltr" translate="no">serviceusage.services.use</code> permission for the project
that's specified in <code dir="ltr" translate="no">parent</code>. The <code dir="ltr" translate="no">roles/editor</code>, <code dir="ltr" translate="no">roles/owner</code>, and
<code dir="ltr" translate="no">roles/dlp.user</code> roles contain the required permission or you can define your
own <a href="/iam/docs/creating-custom-roles">custom roles</a> containing this permission.</p>
<p>This permission ensures you are authorized to bill the project you specify.</p>
<h2 data-text="Service account" id="service_account">Service account</h2>
<p>To access both Google Cloud resources and execute calls to
Cloud DLP,
Cloud DLP uses the credentials of the
Cloud Data Loss Prevention Service Agent to authenticate to other APIs. A
service agent is a special type of service account that runs internal Google
processes on your behalf. The service agent is identifiable using the email:</p>
<pre class="devsite-disable-click-to-copy" dir="ltr" translate="no">
service-<var translate="no">PROJECT_NUMBER</var>@dlp-api.iam.gserviceaccount.com
</pre>
<p>The Cloud Data Loss Prevention Service Agent is created the first time it is
needed. You can create it in advance by making a call to
<a href="/dlp/docs/reference/rest/v2/projects.content/inspect"><code dir="ltr" translate="no">InspectContent</code></a>:</p>
<pre class="prettyprint lang-sh" dir="ltr" suppresswarning="true" translate="no">curl --request POST \
  "https://dlp.googleapis.com/v2/projects/<var translate="no">PROJECT_ID</var>/locations/us-central1/content:inspect" \
  --header "X-Goog-User-Project: <var translate="no">PROJECT_ID</var>" \
  --header "Authorization: Bearer $(gcloud auth print-access-token)" \
  --header 'Accept: application/json' \
  --header 'Content-Type: application/json' \
  --data '{"item":{"value":"google@google.com"}}' \
  --compressed</pre>
<p>Replace <code dir="ltr" translate="no"><var translate="no">PROJECT_ID</var></code> with the <a href="/resource-manager/docs/creating-managing-projects#before_you_begin">project ID</a>.</p>
<p>The Cloud Data Loss Prevention Service Agent is automatically granted common
permissions on the project that are needed for inspecting resources and is
listed in the IAM section of the Google Cloud console. The service agent exists
indefinitely with the project and is only deleted when the project is deleted.
Cloud DLP relies on this service agent, so you should not remove
it.</p>
<aside class="note"><strong>Note:</strong><span> If you are using Cloud DLP to scan critical resources, such
as those protected by additional custom Identity and Access Management roles, you must assign
those additional IAM roles to the Cloud Data Loss Prevention
Service Agent. For example, if you want to use Cloud DLP to inspect
files in Google Cloud that are restricted to only a subset of individuals,
you must grant the appropriate role to the Cloud Data Loss Prevention Service
Agent.</span></aside><aside class="warning"><strong>Warning:</strong><span> If you remove the Cloud Data Loss Prevention Service Agent or revoke
its roles, all
<a href="/dlp/docs/reference/rest/v2/projects.dlpJobs">jobs</a> and
<a href="/dlp/docs/reference/rest/v2/projects.jobTriggers">job triggers</a>
will fail.</span></aside>
<p>For more information on how service accounts are used in data profiling
operations, see <a href="/dlp/docs/data-profiles#service-agent-container">Service agent container and service agent</a>.</p>
<h2 data-text="Job permissions" id="job_permissions">Job permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.jobs.create</code></td>
<td>Create new jobs.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobs.cancel</code></td>
<td>Cancel jobs.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobs.delete</code></td>
<td>Delete jobs.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobs.get</code></td>
<td>Read job objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobs.list</code></td>
<td>List jobs.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobs.hybridInspect</code></td>
<td>Make a hybrid inspect call on a hybrid job.</td>
</tr>
</tbody>
</table>
<h2 data-text="Job trigger permissions" id="job_trigger_permissions">Job trigger permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.jobTriggers.create</code></td>
<td>Create new job triggers.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobTriggers.delete</code></td>
<td>Delete job triggers.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobTriggers.get</code></td>
<td>Read job trigger objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobTriggers.list</code></td>
<td>List job triggers.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobTriggers.update</code></td>
<td>Update job triggers.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.jobTriggers.hybridInspect</code></td>
<td>Make a hybrid inspect call on a hybrid trigger.</td>
</tr>
</tbody>
</table>
<h2 data-text="Inspection template permissions" id="inspection_template_permissions">Inspection template permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.inspectTemplates.create</code></td>
<td>Create new inspection templates.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.inspectTemplates.delete</code></td>
<td>Delete inspection templates.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.inspectTemplates.get</code></td>
<td>Read inspection template objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.inspectTemplates.list</code></td>
<td>List inspection templates.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.inspectTemplates.update</code></td>
<td>Update inspection templates.</td>
</tr>
</tbody>
</table>
<h2 data-text="De-identification template permissions" id="de-identification_template_permissions">De-identification template permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.deidentifyTemplates.create</code></td>
<td>Create new de-identification templates.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.deidentifyTemplates.delete</code></td>
<td>Delete de-identification templates.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.deidentifyTemplates.get</code></td>
<td>Read de-identification template objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.deidentifyTemplates.list</code></td>
<td>List de-identification templates.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.deidentifyTemplates.update</code></td>
<td>Update de-identification templates.</td>
</tr>
</tbody>
</table>
<!-- ## Risk analysis template permissions

|Permission name|Description
| --- | ---
|`dlp.analyzeRiskTemplates.create`|Create new risk analysis templates.
|`dlp.analyzeRiskTemplates.delete`|Delete risk analysis templates.
|`dlp.analyzeRiskTemplates.get`|Read risk analysis template objects.
|`dlp.analyzeRiskTemplates.list`|List risk analysis templates.
|`dlp.analyzeRiskTemplates.update`|Update risk analysis templates.
 -->
<h2 data-text="Data profile permissions" id="data_profile_permissions">Data profile permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.projectDataProfiles.list</code></td>
<td>List project data profiles.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.projectDataProfiles.get</code></td>
<td>Read project data profile objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.tableDataProfiles.list</code></td>
<td>List table data profiles.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.tableDataProfiles.get</code></td>
<td>Read table data profile objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.columnDataProfiles.list</code></td>
<td>List column data profiles.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.columnDataProfiles.get</code></td>
<td>Read column data profile objects.</td>
</tr>
</tbody>
</table>
<h2 data-text="Estimate permissions" id="estimate_permissions">Estimate permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.estimates.get</code></td>
<td>Read estimate objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.estimates.list</code></td>
<td>List estimate objects.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.estimates.create</code></td>
<td>Create an estimate object.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.estimates.delete</code></td>
<td>Delete an estimate object.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.estimates.cancel</code></td>
<td>Cancel an ongoing estimation.</td>
</tr>
</tbody>
</table>
<h2 data-text="Stored infoType permissions" id="stored_infotype_permissions">Stored infoType permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.storedInfoTypes.create</code></td>
<td>Create new stored infotypes.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.storedInfoTypes.delete</code></td>
<td>Delete stored infotypes.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.storedInfoTypes.get</code></td>
<td>Read stored infotypes.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.storedInfoTypes.list</code></td>
<td>List stored infotypes.</td>
</tr>
<tr>
<td><code dir="ltr" translate="no">dlp.storedInfoTypes.update</code></td>
<td>Update stored infotypes.</td>
</tr>
</tbody>
</table>
<h2 data-text="Misc permissions" id="misc_permissions">Misc permissions</h2>
<table>
<thead>
<tr>
<th>Permission name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code dir="ltr" translate="no">dlp.kms.encrypt</code></td>
<td>De-identify content using encryption tokens persisted in Cloud KMS.</td>
</tr>
</tbody>
</table>
<devsite-hats-survey class="nocontent" hats-id="Nd7nTix2o0eU5NUYprb0ThtUc5jf" listnr-id="83405"></devsite-hats-survey>
</meta></meta></div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/audit-logging]</H1></p><div class="devsite-article-body clearfix">
<p>This document describes the audit logs created by Cloud Data Loss Prevention as part of
<a href="/logging/docs/audit">Cloud Audit Logs</a>.</p>
<h2 data-text="Overview" id="overview">Overview</h2>
<p>Google Cloud services write audit logs to help you answer the questions, "Who
did what, where, and when?" within your Google Cloud resources.</p>
<p>Your Google Cloud projects contain only the audit logs for resources that are
directly within the Cloud project. Other Google Cloud resources,
such as folders, organizations, and billing accounts, contain the audit logs for
the entity itself.</p>
<p>For a general overview of Cloud Audit Logs, see
<a href="/logging/docs/audit">Cloud Audit Logs overview</a>. For a deeper understanding of
the audit log format, see
<a href="/logging/docs/audit/understanding-audit-logs">Understand audit logs</a>.</p>
<h2 data-text="Available audit logs" id="available-logs">Available audit logs</h2>
<p>The following types of audit logs are available for Cloud DLP:</p>
<ul>
<li>
<p>
        Admin Activity audit logs
      </p>
<p>
        Includes "admin write" operations that write metadata or configuration
        information.
      </p>
<p>
        You can't disable Admin Activity audit logs.
      </p>
</li>
<li>
<p>
        Data Access audit logs
      </p>
<p>
        Includes "admin read" operations that read metadata or configuration
        information. Also includes "data read" and "data write" operations that
        read or write user-provided data.
      </p>
<p>
          To receive Data Access audit logs, you must
          <a href="/logging/docs/audit/configure-data-access#config-console-enable">
            explicitly enable</a> them.
        </p>
</li>
</ul>
<p>For fuller descriptions of the audit log types, see
<a href="/logging/docs/audit#types">Types of audit logs</a>.</p>
<h2 data-text="Audited operations" id="audited_operations">Audited operations</h2>
<p>The following summarizes which API operations correspond to each audit log
type in Cloud DLP:</p>
<p>
<table>
<thead>
<tr>
<th>Audit logs category</th>
<th>Cloud DLP operations</th>
</tr>
</thead>
<tbody>
<tr>
<td>Admin activity logs</td>
<td>CreateDeidentifyTemplate<br/>DeleteDeidentifyTemplate<br/>UpdateDeidentifyTemplate<br/>CreateInspectTemplate<br/>DeleteInspectTemplate<br/>UpdateInspectTemplate<br/>CreateJobTrigger<br/>DeleteJobTrigger<br/>UpdateJobTrigger</td>
</tr>
<tr>
<td>Data Access logs (ADMIN_READ)</td>
<td>GetDeidentifyTemplate<br/>ListDeidentifyTemplates<br/>GetInspectTemplate<br/>ListInspectTemplates<br/>GetJobTrigger<br/>ListJobTriggers</td>
</tr>
<tr>
<td>Data Access logs (DATA_READ)</td>
<td>GetDlpJob<br/>ListDlpJobs</td>
</tr>
<tr>
<td>Data Access logs (DATA_WRITE)</td>
<td>CancelDlpJob<br/>CreateDlpJob<br/>DeleteDlpJob</td>
</tr>
</tbody>
</table>
</p>
<h2 data-text="Audit log format" id="audit_log_format">Audit log format</h2>
<p>Audit log entries include the following objects:</p>
<ul>
<li><p>The log entry itself, which is an object of type <a href="/logging/docs/reference/v2/rest/v2/LogEntry"><code dir="ltr" translate="no">LogEntry</code></a>.
Useful fields include the following:</p>
<ul>
<li>The <code dir="ltr" translate="no">logName</code> contains the resource ID and audit log type.</li>
<li>The <code dir="ltr" translate="no">resource</code> contains the target of the audited operation.</li>
<li>The <code dir="ltr" translate="no">timeStamp</code> contains the time of the audited operation.</li>
<li>The <code dir="ltr" translate="no">protoPayload</code> contains the audited information.</li>
</ul></li>
<li><p>The audit logging data, which is an <a href="/logging/docs/reference/audit/auditlog/rest/Shared.Types/AuditLog"><code dir="ltr" translate="no">AuditLog</code></a> object held in
the <code dir="ltr" translate="no">protoPayload</code> field of the log entry.</p></li>
<li><p>Optional service-specific audit information, which is a service-specific
object. For earlier integrations, this object is held in the <code dir="ltr" translate="no">serviceData</code>
field of the <code dir="ltr" translate="no">AuditLog</code> object; later integrations use the <code dir="ltr" translate="no">metadata</code> field.</p></li>
</ul>
<p>For other fields in these objects, and how to interpret them, review
<a href="/logging/docs/audit/understanding-audit-logs">Understand audit logs</a>.</p>
<h3 data-text="Log name" id="log_name">Log name</h3>
<p>Cloud Audit Logs log names include resource identifiers indicating the
Cloud project or other Google Cloud entity that owns the audit
logs, and whether the log contains Admin Activity, Data Access, Policy Denied,
or System Event audit logging data.</p>
<p>The following are the audit log names, including variables for the resource
identifiers:</p>
<pre class="devsite-click-to-copy" dir="ltr" lang-sql="" translate="no">
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy

   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy

   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy

   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Factivity
   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Fdata_access
   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Fsystem_event
   organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com%2Fpolicy
</pre>
<aside class="note"><strong>Note:</strong><span> The part of the log name following <code dir="ltr" translate="no">/logs/</code> must be URL-encoded. The
forward-slash character, <code dir="ltr" translate="no">/</code>, must be written as <code dir="ltr" translate="no">%2F</code>.</span></aside>
<h3 data-text="Service name" id="service_name">Service name</h3>
<p>
<p>Cloud DLP audit logs use the service name
<code dir="ltr" translate="no">dlp.googleapis.com</code>.</p>
</p>
<p>For a list of all the Cloud Logging API service names and their corresponding
monitored resource type, see
<a href="/logging/docs/api/v2/resource-list#service-names">Map services to resources</a>.</p>
<h3 data-text="Resource types" id="resource_types">Resource types</h3>
<p>
<p>Cloud DLP audit logs use
  the resource type <code dir="ltr" translate="no">audited_resource</code> for all
  audit logs, because many different types of
  resources can be monitored.</p>
</p>
<p>For a list of all the Cloud Logging monitored resource types and descriptive
information, see
<a href="/logging/docs/api/v2/resource-list#resource-types">Monitored resource types</a>.</p>
<h2 data-text="Enable audit logging" id="enabling_audit_logging">Enable audit logging</h2>
<p>Admin Activity audit logs are always enabled; you can't disable them.</p>
<p>Data Access audit logs are disabled by default and aren't written unless
explicitly enabled (the exception is Data Access audit logs for
BigQuery, which can't be disabled).</p>
<p>For information about enabling some or all of your Data Access audit logs, see
<a href="/logging/docs/audit/configure-data-access">Configure Data Access audit logs</a>.</p>
<h2 data-text="Permissions and roles" id="audit_log_permissions">Permissions and roles</h2>
<p><a href="/iam/docs">IAM</a> permissions and roles determine your ability to
access audit logs data in Google Cloud resources.</p>
<p>When deciding which
<a href="/logging/docs/access-control#permissions_and_roles">Logging-specific permissions and roles</a>
apply to your use case, consider the following:</p>
<ul>
<li><p>The Logs Viewer role (<code dir="ltr" translate="no">roles/logging.viewer</code>) gives you read-only access to
Admin Activity, Policy Denied, and System Event audit logs. If you have just
this role, you cannot view Data Access audit logs that are in the
<code dir="ltr" translate="no">_Required</code> and <code dir="ltr" translate="no">_Default</code> buckets.</p></li>
<li><p>The Private Logs Viewer role<code dir="ltr" translate="no">(roles/logging.privateLogViewer</code>) includes the
permissions contained in <code dir="ltr" translate="no">roles/logging.viewer</code>, plus the ability to read
Data Access audit logs in the <code dir="ltr" translate="no">_Required</code> and <code dir="ltr" translate="no">_Default</code> buckets.</p>
<p>Note that if these private logs are stored in user-defined buckets, then any
user who has permissions to read logs in those buckets can read the private
logs. For more information about log buckets, see
<a href="/logging/docs/routing/overview">Routing and storage overview</a>.</p></li>
</ul>
<p>For more information about the IAM permissions and roles that
apply to audit logs data, see
<a href="/logging/docs/access-control">Access control with IAM</a>.</p>
<h2 data-text="View logs" id="viewing_logs">View logs</h2>
<p>To query for audit logs, you need to know the <a href="#log_name">audit log name</a>, which includes the
<a href="/resource-manager/docs/creating-managing-projects#identifying_projects">resource identifier</a>
of the Cloud project, folder, billing account, or
organization for which you want to view audit logging information. In your
query, you can further specify other indexed <a href="/logging/docs/reference/v2/rest/v2/LogEntry"><code dir="ltr" translate="no">LogEntry</code></a> fields, such
as <code dir="ltr" translate="no">resource.type</code>. For more information on querying, see
<a href="/logging/docs/view/building-queries">Build queries in the Logs Explorer</a>.</p>


You can view audit logs in Cloud Logging by using the
Cloud console, the Google Cloud CLI, or the Logging API.



<div class="ds-selector-tabs" data-ds-scope="code-sample">
<section><h3 data-text="Console" id="console">Console</h3><p>In the Cloud console, you can use the Logs Explorer
to retrieve your audit log entries for your Cloud project, folder,
or organization:</p>
<aside class="note"><strong>Note:</strong><span> You can't view audit logs for Cloud Billing accounts in the
Cloud console. You must use the API or the gcloud CLI.</span></aside>
<ol>
<li><p>In the Cloud console, go to the
<strong>Logging<span aria-label="and then">&gt;</span> Logs Explorer</strong> page.</p>
<p><a class="button button-primary" href="https://console.cloud.google.com/logs/query" target="console">Go to Logs Explorer</a> </p></li>
<li><p>Select an existing Cloud project, folder, or organization.</p></li>
<li><p>In the <strong>Query builder</strong> pane, do the following:</p>
<ul>
<li><p>In <strong>Resource type</strong>, select the Google Cloud resource whose
audit logs you want to see.</p></li>
<li><p>In <strong>Log name</strong>, select the audit log type that you want to see:</p>
<ul>
<li>For Admin Activity audit logs, select <strong>activity</strong>.</li>
<li>For Data Access audit logs, select <strong>data_access</strong>.</li>
<li>For System Event audit logs, select <strong>system_event</strong>.</li>
<li>For Policy Denied audit logs, select <strong>policy</strong>.</li>
</ul></li>
</ul>
<p>If you don't see these options, then there aren't any audit logs of
that type available in the Cloud project, folder, or
organization.</p>
<p>If you're experiencing issues when trying to view logs in the
Logs Explorer, see the
<a href="/logging/docs/view/logs-explorer-interface#troubleshooting">troubleshooting</a>
information.</p>
<p>For more information about querying by using the Logs Explorer, see
<a href="/logging/docs/view/building-queries">Build queries in the Logs Explorer</a>.</p></li>
</ol></section>
<section><h3 data-text="gcloud" id="gcloud">gcloud</h3><p>The Google Cloud CLI provides a command-line interface to the
Logging API. Supply a valid resource identifier in each of the log
names. For example, if your query includes a <var translate="no">PROJECT_ID</var>, then the
project identifier you supply must refer to the currently selected
Cloud project.</p>
<p>To read your Cloud project-level audit log entries, run
the following command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com" \
    --project=<var translate="no">PROJECT_ID</var>
</pre>
<p>To read your folder-level audit log entries, run the following command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : folders/<var translate="no">FOLDER_ID</var>/logs/cloudaudit.googleapis.com" \
    --folder=<var translate="no">FOLDER_ID</var>
</pre>
<p>To read your organization-level audit log entries, run the following
command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : organizations/<var translate="no">ORGANIZATION_ID</var>/logs/cloudaudit.googleapis.com" \
    --organization=<var translate="no">ORGANIZATION_ID</var>
</pre>
<p>To read your Cloud Billing account-level audit log entries, run the following command:</p>
<pre class="devsite-click-to-copy" dir="ltr" translate="no">
gcloud logging read "logName : billingAccounts/<var translate="no">BILLING_ACCOUNT_ID</var>/logs/cloudaudit.googleapis.com" \
    --billing-account=<var translate="no">BILLING_ACCOUNT_ID</var>
</pre>
<p>Add the <a href="/sdk/gcloud/reference/logging/read#--freshness"><code dir="ltr" translate="no">--freshness</code> flag</a>
to your command to read logs that are more than 1 day old.</p>
<p>For more information about using the gcloud CLI, see
<a href="/sdk/gcloud/reference/logging/read"><code dir="ltr" translate="no">gcloud logging read</code></a>.</p></section>
<section><h3 data-text="API" id="api">API</h3><p>When building your queries, supply a valid resource identifier in each of
the log names. For example, if your query includes a <var translate="no">PROJECT_ID</var>,
then the project identifier you supply must refer to the currently selected
Cloud project.</p>
<p>For example, to use the Logging API to view your project-level
audit log entries, do the following:</p>
<ol>
<li><p>Go to the <strong>Try this API</strong> section in the documentation for the
<a href="/logging/docs/reference/v2/rest/v2/entries/list"><code dir="ltr" translate="no">entries.list</code></a>
method.</p></li>
<li><p>Put the following into the <strong>Request body</strong> part of the <strong>Try this
API</strong> form. Clicking this <a href="/logging/docs/reference/v2/rest/v2/entries/list?apix_params=%7B%22resource%22%3A%7B%22resourceNames%22%3A%5B%22projects%2F%5BPROJECT_ID%5D%22%5D%2C%22pageSize%22%3A5%2C%22filter%22%3A%22logName%3D(projects%2F%5BPROJECT_ID%5D%2Flogs%2Fcloudaudit.googleapis.com%252Factivity%20OR%20projects%2F%5BPROJECT_ID%5D%2Flogs%2Fcloudaudit.googleapis.com%252Fsystem_events%20OR%20projects%2F%5BPROJECT_ID%5D%2Flogs%2Fcloudaudit.googleapis.com%252Fdata_access)%22%7D%7D">prepopulated form</a>
automatically fills the request body, but you need to supply a valid
<var translate="no">PROJECT_ID</var> in each of the log names.</p>
<pre class="devsite-click-to-copy" dir="ltr" lang-html="" translate="no">
{
  "resourceNames": [
    "projects/<var translate="no">PROJECT_ID</var>"
  ],
  "pageSize": 5,
  "filter": "logName : projects/<var translate="no">PROJECT_ID</var>/logs/cloudaudit.googleapis.com"
}
</pre></li>
<li><p>Click <strong>Execute</strong>.</p></li>
</ol></section>
</div>
<h2 data-text="Route audit logs" id="exporting_audit_logs">Route audit logs</h2>
<p>You can <a href="/logging/docs/routing/overview">route audit logs</a> to supported
destinations in the same way that you can route other kinds of logs. Here are
some reasons you might want to route your audit logs:</p>
<ul>
<li><p>To keep audit logs for a longer period of time or to use more powerful
search capabilities, you can route copies of your audit logs to
Cloud Storage, BigQuery, or Pub/Sub. Using
Pub/Sub, you can route to other applications, other
repositories, and to third parties.</p></li>
<li><p>To manage your audit logs across an entire organization, you can create
<a href="/logging/docs/export/aggregated_sinks">aggregated sinks</a> that can
route logs from any or all Cloud projects in the organization.</p></li>
</ul>
<ul>
<li>If your enabled Data Access audit logs are pushing your
Cloud projects over your log allotments, you can create sinks that
exclude the Data Access audit logs from Logging.</li>
</ul>
<p>For instructions about routing logs, see
<a href="/logging/docs/export/configure_export_v2">Configure and manage sinks </a>.</p>
<h2 data-text="Pricing" id="pricing">Pricing</h2>
<p>For information about Cloud Logging pricing, see
<a href="/stackdriver/pricing#logging-costs">Google Cloud's operations suite pricing: Cloud Logging</a>.</p>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/monitoring]</H1></p><div class="devsite-article-body clearfix">
<aside class="beta">
<p>
<strong>
      
        Beta
      
        
    </strong>
</p>
<p>
      
      
        This product or feature is covered by the
        <a href="/terms/service-terms#1">Pre-GA Offerings Terms</a> of the Google Cloud
        Terms of Service. Pre-GA products and features might have limited support, and changes to
        pre-GA products and features might not be compatible with other pre-GA versions.
      
      For more information, see the
      <a href="/products#product-launch-stages">launch stage descriptions</a>.
  </p>
</aside>
<style>
  tr.type {
      border: none;
  }
  tr.desc {
      border-top:0 solid #000;
      border-bottom:1px solid #cfd8dc;
  }
  th.kind {
      width: 25%;
  }
</style>
<p>Cloud Data Loss Prevention sends detailed telemetry about your Cloud DLP
usage to Cloud Monitoring. This can be useful to monitor for
unexpected findings, amount of data scanned or transformed, errors in
<a href="/dlp/docs/concepts-job-triggers">job triggers or jobs</a>, and <a href="/dlp/pricing">expenses</a>.</p>
<h2 data-text="Using Cloud Monitoring with Cloud DLP" id="using_with">Using Cloud Monitoring with Cloud DLP</h2>
<p>Using <a href="/monitoring/charts/metrics-explorer">Metrics Explorer</a> in
Cloud Monitoring, you can dig into available metrics data to give you
insight into your Cloud DLP usage. Monitoring
supports a wide variety of metrics, which you can combine with filters and
aggregations for new and insightful views.</p>
<p>To view the metrics for a monitored resource by using Metrics Explorer, do the following:</p>
<ol>
<li>In the Google Cloud console, go to <b>Monitoring</b> or use the following button:<br/>
<a class="button button-primary" href="https://console.cloud.google.com/monitoring" target="console">Go to Monitoring</a></li>
<li>In the Monitoring navigation pane, click
      <img alt="" src="/monitoring/images/tme.png" width="18px"/> <b>Metrics Explorer</b>.
  </li>
<li>In the toolbar, select the <b>Explorer</b> tab.</li>
<li>Select the <b>Configuration</b> tab.</li>
<li>Expand the <b>Select a metric</b> menu, and then use the submenus to select a
    resource type and metric. For example, to chart the CPU utilization of a
    virtual machine, do the following:
    <ol>
<li>(Optional) To reduce the menu's options, enter part of the metric name in the
        <b>Filter bar</b>. For this example, enter <code dir="ltr" translate="no">utilization</code>.</li>
<li>In the <b>Active resources</b> menu, select <b>VM instance</b>.</li>
<li>In the <b>Active metric categories</b> menu, select <b>Instance</b>.</li>
<li>In the <b>Active metrics</b> menu, select <b>CPU utilization</b>.</li>
</ol>
</li></ol>
<p>To see Cloud DLP-specific metrics in Metrics Explorer, search with
<code dir="ltr" translate="no">dlp.googleapis.com</code> to refine your search results.</p>
<p>To see API metrics in Metrics Explorer, select <strong>Consumed API</strong> as the resource
type, and then use the filter and aggregation options to refine your data.</p>
<p>After you've found the metrics you want, you can use Monitoring
to create custom dashboards and alerts that will help you continue to monitor
and maintain a robust application.</p>
<h2 data-text="Monitoring &amp; graphing metrics" id="monitoring_graphing_metrics">Monitoring &amp; graphing metrics</h2>
<p>When graphing metrics, the most common way to do so is to aggregate using
Advanced Aggregation and the following settings:</p>
<ul>
<li>Aligner: SUM</li>
<li>Alignment Period: 1440</li>
</ul>
<figure style="text-align: center">
<a href="/dlp/docs/images/stackdriver-metric.png"><img alt="Cloud Monitoring metric configuration (click to enlarge)" class="screenshot" src="/dlp/docs/images/stackdriver-metric.png" style="max-width:80%; max-height:600px;" title="Cloud Monitoring metric configuration (click to enlarge)"/></a>
</figure>
<p>This will provide you with a chart showing you results per day.</p>
<figure style="text-align: center">
<a href="/dlp/docs/images/stackdriver-chart.png">
<img alt="Cloud Monitoring metric configuration (click to enlarge)" class="screenshot" src="/dlp/docs/images/stackdriver-chart.png" style="max-width:80%;" title="Cloud Monitoring metric configuration (click to enlarge)"/></a>
</figure>
<p>Cloud Monitoring supports alerting on all metrics. Using the
Cloud DLP metrics, you can alert on use cases that include:</p>
<ul>
<li>Monitor <code dir="ltr" translate="no">content_bytes_inspected_count</code> or
    <code dir="ltr" translate="no">content_bytes_transformed_count</code> to alert when spend has
    exceeded budget for a day.</li>
<li>Alert when the number of total findings or findings for a specific
    infoType exceed a threshold. For example, you can build an alert if
    <code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code> findings exceed 0 in a given project where
    no PII should exist.</li>
</ul>
<h2 data-text="Available metrics" id="available_metrics">Available metrics</h2>
<p>Launch stages of these metrics: Beta</p>
<aside class="note"><strong>Note:</strong><span> The following metric type names must be prefixed with
<code dir="ltr" translate="no">dlp.googleapis.com/</code>. That prefix has been omitted from the entries in the
table.</span></aside>
<table>
<thead>
<tr class="type">
<th colspan="2">MetricÂ type<br/>DisplayÂ name</th>
</tr>
<tr class="desc">
<th class="kind">Kind,Â Type,Â Unit<br/>LaunchÂ stage</th>
<th><i>Description</i><br/>Labels</th>
</tr>
</thead>
<tbody>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">finding_count</code><br/>Number of findings
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">By</code>
<br/><span>Beta</span>
</td>
<td>
<i>Number of findings per second. Only populated for jobs where the
          action <code dir="ltr" translate="no">PublishToStackdriver</code> is included.</i>
</td>
</tr>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">content_bytes_inspected_count</code><br/>Content bytes inspected
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">By</code>
<br/><span>Beta</span>
</td>
<td>
<i>Number of bytes inspected in content methods per second.</i>
</td>
</tr>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">content_bytes_transformed_count</code><br/>Content bytes transformed
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">By</code>
<br/><span>Beta</span>
</td>
<td>
<i>Number of bytes transformed in content methods per second.</i>
</td>
</tr>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">storage_bytes_inspected_count</code><br/>Storage bytes inspected
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">By</code>
<br/><span>Beta</span>
</td>
<td>
<i>Number of bytes inspected in Cloud DLP jobs.</i>
</td>
</tr>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">storage_bytes_transformed_count</code><br/>Storage bytes transformed
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">By</code>
<br/><span>Beta</span>
</td>
<td>
<i>Number of bytes transformed in Cloud DLP jobs.</i>
</td>
</tr>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">job_result_count</code><br/>Job results
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">1</code>
<br/><span>Beta</span>
</td>
<td>
<i>Results of Cloud DLP jobs. True if the job was success
          and false otherwise.</i>
</td>
</tr>
<tr class="type">
<td colspan="2">
<code dir="ltr" translate="no">job_trigger_run_count</code><br/>Job trigger runs
      </td>
</tr>
<tr class="desc">
<td>
<code dir="ltr" translate="no">DELTA</code>,Â <code dir="ltr" translate="no">INT64</code>,Â <code dir="ltr" translate="no">1</code>
<br/><span>Beta</span>
</td>
<td>
<i>Results of job trigger runs.</i>
</td>
</tr>
</tbody>
</table>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp]</H1></p><div class="devsite-article-body clearfix devsite-no-page-title">
<cloudx-tags tags="5D6Y89"></cloudx-tags>
<style>
  body[layout='full'] {
    background: #fff;
  }
</style>
<article id="cloud-site">
<style>
      .module-section:first-child {
        margin-top: 48px;
      }

      .module-section:empty {
        display: none;
      }

      .module-section:not(:empty) {
        margin-bottom: 48px;
      }

      div.richtext {
        color: #5f6368;
      }

      .richtext p {
        color: inherit;
        font: inherit;
        margin-bottom: 0;
      }

      .cloud-jump-content {
        padding-top: 72px;
      }

      .cloud-module__description p {
        margin: 0;
      }

      .cloud-module__description p+p {
        margin-top: 16px;
      }

      @media(min-width: 1024px) {
        .module-section:first-child {
          margin-top: 60px;
        }

        .module-section:not(:empty) {
          margin-bottom: 60px;
        }
      }

      @media(min-width: 1280px) {
        .cloud-jump-content {
          padding-top: 0;
        }
      }

      .cloud-block__image {
        width: 100%;
      }
    </style>
<style>
      .product-template__benefits:not(:empty) {
        margin-top: 36px;
      }

      .product-v2-template .cloud-chip {
        text-decoration: none;
      }
    </style>
<section class="module-section">
<div class="cws-banner cws-fullbleed" track-metadata-module="banner">
<p class="cws-banner__body-copy">
<span><a class="cws-link cws-link--dark" href="https://cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-name="automatic dlp" track-type="inline link">Automatic DLP</a>
            for BigQuery is now GA â our fully managed service designed to
            helpÂ  discover, inspect, classify, and protect data in
            BigQuery.</span></p>
</div> </section>
<style>
      .in-page-navigation-module cloudx-jump-menu[mixed],
      .in-page-navigation-module .cloud-jump-menu {
        padding-top: 0
      }

      .in-page-navigation-module .bricks-jump-menu {
        background-color: #f8f9fa;
      }

      @media(min-width: 1024px) {
        .in-page-navigation-module .bricks-jump-menu {
          margin-top: 60px;
        }

        .in-page-navigation-module .bricks-jump-menu--has-banner {
          margin-top: 0;
        }
      }

      #cloud-site cloudx-jump-menu .in-page-navigation-module__headline {
        margin-top: 0;
      }
    </style>
<div class="in-page-navigation-module">
<cloudx-jump-menu class="bricks-jump-menu--has-banner" label="Jump to" label-hidden-large="" mixed="">
<div class="cloud-menu-content">
<a class="cloud-jump-menu__toggle cloud-jump-menu__toggle--hide-large" href="#">Jump to<i aria-hidden="true" class="material-icons" translate="no"><span></span></i></a>
<div class="cloud-jump-menu__links">
<span class="cloud-subhead in-page-navigation-module__headline">
              Cloud Data Loss Prevention </span>
<div class="cloud-jump-menu__active-page"></div>
</div>
</div>
</cloudx-jump-menu>
</div>
<div class="product-v2-template cloud-jump-content">
<section class="module-section">
<style>
          .hero-module__title {
            color: #4185f4;
          }

          .hero-module--centered.hero-module--no-hero-asset .hero-module__content {
            text-align: center;
          }

          @media(max-width: 1024px) {
            .hero-module--centered .hero-module__content {
              text-align: center;
            }
          }
        </style>
<div class="hero-module hero-module--product" track-metadata-module="hero" track-metadata-module_headline="cloud data loss prevention" track-metadata-position="hero">
<div class="cws-grid">
<div class="cws-grid__col--span-12">
</div>
</div>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="cws-content-block">
<div class="cws-content-block__content hero-module__content">
<div class="cws-content-block__headline">
<h1 class="cws-headline--headline-3" data-text=" Cloud Data Loss                       Prevention " id="cloud-data-loss-prevention"> Cloud Data Loss
                      Prevention </h1>
</div>
<div class="cws-content-block__text">
<div class="cws-body--large richtext">Fully managed service
                      designed to help you discover, classify, and protect your
                      most sensitive data.</div>
</div>
</div>
</div>
<div class="cws-spacer-4--top">
<div class="cws-button__set">
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/freetrial" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/freetrial" track-metadata-modifier="high-emphasis" track-name="try cloud dlp free" track-type="button">


      Try Cloud DLP free
      
    
      </a>
</slot>
<slot slot="ineligible">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/dlp" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/dlp" track-metadata-modifier="high-emphasis" track-name="go to console" track-type="button">


      Go to console
      
    
      </a>
</slot>
</cloudx-free-trial-eligible-content>
</div>
</div>
<div class="cws-spacer-4--top cws-spacer-4--bottom">
<ul class="cws-bulleted-list">
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">Take
                      charge of your data on or off cloud</span>
</li>
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">
<p>Gain visibility into sensitive data risk across your
                        entire organization</p>
</span>
</li>
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">
<p>Reduce data risk with obfuscation and de-identification
                        methods like masking and tokenization</p>
</span>
</li>
<li class="cws-bulleted-list__list-item">
<span aria-hidden="true">
<svg class="cws-icon" height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z">
</path>
</svg>
</span>
<span class="cws-bulleted-list__text cws-body--large">Seamlessly
                      inspect and transform structured and unstructured
                      data</span>
</li>
</ul>
</div>
</div>
<div class="hero-module__right-rail cws-grid__col--span-4">
<a class="cws-card" href="https://cloud.google.com/resources/forrester-unstructured-data-security-2021-report" track-metadata-child_headline="google cloud named a leader in the forrester wave unstructured data security platforms q2 2021 report" track-metadata-eventdetail="cloud.google.com/resources/forrester-unstructured-data-security-2021-report" track-metadata-module="hero" track-metadata-module_headline="cloud data loss prevention" track-metadata-position="hero" track-name="google cloud named a leader in the forrester wave unstructured data security platforms q2 2021 report" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
</div>
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-5">Google Cloud named a Leader in The Forrester Waveâ¢: Unstructured Data Security Platforms, Q2 2021 report.</p>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Get the report
        </span>
</div>
</div>
</a>
</div>
</div>
</div> <div class="product-template__benefits">
<div class="cloud-jump-section" data-cloud-main-text="Benefits">
<p class="cws-label" style="margin-bottom: 16px;">Benefits</p>
<style>
              .benefit-module__copy-block {
                border: 1px solid #dbdce0;
                padding: 36px;
              }

              @media(max-width: 767px) {
                .benefit-module__copy-block {
                  padding: 24px;
                }
              }
            </style>
<div class="benefits-module" track-metadata-module="benefits">
<div class="cws-spacer-2--bottom">
<div class="cws-content-block">
</div>
</div>
<div class="benefit-module__copy-block cws-grid">
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                         Gain visibility into the data you store and process" id="gain-visibility-into-the-data-you-store-and-process">
                        Gain visibility into the data you store and process</h4>
<div class="cws-body cws-content-block__text">
<p>Create dashboards and audit reports. Automate
                          tagging, remediation, or policy based on findings.
                          Connect DLP results into Security Command Center, Data
                          Catalog, or export to your own SIEM or governance
                          tool.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                         Configure data inspection and monitoring with ease" id="configure-data-inspection-and-monitoring-with-ease">
                        Configure data inspection and monitoring with ease</h4>
<div class="cws-body cws-content-block__text">
<p>Enable DLP across your entire BigQuery footprint to
                          automatically discover, inspect, and classify your
                          data. DLP runs continuously, picking up new data
                          tables as they are added, so you can focus on
                          analysis.</p>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-6 cws-grid__col--span-4-lg">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h4 class="cws-headline--headline-5 cws-content-block__headline" data-text="                         Reduce risk to unlock more data for your business" id="reduce-risk-to-unlock-more-data-for-your-business">
                        Reduce risk to unlock more data for your business</h4>
<div class="cws-body cws-content-block__text">
<p>Protection of sensitive data, like personally
                          identifiable information (PII), is critical to your
                          business. Deploy de-identification in migrations, data
                          workloads, and real-time data collection and
                          processing.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="module-section"></section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-main-text="Key features">
<p class="cws-label" style="margin-bottom: 16px;">Key features</p>
<style>
            .key-features-module__eyebrow {
              margin-bottom: 8px;
            }

            .key-features-module__key-feature img {
              width: auto;
            }
          </style>
<div class="key-features-module" track-metadata-module="key features" track-metadata-module_headline="key features">
<div class="cws-grid">
<div class="key-features-module__headline cws-spacer-4--bottom cws-grid__col--span-8">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                       Key features" id="key-features">
                      Key features</h2>
</div>
</div>
</div>
</div>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Automated sensitive data discovery for your data                         warehouse" id="automated-sensitive-data-discovery-for-your-data-warehouse">
                        Automated sensitive data discovery for your data
                        warehouse</h3>
<div class="cws-body cws-content-block__text">
<p>Discover sensitive data by profiling every BigQuery
                          table and column across your entire organization,
                          select organization folders, or individual projects.
                          Configure directly in the Cloud Console UI and let DLP
                          handle the rest. Use table and column profiles to
                          inform your security and privacy posture.</p>
</div>
</div>
</div>
</div>
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Use Cloud DLP from virtually anywhere, on or off Cloud                       " id="use-cloud-dlp-from-virtually-anywhere,-on-or-off-cloud">
                        Use Cloud DLP from virtually anywhere, on or off Cloud
                      </h3>
<div class="cws-body cws-content-block__text">
<p>With over
                          <a class="cws-link" href="/dlp/docs/infotypes-reference" track-metadata-eventdetail="cloud.google.com/dlp/docs/infotypes-reference" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="150 built-in infotypes" track-type="content block">150 built-in infoTypes</a>,
                          Cloud DLP gives you the power to scan, discover,
                          classify, and report on data from virtually anywhere.
                          Cloud DLP has built-in support for scanning and
                          classifying sensitive data in Cloud Storage, BigQuery,
                          and Datastore, and a streaming content API to enable
                          support for additional data sources, custom workloads,
                          and applications.</p>
</div>
</div>
</div>
</div>
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Automatically mask your data to safely unlock more of                         the cloud" id="automatically-mask-your-data-to-safely-unlock-more-of-the-cloud">
                        Automatically mask your data to safely unlock more of
                        the cloud</h3>
<div class="cws-body cws-content-block__text">
<p>Cloud DLP provides tools to classify, mask, tokenize,
                          and transform sensitive elements to help you better
                          manage the data that you collect, store, or use for
                          business or analytics. With support for
                          <a class="cws-link" href="/dlp/docs/examples-deid-tables" track-metadata-eventdetail="cloud.google.com/dlp/docs/examples-deid-tables" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="structured" track-type="content block">structured</a>
                          and
                          <a class="cws-link" href="/dlp/docs/deidentify-sensitive-data" track-metadata-eventdetail="cloud.google.com/dlp/docs/deidentify-sensitive-data" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="unstructured" track-type="content block">unstructured</a>
                          data, Cloud DLP can help you preserve the utility of
                          your data for joining, analytics, and AI while
                          protecting the raw sensitive identifiers.</p>
</div>
</div>
</div>
</div>
<div class="key-features-module__key-feature cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h3 class="cws-headline--headline-6 cws-content-block__headline" data-text="                         Measure re-identification risk in structured data" id="measure-re-identification-risk-in-structured-data">
                        Measure re-identification risk in structured data</h3>
<div class="cws-body cws-content-block__text">
<p>Enhance your understanding of data privacy risk.
                          Quasi-identifiers are partially identifying elements
                          or combinations of data that may link to a single
                          person or a very small group. Cloud DLP allows you to
                          measure statistical properties such as k-anonymity and
                          l-diversity, expanding your ability to understand and
                          protect data privacy.</p>
</div>
</div>
</div>
</div>
<a class="cws-button cws-button--low-emphasis cws-button--align-left cloud-smooth-scroll" href="#all-features" track-metadata-eventdetail="cloud.google.com" track-metadata-modifier="low-emphasis" track-name="view all features" track-type="button">


      View all features
      
    
      </a>
</div>
<div class="key-features-module__right-rail cws-grid__col--span-4">
<a class="cws-card lb" data-lightbox-height="506" data-lightbox-width="900" href="https://youtube.com/watch?v=7RqG-pjgZeQ&amp;autoplay=1?t=1" rel="noopener" target="_blank" track-metadata-child_eyebrow="video" track-metadata-child_headline="learn how cloud dlp helps enterprises discover and manage sensitive data assets" track-metadata-eventdetail="youtube.com/watch" track-metadata-module="key features" track-metadata-module_headline="key features" track-name="learn how cloud dlp helps enterprises discover and manage sensitive data assets" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--video">
<picture>
<source srcset="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rw-lo-sc0xffffff-h338-w600 1x,https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rw-lo-sc0xffffff-h676-w1200 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h338-w600 1x,https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h676-w1200 2x" type="image/jpeg"/>
<img alt="Thumbnail from Cloud OnAir presentation: Protecting sensitive datasets in Google Cloud" class="" loading="lazy" src="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h338-w600" srcset="https://lh3.googleusercontent.com/-TJUeuqxmBopI5FJJfoFYEXqUqt1o2RBlwNpxywNuPPOJ74hZNVVKNLwfHVcu-4p9sk6GmRlIGU3qA=e14-rj-sc0xffffff-h676-w1200 2x"/>
</picture>
<span aria-hidden="true">
<svg class="cws-icon" height="18px" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M23.74 7.1s-.23-1.65-.95-2.37c-.91-.96-1.93-.96-2.4-1.02C17.04 3.47 12 3.5 12 3.5s-5.02-.03-8.37.21c-.46.06-1.48.06-2.39 1.02C.52 5.45.28 7.1.28 7.1S.04 9.05 0 10.98V13c.04 1.94.28 3.87.28 3.87s.24 1.65.96 2.38c.91.95 2.1.92 2.64 1.02 1.88.18 7.91.22 8.12.22 0 0 5.05.01 8.4-.23.46-.06 1.48-.06 2.39-1.02.72-.72.96-2.37.96-2.37s.24-1.94.25-3.87v-2.02c-.02-1.93-.26-3.88-.26-3.88zM9.57 15.5V8.49L16 12.13 9.57 15.5z"></path></svg>
</span>
</div>
<div class="cws-card__content">
<p class="cws-label">VIDEO</p>
<p class="cws-headline cws-headline--headline-5">Learn how Cloud DLP helps enterprises discover and manage sensitive data assets.</p>
<p class="cws-small-text">37:55</p>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
</section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-main-text="Customers">
<style>
            .customer-module__carousel .cloud-carousel {
              padding: 0;
            }
          </style>
<div class="customer-module" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action">
<p class="cws-label">Customers</p>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="customer-module__headline cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                         See DLP in action" id="see-dlp-in-action">
                        See DLP in action</h2>
</div>
</div>
</div>
</div>
</div>
<div class="customer-module__carousel cws-spacer-4--bottom">
<style>
                @media (max-width: 480px) {
                  .cloud-carousel--bleed-right {
                    margin-right: 0;
                  }

                  .cloud-carousel__slide {
                    margin-right: 16px;
                  }
                }
              </style>
<div class="cloud-carousel cloud-carousel--3up cloud-carousel--margin-tight">
<div class="cloud-carousel__slide-deck-container">
<div class="cloud-carousel__slide-deck" role="group">
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/sittercity" track-metadata-child_eyebrow="case study" track-metadata-child_headline="sittercity uses uses cloud dlp api to detect and redact personal data to keep its service secure" track-metadata-child_index="1" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/sittercity" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="sittercity uses uses cloud dlp api to detect and redact personal data to keep its service secure" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="Sittercity logo" class="" src="https://lh3.googleusercontent.com/yKu7jAeos7YSTgrJ9FCi88Dcx3oIRdd08nkO_OZu7smei1CH8AZsaPCkCMTgaiVf8axaS-pBlS3c=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/yKu7jAeos7YSTgrJ9FCi88Dcx3oIRdd08nkO_OZu7smei1CH8AZsaPCkCMTgaiVf8axaS-pBlS3c=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">Sittercity uses uses Cloud DLP API to detect and redact personal data to keep its service secure.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/featured/paypal" track-metadata-child_eyebrow="case study" track-metadata-child_headline="paypal uses cloud dlp to secure sensitive data" track-metadata-child_index="2" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/featured/paypal/index.html" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="paypal uses cloud dlp to secure sensitive data" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="PayPal" class="" src="https://lh3.googleusercontent.com/60Hm2cszoJ78rOSK4YalVQ7v0GC40eZjxbcrzAIh9zRjM8AFUhyF8IDIG8vzMJ2r0TmwGhDp-fXn=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/60Hm2cszoJ78rOSK4YalVQ7v0GC40eZjxbcrzAIh9zRjM8AFUhyF8IDIG8vzMJ2r0TmwGhDp-fXn=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">PayPal uses Cloud DLP to secure sensitive data.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/ambra-health" track-metadata-child_eyebrow="case study" track-metadata-child_headline="ambra health uses the cloud dlp api for managing and redacting sensitive patient data at scale" track-metadata-child_index="3" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/ambra-health/" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="ambra health uses the cloud dlp api for managing and redacting sensitive patient data at scale" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="ambra health" class="" src="https://lh3.googleusercontent.com/ZG7P3eiWrSt1J19qxA-ZoeSGWosq9EHNV8dJA3CbE6CvNYvam69D1JIQIF6FbkuQscF7doQ-tqTy=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/ZG7P3eiWrSt1J19qxA-ZoeSGWosq9EHNV8dJA3CbE6CvNYvam69D1JIQIF6FbkuQscF7doQ-tqTy=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">Ambra health uses the Cloud DLP API for managing and redacting sensitive patient data at scale.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
<div class="cloud-carousel__slide cws-cards">
<a class="cws-card" href="/customers/sunway-group" track-metadata-child_eyebrow="case study" track-metadata-child_headline="sunway group uses cloud dlp to classify and protect sensitive data in their data processing pipelines" track-metadata-child_index="4" track-metadata-child_total="4" track-metadata-eventdetail="cloud.google.com/customers/sunway-group" track-metadata-module="customers carousel" track-metadata-module_headline="see dlp in action" track-name="sunway group uses cloud dlp to classify and protect sensitive data in their data processing pipelines" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__asset cws-card__asset--logo">
<img alt="Sunway Group" class="" src="https://lh3.googleusercontent.com/NSuQnqfqQX6l1aqWQvQ8LYbsABw6IdRO3lY3EGRrctjxiGwT9IanjE4bYYe1IButUn0YBlp3kBU8gg=e14-rj-sc0xffffff-h36" srcset="https://lh3.googleusercontent.com/NSuQnqfqQX6l1aqWQvQ8LYbsABw6IdRO3lY3EGRrctjxiGwT9IanjE4bYYe1IButUn0YBlp3kBU8gg=e14-rj-sc0xffffff-h72 2x"/>
</div>
<div class="cws-card__content">
<p class="cws-label">Case study</p>
<p class="cws-headline cws-headline--headline-5">Sunway Group uses Cloud DLP to classify and protect sensitive data in their data processing pipelines.</p>
<p class="cws-small-text">5-min read</p>
</div>
</div>
</a>
</div>
</div>
</div>
<div class="cloud-carousel__controls cloud-carousel__controls--hide-nuggets">
<div class="cloud-carousel__arrow left-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_left</i>
</div>
<div class="cloud-carousel__arrow right-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_right</i>
</div>
<div class="cloud-carousel__nuggets">
<div class="cloud-carousel__nugget"></div>
</div>
</div>
</div>
</div>
<div>
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://cloud.google.com/customers" track-metadata-eventdetail="cloud.google.com/customers" track-metadata-modifier="low-emphasis" track-name="see all customers" track-type="button">


      See all customers
      
    
      </a>
</div>
</div>
</div> </section>
<section class="module-section"></section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-main-text="What's new">
<style>
            .whats-new-module .cloud-carousel {
              padding: 0;
            }

            @media (max-width: 767px) {
              .whats-new-module .cloud-carousel--3up .cloud-carousel__slide {
                padding: 0 24px;
                align-items: start;
              }
            }
          </style>
<div class="whats-new-module" track-metadata-module="whats new" track-metadata-module_headline="whats new">
<p class="cws-label">What's new</p>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="whats-new-module__headline cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                         What's new" id="whats-new">
                        What's new</h2>
<div class="cws-body cws-content-block__text">
<p>
<a class="cws-link" href="https://cloud.google.com/newsletter" track-metadata-eventdetail="cloud.google.com/newsletter" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="sign up" track-type="content block">Sign up</a>
                          for Google Cloud newsletters to receive product
                          updates, event information, special offers, and more.
                        </p>
</div>
</div>
</div>
</div>
</div>
</div>
<style>
              @media (max-width: 480px) {
                .cloud-carousel--bleed-right {
                  margin-right: 0;
                }

                .cloud-carousel__slide {
                  margin-right: 16px;
                }
              }
            </style>
<div class="cloud-carousel cloud-carousel--3up">
<div class="cloud-carousel__slide-deck-container">
<div class="cloud-carousel__slide-deck" role="group">
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="https://cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="automatic data risk management for bigquery using dlp" track-metadata-child_index="1" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/google-launches-automatic-dlp-for-bigquery" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="People analysing data" class="" src="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/ppQuuzBLoHQ3OIsUbCSRNkbLi3aBBIBsNMzwVmw03TREeAUbtkgWzr5z6v58kVLL0dYQpDAZAE42=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Automatic data risk management for BigQuery using DLP</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="scan for sensitive data in just a few clicks" track-metadata-child_index="2" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Blog logo" class="" src="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/liG4K4tTgWECu-LueTTHUVvR_OSyfaBhhNkBPjf2K8VAWzp283GafCz0ljyjSWe6geX412x1WPJC=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Scan for sensitive data in just a few clicks</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="https://cloud.google.com/blog/products/identity-security/taking-charge-of-your-data-using-cloud-dlp-to-de-identify-and-obfuscate-sensitive-information" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="use cloud dlp to mask sensitive information" track-metadata-child_index="3" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/taking-charge-of-your-data-using-cloud-dlp-to-de-identify-and-obfuscate-sensitive-information" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Painter covering data with paint" class="" src="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/nTe97Yi7NggDakSQLhtlxy-icdsLyov2kW6daMuPPtTtIQ8IDbAqo0TgOz5SeS-7I4SkewKZOdTd=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Use cloud DLP to mask sensitive information</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link lb" data-lightbox-height="506" data-lightbox-width="900" href="https://www.youtube.com/watch?v=PIlMsykXqLk" rel="noopener" target="_blank" track-metadata-child_eyebrow="video" track-metadata-child_headline="scotiabank shares their cloud-native approach to ingesting pii into google cloud" track-metadata-child_index="4" track-metadata-child_total="6" track-metadata-eventdetail="www.youtube.com/watch" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-metadata-video-id="PIlMsykXqLk" track-name="watch video" track-type="card">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Thumbnail image of man on stage" class="" src="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/Kk2SFNDnOAob2hUciEs9kr-ElMv2T7T4Z-NQyEh_HSmU8fHMfse-fdD3W1VtLlRShK-XcVvRhxAgsw=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Video</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Scotiabank shares their cloud-native approach to ingesting PII into Google Cloud</span>
<span class="cloud-link cloud-carousel__slide-cta">Watch video</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="/blog/products/identity-security/take-charge-of-your-data-how-tokenization-makes-data-usable-without-sacrificing-privacy" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="how tokenization makes data usable without sacrificing privacy" track-metadata-child_index="5" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/take-charge-of-your-data-how-tokenization-makes-data-usable-without-sacrificing-privacy" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Stylized image of flow of multicolored circles entering a funnel and emerging as a stacked set of square blocks" class="" src="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/yERU4qc4qojx_6sxRPk61Uz1IpWhI6lcA1pVB31DeE5DiOIMqsUIycxX6UmBkSBMnBiIb9MA727X=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>How tokenization makes data usable without sacrificing privacy</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
<div class="cloud-carousel__slide cloud-carousel__slide--story">
<a class="cloud-carousel__slide-link" href="https://cloud.google.com/blog/products/identity-security/how-cloud-dlp-can-help-with-compliance-security-and-privacy" track-metadata-child_eyebrow="blog post" track-metadata-child_headline="not just compliance reimagining dlp for todays cloud-centric world" track-metadata-child_index="6" track-metadata-child_total="6" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/how-cloud-dlp-can-help-with-compliance-security-and-privacy" track-metadata-module="whats new" track-metadata-module_headline="whats new" track-name="read the blog" track-type="carousel slide item">
<div class="cloud-carousel__slide-image cloud-carousel__slide-image--rounded">
<picture>
<source srcset="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rw-lo-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rw-lo-sc0xffffff-h260-w204 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h130-w102 1x,https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h260-w204 2x" type="image/jpeg"/>
<img alt="Thumbnail of a woman standing and looking at a variety of data output" class="" src="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h130-w102" srcset="https://lh3.googleusercontent.com/lTVN1KwfttJmXdbBbBRrPK37EWyIdgvcpyTw3umsB7aSrCmhbf1dRRCm9_8BQTet_Ou3jsKR7H4=e14-rj-sc0xffffff-h260-w204 2x"/>
</picture>
</div>
<div class="cloud-carousel__slide-body">
<p class="cloud-carousel__slide-metadata cws-label">
<span class="cloud-carousel__slide-eyebrow">Blog post</span>
</p>
<p class="cloud-carousel__slide-description cws-headline--headline-6">
<span>Not just compliance: reimagining DLP for todayâs cloud-centric world</span>
<span class="cloud-link cloud-carousel__slide-cta">Read the blog</span>
</p>
</div>
</a>
</div>
</div>
</div>
<div class="cloud-carousel__controls cloud-carousel__controls--hide-nuggets">
<div class="cloud-carousel__arrow left-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_left</i>
</div>
<div class="cloud-carousel__arrow right-arrow">
<i aria-hidden="true" class="material-icons" translate="no">keyboard_arrow_right</i>
</div>
<div class="cloud-carousel__nuggets">
<div class="cloud-carousel__nugget"></div>
</div>
</div>
</div>
</div>
</div> </section>
<section class="module-section" id="documentation">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Documentation">
<p class="cws-label" style="margin-bottom: 16px;">Documentation</p>
<style>
            .documentation-module__more-docs {
              margin-bottom: 24px;
            }
          </style>
<div class="documentation-module" track-metadata-module="documentation" track-metadata-module_headline="documentation">
<div class="cws-grid">
<div class="documentation-module__copy cws-grid__col--span-8">
<div class="documentation-module__headline cws-spacer-4--bottom">
<div class="cws-content-block">
<div class="cws-content-block__content">
<h2 class="cws-headline--headline-4 cws-content-block__headline" data-text="                         Documentation" id="documentation">
                        Documentation</h2>
</div>
</div>
</div>
</div>
</div>
<div class="cws-grid">
<div class="cws-grid__col--span-8">
<div class="cloud-list">
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         De-identification of PII in large-scale data using Cloud                         DLP" id="de-identification-of-pii-in-large-scale-data-using-cloud-dlp">
                        De-identification of PII in large-scale data using Cloud
                        DLP</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to use Cloud DLP
                          to create an automated transformation pipeline to
                          de-identify sensitive data like personally
                          identifiable information (PII).Â </span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-child_index="1" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Automating the classification of data in Cloud Storage                       " id="automating-the-classification-of-data-in-cloud-storage">
                        Automating the classification of data in Cloud Storage
                      </h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to implement an
                          automated data quarantine and classification system
                          using Cloud Storage and other Google Cloud
                          products.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-child_index="2" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Pattern </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Relational database import to BigQuery with Dataflow                       " id="relational-database-import-to-bigquery-with-dataflow">
                        Relational database import to BigQuery with Dataflow
                      </h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">This proof of concept uses
                          Dataflow and Cloud DLP to securely tokenize and import
                          data from a relational database to BigQuery.</span>
</p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://github.com/GoogleCloudPlatform/dlp-rdb-bq-import" rel="noopener" target="_blank" track-metadata-child_index="3" track-metadata-child_total="9" track-metadata-eventdetail="github.com/GoogleCloudPlatform/dlp-rdb-bq-import" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Pattern </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Using a Cloud DLP proxy to query a database" id="using-a-cloud-dlp-proxy-to-query-a-database">
                        Using a Cloud DLP proxy to query a database</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">This concept architecture
                          uses a proxy that parses, inspects, and then either
                          logs the findings or de-identifies the results by
                          using Cloud DLP.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/solutions/example-architecture-dlp-proxy-query-database-sensitive-data" track-metadata-child_index="4" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/solutions/example-architecture-dlp-proxy-query-database-sensitive-data" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Inspecting storage and databases for sensitive data" id="inspecting-storage-and-databases-for-sensitive-data">
                        Inspecting storage and databases for sensitive data</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Instructions for setting up
                          an inspection scan using Cloud DLP in the Cloud
                          Console, and (optionally) for scheduling periodic
                          repeating inspection scans.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/inspecting-storage" track-metadata-child_index="5" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/dlp/docs/inspecting-storage" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Quickstart </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Scheduling a Cloud DLP inspection scan" id="scheduling-a-cloud-dlp-inspection-scan">
                        Scheduling a Cloud DLP inspection scan</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">You can schedule inspection
                          scans of storage repositories like Cloud Storage,
                          BigQuery, and Datastore using Cloud DLPâs job trigger
                          feature.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/schedule-inspection-scan" track-metadata-child_index="6" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/dlp/docs/schedule-inspection-scan" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> APIs &amp; Libraries </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Cloud DLP Client Libraries" id="cloud-dlp-client-libraries">
                        Cloud DLP Client Libraries</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to get started
                          with the Cloud Client Libraries for the Cloud Data
                          Loss Prevention API.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/libraries" track-metadata-child_index="7" track-metadata-child_total="9" track-metadata-eventdetail="cloud.google.com/dlp/docs/libraries" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Create a Cloud DLP inspection template" id="create-a-cloud-dlp-inspection-template">
                        Create a Cloud DLP inspection template</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">This quickstart shows you
                          how to create and use a Cloud Data Loss Prevention
                          (DLP) inspection template that lets you create and
                          persist configuration information.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-template-inspect" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-child_index="8" track-metadata-child_total="9" track-metadata-eventdetail="console.cloud.google.com/" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list-item">
<div class="cloud-list-item__content">
<div class="cloud-list-item__header">
<span class="cloud-chip cloud-chip--green-bg"> Tutorial </span>
</div>
<h5 class="cws-headline--headline-6 cloud-list-item__headline" data-text="                         Schedule a Cloud DLP inspection scan" id="schedule-a-cloud-dlp-inspection-scan">
                        Schedule a Cloud DLP inspection scan</h5>
<p class="cws-body cloud-list-item__blurb"><span class="cws-body richtext">Learn how to: enable DLP in
                          a project, create a job trigger to scan a public
                          dataset, choose input data to customize your scan and
                          configure detection parameters.</span></p>
</div>
<div class="cloud-list-item__footer">
<div class="cws-button__set cws-button__set--with-margin">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="https://console.cloud.google.com/?walkthrough_id=dlp__quickstart-create-job-trigger" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-child_index="9" track-metadata-child_total="9" track-metadata-eventdetail="console.cloud.google.com/" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-metadata-parent_type="list item" track-name="learn more" track-type="button">


      Learn more
      
    
      </a>
</div>
</div>
</div>
<div class="cloud-list__footer">
<h5 class="cws-headline--headline-6 cloud-list__footer-heading" data-text="                       Not seeing what youâre looking for? " id="not-seeing-what-youâre-looking-for">
                      Not seeing what youâre looking for? </h5>
<div class="cloud-list__footer--buttons">
<div class="cws-button__set">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs" track-metadata-eventdetail="cloud.google.com/dlp/docs" track-metadata-modifier="low-emphasis" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-name="view all product documentation" track-type="button">


      View all product documentation
      
    
      </a>
</div>
</div>
</div>
</div>
</div>
<div class="cws-grid__col--span-4 documentation-module__sidebar">
<div class="documentation-module__more-docs">
<div aria-label="Explore more docs 1" class="cws-link-aside" role="complementary">
<div class="cws-link-aside__header">
<h2 class="cws-link-aside__headline cws-headline--headline-6" data-text="                         Explore more docs " id="explore-more-docs">
                        Explore more docs </h2>
</div>
<ul class="cws-link-aside__items">
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/quickstarts" track-metadata-eventdetail="cloud.google.com/dlp/docs/quickstarts" track-name="get a quick intro to using this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">Get a quick intro to using this product.</p>
</div>
</a>
</li>
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/how-to" track-metadata-eventdetail="cloud.google.com/dlp/docs/how-to" track-name="learn to complete specific tasks with this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">Learn to complete specific tasks with this product.</p>
</div>
</a>
</li>
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/solutions" track-metadata-eventdetail="cloud.google.com/dlp/docs/solutions" track-name="browse walkthroughs of common uses and scenarios for this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">Browse walkthroughs of common uses and scenarios for                this product.</p>
</div>
</a>
</li>
<li class="cws-link-aside__item">
<a class="cws-link-aside__link" href="/dlp/docs/apis" track-metadata-eventdetail="cloud.google.com/dlp/docs/apis" track-name="view apis references and other resources for this product" track-type="link aside">
<div class="cws-link-aside__link-content">
<p class="cws-link-aside__link-text cws-headline--headline-6">View APIs, references, and other resources for this product.</p>
</div>
</a>
</li>
</ul>
</div>
</div>
<a class="cws-card cws-card--list" href="/dlp/docs/release-notes" track-metadata-child_headline="release notes" track-metadata-eventdetail="cloud.google.com/dlp/docs/release-notes" track-metadata-module="documentation" track-metadata-module_headline="documentation" track-name="release notes" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-headline cws-headline--headline-6">Release notes</p>
<div class="cws-body">Read about the latest releases for Cloud DLP</div>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
</section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Use cases">
<p class="cws-label" style="margin-bottom: 16px;">Use cases</p>
<style>
            /* [1] Override chip bottom margin to match design spec */
            .use-case-module .cloud-chip {
              margin-bottom: 8px;
              /* [1] */
            }

            .use-case-module__headline {
              margin-bottom: 40px;
            }

            .use-case-module__use-case {
              margin-bottom: 36px;
            }

            .use-case-module__use-case:last-child {
              margin-bottom: 0;
            }

            .use-case-module__use-case-diagram {
              display: flex;
              justify-content: left;
              overflow-x: auto;
              margin: 24px 0;
            }

            .use-case-module__cta {
              margin-top: 24px;
            }
          </style>
<div class="use-case-module" track-metadata-module="use cases" track-metadata-module_headline="use cases">
<div class="use-case-module__headline">
<h3 class="cws-headline--headline-4" data-text=" Use cases " id="use-cases"> Use cases </h3>
</div>
<div>
<div class="use-case-module__use-case">
<div>
<span class="cloud-chip cloud-chip--yellow-bg"> Use case </span>
</div>
<div>
<span class="cws-headline--headline-6 cloud-jump-section">Automatically
                    discover sensitive data</span>
</div>
<span class="cws-body richtext">
<p>Understand and manage your data risk across your
                    organization automatically with Cloud DLP (available now for
                    BigQuery). Continuous visibility into your data can help you
                    make more informed decisions, manage and reduce your data
                    risk, and help stay in compliance. Data profiling can be
                    configured easily in the Cloud Console with no jobs or
                    overhead to manage, letting you focus on the outcomes and
                    your business.</p>
</span>
<div class="use-case-module__use-case-diagram">
<picture>
<source srcset="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rw-lo-sc0xffffff-h400-w953 1x,https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rw-lo-sc0xffffff-h800-w1906 2x" type="image/webp"/>
<source srcset="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h400-w953 1x,https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h800-w1906 2x" type="image/jpeg"/>
<img alt="Automatic Profiling" class="" loading="lazy" src="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h400-w953" srcset="https://lh3.googleusercontent.com/RZLjqP1AXOYnOgLS-laduWqk-uXVnUk-OfDY8BE8XZmAUOztenS8y7rToR3bE1cQV9w5ZmYtQhSUxg=e14-rj-sc0xffffff-h800-w1906 2x"/>
</picture>
</div>
<div class="cws-grid cws-cards--compact use-case-module__technical-content cws-spacer-3--top">
</div>
</div>
<div class="use-case-module__use-case">
<div>
<span class="cloud-chip cloud-chip--yellow-bg"> Use case </span>
</div>
<div>
<span class="cws-headline--headline-6 cloud-jump-section">Classify
                    data across your enterprise</span>
</div>
<span class="cws-body richtext">
<p>Cloud DLP can help classify your data on or off cloud
                    giving you the insights you need to ensure proper
                    governance, control, and compliance. Save detailed findings
                    to BigQuery for analysis or publish summary findings to
                    other services like Data Catalog, Security Command Center,
                    Cloud Monitoring, and Pub/Sub. Audit and monitor your data
                    in Cloud Console or build custom reports and dashboards
                    using Google Data Studio or your tool of choice.</p>
</span>
<div class="use-case-module__use-case-diagram">
<img alt="On left is a rectangle labeled Data Sources with stacked icons for BigQuery, Cloud Storage, and Datastore. Arrow points right at rectangle labeled Cloud Data Loss Prevention with a Cloud DLP icon and 1. Set up a job or job trigger. Cloud DLP creates and runs a scan whenever you tell it to inspect your data. 2. Scan for sensitive data. Cloud DLP inspects for sensitive data elements like personally identifiable information (PII), credentials, and secrets. 3. Choose actions. Once the job is complete, Cloud DLP actions can give you rich, detailed findings or publish summary details to other systems.  From that rectangle, flow continues right splitting into upper box labeled Save Findings, with BigQuery and DLP icons and lower box labeled Publish Findings with icons for Security Command Center, Data Catalog, Cloud Monitoring, Email, and Pub/Sub" class="" loading="lazy" src="https://www.gstatic.com/bricks/image/17ce743c5356e76389a971b4267faca0331ad0c6dd28a0eb6728565c23cb9704.svg" style="max-width: 953px; max-height: 400px;"/>
</div>
<div class="cws-grid cws-cards--compact use-case-module__technical-content cws-spacer-3--top">
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-child_eyebrow="whitepaper" track-metadata-child_headline="scan for sensitive data in just a few clicks" track-metadata-child_index="1" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/blog/products/identity-security/take-charge-of-your-data-scan-for-sensitive-data-in-just-a-few-clicks" track-metadata-module="use cases" track-metadata-module_headline="classify data across your enterprise" track-name="scan for sensitive data in just a few clicks" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Whitepaper</p>
<p class="cws-headline cws-headline--headline-5">Scan for sensitive data in just a few clicks</p>
<div class="cws-body">A deeper look at the Google Cloud Console user interface for Cloud DLP and how you can start to inspect your enterprise data with just a few clicks.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-child_eyebrow="tutorial" track-metadata-child_headline="automating the classification of data in cloud storage" track-metadata-child_index="2" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/solutions/automating-classification-of-data-uploaded-to-cloud-storage" track-metadata-module="use cases" track-metadata-module_headline="classify data across your enterprise" track-name="automating the classification of data in cloud storage" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Tutorial</p>
<p class="cws-headline cws-headline--headline-5">Automating the classification of data in Cloud Storage</p>
<div class="cws-body">This tutorial teaches you how to implement an automated data quarantine and classification system using Cloud Storage and other Google Cloud products.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/dlp/docs/schedule-inspection-scan" track-metadata-child_eyebrow="quickstart" track-metadata-child_headline="quickstart scheduling a cloud dlp inspection scan" track-metadata-child_index="3" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/dlp/docs/schedule-inspection-scan" track-metadata-module="use cases" track-metadata-module_headline="classify data across your enterprise" track-name="quickstart scheduling a cloud dlp inspection scan" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Quickstart</p>
<p class="cws-headline cws-headline--headline-5">Quickstart: Scheduling a Cloud DLP inspection scan</p>
<div class="cws-body">Get started with Cloud DLP to inspect and monitor your data using jobs and job triggers.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
</div>
</div>
<div class="use-case-module__use-case">
<div>
<span class="cloud-chip cloud-chip--yellow-bg"> Use case </span>
</div>
<div>
<span class="cws-headline--headline-6 cloud-jump-section">Protect
                    sensitive data as you migrate to the cloud</span>
</div>
<span class="cws-body richtext">
<p>Unblock more workloads as you migrate to the cloud. Cloud
                    DLP enables you to inspect and classify your sensitive data
                    in structured and unstructured workloads. De-identification
                    techniques like tokenization (pseudonymization) let you
                    preserve the utility of your data for joining or analytics
                    while reducing the risk of handling the data by obfuscating
                    the raw sensitive identifiers.</p>
</span>
<div class="use-case-module__use-case-diagram">
<img alt="Large gray Google Cloud rectangle comprises 3 yellow boxes. Top box on left is labeled âData de-identificationâ and contains Cloud Storage, which flows to Dataflow. Dataflow flows to lower yellow box labeled âConfiguration (DLP template and key) management.â On left is a Security admins box, and arrows flow right into Cloud DLP, into which Dataflow points, and Cloud KMS. To the right is the 3rd yellow box, labeled âData validation and re-identification,â containing BigQuery, Other data storage, Pub/Sub, Security analysts, Dataflow, and Subscriber client. Arrows indicate flow between these." class="" loading="lazy" src="https://www.gstatic.com/bricks/image/f3e5f0e8b58a60ef1b787ce6fb2d780ac0f1227314cb0b4a25eed9a36294fc86.svg" style="max-width: 953px; max-height: 400px;"/>
</div>
<div class="cws-grid cws-cards--compact use-case-module__technical-content cws-spacer-3--top">
<div class="cws-grid__col--span-4">
<a class="cws-card" href="/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-child_eyebrow="tutorial" track-metadata-child_headline="de-identification of pii in large-scale datasets" track-metadata-child_index="1" track-metadata-child_total="2" track-metadata-eventdetail="cloud.google.com/solutions/de-identification-re-identification-pii-using-cloud-dlp" track-metadata-module="use cases" track-metadata-module_headline="protect sensitive data as you migrate to the cloud" track-name="de-identification of pii in large-scale datasets" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Tutorial</p>
<p class="cws-headline cws-headline--headline-5">De-identification of PII in large-scale datasets</p>
<div class="cws-body">Reference on how to use Cloud DLP to create an automated data transformation pipeline to de-identify sensitive data like personally identifiable information (PII).</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
<div class="cws-grid__col--span-4">
<a class="cws-card" href="https://github.com/GoogleCloudPlatform/dlp-rdb-bq-import" rel="noopener" target="_blank" track-metadata-child_eyebrow="pattern" track-metadata-child_headline="relational database import to bigquery with dataflow" track-metadata-child_index="2" track-metadata-child_total="2" track-metadata-eventdetail="github.com/GoogleCloudPlatform/dlp-rdb-bq-import" track-metadata-module="use cases" track-metadata-module_headline="protect sensitive data as you migrate to the cloud" track-name="relational database import to bigquery with dataflow" track-type="card">
<div class="cws-card__inner">
<div class="cws-card__content">
<p class="cws-label">Pattern</p>
<p class="cws-headline cws-headline--headline-5">Relational database import to BigQuery with Dataflow</p>
<div class="cws-body">This concept architecture uses Dataflow and Cloud DLP to securely tokenize and import data from a relational database to BigQuery.</div>
</div>
<div class="cws-card__cta">
<span class="cws-button cws-button--low-emphasis">
          Learn more
        </span>
</div>
</div>
</a>
</div>
</div>
</div>
</div>
<div class="use-case-module__cta">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/docs/how-to" track-metadata-eventdetail="cloud.google.com/dlp/docs/how-to" track-metadata-modifier="low-emphasis" track-name="view all technical guides" track-type="button">


      View all technical guides
      
    
      </a>
</div>
</div>
</div>
</section>
<section class="module-section" id="all-features"></section>
<section class="module-section" id="all-features">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="All features">
<p class="cws-label" style="margin-bottom: 16px;">All features</p>
<style>
            .feature-module__body-text__large {
              font-family: Google Sans, sans-serif;
            }

            .feature-module__table-header {
              color: #202124;
            }

            .feature-module__table-cell p {
              font: inherit;
              margin-top: 0;
            }

            .feature-module__table-cell {
              line-height: 30px;
            }

            .feature-module__headline {
              margin-bottom: 36px;
            }
          </style>
<div class="feature-module" track-metadata-module="all features" track-metadata-module_headline="all features">
<div>
<div class="feature-module__headline">
<h3 class="cws-headline--headline-4" data-text=" All features " id="all-features"> All features </h3>
</div>
<div class="feature-module__feature-table">
<div class="cloud-table-wrapper devsite-table-wrapper">
<table class="cloud-table">
<tbody>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Automatic discovery, inspection, and classification
                          </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Automatic DLP can be
                            configured directly in the Cloud Console and runs
                            continuously for you.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Flexible classification </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext"><a class="cws-link" href="/dlp/docs/infotypes-reference" track-metadata-eventdetail="cloud.google.com/dlp/docs/infotypes-reference" track-metadata-module="all features" track-metadata-module_headline="all features" track-name="150 pre-defined detectors" track-type="inline link">150+ pre-defined detectors</a>
                            with a focus on quality, speed, and scale. Detectors
                            are improving and expanding all the time.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Simple and powerful redaction </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">De-identify your data:
                            redact, mask, tokenize, and transform text and
                            images to help ensure data privacy.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Serverless </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Cloud DLP is ready to
                            go, no need to manage hardware, VMs, or scale. Just
                            send a little or a lot of data and Cloud DLP scales
                            for you.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Detailed findings with on-demand inspection </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Classification results
                            can be sent directly into BigQuery for detailed
                            analysis or export into other systems. Custom
                            reports can easily be generated in Data
                            Studio.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Secure data handling </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Cloud DLP handles your
                            <a class="cws-link" href="/dlp/docs/support/data-security" track-metadata-eventdetail="cloud.google.com/dlp/docs/support/data-security" track-metadata-module="all features" track-metadata-module_headline="all features" track-name="data securely" track-type="inline link">data securely</a>
                            and undergoes several independent third-party audits
                            to test for data safety, privacy, and
                            security.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Pay-as-you-go pricing </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Cloud DLP is charged
                            based on the amount of data processed, not based on
                            a subscription service or device. This
                            customer-friendly pricing allows you to pay as you
                            go and not in advance of demand.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Easy workload integration </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Efficiently deploy
                            Cloud DLP with reusable templates, monitor your data
                            with periodic scans, and integrate into serverless
                            architecture with Pub/Sub notifications.</span>
</td>
</tr>
<tr>
<td>
<span class="cws-headline--headline-6 feature-module__table-header">
                            Custom rules </span>
</td>
<td class="feature-module__table-cell">
<span class="cws-body richtext">Add your own custom
                            types, adjust detection thresholds, and create
                            detection rules to fit your needs and reduce
                            noise.</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section class="module-section">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Pricing">
<p class="cws-label" style="margin-bottom: 16px;">Pricing</p>
<style>
            .pricing-module__table-header span {
              color: #202124;
            }

            .pricing-module__table-cell {
              line-height: 30px;
            }

            .pricing-module__headline {
              margin-bottom: 36px;
            }

            .pricing-module__pricing-table,
            .pricing-module__pricing-cta {
              margin-top: 24px;
            }
          </style>
<div class="pricing-module" track-metadata-module="pricing" track-metadata-module_headline="pricing">
<div>
<div class="pricing-module__headline">
<h3 class="cws-headline--headline-4" data-text=" Pricing " id="pricing"> Pricing </h3>
</div>
<p class="cws-spacer-0--bottom">
<span class="cws-body--large richtext">
<p>Pricing for Cloud DLP is based on total bytes processed
                    with rate schedules based on total volume. You can try DLP
                    for free using the monthly free tier.</p>
</span>
</p>
</div>
<div class="pricing-module__pricing-cta">
<a class="cws-button cws-button--low-emphasis cws-button--align-left" href="/dlp/pricing" track-metadata-eventdetail="cloud.google.com/dlp/pricing" track-metadata-modifier="low-emphasis" track-name="view pricing details" track-type="button">


      View pricing details
      
    
      </a>
</div>
</div>
</div>
</section>
<section class="module-section">
</section>
<section class="module-section"></section>
</div>
<section class="cloud-content-footer">
<div class="cloud-jump-section" data-cloud-is-subtitle-linked="true" data-cloud-main-text="Take the next step">
<style>
          .ankle-module__headline {
            margin-bottom: 28px;
          }

          .ankle-module__description {
            margin-bottom: 48px;
          }

          .ankle-module__buttons-wrap {
            display: flex;
            flex-wrap: wrap;
            gap: 32px;
          }

          .ankle-module__buttons {
            display: inline-block;
          }

          .ankle-module__richtext-cta {
            align-self: center;
            display: inline-block;
          }

          .ankle-module__richtext-cta p {
            margin-top: 0;
          }

          .ankle-module__content {
            padding: 60px 0;
          }

          .ankle-module__link-list {
            list-style: none;
            padding: 0;
          }

          .ankle-module__link-list-item:first-child {
            margin: 0;
          }

          .ankle-module__link-list-item {
            margin: 24px 0 0;
          }

          .ankle-module__link-list-item-label {
            margin-bottom: 8px;
          }

          @media (min-width: 767px) {
            .ankle-module__links {
              border-left: 1px solid #dadce0;
            }

            .ankle-module__link-list {
              padding: 4px 24px;
            }
          }

          @media (min-width: 1280px) {
            .ankle-module__link-list-item {
              margin: 36px 0 0;
            }
          }

          @media (max-width: 600px) {
            .ankle-module__links {
              margin-top: 24px;
            }
          }
        </style>
<div class="ankle-module cws-fullbleed cws-background--grey" track-metadata-module="take the next step">
<div class="cws-page">
<div class="ankle-module__content cloud-jump-content cws-grid">
<div class="cws-grid__col--span-6">
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<h3 class="cws-headline--headline-4 ankle-module__headline" data-text="                       Take the next step " id="take-the-next-step">
                      Take the next step </h3>
<p class="cws-body--large ankle-module__description"> Start
                      building on Google Cloud with $300 in free credits and 20+
                      always free products. </p>
<div class="ankle-module__buttons-wrap">
<div class="ankle-module__buttons">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/freetrial" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/freetrial" track-metadata-modifier="high-emphasis" track-name="try cloud dlp free" track-type="button">


      Try Cloud DLP free
      
    
      </a>
</div>
</div>
</slot>
<slot slot="ineligible">
<h3 class="cws-headline--headline-4 ankle-module__headline" data-text="                       Take the next step " id="take-the-next-step_1">
                      Take the next step </h3>
<p class="cws-body--large ankle-module__description"> Start
                      your next project, explore interactive tutorials, and
                      manage your account. </p>
<div class="ankle-module__buttons-wrap">
<div class="ankle-module__buttons">
<a class="cws-button cws-button--high-emphasis" href="https://console.cloud.google.com/dlp" referrerpolicy="no-referrer-when-downgrade" rel="noopener" target="_blank" track-metadata-eventdetail="console.cloud.google.com/dlp" track-metadata-modifier="high-emphasis" track-name="go to console" track-type="button">


      Go to console
      
    
      </a>
</div>
</div>
</slot>
</cloudx-free-trial-eligible-content>
</div>
<div class="cws-grid__col--span-4 cws-grid__col--offset-7 ankle-module__links">
<cloudx-free-trial-eligible-content>
<slot slot="eligible">
<ul class="ankle-module__link-list">
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Need help getting started? </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/contact/" track-metadata-child_index="1" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/contact/" track-metadata-module="take the next step" track-name="contact sales" track-type="ankle link">
        Contact sales
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Work with a trusted partner </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.withgoogle.com/partners/" rel="noopener" target="_blank" track-metadata-child_index="2" track-metadata-child_total="3" track-metadata-eventdetail="cloud.withgoogle.com/partners/" track-metadata-module="take the next step" track-name="find a partner" track-type="ankle link">
        Find a partner
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Continue browsing </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/products/" track-metadata-child_index="3" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/products/" track-metadata-module="take the next step" track-name="see all products" track-type="ankle link">
        See all products
    </a>
</li>
</ul>
</slot>
<slot slot="ineligible">
<ul class="ankle-module__link-list">
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Need help getting started? </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/contact/" track-metadata-child_index="1" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/contact/" track-metadata-module="take the next step" track-name="contact sales" track-type="ankle link">
        Contact sales
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Work with a trusted partner </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.withgoogle.com/partners/" rel="noopener" target="_blank" track-metadata-child_index="2" track-metadata-child_total="3" track-metadata-eventdetail="cloud.withgoogle.com/partners/" track-metadata-module="take the next step" track-name="find a partner" track-type="ankle link">
        Find a partner
    </a>
</li>
<li class="ankle-module__link-list-item">
<div class="cws-headline--headline-6 ankle-module__link-list-item-label">
                          Get tips &amp; best practices </div>
<a class="cws-link-independent cws-link-independent" href="https://cloud.google.com/docs/tutorials" track-metadata-child_index="3" track-metadata-child_total="3" track-metadata-eventdetail="cloud.google.com/docs/tutorials" track-metadata-module="take the next step" track-name="see tutorials" track-type="ankle link">
        See tutorials
    </a>
</li>
</ul>
</slot>
</cloudx-free-trial-eligible-content>
</div>
</div>
</div>
</div>
</div>
</section>
</article>
<!--&#123;# Page published by Bricks, request id 2bd353c5-84c3-4c5f-8873-d20fcb3b094c} #}-->
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/concepts-infotypes]</H1></p><div class="devsite-article-body clearfix">
<p>Cloud Data Loss Prevention uses <em>information types</em>âor <em>infoTypes</em>âto
define what it scans for. An infoType is a type of sensitive data, such as a
name, email address, telephone number, identification number, credit card
number, and so on. An <em>infoType detector</em> is the corresponding detection
mechanism that matches on an infoType's matching criteria.</p>
<aside class="note"><strong>Note:</strong><span> If you're looking for an up-to-date list of all built-in infoType
detectors, see <a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</span></aside>
<h2 data-text="How to use infoTypes" id="how_to_use_infotypes">How to use infoTypes</h2>
<p>Cloud DLP uses infoType detectors in the configuration for its
scans to determine what to inspect for and how to transform findings. InfoType
names are also used when displaying or reporting scan results.</p>
<p>For example, if you wanted to look for email addresses in a block of text, you
would specify the <code dir="ltr" translate="no">EMAIL_ADDRESS</code> infoType detector in the inspection
configuration.  If you wanted to redact email addresses from the text block,
you would specify <code dir="ltr" translate="no">EMAIL_ADDRESS</code> in both the inspection configuration and the
de-identification configuration to indicate how to redact or transform that
type.</p>
<p>Further, you could use a combination of built-in and custom infoType detectors
to exclude a subset of email addresses from scan findings. First, create a
custom infoType called <code dir="ltr" translate="no">INTERNAL_EMAIL_ADDRESS</code> and configure it to exclude
internal test email addresses. Then, you can set up your scan to include
findings for <code dir="ltr" translate="no">EMAIL_ADDRESS</code>, but include an exclusion rule that excludes any
findings that match <code dir="ltr" translate="no">INTERNAL_EMAIL_ADDRESS</code>. For more information about
exclusion rules and other features of custom infoType detectors, see <a href="/dlp/docs/creating-custom-infotypes">Creating
custom infoType detectors</a>.</p>
<p>Cloud DLP provides a set of built-in infoType detectors that you
specify by name, each of which is listed in <a href="/dlp/docs/infotypes-reference">InfoType detector
reference</a>. These detectors use a variety of
techniques to discover and classify each type. For example, some types will
require a pattern match, some may have mathematical checksums, some have special
digit restrictions, and others may have specific prefixes or context around the
findings.</p>
<h3 data-text="Examples" id="examples">Examples</h3>
<p>When you set up Cloud DLP to scan your content, you include the
infoType detectors to use in the scan configuration.</p>
<p>For example, the following JSON and code samples demonstrate a simple scan
request to the DLP API. Notice that the <code dir="ltr" translate="no">PHONE_NUMBER</code>
detector is specified in
<a href="/dlp/docs/reference/rest/v2/InspectConfig"><code dir="ltr" translate="no">inspectConfig</code></a>,
which instructs Cloud DLP to scan the given string for a
phone number.</p>
<div class="ds-selector-tabs" data-ds-scope="code-sample" id="dlp-inspect-phone-number-code-sample">
<section>
<h3 data-text="Protocol" id="dlp-inspect-phone-number-protocol" track-metadata-position="dlp-inspect-phone-number" track-name="protocol" track-type="sampleTabNav">Protocol</h3>
<p><strong>JSON input:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">POST https://dlp.googleapis.com/v2/projects/[PROJECT-ID]/content:inspect?key={YOUR_API_KEY}

{
  "item":{
    "value":"My phone number is (415) 555-0890"
  },
  "inspectConfig":{
    "includeQuote":true,
    "minLikelihood":"POSSIBLE",
    "infoTypes":{
      "name":"PHONE_NUMBER"
    }
  }
}
</code></pre>
<p>When you send the preceding request the specified endpoint,
Cloud DLP returns the following:</p>
<p><strong>JSON output:</strong></p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">{
  "result":{
    "findings":[
      {
        "quote":"(415) 555-0890",
        "infoType":{
          "name":"PHONE_NUMBER"
        },
        "likelihood":"VERY_LIKELY",
        "location":{
          "byteRange":{
            "start":"19",
            "end":"33"
          },
          "codepointRange":{
            "start":"19",
            "end":"33"
          }
        },
        "createTime":"2018-10-29T23:46:34.535Z"
      }
    ]
  }
}
</code></pre>
</section>
<section>
<h3 data-text="Java" id="dlp-inspect-phone-number-java" track-metadata-position="dlp-inspect-phone-number" track-name="java" track-type="sampleTabNav">Java</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-phone-number" track-name="java" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/java-dlp/blob/HEAD/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-phone-number" data-p="1634365" href="#" track-metadata-lang="java" track-metadata-position="dlp-inspect-phone-number" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-java" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java" data-region-tag="dlp_inspect_phone_number" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/java-dlp/samples/snippets/src/main/java/dlp/snippets/InspectPhoneNumber.java/HEAD/dlp_inspect_phone_number" translate="no"><code dir="ltr" translate="no">
import com.google.cloud.dlp.v2.DlpServiceClient;
import com.google.privacy.dlp.v2.ContentItem;
import com.google.privacy.dlp.v2.Finding;
import com.google.privacy.dlp.v2.InfoType;
import com.google.privacy.dlp.v2.InspectConfig;
import com.google.privacy.dlp.v2.InspectContentRequest;
import com.google.privacy.dlp.v2.InspectContentResponse;
import com.google.privacy.dlp.v2.Likelihood;
import com.google.privacy.dlp.v2.LocationName;
import java.io.IOException;

public class InspectPhoneNumber {

  public static void main(String[] args) throws Exception {
    // TODO(developer): Replace these variables before running the sample.
    String projectId = "your-project-id";
    String textToInspect = "My name is Gary and my email is gary@example.com";
    inspectString(projectId, textToInspect);
  }

  // Inspects the provided text.
  public static void inspectString(String projectId, String textToInspect) throws IOException {
    // Initialize client that will be used to send requests. This client only needs to be created
    // once, and can be reused for multiple requests. After completing all of your requests, call
    // the "close" method on the client to safely clean up any remaining background resources.
    try (DlpServiceClient dlp = DlpServiceClient.create()) {
      // Specify the type and content to be inspected.
      ContentItem item = ContentItem.newBuilder().setValue(textToInspect).build();

      // Specify the type of info the inspection will look for.
      // See https://cloud.google.com/dlp/docs/infotypes-reference for complete list of info types
      InfoType infoType = InfoType.newBuilder().setName("PHONE_NUMBER").build();

      // Construct the configuration for the Inspect request.
      InspectConfig config =
          InspectConfig.newBuilder()
              .setIncludeQuote(true)
              .setMinLikelihood(Likelihood.POSSIBLE)
              .addInfoTypes(infoType)
              .build();

      // Construct the Inspect request to be sent by the client.
      InspectContentRequest request =
          InspectContentRequest.newBuilder()
              .setParent(LocationName.of(projectId, "global").toString())
              .setItem(item)
              .setInspectConfig(config)
              .build();

      // Use the client to send the API request.
      InspectContentResponse response = dlp.inspectContent(request);

      // Parse the response and process results
      System.out.println("Findings: " + response.getResult().getFindingsCount());
      for (Finding f : response.getResult().getFindingsList()) {
        System.out.println("\tQuote: " + f.getQuote());
        System.out.println("\tInfo type: " + f.getInfoType().getName());
        System.out.println("\tLikelihood: " + f.getLikelihood());
      }
    }
  }
}</code></pre>
</div>
</section>
<section>
<h3 data-text="Python" id="dlp-inspect-phone-number-python" track-metadata-position="dlp-inspect-phone-number" track-name="python" track-type="sampleTabNav">Python</h3>
<p>
      
        
          To learn how to install and use the client library for Cloud DLP, see
          <a href="/dlp/docs/libraries" track-metadata-position="dlp-inspect-phone-number" track-name="python" track-type="clientLibrariesReference">
            Cloud DLP client libraries</a>.
        
      
      
    </p>
<div class="github-docwidget-include" style="border: 1px solid #4285f4; padding: 4px; background-color: #4285f4;">
<div style="text-align: right; float: right;">
<a class="button" href="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" style="margin-left: 0" target="_blank" track-metadata-link-destination="https://github.com/googleapis/python-dlp/blob/HEAD/samples/snippets/inspect_content.py" track-name="gitHubViewButton" track-type="github">View on GitHub</a>
<a class="button google-feedback" data-b="infraops" data-context="dlp-inspect-phone-number" data-p="1634365" href="#" track-metadata-lang="python" track-metadata-position="dlp-inspect-phone-number" track-name="sampleFeedback" track-type="feedback">Feedback</a>
</div>
<div style="clear: both;"></div>
</div>
<div class="github-docwidget-gitinclude-code">
<pre class="prettyprint lang-py" data-code-snippet="true" data-git-revision="HEAD" data-github-path="googleapis/python-dlp/samples/snippets/inspect_content.py" data-region-tag="dlp_inspect_string_basic" dir="ltr" suppresswarning="suppresswarning" track-metadata-position="googleapis/python-dlp/samples/snippets/inspect_content.py/HEAD/dlp_inspect_string_basic" translate="no"><code dir="ltr" translate="no">def inspect_string_basic(
    project,
    content_string,
    info_types=["PHONE_NUMBER"],
):
    """Uses the Data Loss Prevention API to analyze strings for protected data.
    Args:
        project: The Google Cloud project id to use as a parent resource.
        content_string: The string to inspect.
        info_types: A list of strings representing info types to look for.
            A full list of info type categories can be fetched from the API.
    Returns:
        None; the response from the API is printed to the terminal.
    """

    # Import the client library.
    import google.cloud.dlp

    # Instantiate a client.
    dlp = google.cloud.dlp_v2.DlpServiceClient()

    # Prepare info_types by converting the list of strings into a list of
    # dictionaries (protos are also accepted).
    info_types = [{"name": info_type} for info_type in info_types]

    # Construct the configuration dictionary.
    inspect_config = {
        "info_types": info_types,
        "include_quote": True,
    }

    # Construct the `item`.
    item = {"value": content_string}

    # Convert the project id into a full resource id.
    parent = f"projects/{project}"

    # Call the API.
    response = dlp.inspect_content(
        request={"parent": parent, "inspect_config": inspect_config, "item": item}
    )

    # Print out the results.
    if response.result.findings:
        for finding in response.result.findings:
            print("Quote: {}".format(finding.quote))
            print("Info type: {}".format(finding.info_type.name))
            print("Likelihood: {}".format(finding.likelihood))
    else:
        print("No findings.")

</code></pre>
</div>
</section>
</div>
<p>If you need precise control and predictability as to what detectors are run, you
should specify particular <a href="/dlp/docs/infotypes-reference">infoTypes listed in the
reference</a>, otherwise Cloud DLP uses
a default list, which may change over time. Depending on the amount of content
to scan, scanning for default infoTypes can be prohibitively time-consuming or
expensive.</p>
<p>For more information on how to use infoType detectors to scan your content,
see one of the <a href="/dlp/docs/how-to">how-to topics</a> about inspecting, redacting,
or de-identifying.</p>
<h2 data-text="Certainty and testing" id="certainty">Certainty and testing</h2>
<p>Findings are reported with a certainty score called
<a href="/dlp/docs/likelihood">likelihood</a>. The likelihood score indicates how likely a
finding matches the corresponding type. For example, a type may return a lower
likelihood if it only matches the pattern and return a higher likelihood if it
matches the pattern and has positive context around it. For this reason, you may
notice that a single finding could match several types at lower likelihood.
Also, a finding may not appear or might have lower certainty if it doesn't match
properly, or if it has negative context around it. For example, a finding might
not reported if it matches the structure for the specified infoType but fails
the infoType's checksum. Or a finding could match more than one infoType but
have context that boosts one of them, and thus only get reported for that type.</p>
<aside class="note"><strong>Note:</strong><span> <em>Positive context</em> is when the inclusion of certain characters, words, or
phrases in proximity to a potentially matched pattern indicates to
Cloud DLP that a match to the pattern is more likely. Similarly,
<em>negative context</em> is when the inclusion of certain characters, words, or
phrases in proximity to a pattern indicates that a match is less likely.</span></aside>
<p>If you are testing various detectors, you may notice that fake or sample data
does not get reported because that fake or sample data is not passing enough
checks to report.</p>
<h2 data-text="Kinds of infoType detectors" id="kinds">Kinds of infoType detectors</h2>
<p>Cloud DLP includes several kinds of infoType detectors, all
of which are summarized here:</p>
<ul>
<li><a href="#built-in"><em>Built-in infoType detectors</em></a> are built into
Cloud DLP. They include detectors for country- or
region-specific sensitive data types as well as globally applicable data
types.</li>
<li><a href="#custom"><em>Custom infoType detectors</em></a> are detectors that you create
yourself. There are three kinds of custom infoType detectors:
<ul>
<li><em>Small custom dictionary detectors</em> are simple word lists that
Cloud DLP matches on. Use small custom dictionary
detectors when you have a list of up to several tens of thousands of
words or phrases. Small custom dictionary detectors are preferred if
you don't anticipate your word list changing significantly.</li>
<li><em>Large custom dictionary detectors</em> are generated by
Cloud DLP using large lists of words or phrases stored
in either Cloud Storage or BigQuery. Use large custom dictionary
detectors when you have a large list of words or phrasesâup to tens
of millions.</li>
<li><em>Regular expressions (regex) detectors</em> enable
Cloud DLP to detect matches based on a regular expression
pattern.</li>
</ul></li>
</ul>
<p>In addition, Cloud DLP includes the concept of
<a href="#inspection-rules"><em>inspection rules</em></a>, which enable you to fine-tune scan
results using the following:</p>
<ul>
<li><em>Exclusion rules</em> enable you to decrease the number of findings returned
by adding rules to a built-in or custom infoType detector.</li>
<li><em>Hotword rules</em> enable you to increase the quantity or change the
<a href="/dlp/docs/likelihood">likelihood value</a> of findings returned by adding
rules to a built-in or custom infoType detector.</li>
</ul>
<h2 data-text="Built-in infoType detectors" id="built-in">Built-in infoType detectors</h2>
<p>Built-in infoType detectors are built into Cloud DLP, and
include detectors for country- or region-specific sensitive data types such as
the French <em>NumÃ©ro d'Inscription au RÃ©pertoire (NIR)</em> (<code dir="ltr" translate="no">FRANCE_NIR</code>), UK
driver's license number (<code dir="ltr" translate="no">UK_DRIVERS_LICENSE_NUMBER</code>), and US Social Security
number (<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code>). They also include globally applicable data
types such as a person name (<code dir="ltr" translate="no">PERSON_NAME</code>), telephone numbers (<code dir="ltr" translate="no">PHONE_NUMBER</code>),
email addresses (<code dir="ltr" translate="no">EMAIL_ADDRESS</code>), and credit card numbers
(<code dir="ltr" translate="no">CREDIT_CARD_NUMBER</code>). To detect content that corresponds to infoTypes,
Cloud DLP leverages various techniques including pattern
matching, checksums, machine-learning, context analysis, and others.</p>
<p>The list of built-in infoType detectors is always being updated. For a complete
list of currently supported built-in infoType detectors, see
<a href="/dlp/docs/infotypes-reference">InfoType detector reference</a>.</p>
<p>You can also view a complete list of all built-in infoType detectors by
calling Cloud DLP's
<a href="/dlp/docs/reference/rest/v2/infoTypes/list"><code dir="ltr" translate="no">infoTypes.list</code></a>
method.</p>
<p>Built-in infoType detectors are not a 100% accurate detection method. For
example, they can't guarantee compliance with regulatory requirements. You must
decide what data is sensitive and how to best protect it. Google recommends that
you test your settings to make sure your configuration meets your
requirements.</p>
<h3 data-text="Language support" id="language-support">Language support</h3>
<p>Country-specific infoTypes support the English language and the respective
country's languages. Most global infoTypes work with multiple languages.
Test Cloud DLP with your data to verify that it meets your
requirements.</p>
<h2 data-text="Custom infoType detectors" id="custom">Custom infoType detectors</h2>
<p>There are three kinds of custom infoType detectors:</p>
<ul>
<li><a href="#small">Small custom dictionary detectors</a></li>
<li><a href="#large">Large custom dictionary detectors</a></li>
<li><a href="#regex">Regular expressions (regex)</a></li>
</ul>
<p>In addition, Cloud DLP includes inspection rules, which
enable you to fine-tune scan results by adding the following to existing
detectors:</p>
<ul>
<li><a href="#exclusion">Exclusion rules</a></li>
<li><a href="#hotword">Hotword rules</a></li>
</ul>
<h3 data-text="Small custom dictionary detectors" id="small">Small custom dictionary detectors</h3>
<p>Use <a href="/dlp/docs/creating-custom-infotypes-dictionary">small custom dictionary
detectors</a> (also referred to as
"regular custom dictionary detectors") to match a short (up to several tens of
thousands) list of words or phrases. A small custom dictionary can act as its
own unique detector.</p>
<p>Custom dictionary detectors are useful when you want to scan for a list of
words or phrases that are not easily matched by a regular expression or a
built-in detector. For example, suppose you want to scan for conference rooms
that are commonly referred to by their assigned room names rather than their
room numbers, such as state or region names, landmarks, fictional characters,
and so on. You can make a small custom dictionary detector that contains a
list of these room names. Cloud DLP can scan your content
for each of the room names and return a match when it encounters one of them in
context. Learn more about how Cloud DLP matches dictionary
words and phrases in the "<a href="/dlp/docs/creating-custom-infotypes-dictionary#specifics">Dictionary matching
specifics</a>" section of
<a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
detector</a>.</p>
<p>For more details about how small dictionary custom infoType detectors work,
as well as examples in action, see <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a regular custom dictionary
detector</a>.</p>
<h3 data-text="Large custom dictionary detectors" id="large">Large custom dictionary detectors</h3>
<p>Use <a href="/dlp/docs/creating-stored-infotypes">large custom dictionary detectors</a>
(also referred to as "stored custom dictionary detectors") when you have more
than a few words or phrases to scan for, or if your list of words or phrases
changes frequently. Large custom dictionary detectors can match on up to tens of
millions of words or phrases.</p>
<p>Large custom dictionary detectors are created differently from both regular
expression custom detectors and small custom dictionary detectors. Each large
custom dictionary has two components:</p>
<ul>
<li>A list of phrases that you create and define. The list is stored as either
a text file within Cloud Storage or a column in a
BigQuery table.</li>
<li>The generated dictionary files, which are built by Cloud DLP
based on your phrase list. The dictionary files are stored in
Cloud Storage, and are comprised of a copy of the source phrase data
plus bloom filters, which aid in searching and matching. You can't edit
these files directly.</li>
</ul>
<p>Once you've created a word list and then used Cloud DLP to
generate a custom dictionary, you initiate or schedule a scan using a large
custom dictionary detector in a similar way as other infoType detectors.</p>
<p>For more details about how large custom dictionary detectors work, as well as
examples in action, see <a href="/dlp/docs/creating-custom-infotypes-dictionary">Creating a stored custom dictionary
detector</a>.</p>
<h3 data-text="Regular expressions" id="regex">Regular expressions</h3>
<p>A regular expression (regex) custom infoType detector allows you to create your
own infoType detectors that enable Cloud DLP to detect matches
based on a regex pattern. For example, suppose that you had medical record
numbers in the formÂ <code dir="ltr" translate="no">###-#-#####</code>. You could define a regex pattern such as the
following:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">[1-9]{3}-[1-9]{1}-[1-9]{5}
</code></pre>
<p>The Cloud DLP would then match items like this:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">123-4-56789
</code></pre>
<p>You can also specify a <a href="/dlp/docs/likelihood">likelihood</a> to assign to each
custom infoType match. That is, when Cloud DLP matches the sequence
you specify, it will assign the likelihood that you have indicated. This is
useful because if your custom regex defines a sequence that is common enough it
could easily match some other random sequence, you would not want
Cloud DLP to label every match asÂ <code dir="ltr" translate="no">VERY_LIKELY</code>. Doing so would
erode confidence in scan results and potentially cause the wrong information to
be matched or de-identified.</p>
<p>For more information about regular expression custom infoType detectors, and to
see them in action, see <a href="/dlp/docs/creating-custom-infotypes-regex">Creating a custom regex
detector</a>.</p>
<h2 data-text="Inspection rules" id="inspection-rules">Inspection rules</h2>
<p>You use inspection rules to refine the results returned by existing infoType
detectorsâeither built-in or custom. Inspection rules can be useful for
times when the results that Cloud DLP returns need to be augmented
in some way, either by adding to and excluding from the existing infoType
detector.</p>
<p>The two types of inspection rules are:</p>
<ul>
<li>Exclusion rules</li>
<li>Hotword rules</li>
</ul>
<p>For more information about inspection rules, see <a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors
to refine scan results</a>.</p>
<h3 data-text="Exclusion rules" id="exclusion">Exclusion rules</h3>
<p>Exclusion rules enable you to decrease the quantity or precision of findings
returned by adding rules to a built-in or custom infoType detector. Exclusion
rules can help you reduce noise or other unwanted findings from being returned
by an infoType detector.</p>
<p>For example, if you scan a database for email addresses, you can add an
exclusion rule in the form of a custom regex that instructs
Cloud DLP to exclude any findings ending in "@example.com."</p>
<p>For more information about exclusion rules, see <a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors
to refine scan results</a>.</p>
<h3 data-text="Hotword rules" id="hotword">Hotword rules</h3>
<p>Hotword rules enable you to increase the quantity or accuracy of findings
returned by adding rules to a built-in or custom infoType detector. Hotword
rules can effectively help you loosen an existing infoType detector's rules.</p>
<p>For example, suppose you want to scan a medical database for patient names. You
can use Cloud DLP's built-in <code dir="ltr" translate="no">PERSON_NAME</code> infoType
detector, but that will cause Cloud DLP to match on all
names of people, not just names of patients. To fix this, you can include a
hotword rule in the form of a regex custom infoType that looks for the word
"patient" within a certain character proximity from the first character of
potential matches. You can then assign findings matching this pattern a
<a href="/dlp/docs/likelihood">likelihood</a> of "very likely," since they correspond to
your special criteria.</p>
<p>For more information about hotword rules, see <a href="/dlp/docs/creating-custom-infotypes-rules">Modifying infoType detectors to
refine scan results</a>.</p>
<h2 data-text="Examples" id="examples_2">Examples</h2>
<p>To get a better idea of how infoTypes match on findings, look at the following
examples of matching on a series of digits to determine whether they constitute
a US Social Security number or a US Individual Taxpayer Identification Number.
Keep in mind that these examples are for built-in infoType detectors. When you
create a custom infoType detector, you specify the criteria that determine the
likelihood of a scan match.</p>
<h3 data-text="Example 1" id="example_1">Example 1</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"SSN 222-22-2222"
</code></pre>
<p>Reports a high likelihood score of <code dir="ltr" translate="no">VERY_LIKELY</code> for a
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> because:</p>
<ul>
<li>It is in the standard Social Security number format, which raises the
certainty.</li>
<li>It has context nearby ("SSN") that boosts towards
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code>.</li>
</ul>
<h3 data-text="Example 2" id="example_2">Example 2</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"999-99-9999"
</code></pre>
<p>Reports a low likelihood score of <code dir="ltr" translate="no">VERY_UNLIKELY</code> for a
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> because:</p>
<ul>
<li>It is in the standard format, which raises the certainty.</li>
<li>It starts with a 9, which is not allowed in Social Security numbers, thus
lowers the certainty.</li>
<li>It lacks context, which lowers the certainty.</li>
</ul>
<h3 data-text="Example 3" id="example_3">Example 3</h3>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">"999-98-9999"
</code></pre>
<p>Reports a likelihood score of <code dir="ltr" translate="no">POSSIBLE</code> for a
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code> and <code dir="ltr" translate="no">VERY_UNLIKELY</code> for
<code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> because:</p>
<ul>
<li>It has the standard format for both <code dir="ltr" translate="no">US_SOCIAL_SECURITY_NUMBER</code> and
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code>.</li>
<li>It starts with a 9 and has another digit check, which boosts certainty for
<code dir="ltr" translate="no">US_INDIVIDUAL_TAXPAYER_IDENTIFICATION_NUMBER</code>.</li>
<li>It lacks any context, which lowers the certainty for both.</li>
</ul>
<h2 data-text="What's next" id="whats_next">What's next</h2>
<p>The Cloud DLP team releases new infoType detectors and groups
periodically. To learn how to get the latest list of built-in infoTypes, see
<a href="/dlp/docs/listing-infotypes">Listing built-in infoType detectors</a>.</p>
<aside class="special"><strong>Important:</strong><span> Built-in infoType detectors are not a 100% accurate detection method.
For example, they can't guarantee compliance with regulatory requirements. You
must decide what data is sensitive and how to best protect it. Google recommends
that you test your settings to make sure your configuration meets your
requirements.</span></aside>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr><p style="background-color:lightgray;"<H1>[ Page URL:https://cloud.google.com//dlp/docs/reference/rest/v2/infoTypes/list]</H1></p><div class="devsite-article-body clearfix">
<meta content="list" itemprop="name"/>
<meta content="/dlp/docs/reference/rest/v2/infoTypes/list" itemprop="path"/>
<section id="/dlp/docs/reference/rest/v2/infoTypes/list">
<ul class="toc">
<li><a href="#body.HTTP_TEMPLATE">HTTP request</a></li>
<li><a href="#body.QUERY_PARAMETERS">Query parameters</a></li>
<li><a href="#body.request_body">Request body</a></li>
<li><a href="#body.response_body">Response body</a></li>
<li><a href="#body.aspect">Authorization Scopes</a></li>
<li><a href="#try-it">Try it!</a></li>
</ul>
<section id="google.privacy.dlp.v2.DlpService.ListInfoTypes">
</section>
<section id="description">
<p>Returns a list of the sensitive information types that the DLP API supports. See <a href="https://cloud.google.com/dlp/docs/infotypes-reference">https://cloud.google.com/dlp/docs/infotypes-reference</a> to learn more.</p>
</section>
<section id="body">
<section id="body.HTTP_TEMPLATE">
<h3 data-text="HTTP request" id="http-request">HTTP request</h3>
<p><code dir="ltr" translate="no">GET https://dlp.googleapis.com/v2/infoTypes</code></p><p>The URL uses <a href="https://github.com/googleapis/googleapis/blob/master/google/api/http.proto">gRPC Transcoding</a> syntax.</p>
</section>
<section id="body.QUERY_PARAMETERS">
<h3 data-text="Query parameters" id="query-parameters">Query parameters</h3>
<table class="properties responsive" id="body.QUERY_PARAMETERS-table">
<thead>
<tr>
<th colspan="2">Parameters</th>
</tr>
</thead>
<tbody>
<tr id="body.QUERY_PARAMETERS.parent">
<td><code dir="ltr" translate="no">parent</code></td>
<td>
<p><code class="apitype" dir="ltr" translate="no">string</code></p>
<p>The parent resource name.</p><p>The format of this value is as follows:</p>
<pre dir="ltr" translate="no"><code dir="ltr" translate="no">locations/&lt;var&gt;LOCATION_ID&lt;/var&gt;
</code></pre>
</td>
</tr>
<tr id="body.QUERY_PARAMETERS.language_code">
<td><code dir="ltr" translate="no">languageCode</code></td>
<td>
<p><code class="apitype" dir="ltr" translate="no">string</code></p>
<p>BCP-47 language code for localized infoType friendly names. If omitted, or if localized strings are not available, en-US strings will be returned.</p>
</td>
</tr>
<tr id="body.QUERY_PARAMETERS.filter">
<td><code dir="ltr" translate="no">filter</code></td>
<td>
<p><code class="apitype" dir="ltr" translate="no">string</code></p>
<p>filter to only return infoTypes supported by certain parts of the API. Defaults to supportedBy=INSPECT.</p>
</td>
</tr>
<tr id="body.QUERY_PARAMETERS.location_id">
<td><code dir="ltr" translate="no">locationId</code></td>
<td>
<p><code class="apitype" dir="ltr" translate="no">string</code></p>
<p>Deprecated. This field has no effect.</p>
</td>
</tr>
</tbody>
</table>
</section>
<section id="body.request_body">
<h3 data-text="Request body" id="request-body">Request body</h3>
<p>The request body must be empty.</p>
</section>
<section id="body.response_body">
<h3 data-text="Response body" id="response-body">Response body</h3>
<p>If successful, the response body contains an instance of <code dir="ltr" translate="no"><a href="/dlp/docs/reference/rest/v2/ListInfoTypesResponse">ListInfoTypesResponse</a></code>.</p>
</section>
<section id="body.aspect">
<h3 data-text="Authorization Scopes" id="authorization-scopes">Authorization Scopes</h3>
<p>Requires the following OAuth scope:</p>
<ul>
<li><code dir="ltr" translate="no">https://www.googleapis.com/auth/cloud-platform</code></li>
</ul><p>For more information, see the <a href="https://cloud.google.com/docs/authentication/">Authentication Overview</a>.</p>
</section>
</section>
<section id="try-it">
<div class="devsite-apix">
<div class="apis-explorer" data-discovery-rest-url="https://dlp.googleapis.com/$discovery/rest?version=v2" data-method-id="dlp.infoTypes.list" data-params=""></div>
</div>
</section>
</section>
<devsite-hats-survey class="nocontent" hats-id="mwETRvWii0eU5NUYprb0Y9z5GVbc" listnr-id="83405"></devsite-hats-survey>
</div><hr>